diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/ChangeLog /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/ChangeLog
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/ChangeLog	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/ChangeLog	2007-10-25 02:57:37.000000000 +0800
@@ -1,6 +1,12 @@
+2007-10-24, Version 4.1.3
+	* collectd: A build issue under Solaris has been resolved by renaming
+	  data types.
+	* rrdtool plugin: Use the threadsafe RRD-library if available. Try to
+	  be more threadsafe otherwise by locking calls to the library.
+
 2007-09-28, Version 4.1.2
 	* apcups plugin: Fix reporting of the `load percent' data.
 	* wireless plugin: Correct the handling of cards returning signal and
 	  noise quality as percentage.
 	* perl plugin: Fix a possible buffer overflow in get_module_name().
 	* build system: Further improve the detection of libraries.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/configure	2007-09-28 22:58:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/configure	2007-10-25 02:58:08.000000000 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61 for collectd 4.1.2.
+# Generated by GNU Autoconf 2.61 for collectd 4.1.3.
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 # 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
@@ -723,14 +723,14 @@
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
 # Identity of this package.
 PACKAGE_NAME='collectd'
 PACKAGE_TARNAME='collectd'
-PACKAGE_VERSION='4.1.2'
-PACKAGE_STRING='collectd 4.1.2'
+PACKAGE_VERSION='4.1.3'
+PACKAGE_STRING='collectd 4.1.3'
 PACKAGE_BUGREPORT=''
 
 ac_unique_file="src/collectd.c"
 ac_default_prefix="/opt/collectd"
 # Factoring default headers for most tests.
 ac_includes_default="\
@@ -882,14 +882,14 @@
 BUILD_WITH_LIBSOCKET_TRUE
 BUILD_WITH_LIBSOCKET_FALSE
 BUILD_WITH_LIBRT_TRUE
 BUILD_WITH_LIBRT_FALSE
 BUILD_WITH_LIBRESOLV_TRUE
 BUILD_WITH_LIBRESOLV_FALSE
-BUILD_WITH_RRDTOOL_TRUE
-BUILD_WITH_RRDTOOL_FALSE
+BUILD_WITH_LIBRRD_CFLAGS
+BUILD_WITH_LIBRRD_LDFLAGS
 BUILD_WITH_LIBPTHREAD_TRUE
 BUILD_WITH_LIBPTHREAD_FALSE
 BUILD_WITH_LIBKSTAT_TRUE
 BUILD_WITH_LIBKSTAT_FALSE
 BUILD_WITH_LIBDEVINFO_TRUE
 BUILD_WITH_LIBDEVINFO_FALSE
@@ -1552,13 +1552,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures collectd 4.1.2 to adapt to many kinds of systems.
+\`configure' configures collectd 4.1.3 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -1622,13 +1622,13 @@
   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of collectd 4.1.2:";;
+     short | recursive ) echo "Configuration of collectd 4.1.3:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
@@ -1806,13 +1806,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-collectd configure 4.1.2
+collectd configure 4.1.3
 generated by GNU Autoconf 2.61
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
@@ -1820,13 +1820,13 @@
   exit
 fi
 cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by collectd $as_me 4.1.2, which was
+It was created by collectd $as_me 4.1.3, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 exec 5>>config.log
@@ -2493,13 +2493,13 @@
   fi
 fi
 
 
 # Define the identity of the package.
  PACKAGE='collectd'
- VERSION='4.1.2'
+ VERSION='4.1.3'
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -30128,104 +30128,37 @@
 
 
 
 
 
 # AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given])
+librrd_cflags=""
+librrd_ldflags=""
+librrd_threadsafe="yes"
 
 # Check whether --with-rrdtool was given.
 if test "${with_rrdtool+set}" = set; then
   withval=$with_rrdtool; 	if test "x$withval" != "xno" && test "x$withval" != "xyes"
 	then
-		LDFLAGS="$LDFLAGS -L$withval/lib"
-		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		librrd_cflags="-I$withval/include"
+		librrd_ldflags="-L$withval/lib"
 		with_rrdtool="yes"
 	fi
 
 else
   with_rrdtool="yes"
 fi
 
 if test "x$with_rrdtool" = "xyes"
 then
-	{ echo "$as_me:$LINENO: checking for rrd_update in -lrrd" >&5
-echo $ECHO_N "checking for rrd_update in -lrrd... $ECHO_C" >&6; }
-if test "${ac_cv_lib_rrd_rrd_update+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lrrd -lm $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char rrd_update ();
-int
-main ()
-{
-return rrd_update ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_rrd_rrd_update=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cv_lib_rrd_rrd_update=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_rrd_rrd_update" >&5
-echo "${ECHO_T}$ac_cv_lib_rrd_rrd_update" >&6; }
-if test $ac_cv_lib_rrd_rrd_update = yes; then
-
-
-cat >>confdefs.h <<\_ACEOF
-#define HAVE_LIBRRD 1
-_ACEOF
+	SAVE_CFLAGS="$CFLAGS"
+	SAVE_LDFLAGS="$LDFLAGS"
 
+	CFLAGS="$CFLAGS $librrd_cflags"
+	LDFLAGS="$LDFLAGS $librrd_ldflags"
 
-else
-  with_rrdtool="no (librrd not found)"
-fi
-
-fi
-if test "x$with_rrdtool" = "xyes"
-then
 
 for ac_header in rrd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   { echo "$as_me:$LINENO: checking for $ac_header" >&5
@@ -30362,35 +30295,175 @@
 else
   with_rrdtool="no (rrd.h not found)"
 fi
 
 done
 
+
+	CFLAGS="$SAVE_CFLAGS"
+	LDFLAGS="$SAVE_LDFLAGS"
 fi
 if test "x$with_rrdtool" = "xyes"
 then
-	collect_rrdtool=1
+	{ echo "$as_me:$LINENO: checking for rrd_update_r in -lrrd_th" >&5
+echo $ECHO_N "checking for rrd_update_r in -lrrd_th... $ECHO_C" >&6; }
+if test "${ac_cv_lib_rrd_th_rrd_update_r+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lrrd_th  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char rrd_update_r ();
+int
+main ()
+{
+return rrd_update_r ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_rrd_th_rrd_update_r=yes
 else
-	collect_rrdtool=0
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_rrd_th_rrd_update_r=no
 fi
 
-cat >>confdefs.h <<_ACEOF
-#define COLLECT_RRDTOOL $collect_rrdtool
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_rrd_th_rrd_update_r" >&5
+echo "${ECHO_T}$ac_cv_lib_rrd_th_rrd_update_r" >&6; }
+if test $ac_cv_lib_rrd_th_rrd_update_r = yes; then
+  with_rrdtool="yes"
+	 librrd_ldflags="$librrd_ldflags -lrrd_th -lm"
+
+else
+  librrd_threadsafe="no"
+	 { echo "$as_me:$LINENO: checking for rrd_update in -lrrd" >&5
+echo $ECHO_N "checking for rrd_update in -lrrd... $ECHO_C" >&6; }
+if test "${ac_cv_lib_rrd_rrd_update+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lrrd -lm $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
 _ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char rrd_update ();
+int
+main ()
+{
+return rrd_update ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_rrd_rrd_update=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
+	ac_cv_lib_rrd_rrd_update=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_rrd_rrd_update" >&5
+echo "${ECHO_T}$ac_cv_lib_rrd_rrd_update" >&6; }
+if test $ac_cv_lib_rrd_rrd_update = yes; then
+  with_rrdtool="yes"
+	  librrd_ldflags="$librrd_ldflags -lrrd -lm"
 
-if test "x$with_rrdtool" = "xyes"; then
-  BUILD_WITH_RRDTOOL_TRUE=
-  BUILD_WITH_RRDTOOL_FALSE='#'
 else
-  BUILD_WITH_RRDTOOL_TRUE='#'
-  BUILD_WITH_RRDTOOL_FALSE=
+  with_rrdtool="no (symbol 'rrd_update' not found)"
 fi
 
 
+	-lm
+fi
+
+fi
+if test "x$with_rrdtool" = "xyes"
+then
+	BUILD_WITH_LIBRRD_CFLAGS="$librrd_cflags"
+	BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
+
+
+fi
+if test "x$librrd_threadsafe" = "xyes"
+then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_THREADSAFE_LIBRRD 1
+_ACEOF
+
+fi
+
 
 # Check whether --with-libpthread was given.
 if test "${with_libpthread+set}" = set; then
   withval=$with_libpthread; 	if test "x$withval" != "xno" -a "x$withval" != "xyes"
 	then
 		LDFLAGS="$LDFLAGS -L$withval/lib"
@@ -36746,19 +36819,12 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBRESOLV\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_WITH_LIBRESOLV\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
-if test -z "${BUILD_WITH_RRDTOOL_TRUE}" && test -z "${BUILD_WITH_RRDTOOL_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_RRDTOOL\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"BUILD_WITH_RRDTOOL\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
 if test -z "${BUILD_WITH_LIBPTHREAD_TRUE}" && test -z "${BUILD_WITH_LIBPTHREAD_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBPTHREAD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_WITH_LIBPTHREAD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -37515,13 +37581,13 @@
 exec 6>&1
 
 # Save the log message, to keep $[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by collectd $as_me 4.1.2, which was
+This file was extended by collectd $as_me 4.1.3, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -37568,13 +37634,13 @@
 
 Report bugs to <bug-autoconf@gnu.org>."
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-collectd config.status 4.1.2
+collectd config.status 4.1.3
 configured by $0, generated by GNU Autoconf 2.61,
   with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
 Copyright (C) 2006 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
@@ -37908,14 +37974,14 @@
 BUILD_WITH_LIBSOCKET_TRUE!$BUILD_WITH_LIBSOCKET_TRUE$ac_delim
 BUILD_WITH_LIBSOCKET_FALSE!$BUILD_WITH_LIBSOCKET_FALSE$ac_delim
 BUILD_WITH_LIBRT_TRUE!$BUILD_WITH_LIBRT_TRUE$ac_delim
 BUILD_WITH_LIBRT_FALSE!$BUILD_WITH_LIBRT_FALSE$ac_delim
 BUILD_WITH_LIBRESOLV_TRUE!$BUILD_WITH_LIBRESOLV_TRUE$ac_delim
 BUILD_WITH_LIBRESOLV_FALSE!$BUILD_WITH_LIBRESOLV_FALSE$ac_delim
-BUILD_WITH_RRDTOOL_TRUE!$BUILD_WITH_RRDTOOL_TRUE$ac_delim
-BUILD_WITH_RRDTOOL_FALSE!$BUILD_WITH_RRDTOOL_FALSE$ac_delim
+BUILD_WITH_LIBRRD_CFLAGS!$BUILD_WITH_LIBRRD_CFLAGS$ac_delim
+BUILD_WITH_LIBRRD_LDFLAGS!$BUILD_WITH_LIBRRD_LDFLAGS$ac_delim
 BUILD_WITH_LIBPTHREAD_TRUE!$BUILD_WITH_LIBPTHREAD_TRUE$ac_delim
 BUILD_WITH_LIBPTHREAD_FALSE!$BUILD_WITH_LIBPTHREAD_FALSE$ac_delim
 BUILD_WITH_LIBKSTAT_TRUE!$BUILD_WITH_LIBKSTAT_TRUE$ac_delim
 BUILD_WITH_LIBKSTAT_FALSE!$BUILD_WITH_LIBKSTAT_FALSE$ac_delim
 BUILD_WITH_LIBDEVINFO_TRUE!$BUILD_WITH_LIBDEVINFO_TRUE$ac_delim
 BUILD_WITH_LIBDEVINFO_FALSE!$BUILD_WITH_LIBDEVINFO_FALSE$ac_delim
@@ -38944,12 +39010,13 @@
     nfs . . . . . . . . $enable_nfs
     ntpd  . . . . . . . $enable_ntpd
     nut . . . . . . . . $enable_nut
     perl  . . . . . . . $enable_perl
     ping  . . . . . . . $enable_ping
     processes . . . . . $enable_processes
+    rrdtool . . . . . . $enable_rrdtool
     sensors . . . . . . $enable_sensors
     serial  . . . . . . $enable_serial
     snmp  . . . . . . . $enable_snmp
     swap  . . . . . . . $enable_swap
     syslog  . . . . . . $enable_syslog
     tape  . . . . . . . $enable_tape
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/configure.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/configure.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/configure.in	2007-09-28 22:57:44.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/configure.in	2007-10-25 02:57:37.000000000 +0800
@@ -667,41 +667,63 @@
 
 
 m4_divert_once([HELP_WITH], [
 collectd additional packages:])
 
 # AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given])
+librrd_cflags=""
+librrd_ldflags=""
+librrd_threadsafe="yes"
 AC_ARG_WITH(rrdtool, [AS_HELP_STRING([--with-rrdtool@<:@=PREFIX@:>@], [Path to rrdtool.])],
 [	if test "x$withval" != "xno" && test "x$withval" != "xyes"
 	then
-		LDFLAGS="$LDFLAGS -L$withval/lib"
-		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		librrd_cflags="-I$withval/include"
+		librrd_ldflags="-L$withval/lib"
 		with_rrdtool="yes"
 	fi
 ], [with_rrdtool="yes"])
 if test "x$with_rrdtool" = "xyes"
 then
-	AC_CHECK_LIB(rrd, rrd_update,
-	[
-		AC_DEFINE(HAVE_LIBRRD, 1, [Define to 1 if you have the rrd library (-lrrd).])
-	],
-	[with_rrdtool="no (librrd not found)"], [-lm])
+	SAVE_CFLAGS="$CFLAGS"
+	SAVE_LDFLAGS="$LDFLAGS"
+
+	CFLAGS="$CFLAGS $librrd_cflags"
+	LDFLAGS="$LDFLAGS $librrd_ldflags"
+
+	AC_CHECK_HEADERS(rrd.h,, [with_rrdtool="no (rrd.h not found)"])
+
+	CFLAGS="$SAVE_CFLAGS"
+	LDFLAGS="$SAVE_LDFLAGS"
 fi
 if test "x$with_rrdtool" = "xyes"
 then
-	AC_CHECK_HEADERS(rrd.h,, [with_rrdtool="no (rrd.h not found)"])
+	AC_CHECK_LIB(rrd_th, rrd_update_r,
+	[with_rrdtool="yes"
+	 librrd_ldflags="$librrd_ldflags -lrrd_th -lm"
+	],
+	[librrd_threadsafe="no"
+	 AC_CHECK_LIB(rrd, rrd_update,
+	 [with_rrdtool="yes"
+	  librrd_ldflags="$librrd_ldflags -lrrd -lm"
+	 ],
+	 [with_rrdtool="no (symbol 'rrd_update' not found)"],
+	 [-lm])
+	]
+	[-lm])
 fi
 if test "x$with_rrdtool" = "xyes"
 then
-	collect_rrdtool=1
-else
-	collect_rrdtool=0
+	BUILD_WITH_LIBRRD_CFLAGS="$librrd_cflags"
+	BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
+	AC_SUBST(BUILD_WITH_LIBRRD_CFLAGS)
+	AC_SUBST(BUILD_WITH_LIBRRD_LDFLAGS)
+fi
+if test "x$librrd_threadsafe" = "xyes"
+then
+	AC_DEFINE(HAVE_THREADSAFE_LIBRRD, 1, [Define to 1 if you have the threadsafe rrd library (-lrrd_th).])
 fi
-AC_DEFINE_UNQUOTED(COLLECT_RRDTOOL, [$collect_rrdtool],
-	[Wether or not to use rrdtool library])
-AM_CONDITIONAL(BUILD_WITH_RRDTOOL, test "x$with_rrdtool" = "xyes")
 
 AC_ARG_WITH(libpthread, [AS_HELP_STRING([--with-libpthread=@<:@=PREFIX@:>@], [Path to libpthread.])],
 [	if test "x$withval" != "xno" -a "x$withval" != "xyes"
 	then
 		LDFLAGS="$LDFLAGS -L$withval/lib"
 		CPPFLAGS="$CPPFLAGS -I$withval/include"
@@ -1887,12 +1909,13 @@
     nfs . . . . . . . . $enable_nfs
     ntpd  . . . . . . . $enable_ntpd
     nut . . . . . . . . $enable_nut
     perl  . . . . . . . $enable_perl
     ping  . . . . . . . $enable_ping
     processes . . . . . $enable_processes
+    rrdtool . . . . . . $enable_rrdtool
     sensors . . . . . . $enable_sensors
     serial  . . . . . . $enable_serial
     snmp  . . . . . . . $enable_snmp
     swap  . . . . . . . $enable_swap
     syslog  . . . . . . $enable_syslog
     tape  . . . . . . . $enable_tape
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/contrib: examples
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/contrib/PerlLib/Collectd.pm /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/contrib/PerlLib/Collectd.pm
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/contrib/PerlLib/Collectd.pm	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/contrib/PerlLib/Collectd.pm	2007-10-25 02:57:37.000000000 +0800
@@ -41,12 +41,12 @@
 	push @{$EXPORT_TAGS{'all'}}, grep {! $seen{$_}++ } @{$EXPORT_TAGS{$_}}
 		foreach keys %EXPORT_TAGS;
 }
 
 Exporter::export_ok_tags('all');
 
-bootstrap Collectd "4.1.2";
+bootstrap Collectd "4.1.3";
 
 1;
 
 # vim: set sw=4 ts=4 tw=78 noexpandtab :
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/Makefile.in	2007-09-28 22:58:13.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/Makefile.in	2007-10-25 02:58:06.000000000 +0800
@@ -205,12 +205,14 @@
 BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
 BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
+BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
+BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
@@ -227,14 +229,12 @@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
 BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
 BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
-BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
-BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
 COMPILER_IS_GCC_FALSE = @COMPILER_IS_GCC_FALSE@
 COMPILER_IS_GCC_TRUE = @COMPILER_IS_GCC_TRUE@
 CPP = @CPP@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/README	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/README	2007-10-25 02:57:37.000000000 +0800
@@ -215,14 +215,14 @@
     Run `collectd -h' for a list of builtin defaults. See `collectd.conf(5)'
     for a list of options and a syntax description.
 
   * When the `csv' or `rrdtool' plugins are loaded they'll write the values to
     files. The usual place for these files is beneath `/var/lib/collectd'.
 
-  * When using some of the plugins, collectd needs to run as user root, since only
-    root can do certain things, such as craft ICMP packages needed to ping
+  * When using some of the plugins, collectd needs to run as user root, since
+    only root can do certain things, such as craft ICMP packages needed to ping
     other hosts. collectd should NOT be installed setuid root since it can be
     used to overwrite valuable files!
 
   * Sample scripts to generate graphs reside in `contrib/' in the source
     package or somewhere near `/usr/share/doc/collectd' in most distributions.
     Please be aware that those script are meant as a starting point for your
@@ -233,12 +233,23 @@
   * The RRAs of the automatically created RRD files depend on the `step'
     and `heartbeat' settings given. If change these settings you may need to
     re-create the files, losing all data. Please be aware of that when changing
     the values and read the rrdtool(1) manpage thoroughly.
 
 
+collectd and chkrootkit
+-----------------------
+
+  If you are using the `dns' plugin chkrootkit(1) will report collectd as a
+  packet sniffer ("<iface>: PACKET SNIFFER(/usr/sbin/collectd[<pid>])"). The
+  plugin captures all UDP packets on port 53 to analyze the DNS traffic. In
+  this case, collectd is a legitimate sniffer and the report should be
+  considered to be a false positive. However, you might want to check that
+  this really is collectd and not some other, illegitimate sniffer.
+
+
 Prerequisites
 -------------
 
   To compile collectd from source you will need:
 
   * Usual suspects: C compiler, linker, preprocessor, make, ...
@@ -295,26 +306,26 @@
     particular.
 
 
 Crosscompiling
 --------------
 
-    To compile correctly collectd needs to be able to initialize static
-    variables to NAN (Not A Number). Some C libraries, especially the GNU
-    libc, have a problem with that.
-
-    Luckily, with GCC it's possible to work around that problem: One can define
-    NAN as being (0.0 / 0.0) and `isnan' as `f != f'. However, to test this
-    ``implementation'' the configure script needs to compile and run a short
-    test program. Obviously running a test program when doing a cross-
-    compilation is, well, challenging.
-
-    If you run into this problem, you can use the `--with-nan-emulation'
-    configure option to force the use of this implementation. We can't promise
-    that the compiled binary actually behaves as it should, but since NANs
-    are likely never passed to the libm you have a good chance to be lucky.
+  To compile correctly collectd needs to be able to initialize static
+  variables to NAN (Not A Number). Some C libraries, especially the GNU
+  libc, have a problem with that.
+
+  Luckily, with GCC it's possible to work around that problem: One can define
+  NAN as being (0.0 / 0.0) and `isnan' as `f != f'. However, to test this
+  ``implementation'' the configure script needs to compile and run a short
+  test program. Obviously running a test program when doing a cross-
+  compilation is, well, challenging.
+
+  If you run into this problem, you can use the `--with-nan-emulation'
+  configure option to force the use of this implementation. We can't promise
+  that the compiled binary actually behaves as it should, but since NANs
+  are likely never passed to the libm you have a good chance to be lucky.
 
 
 Contact
 -------
 
   For questions, bugreports, development information and basically all other
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.1	2007-09-28 23:02:07.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.1	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD 1"
-.TH COLLECTD 1 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD 1 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd \- System statistics collection daemon
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.conf.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.conf.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.conf.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.conf.5	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD.CONF 5"
-.TH COLLECTD.CONF 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD.CONF 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd.conf \- Configuration for the system statistics collection daemon \fBcollectd\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 3
 \&  BaseDir "/path/to/data/"
@@ -270,13 +270,13 @@
 installed and an \*(L"cpu governor\*(R" (that's a kernel module) is loaded.
 .ie n .Sh "Plugin ""csv"""
 .el .Sh "Plugin \f(CWcsv\fP"
 .IX Subsection "Plugin csv"
 .IP "\fBDataDir\fR \fIDirectory\fR" 4
 .IX Item "DataDir Directory"
-Set the directory to store RRD-files under. Per default RRD-files are generated
+Set the directory to store CSV-files under. Per default CSV-files are generated
 beneath the daemon's working directory, i.\ e. the \fBBaseDir\fR.
 .ie n .Sh "Plugin ""df"""
 .el .Sh "Plugin \f(CWdf\fP"
 .IX Subsection "Plugin df"
 .IP "\fBDevice\fR \fIDevice\fR" 4
 .IX Item "Device Device"
@@ -444,13 +444,13 @@
 .ie n .Sh "Plugin ""mysql"""
 .el .Sh "Plugin \f(CWmysql\fP"
 .IX Subsection "Plugin mysql"
 The \f(CW\*(C`mysql plugin\*(C'\fR requires \fBmysqlclient\fR to be installed. It connects to the
 database when started and keeps the connection up as long as possible. When the
 connection is interrupted for whatever reason it will try to re\-connect. The
-plugin logs loud complaints in case anything goes wrong.
+plugin will complaint loudly in case anything goes wrong.
 .PP
 This plugin issues \f(CW\*(C`SHOW STATUS\*(C'\fR and evaluates \f(CW\*(C`Bytes_{received,sent}\*(C'\fR,
 \&\f(CW\*(C`Com_*\*(C'\fR and \f(CW\*(C`Handler_*\*(C'\fR which correspond to \fImysql_octets.rrd\fR,
 \&\fImysql_commands\-*.rrd\fR and \fImysql_handler\-*.rrd\fR. Also, the values of
 \&\f(CW\*(C`Qcache_*\*(C'\fR are put in \fImysql_qcache.rrd\fR and values of \f(CW\*(C`Threads_*\*(C'\fR are put
 in \fImysql_threads.rrd\fR. Please refer to the \fBMySQL reference manual\fR,
@@ -660,20 +660,23 @@
 .IP "\fBDataDir\fR \fIDirectory\fR" 4
 .IX Item "DataDir Directory"
 Set the directory to store RRD-files under. Per default RRD-files are generated
 beneath the daemon's working directory, i.\ e. the \fBBaseDir\fR.
 .IP "\fBStepSize\fR \fISeconds\fR" 4
 .IX Item "StepSize Seconds"
-Sets the stepsize of newly created RRD\-files. Ideally (and per default) this
-setting is identical to the global \fBInterval\fR\-option and should not be
-smaller. If unsure, don't set this option.
+\&\fBForce\fR the stepsize of newly created RRD\-files. Ideally (and per default)
+this setting is unset and the stepsize is set to the interval in which the data
+is collected. Do not use this option unless you absolutely have to for some
+reason. Setting this option may cause problems with the \f(CW\*(C`snmp plugin\*(C'\fR, the
+\&\f(CW\*(C`exec plugin\*(C'\fR or when the daemon is set up to receive data from other hosts.
 .IP "\fBHeartBeat\fR \fISeconds\fR" 4
 .IX Item "HeartBeat Seconds"
-Sets the heartbeat of newly created RRD\-files. Ideally this setting is bigger
-than the \fBInterval\fR\-setting, by default it's twice the \fBInterval\fR\-setting. If
-unsure, don't set this option.
+\&\fBForce\fR the heartbeat of newly created RRD\-files. This setting should be unset
+in which case the heartbeat is set to twice the \fBStepSize\fR which should equal
+the interval in which data is collected. Do not set this option unless you have
+a very good reason to do so.
 .IP "\fBRRARows\fR \fINumRows\fR" 4
 .IX Item "RRARows NumRows"
 The \f(CW\*(C`rrdtool plugin\*(C'\fR calculates the number of PDPs per \s-1CDP\s0 based on the
 \&\fBStepSize\fR, this setting and a timespan. This plugin creates RRD-files with
 three times five RRAs, i. e. five RRAs with the CFs \fB\s-1MIN\s0\fR, \fB\s-1AVERAGE\s0\fR, and
 \&\fB\s-1MAX\s0\fR. The five RRAs are optimized for graphs covering one hour, one day, one
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.conf.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.conf.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd.conf.in	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd.conf.in	2007-10-25 02:57:37.000000000 +0800
@@ -174,16 +174,12 @@
 #<Plugin processes>
 #	Process "name"
 #</Plugin>
 
 #<Plugin rrdtool>
 #	DataDir "@prefix@/var/lib/@PACKAGE_NAME@/rrd"
-#	StepSize      10
-#	HeartBeat     20
-#	RRARows     1200
-#	XFF            0.1
 #	CacheTimeout 120
 #	CacheFlush   900
 #</Plugin>
 
 #<Plugin sensors>
 #	Sensor "it8712-isa-0290/temperature-temp1"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-email.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-email.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-email.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-email.5	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EMAIL 5"
-.TH COLLECTD-EMAIL 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-EMAIL 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-email \- Documentation of collectd's \f(CW\*(C`email plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-exec.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-exec.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-exec.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-exec.5	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EXEC 5"
-.TH COLLECTD-EXEC 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-EXEC 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-exec \- Documentation of collectd's \f(CW\*(C`exec plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 7
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-nagios.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-nagios.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-nagios.1	2007-09-28 23:02:07.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-nagios.1	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-NAGIOS 1"
-.TH COLLECTD-NAGIOS 1 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-NAGIOS 1 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-nagios \- Nagios plugin for querying collectd
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd-nagios \fB\-s\fR \fIsocket\fR \fB\-n\fR \fIvalue_spec\fR \fB\-H\fR \fIhostname\fR \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-perl.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-perl.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-perl.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-perl.5	2007-10-25 03:05:27.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-PERL 5"
-.TH COLLECTD-PERL 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-PERL 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-perl \- Documentation of collectd's \f(CW\*(C`perl plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-snmp.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-snmp.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-snmp.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-snmp.5	2007-10-25 03:05:28.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-SNMP 5"
-.TH COLLECTD-SNMP 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-SNMP 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-snmp \- Documentation of collectd's \f(CW\*(C`snmp plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 21
 \&  LoadPlugin snmp
@@ -194,12 +194,16 @@
 and ten threads are used.
 .SH "CONFIGURATION"
 .IX Header "CONFIGURATION"
 Since the aim of the \f(CW\*(C`snmp plugin\*(C'\fR is to provide a generic interface to \s-1SNMP\s0,
 it's configuration is not trivial and may take some time.
 .PP
+Since the \f(CW\*(C`Net\-SNMP\*(C'\fR library is used you cann use all the environment
+variables that are interpreted by that package. See \fIsnmpcmd\fR\|(1) for more
+details.
+.PP
 There are two types of blocks that can be contained in the
 \&\f(CW\*(C`<Plugin\ snmp>\*(C'\fR block: \fBData\fR and \fBHost\fR:
 .Sh "The \fBData\fP block"
 .IX Subsection "The Data block"
 The \fBData\fR block defines a list of values or a table of values that are to be
 queried. The following options can be set:
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-unixsock.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-unixsock.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/collectd-unixsock.5	2007-09-28 23:02:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/collectd-unixsock.5	2007-10-25 03:05:28.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-UNIXSOCK 5"
-.TH COLLECTD-UNIXSOCK 5 "2007-09-28" "4.1.2" "collectd"
+.TH COLLECTD-UNIXSOCK 5 "2007-10-24" "4.1.3" "collectd"
 .SH "NAME"
 collectd\-unixsock \- Documentation of collectd's \f(CW\*(C`unixsock plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/config.h.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/config.h.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/config.h.in	2007-09-28 23:01:03.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/config.h.in	2007-10-25 03:01:27.000000000 +0800
@@ -18,15 +18,12 @@
 /* Wether or not to use statgrab library */
 #undef COLLECT_LIBSTATGRAB
 
 /* Wether or not to use sensors library */
 #undef COLLECT_LM_SENSORS
 
-/* Wether or not to use rrdtool library */
-#undef COLLECT_RRDTOOL
-
 /* Define to 1 if you have the <arpa/inet.h> header file. */
 #undef HAVE_ARPA_INET_H
 
 /* Define to 1 if you have the <arpa/nameser_compat.h> header file. */
 #undef HAVE_ARPA_NAMESER_COMPAT_H
 
@@ -193,15 +190,12 @@
 /* Wether or not to use pthread (POSIX threads) library */
 #undef HAVE_LIBPTHREAD
 
 /* Define to 1 if you have the 'resolv' library (-lresolv). */
 #undef HAVE_LIBRESOLV
 
-/* Define to 1 if you have the rrd library (-lrrd). */
-#undef HAVE_LIBRRD
-
 /* Define to 1 if you have the sensors library (-lsensors). */
 #undef HAVE_LIBSENSORS
 
 /* Define to 1 if you have the 'xmms' library (-lxmms). */
 #undef HAVE_LIBXMMS
 
@@ -738,12 +732,15 @@
 /* True if the enum-member TCA_STATS2 exists */
 #undef HAVE_TCA_STATS2
 
 /* Define to 1 if you have the <termios.h> header file. */
 #undef HAVE_TERMIOS_H
 
+/* Define to 1 if you have the threadsafe rrd library (-lrrd_th). */
+#undef HAVE_THREADSAFE_LIBRRD
+
 /* Define to 1 if you have the `thread_info' function. */
 #undef HAVE_THREAD_INFO
 
 /* Define if the function getmntent exists and takes two arguments. */
 #undef HAVE_TWO_GETMNTENT
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/liboconfig/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/liboconfig/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/liboconfig/Makefile.in	2007-09-28 22:58:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/liboconfig/Makefile.in	2007-10-25 02:58:06.000000000 +0800
@@ -205,12 +205,14 @@
 BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
 BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
+BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
+BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
@@ -227,14 +229,12 @@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
 BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
 BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
-BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
-BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
 COMPILER_IS_GCC_FALSE = @COMPILER_IS_GCC_FALSE@
 COMPILER_IS_GCC_TRUE = @COMPILER_IS_GCC_TRUE@
 CPP = @CPP@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/liboping/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/liboping/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/liboping/Makefile.in	2007-09-28 22:58:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/liboping/Makefile.in	2007-10-25 02:58:06.000000000 +0800
@@ -201,12 +201,14 @@
 BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
 BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
+BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
+BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
@@ -223,14 +225,12 @@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
 BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
 BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
-BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
-BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
 COMPILER_IS_GCC_FALSE = @COMPILER_IS_GCC_FALSE@
 COMPILER_IS_GCC_TRUE = @COMPILER_IS_GCC_TRUE@
 CPP = @CPP@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/Makefile.am	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/Makefile.am	2007-10-25 02:57:37.000000000 +0800
@@ -435,13 +435,15 @@
 collectd_DEPENDENCIES += processes.la
 endif
 
 if BUILD_PLUGIN_RRDTOOL
 pkglib_LTLIBRARIES += rrdtool.la
 rrdtool_la_SOURCES = rrdtool.c
-rrdtool_la_LDFLAGS = -module -avoid-version -lrrd
+rrdtool_la_LDFLAGS = -module -avoid-version
+rrdtool_la_CFLAGS = $(BUILD_WITH_LIBRRD_CFLAGS)
+rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
 collectd_LDADD += "-dlopen" rrdtool.la
 collectd_DEPENDENCIES += rrdtool.la
 endif
 
 if BUILD_PLUGIN_SENSORS
 pkglib_LTLIBRARIES += sensors.la
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/Makefile.in	2007-09-28 22:58:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/Makefile.in	2007-10-25 02:58:05.000000000 +0800
@@ -413,15 +413,17 @@
 processes_la_LIBADD =
 am__processes_la_SOURCES_DIST = processes.c
 @BUILD_PLUGIN_PROCESSES_TRUE@am_processes_la_OBJECTS = processes.lo
 processes_la_OBJECTS = $(am_processes_la_OBJECTS)
 @BUILD_PLUGIN_PROCESSES_TRUE@am_processes_la_rpath = -rpath \
 @BUILD_PLUGIN_PROCESSES_TRUE@	$(pkglibdir)
-rrdtool_la_LIBADD =
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_DEPENDENCIES =  \
+@BUILD_PLUGIN_RRDTOOL_TRUE@	$(am__DEPENDENCIES_1)
 am__rrdtool_la_SOURCES_DIST = rrdtool.c
-@BUILD_PLUGIN_RRDTOOL_TRUE@am_rrdtool_la_OBJECTS = rrdtool.lo
+@BUILD_PLUGIN_RRDTOOL_TRUE@am_rrdtool_la_OBJECTS =  \
+@BUILD_PLUGIN_RRDTOOL_TRUE@	rrdtool_la-rrdtool.lo
 rrdtool_la_OBJECTS = $(am_rrdtool_la_OBJECTS)
 @BUILD_PLUGIN_RRDTOOL_TRUE@am_rrdtool_la_rpath = -rpath $(pkglibdir)
 sensors_la_LIBADD =
 am__sensors_la_SOURCES_DIST = sensors.c
 @BUILD_PLUGIN_SENSORS_TRUE@am_sensors_la_OBJECTS = sensors.lo
 sensors_la_OBJECTS = $(am_sensors_la_OBJECTS)
@@ -749,12 +751,14 @@
 BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
 BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
+BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
+BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
@@ -771,14 +775,12 @@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
 BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
 BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
-BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
-BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
 COMPILER_IS_GCC_FALSE = @COMPILER_IS_GCC_FALSE@
 COMPILER_IS_GCC_TRUE = @COMPILER_IS_GCC_TRUE@
 CPP = @CPP@
@@ -1046,13 +1048,15 @@
 @BUILD_PLUGIN_PING_TRUE@	$(am__append_136)
 @BUILD_PLUGIN_PING_TRUE@@BUILD_WITH_OWN_LIBOPING_TRUE@ping_la_LIBADD = liboping/liboping.la
 @BUILD_PLUGIN_PING_TRUE@@BUILD_WITH_OWN_LIBOPING_TRUE@ping_la_DEPENDENCIES = liboping/liboping.la
 @BUILD_PLUGIN_PROCESSES_TRUE@processes_la_SOURCES = processes.c
 @BUILD_PLUGIN_PROCESSES_TRUE@processes_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_SOURCES = rrdtool.c
-@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LDFLAGS = -module -avoid-version -lrrd
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LDFLAGS = -module -avoid-version
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_CFLAGS = $(BUILD_WITH_LIBRRD_CFLAGS)
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_SOURCES = sensors.c
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_LDFLAGS = -module -avoid-version \
 @BUILD_PLUGIN_SENSORS_TRUE@	$(am__append_146)
 @BUILD_PLUGIN_SERIAL_TRUE@serial_la_SOURCES = serial.c
 @BUILD_PLUGIN_SERIAL_TRUE@serial_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_SNMP_TRUE@snmp_la_SOURCES = snmp.c
@@ -1361,13 +1365,13 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/nfs.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ntpd.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/nut_la-nut.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/perl_la-perl.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ping.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/processes.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rrdtool.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rrdtool_la-rrdtool.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/sensors.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/serial.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/snmp_la-snmp.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/swap.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/syslog.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/tape.Plo@am__quote@
@@ -1433,12 +1437,19 @@
 @am__fastdepCC_TRUE@	if $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(perl_la_CFLAGS) $(CFLAGS) -MT perl_la-perl.lo -MD -MP -MF "$(DEPDIR)/perl_la-perl.Tpo" -c -o perl_la-perl.lo `test -f 'perl.c' || echo '$(srcdir)/'`perl.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/perl_la-perl.Tpo" "$(DEPDIR)/perl_la-perl.Plo"; else rm -f "$(DEPDIR)/perl_la-perl.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='perl.c' object='perl_la-perl.lo' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(perl_la_CFLAGS) $(CFLAGS) -c -o perl_la-perl.lo `test -f 'perl.c' || echo '$(srcdir)/'`perl.c
 
+rrdtool_la-rrdtool.lo: rrdtool.c
+@am__fastdepCC_TRUE@	if $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(rrdtool_la_CFLAGS) $(CFLAGS) -MT rrdtool_la-rrdtool.lo -MD -MP -MF "$(DEPDIR)/rrdtool_la-rrdtool.Tpo" -c -o rrdtool_la-rrdtool.lo `test -f 'rrdtool.c' || echo '$(srcdir)/'`rrdtool.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/rrdtool_la-rrdtool.Tpo" "$(DEPDIR)/rrdtool_la-rrdtool.Plo"; else rm -f "$(DEPDIR)/rrdtool_la-rrdtool.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='rrdtool.c' object='rrdtool_la-rrdtool.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(rrdtool_la_CFLAGS) $(CFLAGS) -c -o rrdtool_la-rrdtool.lo `test -f 'rrdtool.c' || echo '$(srcdir)/'`rrdtool.c
+
 snmp_la-snmp.lo: snmp.c
 @am__fastdepCC_TRUE@	if $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(snmp_la_CFLAGS) $(CFLAGS) -MT snmp_la-snmp.lo -MD -MP -MF "$(DEPDIR)/snmp_la-snmp.Tpo" -c -o snmp_la-snmp.lo `test -f 'snmp.c' || echo '$(srcdir)/'`snmp.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/snmp_la-snmp.Tpo" "$(DEPDIR)/snmp_la-snmp.Plo"; else rm -f "$(DEPDIR)/snmp_la-snmp.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='snmp.c' object='snmp_la-snmp.lo' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(snmp_la_CFLAGS) $(CFLAGS) -c -o snmp_la-snmp.lo `test -f 'snmp.c' || echo '$(srcdir)/'`snmp.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/network.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/network.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/network.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/network.c	2007-10-25 01:21:24.000000000 +0800
@@ -1088,74 +1088,62 @@
 	if (strcmp (vl_def->host, vl->host) != 0)
 	{
 		if (write_part_string (&buffer, &buffer_size, TYPE_HOST,
 					vl->host, strlen (vl->host)) != 0)
 			return (-1);
 		strcpy (vl_def->host, vl->host);
-		DEBUG ("network plugin: add_to_buffer: host = %s", vl->host);
 	}
 
 	if (vl_def->time != vl->time)
 	{
 		if (write_part_number (&buffer, &buffer_size, TYPE_TIME,
 					(uint64_t) vl->time))
 			return (-1);
 		vl_def->time = vl->time;
-		DEBUG ("network plugin: add_to_buffer: time = %u",
-				(unsigned int) vl->time);
 	}
 
 	if (vl_def->interval != vl->interval)
 	{
 		if (write_part_number (&buffer, &buffer_size, TYPE_INTERVAL,
 					(uint64_t) vl->interval))
 			return (-1);
 		vl_def->interval = vl->interval;
-		DEBUG ("network plugin: add_to_buffer: interval = %i",
-				(int) vl->interval);
 	}
 
 	if (strcmp (vl_def->plugin, vl->plugin) != 0)
 	{
 		if (write_part_string (&buffer, &buffer_size, TYPE_PLUGIN,
 					vl->plugin, strlen (vl->plugin)) != 0)
 			return (-1);
 		strcpy (vl_def->plugin, vl->plugin);
-		DEBUG ("network plugin: add_to_buffer: plugin = %s",
-				vl->plugin);
 	}
 
 	if (strcmp (vl_def->plugin_instance, vl->plugin_instance) != 0)
 	{
 		if (write_part_string (&buffer, &buffer_size, TYPE_PLUGIN_INSTANCE,
 					vl->plugin_instance,
 					strlen (vl->plugin_instance)) != 0)
 			return (-1);
 		strcpy (vl_def->plugin_instance, vl->plugin_instance);
-		DEBUG ("network plugin: add_to_buffer: plugin_instance = %s",
-				vl->plugin_instance);
 	}
 
 	if (strcmp (type_def, ds->type) != 0)
 	{
 		if (write_part_string (&buffer, &buffer_size, TYPE_TYPE,
 					ds->type, strlen (ds->type)) != 0)
 			return (-1);
 		strcpy (type_def, ds->type);
-		DEBUG ("network plugin: add_to_buffer: type = %s", ds->type);
 	}
 
 	if (strcmp (vl_def->type_instance, vl->type_instance) != 0)
 	{
 		if (write_part_string (&buffer, &buffer_size, TYPE_TYPE_INSTANCE,
 					vl->type_instance,
 					strlen (vl->type_instance)) != 0)
 			return (-1);
 		strcpy (vl_def->type_instance, vl->type_instance);
-		DEBUG ("network plugin: add_to_buffer: type_instance = %s",
-				vl->type_instance);
 	}
 	
 	if (write_part_values (&buffer, &buffer_size, ds, vl) != 0)
 		return (-1);
 
 	return (buffer - buffer_orig);
@@ -1291,24 +1279,23 @@
 	}
 	return (0);
 } /* int network_config */
 
 static int network_shutdown (void)
 {
-	DEBUG ("Shutting down.");
-
 	listen_loop++;
 
 	if (listen_thread != (pthread_t) 0)
 	{
 		pthread_kill (listen_thread, SIGTERM);
 		pthread_join (listen_thread, NULL /* no return value */);
 		listen_thread = (pthread_t) 0;
 	}
 
-	listen_thread = 0;
+	if (send_buffer_fill > 0)
+		flush_buffer ();
 
 	if (cache_tree != NULL)
 	{
 		void *key;
 		void *value;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/processes.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/processes.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/processes.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/processes.c	2007-10-25 01:21:24.000000000 +0800
@@ -600,14 +600,14 @@
 		tasks = NULL;
 	}
 
 	/* Leave the rest at zero if this is only a zombi */
 	if (ps->num_proc == 0)
 	{
-		DEBUG ("This is only a zombi: pid = %i; name = %s;",
-				pid, ps->name);
+		DEBUG ("processes plugin: This is only a zombi: pid = %i; "
+				"name = %s;", pid, ps->name);
 		return (0);
 	}
 
 	cpu_user_counter   = atoll (fields[13]);
 	cpu_system_counter = atoll (fields[14]);
 	vmem_rss = atoll (fields[23]);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/rrdtool.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/rrdtool.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/rrdtool.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/rrdtool.c	2007-10-25 02:57:37.000000000 +0800
@@ -109,12 +109,16 @@
 static rrd_queue_t    *queue_head = NULL;
 static rrd_queue_t    *queue_tail = NULL;
 static pthread_t       queue_thread = 0;
 static pthread_mutex_t queue_lock = PTHREAD_MUTEX_INITIALIZER;
 static pthread_cond_t  queue_cond = PTHREAD_COND_INITIALIZER;
 
+#if !HAVE_THREADSAFE_LIBRRD
+static pthread_mutex_t librrd_lock = PTHREAD_MUTEX_INITIALIZER;
+#endif
+
 static int do_shutdown = 0;
 
 /* * * * * * * * * *
  * WARNING:  Magic *
  * * * * * * * * * */
 
@@ -324,23 +328,157 @@
 	}
 
 	*ret = ds_def;
 	return (ds_num);
 }
 
+#if HAVE_THREADSAFE_LIBRRD
+static int srrd_create (char *filename, unsigned long pdp_step, time_t last_up,
+		int argc, char **argv)
+{
+	int status;
+
+	optind = 0; /* bug in librrd? */
+	rrd_clear_error ();
+
+	status = rrd_create_r (filename, pdp_step, last_up, argc, argv);
+
+	if (status != 0)
+	{
+		WARNING ("rrdtool plugin: rrd_create_r (%s) failed: %s",
+				filename, rrd_get_error ());
+	}
+
+	return (status);
+} /* int srrd_create */
+
+static int srrd_update (char *filename, char *template, int argc, char **argv)
+{
+	int status;
+
+	optind = 0; /* bug in librrd? */
+	rrd_clear_error ();
+
+	status = rrd_update_r (filename, template, argc, argv);
+
+	if (status != 0)
+	{
+		WARNING ("rrdtool plugin: rrd_update_r (%s) failed: %s",
+				filename, rrd_get_error ());
+	}
+
+	return (status);
+} /* int srrd_update */
+/* #endif HAVE_THREADSAFE_LIBRRD */
+
+#else /* !HAVE_THREADSAFE_LIBRRD */
+static int srrd_create (char *filename, unsigned long pdp_step, time_t last_up,
+		int argc, char **argv)
+{
+	int status;
+
+	int new_argc;
+	char **new_argv;
+
+	char pdp_step_str[16];
+	char last_up_str[16];
+
+	new_argc = 6 + argc;
+	new_argv = (char **) malloc ((new_argc + 1) * sizeof (char *));
+	if (new_argv == NULL)
+	{
+		ERROR ("rrdtool plugin: malloc failed.");
+		return (-1);
+	}
+
+	if (last_up == 0)
+		last_up = time (NULL) - 10;
+
+	snprintf (pdp_step_str, sizeof (pdp_step_str), "%lu", pdp_step);
+	pdp_step_str[sizeof (pdp_step_str) - 1] = '\0';
+	snprintf (last_up_str, sizeof (last_up_str), "%u", (unsigned int) last_up);
+	last_up_str[sizeof (last_up_str) - 1] = '\0';
+
+	new_argv[0] = "create";
+	new_argv[1] = filename;
+	new_argv[2] = "-s";
+	new_argv[3] = pdp_step_str;
+	new_argv[4] = "-b";
+	new_argv[5] = last_up_str;
+
+	memcpy (new_argv + 6, argv, argc * sizeof (char *));
+	new_argv[new_argc] = NULL;
+	
+	pthread_mutex_lock (&librrd_lock);
+	optind = 0; /* bug in librrd? */
+	rrd_clear_error ();
+
+	status = rrd_create (new_argc, new_argv);
+	pthread_mutex_unlock (&librrd_lock);
+
+	if (status != 0)
+	{
+		WARNING ("rrdtool plugin: rrd_create (%s) failed: %s",
+				filename, rrd_get_error ());
+	}
+
+	sfree (new_argv);
+
+	return (status);
+} /* int srrd_create */
+
+static int srrd_update (char *filename, char *template, int argc, char **argv)
+{
+	int status;
+
+	int new_argc;
+	char **new_argv;
+
+	assert (template == NULL);
+
+	new_argc = 2 + argc;
+	new_argv = (char **) malloc ((new_argc + 1) * sizeof (char *));
+	if (new_argv == NULL)
+	{
+		ERROR ("rrdtool plugin: malloc failed.");
+		return (-1);
+	}
+
+	new_argv[0] = "update";
+	new_argv[1] = filename;
+
+	memcpy (new_argv + 2, argv, argc * sizeof (char *));
+	new_argv[new_argc] = NULL;
+
+	pthread_mutex_lock (&librrd_lock);
+	optind = 0; /* bug in librrd? */
+	rrd_clear_error ();
+
+	status = rrd_update (new_argc, new_argv);
+	pthread_mutex_unlock (&librrd_lock);
+
+	if (status != 0)
+	{
+		WARNING ("rrdtool plugin: rrd_update_r failed: %s: %s",
+				argv[1], rrd_get_error ());
+	}
+
+	sfree (new_argv);
+
+	return (status);
+} /* int srrd_update */
+#endif /* !HAVE_THREADSAFE_LIBRRD */
+
 static int rrd_create_file (char *filename, const data_set_t *ds, const value_list_t *vl)
 {
 	char **argv;
 	int argc;
 	char **rra_def;
 	int rra_num;
 	char **ds_def;
 	int ds_num;
-	int i, j;
-	char stepsize_str[16];
-	char begin_str[16];
 	int status = 0;
 
 	if (check_create_dir (filename))
 		return (-1);
 
 	if ((rra_num = rra_get (&rra_def, vl)) < 1)
@@ -352,63 +490,31 @@
 	if ((ds_num = ds_get (&ds_def, ds, vl)) < 1)
 	{
 		ERROR ("rrd_create_file failed: Could not calculate DSes");
 		return (-1);
 	}
 
-	argc = ds_num + rra_num + 6;
+	argc = ds_num + rra_num;
 
 	if ((argv = (char **) malloc (sizeof (char *) * (argc + 1))) == NULL)
 	{
 		char errbuf[1024];
 		ERROR ("rrd_create failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 
-	status = snprintf (stepsize_str, sizeof (stepsize_str),
-			"%i", (stepsize > 0) ? stepsize : vl->interval);
-	if ((status < 1) || (status >= sizeof (stepsize_str)))
-	{
-		ERROR ("rrdtool plugin: snprintf failed.");
-		free (argv);
-		ds_free (ds_num, ds_def);
-		rra_free (rra_num, rra_def);
-		return (-1);
-	}
+	memcpy (argv, ds_def, ds_num * sizeof (char *));
+	memcpy (argv + ds_num, rra_def, rra_num * sizeof (char *));
+	argv[ds_num + rra_num] = NULL;
 
 	assert (vl->time > 10);
-	status = snprintf (begin_str, sizeof (begin_str),
-			"%llu", (unsigned long long) (vl->time - 10));
-	if ((status < 1) || (status >= sizeof (begin_str)))
-	{
-		ERROR ("rrdtool plugin: snprintf failed.");
-		return (-1);
-	}
-
-	argv[0] = "create";
-	argv[1] = filename;
-	argv[2] = "-b";
-	argv[3] = begin_str;
-	argv[4] = "-s";
-	argv[5] = stepsize_str;
-
-	j = 6;
-	for (i = 0; i < ds_num; i++)
-		argv[j++] = ds_def[i];
-	for (i = 0; i < rra_num; i++)
-		argv[j++] = rra_def[i];
-	argv[j] = NULL;
-
-	optind = 0; /* bug in librrd? */
-	rrd_clear_error ();
-	if (rrd_create (argc, argv) == -1)
-	{
-		ERROR ("rrd_create failed: %s: %s", filename, rrd_get_error ());
-		status = -1;
-	}
+	status = srrd_create (filename,
+			(stepsize > 0) ? stepsize : vl->interval,
+			vl->time - 10,
+			argc, argv);
 
 	free (argv);
 	ds_free (ds_num, ds_def);
 	rra_free (rra_num, rra_def);
 
 	return (status);
@@ -491,48 +597,12 @@
 		return (-1);
 	offset += status;
 
 	return (0);
 } /* int value_list_to_filename */
 
-static int rrd_write_to_file (char *filename, char **values, int values_num)
-{
-	char **argv;
-	int argc;
-	int status;
-
-	if (values_num < 1)
-		return (0);
-
-	argc = values_num + 2;
-	argv = (char **) malloc ((argc + 1) * sizeof (char *));
-	if (argv == NULL)
-		return (-1);
-
-	argv[0] = "update";
-	argv[1] = filename;
-	memcpy (argv + 2, values, values_num * sizeof (char *));
-	argv[argc] = NULL;
-
-	DEBUG ("rrd_update (argc = %i, argv = %p)", argc, (void *) argv);
-
-	optind = 0; /* bug in librrd? */
-	rrd_clear_error ();
-	status = rrd_update (argc, argv);
-	if (status != 0)
-	{
-		WARNING ("rrd_update failed: %s: %s",
-				filename, rrd_get_error ());
-		status = -1;
-	}
-
-	sfree (argv);
-
-	return (status);
-} /* int rrd_write_cache_entry */
-
 static void *rrd_queue_thread (void *data)
 {
 	while (42)
 	{
 		rrd_queue_t *queue_entry;
 		rrd_cache_t *cache_entry;
@@ -578,13 +648,13 @@
 		cache_entry->values_num = 0;
 		cache_entry->flags = FLAG_NONE;
 
 		pthread_mutex_unlock (&cache_lock);
 
 		/* Write the values to the RRD-file */
-		rrd_write_to_file (queue_entry->filename, values, values_num);
+		srrd_update (queue_entry->filename, NULL, values_num, values);
 
 		for (i = 0; i < values_num; i++)
 		{
 			sfree (values[i]);
 		}
 		sfree (values);
@@ -641,22 +711,20 @@
 	int    keys_num = 0;
 
 	char *key;
 	avl_iterator_t *iter;
 	int i;
 
-	DEBUG ("Flushing cache, timeout = %i", timeout);
+	DEBUG ("rrdtool plugin: Flushing cache, timeout = %i", timeout);
 
 	now = time (NULL);
 
 	/* Build a list of entries to be flushed */
 	iter = avl_get_iterator (cache);
 	while (avl_iterator_next (iter, (void *) &key, (void *) &rc) == 0)
 	{
-		DEBUG ("key = %s; age = %i;", key, now - rc->first_value);
-
 		if (rc->flags == FLAG_QUEUED)
 			continue;
 		else if ((now - rc->first_value) < timeout)
 			continue;
 		else if (rc->values_num > 0)
 		{
@@ -684,26 +752,25 @@
 	avl_iterator_destroy (iter);
 	
 	for (i = 0; i < keys_num; i++)
 	{
 		if (avl_remove (cache, keys[i], (void *) &key, (void *) &rc) != 0)
 		{
-			DEBUG ("avl_remove (%s) failed.", keys[i]);
+			DEBUG ("rrdtool plugin: avl_remove (%s) failed.", keys[i]);
 			continue;
 		}
 
 		assert (rc->values == NULL);
 		assert (rc->values_num == 0);
 
 		sfree (rc);
 		sfree (key);
 		keys[i] = NULL;
 	} /* for (i = 0..keys_num) */
 
 	free (keys);
-	DEBUG ("Flushed %i value(s)", keys_num);
 
 	cache_flush_last = now;
 } /* void rrd_cache_flush */
 
 static int rrd_cache_insert (const char *filename,
 		const char *value, time_t value_time)
@@ -787,14 +854,16 @@
 			return (-1);
 		}
 
 		avl_insert (cache, cache_key, rc);
 	}
 
-	DEBUG ("rrd_cache_insert (%s, %s, %u) = %p", filename, value,
-			(unsigned int) value_time, (void *) rc);
+	DEBUG ("rrdtool plugin: rrd_cache_insert: file = %s; "
+			"values_num = %i; age = %u;",
+			filename, rc->values_num,
+			rc->last_value - rc->first_value);
 
 	if ((rc->last_value - rc->first_value) >= cache_timeout)
 	{
 		/* XXX: If you need to lock both, cache_lock and queue_lock, at
 		 * the same time, ALWAYS lock `cache_lock' first! */
 		if (rc->flags != FLAG_QUEUED)
@@ -979,12 +1048,20 @@
 static int rrd_shutdown (void)
 {
 	pthread_mutex_lock (&cache_lock);
 	rrd_cache_flush (-1);
 	pthread_mutex_unlock (&cache_lock);
 
+	/* Wait for all the values to be written to disk before returning. */
+	if (queue_thread != 0)
+	{
+		pthread_join (queue_thread, NULL);
+		queue_thread = 0;
+		DEBUG ("rrdtool plugin: queue_thread exited.");
+	}
+
 	pthread_mutex_lock (&queue_lock);
 	do_shutdown = 1;
 	pthread_cond_signal (&queue_cond);
 	pthread_mutex_unlock (&queue_lock);
 
 	return (0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/snmp.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/snmp.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/snmp.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/snmp.c	2007-10-25 02:57:37.000000000 +0800
@@ -61,22 +61,22 @@
 {
   char *name;
   char *address;
   char *community;
   int version;
   void *sess_handle;
-  int16_t skip_num;
-  int16_t skip_left;
+  uint32_t interval;
+  time_t next_update;
   data_definition_t **data_list;
   int data_list_len;
-  enum          /****************************************************/
-  {             /* This host..                                      */
-    STATE_IDLE, /* - just sits there until `skip_left < interval_g' */
-    STATE_WAIT, /* - waits to be queried.                           */
-    STATE_BUSY  /* - is currently being queried.                    */
-  } state;      /****************************************************/
+  enum          /******************************************************/
+  {             /* This host..                                        */
+    STATE_IDLE, /* - just sits there until `next_update < interval_g' */
+    STATE_WAIT, /* - waits to be queried.                             */
+    STATE_BUSY  /* - is currently being queried.                      */
+  } state;      /******************************************************/
   struct host_definition_s *next;
 };
 typedef struct host_definition_s host_definition_t;
 
 /* These two types are used to cache values in `csnmp_read_table' to handle
  * gaps in tables. */
@@ -453,25 +453,22 @@
 
   return (0);
 } /* int csnmp_config_add_host_collect */
 
 static int csnmp_config_add_host_interval (host_definition_t *hd, oconfig_item_t *ci)
 {
-  int interval;
-
   if ((ci->values_num != 1)
       || (ci->values[0].type != OCONFIG_TYPE_NUMBER))
   {
     WARNING ("snmp plugin: The `Interval' config option needs exactly one number argument.");
     return (-1);
   }
 
-  interval = (int) ci->values[0].value.number;
-  hd->skip_num = interval;
-  if (hd->skip_num < 0)
-    hd->skip_num = 0;
+  hd->interval = (int) ci->values[0].value.number;
+  if (hd->interval < 0)
+    hd->interval = 0;
 
   return (0);
 } /* int csnmp_config_add_host_interval */
 
 static int csnmp_config_add_host (oconfig_item_t *ci)
 {
@@ -496,14 +493,14 @@
   {
     free (hd);
     return (-1);
   }
 
   hd->sess_handle = NULL;
-  hd->skip_num = 0;
-  hd->skip_left = 0;
+  hd->interval = 0;
+  hd->next_update = 0;
   hd->state = STATE_IDLE;
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
     status = 0;
@@ -725,13 +722,13 @@
   }
 
   strncpy (vl.host, host->name, sizeof (vl.host));
   vl.host[sizeof (vl.host) - 1] = '\0';
   strcpy (vl.plugin, "snmp");
 
-  vl.interval = host->skip_num;
+  vl.interval = host->interval;
   vl.time = time (NULL);
 
   for (instance_list_ptr = instance_list;
       instance_list_ptr != NULL;
       instance_list_ptr = instance_list_ptr->next)
   {
@@ -1069,13 +1066,13 @@
   strncpy (vl.host, host->name, sizeof (vl.host));
   vl.host[sizeof (vl.host) - 1] = '\0';
   strcpy (vl.plugin, "snmp");
   strncpy (vl.type_instance, data->instance.string, sizeof (vl.type_instance));
   vl.type_instance[sizeof (vl.type_instance) - 1] = '\0';
 
-  vl.interval = host->skip_num;
+  vl.interval = host->interval;
 
   req = snmp_pdu_create (SNMP_MSG_GET);
   if (req == NULL)
   {
     ERROR ("snmp plugin: snmp_pdu_create failed.");
     sfree (vl.values);
@@ -1100,16 +1097,18 @@
   }
 
   vl.time = time (NULL);
 
   for (vb = res->variables; vb != NULL; vb = vb->next_variable)
   {
+#if COLLECT_DEBUG
     char buffer[1024];
     snprint_variable (buffer, sizeof (buffer),
 	vb->name, vb->name_length, vb);
     DEBUG ("snmp plugin: Got this variable: %s", buffer);
+#endif /* COLLECT_DEBUG */
 
     for (i = 0; i < data->values_len; i++)
       if (snmp_oid_compare (data->values[i].oid, data->values[i].oid_len,
 	    vb->name, vb->name_length) == 0)
 	vl.values[i] = csnmp_value_list_to_value (vb, ds->ds[i].type);
   } /* for (res->variables) */
@@ -1123,14 +1122,18 @@
   return (0);
 } /* int csnmp_read_value */
 
 static int csnmp_read_host (host_definition_t *host)
 {
   int i;
+  time_t time_start;
+  time_t time_end;
 
-  DEBUG ("snmp plugin: csnmp_read_host (%s);", host->name);
+  time_start = time (NULL);
+  DEBUG ("snmp plugin: csnmp_read_host (%s) started at %u;", host->name,
+      (unsigned int) time_start);
 
   if (host->sess_handle == NULL)
     csnmp_host_open_session (host);
 
   if (host->sess_handle == NULL)
     return (-1);
@@ -1142,12 +1145,22 @@
     if (data->is_table)
       csnmp_read_table (host, data);
     else
       csnmp_read_value (host, data);
   }
 
+  time_end = time (NULL);
+  DEBUG ("snmp plugin: csnmp_read_host (%s) finished at %u;", host->name,
+      (unsigned int) time_end);
+  if ((time_end - time_start) > host->interval)
+  {
+    WARNING ("snmp plugin: Host `%s' should be queried every %i seconds, "
+	"but reading all values takes %i seconds.",
+	host->name, host->interval, time_end - time_start);
+  }
+
   return (0);
 } /* int csnmp_read_host */
 
 static void *csnmp_read_thread (void *data)
 {
   host_definition_t *host;
@@ -1191,24 +1204,24 @@
   call_snmp_init_once ();
 
   threads_num = 0;
   for (host = host_head; host != NULL; host = host->next)
   {
     threads_num++;
-    /* We need to initialize `skip_num' here, because `interval_g' isn't
+    /* We need to initialize `interval' here, because `interval_g' isn't
      * initialized during `configure'. */
-    host->skip_left = interval_g;
-    if (host->skip_num == 0)
+    host->next_update = time (NULL);
+    if (host->interval == 0)
     {
-      host->skip_num = interval_g;
+      host->interval = interval_g;
     }
-    else if (host->skip_num < interval_g)
+    else if (host->interval < interval_g)
     {
-      host->skip_num = interval_g;
+      host->interval = interval_g;
       WARNING ("snmp plugin: Data for host `%s' will be collected every %i seconds.",
-	  host->name, host->skip_num);
+	  host->name, host->interval);
     }
 
     csnmp_host_open_session (host);
   } /* for (host) */
 
   /* Now start the reading threads */
@@ -1249,19 +1262,18 @@
   pthread_mutex_lock (&host_lock);
   for (host = host_head; host != NULL; host = host->next)
   {
     if (host->state != STATE_IDLE)
       continue;
 
-    host->skip_left -= interval_g;
-    if (host->skip_left >= interval_g)
+    /* Skip this host if the next or a later iteration will be sufficient. */
+    if (host->next_update >= (now + interval_g))
       continue;
 
     host->state = STATE_WAIT;
-
-    host->skip_left = host->skip_num;
+    host->next_update = now + host->interval;
   } /* for (host) */
 
   pthread_cond_broadcast (&host_cond);
   pthread_mutex_unlock (&host_lock);
 
   return (0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/unixsock.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/unixsock.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/unixsock.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/unixsock.c	2007-10-25 01:21:24.000000000 +0800
@@ -620,13 +620,13 @@
 
 	if (us_open_socket () != 0)
 		pthread_exit ((void *) 1);
 
 	while (loop != 0)
 	{
-		DEBUG ("Calling accept..");
+		DEBUG ("unixsock plugin: Calling accept..");
 		status = accept (sock_fd, NULL, NULL);
 		if (status < 0)
 		{
 			char errbuf[1024];
 
 			if (errno == EINTR)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/utils_ignorelist.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/utils_ignorelist.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/utils_ignorelist.c	2007-09-28 19:38:23.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/utils_ignorelist.c	2007-10-25 01:21:24.000000000 +0800
@@ -237,14 +237,12 @@
  */
 void ignorelist_free (ignorelist_t *il)
 {
 	ignorelist_item_t *this;
 	ignorelist_item_t *next;
 
-	DEBUG ("(il = 0x%p)", (void *) il);
-
 	if (il == NULL)
 		return;
 
 	for (this = il->head; this != NULL; this = next)
 	{
 		next = this->next;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/utils_mount.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/utils_mount.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/utils_mount.c	2007-09-28 19:38:23.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/utils_mount.c	2007-10-25 01:21:24.000000000 +0800
@@ -331,13 +331,13 @@
 		uuid[i] = ((fromhex(s[0]) << 4) | fromhex(s[1]));
 		s += 2;
 	}
 	return get_spec_by_x(UUID, uuid);
 
 	bad_uuid:
-		DEBUG("Found an invalid UUID: %s", s);
+		DEBUG("utils_mount: Found an invalid UUID: %s", s);
 	return NULL;
 }
 
 static char *get_spec_by_volume_label(const char *s)
 {
         return get_spec_by_x (VOL, s);
@@ -350,28 +350,28 @@
 	if (optstr == NULL)
 	{
 		return (NULL);
 	}
 	else if (strncmp (optstr, "UUID=", 5) == 0)
 	{
-		DEBUG ("TODO: check UUID= code!");
+		DEBUG ("utils_mount: TODO: check UUID= code!");
 		rc = get_spec_by_uuid (optstr + 5);
 	}
 	else if (strncmp (optstr, "LABEL=", 6) == 0)
 	{
-		DEBUG ("TODO: check LABEL= code!");
+		DEBUG ("utils_mount: TODO: check LABEL= code!");
 		rc = get_spec_by_volume_label (optstr + 6);
 	}
 	else
 	{
 		rc = sstrdup (optstr);
 	}
 
 	if(!rc)
 	{
-		DEBUG ("Error checking device name: optstr = %s", optstr);
+		DEBUG ("utils_mount: Error checking device name: optstr = %s", optstr);
 	}
 	return rc;
 }
 
 /* What weird OS is this..? I can't find any info with google :/ -octo */
 #if HAVE_LISTMNTENT && 0
@@ -381,25 +381,25 @@
 	struct tabmntent *p;
 	struct mntent *mnt;
 
 	struct tabmntent *mntlist;
 	if(listmntent(&mntlist, COLLECTD_MNTTAB, NULL, NULL) < 0) {
 		char errbuf[1024];
-		DEBUG("calling listmntent() failed: %s",
+		DEBUG("utils_mount: calling listmntent() failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 	}
 
 	for(p = mntlist; p; p = p->next) {
 		char *loop = NULL, *device = NULL;
 
 		mnt = p->ment;
 		loop = cu_mount_getoptionvalue(mnt->mnt_opts, "loop=");
 		if(loop == NULL) {   /* no loop= mount */
 			device = get_device_name(mnt->mnt_fsname);
 			if(device == NULL) {
-				DEBUG("can't get devicename for fs (%s) %s (%s)"
+				DEBUG("utils_mount: can't get devicename for fs (%s) %s (%s)"
 					": ignored", mnt->mnt_type,
 					mnt->mnt_dir, mnt->mnt_fsname);
 				continue;
 			}
 		} else {
 			device = loop;
@@ -452,13 +452,13 @@
 	cu_mount_t *new   = NULL;
 
 	/* Get the number of mounted file systems */
 	if ((bufsize = CMD_STATFS (NULL, 0, FLAGS_STATFS)) < 1)
 	{
 		char errbuf[1024];
-		DEBUG ("getv?fsstat failed: %s",
+		DEBUG ("utils_mount: getv?fsstat failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (NULL);
 	}
 
 	if ((buf = (STRUCT_STATFS *) malloc (bufsize * sizeof (STRUCT_STATFS)))
 			== NULL)
@@ -467,13 +467,13 @@
 
 	/* The bufsize needs to be passed in bytes. Really. This is not in the
 	 * manpage.. -octo */
 	if ((num = CMD_STATFS (buf, bufsize * sizeof (STRUCT_STATFS), FLAGS_STATFS)) < 1)
 	{
 		char errbuf[1024];
-		DEBUG ("getv?fsstat failed: %s",
+		DEBUG ("utils_mount: getv?fsstat failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		free (buf);
 		return (NULL);
 	}
 
 	for (i = 0; i < num; i++)
@@ -517,13 +517,13 @@
 	FILE *fp;
 
 	cu_mount_t *first = NULL;
 	cu_mount_t *last  = NULL;
 	cu_mount_t *new   = NULL;
 
-	DEBUG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
+	DEBUG ("utils_mount: (void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
 
 	if ((fp = fopen (COLLECTD_MNTTAB, "r")) == NULL)
 	{
 		char errbuf[1024];
 		ERROR ("fopen (%s): %s", COLLECTD_MNTTAB,
 				sstrerror (errno, errbuf, sizeof (errbuf)));
@@ -574,13 +574,13 @@
 	struct mntent *me;
 
 	cu_mount_t *first = NULL;
 	cu_mount_t *last  = NULL;
 	cu_mount_t *new   = NULL;
 
-	DEBUG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
+	DEBUG ("utils_mount: (void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
 
 	if ((fp = setmntent (COLLECTD_MNTTAB, "r")) == NULL)
 	{
 		char errbuf[1024];
 		ERROR ("setmntent (%s): %s", COLLECTD_MNTTAB,
 				sstrerror (errno, errbuf, sizeof (errbuf)));
@@ -598,13 +598,13 @@
 		new->spec_device = sstrdup (me->mnt_fsname);
 		new->type        = sstrdup (me->mnt_type);
 		new->options     = sstrdup (me->mnt_opts);
 		new->device      = get_device_name (new->options);
 		new->next        = NULL;
 
-		DEBUG ("new = {dir = %s, spec_device = %s, type = %s, options = %s, device = %s}",
+		DEBUG ("utils_mount: new = {dir = %s, spec_device = %s, type = %s, options = %s, device = %s}",
 				new->dir, new->spec_device, new->type, new->options, new->device);
 
 		/* Append to list */
 		if (first == NULL)
 		{
 			first = new;
@@ -616,13 +616,13 @@
 			last       = new;
 		}
 	}
 
 	endmntent (fp);
 
-	DEBUG ("return (0x%p)", (void *) first);
+	DEBUG ("utils_mount: return (0x%p)", (void *) first);
 
 	return (first);
 }
 #endif /* HAVE_ONE_GETMNTENT */
 
 /* *** *** *** ******************************************** *** *** *** */
@@ -679,14 +679,12 @@
 
 void cu_mount_freelist (cu_mount_t *list)
 {
 	cu_mount_t *this;
 	cu_mount_t *next;
 
-	DEBUG ("(list = 0x%p)", (void *) list);
-
 	for (this = list; this != NULL; this = next)
 	{
 		next = this->next;
 
 		sfree (this->dir);
 		sfree (this->spec_device);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/xmms.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/xmms.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.2/src/xmms.c	2007-09-28 22:55:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.3/src/xmms.c	2007-10-25 01:21:25.000000000 +0800
@@ -52,13 +52,13 @@
   if (!xmms_remote_is_running (xmms_session))
     return (0);
 
   xmms_remote_get_info (xmms_session, &rate, &freq, &nch);
 
   if ((freq == 0) || (nch == 0))
-    return (0);
+    return (-1);
 
   cxmms_submit ("bitrate", rate);
   cxmms_submit ("frequency", freq);
 
   return (0);
 } /* int read */
