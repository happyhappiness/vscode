diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/ChangeLog /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/ChangeLog
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/ChangeLog	2007-11-09 04:54:18.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/ChangeLog	2007-12-15 20:08:58.000000000 +0800
@@ -1,6 +1,14 @@
+2007-12-15, Version 4.2.2
+	* nginx plugin: Incorrect comparison of strings lead to a segfault
+	  when using the plugin. Thanks to Saulius Grigaliunas for fixing
+	  this.
+	* logfile plugin: The config option `Timestamp' was handled
+	  incorrectly and basically always active. Thanks to Luke Heberling
+	  for fixing this.
+
 2007-11-08, Version 4.2.1
 	* tcpconns plugin: Don't complain about a missing file if IPv6 is not
 	  enabled on the host.
 	* snmp plugin: Fix a memory leak.
 
 2007-10-27, Version 4.2.0
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/configure	2007-11-09 04:56:05.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/configure	2007-12-15 20:09:32.000000000 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61 for collectd 4.2.1.
+# Generated by GNU Autoconf 2.61 for collectd 4.2.2.
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 # 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
@@ -723,14 +723,14 @@
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
 # Identity of this package.
 PACKAGE_NAME='collectd'
 PACKAGE_TARNAME='collectd'
-PACKAGE_VERSION='4.2.1'
-PACKAGE_STRING='collectd 4.2.1'
+PACKAGE_VERSION='4.2.2'
+PACKAGE_STRING='collectd 4.2.2'
 PACKAGE_BUGREPORT=''
 
 ac_unique_file="src/collectd.c"
 ac_default_prefix="/opt/collectd"
 # Factoring default headers for most tests.
 ac_includes_default="\
@@ -1565,13 +1565,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures collectd 4.2.1 to adapt to many kinds of systems.
+\`configure' configures collectd 4.2.2 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -1635,13 +1635,13 @@
   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of collectd 4.2.1:";;
+     short | recursive ) echo "Configuration of collectd 4.2.2:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
@@ -1825,13 +1825,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-collectd configure 4.2.1
+collectd configure 4.2.2
 generated by GNU Autoconf 2.61
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
@@ -1839,13 +1839,13 @@
   exit
 fi
 cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by collectd $as_me 4.2.1, which was
+It was created by collectd $as_me 4.2.2, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 exec 5>>config.log
@@ -2512,13 +2512,13 @@
   fi
 fi
 
 
 # Define the identity of the package.
  PACKAGE='collectd'
- VERSION='4.2.1'
+ VERSION='4.2.2'
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -38085,13 +38085,13 @@
 exec 6>&1
 
 # Save the log message, to keep $[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by collectd $as_me 4.2.1, which was
+This file was extended by collectd $as_me 4.2.2, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -38138,13 +38138,13 @@
 
 Report bugs to <bug-autoconf@gnu.org>."
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-collectd config.status 4.2.1
+collectd config.status 4.2.2
 configured by $0, generated by GNU Autoconf 2.61,
   with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
 Copyright (C) 2006 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/contrib/collectd2html.pl /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/contrib/collectd2html.pl
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/contrib/collectd2html.pl	2007-10-25 01:21:23.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/contrib/collectd2html.pl	2007-12-15 20:08:58.000000000 +0800
@@ -13,12 +13,15 @@
 #   When run on <host>, it generated <host>.html and <host>.dir, the latter
 #   containing all necessary images.
 #
 #
 # Copyright 2006 Vincent Stehlé <vincent.stehle@free.fr>
 #
+# Patch to configure the data directory and hostname by Eddy Petrisor
+# <eddy.petrisor@gmail.com>.
+#
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
 #
 # This program is distributed in the hope that it will be useful,
@@ -36,23 +39,23 @@
 use strict;
 use Fatal qw(open close);
 use File::Basename;
 use Getopt::Long qw(:config no_ignore_case bundling pass_through);
 
 my $DIR  = "/var/lib/collectd";
-my $HOST = "_UNDEFINED_";
+my $HOST = undef;
 
 GetOptions (
-    "host-is=s"  => \$HOST,
+    "host=s"     => \$HOST,
     "data-dir=s" => \$DIR
 );
 
 my @COLORS = (0xff7777, 0x7777ff, 0x55ff55, 0xffcc77, 0xff77ff, 0x77ffff,
 	0xffff77, 0x55aaff);
 my @tmp = `/bin/hostname`; chomp(@tmp);
-$HOST = $tmp[0] if ( $HOST =~ /_UNDEFINED_/ );
+$HOST = $tmp[0] if (! defined $HOST);
 my $IMG_DIR = "${HOST}.dir";
 my $HTML = "${HOST}.html";
 
 ################################################################################
 #
 # fade_component
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.1	2007-11-09 04:59:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.1	2007-12-15 20:53:06.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD 1"
-.TH COLLECTD 1 "2007-10-24" "4.2.1" "collectd"
+.TH COLLECTD 1 "2007-10-24" "4.2.2" "collectd"
 .SH "NAME"
 collectd \- System statistics collection daemon
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.conf.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.conf.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.conf.5	2007-11-09 04:59:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.conf.5	2007-12-15 20:53:07.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD.CONF 5"
-.TH COLLECTD.CONF 5 "2007-11-08" "4.2.1" "collectd"
+.TH COLLECTD.CONF 5 "2007-12-15" "4.2.2" "collectd"
 .SH "NAME"
 collectd.conf \- Configuration for the system statistics collection daemon \fBcollectd\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 3
 \&  BaseDir "/path/to/data/"
@@ -163,12 +163,16 @@
 \&\fBApache Webserver\fR. Each line contains either a key-value-pair or a
 section-start or \-end. Empty lines and everything after the hash-symbol `#' is
 ignored. Values are either string, enclosed in double\-quotes,
 (floating\-point\-)numbers or a boolean expression, i.\ e. either \fBtrue\fR or
 \&\fBfalse\fR. String containing of only alphanumeric characters and underscores do
 not need to be quoted.
+.PP
+Plugins are loaded in the order listed in this config file. It is a good idea
+to load any logging plugins first in order to catch messages from plugins
+during configuration.
 .SH "GLOBAL OPTIONS"
 .IX Header "GLOBAL OPTIONS"
 .IP "\fBBaseDir\fR \fIDirectory\fR" 4
 .IX Item "BaseDir Directory"
 Sets the base directory. This is the directory beneath all RRD-files are
 created. Possibly more subdirectories are created. This is also the working
@@ -318,13 +322,13 @@
 .IX Subsection "Plugin email"
 .IP "\fBSocketFile\fR \fIPath\fR" 4
 .IX Item "SocketFile Path"
 Sets the socket-file which is to be created.
 .IP "\fBSocketGroup\fR \fIGroup\fR" 4
 .IX Item "SocketGroup Group"
-If running as root change the group of the UNIX-socket after it has been 
+If running as root change the group of the UNIX-socket after it has been
 created. Defaults to \fBcollectd\fR.
 .IP "\fBSocketPerms\fR \fIPermissions\fR" 4
 .IX Item "SocketPerms Permissions"
 Change the file permissions of the UNIX-socket after it has been created. The
 permissions must be given as a numeric, octal value as you would pass to
 \&\fIchmod\fR\|(1). Defaults to \fB0770\fR.
@@ -830,13 +834,13 @@
 .IX Subsection "Plugin unixsock"
 .IP "\fBSocketFile\fR \fIPath\fR" 4
 .IX Item "SocketFile Path"
 Sets the socket-file which is to be created.
 .IP "\fBSocketGroup\fR \fIGroup\fR" 4
 .IX Item "SocketGroup Group"
-If running as root change the group of the UNIX-socket after it has been 
+If running as root change the group of the UNIX-socket after it has been
 created. Defaults to \fBcollectd\fR.
 .IP "\fBSocketPerms\fR \fIPermissions\fR" 4
 .IX Item "SocketPerms Permissions"
 Change the file permissions of the UNIX-socket after it has been created. The
 permissions must be given as a numeric, octal value as you would pass to
 \&\fIchmod\fR\|(1). Defaults to \fB0770\fR.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.conf.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.conf.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd.conf.pod	2007-11-09 01:51:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd.conf.pod	2007-12-15 20:08:58.000000000 +0800
@@ -29,12 +29,16 @@
 section-start or -end. Empty lines and everything after the hash-symbol `#' is
 ignored. Values are either string, enclosed in double-quotes,
 (floating-point-)numbers or a boolean expression, i.E<nbsp>e. either B<true> or
 B<false>. String containing of only alphanumeric characters and underscores do
 not need to be quoted.
 
+Plugins are loaded in the order listed in this config file. It is a good idea
+to load any logging plugins first in order to catch messages from plugins
+during configuration.
+
 =head1 GLOBAL OPTIONS
 
 =over 4
 
 =item B<BaseDir> I<Directory>
 
@@ -226,13 +230,13 @@
 =item B<SocketFile> I<Path>
 
 Sets the socket-file which is to be created.
 
 =item B<SocketGroup> I<Group>
 
-If running as root change the group of the UNIX-socket after it has been 
+If running as root change the group of the UNIX-socket after it has been
 created. Defaults to B<collectd>.
 
 =item B<SocketPerms> I<Permissions>
 
 Change the file permissions of the UNIX-socket after it has been created. The
 permissions must be given as a numeric, octal value as you would pass to
@@ -855,13 +859,13 @@
 =item B<SocketFile> I<Path>
 
 Sets the socket-file which is to be created.
 
 =item B<SocketGroup> I<Group>
 
-If running as root change the group of the UNIX-socket after it has been 
+If running as root change the group of the UNIX-socket after it has been
 created. Defaults to B<collectd>.
 
 =item B<SocketPerms> I<Permissions>
 
 Change the file permissions of the UNIX-socket after it has been created. The
 permissions must be given as a numeric, octal value as you would pass to
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-email.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-email.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-email.5	2007-11-09 04:59:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-email.5	2007-12-15 20:53:07.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EMAIL 5"
-.TH COLLECTD-EMAIL 5 "2007-10-24" "4.2.1" "collectd"
+.TH COLLECTD-EMAIL 5 "2007-10-24" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-email \- Documentation of collectd's \f(CW\*(C`email plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-exec.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-exec.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-exec.5	2007-11-09 04:59:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-exec.5	2007-12-15 20:53:07.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EXEC 5"
-.TH COLLECTD-EXEC 5 "2007-11-08" "4.2.1" "collectd"
+.TH COLLECTD-EXEC 5 "2007-12-15" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-exec \- Documentation of collectd's \f(CW\*(C`exec plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 7
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-nagios.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-nagios.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-nagios.1	2007-11-09 04:59:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-nagios.1	2007-12-15 20:53:07.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-NAGIOS 1"
-.TH COLLECTD-NAGIOS 1 "2007-10-27" "4.2.1" "collectd"
+.TH COLLECTD-NAGIOS 1 "2007-10-27" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-nagios \- Nagios plugin for querying collectd
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd-nagios \fB\-s\fR \fIsocket\fR \fB\-n\fR \fIvalue_spec\fR \fB\-H\fR \fIhostname\fR \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-perl.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-perl.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-perl.5	2007-11-09 04:59:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-perl.5	2007-12-15 20:53:08.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-PERL 5"
-.TH COLLECTD-PERL 5 "2007-11-08" "4.2.1" "collectd"
+.TH COLLECTD-PERL 5 "2007-12-15" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-perl \- Documentation of collectd's \f(CW\*(C`perl plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  LoadPlugin perl
@@ -179,13 +179,13 @@
 .IX Item "IncludeDir Dir"
 Adds \fIDir\fR to the \fB@INC\fR array. This is the same as using the \fB\-IDir\fR
 command line option or \fBuse lib Dir\fR in the source code. Please note that it
 only has effect on plugins loaded after this option.
 .SH "WRITING YOUR OWN PLUGINS"
 .IX Header "WRITING YOUR OWN PLUGINS"
-Writing your own plugins is quite simply. collectd manages plugins by means of
+Writing your own plugins is quite simple. collectd manages plugins by means of
 \&\fBdispatch functions\fR which call the appropriate \fBcallback functions\fR
 registered by the plugins. Any plugin basically consists of the implementation
 of these callback functions and initializing code which registers the
 functions with collectd. See the section \*(L"\s-1EXAMPLES\s0\*(R" below for a really basic
 example. The following types of \fBcallback functions\fR are known to collectd
 (all of these are optional):
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-perl.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-perl.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-perl.pod	2007-11-09 01:51:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-perl.pod	2007-12-15 20:08:58.000000000 +0800
@@ -57,13 +57,13 @@
 only has effect on plugins loaded after this option.
 
 =back
 
 =head1 WRITING YOUR OWN PLUGINS
 
-Writing your own plugins is quite simply. collectd manages plugins by means of
+Writing your own plugins is quite simple. collectd manages plugins by means of
 B<dispatch functions> which call the appropriate B<callback functions>
 registered by the plugins. Any plugin basically consists of the implementation
 of these callback functions and initializing code which registers the
 functions with collectd. See the section "EXAMPLES" below for a really basic
 example. The following types of B<callback functions> are known to collectd
 (all of these are optional):
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-snmp.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-snmp.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-snmp.5	2007-11-09 04:59:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-snmp.5	2007-12-15 20:53:08.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-SNMP 5"
-.TH COLLECTD-SNMP 5 "2007-11-08" "4.2.1" "collectd"
+.TH COLLECTD-SNMP 5 "2007-12-15" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-snmp \- Documentation of collectd's \f(CW\*(C`snmp plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 23
 \&  LoadPlugin snmp
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-unixsock.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-unixsock.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/collectd-unixsock.5	2007-11-09 04:59:40.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/collectd-unixsock.5	2007-12-15 20:53:08.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-UNIXSOCK 5"
-.TH COLLECTD-UNIXSOCK 5 "2007-11-08" "4.2.1" "collectd"
+.TH COLLECTD-UNIXSOCK 5 "2007-12-15" "4.2.2" "collectd"
 .SH "NAME"
 collectd\-unixsock \- Documentation of collectd's \f(CW\*(C`unixsock plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/logfile.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/logfile.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/logfile.c	2007-11-09 01:51:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/logfile.c	2007-12-15 20:08:58.000000000 +0800
@@ -67,13 +67,13 @@
 			return 1;
 	}
 	else if (0 == strcasecmp (key, "File")) {
 		sfree (log_file);
 		log_file = strdup (value);
 	}
-	else if (0 == strcasecmp (key, "File")) {
+	else if (0 == strcasecmp (key, "Timestamp")) {
 		if ((strcasecmp (value, "false") == 0)
 				|| (strcasecmp (value, "no") == 0)
 				|| (strcasecmp (value, "off") == 0))
 			print_timestamp = 0;
 		else
 			print_timestamp = 1;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/network.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/network.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/network.c	2007-10-25 01:21:24.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/network.c	2007-12-15 20:08:58.000000000 +0800
@@ -163,13 +163,13 @@
 static char        *send_buffer_ptr;
 static int          send_buffer_fill;
 static value_list_t send_buffer_vl = VALUE_LIST_STATIC;
 static char         send_buffer_type[DATA_MAX_NAME_LEN];
 static pthread_mutex_t send_buffer_lock = PTHREAD_MUTEX_INITIALIZER;
 
-static avl_tree_t      *cache_tree = NULL;
+static c_avl_tree_t      *cache_tree = NULL;
 static pthread_mutex_t  cache_lock = PTHREAD_MUTEX_INITIALIZER;
 static time_t           cache_flush_last;
 static int              cache_flush_interval = 1800;
 
 /*
  * Private functions
@@ -181,43 +181,43 @@
 
 	char **tmp;
 	int    i;
 
 	char   *key;
 	time_t *value;
-	avl_iterator_t *iter;
+	c_avl_iterator_t *iter;
 
 	time_t curtime = time (NULL);
 
-	iter = avl_get_iterator (cache_tree);
-	while (avl_iterator_next (iter, (void *) &key, (void *) &value) == 0)
+	iter = c_avl_get_iterator (cache_tree);
+	while (c_avl_iterator_next (iter, (void *) &key, (void *) &value) == 0)
 	{
 		if ((curtime - *value) <= cache_flush_interval)
 			continue;
 		tmp = (char **) realloc (keys,
 				(keys_num + 1) * sizeof (char *));
 		if (tmp == NULL)
 		{
 			sfree (keys);
-			avl_iterator_destroy (iter);
+			c_avl_iterator_destroy (iter);
 			ERROR ("network plugin: cache_flush: realloc"
 					" failed.");
 			return (-1);
 		}
 		keys = tmp;
 		keys[keys_num] = key;
 		keys_num++;
-	} /* while (avl_iterator_next) */
-	avl_iterator_destroy (iter);
+	} /* while (c_avl_iterator_next) */
+	c_avl_iterator_destroy (iter);
 
 	for (i = 0; i < keys_num; i++)
 	{
-		if (avl_remove (cache_tree, keys[i], (void *) &key,
+		if (c_avl_remove (cache_tree, keys[i], (void *) &key,
 					(void *) &value) != 0)
 		{
-			WARNING ("network plugin: cache_flush: avl_remove"
+			WARNING ("network plugin: cache_flush: c_avl_remove"
 					" (%s) failed.", keys[i]);
 			continue;
 		}
 
 		sfree (key);
 		sfree (value);
@@ -243,13 +243,13 @@
 	if (format_name (key, sizeof (key), vl->host, vl->plugin,
 				vl->plugin_instance, type, vl->type_instance))
 		return (-1);
 
 	pthread_mutex_lock (&cache_lock);
 
-	if (avl_get (cache_tree, key, (void *) &value) == 0)
+	if (c_avl_get (cache_tree, key, (void *) &value) == 0)
 	{
 		if (*value < vl->time)
 		{
 			*value = vl->time;
 			retval = 0;
 		}
@@ -264,13 +264,13 @@
 	{
 		char *key_copy = strdup (key);
 		value = malloc (sizeof (time_t));
 		if ((key_copy != NULL) && (value != NULL))
 		{
 			*value = vl->time;
-			avl_insert (cache_tree, key_copy, value);
+			c_avl_insert (cache_tree, key_copy, value);
 			retval = 0;
 		}
 		else
 		{
 			sfree (key_copy);
 			sfree (value);
@@ -1296,18 +1296,18 @@
 
 	if (cache_tree != NULL)
 	{
 		void *key;
 		void *value;
 
-		while (avl_pick (cache_tree, &key, &value) == 0)
+		while (c_avl_pick (cache_tree, &key, &value) == 0)
 		{
 			sfree (key);
 			sfree (value);
 		}
-		avl_destroy (cache_tree);
+		c_avl_destroy (cache_tree);
 		cache_tree = NULL;
 	}
 
 	/* TODO: Close `sending_sockets' */
 
 	plugin_unregister_config ("network");
@@ -1324,13 +1324,13 @@
 
 	send_buffer_ptr  = send_buffer;
 	send_buffer_fill = 0;
 	memset (&send_buffer_vl, '\0', sizeof (send_buffer_vl));
 	memset (send_buffer_type, '\0', sizeof (send_buffer_type));
 
-	cache_tree = avl_create ((int (*) (const void *, const void *)) strcmp);
+	cache_tree = c_avl_create ((int (*) (const void *, const void *)) strcmp);
 	cache_flush_last = time (NULL);
 
 	/* setup socket(s) and so on */
 	if (sending_sockets != NULL)
 		plugin_register_write ("network", network_write);
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/nginx.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/nginx.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/nginx.c	2007-11-09 01:51:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/nginx.c	2007-12-15 19:14:39.000000000 +0800
@@ -138,15 +138,15 @@
 
 static void submit (char *type, char *inst, long long value)
 {
   value_t values[1];
   value_list_t vl = VALUE_LIST_INIT;
 
-  if (strcpy (type, "nginx_connections") == 0)
+  if (strcmp (type, "nginx_connections") == 0)
     values[0].gauge = value;
-  else if (strcpy (type, "nginx_requests") == 0)
+  else if (strcmp (type, "nginx_requests") == 0)
     values[0].counter = value;
   else
     return;
 
   vl.values = values;
   vl.values_len = 1;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/rrdtool.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/rrdtool.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/rrdtool.c	2007-11-09 01:51:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/rrdtool.c	2007-12-15 20:08:58.000000000 +0800
@@ -102,13 +102,13 @@
 
 /* XXX: If you need to lock both, cache_lock and queue_lock, at the same time,
  * ALWAYS lock `cache_lock' first! */
 static int         cache_timeout = 0;
 static int         cache_flush_timeout = 0;
 static time_t      cache_flush_last;
-static avl_tree_t *cache = NULL;
+static c_avl_tree_t *cache = NULL;
 static pthread_mutex_t cache_lock = PTHREAD_MUTEX_INITIALIZER;
 
 static rrd_queue_t    *queue_head = NULL;
 static rrd_queue_t    *queue_tail = NULL;
 static pthread_t       queue_thread = 0;
 static pthread_mutex_t queue_lock = PTHREAD_MUTEX_INITIALIZER;
@@ -638,13 +638,13 @@
 		pthread_mutex_unlock (&queue_lock);
 
 		/* We now need the cache lock so the entry isn't updated while
 		 * we make a copy of it's values */
 		pthread_mutex_lock (&cache_lock);
 
-		avl_get (cache, queue_entry->filename, (void *) &cache_entry);
+		c_avl_get (cache, queue_entry->filename, (void *) &cache_entry);
 
 		values = cache_entry->values;
 		values_num = cache_entry->values_num;
 
 		cache_entry->values = NULL;
 		cache_entry->values_num = 0;
@@ -664,13 +664,13 @@
 		sfree (values);
 		sfree (queue_entry->filename);
 		sfree (queue_entry);
 	} /* while (42) */
 
 	pthread_mutex_lock (&cache_lock);
-	avl_destroy (cache);
+	c_avl_destroy (cache);
 	cache = NULL;
 	pthread_mutex_unlock (&cache_lock);
 
 	pthread_exit ((void *) 0);
 	return ((void *) 0);
 } /* void *rrd_queue_thread */
@@ -712,69 +712,71 @@
 	time_t       now;
 
 	char **keys = NULL;
 	int    keys_num = 0;
 
 	char *key;
-	avl_iterator_t *iter;
+	c_avl_iterator_t *iter;
 	int i;
 
 	DEBUG ("rrdtool plugin: Flushing cache, timeout = %i", timeout);
 
 	now = time (NULL);
 
 	/* Build a list of entries to be flushed */
-	iter = avl_get_iterator (cache);
-	while (avl_iterator_next (iter, (void *) &key, (void *) &rc) == 0)
+	iter = c_avl_get_iterator (cache);
+	while (c_avl_iterator_next (iter, (void *) &key, (void *) &rc) == 0)
 	{
 		if (rc->flags == FLAG_QUEUED)
 			continue;
 		else if ((now - rc->first_value) < timeout)
 			continue;
 		else if (rc->values_num > 0)
 		{
 			if (rrd_queue_cache_entry (key) == 0)
 				rc->flags = FLAG_QUEUED;
 		}
 		else /* ancient and no values -> waste of memory */
 		{
-			keys = (char **) realloc ((void *) keys,
+			char **tmp = (char **) realloc ((void *) keys,
 					(keys_num + 1) * sizeof (char *));
-			if (keys == NULL)
+			if (tmp == NULL)
 			{
 				char errbuf[1024];
 				ERROR ("rrdtool plugin: "
 						"realloc failed: %s",
 						sstrerror (errno, errbuf,
 							sizeof (errbuf)));
-				avl_iterator_destroy (iter);
+				c_avl_iterator_destroy (iter);
+				sfree (keys);
 				return;
 			}
+			keys = tmp;
 			keys[keys_num] = key;
 			keys_num++;
 		}
-	} /* while (avl_iterator_next) */
-	avl_iterator_destroy (iter);
+	} /* while (c_avl_iterator_next) */
+	c_avl_iterator_destroy (iter);
 	
 	for (i = 0; i < keys_num; i++)
 	{
-		if (avl_remove (cache, keys[i], (void *) &key, (void *) &rc) != 0)
+		if (c_avl_remove (cache, keys[i], (void *) &key, (void *) &rc) != 0)
 		{
-			DEBUG ("rrdtool plugin: avl_remove (%s) failed.", keys[i]);
+			DEBUG ("rrdtool plugin: c_avl_remove (%s) failed.", keys[i]);
 			continue;
 		}
 
 		assert (rc->values == NULL);
 		assert (rc->values_num == 0);
 
 		sfree (rc);
 		sfree (key);
 		keys[i] = NULL;
 	} /* for (i = 0..keys_num) */
 
-	free (keys);
+	sfree (keys);
 
 	cache_flush_last = now;
 } /* void rrd_cache_flush */
 
 static int rrd_cache_insert (const char *filename,
 		const char *value, time_t value_time)
@@ -782,13 +784,13 @@
 	rrd_cache_t *rc = NULL;
 	int new_rc = 0;
 	char **values_new;
 
 	pthread_mutex_lock (&cache_lock);
 
-	avl_get (cache, filename, (void *) &rc);
+	c_avl_get (cache, filename, (void *) &rc);
 
 	if (rc == NULL)
 	{
 		rc = (rrd_cache_t *) malloc (sizeof (rrd_cache_t));
 		if (rc == NULL)
 			return (-1);
@@ -815,13 +817,13 @@
 	{
 		char errbuf[1024];
 		void *cache_key = NULL;
 
 		sstrerror (errno, errbuf, sizeof (errbuf));
 
-		avl_remove (cache, filename, &cache_key, NULL);
+		c_avl_remove (cache, filename, &cache_key, NULL);
 		pthread_mutex_unlock (&cache_lock);
 
 		ERROR ("rrdtool plugin: realloc failed: %s", errbuf);
 
 		sfree (cache_key);
 		sfree (rc->values);
@@ -855,13 +857,13 @@
 			sfree (rc->values[0]);
 			sfree (rc->values);
 			sfree (rc);
 			return (-1);
 		}
 
-		avl_insert (cache, cache_key, rc);
+		c_avl_insert (cache, cache_key, rc);
 	}
 
 	DEBUG ("rrdtool plugin: rrd_cache_insert: file = %s; "
 			"values_num = %i; age = %u;",
 			filename, rc->values_num,
 			rc->last_value - rc->first_value);
@@ -1094,16 +1096,16 @@
 				"smaller than your `interval'. This will "
 				"create needlessly big RRD-files.");
 
 	/* Set the cache up */
 	pthread_mutex_lock (&cache_lock);
 
-	cache = avl_create ((int (*) (const void *, const void *)) strcmp);
+	cache = c_avl_create ((int (*) (const void *, const void *)) strcmp);
 	if (cache == NULL)
 	{
-		ERROR ("rrdtool plugin: avl_create failed.");
+		ERROR ("rrdtool plugin: c_avl_create failed.");
 		return (-1);
 	}
 
 	cache_flush_last = time (NULL);
 	if (cache_timeout < 2)
 	{
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_avltree.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_avltree.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_avltree.c	2007-10-25 01:21:24.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_avltree.c	2007-12-15 20:08:58.000000000 +0800
@@ -32,41 +32,41 @@
 #define BALANCE(n) ((((n)->left == NULL) ? 0 : (n)->left->height) \
 		- (((n)->right == NULL) ? 0 : (n)->right->height))
 
 /*
  * private data types
  */
-struct avl_node_s
+struct c_avl_node_s
 {
 	void *key;
 	void *value;
 
 	int height;
-	struct avl_node_s *left;
-	struct avl_node_s *right;
-	struct avl_node_s *parent;
+	struct c_avl_node_s *left;
+	struct c_avl_node_s *right;
+	struct c_avl_node_s *parent;
 };
-typedef struct avl_node_s avl_node_t;
+typedef struct c_avl_node_s c_avl_node_t;
 
-struct avl_tree_s
+struct c_avl_tree_s
 {
-	avl_node_t *root;
+	c_avl_node_t *root;
 	int (*compare) (const void *, const void *);
 };
 
-struct avl_iterator_s
+struct c_avl_iterator_s
 {
-	avl_tree_t *tree;
-	avl_node_t *node;
+	c_avl_tree_t *tree;
+	c_avl_node_t *node;
 };
 
 /*
  * private functions
  */
 #if 0
-static void verify_tree (avl_node_t *n)
+static void verify_tree (c_avl_node_t *n)
 {
 	if (n == NULL)
 		return;
 
 	verify_tree (n->left);
 	verify_tree (n->right);
@@ -75,26 +75,26 @@
 	assert ((n->parent == NULL) || (n->parent->right == n) || (n->parent->left == n));
 } /* void verify_tree */
 #else
 # define verify_tree(n) /**/
 #endif
 
-static void free_node (avl_node_t *n)
+static void free_node (c_avl_node_t *n)
 {
 	if (n == NULL)
 		return;
 
 	if (n->left != NULL)
 		free_node (n->left);
 	if (n->right != NULL)
 		free_node (n->right);
 
 	free (n);
 }
 
-static int calc_height (avl_node_t *n)
+static int calc_height (c_avl_node_t *n)
 {
 	int height_left;
 	int height_right;
 
 	if (n == NULL)
 		return (0);
@@ -104,15 +104,15 @@
 
 	return (((height_left > height_right)
 				? height_left
 				: height_right) + 1);
 } /* int calc_height */
 
-static avl_node_t *search (avl_tree_t *t, const void *key)
+static c_avl_node_t *search (c_avl_tree_t *t, const void *key)
 {
-	avl_node_t *n;
+	c_avl_node_t *n;
 	int cmp;
 
 	n = t->root;
 	while (n != NULL)
 	{
 		cmp = t->compare (key, n->key);
@@ -132,17 +132,17 @@
  *     (y)    /\         /\    (x)
  *    /   \  /_c\  ==>  / a\  /   \
  *   /\   /\           /____\/\   /\
  *  / a\ /_b\               /_b\ /_c\
  * /____\
  */
-static avl_node_t *rotate_right (avl_tree_t *t, avl_node_t *x)
+static c_avl_node_t *rotate_right (c_avl_tree_t *t, c_avl_node_t *x)
 {
-	avl_node_t *p;
-	avl_node_t *y;
-	avl_node_t *b;
+	c_avl_node_t *p;
+	c_avl_node_t *y;
+	c_avl_node_t *b;
 
 	p = x->parent;
 	y = x->left;
 	b = y->right;
 
 	x->left = b;
@@ -173,17 +173,17 @@
  *  /\    (y)           (x)    /\
  * /_a\  /   \   ==>   /   \  / c\
  *      /\   /\       /\   /\/____\
  *     /_b\ / c\     /_a\ /_b\
  *         /____\
  */
-static avl_node_t *rotate_left (avl_tree_t *t, avl_node_t *x)
+static c_avl_node_t *rotate_left (c_avl_tree_t *t, c_avl_node_t *x)
 {
-	avl_node_t *p;
-	avl_node_t *y;
-	avl_node_t *b;
+	c_avl_node_t *p;
+	c_avl_node_t *y;
+	c_avl_node_t *b;
 
 	p = x->parent;
 	y = x->right;
 	b = y->left;
 
 	x->right = b;
@@ -205,25 +205,25 @@
 	x->height = calc_height (x);
 	y->height = calc_height (y);
 
 	return (y);
 } /* void rotate_left */
 
-static avl_node_t *rotate_left_right (avl_tree_t *t, avl_node_t *x)
+static c_avl_node_t *rotate_left_right (c_avl_tree_t *t, c_avl_node_t *x)
 {
 	rotate_left (t, x->left);
 	return (rotate_right (t, x));
 } /* void rotate_left_right */
 
-static avl_node_t *rotate_right_left (avl_tree_t *t, avl_node_t *x)
+static c_avl_node_t *rotate_right_left (c_avl_tree_t *t, c_avl_node_t *x)
 {
 	rotate_right (t, x->right);
 	return (rotate_left (t, x));
 } /* void rotate_right_left */
 
-static void rebalance (avl_tree_t *t, avl_node_t *n)
+static void rebalance (c_avl_tree_t *t, c_avl_node_t *n)
 {
 	int b_top;
 	int b_bottom;
 
 	while (n != NULL)
 	{
@@ -261,15 +261,15 @@
 		assert (n->height == calc_height (n));
 
 		n = n->parent;
 	} /* while (n != NULL) */
 } /* void rebalance */
 
-static avl_node_t *avl_node_next (avl_tree_t *t, avl_node_t *n)
+static c_avl_node_t *c_avl_node_next (c_avl_tree_t *t, c_avl_node_t *n)
 {
-	avl_node_t *r; /* return node */
+	c_avl_node_t *r; /* return node */
 
 	if (n == NULL)
 	{
 		return (NULL);
 	}
 
@@ -304,17 +304,17 @@
 		r = n->right;
 		while (r->left != NULL)
 			r = r->left;
 	}
 
 	return (r);
-} /* avl_node_t *avl_node_next */
+} /* c_avl_node_t *c_avl_node_next */
 
-static avl_node_t *avl_node_prev (avl_tree_t *t, avl_node_t *n)
+static c_avl_node_t *c_avl_node_prev (c_avl_tree_t *t, c_avl_node_t *n)
 {
-	avl_node_t *r; /* return node */
+	c_avl_node_t *r; /* return node */
 
 	if (n == NULL)
 	{
 		return (NULL);
 	}
 
@@ -349,31 +349,31 @@
 		r = n->left;
 		while (r->right != NULL)
 			r = r->right;
 	}
 
 	return (r);
-} /* avl_node_t *avl_node_prev */
+} /* c_avl_node_t *c_avl_node_prev */
 
-static int _remove (avl_tree_t *t, avl_node_t *n)
+static int _remove (c_avl_tree_t *t, c_avl_node_t *n)
 {
 	assert ((t != NULL) && (n != NULL));
 
 	if ((n->left != NULL) && (n->right != NULL))
 	{
-		avl_node_t *r; /* replacement node */
+		c_avl_node_t *r; /* replacement node */
 		if (BALANCE (n) > 0) /* left subtree is higher */
 		{
 			assert (n->left != NULL);
-			r = avl_node_prev (t, n);
+			r = c_avl_node_prev (t, n);
 			
 		}
 		else /* right subtree is higher */
 		{
 			assert (n->right != NULL);
-			r = avl_node_next (t, n);
+			r = c_avl_node_next (t, n);
 		}
 
 		assert ((r->left == NULL) || (r->right == NULL));
 
 		/* copy content */
 		n->key   = r->key;
@@ -464,41 +464,41 @@
 	return (0);
 } /* void *_remove */
 
 /*
  * public functions
  */
-avl_tree_t *avl_create (int (*compare) (const void *, const void *))
+c_avl_tree_t *c_avl_create (int (*compare) (const void *, const void *))
 {
-	avl_tree_t *t;
+	c_avl_tree_t *t;
 
 	if (compare == NULL)
 		return (NULL);
 
-	if ((t = (avl_tree_t *) malloc (sizeof (avl_tree_t))) == NULL)
+	if ((t = (c_avl_tree_t *) malloc (sizeof (c_avl_tree_t))) == NULL)
 		return (NULL);
 
 	t->root = NULL;
 	t->compare = compare;
 
 	return (t);
 }
 
-void avl_destroy (avl_tree_t *t)
+void c_avl_destroy (c_avl_tree_t *t)
 {
 	free_node (t->root);
 	free (t);
 }
 
-int avl_insert (avl_tree_t *t, void *key, void *value)
+int c_avl_insert (c_avl_tree_t *t, void *key, void *value)
 {
-	avl_node_t *new;
-	avl_node_t *nptr;
+	c_avl_node_t *new;
+	c_avl_node_t *nptr;
 	int cmp;
 
-	if ((new = (avl_node_t *) malloc (sizeof (avl_node_t))) == NULL)
+	if ((new = (c_avl_node_t *) malloc (sizeof (c_avl_node_t))) == NULL)
 		return (-1);
 
 	new->key = key;
 	new->value = value;
 	new->height = 1;
 	new->left = NULL;
@@ -551,17 +551,17 @@
 			}
 		}
 	} /* while (42) */
 
 	verify_tree (t->root);
 	return (0);
-} /* int avl_insert */
+} /* int c_avl_insert */
 
-int avl_remove (avl_tree_t *t, const void *key, void **rkey, void **rvalue)
+int c_avl_remove (c_avl_tree_t *t, const void *key, void **rkey, void **rvalue)
 {
-	avl_node_t *n;
+	c_avl_node_t *n;
 	int status;
 
 	assert (t != NULL);
 
 	n = search (t, key);
 	if (n == NULL)
@@ -572,33 +572,32 @@
 	if (rvalue != NULL)
 		*rvalue = n->value;
 
 	status = _remove (t, n);
 	verify_tree (t->root);
 	return (status);
-} /* void *avl_remove */
+} /* void *c_avl_remove */
 
-int avl_get (avl_tree_t *t, const void *key, void **value)
+int c_avl_get (c_avl_tree_t *t, const void *key, void **value)
 {
-	avl_node_t *n;
-
-	assert (value != NULL);
+	c_avl_node_t *n;
 
 	n = search (t, key);
 	if (n == NULL)
 		return (-1);
 
-	*value = n->value;
+	if (value != NULL)
+		*value = n->value;
 
 	return (0);
 }
 
-int avl_pick (avl_tree_t *t, void **key, void **value)
+int c_avl_pick (c_avl_tree_t *t, void **key, void **value)
 {
-	avl_node_t *n;
-	avl_node_t *p;
+	c_avl_node_t *n;
+	c_avl_node_t *p;
 
 	if ((key == NULL) || (value == NULL))
 		return (-1);
 	if (t->root == NULL)
 		return (-1);
 
@@ -626,33 +625,33 @@
 	*value = n->value;
 
 	free_node (n);
 	rebalance (t, p);
 
 	return (0);
-} /* int avl_pick */
+} /* int c_avl_pick */
 
-avl_iterator_t *avl_get_iterator (avl_tree_t *t)
+c_avl_iterator_t *c_avl_get_iterator (c_avl_tree_t *t)
 {
-	avl_iterator_t *iter;
+	c_avl_iterator_t *iter;
 
 	if (t == NULL)
 		return (NULL);
 
-	iter = (avl_iterator_t *) malloc (sizeof (avl_iterator_t));
+	iter = (c_avl_iterator_t *) malloc (sizeof (c_avl_iterator_t));
 	if (iter == NULL)
 		return (NULL);
-	memset (iter, '\0', sizeof (avl_iterator_t));
+	memset (iter, '\0', sizeof (c_avl_iterator_t));
 	iter->tree = t;
 
 	return (iter);
-} /* avl_iterator_t *avl_get_iterator */
+} /* c_avl_iterator_t *c_avl_get_iterator */
 
-int avl_iterator_next (avl_iterator_t *iter, void **key, void **value)
+int c_avl_iterator_next (c_avl_iterator_t *iter, void **key, void **value)
 {
-	avl_node_t *n;
+	c_avl_node_t *n;
 
 	if ((iter == NULL) || (key == NULL) || (value == NULL))
 		return (-1);
 
 	if (iter->node == NULL)
 	{
@@ -660,28 +659,28 @@
 			if (n->left == NULL)
 				break;
 		iter->node = n;
 	}
 	else
 	{
-		n = avl_node_next (iter->tree, iter->node);
+		n = c_avl_node_next (iter->tree, iter->node);
 	}
 
 	if (n == NULL)
 		return (-1);
 
 	iter->node = n;
 	*key = n->key;
 	*value = n->value;
 
 	return (0);
-} /* int avl_iterator_next */
+} /* int c_avl_iterator_next */
 
-int avl_iterator_prev (avl_iterator_t *iter, void **key, void **value)
+int c_avl_iterator_prev (c_avl_iterator_t *iter, void **key, void **value)
 {
-	avl_node_t *n;
+	c_avl_node_t *n;
 
 	if ((iter == NULL) || (key == NULL) || (value == NULL))
 		return (-1);
 
 	if (iter->node == NULL)
 	{
@@ -689,23 +688,23 @@
 			if (n->right == NULL)
 				break;
 		iter->node = n;
 	}
 	else
 	{
-		n = avl_node_prev (iter->tree, iter->node);
+		n = c_avl_node_prev (iter->tree, iter->node);
 	}
 
 	if (n == NULL)
 		return (-1);
 
 	iter->node = n;
 	*key = n->key;
 	*value = n->value;
 
 	return (0);
-} /* int avl_iterator_prev */
+} /* int c_avl_iterator_prev */
 
-void avl_iterator_destroy (avl_iterator_t *iter)
+void c_avl_iterator_destroy (c_avl_iterator_t *iter)
 {
 	free (iter);
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_avltree.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_avltree.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_avltree.h	2007-10-25 01:21:24.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_avltree.h	2007-12-15 20:08:58.000000000 +0800
@@ -20,21 +20,21 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #ifndef UTILS_AVLTREE_H
 #define UTILS_AVLTREE_H 1
 
-struct avl_tree_s;
-typedef struct avl_tree_s avl_tree_t;
+struct c_avl_tree_s;
+typedef struct c_avl_tree_s c_avl_tree_t;
 
-struct avl_iterator_s;
-typedef struct avl_iterator_s avl_iterator_t;
+struct c_avl_iterator_s;
+typedef struct c_avl_iterator_s c_avl_iterator_t;
 
 /*
  * NAME
- *   avl_create
+ *   c_avl_create
  *
  * DESCRIPTION
  *   Allocates a new AVL-tree.
  *
  * PARAMETERS
  *   `compare'  The function-pointer `compare' is used to compare two keys. It
@@ -42,30 +42,30 @@
  *              then the second argument, more than zero if the first argument
  *              is bigger than the second argument and zero if they are equal.
  *              If your keys are char-pointers, you can use the `strcmp'
  *              function from the libc here.
  *
  * RETURN VALUE
- *   A avl_tree_t-pointer upon success or NULL upon failure.
+ *   A c_avl_tree_t-pointer upon success or NULL upon failure.
  */
-avl_tree_t *avl_create (int (*compare) (const void *, const void *));
+c_avl_tree_t *c_avl_create (int (*compare) (const void *, const void *));
 
 
 /*
  * NAME
- *   avl_destroy
+ *   c_avl_destroy
  *
  * DESCRIPTION
  *   Deallocates an AVL-tree. Stored value- and key-pointer are lost, but of
  *   course not freed.
  */
-void avl_destroy (avl_tree_t *t);
+void c_avl_destroy (c_avl_tree_t *t);
 
 /*
  * NAME
- *   avl_insert
+ *   c_avl_insert
  *
  * DESCRIPTION
  *   Stores the key-value-pair in the AVL-tree pointed to by `t'.
  *
  * PARAMETERS
  *   `t'        AVL-tree to store the data in.
@@ -74,17 +74,17 @@
  *   `value'    Value to be stored.
  *
  * RETURN VALUE
  *   Zero upon success and non-zero upon failure and if the key is already
  *   stored in the tree.
  */
-int avl_insert (avl_tree_t *t, void *key, void *value);
+int c_avl_insert (c_avl_tree_t *t, void *key, void *value);
 
 /*
  * NAME
- *   avl_remove
+ *   c_avl_remove
  *
  * DESCRIPTION
  *   Removes a key-value-pair from the tree t. The stored key and value may be
  *   returned in `rkey' and `rvalue'.
  *
  * PARAMETERS
@@ -93,34 +93,34 @@
  *   `rkey'     Pointer to a pointer in which to store the key. May be NULL.
  *   `rvalue'   Pointer to a pointer in which to store the value. May be NULL.
  *
  * RETURN VALUE
  *   Zero upon success or non-zero if the key isn't found in the tree.
  */
-int avl_remove (avl_tree_t *t, const void *key, void **rkey, void **rvalue);
+int c_avl_remove (c_avl_tree_t *t, const void *key, void **rkey, void **rvalue);
 
 /*
  * NAME
- *   avl_get
+ *   c_avl_get
  *
  * DESCRIPTION
  *   Retrieve the `value' belonging to `key'.
  *
  * PARAMETERS
  *   `t'	AVL-tree to get the value from.
  *   `key'      Key to identify the entry.
  *   `value'    Pointer to a pointer in which to store the value. May be NULL.
  *
  * RETURN VALUE
  *   Zero upon success or non-zero if the key isn't found in the tree.
  */
-int avl_get (avl_tree_t *t, const void *key, void **value);
+int c_avl_get (c_avl_tree_t *t, const void *key, void **value);
 
 /*
  * NAME
- *   avl_pick
+ *   c_avl_pick
  *
  * DESCRIPTION
  *   Remove a (pseudo-)random element from the tree and return it's `key' and
  *   `value'. Entries are not returned in any particular order. This function
  *   is intended for cache-flushes that don't care about the order but simply
  *   want to remove all elements, one at a time.
@@ -131,14 +131,14 @@
  *   `value'    Pointer to a pointer in which to store the value.
  *
  * RETURN VALUE
  *   Zero upon success or non-zero if the tree is empty or key or value is
  *   NULL.
  */
-int avl_pick (avl_tree_t *t, void **key, void **value);
+int c_avl_pick (c_avl_tree_t *t, void **key, void **value);
 
-avl_iterator_t *avl_get_iterator (avl_tree_t *t);
-int avl_iterator_next (avl_iterator_t *iter, void **key, void **value);
-int avl_iterator_prev (avl_iterator_t *iter, void **key, void **value);
-void avl_iterator_destroy (avl_iterator_t *iter);
+c_avl_iterator_t *c_avl_get_iterator (c_avl_tree_t *t);
+int c_avl_iterator_next (c_avl_iterator_t *iter, void **key, void **value);
+int c_avl_iterator_prev (c_avl_iterator_t *iter, void **key, void **value);
+void c_avl_iterator_destroy (c_avl_iterator_t *iter);
 
 #endif /* UTILS_AVLTREE_H */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_llist.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_llist.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/src/utils_llist.c	2007-10-25 01:21:24.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/src/utils_llist.c	2007-12-15 20:08:58.000000000 +0800
@@ -107,12 +107,15 @@
 }
 
 void llist_prepend (llist_t *l, llentry_t *e)
 {
 	e->next = l->head;
 	l->head = e;
+
+	if (l->tail == NULL)
+		l->tail = e;
 }
 
 void llist_remove (llist_t *l, llentry_t *e)
 {
 	llentry_t *prev;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/version-gen.sh /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/version-gen.sh
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.1/version-gen.sh	2007-11-09 04:54:22.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.2.2/version-gen.sh	2007-12-15 20:08:58.000000000 +0800
@@ -1,9 +1,9 @@
 #!/bin/sh
 
-DEFAULT_VERSION="4.2.1.git"
+DEFAULT_VERSION="4.2.2.git"
 
 VERSION="$( git describe 2> /dev/null | sed -e 's/^collectd-//' )"
 
 if test -z "$VERSION"; then
 	VERSION="$DEFAULT_VERSION"
 fi
