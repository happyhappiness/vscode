diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/java/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/java/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/java/Makefile.am	2012-09-13 19:10:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/java/Makefile.am	2016-07-19 16:42:46.615749762 +0800
@@ -21,13 +21,13 @@
 	     org/collectd/java/GenericJMXConfConnection.java \
 	     org/collectd/java/GenericJMXConfMBean.java \
 	     org/collectd/java/GenericJMXConfValue.java \
 	     org/collectd/java/GenericJMX.java \
 	     org/collectd/java/JMXMemory.java
 
-java-build-stamp: org/collectd/api/*.java org/collectd/java/*.java
+java-build-stamp: $(srcdir)/org/collectd/api/*.java $(srcdir)/org/collectd/java/*.java
 	$(JAVAC) -d "." "$(srcdir)/org/collectd/api"/*.java
 	$(JAVAC) -d "." "$(srcdir)/org/collectd/java"/*.java
 	mkdir -p .libs
 	$(JAR) cf .libs/collectd-api.jar "org/collectd/api"/*.class
 	$(JAR) cf .libs/generic-jmx.jar "org/collectd/java"/*.class
 	touch "$@"
@@ -38,11 +38,16 @@
 	mkdir -p "$(DESTDIR)$(pkgdatadir)/java"
 	$(INSTALL) -m 644 .libs/collectd-api.jar \
 		"$(DESTDIR)$(pkgdatadir)/java"
 	$(INSTALL) -m 644 .libs/generic-jmx.jar \
 		"$(DESTDIR)$(pkgdatadir)/java"
 
+uninstall-local:
+	rm -f "$(DESTDIR)$(pkgdatadir)/java/collectd-api.jar"
+	rm -f "$(DESTDIR)$(pkgdatadir)/java/generic-jmx.jar"
+	rmdir "$(DESTDIR)$(pkgdatadir)/java" || true
+
 clean-local:
 	rm -f "org/collectd/api"/*.class
 	rm -f "org/collectd/java"/*.class
 	rm -f .libs
 	rm -f "java-build-stamp"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/java/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/java/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/java/Makefile.in	2015-02-26 22:07:47.109223886 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/java/Makefile.in	2016-07-26 15:47:21.177733909 +0800
@@ -154,12 +154,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -299,12 +300,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
@@ -564,13 +567,13 @@
 pdf-am:
 
 ps: ps-am
 
 ps-am:
 
-uninstall-am:
+uninstall-am: uninstall-local
 
 .MAKE: install-am install-strip
 
 .PHONY: all all-am all-local check check-am clean clean-generic \
 	clean-libtool clean-local cscopelist-am ctags-am distclean \
 	distclean-generic distclean-libtool distdir dvi dvi-am html \
@@ -579,16 +582,16 @@
 	install-exec-am install-exec-local install-html \
 	install-html-am install-info install-info-am install-man \
 	install-pdf install-pdf-am install-ps install-ps-am \
 	install-strip installcheck installcheck-am installdirs \
 	maintainer-clean maintainer-clean-generic mostlyclean \
 	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
-	tags-am uninstall uninstall-am
+	tags-am uninstall uninstall-am uninstall-local
 
 
-java-build-stamp: org/collectd/api/*.java org/collectd/java/*.java
+java-build-stamp: $(srcdir)/org/collectd/api/*.java $(srcdir)/org/collectd/java/*.java
 	$(JAVAC) -d "." "$(srcdir)/org/collectd/api"/*.java
 	$(JAVAC) -d "." "$(srcdir)/org/collectd/java"/*.java
 	mkdir -p .libs
 	$(JAR) cf .libs/collectd-api.jar "org/collectd/api"/*.class
 	$(JAR) cf .libs/generic-jmx.jar "org/collectd/java"/*.class
 	touch "$@"
@@ -599,12 +602,17 @@
 	mkdir -p "$(DESTDIR)$(pkgdatadir)/java"
 	$(INSTALL) -m 644 .libs/collectd-api.jar \
 		"$(DESTDIR)$(pkgdatadir)/java"
 	$(INSTALL) -m 644 .libs/generic-jmx.jar \
 		"$(DESTDIR)$(pkgdatadir)/java"
 
+uninstall-local:
+	rm -f "$(DESTDIR)$(pkgdatadir)/java/collectd-api.jar"
+	rm -f "$(DESTDIR)$(pkgdatadir)/java/generic-jmx.jar"
+	rmdir "$(DESTDIR)$(pkgdatadir)/java" || true
+
 clean-local:
 	rm -f "org/collectd/api"/*.class
 	rm -f "org/collectd/java"/*.class
 	rm -f .libs
 	rm -f "java-build-stamp"
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/bindings/Makefile.in	2015-02-26 22:07:47.033222307 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/bindings/Makefile.in	2016-07-26 15:47:21.133733802 +0800
@@ -215,12 +215,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -360,12 +361,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/ChangeLog /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/ChangeLog
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/ChangeLog	2015-02-26 22:07:35.800989009 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/ChangeLog	2016-07-26 15:47:12.945713764 +0800
@@ -1,6 +1,184 @@
+2016-07-26, Version 5.4.3
+	* Build system: A deprecation warning has been removed. Thanks to
+	  Florian Forster.
+	* Build system: An ordering issue when build the AMQP plugin was
+	  corrected. Thanks to Shahul Hameed.
+	* Build system: Building the gmond plugin against recent libganglia
+	  versions has been added. Thanks to Marc Fournier. #1129
+	* Build system: "collectd-tg" now builds on AIX. Thanks to Manuel Luis
+	  Sanmartín Rozada. #542
+	* Build system: "version-gen.sh" portablility was improved. Thanks to
+	  Marc Fournier and Ruben Kerkhof.
+	* Build system: Compiling utils_dns.c on Solaris has beed fixed. Thanks
+	  to Yves Mettier, Dagobert Michelsen and Florian Forster. #348
+	* Build system: Default JDK detection got improved. Thanks to Ruben
+	  Kerkhof and Marc Fournier.
+	* Build system: Detection and handling of librrd 1.6 and later has been
+	  fixed. Thanks to Ruben Kerkhof.
+	* Build system: notify_email build options got corrected to make it
+	  build on non-GNU libc systems. Thanks to Marc Fournier.
+	* Build system: Protobuf building and logging has been improved. Thanks
+	  to Ruben Kerkhof.
+	* Build system: The "make distcheck" target was fixed to properly handle
+	  java build artifacts. Thanks to Florian Forster.
+	* Build system: The configure script got fixed to work properly when
+	  called with "CC="gcc -Wall -Werror"" . Thanks to Marc Fournier.
+	* Build system: The configure script will now fail if pkg-config isn't
+	  available. Thanks to Ruben Kerkhof.
+	* Build system: The users plugin now builds properly on Solaris when
+	  libstatgrab is available. Thanks to Dagobert Michelsen. #1061
+	* Build system: Various fixes have been done to improve library
+	  detection on FreeBSD. Thanks to Ruben Kerkhof.
+	* collectd2html: Several perl errors have been corrected. Thanks to Ruud
+	  van Melick. #1103
+	* collectd: A global gauge format-string is now used to avoid loss of
+	  precision. Thanks to Florian Forster. #1039
+	* collectd: A race condition at plugin initialization time was fixed.
+	  Thanks to Jan Andres. #1316
+	* collectd: Autoloading now properly sets plugin context, allowing
+	  plugins to determine the interval. Thanks to Florian Forster. #1069
+	* collectd: Empty "Plugin" blocks are now supported by the configuration
+	  file parser. Thanks to Manuel Luis Sanmartín Rozada. #1035
+	* collectd: The address of the Free Software Foundation has been fixed
+	  in GPL license headers. Thanks to Ruben Kerkhof.
+	* collectd: Writing to a closed TCP socket is now properly handled.
+	  Thanks to Tamás Földesi. #1104
+	* Documentation: iptables plugin: IPv6 configuration option has been
+	  added to the collectd.conf(5) manpage. Thanks to 'Marc Fournier''.
+	  #1496
+	* AMQP plugin: The plugin was fixed to build against librabbitmq 0.6.0.
+	  Thanks to Remi Collet. #1008
+	* Apache plugin: A warning about a possible misconfiguration has been
+	  added. Thanks to Marc Fournier.
+	* Apache plugin: The plugin was extended to parse the whole response,
+	  required to support Apache versions greater than 2.4.17. Thanks to
+	  Marc Fournier and Florian Forster. #1170, #1343
+	* APC UPS plugin: Log messages are now prefixed with the plugin name.
+	  Thanks to Sergey. #1329
+	* Bind plugin: The type_instance now gets properly sanitized. Thanks to
+	  Thomas Kho. #992
+	* CPU plugin: Error messages on MacOSX have been improved. Thanks to
+	  Florian Forster. #22
+	* cURL plugin: A typo in an error message got corrected. Thanks to Marc
+	  Fournier.
+	* cURL, cURL-JSON and cURL-XML plugins: A memory leak when allocating
+	  more memory fails has been fixed. Thanks to Brandon Arp.
+	* DF plugin: An bug preventing filesystems which don't report inodes
+	  such as btrfs has been corrected. Thanks to Marek Becka. #1096
+	* DF plugin: Duplicate entries are no longer reported twice. Thanks to
+	  Stefan Brüns and Florian Forster. #1402
+	* DF plugin: Legacy code for skipping "rootfs" mount points has been
+	  removed. Thanks to Marc Fournier. #1402
+	* DF plugin: Legacy references to the "ReportReserved" option have been
+	  removed. Thanks to Marc Fournier.
+	* DF plugin: Reading the mtab now uses a reentrant function when
+	  possible. Thanks to Ruben Kerkhof. #1163
+	* Ethstat plugin: Code to strip leading whitespace from device names.
+	  This works around an issue in the VMXNet3 driver. Thanks to Thomas
+	  Guthmann. #1059
+	* Exec plugin: A file descriptor leak when the plugin is configured to
+	  run as a non-existing user was corrected. Thanks to Gautam BT and Marc
+	  Fournier. #762
+	* Exec plugin: A problem in the error handling of an fdopen() failure
+	  has been fixed. Thanks to @ciomaire.
+	* Interface plugin: Documentation about regular expressions in the
+	  ignore list has been added. Thanks to Jakub Jankowski.
+	* IRQ plugin: The "FIQ" line is now skipped as it doesn't contain any
+	  counter. Thanks to Ruben Kerkhof. #971
+	* Modbus plugin: The debug output has been disabled by default. It is
+	  now only enabled when building with "--enable-debug". Thanks to Eric
+	  Sandeen and Marc Fournier.
+	* MongoDB plugin: A memory leak has been fixed and some adaptations to
+	  the current API of the mongo-c-driver have been made. Thanks to
+	  Florian Forster. #956
+	* Network plugin: A check for the initialization of secure memory has
+	  been added. Previously, failure to initialize this memory was ignored.
+	  Thanks to @yujokang. #1665
+	* Network plugin: A heap overflow has been fixed in the server code.
+	  This issue can be triggered remotely and is potentially exploitable.
+	  Thanks to Emilien Gaspar. CVE-2016-6254
+	* Network plugin: The TimeToLive option handling was made more robust.
+	  Thanks to Tim Laszlo. #654
+	* NTPd plugin: Documentation about the required "mode 7" has been added.
+	  Thanks to Jakub Jankowski.
+	* NTPd plugin: Reporting of "time_offset-loop" was corrected to match
+	  the values from ntpq/ntpdc. Thanks to Pierre Fersing and Florian
+	  Forster. #1300
+	* OpenVPN plugin: The plugin was fixe to avoid signaling an error when
+	  no clients were connected. Thanks to Florian Forster. #731
+	* Perl plugin: Init callbacks have been changed to run essentially
+	  single-threaded to avoid race conditions by init functions which
+	  create additional threads. Thanks to Pavel Rochnyack. #1706
+	* PF plugin and DNS plugin: These plugins have been fixed to build
+	  properly on OpenBSD again. Thanks to Ruben Kerkhof.
+	* Processes plugin: A compilation error on systems without "regex.h" has
+	  been fixed. Thanks to Corey Kosak.
+	* Processes plugin: A memory leak on Solaris has been fixed. Thanks to
+	  Jim Quinn.
+	* Processes plugin and Swap plugin: These plugins have been corrected to
+	  also work inside FreeBSD jails. Thanks to biancalana. #1019
+	* Processes plugin: A warning about too long process names has been
+	  added. Thanks to Marc Fournier. #1284
+	* Processes plugin: Process counting on the FreeBSD and OpenBSD
+	  platforms has been fixed. Thanks to Herve COMMOWICK. #1298
+	* Processes plugin: The plugin was fixed to work properly on Solaris.
+	  Thanks to Jan Andres. #919
+	* Python plugin: A double-free bug got fixed. Thanks to Sven Trenkel.
+	  #1285
+	* RRDtool plugin: A race condition leading to corrupt RRD file creation
+	  has been fixed. Thanks to Manuel Luis Sanmartín Rozada. #1031
+	* SNMP plugin: The "Gauge32" signedness was corrected to match RFC1902.
+	  Thanks to Nathan Ward. #1325
+	* StatsD plugin: A deadlock on plugin shutdown has been fixed. Thanks to
+	  Pavel Rochnyack #1703
+	* StatsD plugin: A memory leak was corrected. Thanks to Florian Forster.
+	  #997
+	* StatsD plugin: A symbol lookup error was fixed by properly linking the
+	  plugin against libm. Thanks to Florian Forster.
+	* StatsD plugin: "utils_latency": Support for including values above
+	  1000 in percentile calculation has been added. Thanks to Yoga
+	  Ramalingam. #401
+	* StatsD plugin: "utils_latency": Two division by zero error conditions
+	  have been corrected. Thanks to Wilfried Goesgens. #655
+	* StatsD plugin: Counters absolute counts are now also reported. Thanks
+	  to Pierre-Yves Ritschard. #1311
+	* StatsD plugin: The plugin now emits NaN values when no timer event is
+	  recorded. Thanks to Florian Forster. #1038, #1039
+	* StatsD plugin: The plugin was corrected to avoid crashing when
+	  negative timer values are submitted. Thanks to Florian Forster. #1131
+	* Tail CSV plugin: The plugin was fixed to work properly with multiple
+	  "Collect" options and a bug got fixed when no "TimeFrom" is specified.
+	  Thanks to Manuel Luis Sanmartín Rozada and Florian Forster. #1032
+	* TCPConns plugin: A memory leak was fixed. Thanks to Florian Forster.
+	  #1074
+	* TCPConns plugin: An bug causing collectd to enter an inifinite loop on
+	  OpenBSD was fixed. Thanks to Landry Breuil. #1094
+	* Threshold plugin: Threshold configuration blocks can now be defined in
+	  different files. Thanks to Michael Salmon. #551
+	* vmem plugin: Support for pgsteal in recent Linux kernels has been
+	  added. Thanks to Jakub Jankowski. #1307
+	* vmem plugin: The DSType for nr_dirtied and nr_written was corrected to
+	  report a derive. Thanks to Marek Becka. #1072
+	* Write Graphite plugin: Error handling when submitting metrics to the
+	  server is now more robust. Thanks to Sam Pointer. #1364
+	* Write HTTP plugin: Freeing of memory holding HTTP headers during
+	  shutdown has been fixed. Thanks to Tolga Ceylan.
+	* Write Redis plugin: Multi-Valued key was made easier to parse by
+	  adding a "|" character as a delimiter. Thanks to brianpkelly and
+	  Florian Forster. #1070
+	* Write Redis plugin: The timestamp format was corrected. Thanks to
+	  Florian Forster.
+	* ZFS ARC plugin: The plugin was will not emit warning about missing
+	  "l2_size" stats anymore. Thanks to Jan Andres. #919
+	* 152 patches have been applied to numerous plugins and core components,
+	  fixing various programming errors which were reported by scan-build,
+	  libasan, FBInfer, coverity-scan, clang and gcc-6: Thanks to Ruben
+	  Kerkhof, Florian Forster, Marc Fournier, Corey Kosak, Laurent,
+	  Claudius Zingerli and Fabien Wernli.
+
 2015-02-26, Version 5.4.2
 	* Build system: Numerous fixes. Thanks to Bjørn Nordbø, Jim Radford,
 	  KOMEDA Shinji, Lauri Tirkkonen, Manuel Luis Sanmartin Rozada, Marc
 	  Fournier, Rainer Müller, Yoga Ramalingam and Yves Mettier. #326,
 	  #373, #653, #828
 	* collectd: A use-after-free has been fixed in the "parse_value()"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/configure	2015-02-26 22:07:49.025263680 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/configure	2016-07-26 15:47:22.401736903 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for collectd 5.4.2.
+# Generated by GNU Autoconf 2.69 for collectd 5.4.3.
 #
 #
 # Copyright (C) 1992-1996, 1998-2012 Free Software Foundation, Inc.
 #
 #
 # This configure script is free software; the Free Software Foundation
@@ -588,18 +588,19 @@
 MFLAGS=
 MAKEFLAGS=
 
 # Identity of this package.
 PACKAGE_NAME='collectd'
 PACKAGE_TARNAME='collectd'
-PACKAGE_VERSION='5.4.2'
-PACKAGE_STRING='collectd 5.4.2'
+PACKAGE_VERSION='5.4.3'
+PACKAGE_STRING='collectd 5.4.3'
 PACKAGE_BUGREPORT=''
 PACKAGE_URL=''
 
 ac_unique_file="src/collectd.c"
+: "${ARFLAGS=cr} ${AR_FLAGS=cr}"
 # Factoring default headers for most tests.
 ac_includes_default="\
 #include <stdio.h>
 #ifdef HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -944,14 +945,17 @@
 GLIB_LIBS
 GLIB_CFLAGS
 BUILD_WITH_LM_SENSORS_FALSE
 BUILD_WITH_LM_SENSORS_TRUE
 BUILD_WITH_LIBSENSORS_LDFLAGS
 BUILD_WITH_LIBSENSORS_CFLAGS
+BUILD_WITH_LIBRRD_LIBS
 BUILD_WITH_LIBRRD_LDFLAGS
 BUILD_WITH_LIBRRD_CFLAGS
+RRD_LIBS
+RRD_CFLAGS
 BUILD_WITH_LIBROUTEROS_FALSE
 BUILD_WITH_LIBROUTEROS_TRUE
 BUILD_WITH_LIBROUTEROS_LDFLAGS
 BUILD_WITH_LIBROUTEROS_CPPFLAGS
 BUILD_WITH_LIBRABBITMQ_FALSE
 BUILD_WITH_LIBRABBITMQ_TRUE
@@ -1147,12 +1151,14 @@
 PACKAGE
 CYGPATH_W
 am__isrc
 INSTALL_DATA
 INSTALL_SCRIPT
 INSTALL_PROGRAM
+BUILD_INCLUDED_LTDL_FALSE
+BUILD_INCLUDED_LTDL_TRUE
 LTDLOPEN
 LT_CONFIG_H
 subdirs
 CONVENIENCE_LTDL_FALSE
 CONVENIENCE_LTDL_TRUE
 INSTALL_LTDL_FALSE
@@ -1447,12 +1453,14 @@
 PKG_CONFIG_PATH
 PKG_CONFIG_LIBDIR
 KERNEL_DIR
 LIBNETAPP_CPPFLAGS
 LIBNETAPP_LDFLAGS
 LIBNETAPP_LIBS
+RRD_CFLAGS
+RRD_LIBS
 LIBNOTIFY_CFLAGS
 LIBNOTIFY_LIBS'
 ac_subdirs_all='libltdl'
 
 # Initialize some variables set by options.
 ac_init_help=
@@ -1989,13 +1997,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures collectd 5.4.2 to adapt to many kinds of systems.
+\`configure' configures collectd 5.4.3 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -2059,13 +2067,13 @@
   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of collectd 5.4.2:";;
+     short | recursive ) echo "Configuration of collectd 5.4.3:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-option-checking  ignore unrecognized --enable/--with options
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
@@ -2326,12 +2334,14 @@
   LIBNETAPP_CPPFLAGS
               C preprocessor flags required to build with libnetapp
   LIBNETAPP_LDFLAGS
               Linker flags required to build with libnetapp
   LIBNETAPP_LIBS
               Other libraries required to link against libnetapp
+  RRD_CFLAGS  C compiler flags for RRD, overriding pkg-config
+  RRD_LIBS    linker flags for RRD, overriding pkg-config
   LIBNOTIFY_CFLAGS
               C compiler flags for LIBNOTIFY, overriding pkg-config
   LIBNOTIFY_LIBS
               linker flags for LIBNOTIFY, overriding pkg-config
 
 Use these variables to override the choices made by `configure' or to help
@@ -2397,13 +2407,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-collectd configure 5.4.2
+collectd configure 5.4.3
 generated by GNU Autoconf 2.69
 
 Copyright (C) 2012 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
@@ -2919,13 +2929,13 @@
 
 } # ac_fn_c_check_member
 cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by collectd $as_me 5.4.2, which was
+It was created by collectd $as_me 5.4.3, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 exec 5>>config.log
@@ -12875,12 +12887,21 @@
 
 $as_echo "#define LIBTOOL_VERSION 2" >>confdefs.h
 
 
 
 
+ if test "x$LTDLDEPS" != "x"; then
+  BUILD_INCLUDED_LTDL_TRUE=
+  BUILD_INCLUDED_LTDL_FALSE='#'
+else
+  BUILD_INCLUDED_LTDL_TRUE='#'
+  BUILD_INCLUDED_LTDL_FALSE=
+fi
+
+
 am__api_version='1.14'
 
 # Find a good install program.  We prefer a C program (faster),
 # so one script is as good as another.  But avoid the broken or
 # incompatible versions:
 # SysV /etc/install, /usr/sbin/install
@@ -13379,13 +13400,13 @@
   fi
 fi
 
 
 # Define the identity of the package.
  PACKAGE='collectd'
- VERSION='5.4.2'
+ VERSION='5.4.3'
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -14671,12 +14692,79 @@
 ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for egrep" >&5
+$as_echo_n "checking for egrep... " >&6; }
+if ${ac_cv_path_EGREP+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
+   then ac_cv_path_EGREP="$GREP -E"
+   else
+     if test -z "$EGREP"; then
+  ac_path_EGREP_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_prog in egrep; do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
+      as_fn_executable_p "$ac_path_EGREP" || continue
+# Check for GNU ac_path_EGREP and select it if it is found.
+  # Check for GNU $ac_path_EGREP
+case `"$ac_path_EGREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
+*)
+  ac_count=0
+  $as_echo_n 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    $as_echo 'EGREP' >> "conftest.nl"
+    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP="$ac_path_EGREP"
+      ac_path_EGREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_EGREP_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_EGREP"; then
+    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_EGREP=$EGREP
+fi
+
+   fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP" >&5
+$as_echo "$ac_cv_path_EGREP" >&6; }
+ EGREP="$ac_cv_path_EGREP"
+
+
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether ln -s works" >&5
 $as_echo_n "checking whether ln -s works... " >&6; }
 LN_S=$as_ln_s
 if test "$LN_S" = "ln -s"; then
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
@@ -14956,12 +15044,16 @@
 
   test -n "$YACC" && break
 done
 test -n "$YACC" || YACC="yacc"
 
 
+# Warn when pkg.m4 is missing
+
+
+
 
 
 
 
 
 
@@ -15076,12 +15168,33 @@
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
 		PKG_CONFIG=""
 	fi
 fi
 
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if bison is the parser generator" >&5
+$as_echo_n "checking if bison is the parser generator... " >&6; }
+if ${collectd_cv_prog_bison+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if $YACC --version 2>/dev/null | $EGREP -q '^bison '; then :
+  collectd_cv_prog_bison=yes
+else
+  collectd_cv_prog_bison=no
+
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $collectd_cv_prog_bison" >&5
+$as_echo "$collectd_cv_prog_bison" >&6; }
+
+if test "x$collectd_cv_prog_bison" = "xno" && test ! -f "${srcdir}/src/liboconfig/parser.c"
+then
+	as_fn_error $? "bison is missing and you do not have ${srcdir}/src/liboconfig/parser.c. Please install bison" "$LINENO" 5
+fi
+
 # Extract the first word of "protoc-c", so it can be a program name with args.
 set dummy protoc-c; ac_word=$2
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
 $as_echo_n "checking for $ac_word... " >&6; }
 if ${ac_cv_prog_have_protoc_c+:} false; then :
   $as_echo_n "(cached) " >&6
@@ -15114,29 +15227,80 @@
 else
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
 fi
 
 
-for ac_header in google/protobuf-c/protobuf-c.h
+if test "x$have_protoc_c" = "xno"
+then
+	have_protoc_c="no (protoc-c compiler not found)"
+fi
+
+if test "x$have_protoc_c" = "xyes"
+then
+	for ac_header in protobuf-c/protobuf-c.h google/protobuf-c/protobuf-c.h
 do :
-  ac_fn_c_check_header_mongrel "$LINENO" "google/protobuf-c/protobuf-c.h" "ac_cv_header_google_protobuf_c_protobuf_c_h" "$ac_includes_default"
-if test "x$ac_cv_header_google_protobuf_c_protobuf_c_h" = xyes; then :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
-#define HAVE_GOOGLE_PROTOBUF_C_PROTOBUF_C_H 1
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
- have_protobuf_c_h="yes"
+ have_protoc_c="yes"; break
 else
-  have_protobuf_c_h="no"
+  have_protoc_c="no (<google/protobuf-c/protobuf-c.h> not found)"
 fi
 
 done
 
-if test "x$have_protoc_c" = "xyes" && test "x$have_protobuf_c_h" != "xyes"
+fi
+if test "x$have_protoc_c" = "xyes"
 then
-	have_protoc_c="no (unable to find <google/protobuf-c/protobuf-c.h>)"
+	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for protobuf_c_message_pack in -lprotobuf-c" >&5
+$as_echo_n "checking for protobuf_c_message_pack in -lprotobuf-c... " >&6; }
+if ${ac_cv_lib_protobuf_c_protobuf_c_message_pack+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lprotobuf-c  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char protobuf_c_message_pack ();
+int
+main ()
+{
+return protobuf_c_message_pack ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_lib_protobuf_c_protobuf_c_message_pack=yes
+else
+  ac_cv_lib_protobuf_c_protobuf_c_message_pack=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_protobuf_c_protobuf_c_message_pack" >&5
+$as_echo "$ac_cv_lib_protobuf_c_protobuf_c_message_pack" >&6; }
+if test "x$ac_cv_lib_protobuf_c_protobuf_c_message_pack" = xyes; then :
+  have_protoc_c="yes"
+else
+  have_protoc_c="no (libprotobuf-c not found)"
+fi
+
+
 fi
  if test "x$have_protoc_c" = "xyes"; then
   HAVE_PROTOC_C_TRUE=
   HAVE_PROTOC_C_FALSE='#'
 else
   HAVE_PROTOC_C_TRUE='#'
@@ -15903,12 +16067,80 @@
 
 fi
 
 done
 
 
+have_ip6_ext="no"
+ac_fn_c_check_type "$LINENO" "struct ip6_ext" "ac_cv_type_struct_ip6_ext" "#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP6_H
+# include <netinet/ip6.h>
+#endif
+
+"
+if test "x$ac_cv_type_struct_ip6_ext" = xyes; then :
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_STRUCT_IP6_EXT 1
+_ACEOF
+
+have_ip6_ext="yes"
+else
+  have_ip6_ext="no"
+fi
+
+
+if test "x$have_ip6_ext" = "xno"; then
+	SAVE_CFLAGS="$CFLAGS"
+	CFLAGS="$CFLAGS -DSOLARIS2=8"
+
+	ac_fn_c_check_type "$LINENO" "struct ip6_ext" "ac_cv_type_struct_ip6_ext" "#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP6_H
+# include <netinet/ip6.h>
+#endif
+
+"
+if test "x$ac_cv_type_struct_ip6_ext" = xyes; then :
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_STRUCT_IP6_EXT 1
+_ACEOF
+
+have_ip6_ext="yes, with -DSOLARIS2=8"
+else
+  have_ip6_ext="no"
+fi
+
+
+	if test "x$have_ip6_ext" = "xno"; then
+		CFLAGS="$SAVE_CFLAGS"
+	fi
+fi
+
 # For cpu modules
 for ac_header in sys/dkstat.h
 do :
   ac_fn_c_check_header_mongrel "$LINENO" "sys/dkstat.h" "ac_cv_header_sys_dkstat_h" "$ac_includes_default"
 if test "x$ac_cv_header_sys_dkstat_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
@@ -16451,13 +16683,34 @@
 
 fi
 
 done
 
 
-for ac_header in pwd.h grp.h sys/un.h ctype.h limits.h xfs/xqm.h fs_info.h fshelp.h paths.h mntent.h mnttab.h sys/fstyp.h sys/fs_types.h sys/mntent.h sys/mnttab.h sys/statfs.h sys/statvfs.h sys/vfs.h sys/vfstab.h kvm.h wordexp.h
+for ac_header in  \
+  ctype.h \
+  fs_info.h \
+  fshelp.h \
+  grp.h \
+  kvm.h \
+  limits.h \
+  mntent.h \
+  mnttab.h \
+  paths.h \
+  pwd.h \
+  sys/fs_types.h \
+  sys/fstyp.h \
+  sys/mntent.h \
+  sys/mnttab.h \
+  sys/statfs.h \
+  sys/statvfs.h \
+  sys/un.h \
+  sys/vfs.h \
+  sys/vfstab.h \
+  wordexp.h \
+
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
 if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
@@ -16465,12 +16718,28 @@
 
 fi
 
 done
 
 
+for ac_header in xfs/xqm.h
+do :
+  ac_fn_c_check_header_compile "$LINENO" "xfs/xqm.h" "ac_cv_header_xfs_xqm_h" "
+#define _GNU_SOURCE
+
+"
+if test "x$ac_cv_header_xfs_xqm_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_XFS_XQM_H 1
+_ACEOF
+
+fi
+
+done
+
+
 # For the dns plugin
 for ac_header in arpa/nameser.h
 do :
   ac_fn_c_check_header_mongrel "$LINENO" "arpa/nameser.h" "ac_cv_header_arpa_nameser_h" "$ac_includes_default"
 if test "x$ac_cv_header_arpa_nameser_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
@@ -16595,12 +16864,15 @@
 #if HAVE_SYS_SOCKET_H
 # include <sys/socket.h>
 #endif
 #if HAVE_NET_IF_H
 # include <net/if.h>
 #endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
 
 "
 if test "x$ac_cv_header_net_pfvar_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
 #define HAVE_NET_PFVAR_H 1
 _ACEOF
@@ -18226,12 +18498,24 @@
 #define HAVE_LISTMNTENT 1
 _ACEOF
  have_listmntent="yes"
 fi
 done
 
+have_getmntent_r="no"
+for ac_func in getmntent_r
+do :
+  ac_fn_c_check_func "$LINENO" "getmntent_r" "ac_cv_func_getmntent_r"
+if test "x$ac_cv_func_getmntent_r" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_GETMNTENT_R 1
+_ACEOF
+ have_getmntent_r="yes"
+fi
+done
+
 
 have_getmntent="no"
 for ac_func in getmntent
 do :
   ac_fn_c_check_func "$LINENO" "getmntent" "ac_cv_func_getmntent"
 if test "x$ac_cv_func_getmntent" = xyes; then :
@@ -18385,12 +18669,13 @@
 {
 
 FILE *fh;
 struct mntent *me;
 fh = setmntent ("/etc/mtab", "r");
 me = getmntent (fh);
+return(me->mnt_passno);
 
 
   ;
   return 0;
 }
 _ACEOF
@@ -18421,12 +18706,13 @@
 
 				 FILE *fh;
 				 struct mnttab mt;
 				 int status;
 				 fh = fopen ("/etc/mnttab", "r");
 				 status = getmntent (fh, &mt);
+				 return(status);
 
 
   ;
   return 0;
 }
 _ACEOF
@@ -18786,12 +19072,13 @@
 		have_struct_kinfo_proc_openbsd="no"
 
 fi
 
 
 ac_fn_c_check_member "$LINENO" "struct udphdr" "uh_dport" "ac_cv_member_struct_udphdr_uh_dport" "#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -18815,12 +19102,13 @@
 #define HAVE_STRUCT_UDPHDR_UH_DPORT 1
 _ACEOF
 
 
 fi
 ac_fn_c_check_member "$LINENO" "struct udphdr" "uh_sport" "ac_cv_member_struct_udphdr_uh_sport" "#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -18845,12 +19133,13 @@
 _ACEOF
 
 
 fi
 
 ac_fn_c_check_member "$LINENO" "struct udphdr" "dest" "ac_cv_member_struct_udphdr_dest" "#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -18874,12 +19163,13 @@
 #define HAVE_STRUCT_UDPHDR_DEST 1
 _ACEOF
 
 
 fi
 ac_fn_c_check_member "$LINENO" "struct udphdr" "source" "ac_cv_member_struct_udphdr_source" "#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -20224,39 +20514,42 @@
  else if test -d "$withval"
  then
 	 GANGLIA_CPPFLAGS="-I$withval/include"
 	 GANGLIA_LDFLAGS="-L$withval/lib"
 	 with_libganglia="yes"
  else
-	 with_libganglia_config="ganglia-config"
 	 with_libganglia="$withval"
  fi; fi; fi
 
 else
 
- with_libganglia_config="ganglia-config"
  with_libganglia="yes"
 
 fi
 
 
-if test "x$with_libganglia" = "xyes" && test "x$with_libganglia_config" != "x"
+if test "x$with_libganglia" = "xyes"
 then
-	if test "x$GANGLIA_CPPFLAGS" = "x"
+	if test "x$with_libganglia_config" != "x"
 	then
-		GANGLIA_CPPFLAGS=`"$with_libganglia_config" --cflags 2>/dev/null`
-	fi
+		if test "x$GANGLIA_CPPFLAGS" = "x"
+		then
+			GANGLIA_CPPFLAGS=`"$with_libganglia_config" --cflags 2>/dev/null`
+		fi
 
-	if test "x$GANGLIA_LDFLAGS" = "x"
-	then
-		GANGLIA_LDFLAGS=`"$with_libganglia_config" --ldflags 2>/dev/null`
-	fi
+		if test "x$GANGLIA_LDFLAGS" = "x"
+		then
+			GANGLIA_LDFLAGS=`"$with_libganglia_config" --ldflags 2>/dev/null`
+		fi
 
-	if test "x$GANGLIA_LIBS" = "x"
-	then
-		GANGLIA_LIBS=`"$with_libganglia_config" --libs 2>/dev/null`
+		if test "x$GANGLIA_LIBS" = "x"
+		then
+			GANGLIA_LIBS=`"$with_libganglia_config" --libs 2>/dev/null`
+		fi
+	else
+		GANGLIA_LIBS="-lganglia"
 	fi
 fi
 
 SAVE_CPPFLAGS="$CPPFLAGS"
 SAVE_LDFLAGS="$LDFLAGS"
 CPPFLAGS="$CPPFLAGS $GANGLIA_CPPFLAGS"
@@ -20388,28 +20681,24 @@
 then
 	if test "x$GCRYPT_CPPFLAGS" = "x"
 	then
 		GCRYPT_CPPFLAGS=`"$with_libgcrypt_config" --cflags 2>/dev/null`
 	fi
 
-	if test "x$GCRYPT_LDFLAGS" = "x"
-	then
-		gcrypt_exec_prefix=`"$with_libgcrypt_config" --exec-prefix 2>/dev/null`
-		GCRYPT_LDFLAGS="-L$gcrypt_exec_prefix/lib"
-	fi
-
 	if test "x$GCRYPT_LIBS" = "x"
 	then
 		GCRYPT_LIBS=`"$with_libgcrypt_config" --libs 2>/dev/null`
 	fi
 fi
 
 SAVE_CPPFLAGS="$CPPFLAGS"
 SAVE_LDFLAGS="$LDFLAGS"
+SAVE_LIBS="$LIBS"
 CPPFLAGS="$CPPFLAGS $GCRYPT_CPPFLAGS"
 LDFLAGS="$LDFLAGS $GCRYPT_LDFLAGS"
+LIBS="$LIBS $GCRYPT_LIBS"
 
 if test "x$with_libgcrypt" = "xyes"
 then
 	if test "x$GCRYPT_CPPFLAGS" != "x"
 	then
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: gcrypt CPPFLAGS: $GCRYPT_CPPFLAGS" >&5
@@ -20430,17 +20719,12 @@
 done
 
 fi
 
 if test "x$with_libgcrypt" = "xyes"
 then
-	if test "x$GCRYPT_LDFLAGS" != "x"
-	then
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: gcrypt LDFLAGS: $GCRYPT_LDFLAGS" >&5
-$as_echo "$as_me: gcrypt LDFLAGS: $GCRYPT_LDFLAGS" >&6;}
-	fi
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for gcry_md_hash_buffer in -lgcrypt" >&5
 $as_echo_n "checking for gcry_md_hash_buffer in -lgcrypt... " >&6; }
 if ${ac_cv_lib_gcrypt_gcry_md_hash_buffer+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -20701,12 +20985,13 @@
 		GCRYPT_LIBS="$LIBGCRYPT_LIBS"
 	fi
 fi
 
 CPPFLAGS="$SAVE_CPPFLAGS"
 LDFLAGS="$SAVE_LDFLAGS"
+LIBS="$SAVE_LIBS"
 
 if test "x$with_libgcrypt" = "xyes"
 then
 
 $as_echo "#define HAVE_LIBGCRYPT 1" >>confdefs.h
 
@@ -20963,12 +21248,16 @@
 
 fi
 # }}}
 
 # --with-java {{{
 with_java_home="$JAVA_HOME"
+if test "x$with_java_home" = "x"
+then
+	with_java_home="/usr/lib/jvm"
+fi
 with_java_vmtype="client"
 with_java_cflags=""
 with_java_libs=""
 JAVAC="$JAVAC"
 JAR="$JAR"
 
@@ -20993,39 +21282,39 @@
 if test "x$with_java" = "xyes"
 then
 	if test -d "$with_java_home"
 	then
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for jni.h" >&5
 $as_echo_n "checking for jni.h... " >&6; }
-		TMPVAR=`find "$with_java_home" -name jni.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -name jni.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: result: found in $TMPVAR" >&5
 $as_echo "found in $TMPVAR" >&6; }
 			JAVA_CPPFLAGS="$JAVA_CPPFLAGS -I$TMPVAR"
 		else
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 $as_echo "not found" >&6; }
 		fi
 
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for jni_md.h" >&5
 $as_echo_n "checking for jni_md.h... " >&6; }
-		TMPVAR=`find "$with_java_home" -name jni_md.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -name jni_md.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: result: found in $TMPVAR" >&5
 $as_echo "found in $TMPVAR" >&6; }
 			JAVA_CPPFLAGS="$JAVA_CPPFLAGS -I$TMPVAR"
 		else
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: result: not found" >&5
 $as_echo "not found" >&6; }
 		fi
 
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for libjvm.so" >&5
 $as_echo_n "checking for libjvm.so... " >&6; }
-		TMPVAR=`find "$with_java_home" -name libjvm.so -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -type f \( -name libjvm.so -o -name libjvm.dylib \) -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: result: found in $TMPVAR" >&5
 $as_echo "found in $TMPVAR" >&6; }
 			JAVA_LDFLAGS="$JAVA_LDFLAGS -L$TMPVAR -Wl,-rpath -Wl,$TMPVAR"
 		else
@@ -21034,13 +21323,13 @@
 		fi
 
 		if test "x$JAVAC" = "x"
 		then
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for javac" >&5
 $as_echo_n "checking for javac... " >&6; }
-			TMPVAR=`find "$with_java_home" -name javac -type f 2>/dev/null | head -n 1`
+			TMPVAR=`find -L "$with_java_home" -name javac -type f 2>/dev/null | head -n 1`
 			if test "x$TMPVAR" != "x"
 			then
 				JAVAC="$TMPVAR"
 				{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $JAVAC" >&5
 $as_echo "$JAVAC" >&6; }
 			else
@@ -21049,13 +21338,13 @@
 			fi
 		fi
 		if test "x$JAR" = "x"
 		then
 			{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for jar" >&5
 $as_echo_n "checking for jar... " >&6; }
-			TMPVAR=`find "$with_java_home" -name jar -type f 2>/dev/null | head -n 1`
+			TMPVAR=`find -L "$with_java_home" -name jar -type f 2>/dev/null | head -n 1`
 			if test "x$TMPVAR" != "x"
 			then
 				JAR="$TMPVAR"
 				{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $JAR" >&5
 $as_echo "$JAR" >&6; }
 			else
@@ -21601,22 +21890,22 @@
 # the actual checks.
 if test "x$with_libmodbus" = "xyes"
 then
 	SAVE_CPPFLAGS="$CPPFLAGS"
 	CPPFLAGS="$CPPFLAGS $with_libmodbus_cflags"
 
-	for ac_header in modbus/modbus.h
+	for ac_header in modbus.h
 do :
-  ac_fn_c_check_header_mongrel "$LINENO" "modbus/modbus.h" "ac_cv_header_modbus_modbus_h" "$ac_includes_default"
-if test "x$ac_cv_header_modbus_modbus_h" = xyes; then :
+  ac_fn_c_check_header_mongrel "$LINENO" "modbus.h" "ac_cv_header_modbus_h" "$ac_includes_default"
+if test "x$ac_cv_header_modbus_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
-#define HAVE_MODBUS_MODBUS_H 1
+#define HAVE_MODBUS_H 1
 _ACEOF
 
 else
-  with_libmodbus="no (modbus/modbus.h not found)"
+  with_libmodbus="no (modbus.h not found)"
 fi
 
 done
 
 
 	CPPFLAGS="$SAVE_CPPFLAGS"
@@ -21841,13 +22130,13 @@
 	with_libmysql="yes"
 
 fi
 
 if test "x$with_libmysql" = "xyes"
 then
-	with_mysql_cflags=`$with_mysql_config --cflags 2>/dev/null`
+	with_mysql_cflags=`$with_mysql_config --include 2>/dev/null`
 	mysql_config_status=$?
 
 	if test $mysql_config_status -ne 0
 	then
 		with_libmysql="no ($with_mysql_config failed)"
 	else
@@ -21899,97 +22188,76 @@
 	mysql_config_status=$?
 
 	if test $mysql_config_status -ne 0
 	then
 		with_libmysql="no ($with_mysql_config failed)"
 	else
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for mysql_init in -lmysqlclient" >&5
-$as_echo_n "checking for mysql_init in -lmysqlclient... " >&6; }
-if ${ac_cv_lib_mysqlclient_mysql_init+:} false; then :
+		SAVE_CPPFLAGS="$CPPFLAGS"
+		CPPFLAGS="$CPPFLAGS $with_mysql_cflags"
+		SAVE_LIBS="$LIBS"
+		LIBS="$with_mysql_libs"
+		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for library containing mysql_get_server_version" >&5
+$as_echo_n "checking for library containing mysql_get_server_version... " >&6; }
+if ${ac_cv_search_mysql_get_server_version+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lmysqlclient $with_mysql_libs $LIBS"
+  ac_func_search_save_LIBS=$LIBS
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
    builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-char mysql_init ();
+char mysql_get_server_version ();
 int
 main ()
 {
-return mysql_init ();
+return mysql_get_server_version ();
   ;
   return 0;
 }
 _ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_mysqlclient_mysql_init=yes
-else
-  ac_cv_lib_mysqlclient_mysql_init=no
+for ac_lib in '' ; do
+  if test -z "$ac_lib"; then
+    ac_res="none required"
+  else
+    ac_res=-l$ac_lib
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+  fi
+  if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_search_mysql_get_server_version=$ac_res
 fi
 rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_mysqlclient_mysql_init" >&5
-$as_echo "$ac_cv_lib_mysqlclient_mysql_init" >&6; }
-if test "x$ac_cv_lib_mysqlclient_mysql_init" = xyes; then :
-  with_libmysql="yes"
-else
-  with_libmysql="no (symbol 'mysql_init' not found)"
+    conftest$ac_exeext
+  if ${ac_cv_search_mysql_get_server_version+:} false; then :
+  break
 fi
+done
+if ${ac_cv_search_mysql_get_server_version+:} false; then :
 
-
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for mysql_get_server_version in -lmysqlclient" >&5
-$as_echo_n "checking for mysql_get_server_version in -lmysqlclient... " >&6; }
-if ${ac_cv_lib_mysqlclient_mysql_get_server_version+:} false; then :
-  $as_echo_n "(cached) " >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lmysqlclient $with_mysql_libs $LIBS"
-cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char mysql_get_server_version ();
-int
-main ()
-{
-return mysql_get_server_version ();
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_mysqlclient_mysql_get_server_version=yes
-else
-  ac_cv_lib_mysqlclient_mysql_get_server_version=no
+  ac_cv_search_mysql_get_server_version=no
 fi
-rm -f core conftest.err conftest.$ac_objext \
-    conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+rm conftest.$ac_ext
+LIBS=$ac_func_search_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_mysqlclient_mysql_get_server_version" >&5
-$as_echo "$ac_cv_lib_mysqlclient_mysql_get_server_version" >&6; }
-if test "x$ac_cv_lib_mysqlclient_mysql_get_server_version" = xyes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_mysql_get_server_version" >&5
+$as_echo "$ac_cv_search_mysql_get_server_version" >&6; }
+ac_res=$ac_cv_search_mysql_get_server_version
+if test "$ac_res" != no; then :
+  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
   with_libmysql="yes"
 else
   with_libmysql="no (symbol 'mysql_get_server_version' not found)"
 fi
 
+		CPPFLAGS="$SAVE_CPPFLAGS"
+		LIBS="$SAVE_LIBS"
 	fi
 fi
 if test "x$with_libmysql" = "xyes"
 then
 	BUILD_WITH_LIBMYSQL_CFLAGS="$with_mysql_cflags"
 	BUILD_WITH_LIBMYSQL_LIBS="$with_mysql_libs"
@@ -22989,29 +23257,12 @@
 
 done
 
 fi
 if test "x$with_libpcap" = "xyes"
 then
-	for ac_header in pcap-bpf.h
-do :
-  ac_fn_c_check_header_mongrel "$LINENO" "pcap-bpf.h" "ac_cv_header_pcap_bpf_h" "$ac_includes_default"
-if test "x$ac_cv_header_pcap_bpf_h" = xyes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_PCAP_BPF_H 1
-_ACEOF
-
-else
-  with_libpcap="no (pcap-bpf.h not found)"
-fi
-
-done
-
-fi
-if test "x$with_libpcap" = "xyes"
-then
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether libpcap has PCAP_ERROR_IFACE_NOT_UP" >&5
 $as_echo_n "checking whether libpcap has PCAP_ERROR_IFACE_NOT_UP... " >&6; }
 if ${c_cv_libpcap_have_pcap_error_iface_not_up+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -23021,12 +23272,13 @@
 
 int
 main ()
 {
 
   int val = PCAP_ERROR_IFACE_NOT_UP;
+  return(val);
 
 
   ;
   return 0;
 }
 _ACEOF
@@ -24107,42 +24359,205 @@
   BUILD_WITH_LIBROUTEROS_FALSE=
 fi
 
 # }}}
 
 # --with-librrd {{{
-# AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given])
 librrd_cflags=""
 librrd_ldflags=""
-librrd_threadsafe="yes"
+librrd_threadsafe="no"
 librrd_rrdc_update="no"
 
 # Check whether --with-librrd was given.
 if test "${with_librrd+set}" = set; then :
-  withval=$with_librrd; 	if test "x$withval" != "xno" && test "x$withval" != "xyes"
-	then
-		librrd_cflags="-I$withval/include"
-		librrd_ldflags="-L$withval/lib"
-		with_librrd="yes"
-	else
-		with_librrd="$withval"
-	fi
+  withval=$with_librrd;
+    if test "x$withval" != "xno" && test "x$withval" != "xyes"
+    then
+      librrd_cflags="-I$withval/include"
+      librrd_ldflags="-L$withval/lib"
+      with_librrd="yes"
+    else
+      with_librrd="$withval"
+    fi
 
 else
   with_librrd="yes"
+
 fi
 
+
 if test "x$with_librrd" = "xyes"
 then
-	SAVE_CPPFLAGS="$CPPFLAGS"
-	SAVE_LDFLAGS="$LDFLAGS"
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
+
+pkg_failed=no
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for RRD" >&5
+$as_echo_n "checking for RRD... " >&6; }
+
+if test -n "$RRD_CFLAGS"; then
+    pkg_cv_RRD_CFLAGS="$RRD_CFLAGS"
+ elif test -n "$PKG_CONFIG"; then
+    if test -n "$PKG_CONFIG" && \
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"librrd >= 1.6.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "librrd >= 1.6.0") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; then
+  pkg_cv_RRD_CFLAGS=`$PKG_CONFIG --cflags "librrd >= 1.6.0" 2>/dev/null`
+		      test "x$?" != "x0" && pkg_failed=yes
+else
+  pkg_failed=yes
+fi
+ else
+    pkg_failed=untried
+fi
+if test -n "$RRD_LIBS"; then
+    pkg_cv_RRD_LIBS="$RRD_LIBS"
+ elif test -n "$PKG_CONFIG"; then
+    if test -n "$PKG_CONFIG" && \
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"librrd >= 1.6.0\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "librrd >= 1.6.0") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; then
+  pkg_cv_RRD_LIBS=`$PKG_CONFIG --libs "librrd >= 1.6.0" 2>/dev/null`
+		      test "x$?" != "x0" && pkg_failed=yes
+else
+  pkg_failed=yes
+fi
+ else
+    pkg_failed=untried
+fi
+
+
+
+if test $pkg_failed = yes; then
+   	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
+        _pkg_short_errors_supported=yes
+else
+        _pkg_short_errors_supported=no
+fi
+        if test $_pkg_short_errors_supported = yes; then
+	        RRD_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "librrd >= 1.6.0" 2>&1`
+        else
+	        RRD_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "librrd >= 1.6.0" 2>&1`
+        fi
+	# Put the nasty error message in config.log where it belongs
+	echo "$RRD_PKG_ERRORS" >&5
+
+	:
+
+elif test $pkg_failed = untried; then
+     	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+	:
+
+else
+	RRD_CFLAGS=$pkg_cv_RRD_CFLAGS
+	RRD_LIBS=$pkg_cv_RRD_LIBS
+        { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrd_update_r in -lrrd" >&5
+$as_echo_n "checking for rrd_update_r in -lrrd... " >&6; }
+if ${ac_cv_lib_rrd_rrd_update_r+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lrrd  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char rrd_update_r ();
+int
+main ()
+{
+return rrd_update_r ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_lib_rrd_rrd_update_r=yes
+else
+  ac_cv_lib_rrd_rrd_update_r=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_rrd_update_r" >&5
+$as_echo "$ac_cv_lib_rrd_rrd_update_r" >&6; }
+if test "x$ac_cv_lib_rrd_rrd_update_r" = xyes; then :
+  librrd_threadsafe="yes"
+else
+  :
+
+fi
 
-	CPPFLAGS="$CPPFLAGS $librrd_cflags"
-	LDFLAGS="$LDFLAGS $librrd_ldflags"
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrdc_update in -lrrd" >&5
+$as_echo_n "checking for rrdc_update in -lrrd... " >&6; }
+if ${ac_cv_lib_rrd_rrdc_update+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lrrd  $LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
 
-	for ac_header in rrd.h
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char rrdc_update ();
+int
+main ()
+{
+return rrdc_update ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_lib_rrd_rrdc_update=yes
+else
+  ac_cv_lib_rrd_rrdc_update=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_rrdc_update" >&5
+$as_echo "$ac_cv_lib_rrd_rrdc_update" >&6; }
+if test "x$ac_cv_lib_rrd_rrdc_update" = xyes; then :
+  librrd_rrdc_update="yes"
+else
+  :
+
+fi
+
+
+fi
+  LDFLAGS="$SAVE_LDFLAGS"
+
+  SAVE_CPPFLAGS="$CPPFLAGS"
+  CPPFLAGS="$CPPFLAGS $RRD_CFLAGS $librrd_cflags"
+
+  for ac_header in rrd.h
 do :
   ac_fn_c_check_header_mongrel "$LINENO" "rrd.h" "ac_cv_header_rrd_h" "$ac_includes_default"
 if test "x$ac_cv_header_rrd_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
 #define HAVE_RRD_H 1
 _ACEOF
@@ -24151,30 +24566,27 @@
   with_librrd="no (rrd.h not found)"
 fi
 
 done
 
 
-	CPPFLAGS="$SAVE_CPPFLAGS"
-	LDFLAGS="$SAVE_LDFLAGS"
+  CPPFLAGS="$SAVE_CPPFLAGS"
 fi
-if test "x$with_librrd" = "xyes"
-then
-	SAVE_CPPFLAGS="$CPPFLAGS"
-	SAVE_LDFLAGS="$LDFLAGS"
 
-	CPPFLAGS="$CPPFLAGS $librrd_cflags"
-	LDFLAGS="$LDFLAGS $librrd_ldflags"
+if test "x$with_librrd" = "xyes" && test "x$librrd_threadsafe" = "xno"
+then
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
 
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrd_update_r in -lrrd_th" >&5
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrd_update_r in -lrrd_th" >&5
 $as_echo_n "checking for rrd_update_r in -lrrd_th... " >&6; }
 if ${ac_cv_lib_rrd_th_rrd_update_r+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lrrd_th -lm $LIBS"
+LIBS="-lrrd_th  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
    builtin and then its argument prototype would still apply.  */
@@ -24199,111 +24611,111 @@
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_th_rrd_update_r" >&5
 $as_echo "$ac_cv_lib_rrd_th_rrd_update_r" >&6; }
 if test "x$ac_cv_lib_rrd_th_rrd_update_r" = xyes; then :
-  with_librrd="yes"
-	 librrd_ldflags="$librrd_ldflags -lrrd_th -lm"
 
-else
-  librrd_threadsafe="no"
-	 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrd_update in -lrrd" >&5
-$as_echo_n "checking for rrd_update in -lrrd... " >&6; }
-if ${ac_cv_lib_rrd_rrd_update+:} false; then :
+      librrd_ldflags="$librrd_ldflags -lrrd_th"
+      librrd_threadsafe="yes"
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrdc_update in -lrrd_th" >&5
+$as_echo_n "checking for rrdc_update in -lrrd_th... " >&6; }
+if ${ac_cv_lib_rrd_th_rrdc_update+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lrrd -lm $LIBS"
+LIBS="-lrrd_th  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
    builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-char rrd_update ();
+char rrdc_update ();
 int
 main ()
 {
-return rrd_update ();
+return rrdc_update ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_rrd_rrd_update=yes
+  ac_cv_lib_rrd_th_rrdc_update=yes
 else
-  ac_cv_lib_rrd_rrd_update=no
+  ac_cv_lib_rrd_th_rrdc_update=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_rrd_update" >&5
-$as_echo "$ac_cv_lib_rrd_rrd_update" >&6; }
-if test "x$ac_cv_lib_rrd_rrd_update" = xyes; then :
-  with_librrd="yes"
-	  librrd_ldflags="$librrd_ldflags -lrrd -lm"
-
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_th_rrdc_update" >&5
+$as_echo "$ac_cv_lib_rrd_th_rrdc_update" >&6; }
+if test "x$ac_cv_lib_rrd_th_rrdc_update" = xyes; then :
+  librrd_rrdc_update="yes"
 else
-  with_librrd="no (symbol 'rrd_update' not found)"
+  :
 fi
 
 
+else
+  :
+
 fi
 
+  LDFLAGS="$SAVE_LDFLAGS"
+fi
 
-	if test "x$librrd_threadsafe" = "xyes"
-	then
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrdc_update in -lrrd_th" >&5
-$as_echo_n "checking for rrdc_update in -lrrd_th... " >&6; }
-if ${ac_cv_lib_rrd_th_rrdc_update+:} false; then :
+if test "x$with_librrd" = "xyes" && test "x$librrd_threadsafe" = "xno"
+then
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
+
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrd_update in -lrrd" >&5
+$as_echo_n "checking for rrd_update in -lrrd... " >&6; }
+if ${ac_cv_lib_rrd_rrd_update+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lrrd_th  $LIBS"
+LIBS="-lrrd  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
    builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-char rrdc_update ();
+char rrd_update ();
 int
 main ()
 {
-return rrdc_update ();
+return rrd_update ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_rrd_th_rrdc_update=yes
+  ac_cv_lib_rrd_rrd_update=yes
 else
-  ac_cv_lib_rrd_th_rrdc_update=no
+  ac_cv_lib_rrd_rrd_update=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_th_rrdc_update" >&5
-$as_echo "$ac_cv_lib_rrd_th_rrdc_update" >&6; }
-if test "x$ac_cv_lib_rrd_th_rrdc_update" = xyes; then :
-  librrd_rrdc_update="yes"
-else
-  librrd_rrdc_update="no"
-fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_rrd_update" >&5
+$as_echo "$ac_cv_lib_rrd_rrd_update" >&6; }
+if test "x$ac_cv_lib_rrd_rrd_update" = xyes; then :
 
-	else
-		{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrdc_update in -lrrd" >&5
+      librrd_ldflags="$librrd_ldflags -lrrd"
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for rrdc_update in -lrrd" >&5
 $as_echo_n "checking for rrdc_update in -lrrd... " >&6; }
 if ${ac_cv_lib_rrd_rrdc_update+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-lrrd  $LIBS"
@@ -24336,24 +24748,31 @@
 fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_rrd_rrdc_update" >&5
 $as_echo "$ac_cv_lib_rrd_rrdc_update" >&6; }
 if test "x$ac_cv_lib_rrd_rrdc_update" = xyes; then :
   librrd_rrdc_update="yes"
 else
-  librrd_rrdc_update="no"
+  :
+
 fi
 
-	fi
 
-	CPPFLAGS="$SAVE_CPPFLAGS"
-	LDFLAGS="$SAVE_LDFLAGS"
+else
+  with_librrd="no (symbol 'rrd_update' not found)"
+
 fi
+
+  LDFLAGS="$SAVE_LDFLAGS"
+fi
+
 if test "x$with_librrd" = "xyes"
 then
-	BUILD_WITH_LIBRRD_CFLAGS="$librrd_cflags"
-	BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
+  BUILD_WITH_LIBRRD_CFLAGS="$RRD_CFLAGS $librrd_cflags"
+  BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
+  BUILD_WITH_LIBRRD_LIBS="$RRD_LIBS"
+
 
 
 fi
 if test "x$librrd_threadsafe" = "xyes"
 then
 
@@ -26652,12 +27071,13 @@
 fi
 
 # Solaris
 if test "x$with_kstat" = "xyes"
 then
 	plugin_nfs="yes"
+	plugin_processes="yes"
 	plugin_uptime="yes"
 	plugin_zfs_arc="yes"
 fi
 
 if test "x$with_devinfo$with_kstat" = "xyesyes"
 then
@@ -26744,12 +27164,17 @@
 #fi
 if test "x$c_cv_have_one_getmntent" = "xyes"
 then
 	plugin_df="yes"
 fi
 
+if test "x$c_cv_have_getmntent_r" = "xyes"
+then
+	plugin_df="yes"
+fi
+
 # Df plugin: Check if we have either `statfs' or `statvfs' second.
 if test "x$plugin_df" = "xyes"
 then
 	plugin_df="no"
 	if test "x$have_statfs" = "xyes"
 	then
@@ -34333,12 +34758,16 @@
     fi
     ltdl_LIBOBJS=$_ltdl_libobjs
 
     ltdl_LTLIBOBJS=$_ltdl_ltlibobjs
 
 
+if test -z "${BUILD_INCLUDED_LTDL_TRUE}" && test -z "${BUILD_INCLUDED_LTDL_FALSE}"; then
+  as_fn_error $? "conditional \"BUILD_INCLUDED_LTDL\" was never defined.
+Usually this means the macro was only invoked conditionally." "$LINENO" 5
+fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking that generated files are newer than configure" >&5
 $as_echo_n "checking that generated files are newer than configure... " >&6; }
    if test -n "$am_sleep_pid"; then
      # Hide warnings about reused PIDs.
      wait $am_sleep_pid 2>/dev/null
    fi
@@ -35446,13 +35875,13 @@
 
 cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 # Save the log message, to keep $0 and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by collectd $as_me 5.4.2, which was
+This file was extended by collectd $as_me 5.4.3, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -35512,13 +35941,13 @@
 Report bugs to the package provider."
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-collectd config.status 5.4.2
+collectd config.status 5.4.3
 configured by $0, generated by GNU Autoconf 2.69,
   with options \\"\$ac_cs_config\\"
 
 Copyright (C) 2012 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
@@ -37462,33 +37891,37 @@
 cat <<EOF;
 
 Configuration:
   Libraries:
     intel mic . . . . . . $with_mic
     libaquaero5 . . . . . $with_libaquaero5
+    libcredis . . . . . . $with_libcredis
     libcurl . . . . . . . $with_libcurl
     libdbi  . . . . . . . $with_libdbi
-    libcredis . . . . . . $with_libcredis
     libesmtp  . . . . . . $with_libesmtp
     libganglia  . . . . . $with_libganglia
     libgcrypt . . . . . . $with_libgcrypt
+    libhal  . . . . . . . $with_libhal
     libiokit  . . . . . . $with_libiokit
     libiptc . . . . . . . $with_libiptc
     libjvm  . . . . . . . $with_java
     libkstat  . . . . . . $with_kstat
     libkvm  . . . . . . . $with_libkvm
+    liblvm2app  . . . . . $with_liblvm2app
     libmemcached  . . . . $with_libmemcached
     libmnl  . . . . . . . $with_libmnl
     libmodbus . . . . . . $with_libmodbus
+    libmongoc . . . . . . $with_libmongoc
     libmysql  . . . . . . $with_libmysql
     libnetapp . . . . . . $with_libnetapp
     libnetsnmp  . . . . . $with_libnetsnmp
     libnotify . . . . . . $with_libnotify
     liboconfig  . . . . . $with_liboconfig
     libopenipmi . . . . . $with_libopenipmipthread
     liboping  . . . . . . $with_liboping
+    libowcapi . . . . . . $with_libowcapi
     libpcap . . . . . . . $with_libpcap
     libperfstat . . . . . $with_perfstat
     libperl . . . . . . . $with_libperl
     libpq . . . . . . . . $with_libpq
     libpthread  . . . . . $with_libpthread
     librabbitmq . . . . . $with_librabbitmq
@@ -37501,15 +37934,14 @@
     libupsclient  . . . . $with_libupsclient
     libvarnish  . . . . . $with_libvarnish
     libvirt . . . . . . . $with_libvirt
     libxml2 . . . . . . . $with_libxml2
     libxmms . . . . . . . $with_libxmms
     libyajl . . . . . . . $with_libyajl
-    libevent  . . . . . . $with_libevent
-    protobuf-c  . . . . . $have_protoc_c
     oracle  . . . . . . . $with_oracle
+    protobuf-c  . . . . . $have_protoc_c
     python  . . . . . . . $with_python
 
   Features:
     daemon mode . . . . . $enable_daemon
     debug . . . . . . . . $enable_debug
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/configure.ac /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/configure.ac
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/configure.ac	2015-02-26 19:49:16.677658950 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/configure.ac	2016-07-26 15:47:12.945713764 +0800
@@ -1,12 +1,17 @@
 dnl Process this file with autoconf to produce a configure script.
 AC_INIT([collectd],[m4_esyscmd(./version-gen.sh)])
 AC_CONFIG_SRCDIR(src/collectd.c)
 AC_CONFIG_HEADERS(src/config.h)
 AC_CONFIG_AUX_DIR([libltdl/config])
 
+dnl older automake's default of ARFLAGS=cru is noisy on newer binutils;
+dnl we don't really need the 'u' even in older toolchains.  Then there is
+dnl older libtool, which spelled it AR_FLAGS
+m4_divert_text([DEFAULTS], [: "${ARFLAGS=cr} ${AR_FLAGS=cr}"])
+
 m4_ifdef([LT_PACKAGE_VERSION],
 	# libtool >= 2.2
 	[
 	 LT_CONFIG_LTDL_DIR([libltdl])
 	 LT_INIT([dlopen])
 	 LTDL_INIT([convenience])
@@ -21,12 +26,14 @@
 	 AC_LIBTOOL_DLOPEN
 	 AC_CONFIG_SUBDIRS(libltdl)
 	 AC_DEFINE(LIBTOOL_VERSION, 1, [Define to used libtool version.])
 	]
 )
 
+AM_CONDITIONAL([BUILD_INCLUDED_LTDL], [test "x$LTDLDEPS" != "x"])
+
 AM_INIT_AUTOMAKE([tar-pax dist-bzip2 foreign])
 m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])
 AC_LANG(C)
 
 AC_PREFIX_DEFAULT("/opt/collectd")
 
@@ -34,31 +41,59 @@
 
 #
 # Checks for programs.
 #
 AC_PROG_CC
 AC_PROG_CPP
+AC_PROG_EGREP
 AC_PROG_INSTALL
 AC_PROG_LN_S
 AC_PROG_MAKE_SET
 AM_PROG_CC_C_O
 AM_CONDITIONAL(COMPILER_IS_GCC, test "x$GCC" = "xyes")
 
 AC_DISABLE_STATIC
 AC_PROG_LIBTOOL
 AC_PROG_LEX
 AC_PROG_YACC
+
+# Warn when pkg.m4 is missing
+m4_pattern_forbid([^_?PKG_[A-Z_]+$],[*** pkg.m4 missing, please install pkg-config])
+
 PKG_PROG_PKG_CONFIG
 
+AC_CACHE_CHECK([if bison is the parser generator],
+	[collectd_cv_prog_bison],
+	[AS_IF([$YACC --version 2>/dev/null | $EGREP -q '^bison '],
+		[collectd_cv_prog_bison=yes], [collectd_cv_prog_bison=no]
+	)]
+)
+
+if test "x$collectd_cv_prog_bison" = "xno" && test ! -f "${srcdir}/src/liboconfig/parser.c"
+then
+	AC_MSG_ERROR([bison is missing and you do not have ${srcdir}/src/liboconfig/parser.c. Please install bison])
+fi
+
 AC_CHECK_PROG([have_protoc_c], [protoc-c], [yes], [no])
-AC_CHECK_HEADERS([google/protobuf-c/protobuf-c.h],
-                 [have_protobuf_c_h="yes"],
-                 [have_protobuf_c_h="no"])
-if test "x$have_protoc_c" = "xyes" && test "x$have_protobuf_c_h" != "xyes"
+if test "x$have_protoc_c" = "xno"
 then
-	have_protoc_c="no (unable to find <google/protobuf-c/protobuf-c.h>)"
+	have_protoc_c="no (protoc-c compiler not found)"
+fi
+
+if test "x$have_protoc_c" = "xyes"
+then
+	AC_CHECK_HEADERS([protobuf-c/protobuf-c.h google/protobuf-c/protobuf-c.h],
+			 [have_protoc_c="yes"; break],
+			 [have_protoc_c="no (<google/protobuf-c/protobuf-c.h> not found)"])
+fi
+if test "x$have_protoc_c" = "xyes"
+then
+	AC_CHECK_LIB([protobuf-c], [protobuf_c_message_pack],
+		     [have_protoc_c="yes"],
+		     [have_protoc_c="no (libprotobuf-c not found)"])
+
 fi
 AM_CONDITIONAL(HAVE_PROTOC_C, test "x$have_protoc_c" = "xyes")
 
 AC_MSG_CHECKING([for kernel type ($host_os)])
 case $host_os in
 	*linux*)
@@ -273,12 +308,60 @@
 #endif
 #if HAVE_NETINET_IP_H
 # include <netinet/ip.h>
 #endif
 ])
 
+have_ip6_ext="no"
+AC_CHECK_TYPES([struct ip6_ext], [have_ip6_ext="yes"], [have_ip6_ext="no"],
+[#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP6_H
+# include <netinet/ip6.h>
+#endif
+])
+
+if test "x$have_ip6_ext" = "xno"; then
+	SAVE_CFLAGS="$CFLAGS"
+	CFLAGS="$CFLAGS -DSOLARIS2=8"
+
+	AC_CHECK_TYPES([struct ip6_ext],
+		       [have_ip6_ext="yes, with -DSOLARIS2=8"],
+		       [have_ip6_ext="no"],
+[#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP6_H
+# include <netinet/ip6.h>
+#endif
+])
+
+	if test "x$have_ip6_ext" = "xno"; then
+		CFLAGS="$SAVE_CFLAGS"
+	fi
+fi
+
 # For cpu modules
 AC_CHECK_HEADERS(sys/dkstat.h)
 if test "x$ac_system" = "xDarwin"
 then
 	AC_CHECK_HEADERS(mach/mach_init.h mach/host_priv.h mach/mach_error.h mach/mach_host.h mach/mach_port.h mach/mach_types.h mach/message.h mach/processor_set.h mach/processor.h mach/processor_info.h mach/task.h mach/thread_act.h mach/vm_region.h mach/vm_map.h mach/vm_prot.h mach/vm_statistics.h mach/kern_return.h)
 	AC_CHECK_HEADERS(CoreFoundation/CoreFoundation.h IOKit/IOKitLib.h IOKit/IOTypes.h IOKit/ps/IOPSKeys.h IOKit/IOBSD.h IOKit/storage/IOBlockStorageDriver.h)
@@ -515,13 +598,39 @@
 [
 #if HAVE_SYS_SOCKET_H
 #	include <sys/socket.h>
 #endif
 ])
 
-AC_CHECK_HEADERS(pwd.h grp.h sys/un.h ctype.h limits.h xfs/xqm.h fs_info.h fshelp.h paths.h mntent.h mnttab.h sys/fstyp.h sys/fs_types.h sys/mntent.h sys/mnttab.h sys/statfs.h sys/statvfs.h sys/vfs.h sys/vfstab.h kvm.h wordexp.h)
+AC_CHECK_HEADERS([ \
+  ctype.h \
+  fs_info.h \
+  fshelp.h \
+  grp.h \
+  kvm.h \
+  limits.h \
+  mntent.h \
+  mnttab.h \
+  paths.h \
+  pwd.h \
+  sys/fs_types.h \
+  sys/fstyp.h \
+  sys/mntent.h \
+  sys/mnttab.h \
+  sys/statfs.h \
+  sys/statvfs.h \
+  sys/un.h \
+  sys/vfs.h \
+  sys/vfstab.h \
+  wordexp.h \
+])
+
+AC_CHECK_HEADERS([xfs/xqm.h], [], [],
+[
+#define _GNU_SOURCE
+])
 
 # For the dns plugin
 AC_CHECK_HEADERS(arpa/nameser.h)
 AC_CHECK_HEADERS(arpa/nameser_compat.h, [], [],
 [
 #if HAVE_ARPA_NAMESER_H
@@ -571,12 +680,15 @@
 #if HAVE_SYS_SOCKET_H
 # include <sys/socket.h>
 #endif
 #if HAVE_NET_IF_H
 # include <net/if.h>
 #endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
 ])
 
 # For the multimeter plugin
 have_termios_h="no"
 AC_CHECK_HEADERS(termios.h, [have_termios_h="yes"])
 
@@ -1137,12 +1249,14 @@
 have_getfsstat="no"
 AC_CHECK_FUNCS(getfsstat, [have_getfsstat="yes"])
 have_getvfsstat="no"
 AC_CHECK_FUNCS(getvfsstat, [have_getvfsstat="yes"])
 have_listmntent="no"
 AC_CHECK_FUNCS(listmntent, [have_listmntent="yes"])
+have_getmntent_r="no"
+AC_CHECK_FUNCS(getmntent_r, [have_getmntent_r="yes"])
 
 have_getmntent="no"
 AC_CHECK_FUNCS(getmntent, [have_getmntent="c"])
 if test "x$have_getmntent" = "xno"; then
 	AC_CHECK_LIB(sun, getmntent, [have_getmntent="sun"])
 fi
@@ -1163,12 +1277,13 @@
 ]]],
 [[[
 FILE *fh;
 struct mntent *me;
 fh = setmntent ("/etc/mtab", "r");
 me = getmntent (fh);
+return(me->mnt_passno);
 ]]]
 			)],
 			[c_cv_have_one_getmntent="yes"],
 			[c_cv_have_one_getmntent="no"]
 		)
 	)
@@ -1182,12 +1297,13 @@
 [[[
 				 FILE *fh;
 				 struct mnttab mt;
 				 int status;
 				 fh = fopen ("/etc/mnttab", "r");
 				 status = getmntent (fh, &mt);
+				 return(status);
 ]]]
 			)],
 			[c_cv_have_two_getmntent="yes"],
 			[c_cv_have_two_getmntent="no"]
 		)
 	)
@@ -1305,12 +1421,13 @@
 #include <sys/sysctl.h>
 #include <kvm.h>
 	])
 
 AC_CHECK_MEMBERS([struct udphdr.uh_dport, struct udphdr.uh_sport], [], [],
 [#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -1326,12 +1443,13 @@
 #if HAVE_NETINET_UDP_H
 # include <netinet/udp.h>
 #endif
 ])
 AC_CHECK_MEMBERS([struct udphdr.dest, struct udphdr.source], [], [],
 [#define _BSD_SOURCE
+#define _DEFAULT_SOURCE
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
@@ -1789,36 +1907,39 @@
  else if test -d "$withval"
  then
 	 GANGLIA_CPPFLAGS="-I$withval/include"
 	 GANGLIA_LDFLAGS="-L$withval/lib"
 	 with_libganglia="yes"
  else
-	 with_libganglia_config="ganglia-config"
 	 with_libganglia="$withval"
  fi; fi; fi
 ],
 [
- with_libganglia_config="ganglia-config"
  with_libganglia="yes"
 ])
 
-if test "x$with_libganglia" = "xyes" && test "x$with_libganglia_config" != "x"
+if test "x$with_libganglia" = "xyes"
 then
-	if test "x$GANGLIA_CPPFLAGS" = "x"
+	if test "x$with_libganglia_config" != "x"
 	then
-		GANGLIA_CPPFLAGS=`"$with_libganglia_config" --cflags 2>/dev/null`
-	fi
+		if test "x$GANGLIA_CPPFLAGS" = "x"
+		then
+			GANGLIA_CPPFLAGS=`"$with_libganglia_config" --cflags 2>/dev/null`
+		fi
 
-	if test "x$GANGLIA_LDFLAGS" = "x"
-	then
-		GANGLIA_LDFLAGS=`"$with_libganglia_config" --ldflags 2>/dev/null`
-	fi
+		if test "x$GANGLIA_LDFLAGS" = "x"
+		then
+			GANGLIA_LDFLAGS=`"$with_libganglia_config" --ldflags 2>/dev/null`
+		fi
 
-	if test "x$GANGLIA_LIBS" = "x"
-	then
-		GANGLIA_LIBS=`"$with_libganglia_config" --libs 2>/dev/null`
+		if test "x$GANGLIA_LIBS" = "x"
+		then
+			GANGLIA_LIBS=`"$with_libganglia_config" --libs 2>/dev/null`
+		fi
+	else
+		GANGLIA_LIBS="-lganglia"
 	fi
 fi
 
 SAVE_CPPFLAGS="$CPPFLAGS"
 SAVE_LDFLAGS="$LDFLAGS"
 CPPFLAGS="$CPPFLAGS $GANGLIA_CPPFLAGS"
@@ -1884,28 +2005,24 @@
 then
 	if test "x$GCRYPT_CPPFLAGS" = "x"
 	then
 		GCRYPT_CPPFLAGS=`"$with_libgcrypt_config" --cflags 2>/dev/null`
 	fi
 
-	if test "x$GCRYPT_LDFLAGS" = "x"
-	then
-		gcrypt_exec_prefix=`"$with_libgcrypt_config" --exec-prefix 2>/dev/null`
-		GCRYPT_LDFLAGS="-L$gcrypt_exec_prefix/lib"
-	fi
-
 	if test "x$GCRYPT_LIBS" = "x"
 	then
 		GCRYPT_LIBS=`"$with_libgcrypt_config" --libs 2>/dev/null`
 	fi
 fi
 
 SAVE_CPPFLAGS="$CPPFLAGS"
 SAVE_LDFLAGS="$LDFLAGS"
+SAVE_LIBS="$LIBS"
 CPPFLAGS="$CPPFLAGS $GCRYPT_CPPFLAGS"
 LDFLAGS="$LDFLAGS $GCRYPT_LDFLAGS"
+LIBS="$LIBS $GCRYPT_LIBS"
 
 if test "x$with_libgcrypt" = "xyes"
 then
 	if test "x$GCRYPT_CPPFLAGS" != "x"
 	then
 		AC_MSG_NOTICE([gcrypt CPPFLAGS: $GCRYPT_CPPFLAGS])
@@ -1914,16 +2031,12 @@
 		[with_libgcrypt="yes"],
 		[with_libgcrypt="no (gcrypt.h not found)"])
 fi
 
 if test "x$with_libgcrypt" = "xyes"
 then
-	if test "x$GCRYPT_LDFLAGS" != "x"
-	then
-		AC_MSG_NOTICE([gcrypt LDFLAGS: $GCRYPT_LDFLAGS])
-	fi
 	AC_CHECK_LIB(gcrypt, gcry_md_hash_buffer,
 		[with_libgcrypt="yes"],
 		[with_libgcrypt="no (symbol gcry_md_hash_buffer not found)"])
 
 	if test "$with_libgcrypt" != "no"; then
 		m4_ifdef([AM_PATH_LIBGCRYPT],[AM_PATH_LIBGCRYPT(1:1.2.0,,with_libgcrypt="no (version 1.2.0+ required)")])
@@ -1931,12 +2044,13 @@
 		GCRYPT_LIBS="$LIBGCRYPT_LIBS"
 	fi
 fi
 
 CPPFLAGS="$SAVE_CPPFLAGS"
 LDFLAGS="$SAVE_LDFLAGS"
+LIBS="$SAVE_LIBS"
 
 if test "x$with_libgcrypt" = "xyes"
 then
 	AC_DEFINE(HAVE_LIBGCRYPT, 1, [Define to 1 if you have the gcrypt library (-lgcrypt).])
 fi
 
@@ -2065,12 +2179,16 @@
 	AC_SUBST(BUILD_WITH_LIBIPTC_LDFLAGS)
 fi
 # }}}
 
 # --with-java {{{
 with_java_home="$JAVA_HOME"
+if test "x$with_java_home" = "x"
+then
+	with_java_home="/usr/lib/jvm"
+fi
 with_java_vmtype="client"
 with_java_cflags=""
 with_java_libs=""
 JAVAC="$JAVAC"
 JAR="$JAR"
 AC_ARG_WITH(java, [AS_HELP_STRING([--with-java@<:@=PREFIX@:>@], [Path to Java home.])],
@@ -2089,57 +2207,57 @@
 [with_java="yes"])
 if test "x$with_java" = "xyes"
 then
 	if test -d "$with_java_home"
 	then
 		AC_MSG_CHECKING([for jni.h])
-		TMPVAR=`find "$with_java_home" -name jni.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -name jni.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			AC_MSG_RESULT([found in $TMPVAR])
 			JAVA_CPPFLAGS="$JAVA_CPPFLAGS -I$TMPVAR"
 		else
 			AC_MSG_RESULT([not found])
 		fi
 
 		AC_MSG_CHECKING([for jni_md.h])
-		TMPVAR=`find "$with_java_home" -name jni_md.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -name jni_md.h -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			AC_MSG_RESULT([found in $TMPVAR])
 			JAVA_CPPFLAGS="$JAVA_CPPFLAGS -I$TMPVAR"
 		else
 			AC_MSG_RESULT([not found])
 		fi
 
 		AC_MSG_CHECKING([for libjvm.so])
-		TMPVAR=`find "$with_java_home" -name libjvm.so -type f -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
+		TMPVAR=`find -L "$with_java_home" -type f \( -name libjvm.so -o -name libjvm.dylib \) -exec 'dirname' '{}' ';' 2>/dev/null | head -n 1`
 		if test "x$TMPVAR" != "x"
 		then
 			AC_MSG_RESULT([found in $TMPVAR])
 			JAVA_LDFLAGS="$JAVA_LDFLAGS -L$TMPVAR -Wl,-rpath -Wl,$TMPVAR"
 		else
 			AC_MSG_RESULT([not found])
 		fi
 
 		if test "x$JAVAC" = "x"
 		then
 			AC_MSG_CHECKING([for javac])
-			TMPVAR=`find "$with_java_home" -name javac -type f 2>/dev/null | head -n 1`
+			TMPVAR=`find -L "$with_java_home" -name javac -type f 2>/dev/null | head -n 1`
 			if test "x$TMPVAR" != "x"
 			then
 				JAVAC="$TMPVAR"
 				AC_MSG_RESULT([$JAVAC])
 			else
 				AC_MSG_RESULT([not found])
 			fi
 		fi
 		if test "x$JAR" = "x"
 		then
 			AC_MSG_CHECKING([for jar])
-			TMPVAR=`find "$with_java_home" -name jar -type f 2>/dev/null | head -n 1`
+			TMPVAR=`find -L "$with_java_home" -name jar -type f 2>/dev/null | head -n 1`
 			if test "x$TMPVAR" != "x"
 			then
 				JAR="$TMPVAR"
 				AC_MSG_RESULT([$JAR])
 			else
 				AC_MSG_RESULT([not found])
@@ -2399,13 +2517,13 @@
 # the actual checks.
 if test "x$with_libmodbus" = "xyes"
 then
 	SAVE_CPPFLAGS="$CPPFLAGS"
 	CPPFLAGS="$CPPFLAGS $with_libmodbus_cflags"
 
-	AC_CHECK_HEADERS(modbus/modbus.h, [], [with_libmodbus="no (modbus/modbus.h not found)"])
+	AC_CHECK_HEADERS(modbus.h, [], [with_libmodbus="no (modbus.h not found)"])
 
 	CPPFLAGS="$SAVE_CPPFLAGS"
 fi
 if test "x$with_libmodbus" = "xyes"
 then
 	SAVE_CPPFLAGS="$CPPFLAGS"
@@ -2518,13 +2636,13 @@
 ],
 [
 	with_libmysql="yes"
 ])
 if test "x$with_libmysql" = "xyes"
 then
-	with_mysql_cflags=`$with_mysql_config --cflags 2>/dev/null`
+	with_mysql_cflags=`$with_mysql_config --include 2>/dev/null`
 	mysql_config_status=$?
 
 	if test $mysql_config_status -ne 0
 	then
 		with_libmysql="no ($with_mysql_config failed)"
 	else
@@ -2554,21 +2672,23 @@
 	mysql_config_status=$?
 
 	if test $mysql_config_status -ne 0
 	then
 		with_libmysql="no ($with_mysql_config failed)"
 	else
-		AC_CHECK_LIB(mysqlclient, mysql_init,
-		 [with_libmysql="yes"],
-		 [with_libmysql="no (symbol 'mysql_init' not found)"],
-		 [$with_mysql_libs])
-
-		AC_CHECK_LIB(mysqlclient, mysql_get_server_version,
+		SAVE_CPPFLAGS="$CPPFLAGS"
+		CPPFLAGS="$CPPFLAGS $with_mysql_cflags"
+		SAVE_LIBS="$LIBS"
+		LIBS="$with_mysql_libs"
+		AC_SEARCH_LIBS([mysql_get_server_version],
+		 [],
 		 [with_libmysql="yes"],
 		 [with_libmysql="no (symbol 'mysql_get_server_version' not found)"],
-		 [$with_mysql_libs])
+		 [])
+		CPPFLAGS="$SAVE_CPPFLAGS"
+		LIBS="$SAVE_LIBS"
 	fi
 fi
 if test "x$with_libmysql" = "xyes"
 then
 	BUILD_WITH_LIBMYSQL_CFLAGS="$with_mysql_cflags"
 	BUILD_WITH_LIBMYSQL_LIBS="$with_mysql_libs"
@@ -3073,25 +3193,21 @@
 then
 	AC_CHECK_HEADERS(pcap.h,,
 			 [with_libpcap="no (pcap.h not found)"])
 fi
 if test "x$with_libpcap" = "xyes"
 then
-	AC_CHECK_HEADERS(pcap-bpf.h,,
-			 [with_libpcap="no (pcap-bpf.h not found)"])
-fi
-if test "x$with_libpcap" = "xyes"
-then
 	AC_CACHE_CHECK([whether libpcap has PCAP_ERROR_IFACE_NOT_UP],
 		       [c_cv_libpcap_have_pcap_error_iface_not_up],
 		       AC_COMPILE_IFELSE([AC_LANG_PROGRAM(
 [[[
 #include <pcap.h>
 ]]],
 [[[
   int val = PCAP_ERROR_IFACE_NOT_UP;
+  return(val);
 ]]]
 		       )],
 		       [c_cv_libpcap_have_pcap_error_iface_not_up="yes"],
 		       [c_cv_libpcap_have_pcap_error_iface_not_up="no"]))
 fi
 if test "x$c_cv_libpcap_have_pcap_error_iface_not_up" != "xyes"
@@ -3687,82 +3803,108 @@
 	AC_SUBST(BUILD_WITH_LIBROUTEROS_LDFLAGS)
 fi
 AM_CONDITIONAL(BUILD_WITH_LIBROUTEROS, test "x$with_librouteros" = "xyes")
 # }}}
 
 # --with-librrd {{{
-# AC_ARG_WITH (package, help-string, [action-if-given], [action-if-not-given])
 librrd_cflags=""
 librrd_ldflags=""
-librrd_threadsafe="yes"
+librrd_threadsafe="no"
 librrd_rrdc_update="no"
-AC_ARG_WITH(librrd, [AS_HELP_STRING([--with-librrd@<:@=PREFIX@:>@], [Path to rrdtool.])],
-[	if test "x$withval" != "xno" && test "x$withval" != "xyes"
-	then
-		librrd_cflags="-I$withval/include"
-		librrd_ldflags="-L$withval/lib"
-		with_librrd="yes"
-	else
-		with_librrd="$withval"
-	fi
-], [with_librrd="yes"])
+AC_ARG_WITH(librrd,
+  [AS_HELP_STRING([--with-librrd@<:@=PREFIX@:>@], [Path to rrdtool.])],
+  [
+    if test "x$withval" != "xno" && test "x$withval" != "xyes"
+    then
+      librrd_cflags="-I$withval/include"
+      librrd_ldflags="-L$withval/lib"
+      with_librrd="yes"
+    else
+      with_librrd="$withval"
+    fi
+  ],
+  [with_librrd="yes"]
+)
+
 if test "x$with_librrd" = "xyes"
 then
-	SAVE_CPPFLAGS="$CPPFLAGS"
-	SAVE_LDFLAGS="$LDFLAGS"
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
+  PKG_CHECK_MODULES([RRD], [librrd >= 1.6.0],
+    [
+      AC_CHECK_LIB([rrd], [rrd_update_r],
+        [librrd_threadsafe="yes"],
+        [:]
+      )
+      AC_CHECK_LIB([rrd], [rrdc_update],
+        [librrd_rrdc_update="yes"],
+        [:]
+      )
+    ],[:]
+  )
+  LDFLAGS="$SAVE_LDFLAGS"
 
-	CPPFLAGS="$CPPFLAGS $librrd_cflags"
-	LDFLAGS="$LDFLAGS $librrd_ldflags"
+  SAVE_CPPFLAGS="$CPPFLAGS"
+  CPPFLAGS="$CPPFLAGS $RRD_CFLAGS $librrd_cflags"
 
-	AC_CHECK_HEADERS(rrd.h,, [with_librrd="no (rrd.h not found)"])
+  AC_CHECK_HEADERS([rrd.h],, [with_librrd="no (rrd.h not found)"])
 
-	CPPFLAGS="$SAVE_CPPFLAGS"
-	LDFLAGS="$SAVE_LDFLAGS"
+  CPPFLAGS="$SAVE_CPPFLAGS"
 fi
-if test "x$with_librrd" = "xyes"
-then
-	SAVE_CPPFLAGS="$CPPFLAGS"
-	SAVE_LDFLAGS="$LDFLAGS"
 
-	CPPFLAGS="$CPPFLAGS $librrd_cflags"
-	LDFLAGS="$LDFLAGS $librrd_ldflags"
+if test "x$with_librrd" = "xyes" && test "x$librrd_threadsafe" = "xno"
+then
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
 
-	AC_CHECK_LIB(rrd_th, rrd_update_r,
-	[with_librrd="yes"
-	 librrd_ldflags="$librrd_ldflags -lrrd_th -lm"
-	],
-	[librrd_threadsafe="no"
-	 AC_CHECK_LIB(rrd, rrd_update,
-	 [with_librrd="yes"
-	  librrd_ldflags="$librrd_ldflags -lrrd -lm"
-	 ],
-	 [with_librrd="no (symbol 'rrd_update' not found)"],
-	 [-lm])
-	],
-	[-lm])
+  AC_CHECK_LIB([rrd_th], [rrd_update_r],
+    [
+      librrd_ldflags="$librrd_ldflags -lrrd_th"
+      librrd_threadsafe="yes"
+      AC_CHECK_LIB([rrd_th], [rrdc_update],
+        [librrd_rrdc_update="yes"],
+        [:],
+      )
+    ],
+    [:]
+  )
+  LDFLAGS="$SAVE_LDFLAGS"
+fi
 
-	if test "x$librrd_threadsafe" = "xyes"
-	then
-		AC_CHECK_LIB(rrd_th, rrdc_update, [librrd_rrdc_update="yes"], [librrd_rrdc_update="no"])
-	else
-		AC_CHECK_LIB(rrd, rrdc_update, [librrd_rrdc_update="yes"], [librrd_rrdc_update="no"])
-	fi
+if test "x$with_librrd" = "xyes" && test "x$librrd_threadsafe" = "xno"
+then
+  SAVE_LDFLAGS="$LDFLAGS"
+  LDFLAGS="$LDFLAGS $librrd_ldflags"
 
-	CPPFLAGS="$SAVE_CPPFLAGS"
-	LDFLAGS="$SAVE_LDFLAGS"
+  AC_CHECK_LIB([rrd], [rrd_update],
+    [
+      librrd_ldflags="$librrd_ldflags -lrrd"
+      AC_CHECK_LIB([rrd], [rrdc_update],
+        [librrd_rrdc_update="yes"],
+        [:]
+      )
+    ],
+    [with_librrd="no (symbol 'rrd_update' not found)"]
+  )
+  LDFLAGS="$SAVE_LDFLAGS"
 fi
+
 if test "x$with_librrd" = "xyes"
 then
-	BUILD_WITH_LIBRRD_CFLAGS="$librrd_cflags"
-	BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
-	AC_SUBST(BUILD_WITH_LIBRRD_CFLAGS)
-	AC_SUBST(BUILD_WITH_LIBRRD_LDFLAGS)
+  BUILD_WITH_LIBRRD_CFLAGS="$RRD_CFLAGS $librrd_cflags"
+  BUILD_WITH_LIBRRD_LDFLAGS="$librrd_ldflags"
+  BUILD_WITH_LIBRRD_LIBS="$RRD_LIBS"
+  AC_SUBST(BUILD_WITH_LIBRRD_CFLAGS)
+  AC_SUBST(BUILD_WITH_LIBRRD_LDFLAGS)
+  AC_SUBST(BUILD_WITH_LIBRRD_LIBS)
 fi
 if test "x$librrd_threadsafe" = "xyes"
 then
-	AC_DEFINE(HAVE_THREADSAFE_LIBRRD, 1, [Define to 1 if you have the threadsafe rrd library (-lrrd_th).])
+  AC_DEFINE([HAVE_THREADSAFE_LIBRRD], [1],
+    [Define to 1 if the rrd library is thread-safe]
+  )
 fi
 # }}}
 
 # --with-libsensors {{{
 with_sensors_cflags=""
 with_sensors_ldflags=""
@@ -4944,12 +5086,13 @@
 fi
 
 # Solaris
 if test "x$with_kstat" = "xyes"
 then
 	plugin_nfs="yes"
+	plugin_processes="yes"
 	plugin_uptime="yes"
 	plugin_zfs_arc="yes"
 fi
 
 if test "x$with_devinfo$with_kstat" = "xyesyes"
 then
@@ -5036,12 +5179,17 @@
 #fi
 if test "x$c_cv_have_one_getmntent" = "xyes"
 then
 	plugin_df="yes"
 fi
 
+if test "x$c_cv_have_getmntent_r" = "xyes"
+then
+	plugin_df="yes"
+fi
+
 # Df plugin: Check if we have either `statfs' or `statvfs' second.
 if test "x$plugin_df" = "xyes"
 then
 	plugin_df="no"
 	if test "x$have_statfs" = "xyes"
 	then
@@ -5434,33 +5582,37 @@
 cat <<EOF;
 
 Configuration:
   Libraries:
     intel mic . . . . . . $with_mic
     libaquaero5 . . . . . $with_libaquaero5
+    libcredis . . . . . . $with_libcredis
     libcurl . . . . . . . $with_libcurl
     libdbi  . . . . . . . $with_libdbi
-    libcredis . . . . . . $with_libcredis
     libesmtp  . . . . . . $with_libesmtp
     libganglia  . . . . . $with_libganglia
     libgcrypt . . . . . . $with_libgcrypt
+    libhal  . . . . . . . $with_libhal
     libiokit  . . . . . . $with_libiokit
     libiptc . . . . . . . $with_libiptc
     libjvm  . . . . . . . $with_java
     libkstat  . . . . . . $with_kstat
     libkvm  . . . . . . . $with_libkvm
+    liblvm2app  . . . . . $with_liblvm2app
     libmemcached  . . . . $with_libmemcached
     libmnl  . . . . . . . $with_libmnl
     libmodbus . . . . . . $with_libmodbus
+    libmongoc . . . . . . $with_libmongoc
     libmysql  . . . . . . $with_libmysql
     libnetapp . . . . . . $with_libnetapp
     libnetsnmp  . . . . . $with_libnetsnmp
     libnotify . . . . . . $with_libnotify
     liboconfig  . . . . . $with_liboconfig
     libopenipmi . . . . . $with_libopenipmipthread
     liboping  . . . . . . $with_liboping
+    libowcapi . . . . . . $with_libowcapi
     libpcap . . . . . . . $with_libpcap
     libperfstat . . . . . $with_perfstat
     libperl . . . . . . . $with_libperl
     libpq . . . . . . . . $with_libpq
     libpthread  . . . . . $with_libpthread
     librabbitmq . . . . . $with_librabbitmq
@@ -5473,15 +5625,14 @@
     libupsclient  . . . . $with_libupsclient
     libvarnish  . . . . . $with_libvarnish
     libvirt . . . . . . . $with_libvirt
     libxml2 . . . . . . . $with_libxml2
     libxmms . . . . . . . $with_libxmms
     libyajl . . . . . . . $with_libyajl
-    libevent  . . . . . . $with_libevent
-    protobuf-c  . . . . . $have_protoc_c
     oracle  . . . . . . . $with_oracle
+    protobuf-c  . . . . . $have_protoc_c
     python  . . . . . . . $with_python
 
   Features:
     daemon mode . . . . . $enable_daemon
     debug . . . . . . . . $enable_debug
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/contrib/collectd2html.pl /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/contrib/collectd2html.pl
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/contrib/collectd2html.pl	2012-09-13 19:10:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/contrib/collectd2html.pl	2016-07-19 16:42:46.615749762 +0800
@@ -213,13 +213,13 @@
 	$cleaned_bn =~ tr/%\//__/;
 	print OUT <<END;
 <h2><a id="$cleaned_bn">$bn</a></h2>
 END
 
 	# graph various ranges
-	foreach my $span qw(1hour 1day 1week 1month){
+	foreach my $span (qw(1hour 1day 1week 1month)){
 		system("mkdir -p $IMG_DIR/" . dirname($bn));
 		my $img = "$IMG_DIR/${bn}-$span$IMG_SFX";
 
 		my $cmd = "rrdtool graph $img"
 			." -t \"$bn $span\" --imgformat $IMG_FMT --width 600 --height 100"
 			." --start now-$span --end now --interlaced"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/contrib/redhat/collectd.spec /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/contrib/redhat/collectd.spec
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/contrib/redhat/collectd.spec	2015-02-26 19:49:16.677658950 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/contrib/redhat/collectd.spec	2016-07-26 15:47:12.949713774 +0800
@@ -55,14 +55,15 @@
 %{?el7:%global _has_recent_sockios_h 1}
 %{?el7:%global _has_working_libiptc 1}
 %{?el7:%global _has_ip_vs_h 1}
 %{?el7:%global _has_lvm2app_h 1}
 %{?el7:%global _has_recent_librrd 1}
 %{?el7:%global _has_varnish4 1}
-%{?el7:%global _has_broken_libmemcached 1}
 %{?el7:%global _has_iproute 1}
+%{?el7:%global _has_libmodbus 1}
+%{?el7:%global _has_xmms 1}
 
 # plugins enabled by default
 %define with_aggregation 0%{!?_without_aggregation:1}
 %define with_amqp 0%{!?_without_amqp:1}
 %define with_apache 0%{!?_without_apache:1}
 %define with_apcups 0%{!?_without_apcups:1}
@@ -100,13 +101,13 @@
 %define with_load 0%{!?_without_load:1}
 %define with_logfile 0%{!?_without_logfile:1}
 %define with_lvm 0%{!?_without_lvm:0%{?_has_lvm2app_h}}
 %define with_madwifi 0%{!?_without_madwifi:1}
 %define with_mbmon 0%{!?_without_mbmon:1}
 %define with_md 0%{!?_without_md:1}
-%define with_memcachec 0%{!?_without_memcachec:0%{!?_has_broken_libmemcached:1}}
+%define with_memcachec 0%{!?_without_memcachec:1}
 %define with_memcached 0%{!?_without_memcached:1}
 %define with_memory 0%{!?_without_memory:1}
 %define with_multimeter 0%{!?_without_multimeter:1}
 %define with_modbus 0%{!?_without_modbus:0%{?_has_libmodbus}}
 %define with_mysql 0%{!?_without_mysql:1}
 %define with_netlink 0%{!?_without_netlink:0%{?_has_iproute}}
@@ -152,12 +153,13 @@
 %define with_vmem 0%{!?_without_vmem:1}
 %define with_vserver 0%{!?_without_vserver:1}
 %define with_wireless 0%{!?_without_wireless:1}
 %define with_write_graphite 0%{!?_without_write_graphite:1}
 %define with_write_http 0%{!?_without_write_http:1}
 %define with_write_riemann 0%{!?_without_write_riemann:1}
+%define with_xmms 0%{!?_without_xmms:0%{?_has_xmms}}
 
 # Plugins not built by default because of dependencies on libraries not
 # available in RHEL or EPEL:
 
 # plugin apple_sensors disabled, requires a Mac
 %define with_apple_sensors 0%{!?_without_apple_sensors:0}
@@ -186,20 +188,18 @@
 # plugin tokyotyrant disabled, requires tcrdb.h
 %define with_tokyotyrant 0%{!?_without_tokyotyrant:0}
 # plugin write_mongodb disabled, requires libmongoc
 %define with_write_mongodb 0%{!?_without_write_mongodb:0}
 # plugin write_redis disabled, requires credis
 %define with_write_redis 0%{!?_without_write_redis:0}
-# plugin xmms disabled, requires xmms
-%define with_xmms 0%{!?_without_xmms:0}
 # plugin zfs_arc disabled, requires FreeBSD/Solaris
 %define with_zfs_arc 0%{!?_without_zfs_arc:0}
 
-Summary:	Statistics collection daemon for filling RRD files
+Summary:	statistics collection and monitoring daemon
 Name:		collectd
-Version:	5.4.0
+Version:	5.4.2
 Release:	1%{?dist}
 URL:		http://collectd.org
 Source:		http://collectd.org/files/%{name}-%{version}.tar.bz2
 License:	GPLv2
 Group:		System Environment/Daemons
 BuildRoot:	%{_tmppath}/%{name}-%{version}-root
@@ -673,12 +673,22 @@
 Requires:	%{name}%{?_isa} = %{version}-%{release}
 BuildRequires:	protobuf-c-devel
 %description write_riemann
 The riemann plugin submits values to Riemann, an event stream processor.
 %endif
 
+%if %{with_xmms}
+%package xmms
+Summary:	XMMS plugin for collectd
+Group:		System Environment/Daemons
+Requires:	%{name}%{?_isa} = %{version}-%{release}
+BuildRequires:	xmms-devel
+%description xmms
+The xmms plugin collects information from the XMMS music player.
+%endif
+
 %package collection3
 Summary:	Web-based viewer for collectd
 Group:		System Environment/Daemons
 Requires:	%{name}%{?_isa} = %{version}-%{release}
 Requires: httpd
 %description collection3
@@ -831,13 +841,13 @@
 %define _with_curl_xml --disable-curl_xml
 %endif
 
 %if %{with_dbi}
 %define _with_dbi --enable-dbi
 %else
-%define _with_dbi --disable-dbi --without-libdbi
+%define _with_dbi --disable-dbi
 %endif
 
 %if %{with_df}
 %define _with_df --enable-df
 %else
 %define _with_df --disable-df
@@ -1065,13 +1075,13 @@
 %define _with_notify_desktop --disable-notify_desktop
 %endif
 
 %if %{with_notify_email}
 %define _with_notify_email --enable-notify_email
 %else
-%define _with_notify_email --disable-notify_email --without-libesmpt
+%define _with_notify_email --disable-notify_email
 %endif
 
 %if %{with_ntpd}
 %define _with_ntpd --enable-ntpd
 %else
 %define _with_ntpd --disable-ntpd
@@ -1113,13 +1123,13 @@
 %define _with_oracle --disable-oracle
 %endif
 
 %if %{with_perl}
 %define _with_perl --enable-perl --with-perl-bindings="INSTALLDIRS=vendor"
 %else
-%define _with_perl --disable-perl --without-libperl
+%define _with_perl --disable-perl
 %endif
 
 %if %{with_pf}
 %define _with_pf --enable-pf
 %else
 %define _with_pf --disable-pf
@@ -1357,19 +1367,19 @@
 %define _with_write_http --disable-write_http
 %endif
 
 %if %{with_write_mongodb}
 %define _with_write_mongodb --enable-write_mongodb
 %else
-%define _with_write_mongodb --disable-write_mongodb --without-libmongoc
+%define _with_write_mongodb --disable-write_mongodb
 %endif
 
 %if %{with_write_redis}
 %define _with_write_redis --enable-write_redis
 %else
-%define _with_write_redis --disable-write_redis --without-libcredis
+%define _with_write_redis --disable-write_redis
 %endif
 
 %if %{with_write_riemann}
 %define _with_write_riemann --enable-write_riemann
 %else
 %define _with_write_riemann --disable-write_riemann
@@ -1763,13 +1773,13 @@
 %if %{with_ted}
 %{_libdir}/%{name}/ted.so
 %endif
 %if %{with_thermal}
 %{_libdir}/%{name}/thermal.so
 %endif
-%if %{with_load}
+%if %{with_threshold}
 %{_libdir}/%{name}/threshold.so
 %endif
 %if %{with_unixsock}
 %{_libdir}/%{name}/unixsock.so
 %endif
 %if %{with_uptime}
@@ -1798,15 +1808,15 @@
 %files -n libcollectdclient-devel
 %{_includedir}/collectd/client.h
 %{_includedir}/collectd/network.h
 %{_includedir}/collectd/network_buffer.h
 %{_includedir}/collectd/lcc_features.h
 %{_libdir}/pkgconfig/libcollectdclient.pc
+%{_libdir}/libcollectdclient.so
 
 %files -n libcollectdclient
-%{_libdir}/libcollectdclient.so
 %{_libdir}/libcollectdclient.so.*
 
 %if %{with_amqp}
 %files amqp
 %{_libdir}/%{name}/amqp.so
 %endif
@@ -2023,29 +2033,35 @@
 
 %if %{with_write_riemann}
 %files write_riemann
 %{_libdir}/%{name}/write_riemann.so
 %endif
 
+%if %{with_xmms}
+%files xmms
+%{_libdir}/%{name}/xmms.so
+%endif
+
 %files collection3
 %{_localstatedir}/www/collection3
 %{_sysconfdir}/httpd/conf.d/collection3.conf
 
 %files php-collection
 %{_localstatedir}/www/php-collection
 %{_sysconfdir}/httpd/conf.d/php-collection.conf
 
 %files contrib
 %doc contrib/
 
 %changelog
-* Mon Aug 19 2013 Marc Fournier <marc.fournier@camptocamp.com> 5.4.0-1
+* Mon Aug 19 2013 Marc Fournier <marc.fournier@camptocamp.com> 5.4.2-1
 - New upstream version
 - Build netlink plugin by default
 - Enable cgroups, lvm and statsd plugins
 - Enable (but don't build by default) mic, aquaero and sigrok plugins
+- Enable modbus, memcachec and xmms plugins on RHEL7
 
 * Tue Aug 06 2013 Marc Fournier <marc.fournier@camptocamp.com> 5.3.1-1
 - New upstream version
 - Added RHEL5 support:
   * conditionally disable plugins not building on this platform
   * add/specify some build dependencies and options
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/contrib: wiki2commonmark.pl
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/Makefile.am	2015-02-26 18:43:48.448180028 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/Makefile.am	2016-07-26 15:47:12.945713764 +0800
@@ -1,11 +1,17 @@
 ACLOCAL_AMFLAGS = -I libltdl/m4
 
-SUBDIRS = libltdl src bindings .
+SUBDIRS =
 
-INCLUDES = $(LTDLINCL)
+if BUILD_INCLUDED_LTDL
+SUBDIRS += libltdl
+endif
+
+SUBDIRS += src bindings .
+
+AM_CPPFLAGS = $(LTDLINCL)
 
 EXTRA_DIST = contrib version-gen.sh
 
 install-exec-hook:
 	$(mkinstalldirs) $(DESTDIR)$(localstatedir)/run
 	$(mkinstalldirs) $(DESTDIR)$(localstatedir)/lib/$(PACKAGE_NAME)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/Makefile.in	2015-02-26 22:07:46.957220729 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/Makefile.in	2016-07-26 15:47:21.085733684 +0800
@@ -74,12 +74,13 @@
 POST_INSTALL = :
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
+@BUILD_INCLUDED_LTDL_TRUE@am__append_1 = libltdl
 subdir = .
 DIST_COMMON = $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
 	$(top_srcdir)/configure $(am__configure_deps) \
 	$(top_srcdir)/src/libcollectdclient/collectd/lcc_features.h.in \
 	AUTHORS COPYING ChangeLog INSTALL NEWS README TODO compile \
 	libltdl/config/compile config.guess \
@@ -155,13 +156,13 @@
   unique=`for i in $$list; do \
     if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
   done | $(am__uniquify_input)`
 ETAGS = etags
 CTAGS = ctags
 CSCOPE = cscope
-DIST_SUBDIRS = $(SUBDIRS)
+DIST_SUBDIRS = libltdl src bindings .
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
 distdir = $(PACKAGE)-$(VERSION)
 top_distdir = $(distdir)
 am__remove_distdir = \
   if test -d "$(distdir)"; then \
     find "$(distdir)" -type d ! -perm -200 -exec chmod u+w {} ';' \
@@ -247,12 +248,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -392,12 +394,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
@@ -458,14 +462,14 @@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 ACLOCAL_AMFLAGS = -I libltdl/m4
-SUBDIRS = libltdl src bindings .
-INCLUDES = $(LTDLINCL)
+SUBDIRS = $(am__append_1) src bindings .
+AM_CPPFLAGS = $(LTDLINCL)
 EXTRA_DIST = contrib version-gen.sh
 all: all-recursive
 
 .SUFFIXES:
 am--refresh: Makefile
 	@:
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/README	2015-02-26 19:44:34.019896240 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/README	2016-07-26 15:47:12.945713764 +0800
@@ -411,13 +411,13 @@
       Sends the values to a Redis key-value database server.
 
     - write_riemann
       Sends data to Riemann, a stream processing and monitoring system.
 
   * Logging is, as everything in collectd, provided by plugins. The following
-    plugins keep up informed about what's going on:
+    plugins keep us informed about what's going on:
 
     - logfile
       Writes logmessages to a file or STDOUT/STDERR.
 
     - perl
       Log messages are propagated to plugins written in Perl as well.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/aggregation.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/aggregation.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/aggregation.c	2014-08-18 15:36:18.632139234 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/aggregation.c	2016-07-26 15:47:12.949713774 +0800
@@ -259,12 +259,13 @@
 #define INIT_STATE(field) do { \
   inst->state_ ## field = NULL; \
   if (agg->calc_ ## field) { \
     inst->state_ ## field = malloc (sizeof (*inst->state_ ## field)); \
     if (inst->state_ ## field == NULL) { \
       agg_instance_destroy (inst); \
+      free (inst); \
       ERROR ("aggregation plugin: malloc() failed."); \
       return (NULL); \
     } \
     memset (inst->state_ ## field, 0, sizeof (*inst->state_ ## field)); \
   } \
 } while (0)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/amqp.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/amqp.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/amqp.c	2015-02-26 19:44:34.023896321 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/amqp.c	2016-07-26 15:47:12.949713774 +0800
@@ -191,29 +191,29 @@
     amqp_rpc_reply_t r;
 
     r = amqp_get_rpc_reply (conf->connection);
     switch (r.reply_type)
     {
         case AMQP_RESPONSE_NORMAL:
-            sstrncpy (buffer, "Success", sizeof (buffer));
+            sstrncpy (buffer, "Success", buffer_size);
             break;
 
         case AMQP_RESPONSE_NONE:
-            sstrncpy (buffer, "Missing RPC reply type", sizeof (buffer));
+            sstrncpy (buffer, "Missing RPC reply type", buffer_size);
             break;
 
         case AMQP_RESPONSE_LIBRARY_EXCEPTION:
 #if HAVE_AMQP_RPC_REPLY_T_LIBRARY_ERRNO
             if (r.library_errno)
                 return (sstrerror (r.library_errno, buffer, buffer_size));
 #else
             if (r.library_error)
                 return (sstrerror (r.library_error, buffer, buffer_size));
 #endif
             else
-                sstrncpy (buffer, "End of stream", sizeof (buffer));
+                sstrncpy (buffer, "End of stream", buffer_size);
             break;
 
         case AMQP_RESPONSE_SERVER_EXCEPTION:
             if (r.reply.id == AMQP_CONNECTION_CLOSE_METHOD)
             {
                 amqp_connection_close_t *m = r.reply.decoded;
@@ -296,12 +296,16 @@
     ed_ret = amqp_exchange_declare (conf->connection,
             /* channel     = */ CAMQP_CHANNEL,
             /* exchange    = */ amqp_cstring_bytes (conf->exchange),
             /* type        = */ amqp_cstring_bytes (conf->exchange_type),
             /* passive     = */ 0,
             /* durable     = */ 0,
+#if defined(AMQP_VERSION) && AMQP_VERSION >= 0x00060000
+            /* auto delete = */ 0,
+            /* internal    = */ 0,
+#endif
             /* arguments   = */ argument_table);
     if ((ed_ret == NULL) && camqp_is_error (conf))
     {
         char errbuf[1024];
         ERROR ("amqp plugin: amqp_exchange_declare failed: %s",
                 camqp_strerror (conf, errbuf, sizeof (errbuf)));
@@ -689,13 +693,13 @@
         {
             DEBUG ("amqp plugin: Unexpected method id: %#"PRIx32,
                     frame.payload.method.id);
             continue;
         }
 
-        status = camqp_read_header (conf);
+        camqp_read_header (conf);
 
         amqp_maybe_release_buffers (conf->connection);
     } /* while (subscriber_threads_running) */
 
     camqp_config_free (conf);
     pthread_exit (NULL);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/apache.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/apache.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/apache.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/apache.c	2016-07-26 15:47:12.949713774 +0800
@@ -75,12 +75,13 @@
 	sfree (st->server);
 	sfree (st->apache_buffer);
 	if (st->curl) {
 		curl_easy_cleanup(st->curl);
 		st->curl = NULL;
 	}
+	sfree (st);
 } /* apache_free */
 
 static size_t apache_curl_callback (void *buf, size_t size, size_t nmemb,
 		void *user_data)
 {
 	size_t len = size * nmemb;
@@ -581,33 +582,33 @@
 		submit_gauge ("apache_scoreboard", "response_end"  , response_end, st);
 	}
 }
 
 static int apache_read_host (user_data_t *user_data) /* {{{ */
 {
-	int i;
-
 	char *ptr;
 	char *saveptr;
-	char *lines[16];
-	int   lines_num = 0;
+	char *line;
 
 	char *fields[4];
 	int   fields_num;
 
 	apache_t *st;
 
 	st = user_data->data;
 
+	int status;
+
+	char *content_type;
+	static const char *text_plain = "text/plain";
+
 	assert (st->url != NULL);
 	/* (Assured by `config_add') */
 
 	if (st->curl == NULL)
 	{
-		int status;
-
 		status = init_host (st);
 		if (status != 0)
 			return (-1);
 	}
 	assert (st->curl != NULL);
 
@@ -624,37 +625,35 @@
 	{
 		WARNING ("apache plugin: Unable to determine server software "
 				"automatically. Will assume Apache.");
 		st->server_type = APACHE;
 	}
 
+	status = curl_easy_getinfo (st->curl, CURLINFO_CONTENT_TYPE, &content_type);
+	if ((status == CURLE_OK) && (content_type != NULL) &&
+	    (strncasecmp (content_type, text_plain, strlen (text_plain)) != 0))
+	{
+		WARNING ("apache plugin: `Content-Type' response header is not `%s' "
+			"(received: `%s'). Expecting unparseable data. Please check `URL' "
+			"parameter (missing `?auto' suffix ?)",
+			text_plain, content_type);
+	}
+
 	ptr = st->apache_buffer;
 	saveptr = NULL;
-	while ((lines[lines_num] = strtok_r (ptr, "\n\r", &saveptr)) != NULL)
+	while ((line = strtok_r (ptr, "\n\r", &saveptr)) != NULL)
 	{
 		ptr = NULL;
-		lines_num++;
-
-		if (lines_num >= 16)
-			break;
-	}
-
-	for (i = 0; i < lines_num; i++)
-	{
-		fields_num = strsplit (lines[i], fields, 4);
+		fields_num = strsplit (line, fields, STATIC_ARRAY_SIZE (fields));
 
 		if (fields_num == 3)
 		{
-			if ((strcmp (fields[0], "Total") == 0)
-					&& (strcmp (fields[1], "Accesses:") == 0))
-				submit_derive ("apache_requests", "",
-						atoll (fields[2]), st);
-			else if ((strcmp (fields[0], "Total") == 0)
-					&& (strcmp (fields[1], "kBytes:") == 0))
-				submit_derive ("apache_bytes", "",
-						1024LL * atoll (fields[2]), st);
+			if ((strcmp (fields[0], "Total") == 0) && (strcmp (fields[1], "Accesses:") == 0))
+				submit_derive ("apache_requests", "", atoll (fields[2]), st);
+			else if ((strcmp (fields[0], "Total") == 0) && (strcmp (fields[1], "kBytes:") == 0))
+				submit_derive ("apache_bytes", "", 1024LL * atoll (fields[2]), st);
 		}
 		else if (fields_num == 2)
 		{
 			if (strcmp (fields[0], "Scoreboard:") == 0)
 				submit_scoreboard (fields[1], st);
 			else if ((strcmp (fields[0], "BusyServers:") == 0) /* Apache 1.* */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/apcups.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/apcups.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/apcups.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/apcups.c	2016-07-26 15:47:12.953713783 +0800
@@ -136,13 +136,13 @@
 	ai_hints.ai_socktype = SOCK_STREAM;
 
 	status = getaddrinfo (host, port_str, &ai_hints, &ai_return);
 	if (status != 0)
 	{
 		char errbuf[1024];
-		INFO ("getaddrinfo failed: %s",
+		INFO ("apcups plugin: getaddrinfo failed: %s",
 				(status == EAI_SYSTEM)
 				? sstrerror (errno, errbuf, sizeof (errbuf))
 				: gai_strerror (status));
 		return (-1);
 	}
 
@@ -155,31 +155,31 @@
 			break;
 	}
 	/* `ai_list' still holds the current description of the socket.. */
 
 	if (sd < 0)
 	{
-		DEBUG ("Unable to open a socket");
+		DEBUG ("apcups plugin: Unable to open a socket");
 		freeaddrinfo (ai_return);
 		return (-1);
 	}
 
 	status = connect (sd, ai_list->ai_addr, ai_list->ai_addrlen);
 
 	freeaddrinfo (ai_return);
 
 	if (status != 0) /* `connect(2)' failed */
 	{
 		char errbuf[1024];
-		INFO ("connect failed: %s",
+		INFO ("apcups plugin: connect failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		close (sd);
 		return (-1);
 	}
 
-	DEBUG ("Done opening a socket %i", sd);
+	DEBUG ("apcups plugin: Done opening a socket %i", sd);
 
 	return (sd);
 } /* int net_open (char *host, char *service, int port) */
 
 /*
  * Receive a message from the other end. Each message consists of
@@ -477,13 +477,13 @@
 	/*
 	 * if we did not connect then do not bother submitting
 	 * zeros. We want rrd files to have NAN.
 	 */
 	if (status != 0)
 	{
-		DEBUG ("apc_query_server (%s, %i) = %i",
+		DEBUG ("apcups plugin: apc_query_server (%s, %i) = %i",
 				conf_host == NULL
 				? APCUPS_DEFAULT_HOST
 				: conf_host,
 				conf_port, status);
 		return (-1);
 	}
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/battery.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/battery.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/battery.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/battery.c	2016-07-26 15:47:12.953713783 +0800
@@ -108,13 +108,13 @@
 	sstrncpy (vl.type, type, sizeof (vl.type));
 
 	plugin_dispatch_values (&vl);
 } /* void battery_submit */
 
 #if HAVE_IOKIT_PS_IOPOWERSOURCES_H || HAVE_IOKIT_IOKITLIB_H
-double dict_get_double (CFDictionaryRef dict, char *key_string)
+static double dict_get_double (CFDictionaryRef dict, char *key_string)
 {
 	double      val_double;
 	long long   val_int;
 	CFNumberRef val_obj;
 	CFStringRef key_obj;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/bind.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/bind.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/bind.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/bind.c	2016-07-26 15:47:12.953713783 +0800
@@ -263,13 +263,13 @@
     replace_special (vl.plugin_instance, sizeof (vl.plugin_instance));
   }
   sstrncpy(vl.type, type, sizeof(vl.type));
   if (type_instance) {
     sstrncpy(vl.type_instance, type_instance,
         sizeof(vl.type_instance));
-    replace_special (vl.plugin_instance, sizeof (vl.plugin_instance));
+    replace_special (vl.type_instance, sizeof (vl.type_instance));
   }
   plugin_dispatch_values(&vl);
 } /* }}} void submit */
 
 static size_t bind_curl_callback (void *buf, size_t size, /* {{{ */
     size_t nmemb, void __attribute__((unused)) *stream)
@@ -723,14 +723,12 @@
     xmlXPathFreeContext (zone_path_context);
     return (-1);
   }
 
   for (i = 0; i < zone_nodes->nodesetval->nodeNr; i++)
   {
-    xmlNode *node;
-
     node = zone_nodes->nodesetval->nodeTab[i];
     assert (node != NULL);
 
     zone_path_context->node = node;
 
     bind_xml_stats_handle_zone (version, doc, zone_path_context, node, view,
@@ -1308,13 +1306,13 @@
   tmp->zones_num = 0;
 
   tmp->name = strdup (ci->values[0].value.string);
   if (tmp->name == NULL)
   {
     ERROR ("bind plugin: strdup failed.");
-    free (tmp);
+    sfree (views);
     return (-1);
   }
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *child = ci->children + i;
@@ -1351,12 +1349,13 @@
       {
         WARNING ("bind plugin: The `Url' option needs "
                  "exactly one string argument.");
         return (-1);
       }
 
+      sfree (url);
       url = strdup (child->values[0].value.string);
     } else if (strcasecmp ("OpCodes", child->key) == 0)
       bind_config_set_bool ("OpCodes", &global_opcodes, child);
     else if (strcasecmp ("QTypes", child->key) == 0)
       bind_config_set_bool ("QTypes", &global_qtypes, child);
     else if (strcasecmp ("ServerStats", child->key) == 0)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.1	2015-02-26 18:47:24.544473468 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.1	2016-07-26 15:48:06.873845413 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD 1"
-.TH COLLECTD 1 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD 1 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd \- System statistics collection daemon
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.c	2015-02-26 18:43:48.464180347 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.c	2016-07-26 15:47:12.953713783 +0800
@@ -179,14 +179,16 @@
 	}
 	
 	dirlen = strlen (dir);
 	while ((dirlen > 0) && (dir[dirlen - 1] == '/'))
 		dir[--dirlen] = '\0';
 
-	if (dirlen <= 0)
+	if (dirlen <= 0) {
+		free (dir);
 		return (-1);
+	}
 
 	status = chdir (dir);
 	if (status == 0)
 	{
 		free (dir);
 		return (0);
@@ -381,14 +383,15 @@
 	return (0);
 } /* static int pidfile_create (const char *file) */
 
 static int pidfile_remove (void)
 {
 	const char *file = global_option_get ("PIDFile");
+	if (file == NULL)
+		return 0;
 
-	DEBUG ("unlink (%s)", (file != NULL) ? file : "<null>");
 	return (unlink (file));
 } /* static int pidfile_remove (const char *file) */
 #endif /* COLLECT_DAEMON */
 
 int main (int argc, char **argv)
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.5	2015-02-26 22:10:02.408032220 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.5	2016-07-26 15:48:07.489846912 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD.CONF 5"
-.TH COLLECTD.CONF 5 "2015-02-26" "5.4.2" "collectd"
+.TH COLLECTD.CONF 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd.conf \- Configuration for the system statistics collection daemon collectd
@@ -229,15 +229,14 @@
 \& LoadPlugin "cpu"
 .Ve
 .Sp
 Options inside a \fBLoadPlugin\fR block can override default settings and
 influence the way plugins are loaded, e.g.:
 .Sp
-.Vb 4
+.Vb 3
 \& <LoadPlugin perl>
-\&   Globals true
 \&   Interval 60
 \& </LoadPlugin>
 .Ve
 .Sp
 The following options are valid inside \fBLoadPlugin\fR blocks:
 .RS 4
@@ -305,17 +304,13 @@
 .IX Item "Filter pattern"
 If the \f(CW\*(C`fnmatch\*(C'\fR function is available on your system, a shell-like wildcard
 \&\fIpattern\fR may be specified to filter which files to include. This may be used
 in combination with recursively including a directory to easily be able to
 arbitrarily mix configuration files and other documents (e.g. \s-1README\s0 files).
 The given example is similar to the first example above but includes all files
-matching \f(CW\*(C`*.conf\*(C'\fR in any subdirectory of \f(CW\*(C`/etc/collectd.d\*(C'\fR:
-.Sp
-.Vb 1
-\&  Include "/etc/collectd.d" "*.conf"
-.Ve
+matching \f(CW\*(C`*.conf\*(C'\fR in any subdirectory of \f(CW\*(C`/etc/collectd.d\*(C'\fR.
 .RE
 .RS 4
 .Sp
 If more than one files are included by a single \fBInclude\fR option, the files
 will be included in lexicographical order (as defined by the \f(CW\*(C`strcmp\*(C'\fR
 function). Thus, you can e.\ g. use numbered prefixes to specify the
@@ -596,13 +591,13 @@
 Boolean options for enabling calculation of the number of value lists, their
 sum, average, minimum, maximum and\ / or standard deviation. All options
 are disabled by default.
 .ie n .SS "Plugin ""amqp"""
 .el .SS "Plugin \f(CWamqp\fP"
 .IX Subsection "Plugin amqp"
-The \fI\s-1AMQMP\s0 plugin\fR can be used to communicate with other instances of
+The \fI\s-1AMQP\s0 plugin\fR can be used to communicate with other instances of
 \&\fIcollectd\fR or third party applications using an \s-1AMQP\s0 message broker. Values
 are sent to or received from the broker, which handles routing, queueing and
 possibly filtering or messages.
 .PP
 .Vb 10
 \& <Plugin "amqp">
@@ -621,13 +616,13 @@
 \& #   StoreRates false
 \& #   GraphitePrefix "collectd."
 \& #   GraphiteEscapeChar "_"
 \& #   GraphiteSeparateInstances false
 \& #   GraphiteAlwaysAppendDS false
 \&   </Publish>
-\&   
+\&
 \&   # Receive values from an AMQP broker
 \&   <Subscribe "some_name">
 \&     Host "localhost"
 \&     Port "5672"
 \&     VHost "/"
 \&     User "guest"
@@ -1155,13 +1150,13 @@
 plugin below on how matches are defined. If the \fBMeasureResponseTime\fR option
 is set to \fBtrue\fR, \fBMatch\fR blocks are optional.
 .ie n .SS "Plugin ""curl_json"""
 .el .SS "Plugin \f(CWcurl_json\fP"
 .IX Subsection "Plugin curl_json"
 The \fBcurl_json plugin\fR collects values from \s-1JSON\s0 data to be parsed by
-\&\fBlibyajl\fR (<http://www.lloydforge.org/projects/yajl/>) retrieved via
+\&\fBlibyajl\fR (<https://lloyd.github.io/yajl/>) retrieved via
 either \fBlibcurl\fR (<http://curl.haxx.se/>) or read directly from a
 unix socket. The former can be used, for example, to collect values
 from CouchDB documents (which are stored \s-1JSON\s0 notation), and the
 latter to collect values from a uWSGI stats socket.
 .PP
 The following example will collect several values from the built-in
@@ -1215,14 +1210,28 @@
 values for all map keys or array indices will be collectd.
 .PP
 The following options are valid within \fB\s-1URL\s0\fR blocks:
 .IP "\fBInstance\fR \fIInstance\fR" 4
 .IX Item "Instance Instance"
 Sets the plugin instance to \fIInstance\fR.
-.IP "\fBUser\fR \fIName\fR =item \fBPassword\fR \fIPassword\fR =item \fBVerifyPeer\fR \fBtrue\fR|\fBfalse\fR =item \fBVerifyHost\fR \fBtrue\fR|\fBfalse\fR =item \fBCACert\fR \fIfile\fR =item \fBHeader\fR \fIHeader\fR =item \fBPost\fR \fIBody\fR" 4
-.IX Item "User Name =item Password Password =item VerifyPeer true|false =item VerifyHost true|false =item CACert file =item Header Header =item Post Body"
+.IP "\fBUser\fR \fIName\fR" 4
+.IX Item "User Name"
+.PD 0
+.IP "\fBPassword\fR \fIPassword\fR" 4
+.IX Item "Password Password"
+.IP "\fBVerifyPeer\fR \fBtrue\fR|\fBfalse\fR" 4
+.IX Item "VerifyPeer true|false"
+.IP "\fBVerifyHost\fR \fBtrue\fR|\fBfalse\fR" 4
+.IX Item "VerifyHost true|false"
+.IP "\fBCACert\fR \fIfile\fR" 4
+.IX Item "CACert file"
+.IP "\fBHeader\fR \fIHeader\fR" 4
+.IX Item "Header Header"
+.IP "\fBPost\fR \fIBody\fR" 4
+.IX Item "Post Body"
+.PD
 These options behave exactly equivalent to the appropriate options of the
 \&\fIcURL\fR plugin. Please see there for a detailed description.
 .PP
 The following options are valid within \fBKey\fR blocks:
 .IP "\fBType\fR \fIType\fR" 4
 .IX Item "Type Type"
@@ -1932,20 +1941,38 @@
 .IP "\fBInterface\fR \fIInterface\fR" 4
 .IX Item "Interface Interface"
 Select this interface. By default these interfaces will then be collected. For
 a more detailed description see \fBIgnoreSelected\fR below.
 .IP "\fBIgnoreSelected\fR \fItrue\fR|\fIfalse\fR" 4
 .IX Item "IgnoreSelected true|false"
-If no configuration if given, the \fBtraffic\fR\-plugin will collect data from
+If no configuration if given, the \fBinterface\fR\-plugin will collect data from
 all interfaces. This may not be practical, especially for loopback\- and
 similar interfaces. Thus, you can use the \fBInterface\fR\-option to pick the
 interfaces you're interested in. Sometimes, however, it's easier/preferred
 to collect all interfaces \fIexcept\fR a few ones. This option enables you to
 do that: By setting \fBIgnoreSelected\fR to \fItrue\fR the effect of
 \&\fBInterface\fR is inverted: All selected interfaces are ignored and all
 other interfaces are collected.
+.Sp
+It is possible to use regular expressions to match interface names, if the
+name is surrounded by \fI/.../\fR and collectd was compiled with support for
+regexps. This is useful if there's a need to collect (or ignore) data
+for a group of interfaces that are similarly named, without the need to
+explicitly list all of them (especially useful if the list is dynamic).
+Example:
+.Sp
+.Vb 4
+\& Interface "lo"
+\& Interface "/^veth/"
+\& Interface "/^tun[0\-9]+/"
+\& IgnoreSelected "true"
+.Ve
+.Sp
+This will ignore the loopback interface, all interfaces with names starting
+with \fIveth\fR and all interfaces with names starting with \fItun\fR followed by
+at least one digit.
 .ie n .SS "Plugin ""ipmi"""
 .el .SS "Plugin \f(CWipmi\fP"
 .IX Subsection "Plugin ipmi"
 .IP "\fBSensor\fR \fISensor\fR" 4
 .IX Item "Sensor Sensor"
 Selects sensors to collect or to ignore, depending on \fBIgnoreSelected\fR.
@@ -1969,15 +1996,21 @@
 a notification is sent.
 .ie n .SS "Plugin ""iptables"""
 .el .SS "Plugin \f(CWiptables\fP"
 .IX Subsection "Plugin iptables"
 .IP "\fBChain\fR \fITable\fR \fIChain\fR [\fIComment|Number\fR [\fIName\fR]]" 4
 .IX Item "Chain Table Chain [Comment|Number [Name]]"
-Select the rules to count. If only \fITable\fR and \fIChain\fR are given, this plugin
-will collect the counters of all rules which have a comment-match. The comment
-is then used as type-instance.
+.PD 0
+.IP "\fBChain6\fR \fITable\fR \fIChain\fR [\fIComment|Number\fR [\fIName\fR]]" 4
+.IX Item "Chain6 Table Chain [Comment|Number [Name]]"
+.PD
+Select the iptables/ip6tables filter rules to count packets and bytes from.
+.Sp
+If only \fITable\fR and \fIChain\fR are given, this plugin will collect the counters
+of all rules which have a comment-match. The comment is then used as
+type-instance.
 .Sp
 If \fIComment\fR or \fINumber\fR is given, only the rule with the matching comment or
 the \fIn\fRth rule will be collected. Again, the comment (or the number) will be
 used as the type-instance.
 .Sp
 If \fIName\fR is supplied, it will be used as the type-instance instead of the
@@ -3475,12 +3508,23 @@
 with the hostname.
 .Sp
 Default: \f(CW\*(C`Collectd notify: %s@%s\*(C'\fR
 .ie n .SS "Plugin ""ntpd"""
 .el .SS "Plugin \f(CWntpd\fP"
 .IX Subsection "Plugin ntpd"
+The \f(CW\*(C`ntpd\*(C'\fR plugin collects per-peer ntp data such as time offset and time
+dispersion.
+.PP
+For talking to \fBntpd\fR, it mimics what the \fBntpdc\fR control program does on
+the wire \- using \fBmode 7\fR specific requests. This mode is deprecated with
+newer \fBntpd\fR releases (4.2.7p230 and later). For the \f(CW\*(C`ntpd\*(C'\fR plugin to work
+correctly with them, the ntp daemon must be explicitly configured to
+enable \fBmode 7\fR (which is disabled by default). Refer to the \fI\fIntp.conf\fI\|(5)\fR
+manual page for details.
+.PP
+Available configuration options for the \f(CW\*(C`ntpd\*(C'\fR plugin:
 .IP "\fBHost\fR \fIHostname\fR" 4
 .IX Item "Host Hostname"
 Hostname of the host running \fBntpd\fR. Defaults to \fBlocalhost\fR.
 .IP "\fBPort\fR \fIPort\fR" 4
 .IX Item "Port Port"
 UDP-Port to connect to. Defaults to \fB123\fR.
@@ -4169,12 +4213,18 @@
 single transaction. This transaction will last for the specified amount of
 time. By default, each update will be executed in a separate transaction. Each
 transaction generates a fair amount of overhead which can, thus, be reduced by
 activating this option. The draw-back is, that data covering the specified
 amount of time will be lost, for example, if a single statement within the
 transaction fails or if the database server crashes.
+.IP "\fBInstance\fR \fIname\fR" 4
+.IX Item "Instance name"
+Specify the plugin instance name that should be used instead of the database
+name (which is the default, if this option has not been specified). This
+allows to query multiple databases of the same name on the same host (e.g.
+when running multiple database server versions in parallel).
 .IP "\fBHost\fR \fIhostname\fR" 4
 .IX Item "Host hostname"
 Specify the hostname or \s-1IP\s0 of the PostgreSQL server to connect to. If the
 value begins with a slash, it is interpreted as the directory name in which to
 look for the \s-1UNIX\s0 domain socket.
 .Sp
@@ -4194,18 +4244,12 @@
 .IX Item "Password password"
 Specify the password to be used when connecting to the server.
 .IP "\fBSSLMode\fR \fIdisable\fR|\fIallow\fR|\fIprefer\fR|\fIrequire\fR" 4
 .IX Item "SSLMode disable|allow|prefer|require"
 Specify whether to use an \s-1SSL\s0 connection when contacting the server. The
 following modes are supported:
-.IP "\fBInstance\fR \fIname\fR" 4
-.IX Item "Instance name"
-Specify the plugin instance name that should be used instead of the database
-name (which is the default, if this option has not been specified). This
-allows to query multiple databases of the same name on the same host (e.g.
-when running multiple database server versions in parallel).
 .RS 4
 .IP "\fIdisable\fR" 4
 .IX Item "disable"
 Do not use \s-1SSL\s0 at all.
 .IP "\fIallow\fR" 4
 .IX Item "allow"
@@ -4396,12 +4440,15 @@
 .IP "\fBProcess\fR \fIName\fR" 4
 .IX Item "Process Name"
 Select more detailed statistics of processes matching this name. The statistics
 collected for these selected processes are size of the resident segment size
 (\s-1RSS\s0), user\- and system-time used, number of processes and number of threads,
 io data (where available) and minor and major pagefaults.
+.Sp
+Some platforms have a limit on the length of process names. \fIName\fR must stay
+below this limit.
 .IP "\fBProcessMatch\fR \fIname\fR \fIregex\fR" 4
 .IX Item "ProcessMatch name regex"
 Similar to the \fBProcess\fR option this allows to select more detailed
 statistics of processes matching the specified \fIregex\fR (see \fIregex\fR\|(7) for
 details). The statistics of all matching processes are summed up and
 dispatched to the daemon using the specified \fIname\fR as an identifier. This
@@ -4550,14 +4597,14 @@
 The \fBPort\fR option is the \s-1TCP\s0 port on which the Redis instance accepts
 connections. Either a service name of a port number may be given. Please note
 that numerical port numbers must be given as a string, too.
 .IP "\fBPassword\fR \fIPassword\fR" 4
 .IX Item "Password Password"
 Use \fIPassword\fR to authenticate when connecting to \fIRedis\fR.
-.IP "\fBTimeout\fR \fITimeout in miliseconds\fR" 4
-.IX Item "Timeout Timeout in miliseconds"
+.IP "\fBTimeout\fR \fIMilliseconds\fR" 4
+.IX Item "Timeout Milliseconds"
 The \fBTimeout\fR option set the socket timeout for node response. Since the Redis
 read function is blocking, you should keep this value as low as possible. Keep
 in mind that the sum of all \fBTimeout\fR values for all \fBNodes\fR should be lower
 than \fBInterval\fR defined globally.
 .ie n .SS "Plugin ""rrdcached"""
 .el .SS "Plugin \f(CWrrdcached\fP"
@@ -5651,14 +5698,14 @@
 .IP "\fBHost\fR \fIAddress\fR" 4
 .IX Item "Host Address"
 Hostname or address to connect to. Defaults to \f(CW\*(C`localhost\*(C'\fR.
 .IP "\fBPort\fR \fIService\fR" 4
 .IX Item "Port Service"
 Service name or port number to connect to. Defaults to \f(CW27017\fR.
-.IP "\fBTimeout\fR \fITimeout\fR" 4
-.IX Item "Timeout Timeout"
+.IP "\fBTimeout\fR \fIMilliseconds\fR" 4
+.IX Item "Timeout Milliseconds"
 Set the timeout for each operation on \fIMongoDB\fR to \fITimeout\fR milliseconds.
 Setting this option to zero means no timeout, which is the default.
 .IP "\fBStoreRates\fR \fBfalse\fR|\fBtrue\fR" 4
 .IX Item "StoreRates false|true"
 If set to \fBtrue\fR (the default), convert counter values to rates. If set to
 \&\fBfalse\fR counter values are stored as is, i.e. as an increasing integer
@@ -5772,14 +5819,14 @@
 running on.
 .IP "\fBPort\fR \fIPort\fR" 4
 .IX Item "Port Port"
 The \fBPort\fR option is the \s-1TCP\s0 port on which the Redis instance accepts
 connections. Either a service name of a port number may be given. Please note
 that numerical port numbers must be given as a string, too.
-.IP "\fBTimeout\fR \fITimeout in miliseconds\fR" 4
-.IX Item "Timeout Timeout in miliseconds"
+.IP "\fBTimeout\fR \fIMilliseconds\fR" 4
+.IX Item "Timeout Milliseconds"
 The \fBTimeout\fR option sets the socket connection timeout, in milliseconds.
 .ie n .SS "Plugin ""write_riemann"""
 .el .SS "Plugin \f(CWwrite_riemann\fP"
 .IX Subsection "Plugin write_riemann"
 The \fIwrite_riemann plugin\fR will send values to \fIRiemann\fR, a powerfull stream
 aggregation and monitoring system. The plugin sends \fIProtobuf\fR encoded data to
@@ -5826,13 +5873,13 @@
 .Sp
 This will be reflected in the \f(CW\*(C`ds_type\*(C'\fR tag: If \fBStoreRates\fR is enabled,
 converted values will have \*(L"rate\*(R" appended to the data source type, e.g.
 \&\f(CW\*(C`ds_type:derive:rate\*(C'\fR.
 .IP "\fBAlwaysAppendDS\fR \fBfalse\fR|\fBtrue\fR" 4
 .IX Item "AlwaysAppendDS false|true"
-If set the \fBtrue\fR, append the name of the \fIData Source\fR (\s-1DS\s0) to the
+If set to \fBtrue\fR, append the name of the \fIData Source\fR (\s-1DS\s0) to the
 \&\*(L"service\*(R", i.e. the field that, together with the \*(L"host\*(R" field, uniquely
 identifies a metric in \fIRiemann\fR. If set to \fBfalse\fR (the default), this is
 only done when there is more than one \s-1DS.\s0
 .IP "\fBTTLFactor\fR \fIFactor\fR" 4
 .IX Item "TTLFactor Factor"
 \&\fIRiemann\fR events have a \fITime to Live\fR (\s-1TTL\s0) which specifies how long each
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.in	2015-02-26 19:49:16.677658950 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.in	2016-07-26 15:47:12.953713783 +0800
@@ -67,13 +67,13 @@
 ##############################################################################
 # LoadPlugin section                                                         #
 #----------------------------------------------------------------------------#
 # Lines beginning with a single `#' belong to plugins which have been built  #
 # but are disabled by default.                                               #
 #                                                                            #
-# Lines begnning with `##' belong to plugins which have not been built due   #
+# Lines beginning with `##' belong to plugins which have not been built due  #
 # to missing dependencies or because they have been deactivated explicitly.  #
 ##############################################################################
 
 #@BUILD_PLUGIN_AGGREGATION_TRUE@LoadPlugin aggregation
 #@BUILD_PLUGIN_AMQP_TRUE@LoadPlugin amqp
 #@BUILD_PLUGIN_APACHE_TRUE@LoadPlugin apache
@@ -134,24 +134,20 @@
 #@BUILD_PLUGIN_NUMA_TRUE@LoadPlugin numa
 #@BUILD_PLUGIN_NUT_TRUE@LoadPlugin nut
 #@BUILD_PLUGIN_OLSRD_TRUE@LoadPlugin olsrd
 #@BUILD_PLUGIN_ONEWIRE_TRUE@LoadPlugin onewire
 #@BUILD_PLUGIN_OPENVPN_TRUE@LoadPlugin openvpn
 #@BUILD_PLUGIN_ORACLE_TRUE@LoadPlugin oracle
-#@BUILD_PLUGIN_PERL_TRUE@<LoadPlugin perl>
-#@BUILD_PLUGIN_PERL_TRUE@  Globals true
-#@BUILD_PLUGIN_PERL_TRUE@</LoadPlugin>
+#@BUILD_PLUGIN_PERL_TRUE@LoadPlugin perl
 #@BUILD_PLUGIN_PINBA_TRUE@LoadPlugin pinba
 #@BUILD_PLUGIN_PING_TRUE@LoadPlugin ping
 #@BUILD_PLUGIN_POSTGRESQL_TRUE@LoadPlugin postgresql
 #@BUILD_PLUGIN_POWERDNS_TRUE@LoadPlugin powerdns
 #@BUILD_PLUGIN_PROCESSES_TRUE@LoadPlugin processes
 #@BUILD_PLUGIN_PROTOCOLS_TRUE@LoadPlugin protocols
-#@BUILD_PLUGIN_PYTHON_TRUE@<LoadPlugin python>
-#@BUILD_PLUGIN_PYTHON_TRUE@  Globals true
-#@BUILD_PLUGIN_PYTHON_TRUE@</LoadPlugin>
+#@BUILD_PLUGIN_PYTHON_TRUE@LoadPlugin python
 #@BUILD_PLUGIN_REDIS_TRUE@LoadPlugin redis
 #@BUILD_PLUGIN_ROUTEROS_TRUE@LoadPlugin routeros
 #@BUILD_PLUGIN_RRDCACHED_TRUE@LoadPlugin rrdcached
 @LOAD_PLUGIN_RRDTOOL@LoadPlugin rrdtool
 #@BUILD_PLUGIN_SENSORS_TRUE@LoadPlugin sensors
 #@BUILD_PLUGIN_SERIAL_TRUE@LoadPlugin serial
@@ -408,13 +404,12 @@
 #	Device "/dev/hda1"
 #	Device "192.168.0.2:/mnt/nfs"
 #	MountPoint "/home"
 #	FSType "ext3"
 #	IgnoreSelected false
 #	ReportByDevice false
-#	ReportReserved false
 #	ReportInodes false
 #	ValuesAbsolute true
 #	ValuesPercentage false
 #</Plugin>
 
 #<Plugin disk>
@@ -490,12 +485,13 @@
 #	NotifySensorRemove true
 #	NotifySensorNotPresent false
 #</Plugin>
 
 #<Plugin iptables>
 #	Chain table chain
+#	Chain6 table chain
 #</Plugin>
 
 #<Plugin irq>
 #	Irq 7
 #	Irq 8
 #	Irq 9
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.conf.pod	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.conf.pod	2016-07-26 15:47:12.957713794 +0800
@@ -95,13 +95,12 @@
  LoadPlugin "cpu"
 
 Options inside a B<LoadPlugin> block can override default settings and
 influence the way plugins are loaded, e.g.:
 
  <LoadPlugin perl>
-   Globals true
    Interval 60
  </LoadPlugin>
 
 The following options are valid inside B<LoadPlugin> blocks:
 
 =over 4
@@ -170,15 +169,13 @@
 
 If the C<fnmatch> function is available on your system, a shell-like wildcard
 I<pattern> may be specified to filter which files to include. This may be used
 in combination with recursively including a directory to easily be able to
 arbitrarily mix configuration files and other documents (e.g. README files).
 The given example is similar to the first example above but includes all files
-matching C<*.conf> in any subdirectory of C</etc/collectd.d>:
-
-  Include "/etc/collectd.d" "*.conf"
+matching C<*.conf> in any subdirectory of C</etc/collectd.d>.
 
 =back
 
 If more than one files are included by a single B<Include> option, the files
 will be included in lexicographical order (as defined by the C<strcmp>
 function). Thus, you can e.E<nbsp>g. use numbered prefixes to specify the
@@ -357,19 +354,19 @@
  </Plugin>
 
 There are a couple of limitations you should be aware of:
 
 =over 4
 
-=item
+=item *
 
 The I<Type> cannot be left unspecified, because it is not reasonable to add
 apples to oranges. Also, the internal lookup structure won't work if you try
 to group by type.
 
-=item
+=item *
 
 There must be at least one unspecified, ungrouped field. Otherwise nothing
 will be aggregated.
 
 =back
 
@@ -438,25 +435,25 @@
  </Plugin>
 
 This will create the files:
 
 =over 4
 
-=item
+=item *
 
 foo.example.com/cpu-even-average/cpu-idle
 
-=item
+=item *
 
 foo.example.com/cpu-even-average/cpu-system
 
-=item
+=item *
 
 foo.example.com/cpu-even-average/cpu-user
 
-=item
+=item *
 
 ...
 
 =back
 
 =item B<CalculateNum> B<true>|B<false>
@@ -476,13 +473,13 @@
 are disabled by default.
 
 =back
 
 =head2 Plugin C<amqp>
 
-The I<AMQMP plugin> can be used to communicate with other instances of
+The I<AMQP plugin> can be used to communicate with other instances of
 I<collectd> or third party applications using an AMQP message broker. Values
 are sent to or received from the broker, which handles routing, queueing and
 possibly filtering or messages.
 
  <Plugin "amqp">
    # Send values to an AMQP broker
@@ -500,13 +497,13 @@
  #   StoreRates false
  #   GraphitePrefix "collectd."
  #   GraphiteEscapeChar "_"
  #   GraphiteSeparateInstances false
  #   GraphiteAlwaysAppendDS false
    </Publish>
-   
+
    # Receive values from an AMQP broker
    <Subscribe "some_name">
      Host "localhost"
      Port "5672"
      VHost "/"
      User "guest"
@@ -1114,13 +1111,13 @@
 
 =back
 
 =head2 Plugin C<curl_json>
 
 The B<curl_json plugin> collects values from JSON data to be parsed by
-B<libyajl> (L<http://www.lloydforge.org/projects/yajl/>) retrieved via
+B<libyajl> (L<https://lloyd.github.io/yajl/>) retrieved via
 either B<libcurl> (L<http://curl.haxx.se/>) or read directly from a
 unix socket. The former can be used, for example, to collect values
 from CouchDB documents (which are stored JSON notation), and the
 latter to collect values from a uWSGI stats socket.
 
 The following example will collect several values from the built-in
@@ -1991,21 +1994,38 @@
 
 Select this interface. By default these interfaces will then be collected. For
 a more detailed description see B<IgnoreSelected> below.
 
 =item B<IgnoreSelected> I<true>|I<false>
 
-If no configuration if given, the B<traffic>-plugin will collect data from
+If no configuration if given, the B<interface>-plugin will collect data from
 all interfaces. This may not be practical, especially for loopback- and
 similar interfaces. Thus, you can use the B<Interface>-option to pick the
 interfaces you're interested in. Sometimes, however, it's easier/preferred
 to collect all interfaces I<except> a few ones. This option enables you to
 do that: By setting B<IgnoreSelected> to I<true> the effect of
 B<Interface> is inverted: All selected interfaces are ignored and all
 other interfaces are collected.
 
+It is possible to use regular expressions to match interface names, if the
+name is surrounded by I</.../> and collectd was compiled with support for
+regexps. This is useful if there's a need to collect (or ignore) data
+for a group of interfaces that are similarly named, without the need to
+explicitly list all of them (especially useful if the list is dynamic).
+Example:
+
+ Interface "lo"
+ Interface "/^veth/"
+ Interface "/^tun[0-9]+/"
+ IgnoreSelected "true"
+
+This will ignore the loopback interface, all interfaces with names starting
+with I<veth> and all interfaces with names starting with I<tun> followed by
+at least one digit.
+
+
 =back
 
 =head2 Plugin C<ipmi>
 
 =over 4
 
@@ -2040,15 +2060,19 @@
 =head2 Plugin C<iptables>
 
 =over 4
 
 =item B<Chain> I<Table> I<Chain> [I<Comment|Number> [I<Name>]]
 
-Select the rules to count. If only I<Table> and I<Chain> are given, this plugin
-will collect the counters of all rules which have a comment-match. The comment
-is then used as type-instance.
+=item B<Chain6> I<Table> I<Chain> [I<Comment|Number> [I<Name>]]
+
+Select the iptables/ip6tables filter rules to count packets and bytes from.
+
+If only I<Table> and I<Chain> are given, this plugin will collect the counters
+of all rules which have a comment-match. The comment is then used as
+type-instance.
 
 If I<Comment> or I<Number> is given, only the rule with the matching comment or
 the I<n>th rule will be collected. Again, the comment (or the number) will be
 used as the type-instance.
 
 If I<Name> is supplied, it will be used as the type-instance instead of the
@@ -3728,12 +3752,24 @@
 Default: C<Collectd notify: %s@%s>
 
 =back
 
 =head2 Plugin C<ntpd>
 
+The C<ntpd> plugin collects per-peer ntp data such as time offset and time
+dispersion.
+
+For talking to B<ntpd>, it mimics what the B<ntpdc> control program does on
+the wire - using B<mode 7> specific requests. This mode is deprecated with
+newer B<ntpd> releases (4.2.7p230 and later). For the C<ntpd> plugin to work
+correctly with them, the ntp daemon must be explicitly configured to
+enable B<mode 7> (which is disabled by default). Refer to the I<ntp.conf(5)>
+manual page for details.
+
+Available configuration options for the C<ntpd> plugin:
+
 =over 4
 
 =item B<Host> I<Hostname>
 
 Hostname of the host running B<ntpd>. Defaults to B<localhost>.
 
@@ -4512,12 +4548,19 @@
 time. By default, each update will be executed in a separate transaction. Each
 transaction generates a fair amount of overhead which can, thus, be reduced by
 activating this option. The draw-back is, that data covering the specified
 amount of time will be lost, for example, if a single statement within the
 transaction fails or if the database server crashes.
 
+=item B<Instance> I<name>
+
+Specify the plugin instance name that should be used instead of the database
+name (which is the default, if this option has not been specified). This
+allows to query multiple databases of the same name on the same host (e.g.
+when running multiple database server versions in parallel).
+
 =item B<Host> I<hostname>
 
 Specify the hostname or IP of the PostgreSQL server to connect to. If the
 value begins with a slash, it is interpreted as the directory name in which to
 look for the UNIX domain socket.
 
@@ -4542,19 +4585,12 @@
 
 =item B<SSLMode> I<disable>|I<allow>|I<prefer>|I<require>
 
 Specify whether to use an SSL connection when contacting the server. The
 following modes are supported:
 
-=item B<Instance> I<name>
-
-Specify the plugin instance name that should be used instead of the database
-name (which is the default, if this option has not been specified). This
-allows to query multiple databases of the same name on the same host (e.g.
-when running multiple database server versions in parallel).
-
 =over 4
 
 =item I<disable>
 
 Do not use SSL at all.
 
@@ -4761,12 +4797,15 @@
 
 Select more detailed statistics of processes matching this name. The statistics
 collected for these selected processes are size of the resident segment size
 (RSS), user- and system-time used, number of processes and number of threads,
 io data (where available) and minor and major pagefaults.
 
+Some platforms have a limit on the length of process names. I<Name> must stay
+below this limit.
+
 =item B<ProcessMatch> I<name> I<regex>
 
 Similar to the B<Process> option this allows to select more detailed
 statistics of processes matching the specified I<regex> (see L<regex(7)> for
 details). The statistics of all matching processes are summed up and
 dispatched to the daemon using the specified I<name> as an identifier. This
@@ -4938,13 +4977,13 @@
 that numerical port numbers must be given as a string, too.
 
 =item B<Password> I<Password>
 
 Use I<Password> to authenticate when connecting to I<Redis>.
 
-=item B<Timeout> I<Timeout in miliseconds>
+=item B<Timeout> I<Milliseconds>
 
 The B<Timeout> option set the socket timeout for node response. Since the Redis
 read function is blocking, you should keep this value as low as possible. Keep
 in mind that the sum of all B<Timeout> values for all B<Nodes> should be lower
 than B<Interval> defined globally.
 
@@ -5916,26 +5955,26 @@
 shutdowns and migration.
 
 The following methods are used to find the machine's UUID, in order:
 
 =over 4
 
-=item
+=item *
 
 Check I</etc/uuid> (or I<UUIDFile>).
 
-=item
+=item *
 
 Check for UUID from HAL (L<http://www.freedesktop.org/wiki/Software/hal>) if
 present.
 
-=item
+=item *
 
 Check for UUID from C<dmidecode> / SMBIOS.
 
-=item
+=item *
 
 Check for UUID from Xen hypervisor.
 
 =back
 
 If no UUID can be found then the hostname is not modified.
@@ -6222,13 +6261,13 @@
 Hostname or address to connect to. Defaults to C<localhost>.
 
 =item B<Port> I<Service>
 
 Service name or port number to connect to. Defaults to C<27017>.
 
-=item B<Timeout> I<Timeout>
+=item B<Timeout> I<Milliseconds>
 
 Set the timeout for each operation on I<MongoDB> to I<Timeout> milliseconds.
 Setting this option to zero means no timeout, which is the default.
 
 =item B<StoreRates> B<false>|B<true>
 
@@ -6358,13 +6397,13 @@
 =item B<Port> I<Port>
 
 The B<Port> option is the TCP port on which the Redis instance accepts
 connections. Either a service name of a port number may be given. Please note
 that numerical port numbers must be given as a string, too.
 
-=item B<Timeout> I<Timeout in miliseconds>
+=item B<Timeout> I<Milliseconds>
 
 The B<Timeout> option sets the socket connection timeout, in milliseconds.
 
 =back
 
 =head2 Plugin C<write_riemann>
@@ -6421,13 +6460,13 @@
 This will be reflected in the C<ds_type> tag: If B<StoreRates> is enabled,
 converted values will have "rate" appended to the data source type, e.g.
 C<ds_type:derive:rate>.
 
 =item B<AlwaysAppendDS> B<false>|B<true>
 
-If set the B<true>, append the name of the I<Data Source> (DS) to the
+If set to B<true>, append the name of the I<Data Source> (DS) to the
 "service", i.e. the field that, together with the "host" field, uniquely
 identifies a metric in I<Riemann>. If set to B<false> (the default), this is
 only done when there is more than one DS.
 
 =item B<TTLFactor> I<Factor>
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdctl.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdctl.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdctl.1	2015-02-26 18:47:25.692496233 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdctl.1	2016-07-26 15:48:07.721847477 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTDCTL 1"
-.TH COLLECTDCTL 1 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTDCTL 1 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectdctl \- Control interface for collectd
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdctl.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdctl.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdctl.c	2015-02-26 18:43:48.468180427 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdctl.c	2016-07-26 15:47:12.957713794 +0800
@@ -548,20 +548,20 @@
 
   lcc_connection_t *c;
 
   int status;
 
   while (42) {
-    int c;
+    int n;
 
-    c = getopt (argc, argv, "s:h");
+    n = getopt (argc, argv, "s:h");
 
-    if (c == -1)
+    if (n == -1)
       break;
 
-    switch (c) {
+    switch (n) {
       case 's':
         snprintf (address, sizeof (address), "unix:%s", optarg);
         address[sizeof (address) - 1] = '\0';
         break;
       case 'h':
         exit_usage (argv[0], 0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-email.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-email.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-email.5	2015-02-26 18:47:25.428490998 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-email.5	2016-07-26 15:48:07.557847078 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EMAIL 5"
-.TH COLLECTD-EMAIL 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-EMAIL 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-email \- Documentation of collectd's "email plugin"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-email.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-email.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-email.pod	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-email.pod	2016-07-26 15:47:12.953713783 +0800
@@ -30,27 +30,27 @@
 This plugin collects data indirectly by providing a UNIX-socket that external
 programs can connect to. A simple line based protocol is used to communicate
 with the plugin:
 
 =over 4
 
-=item
+=item *
 
 E-Mail type (e.g. "ham", "spam", "virus", ...) and size (bytes):
 
   e:<type>:<size>
 
 If C<size> is less than or equal to zero, C<size> is ignored.
 
-=item
+=item *
 
 Spam score:
 
   s:<value>
 
-=item
+=item *
 
 Successful spam checks (e.g. "BAYES_99", "SUBJECT_DRUG_GAP_C", ...):
 
   c:<type1>[,<type2>,...]
 
 Each line is limited to 256 characters (including the newline character). 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-exec.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-exec.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-exec.5	2015-02-26 22:10:02.540034958 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-exec.5	2016-07-26 15:48:07.645847292 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EXEC 5"
-.TH COLLECTD-EXEC 5 "2015-02-26" "5.4.2" "collectd"
+.TH COLLECTD-EXEC 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-exec \- Documentation of collectd's "exec plugin"
@@ -151,13 +151,13 @@
 \&    Exec "otheruser" "/path/to/another/binary" "arg0" "arg1"
 \&    NotificationExec "user" "/usr/lib/collectd/exec/handle_notification"
 \&  </Plugin>
 .Ve
 .SH "DESCRIPTION"
 .IX Header "DESCRIPTION"
-The \f(CW\*(C`exec plugin\*(C'\fR forks of an executable either to receive values or to
+The \f(CW\*(C`exec plugin\*(C'\fR forks off an executable either to receive values or to
 dispatch notifications to the outside world. The syntax of the configuration is
 explained in \fIcollectd.conf\fR\|(5) but summarized in the above synopsis.
 .PP
 If you want/need better performance or more functionality you should take a
 long look at the \f(CW\*(C`perl plugin\*(C'\fR, \fIcollectd\-perl\fR\|(5).
 .SH "EXECUTABLE TYPES"
@@ -173,13 +173,13 @@
 \&\fIInterval\fR seconds. It is perfectly legal for the executable to run for a long
 time and continuously write values to \f(CW\*(C`STDOUT\*(C'\fR.
 .Sp
 See \*(L"\s-1EXEC DATA FORMAT\*(R"\s0 below for a description of the output format expected
 from these programs.
 .Sp
-\&\fBWarning:\fR If the executable only writes one value and then exits I will be
+\&\fBWarning:\fR If the executable only writes one value and then exits it will be
 executed every \fIInterval\fR seconds. If \fIInterval\fR is short (the default is 10
 seconds) this may result in serious system load.
 .ie n .IP """NotificationExec""" 4
 .el .IP "\f(CWNotificationExec\fR" 4
 .IX Item "NotificationExec"
 The program is forked once for each notification that is handled by the daemon.
@@ -218,13 +218,13 @@
 double quotes.
 .Sp
 \&\fIValuelist\fR is a colon-separated list of the time and the values, each either
 an integer if the data-source is a counter, or a double if the data-source is
 of type \*(L"gauge\*(R". You can submit an undefined gauge-value by using \fBU\fR. When
 submitting \fBU\fR to a counter the behavior is undefined. The time is given as
-epoch (i.\ e. standard \s-1UNIX\s0 time).
+epoch (i.\ e. standard \s-1UNIX\s0 time) or \fBN\fR to use the current time.
 .Sp
 You can mix options and values, but the order is important: Options only
 effect following values, so specifying an option as last field is allowed, but
 useless. Also, an option applies to \fBall\fR following values, so you don't need
 to re-set an option over and over again.
 .Sp
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-exec.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-exec.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-exec.pod	2015-02-26 19:49:36.438060967 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-exec.pod	2016-07-26 15:47:12.953713783 +0800
@@ -14,13 +14,13 @@
     Exec "otheruser" "/path/to/another/binary" "arg0" "arg1"
     NotificationExec "user" "/usr/lib/collectd/exec/handle_notification"
   </Plugin>
 
 =head1 DESCRIPTION
 
-The C<exec plugin> forks of an executable either to receive values or to
+The C<exec plugin> forks off an executable either to receive values or to
 dispatch notifications to the outside world. The syntax of the configuration is
 explained in L<collectd.conf(5)> but summarized in the above synopsis.
 
 If you want/need better performance or more functionality you should take a
 long look at the C<perl plugin>, L<collectd-perl(5)>.
 
@@ -39,13 +39,13 @@
 I<Interval> seconds. It is perfectly legal for the executable to run for a long
 time and continuously write values to C<STDOUT>.
 
 See L<EXEC DATA FORMAT> below for a description of the output format expected
 from these programs.
 
-B<Warning:> If the executable only writes one value and then exits I will be
+B<Warning:> If the executable only writes one value and then exits it will be
 executed every I<Interval> seconds. If I<Interval> is short (the default is 10
 seconds) this may result in serious system load.
 
 =item C<NotificationExec>
 
 The program is forked once for each notification that is handled by the daemon.
@@ -91,13 +91,13 @@
 double quotes.
 
 I<Valuelist> is a colon-separated list of the time and the values, each either
 an integer if the data-source is a counter, or a double if the data-source is
 of type "gauge". You can submit an undefined gauge-value by using B<U>. When
 submitting B<U> to a counter the behavior is undefined. The time is given as
-epoch (i.E<nbsp>e. standard UNIX time).
+epoch (i.E<nbsp>e. standard UNIX time) or B<N> to use the current time.
 
 You can mix options and values, but the order is important: Options only
 effect following values, so specifying an option as last field is allowed, but
 useless. Also, an option applies to B<all> following values, so you don't need
 to re-set an option over and over again.
 
@@ -265,18 +265,18 @@
 to make use of collectd's more powerful interface.
 
 =head1 CAVEATS
 
 =over 4
 
-=item
+=item *
 
 The user, the binary is executed as, may not have root privileges, i.E<nbsp>e.
 must have an UID that is non-zero. This is for your own good.
 
-=item
+=item *
 
 Early versions of the plugin did not use a command but treated all lines as if
 they were arguments to the I<PUTVAL> command. When the I<PUTNOTIF> command was
 implemented, this behavior was kept for lines which start with an unknown
 command for backwards compatibility. This compatibility code has been removed
 in I<collectdE<nbsp>5>.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.h	2015-02-26 18:43:48.468180427 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.h	2016-07-26 15:47:12.957713794 +0800
@@ -284,12 +284,16 @@
 # if defined(COLLECT_DEBUG) && COLLECT_DEBUG && defined(__GNUC__) && __GNUC__
 #  undef sprintf
 #  pragma GCC poison sprintf
 # endif
 #endif
 
+#ifndef GAUGE_FORMAT
+# define GAUGE_FORMAT "%.15g"
+#endif
+
 /* Type for time as used by "utils_time.h" */
 typedef uint64_t cdtime_t;
 
 extern char     hostname_g[];
 extern cdtime_t interval_g;
 extern int      timeout_g;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-java.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-java.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-java.5	2015-02-26 18:47:25.876499882 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-java.5	2016-07-26 15:48:07.869847837 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-JAVA 5"
-.TH COLLECTD-JAVA 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-JAVA 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-java \- Documentation of collectd's "java plugin"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdmon.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdmon.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdmon.1	2015-02-26 18:47:25.972501786 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdmon.1	2016-07-26 15:48:07.953848042 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTDMON 1"
-.TH COLLECTDMON 1 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTDMON 1 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectdmon \- Monitoring daemon for collectd
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdmon.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdmon.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectdmon.c	2015-02-26 18:43:48.468180427 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectdmon.c	2016-07-26 15:47:12.957713794 +0800
@@ -309,32 +309,38 @@
 
 	collectd_argv[collectd_argc] = NULL;
 
 	openlog ("collectdmon", LOG_CONS | LOG_PID, LOG_DAEMON);
 
 	if (-1 == daemonize ())
+	{
+		free (collectd_argv);
 		return 1;
+	}
 
 	sa.sa_handler = sig_int_term_handler;
 	sa.sa_flags   = 0;
 	sigemptyset (&sa.sa_mask);
 
 	if (0 != sigaction (SIGINT, &sa, NULL)) {
 		syslog (LOG_ERR, "Error: sigaction() failed: %s", strerror (errno));
+		free (collectd_argv);
 		return 1;
 	}
 
 	if (0 != sigaction (SIGTERM, &sa, NULL)) {
 		syslog (LOG_ERR, "Error: sigaction() failed: %s", strerror (errno));
+		free (collectd_argv);
 		return 1;
 	}
 
 	sa.sa_handler = sig_hup_handler;
 
 	if (0 != sigaction (SIGHUP, &sa, NULL)) {
 		syslog (LOG_ERR, "Error: sigaction() failed: %s", strerror (errno));
+		free (collectd_argv);
 		return 1;
 	}
 
 	while (0 == loop) {
 		int status = 0;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-nagios.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-nagios.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-nagios.1	2015-02-26 18:47:26.068503690 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-nagios.1	2016-07-26 15:48:08.041848256 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-NAGIOS 1"
-.TH COLLECTD-NAGIOS 1 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-NAGIOS 1 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-nagios \- Nagios plugin for querying collectd
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-nagios.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-nagios.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-nagios.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-nagios.c	2016-07-26 15:47:12.953713783 +0800
@@ -300,14 +300,13 @@
 
 		if ((hostname_g != NULL) && (strcasecmp (hostname_g, ret_ident[i].host)))
 			continue;
 
 		if ((hostname == NULL) || strcasecmp (hostname, ret_ident[i].host))
 		{
-			if (hostname != NULL)
-				free (hostname);
+			free (hostname);
 			hostname = strdup (ret_ident[i].host);
 			printf ("Host: %s\n", hostname);
 		}
 
 		/* empty hostname; not to be printed again */
 		ret_ident[i].host[0] = '\0';
@@ -315,21 +314,23 @@
 		status = lcc_identifier_to_string (connection,
 				id, sizeof (id), ret_ident + i);
 		if (status != 0) {
 			printf ("ERROR: listval: Failed to convert returned "
 					"identifier to a string: %s\n",
 					lcc_strerror (connection));
+			free (hostname);
+			hostname = NULL;
 			continue;
 		}
 
 		/* skip over the (empty) hostname and following '/' */
 		printf ("\t%s\n", id + 1);
 	}
 
-	if (ret_ident != NULL)
-		free (ret_ident);
+	free (ret_ident);
+	free (hostname);
 	return (RET_OKAY);
 } /* int do_listval */
 
 static int do_check_con_none (size_t values_num,
 		double *values, char **values_names)
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-perl.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-perl.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-perl.5	2015-02-26 18:47:26.228506863 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-perl.5	2016-07-26 15:48:08.157848538 +0800
@@ -130,25 +130,23 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-PERL 5"
-.TH COLLECTD-PERL 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-PERL 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-perl \- Documentation of collectd's "perl plugin"
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
-.Vb 9
-\&  <LoadPlugin perl>
-\&    Globals true
-\&  </LoadPlugin>
+.Vb 7
+\&  LoadPlugin perl
 \&  # ...
 \&  <Plugin perl>
 \&    IncludeDir "/path/to/perl/plugins"
 \&    BaseName "Collectd::Plugins"
 \&    EnableDebugger ""
 \&    LoadPlugin "FooBar"
@@ -162,18 +160,12 @@
 .IX Header "DESCRIPTION"
 The \f(CW\*(C`perl plugin\*(C'\fR embeds a Perl-interpreter into collectd and provides an
 interface to collectd's plugin system. This makes it possible to write plugins
 for collectd in Perl. This is a lot more efficient than executing a
 Perl-script every time you want to read a value with the \f(CW\*(C`exec plugin\*(C'\fR (see
 \&\fIcollectd\-exec\fR\|(5)) and provides a lot more functionality, too.
-.PP
-When loading the \f(CW\*(C`perl plugin\*(C'\fR, the \fBGlobals\fR option should be enabled.
-Else, the perl plugin will fail to load any Perl modules implemented in C,
-which includes, amongst many others, the \fBthreads\fR module used by the plugin
-itself. See the documentation of the \fBGlobals\fR option in \fIcollectd.conf\fR\|(5)
-for details.
 .SH "CONFIGURATION"
 .IX Header "CONFIGURATION"
 .IP "\fBLoadPlugin\fR \fIPlugin\fR" 4
 .IX Item "LoadPlugin Plugin"
 Loads the Perl plugin \fIPlugin\fR. This does basically the same as \fBuse\fR would
 do in a Perl program. As a side effect, the first occurrence of this option
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-perl.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-perl.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-perl.pod	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-perl.pod	2016-07-26 15:47:12.953713783 +0800
@@ -3,15 +3,13 @@
 =head1 NAME
 
 collectd-perl - Documentation of collectd's C<perl plugin>
 
 =head1 SYNOPSIS
 
-  <LoadPlugin perl>
-    Globals true
-  </LoadPlugin>
+  LoadPlugin perl
   # ...
   <Plugin perl>
     IncludeDir "/path/to/perl/plugins"
     BaseName "Collectd::Plugins"
     EnableDebugger ""
     LoadPlugin "FooBar"
@@ -26,18 +24,12 @@
 The C<perl plugin> embeds a Perl-interpreter into collectd and provides an
 interface to collectd's plugin system. This makes it possible to write plugins
 for collectd in Perl. This is a lot more efficient than executing a
 Perl-script every time you want to read a value with the C<exec plugin> (see
 L<collectd-exec(5)>) and provides a lot more functionality, too.
 
-When loading the C<perl plugin>, the B<Globals> option should be enabled.
-Else, the perl plugin will fail to load any Perl modules implemented in C,
-which includes, amongst many others, the B<threads> module used by the plugin
-itself. See the documentation of the B<Globals> option in L<collectd.conf(5)>
-for details.
-
 =head1 CONFIGURATION
 
 =over 4
 
 =item B<LoadPlugin> I<Plugin>
 
@@ -710,13 +702,13 @@
 types used by the read, write and match functions.
 
 =head1 NOTES
 
 =over 4
 
-=item
+=item *
 
 Please feel free to send in new plugins to collectd's mailing list at
 E<lt>collectdE<nbsp>atE<nbsp>verplant.orgE<gt> for review and, possibly,
 inclusion in the main distribution. In the latter case, we will take care of
 keeping the plugin up to date and adapting it to new versions of collectd.
 
@@ -726,41 +718,41 @@
 =back
 
 =head1 CAVEATS
 
 =over 4
 
-=item
+=item *
 
 collectd is heavily multi-threaded. Each collectd thread accessing the perl
 plugin will be mapped to a Perl interpreter thread (see L<threads(3perl)>).
 Any such thread will be created and destroyed transparently and on-the-fly.
 
 Hence, any plugin has to be thread-safe if it provides several entry points
 from collectd (i.E<nbsp>e. if it registers more than one callback or if a
 registered callback may be called more than once in parallel). Please note
 that no data is shared between threads by default. You have to use the
 B<threads::shared> module to do so.
 
-=item
+=item *
 
 Each function name registered with collectd has to be available before the
 first thread has been created (i.E<nbsp>e. basically at compile time). This
 basically means that hacks (yes, I really consider this to be a hack) like
 C<*foo = \&bar; plugin_register (TYPE_READ, "plugin", "foo");> most likely
 will not work. This is due to the fact that the symbol table is not shared
 across different threads.
 
-=item
+=item *
 
 Each plugin is usually only loaded once and kept in memory for performance
 reasons. Therefore, END blocks are only executed once when collectd shuts
 down. You should not rely on END blocks anyway - use B<shutdown functions>
 instead.
 
-=item
+=item *
 
 The perl plugin exports the internal API of collectd which is considered
 unstable and subject to change at any time. We try hard to not break backwards
 compatibility in the Perl API during the life cycle of one major release.
 However, this cannot be guaranteed at all times. Watch out for warnings
 dispatched by the perl plugin after upgrades.
@@ -768,13 +760,13 @@
 =back
 
 =head1 KNOWN BUGS
 
 =over 4
 
-=item
+=item *
 
 Currently, it is not possible to flush a single Perl plugin only. You can
 either flush all Perl plugins or none at all and you have to use C<perl> as
 plugin name when doing so.
 
 =back
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd.pod	2015-02-26 18:43:48.468180427 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd.pod	2016-07-26 15:47:12.957713794 +0800
@@ -65,21 +65,21 @@
 package it's a good bet to search somewhere near F</usr/share/doc/collectd>.
 
 There are two big groups of plugins, B<input> and B<output> plugins:
 
 =over 4
 
-=item
+=item *
 
 Input plugins are queried periodically. They somehow acquire the current value
 of whatever they where designed to work with and submit these values back to
 the daemon, i. e. they "dispatch" the values. As an example, the C<cpu plugin>
 reads the current cpu-counters of time spent in the various modes (user,
 system, nice, ...) and dispatches these counters to the daemon.
 
-=item
+=item *
 
 Output plugins get the dispatched values from the daemon and does something
 with them. Common applications are writing to RRD-files, CSV-files or sending
 the data over a network link to a remote box.
 
 =back
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-python.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-python.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-python.5	2015-02-26 18:47:26.412510512 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-python.5	2016-07-26 15:48:08.281848841 +0800
@@ -130,25 +130,23 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-PYTHON 5"
-.TH COLLECTD-PYTHON 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-PYTHON 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-python \- Documentation of collectd's "python plugin"
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
-.Vb 9
-\&  <LoadPlugin python>
-\&    Globals true
-\&  </LoadPlugin>
+.Vb 7
+\&  LoadPlugin python
 \&  # ...
 \&  <Plugin python>
 \&    ModulePath "/path/to/your/python/modules"
 \&    LogTraces true
 \&    Interactive false
 \&    Import "spam"
@@ -168,18 +166,13 @@
 .PP
 The minimum required Python version is \fI2.3\fR.
 .SH "CONFIGURATION"
 .IX Header "CONFIGURATION"
 .IP "\fBLoadPlugin\fR \fIPlugin\fR" 4
 .IX Item "LoadPlugin Plugin"
-Loads the Python plugin \fIPlugin\fR. Unlike most other LoadPlugin lines, this one
-should be a block containing the line \*(L"Globals true\*(R". This will cause collectd
-to export the name of all objects in the Python interpreter for all plugins to
-see. If you don't do this or your platform does not support it, the embedded
-interpreter will start anyway but you won't be able to load certain Python
-modules, e.g. \*(L"time\*(R".
+Loads the Python plugin \fIPlugin\fR.
 .IP "\fBEncoding\fR \fIName\fR" 4
 .IX Item "Encoding Name"
 The default encoding for Unicode objects you pass to collectd. If you omit this
 option it will default to \fBascii\fR on \fIPython 2\fR and \fButf\-8\fR on \fIPython 3\fR.
 This is hardcoded in Python and will ignore everything else, including your
 locale.
@@ -643,13 +636,13 @@
 .IX Item "unregister_*(identifier) -> None"
 Removes a callback or data-set from collectd's internal list of callback
 functions. Every \fIregister_*\fR function has an \fIunregister_*\fR function.
 \&\fIidentifier\fR is either the string that was returned by the register function
 or a callback function. The identifier will be constructed in the same way as
 for the register functions.
-.IP "\fBflush\fR(\fIplugin[, \fItimeout\fI][, \fIidentifier\fI]) \-\fR None" 4
+.IP "\fBflush\fR(\fIplugin[, timeout][, identifier]) \-\fR None" 4
 .IX Item "flush(plugin[, timeout][, identifier]) - None"
 Flush one or all plugins. \fItimeout\fR and the specified \fIidentifiers\fR are
 passed on to the registered flush-callbacks. If omitted, the timeout defaults
 to \f(CW\*(C`\-1\*(C'\fR. The identifier defaults to None. If the \fBplugin\fR argument has been
 specified, only named plugin will be flushed.
 .IP "\fBerror\fR, \fBwarning\fR, \fBnotice\fR, \fBinfo\fR, \fBdebug\fR(\fImessage\fR)" 4
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-python.pod /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-python.pod
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-python.pod	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-python.pod	2016-07-26 15:47:12.953713783 +0800
@@ -13,15 +13,13 @@
 =head1 NAME
 
 collectd-python - Documentation of collectd's C<python plugin>
 
 =head1 SYNOPSIS
 
-  <LoadPlugin python>
-    Globals true
-  </LoadPlugin>
+  LoadPlugin python
   # ...
   <Plugin python>
     ModulePath "/path/to/your/python/modules"
     LogTraces true
     Interactive false
     Import "spam"
@@ -44,18 +42,13 @@
 =head1 CONFIGURATION
 
 =over 4
 
 =item B<LoadPlugin> I<Plugin>
 
-Loads the Python plugin I<Plugin>. Unlike most other LoadPlugin lines, this one
-should be a block containing the line "Globals true". This will cause collectd
-to export the name of all objects in the Python interpreter for all plugins to
-see. If you don't do this or your platform does not support it, the embedded
-interpreter will start anyway but you won't be able to load certain Python
-modules, e.g. "time".
+Loads the Python plugin I<Plugin>.
 
 =item B<Encoding> I<Name>
 
 The default encoding for Unicode objects you pass to collectd. If you omit this
 option it will default to B<ascii> on I<Python 2> and B<utf-8> on I<Python 3>.
 This is hardcoded in Python and will ignore everything else, including your
@@ -89,28 +82,28 @@
 
 This interactive session will behave slightly differently from a daemonized
 collectd script as well as from a normal Python interpreter:
 
 =over 4
 
-=item
+=item *
 
 B<1.> collectd will try to import the B<readline> module to give you a decent
 way of entering your commands. The daemonized collectd won't do that.
 
-=item
+=item *
 
 B<2.> collectd will block I<SIGINT>. Pressing I<Ctrl+C> will usually cause
 collectd to shut down. This would be problematic in an interactive session,
 therefore this signal will be blocked. You can still use it to interrupt
 syscalls like sleep and pause but it won't generate a I<KeyboardInterrupt>
 exception either.
 
 To quit collectd send I<EOF> (press I<Ctrl+D> at the beginning of a new line).
 
-=item
+=item *
 
 B<3.> collectd handles I<SIGCHLD>. This means that Python won't be able to
 determine the return code of spawned processes with system(), popen() and
 subprocess. This will result in Python not using external programs like less
 to display help texts. You can override this behavior with the B<PAGER>
 environment variable, e.g. I<export PAGER=less> before starting collectd.
@@ -517,32 +510,32 @@
 
 There are eight different register functions to get callback for eight
 different events. With one exception all of them are called as shown above.
 
 =over 4
 
-=item
+=item *
 
 I<callback> is a callable object that will be called every time the event is
 triggered.
 
-=item
+=item *
 
 I<data> is an optional object that will be passed back to the callback function
 every time it is called. If you omit this parameter no object is passed back to
 your callback, not even None.
 
-=item
+=item *
 
 I<name> is an optional identifier for this callback. The default name is
 B<python>.I<module>. I<module> is taken from the B<__module__> attribute of
 your callback function. Every callback needs a unique identifier, so if you
 want to register the same callback multiple times in the same module you need to
 specify a name here. Otherwise it's safe to ignore this parameter.
 
-=item
+=item *
 
 I<identifier> is the full identifier assigned to this callback.
 
 =back
 
 These functions are called in the various stages of the daemon (see the section
@@ -613,13 +606,13 @@
 Removes a callback or data-set from collectd's internal list of callback
 functions. Every I<register_*> function has an I<unregister_*> function.
 I<identifier> is either the string that was returned by the register function
 or a callback function. The identifier will be constructed in the same way as
 for the register functions.
 
-=item B<flush>(I<plugin[, I<timeout>][, I<identifier>]) -> None
+=item B<flush>(I<plugin[, timeout][, identifier]) -> None
 
 Flush one or all plugins. I<timeout> and the specified I<identifiers> are
 passed on to the registered flush-callbacks. If omitted, the timeout defaults
 to C<-1>. The identifier defaults to None. If the B<plugin> argument has been
 specified, only named plugin will be flushed.
 
@@ -657,13 +650,13 @@
 types used by the read, write and match functions.
 
 =head1 NOTES
 
 =over 4
 
-=item
+=item *
 
 Please feel free to send in new plugins to collectd's mailing list at
 E<lt>collectdE<nbsp>atE<nbsp>verplant.orgE<gt> for review and, possibly,
 inclusion in the main distribution. In the latter case, we will take care of
 keeping the plugin up to date and adapting it to new versions of collectd.
 
@@ -673,29 +666,29 @@
 =back
 
 =head1 CAVEATS
 
 =over 4
 
-=item
+=item *
 
 collectd is heavily multi-threaded. Each collectd thread accessing the Python
 plugin will be mapped to a Python interpreter thread. Any such thread will be
 created and destroyed transparently and on-the-fly.
 
 Hence, any plugin has to be thread-safe if it provides several entry points
 from collectd (i.E<nbsp>e. if it registers more than one callback or if a
 registered callback may be called more than once in parallel).
 
-=item
+=item *
 
 The Python thread module is initialized just before calling the init callbacks.
 This means you must not use Python's threading module prior to this point. This
 includes all config and possibly other callback as well.
 
-=item
+=item *
 
 The python plugin exports the internal API of collectd which is considered
 unstable and subject to change at any time. We try hard to not break backwards
 compatibility in the Python API during the life cycle of one major release.
 However, this cannot be guaranteed at all times. Watch out for warnings
 dispatched by the python plugin after upgrades.
@@ -703,13 +696,13 @@
 =back
 
 =head1 KNOWN BUGS
 
 =over 4
 
-=item
+=item *
 
 Not all aspects of the collectd API are accessible from Python. This includes
 but is not limited to filters and data sets.
 
 =back
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-snmp.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-snmp.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-snmp.5	2015-02-26 18:47:26.536512971 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-snmp.5	2016-07-26 15:48:08.377849074 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-SNMP 5"
-.TH COLLECTD-SNMP 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-SNMP 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-snmp \- Documentation of collectd's "snmp plugin"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-tg.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-tg.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-tg.1	2014-08-18 15:51:38.787539710 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-tg.1	2016-07-19 16:44:20.475958237 +0800
@@ -1,7 +1,7 @@
-.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
+.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
 .\"
 .\" Standard preamble:
 .\" ========================================================================
 .de Sp \" Vertical space (when we can't use .PP)
 .if t .sp .5v
 .if n .sp
@@ -35,33 +35,42 @@
 'br\}
 .el\{\
 .    ds -- \|\(em\|
 .    ds PI \(*p
 .    ds L" ``
 .    ds R" ''
+.    ds C`
+.    ds C'
 'br\}
 .\"
 .\" Escape single quotes in literal strings from groff's Unicode transform.
 .ie \n(.g .ds Aq \(aq
 .el       .ds Aq '
 .\"
 .\" If the F register is turned on, we'll generate index entries on stderr for
 .\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
 .\" entries marked with X<> in POD.  Of course, you'll have to process the
 .\" output yourself in some meaningful fashion.
-.ie \nF \{\
-.    de IX
-.    tm Index:\\$1\t\\n%\t"\\$2"
+.\"
+.\" Avoid warning from groff about undefined register 'F'.
+.de IX
 ..
-.    nr % 0
-.    rr F
-.\}
-.el \{\
-.    de IX
+.nr rF 0
+.if \n(.g .if rF .nr rF 1
+.if (\n(rF:(\n(.g==0)) \{
+.    if \nF \{
+.        de IX
+.        tm Index:\\$1\t\\n%\t"\\$2"
 ..
+.        if !\nF==2 \{
+.            nr % 0
+.            nr F 2
+.        \}
+.    \}
 .\}
+.rr rF
 .\"
 .\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
 .\" Fear.  Run.  Save yourself.  No user-serviceable parts.
 .    \" fudge factors for nroff and troff
 .if n \{\
 .    ds #H 0
@@ -121,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-TG 1"
-.TH COLLECTD-TG 1 "2014-08-18" "5.4.1.359.g103f05e" "collectd"
+.TH COLLECTD-TG 1 "2016-07-19" "5.4.2.398.g4474714" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-tg \- Traffic generator for collectd.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-tg.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-tg.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-tg.c	2015-02-26 18:43:48.460180267 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-tg.c	2016-07-26 15:47:12.953713783 +0800
@@ -180,12 +180,13 @@
       "host%04i", host_num);
   snprintf (vl->identifier.plugin, sizeof (vl->identifier.plugin),
       "plugin%03i", get_boundet_random (0, conf_num_plugins));
   strncpy (vl->identifier.type,
       (vl->values_types[0] == LCC_TYPE_GAUGE) ? "gauge" : "derive",
       sizeof (vl->identifier.type));
+  vl->identifier.type[sizeof (vl->identifier.type) - 1] = 0;
   snprintf (vl->identifier.type_instance, sizeof (vl->identifier.type_instance),
       "ti%li", random ());
 
   return (vl);
 } /* }}} int create_value_list */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-threshold.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-threshold.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-threshold.5	2014-08-18 15:51:38.859541348 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-threshold.5	2016-07-19 16:44:20.531958360 +0800
@@ -1,7 +1,7 @@
-.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
+.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
 .\"
 .\" Standard preamble:
 .\" ========================================================================
 .de Sp \" Vertical space (when we can't use .PP)
 .if t .sp .5v
 .if n .sp
@@ -35,33 +35,42 @@
 'br\}
 .el\{\
 .    ds -- \|\(em\|
 .    ds PI \(*p
 .    ds L" ``
 .    ds R" ''
+.    ds C`
+.    ds C'
 'br\}
 .\"
 .\" Escape single quotes in literal strings from groff's Unicode transform.
 .ie \n(.g .ds Aq \(aq
 .el       .ds Aq '
 .\"
 .\" If the F register is turned on, we'll generate index entries on stderr for
 .\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
 .\" entries marked with X<> in POD.  Of course, you'll have to process the
 .\" output yourself in some meaningful fashion.
-.ie \nF \{\
-.    de IX
-.    tm Index:\\$1\t\\n%\t"\\$2"
+.\"
+.\" Avoid warning from groff about undefined register 'F'.
+.de IX
 ..
-.    nr % 0
-.    rr F
-.\}
-.el \{\
-.    de IX
+.nr rF 0
+.if \n(.g .if rF .nr rF 1
+.if (\n(rF:(\n(.g==0)) \{
+.    if \nF \{
+.        de IX
+.        tm Index:\\$1\t\\n%\t"\\$2"
 ..
+.        if !\nF==2 \{
+.            nr % 0
+.            nr F 2
+.        \}
+.    \}
 .\}
+.rr rF
 .\"
 .\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
 .\" Fear.  Run.  Save yourself.  No user-serviceable parts.
 .    \" fudge factors for nroff and troff
 .if n \{\
 .    ds #H 0
@@ -121,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-THRESHOLD 5"
-.TH COLLECTD-THRESHOLD 5 "2014-08-18" "5.4.1.359.g103f05e" "collectd"
+.TH COLLECTD-THRESHOLD 5 "2016-07-19" "5.4.2.398.g4474714" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-threshold \- Documentation of collectd's Threshold plugin
@@ -164,13 +173,13 @@
 threshold only once for a notification to be generated. There's no such thing
 as a moving average or similar \- at least not now.
 .PP
 Also, all values that match a threshold are considered to be relevant or
 \&\*(L"interesting\*(R". As a consequence collectd will issue a notification if they are
 not received for \fBTimeout\fR iterations. The \fBTimeout\fR configuration option is
-explained in section \*(L"\s-1GLOBAL\s0 \s-1OPTIONS\s0\*(R" in \fIcollectd.conf\fR\|(5). If, for example,
+explained in section \*(L"\s-1GLOBAL OPTIONS\*(R"\s0 in \fIcollectd.conf\fR\|(5). If, for example,
 \&\fBTimeout\fR is set to \*(L"2\*(R" (the default) and some hosts sends it's \s-1CPU\s0 statistics
 to the server every 60 seconds, a notification will be dispatched after about
 120 seconds. It may take a little longer because the timeout is checked only
 once each \fBInterval\fR on the server.
 .PP
 When a value comes within range again or is received after it was missing, an
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-unixsock.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-unixsock.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/collectd-unixsock.5	2015-02-26 18:47:26.656515351 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/collectd-unixsock.5	2016-07-26 15:48:08.481849327 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-UNIXSOCK 5"
-.TH COLLECTD-UNIXSOCK 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH COLLECTD-UNIXSOCK 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 collectd\-unixsock \- Documentation of collectd's "unixsock plugin"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/common.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/common.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/common.c	2015-02-26 19:44:34.027896403 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/common.c	2016-07-26 15:47:12.957713794 +0800
@@ -41,12 +41,14 @@
 
 /* for getaddrinfo */
 #include <sys/types.h>
 #include <sys/socket.h>
 #include <netdb.h>
 
+#include <poll.h>
+
 #if HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
 
 /* for ntohl and htonl */
 #if HAVE_ARPA_INET_H
@@ -262,15 +264,29 @@
 
 ssize_t swrite (int fd, const void *buf, size_t count)
 {
 	const char *ptr;
 	size_t      nleft;
 	ssize_t     status;
+	struct      pollfd pfd;
 
 	ptr   = (const char *) buf;
 	nleft = count;
+	
+	/* checking for closed peer connection */
+	pfd.fd = fd;
+	pfd.events = POLLIN | POLLHUP;
+	pfd.revents = 0;
+	if (poll(&pfd, 1, 0) > 0) {
+		char buffer[32];
+		if (recv(fd, buffer, sizeof(buffer), MSG_PEEK | MSG_DONTWAIT) == 0) {
+			// if recv returns zero (even though poll() said there is data to be read),
+			// that means the connection has been closed
+			return -1;
+		}
+	}
 
 	while (nleft > 0)
 	{
 		status = write (fd, (const void *) ptr, nleft);
 
 		if ((status < 0) && ((errno == EAGAIN) || (errno == EINTR)))
@@ -304,50 +320,57 @@
 			break;
 	}
 
 	return ((int) i);
 }
 
-int strjoin (char *dst, size_t dst_len,
+int strjoin (char *buffer, size_t buffer_size,
 		char **fields, size_t fields_num,
 		const char *sep)
 {
-	size_t field_len;
+	size_t avail;
+	char *ptr;
 	size_t sep_len;
-	int i;
-
-	memset (dst, '\0', dst_len);
+	size_t i;
 
-	if (fields_num <= 0)
+	if ((buffer_size < 1) || (fields_num <= 0))
 		return (-1);
 
+	memset (buffer, 0, buffer_size);
+	ptr = buffer;
+	avail = buffer_size - 1;
+
 	sep_len = 0;
 	if (sep != NULL)
 		sep_len = strlen (sep);
 
-	for (i = 0; i < (int)fields_num; i++)
+	for (i = 0; i < fields_num; i++)
 	{
+		size_t field_len;
+
 		if ((i > 0) && (sep_len > 0))
 		{
-			if (dst_len <= sep_len)
+			if (avail < sep_len)
 				return (-1);
 
-			strncat (dst, sep, dst_len);
-			dst_len -= sep_len;
+			memcpy (ptr, sep, sep_len);
+			ptr += sep_len;
+			avail -= sep_len;
 		}
 
 		field_len = strlen (fields[i]);
-
-		if (dst_len <= field_len)
+		if (avail < field_len)
 			return (-1);
 
-		strncat (dst, fields[i], dst_len);
-		dst_len -= field_len;
+		memcpy (ptr, fields[i], field_len);
+		ptr += field_len;
+		avail -= field_len;
 	}
 
-	return (strlen (dst));
+	assert (buffer[buffer_size - 1] == 0);
+	return (strlen (buffer));
 }
 
 int strsubstitute (char *str, char c_from, char c_to)
 {
 	int ret;
 
@@ -435,13 +458,13 @@
 		return (0);
 
 	/* Move one to the left */
 	if (buf[0] == '/')
 		memmove (buf, buf + 1, buf_len - 1);
 
-	for (i = 0; i < buf_len - 1; i++)
+	for (i = 0; i < buf_len; i++)
 	{
 		if (buf[i] == '\0')
 			break;
 		else if (buf[i] == '/')
 			buf[i] = '_';
 	}
@@ -899,34 +922,33 @@
 
         BUFFER_ADD ("%.3f", CDTIME_T_TO_DOUBLE (vl->time));
 
         for (i = 0; i < ds->ds_num; i++)
         {
                 if (ds->ds[i].type == DS_TYPE_GAUGE)
-                        BUFFER_ADD (":%f", vl->values[i].gauge);
+                        BUFFER_ADD (":"GAUGE_FORMAT, vl->values[i].gauge);
                 else if (store_rates)
                 {
                         if (rates == NULL)
                                 rates = uc_get_rate (ds, vl);
                         if (rates == NULL)
                         {
-                                WARNING ("format_values: "
-						"uc_get_rate failed.");
+                                WARNING ("format_values: uc_get_rate failed.");
                                 return (-1);
                         }
-                        BUFFER_ADD (":%g", rates[i]);
+                        BUFFER_ADD (":"GAUGE_FORMAT, rates[i]);
                 }
                 else if (ds->ds[i].type == DS_TYPE_COUNTER)
                         BUFFER_ADD (":%llu", vl->values[i].counter);
                 else if (ds->ds[i].type == DS_TYPE_DERIVE)
                         BUFFER_ADD (":%"PRIi64, vl->values[i].derive);
                 else if (ds->ds[i].type == DS_TYPE_ABSOLUTE)
                         BUFFER_ADD (":%"PRIu64, vl->values[i].absolute);
                 else
                 {
-                        ERROR ("format_values plugin: Unknown data source type: %i",
+                        ERROR ("format_values: Unknown data source type: %i",
                                         ds->ds[i].type);
                         sfree (rates);
                         return (-1);
                 }
         } /* for ds->ds_num */
 
@@ -1079,12 +1101,15 @@
 {
 	int i;
 	char *dummy;
 	char *ptr;
 	char *saveptr;
 
+	if ((buffer == NULL) || (vl == NULL) || (ds == NULL))
+		return EINVAL;
+
 	i = -1;
 	dummy = buffer;
 	saveptr = NULL;
 	while ((ptr = strtok_r (dummy, ":", &saveptr)) != NULL)
 	{
 		dummy = NULL;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/configfile.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/configfile.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/configfile.c	2015-02-26 19:44:34.031896485 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/configfile.c	2016-07-26 15:47:12.957713794 +0800
@@ -66,40 +66,42 @@
 	struct cf_complex_callback_s *next;
 } cf_complex_callback_t;
 
 typedef struct cf_value_map_s
 {
 	char *key;
-	int (*func) (const oconfig_item_t *);
+	int (*func) (oconfig_item_t *);
 } cf_value_map_t;
 
 typedef struct cf_global_option_s
 {
 	char *key;
 	char *value;
 	char *def;
 } cf_global_option_t;
 
 /*
  * Prototypes of callback functions
  */
-static int dispatch_value_typesdb (const oconfig_item_t *ci);
-static int dispatch_value_plugindir (const oconfig_item_t *ci);
-static int dispatch_loadplugin (const oconfig_item_t *ci);
+static int dispatch_value_typesdb (oconfig_item_t *ci);
+static int dispatch_value_plugindir (oconfig_item_t *ci);
+static int dispatch_loadplugin (oconfig_item_t *ci);
+static int dispatch_block_plugin (oconfig_item_t *ci);
 
 /*
  * Private variables
  */
 static cf_callback_t *first_callback = NULL;
 static cf_complex_callback_t *complex_callback_head = NULL;
 
 static cf_value_map_t cf_value_map[] =
 {
 	{"TypesDB",    dispatch_value_typesdb},
 	{"PluginDir",  dispatch_value_plugindir},
-	{"LoadPlugin", dispatch_loadplugin}
+	{"LoadPlugin", dispatch_loadplugin},
+	{"Plugin",     dispatch_block_plugin}
 };
 static int cf_value_map_num = STATIC_ARRAY_SIZE (cf_value_map);
 
 static cf_global_option_t cf_global_options[] =
 {
 	{"BaseDir",     NULL, PKGLOCALSTATEDIR},
@@ -145,15 +147,18 @@
 	plugin_ctx_t old_ctx;
 	char *key;
 	char *value;
 	int ret;
 	int i;
 
+	if (orig_key == NULL)
+		return (EINVAL);
+
 	DEBUG ("type = %s, key = %s, value = %s",
 			ESCAPE_NULL(type),
-			ESCAPE_NULL(orig_key),
+			orig_key,
 			ESCAPE_NULL(orig_value));
 
 	if ((cf_cb = cf_search (type)) == NULL)
 	{
 		WARNING ("Found a configuration for the `%s' plugin, but "
 				"the plugin isn't loaded or didn't register "
@@ -188,14 +193,12 @@
 	if (i >= cf_cb->keys_num)
 		WARNING ("Plugin `%s' did not register for value `%s'.", type, key);
 
 	free (key);
 	free (value);
 
-	DEBUG ("cf_dispatch: return (%i)", ret);
-
 	return (ret);
 } /* int cf_dispatch */
 
 static int dispatch_global_option (const oconfig_item_t *ci)
 {
 	if (ci->values_num != 1)
@@ -216,13 +219,13 @@
 			return (global_option_set (ci->key, "false"));
 	}
 
 	return (-1);
 } /* int dispatch_global_option */
 
-static int dispatch_value_typesdb (const oconfig_item_t *ci)
+static int dispatch_value_typesdb (oconfig_item_t *ci)
 {
 	int i = 0;
 
 	assert (strcasecmp (ci->key, "TypesDB") == 0);
 
 	cf_default_typesdb = 0;
@@ -242,26 +245,26 @@
 
 		read_types_list (ci->values[i].value.string);
 	}
 	return (0);
 } /* int dispatch_value_typesdb */
 
-static int dispatch_value_plugindir (const oconfig_item_t *ci)
+static int dispatch_value_plugindir (oconfig_item_t *ci)
 {
 	assert (strcasecmp (ci->key, "PluginDir") == 0);
 	
 	if (ci->values_num != 1)
 		return (-1);
 	if (ci->values[0].type != OCONFIG_TYPE_STRING)
 		return (-1);
 
 	plugin_set_dir (ci->values[0].value.string);
 	return (0);
 }
 
-static int dispatch_loadplugin (const oconfig_item_t *ci)
+static int dispatch_loadplugin (oconfig_item_t *ci)
 {
 	int i;
 	const char *name;
 	unsigned int flags = 0;
 	plugin_ctx_t ctx;
 	plugin_ctx_t old_ctx;
@@ -341,13 +344,13 @@
 	/* skip the initial space */
 	buffer_ptr = buffer + 1;
 
 	return (cf_dispatch (plugin, ci->key, buffer_ptr));
 } /* int dispatch_value_plugin */
 
-static int dispatch_value (const oconfig_item_t *ci)
+static int dispatch_value (oconfig_item_t *ci)
 {
 	int ret = -2;
 	int i;
 
 	for (i = 0; i < cf_value_map_num; i++)
 		if (strcasecmp (cf_value_map[i].key, ci->key) == 0)
@@ -381,15 +384,25 @@
 		return (-1);
 
 	name = ci->values[0].value.string;
 
 	if (IS_TRUE (global_option_get ("AutoLoadPlugin")))
 	{
+		plugin_ctx_t ctx;
+		plugin_ctx_t old_ctx;
 		int status;
 
+		/* default to the global interval set before loading this plugin */
+		memset (&ctx, 0, sizeof (ctx));
+		ctx.interval = cf_get_default_interval ();
+
+		old_ctx = plugin_set_ctx (ctx);
 		status = plugin_load (name, /* flags = */ 0);
+		/* reset to the "global" context */
+		plugin_set_ctx (old_ctx);
+
 		if (status != 0)
 		{
 			ERROR ("Automatically loading plugin \"%s\" failed "
 					"with status %i.", name, status);
 			return (status);
 		}
@@ -594,14 +607,17 @@
 		sfree (pattern);
 
 		if (new == NULL)
 			return (-1);
 
 		/* Now replace the i'th child in `root' with `new'. */
-		if (cf_ci_replace_child (root, new, i) < 0)
+		if (cf_ci_replace_child (root, new, i) < 0) {
+			sfree (new->values);
+			sfree (new);
 			return (-1);
+		}
 
 		/* ... and go back to the new i'th child. */
 		--i;
 
 		sfree (new->values);
 		sfree (new);
@@ -684,12 +700,13 @@
 	}
 
 	root = (oconfig_item_t *) malloc (sizeof (oconfig_item_t));
 	if (root == NULL)
 	{
 		ERROR ("configfile: malloc failed.");
+		closedir (dh);
 		return (NULL);
 	}
 	memset (root, 0, sizeof (oconfig_item_t));
 
 	while ((de = readdir (dh)) != NULL)
 	{
@@ -703,35 +720,43 @@
 				dir, de->d_name);
 		if ((status < 0) || ((size_t) status >= sizeof (name)))
 		{
 			ERROR ("configfile: Not including `%s/%s' because its"
 					" name is too long.",
 					dir, de->d_name);
+			closedir (dh);
 			for (i = 0; i < filenames_num; ++i)
 				free (filenames[i]);
 			free (filenames);
 			free (root);
 			return (NULL);
 		}
 
 		++filenames_num;
 		tmp = (char **) realloc (filenames,
 				filenames_num * sizeof (*filenames));
 		if (tmp == NULL) {
 			ERROR ("configfile: realloc failed.");
+			closedir (dh);
 			for (i = 0; i < filenames_num - 1; ++i)
 				free (filenames[i]);
 			free (filenames);
 			free (root);
 			return (NULL);
 		}
 		filenames = tmp;
 
 		filenames[filenames_num - 1] = sstrdup (name);
 	}
 
+	if (filenames == NULL)
+	{
+		closedir (dh);
+		return (root);
+	}
+
 	qsort ((void *) filenames, filenames_num, sizeof (*filenames),
 			cf_compare_string);
 
 	for (i = 0; i < filenames_num; ++i)
 	{
 		oconfig_item_t *temp;
@@ -749,17 +774,18 @@
 		sfree (temp->children);
 		sfree (temp);
 
 		free (name);
 	}
 
+	closedir (dh);
 	free(filenames);
 	return (root);
 } /* oconfig_item_t *cf_read_dir */
 
-/* 
+/*
  * cf_read_generic
  *
  * Path is stat'ed and either cf_read_file or cf_read_dir is called
  * accordingly.
  *
  * There are two versions of this function: If `wordexp' exists shell wildcards
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/config.h.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/config.h.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/config.h.in	2015-02-26 22:10:02.940043256 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/config.h.in	2016-07-26 15:48:06.793845218 +0800
@@ -176,12 +176,15 @@
 /* Define to 1 if you have the `getloadavg' function. */
 #undef HAVE_GETLOADAVG
 
 /* Define to 1 if you have the `getmntent' function. */
 #undef HAVE_GETMNTENT
 
+/* Define to 1 if you have the `getmntent_r' function. */
+#undef HAVE_GETMNTENT_R
+
 /* Define to 1 if you have the `getnameinfo' function. */
 #undef HAVE_GETNAMEINFO
 
 /* Define to 1 if you have the `getpwnam_r' function. */
 #undef HAVE_GETPWNAM_R
 
@@ -516,14 +519,14 @@
 /* Define to 1 if you have the <mntent.h> header file. */
 #undef HAVE_MNTENT_H
 
 /* Define to 1 if you have the <mnttab.h> header file. */
 #undef HAVE_MNTTAB_H
 
-/* Define to 1 if you have the <modbus/modbus.h> header file. */
-#undef HAVE_MODBUS_MODBUS_H
+/* Define to 1 if you have the <modbus.h> header file. */
+#undef HAVE_MODBUS_H
 
 /* Define to 1 if you have the <mongo.h> header file. */
 #undef HAVE_MONGO_H
 
 /* Define to 1 if you have the <mysql.h> header file. */
 #undef HAVE_MYSQL_H
@@ -621,15 +624,12 @@
 /* Define to 1 if you have the <owcapi.h> header file. */
 #undef HAVE_OWCAPI_H
 
 /* Define to 1 if you have the <paths.h> header file. */
 #undef HAVE_PATHS_H
 
-/* Define to 1 if you have the <pcap-bpf.h> header file. */
-#undef HAVE_PCAP_BPF_H
-
 /* Define to 1 if you have the <pcap.h> header file. */
 #undef HAVE_PCAP_H
 
 /* Define to 1 if you have the 'perfstat' library (-lperfstat) */
 #undef HAVE_PERFSTAT
 
@@ -1008,12 +1008,15 @@
 /* Define to 1 if you have the `processor_info' function. */
 #undef HAVE_PROCESSOR_INFO
 
 /* Define to 1 if you have the procinfo.h */
 #undef HAVE_PROCINFO_H
 
+/* Define to 1 if you have the <protobuf-c/protobuf-c.h> header file. */
+#undef HAVE_PROTOBUF_C_PROTOBUF_C_H
+
 /* Define to 1 if you have the <pthread.h> header file. */
 #undef HAVE_PTHREAD_H
 
 /* Define to 1 if you have the <pwd.h> header file. */
 #undef HAVE_PWD_H
 
@@ -1155,12 +1158,15 @@
 /* Define to 1 if `id' is a member of `struct inet_diag_req'. */
 #undef HAVE_STRUCT_INET_DIAG_REQ_ID
 
 /* Define to 1 if `idiag_states' is a member of `struct inet_diag_req'. */
 #undef HAVE_STRUCT_INET_DIAG_REQ_IDIAG_STATES
 
+/* Define to 1 if the system has the type `struct ip6_ext'. */
+#undef HAVE_STRUCT_IP6_EXT
+
 /* Define to 1 if `imr_ifindex' is a member of `struct ip_mreqn'. */
 #undef HAVE_STRUCT_IP_MREQN_IMR_IFINDEX
 
 /* Define if struct kinfo_proc exists in the FreeBSD variant. */
 #undef HAVE_STRUCT_KINFO_PROC_FREEBSD
 
@@ -1331,13 +1337,13 @@
 /* Define to 1 if you have the <tcrdb.h> header file. */
 #undef HAVE_TCRDB_H
 
 /* Define to 1 if you have the <termios.h> header file. */
 #undef HAVE_TERMIOS_H
 
-/* Define to 1 if you have the threadsafe rrd library (-lrrd_th). */
+/* Define to 1 if the rrd library is thread-safe */
 #undef HAVE_THREADSAFE_LIBRRD
 
 /* Define to 1 if you have the `thread_info' function. */
 #undef HAVE_THREAD_INFO
 
 /* Define if the function getmntent exists and takes two arguments. */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/cpu.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/cpu.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/cpu.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/cpu.c	2016-07-26 15:47:12.957713794 +0800
@@ -143,21 +143,31 @@
 {
 #if PROCESSOR_CPU_LOAD_INFO
 	kern_return_t status;
 
 	port_host = mach_host_self ();
 
-	/* FIXME: Free `cpu_list' if it's not NULL */
-	if ((status = host_processors (port_host, &cpu_list, &cpu_list_len)) != KERN_SUCCESS)
+	status = host_processors (port_host, &cpu_list, &cpu_list_len);
+	if (status == KERN_INVALID_ARGUMENT)
 	{
-		ERROR ("cpu plugin: host_processors returned %i", (int) status);
+		ERROR ("cpu plugin: Don't have a privileged host control port. "
+				"The most common cause for this problem is "
+				"that collectd is running without root "
+				"privileges, which are required to read CPU "
+				"load information. "
+				"<https://collectd.org/bugs/22>");
+		cpu_list_len = 0;
+		return (-1);
+	}
+	if (status != KERN_SUCCESS)
+	{
+		ERROR ("cpu plugin: host_processors() failed with status %d.", (int) status);
 		cpu_list_len = 0;
 		return (-1);
 	}
 
-	DEBUG ("host_processors returned %i %s", (int) cpu_list_len, cpu_list_len == 1 ? "processor" : "processors");
 	INFO ("cpu plugin: Found %i processor%s.", (int) cpu_list_len, cpu_list_len == 1 ? "" : "s");
 /* #endif PROCESSOR_CPU_LOAD_INFO */
 
 #elif defined(HAVE_LIBKSTAT)
 	kstat_t *ksp_chain;
 
@@ -255,13 +265,13 @@
 static int cpu_read (void)
 {
 #if PROCESSOR_CPU_LOAD_INFO
 	int cpu;
 
 	kern_return_t status;
-	
+
 	processor_cpu_load_info_data_t cpu_info;
 	mach_msg_type_number_t         cpu_info_len;
 
 	host_t cpu_host;
 
 	for (cpu = 0; cpu < cpu_list_len; cpu++)
@@ -509,16 +519,16 @@
 	{
 		char errbuf[1024];
 		WARNING ("cpu plugin: perfstat_cpu: %s",
 			sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
-	
-	if (pnumcpu != numcpu || perfcpu == NULL) 
+
+	if (pnumcpu != numcpu || perfcpu == NULL)
 	{
-		if (perfcpu != NULL) 
+		if (perfcpu != NULL)
 			free(perfcpu);
 		perfcpu = malloc(numcpu * sizeof(perfstat_cpu_t));
 	}
 	pnumcpu = numcpu;
 
 	id.name[0] = '\0';
@@ -527,13 +537,13 @@
 		char errbuf[1024];
 		WARNING ("cpu plugin: perfstat_cpu: %s",
 			sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 
-	for (i = 0; i < cpus; i++) 
+	for (i = 0; i < cpus; i++)
 	{
 		submit (i, "idle",   (derive_t) perfcpu[i].idle);
 		submit (i, "system", (derive_t) perfcpu[i].sys);
 		submit (i, "user",   (derive_t) perfcpu[i].user);
 		submit (i, "wait",   (derive_t) perfcpu[i].wait);
 	}
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/csv.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/csv.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/csv.c	2015-02-26 18:43:48.472180506 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/csv.c	2016-07-26 15:47:12.957713794 +0800
@@ -62,19 +62,22 @@
 	for (i = 0; i < ds->ds_num; i++)
 	{
 		if ((ds->ds[i].type != DS_TYPE_COUNTER)
 				&& (ds->ds[i].type != DS_TYPE_GAUGE)
 				&& (ds->ds[i].type != DS_TYPE_DERIVE)
 				&& (ds->ds[i].type != DS_TYPE_ABSOLUTE))
+		{
+			sfree (rates);
 			return (-1);
+		}
 
-		if (ds->ds[i].type == DS_TYPE_GAUGE) 
+		if (ds->ds[i].type == DS_TYPE_GAUGE)
 		{
 			status = ssnprintf (buffer + offset, buffer_len - offset,
 					",%lf", vl->values[i].gauge);
-		} 
+		}
 		else if (store_rates != 0)
 		{
 			if (rates == NULL)
 				rates = uc_get_rate (ds, vl);
 			if (rates == NULL)
 			{
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl.c	2015-02-26 19:44:34.031896485 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl.c	2016-07-26 15:47:12.957713794 +0800
@@ -162,22 +162,25 @@
   sfree (wp);
 } /* }}} void cc_web_page_free */
 
 static int cc_config_append_string (const char *name, struct curl_slist **dest, /* {{{ */
     oconfig_item_t *ci)
 {
+  struct curl_slist *temp = NULL;
   if ((ci->values_num != 1) || (ci->values[0].type != OCONFIG_TYPE_STRING))
   {
     WARNING ("curl plugin: `%s' needs exactly one string argument.", name);
     return (-1);
   }
 
-  *dest = curl_slist_append(*dest, ci->values[0].value.string);
-  if (*dest == NULL)
+  temp = curl_slist_append(*dest, ci->values[0].value.string);
+  if (temp == NULL)
     return (-1);
 
+  *dest = temp;
+
   return (0);
 } /* }}} int cc_config_append_string */
 
 static int cc_config_add_match_dstype (int *dstype_ret, /* {{{ */
     oconfig_item_t *ci)
 {
@@ -322,13 +325,16 @@
     }
 
     break;
   } /* while (status == 0) */
 
   if (status != 0)
+  {
+    cc_web_match_free (match);
     return (status);
+  }
 
   match->match = match_create_simple (match->regex, match->exclude_regex,
       match->dstype);
   if (match->match == NULL)
   {
     ERROR ("curl plugin: tail_match_add_match_simple failed.");
@@ -638,26 +644,26 @@
     start = cdtime ();
 
   wp->buffer_fill = 0;
   status = curl_easy_perform (wp->curl);
   if (status != CURLE_OK)
   {
-    ERROR ("curl plugin: curl_easy_perform failed with staus %i: %s",
+    ERROR ("curl plugin: curl_easy_perform failed with status %i: %s",
         status, wp->curl_errbuf);
     return (-1);
   }
 
   if (wp->response_time)
     cc_submit_response_time (wp, cdtime() - start);
 
   if(wp->response_code)
   {
     long response_code = 0;
     status = curl_easy_getinfo(wp->curl, CURLINFO_RESPONSE_CODE, &response_code);
     if(status != CURLE_OK) {
-      ERROR ("curl plugin: Fetching response code failed with staus %i: %s",
+      ERROR ("curl plugin: Fetching response code failed with status %i: %s",
         status, wp->curl_errbuf);
     } else {
       cc_submit_response_code(wp, response_code);
     }
   }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl_json.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl_json.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl_json.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl_json.c	2016-07-26 15:47:12.957713794 +0800
@@ -126,23 +126,17 @@
     return (len);
 #if !HAVE_YAJL_V2
   else if (status == yajl_status_insufficient_data)
     return (len);
 #endif
 
-  if (status != yajl_status_ok)
-  {
-    unsigned char *msg =
-      yajl_get_error(db->yajl, /* verbose = */ 1,
-          /* jsonText = */ (unsigned char *) buf, (unsigned int) len);
-    ERROR ("curl_json plugin: yajl_parse failed: %s", msg);
-    yajl_free_error(db->yajl, msg);
-    return (0); /* abort write callback */
-  }
-
-  return (len);
+  unsigned char *msg = yajl_get_error(db->yajl, /* verbose = */ 1,
+        /* jsonText = */ (unsigned char *) buf, (unsigned int) len);
+  ERROR ("curl_json plugin: yajl_parse failed: %s", msg);
+  yajl_free_error(db->yajl, msg);
+  return (0); /* abort write callback */
 } /* }}} size_t cj_curl_callback */
 
 static int cj_get_type (cj_key_t *key)
 {
   const data_set_t *ds;
 
@@ -447,22 +441,25 @@
   return c_avl_create ((int (*) (const void *, const void *)) strcmp);
 }
 
 static int cj_config_append_string (const char *name, struct curl_slist **dest, /* {{{ */
     oconfig_item_t *ci)
 {
+  struct curl_slist *temp = NULL;
   if ((ci->values_num != 1) || (ci->values[0].type != OCONFIG_TYPE_STRING))
   {
     WARNING ("curl_json plugin: `%s' needs exactly one string argument.", name);
     return (-1);
   }
 
-  *dest = curl_slist_append(*dest, ci->values[0].value.string);
-  if (*dest == NULL)
+  temp = curl_slist_append(*dest, ci->values[0].value.string);
+  if (temp == NULL)
     return (-1);
 
+  *dest = temp;
+
   return (0);
 } /* }}} int cj_config_append_string */
 
 static int cj_config_add_key (cj_t *db, /* {{{ */
                                    oconfig_item_t *ci)
 {
@@ -497,12 +494,13 @@
     }
   }
   else
   {
     ERROR ("curl_json plugin: cj_config: "
            "Invalid key: %s", ci->key);
+    cj_key_free (key);
     return (-1);
   }
 
   status = 0;
   for (i = 0; i < ci->children_num; i++)
   {
@@ -519,78 +517,74 @@
     }
 
     if (status != 0)
       break;
   } /* for (i = 0; i < ci->children_num; i++) */
 
-  while (status == 0)
+  if (status != 0)
   {
-    if (key->type == NULL)
-    {
-      WARNING ("curl_json plugin: `Type' missing in `Key' block.");
-      status = -1;
-    }
+    cj_key_free (key);
+    return (-1);
+  }
 
-    break;
-  } /* while (status == 0) */
+  if (key->type == NULL)
+  {
+    WARNING ("curl_json plugin: `Type' missing in `Key' block.");
+    cj_key_free (key);
+    return (-1);
+  }
 
   /* store path in a tree that will match the json map structure, example:
    * "httpd/requests/count",
    * "httpd/requests/current" ->
    * { "httpd": { "requests": { "count": $key, "current": $key } } }
    */
-  if (status == 0)
+  char *ptr;
+  char *name;
+  c_avl_tree_t *tree;
+
+  if (db->tree == NULL)
+    db->tree = cj_avl_create();
+
+  tree = db->tree;
+  ptr = key->path;
+  if (*ptr == '/')
+    ++ptr;
+
+  name = ptr;
+  while ((ptr = strchr (name, '/')) != NULL)
   {
-    char *ptr;
-    char *name;
     char ent[PATH_MAX];
-    c_avl_tree_t *tree;
+    c_avl_tree_t *value;
+    size_t len;
 
-    if (db->tree == NULL)
-      db->tree = cj_avl_create();
+    len = ptr - name;
+    if (len == 0)
+      break;
 
-    tree = db->tree;
-    name = key->path;
-    ptr = key->path;
-    if (*ptr == '/')
-      ++ptr;
+    len = COUCH_MIN(len, sizeof (ent)-1);
+    sstrncpy (ent, name, len+1);
 
-    name = ptr;
-    while (*ptr)
+    if (c_avl_get (tree, ent, (void *) &value) != 0)
     {
-      if (*ptr == '/')
-      {
-        c_avl_tree_t *value;
-        int len;
-
-        len = ptr-name;
-        if (len == 0)
-          break;
-        len = COUCH_MIN(len, sizeof (ent)-1);
-        sstrncpy (ent, name, len+1);
-
-        if (c_avl_get (tree, ent, (void *) &value) != 0)
-        {
-          value = cj_avl_create ();
-          c_avl_insert (tree, strdup (ent), value);
-        }
-
-        tree = value;
-        name = ptr+1;
-      }
-      ++ptr;
-    }
-    if (*name)
-      c_avl_insert (tree, strdup(name), key);
-    else
-    {
-      ERROR ("curl_json plugin: invalid key: %s", key->path);
-      status = -1;
+      value = cj_avl_create ();
+      c_avl_insert (tree, strdup (ent), value);
     }
+
+    tree = value;
+    name = ptr + 1;
+  }
+
+  if (strlen (name) == 0)
+  {
+    ERROR ("curl_json plugin: invalid key: %s", key->path);
+    cj_key_free (key);
+    return (-1);
   }
 
+  c_avl_insert (tree, strdup (name), key);
   return (status);
 } /* }}} int cj_config_add_key */
 
 static int cj_init_curl (cj_t *db) /* {{{ */
 {
   db->curl = curl_easy_init ();
@@ -668,12 +662,13 @@
   else if (strcasecmp ("Sock", ci->key) == 0)
     status = cf_util_get_string (ci, &db->sock);
   else
   {
     ERROR ("curl_json plugin: cj_config: "
            "Invalid key: %s", ci->key);
+    cj_free (db);
     return (-1);
   }
   if (status != 0)
   {
     sfree (db);
     return (status);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl_xml.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl_xml.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/curl_xml.c	2015-02-26 19:44:34.031896485 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/curl_xml.c	2016-07-26 15:47:12.957713794 +0800
@@ -212,22 +212,25 @@
   sfree (db);
 } /* }}} void cx_free */
 
 static int cx_config_append_string (const char *name, struct curl_slist **dest, /* {{{ */
     oconfig_item_t *ci)
 {
+  struct curl_slist *temp = NULL;
   if ((ci->values_num != 1) || (ci->values[0].type != OCONFIG_TYPE_STRING))
   {
     WARNING ("curl_xml plugin: `%s' needs exactly one string argument.", name);
     return (-1);
   }
 
-  *dest = curl_slist_append(*dest, ci->values[0].value.string);
-  if (*dest == NULL)
+  temp = curl_slist_append(*dest, ci->values[0].value.string);
+  if (temp == NULL)
     return (-1);
 
+  *dest = temp;
+
   return (0);
 } /* }}} int cx_config_append_string */
 
 static int cx_check_type (const data_set_t *ds, cx_xpath_t *xpath) /* {{{ */
 {
   if (!ds)
@@ -338,12 +341,13 @@
       vl->values[index].gauge = (gauge_t) strtod (node_value,
           /* endptr = */ NULL);
   }
 
   /* free up object */
   xmlXPathFreeObject (values_node_obj);
+  sfree (node_value);
 
   /* We have reached here which means that
    * we have got something to work */
   return (0);
 } /* }}} int cx_handle_single_value_xpath */
 
@@ -382,13 +386,13 @@
 
   memset (vl->type_instance, 0, sizeof (vl->type_instance));
 
   /* If the base xpath returns more than one block, the result is assumed to be
    * a table. The `Instance' option is not optional in this case. Check for the
    * condition and inform the user. */
-  if (is_table)
+  if (is_table && (xpath->instance == NULL))
   {
     WARNING ("curl_xml plugin: "
         "Base-XPath %s is a table (more than one result was returned), "
         "but no instance-XPath has been defined.",
         xpath->path);
     return (-1);
@@ -435,25 +439,32 @@
     }
   } /* if (xpath->instance != NULL) */
 
   if (xpath->instance_prefix != NULL)
   {
     if (instance_node != NULL)
+    {
+      char *node_value = (char *) xmlNodeGetContent(instance_node->nodeTab[0]);
       ssnprintf (vl->type_instance, sizeof (vl->type_instance),"%s%s",
-          xpath->instance_prefix, (char *) xmlNodeGetContent(instance_node->nodeTab[0]));
+          xpath->instance_prefix, node_value);
+      sfree (node_value);
+    }
     else
       sstrncpy (vl->type_instance, xpath->instance_prefix,
           sizeof (vl->type_instance));
   }
   else
   {
     /* If instance_prefix and instance_node are NULL, then
      * don't set the type_instance */
     if (instance_node != NULL)
-      sstrncpy (vl->type_instance, (char *) xmlNodeGetContent(instance_node->nodeTab[0]),
-          sizeof (vl->type_instance));
+    {
+      char *node_value = (char *) xmlNodeGetContent(instance_node->nodeTab[0]);
+      sstrncpy (vl->type_instance, node_value, sizeof (vl->type_instance));
+      sfree (node_value);
+    }
   }
 
   /* Free `instance_node_obj' this late, because `instance_node' points to
    * somewhere inside this structure. */
   xmlXPathFreeObject (instance_node_obj);
 
@@ -685,42 +696,44 @@
   for (i = 0; i < ci->values_num; i++)
   {
     xpath->values[i].path_len = sizeof (ci->values[i].value.string);
     sstrncpy (xpath->values[i].path, ci->values[i].value.string, sizeof (xpath->values[i].path));
   }
 
-  return (0); 
+  return (0);
 } /* }}} cx_config_add_values */
 
-static int cx_config_add_xpath (cx_t *db, /* {{{ */
-                                   oconfig_item_t *ci)
+static int cx_config_add_xpath (cx_t *db, oconfig_item_t *ci) /* {{{ */
 {
   cx_xpath_t *xpath;
+  char *name;
+  llentry_t *le;
   int status;
   int i;
 
-  xpath = (cx_xpath_t *) malloc (sizeof (*xpath));
+  xpath = malloc (sizeof (*xpath));
   if (xpath == NULL)
   {
     ERROR ("curl_xml plugin: malloc failed.");
     return (-1);
   }
   memset (xpath, 0, sizeof (*xpath));
 
   status = cf_util_get_string (ci, &xpath->path);
   if (status != 0)
   {
-    sfree (xpath);
+    cx_xpath_free (xpath);
     return (status);
   }
 
   /* error out if xpath->path is an empty string */
-  if (*xpath->path == 0)
+  if (strlen (xpath->path) == 0)
   {
     ERROR ("curl_xml plugin: invalid xpath. "
            "xpath value can't be an empty string");
+    cx_xpath_free (xpath);
     return (-1);
   }
 
   status = 0;
   for (i = 0; i < ci->children_num; i++)
   {
@@ -741,51 +754,55 @@
     }
 
     if (status != 0)
       break;
   } /* for (i = 0; i < ci->children_num; i++) */
 
-  if (status == 0 && xpath->type == NULL)
+  if (status != 0)
   {
-    WARNING ("curl_xml plugin: `Type' missing in `xpath' block.");
-    status = -1;
+    cx_xpath_free (xpath);
+    return status;
   }
 
-  if (status == 0)
+  if (xpath->type == NULL)
   {
-    char *name;
-    llentry_t *le;
+    WARNING ("curl_xml plugin: `Type' missing in `xpath' block.");
+    cx_xpath_free (xpath);
+    return -1;
+  }
 
+  if (db->list == NULL)
+  {
+    db->list = llist_create();
     if (db->list == NULL)
     {
-      db->list = llist_create();
-      if (db->list == NULL)
-      {
-        ERROR ("curl_xml plugin: list creation failed.");
-        return (-1);
-      }
-    }
-
-    name = strdup(xpath->path);
-    if (name == NULL)
-    {
-        ERROR ("curl_xml plugin: strdup failed.");
-        return (-1);
-    }
-
-    le = llentry_create (name, xpath);
-    if (le == NULL)
-    {
-      ERROR ("curl_xml plugin: llentry_create failed.");
+      ERROR ("curl_xml plugin: list creation failed.");
+      cx_xpath_free (xpath);
       return (-1);
     }
+  }
 
-    llist_append (db->list, le);
+  name = strdup (xpath->path);
+  if (name == NULL)
+  {
+    ERROR ("curl_xml plugin: strdup failed.");
+    cx_xpath_free (xpath);
+    return (-1);
   }
 
-  return (status);
+  le = llentry_create (name, xpath);
+  if (le == NULL)
+  {
+    ERROR ("curl_xml plugin: llentry_create failed.");
+    cx_xpath_free (xpath);
+    sfree (name);
+    return (-1);
+  }
+
+  llist_append (db->list, le);
+  return (0);
 } /* }}} int cx_config_add_xpath */
 
 static int cx_config_add_namespace (cx_t *db, /* {{{ */
     oconfig_item_t *ci)
 {
   cx_namespace_t *ns;
@@ -908,12 +925,13 @@
     }
   }
   else
   {
     ERROR ("curl_xml plugin: cx_config: "
            "Invalid key: %s", ci->key);
+    cx_free (db);
     return (-1);
   }
 
   /* Fill the `cx_t' structure.. */
   for (i = 0; i < ci->children_num; i++)
   {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/dbi.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/dbi.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/dbi.c	2015-02-26 19:49:36.438060967 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/dbi.c	2016-07-26 15:47:12.957713794 +0800
@@ -410,13 +410,13 @@
       udb_query_create (&queries, &queries_num, child,
           /* callback = */ NULL);
     else if (strcasecmp ("Database", child->key) == 0)
       cdbi_config_add_database (child);
     else
     {
-      WARNING ("snmp plugin: Ignoring unknown config option `%s'.", child->key);
+      WARNING ("dbi plugin: Ignoring unknown config option `%s'.", child->key);
     }
   } /* for (ci->children) */
 
   return (0);
 } /* }}} int cdbi_config */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/df.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/df.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/df.c	2015-02-26 19:44:34.031896485 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/df.c	2016-07-26 15:47:12.957713794 +0800
@@ -50,13 +50,12 @@
 {
 	"Device",
 	"MountPoint",
 	"FSType",
 	"IgnoreSelected",
 	"ReportByDevice",
-	"ReportReserved",
 	"ReportInodes",
 	"ValuesAbsolute",
 	"ValuesPercentage"
 };
 static int config_keys_num = STATIC_ARRAY_SIZE (config_keys);
 
@@ -201,26 +200,49 @@
 	}
 
 	for (mnt_ptr = mnt_list; mnt_ptr != NULL; mnt_ptr = mnt_ptr->next)
 	{
 		unsigned long long blocksize;
 		char disk_name[256];
+		cu_mount_t *dup_ptr;
 		uint64_t blk_free;
 		uint64_t blk_reserved;
 		uint64_t blk_used;
 
-		if (ignorelist_match (il_device,
-					(mnt_ptr->spec_device != NULL)
-					? mnt_ptr->spec_device
-					: mnt_ptr->device))
+		char const *dev = (mnt_ptr->spec_device != NULL)
+			? mnt_ptr->spec_device
+			: mnt_ptr->device;
+
+		if (ignorelist_match (il_device, dev))
 			continue;
 		if (ignorelist_match (il_mountpoint, mnt_ptr->dir))
 			continue;
 		if (ignorelist_match (il_fstype, mnt_ptr->type))
 			continue;
 
+		/* search for duplicates *in front of* the current mnt_ptr. */
+		for (dup_ptr = mnt_list; dup_ptr != NULL; dup_ptr = dup_ptr->next)
+		{
+			/* No duplicate found: mnt_ptr is the first of its kind. */
+			if (dup_ptr == mnt_ptr)
+			{
+				dup_ptr = NULL;
+				break;
+			}
+
+			/* Duplicate found: leave non-NULL dup_ptr. */
+			if (by_device && (strcmp (mnt_ptr->spec_device, dup_ptr->spec_device) == 0))
+				break;
+			else if (!by_device && (strcmp (mnt_ptr->dir, dup_ptr->dir) == 0))
+				break;
+		}
+
+		/* ignore duplicates */
+		if (dup_ptr != NULL)
+			continue;
+
 		if (STATANYFS (mnt_ptr->dir, &statbuf) < 0)
 		{
 			char errbuf[1024];
 			ERROR (STATANYFS_STR"(%s) failed: %s",
 					mnt_ptr->dir,
 					sstrerror (errno, errbuf,
@@ -231,31 +253,27 @@
 		if (!statbuf.f_blocks)
 			continue;
 
 		if (by_device)
 		{
 			/* eg, /dev/hda1  -- strip off the "/dev/" */
-			if (strncmp (mnt_ptr->spec_device, "/dev/", strlen ("/dev/")) == 0)
-				sstrncpy (disk_name, mnt_ptr->spec_device + strlen ("/dev/"), sizeof (disk_name));
+			if (strncmp (dev, "/dev/", strlen ("/dev/")) == 0)
+				sstrncpy (disk_name, dev + strlen ("/dev/"), sizeof (disk_name));
 			else
-				sstrncpy (disk_name, mnt_ptr->spec_device, sizeof (disk_name));
+				sstrncpy (disk_name, dev, sizeof (disk_name));
 
 			if (strlen(disk_name) < 1)
 			{
 				DEBUG("df: no device name for mountpoint %s, skipping", mnt_ptr->dir);
 				continue;
 			}
 		}
 		else
 		{
 			if (strcmp (mnt_ptr->dir, "/") == 0)
-			{
-				if (strcmp (mnt_ptr->type, "rootfs") == 0)
-					continue;
 				sstrncpy (disk_name, "root", sizeof (disk_name));
-			}
 			else
 			{
 				int i, len;
 
 				sstrncpy (disk_name, mnt_ptr->dir + 1, sizeof (disk_name));
 				len = strlen (disk_name);
@@ -317,13 +335,13 @@
 					(gauge_t) ((float_t)(blk_used) / statbuf.f_blocks * 100));
 				}
 			else return (-1);
 		}
 
 		/* inode handling */
-		if (report_inodes)
+		if (report_inodes && statbuf.f_files != 0 && statbuf.f_ffree != 0)
 		{
 			uint64_t inode_free;
 			uint64_t inode_reserved;
 			uint64_t inode_used;
 
 			/* Sanity-check for the values in the struct */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/dns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/dns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/dns.c	2015-02-26 18:43:48.472180506 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/dns.c	2016-07-26 15:47:12.957713794 +0800
@@ -18,25 +18,25 @@
  *
  * Authors:
  *   Florian octo Forster <octo at collectd.org>
  *   Mirko Buffoni <briareos at eswat.org>
  **/
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
 
 #include "utils_dns.h"
 #include <pthread.h>
 #include <poll.h>
 
 #include <pcap.h>
-#include <pcap-bpf.h>
 
 /*
  * Private data types
  */
 struct counter_list_s
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/email.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/email.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/email.c	2015-02-26 18:43:48.472180506 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/email.c	2016-07-26 15:47:12.957713794 +0800
@@ -248,14 +248,12 @@
 
 static void *collect (void *arg)
 {
 	collector_t *this = (collector_t *)arg;
 
 	while (1) {
-		int loop = 1;
-
 		conn_t *connection;
 
 		pthread_mutex_lock (&conns_mutex);
 
 		while (NULL == conns.head) {
 			pthread_cond_wait (&conn_available, &conns_mutex);
@@ -274,21 +272,19 @@
 		 * thread and connection management */
 		this->socket = connection->socket;
 
 		log_debug ("collect: handling connection on fd #%i",
 				fileno (this->socket));
 
-		while (loop) {
+		while (42) {
 			/* 256 bytes ought to be enough for anybody ;-) */
 			char line[256 + 1]; /* line + '\0' */
 			int  len = 0;
 
 			errno = 0;
 			if (NULL == fgets (line, sizeof (line), this->socket)) {
-				loop = 0;
-
 				if (0 != errno) {
 					char errbuf[1024];
 					log_err ("collect: reading from socket (fd #%i) "
 							"failed: %s", fileno (this->socket),
 							sstrerror (errno, errbuf, sizeof (errbuf)));
 				}
@@ -302,14 +298,17 @@
 
 				while (NULL != fgets (line, sizeof (line), this->socket))
 					if (('\n' == line[len - 1]) || ('\r' == line[len - 1]))
 						break;
 				continue;
 			}
+			if (len < 3) { /* [a-z] ':' '\n' */
+				continue;
+			}
 
-			line[len - 1] = '\0';
+			line[len - 1] = 0;
 
 			log_debug ("collect: line = '%s'", line);
 
 			if (':' != line[1]) {
 				log_err ("collect: syntax error in line '%s'", line);
 				continue;
@@ -326,42 +325,45 @@
 					continue;
 				}
 
 				bytes = atoi (tmp);
 
 				pthread_mutex_lock (&count_mutex);
-				type_list_incr (&list_count, type, 1);
+				type_list_incr (&list_count, type, /* increment = */ 1);
 				pthread_mutex_unlock (&count_mutex);
 
 				if (bytes > 0) {
 					pthread_mutex_lock (&size_mutex);
-					type_list_incr (&list_size, type, bytes);
+					type_list_incr (&list_size, type, /* increment = */ bytes);
 					pthread_mutex_unlock (&size_mutex);
 				}
 			}
 			else if ('s' == line[0]) { /* s:<value> */
 				pthread_mutex_lock (&score_mutex);
 				score = (score * (double)score_count + atof (line + 2))
 						/ (double)(score_count + 1);
 				++score_count;
 				pthread_mutex_unlock (&score_mutex);
 			}
 			else if ('c' == line[0]) { /* c:<type1>[,<type2>,...] */
-				char *ptr  = NULL;
-				char *type = strtok_r (line + 2, ",", &ptr);
-
-				do {
-					pthread_mutex_lock (&check_mutex);
-					type_list_incr (&list_check, type, 1);
-					pthread_mutex_unlock (&check_mutex);
-				} while (NULL != (type = strtok_r (NULL, ",", &ptr)));
+				char *dummy = line + 2;
+				char *endptr = NULL;
+				char *type;
+
+				pthread_mutex_lock (&check_mutex);
+				while ((type = strtok_r (dummy, ",", &endptr)) != NULL)
+				{
+					dummy = NULL;
+					type_list_incr (&list_check, type, /* increment = */ 1);
+				}
+				pthread_mutex_unlock (&check_mutex);
 			}
 			else {
 				log_err ("collect: unknown type '%c'", line[0]);
 			}
-		} /* while (loop) */
+		} /* while (42) */
 
 		log_debug ("Shutting down connection on fd #%i",
 				fileno (this->socket));
 
 		fclose (connection->socket);
 		free (connection);
@@ -506,34 +508,48 @@
 		}
 
 		--available_collectors;
 
 		pthread_mutex_unlock (&available_mutex);
 
-		do {
+		while (42) {
 			errno = 0;
-			if (-1 == (remote = accept (connector_socket, NULL, NULL))) {
-				if (EINTR != errno) {
-					char errbuf[1024];
-					disabled = 1;
-					close (connector_socket);
-					connector_socket = -1;
-					log_err ("accept() failed: %s",
-							sstrerror (errno, errbuf, sizeof (errbuf)));
-					pthread_exit ((void *)1);
-				}
+
+			remote = accept (connector_socket, NULL, NULL);
+			if (remote == -1) {
+				char errbuf[1024];
+
+				if (errno == EINTR)
+					continue;
+
+				disabled = 1;
+				close (connector_socket);
+				connector_socket = -1;
+				log_err ("accept() failed: %s",
+						 sstrerror (errno, errbuf, sizeof (errbuf)));
+				pthread_exit ((void *)1);
 			}
-		} while (EINTR == errno);
 
-		connection = (conn_t *)smalloc (sizeof (conn_t));
+			/* access() succeeded. */
+			break;
+		}
+
+		connection = malloc (sizeof (*connection));
+		if (connection == NULL)
+		{
+			close (remote);
+			continue;
+		}
+		memset (connection, 0, sizeof (*connection));
 
 		connection->socket = fdopen (remote, "r");
 		connection->next   = NULL;
 
 		if (NULL == connection->socket) {
 			close (remote);
+			sfree (connection);
 			continue;
 		}
 
 		pthread_mutex_lock (&conns_mutex);
 
 		if (NULL == conns.head) {
@@ -567,16 +583,33 @@
 		return (-1);
 	}
 
 	return (0);
 } /* int email_init */
 
-static int email_shutdown (void)
+static void type_list_free (type_list_t *t)
 {
-	type_t *ptr = NULL;
+	type_t *this;
+
+	this = t->head;
+	while (this != NULL)
+	{
+		type_t *next = this->next;
+
+		sfree (this->name);
+		sfree (this);
+
+		this = next;
+	}
+
+	t->head = NULL;
+	t->tail = NULL;
+}
 
+static int email_shutdown (void)
+{
 	int i = 0;
 
 	if (connector != ((pthread_t) 0)) {
 		pthread_kill (connector, SIGTERM);
 		connector = (pthread_t) 0;
 	}
@@ -610,41 +643,18 @@
 		}
 		sfree (collectors);
 	} /* if (collectors != NULL) */
 
 	pthread_mutex_unlock (&conns_mutex);
 
-	for (ptr = list_count.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
-
-	for (ptr = list_count_copy.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
-
-	for (ptr = list_size.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
-
-	for (ptr = list_size_copy.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
-
-	for (ptr = list_check.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
-
-	for (ptr = list_check_copy.head; NULL != ptr; ptr = ptr->next) {
-		free (ptr->name);
-		free (ptr);
-	}
+	type_list_free (&list_count);
+	type_list_free (&list_count_copy);
+	type_list_free (&list_size);
+	type_list_free (&list_size_copy);
+	type_list_free (&list_check);
+	type_list_free (&list_check_copy);
 
 	unlink ((NULL == sock_file) ? SOCK_PATH : sock_file);
 
 	sfree (sock_file);
 	sfree (sock_group);
 	return (0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ethstat.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ethstat.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ethstat.c	2014-08-18 15:33:14.288460635 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ethstat.c	2016-07-26 15:47:12.957713794 +0800
@@ -309,15 +309,19 @@
         sstrerror (errno, errbuf, sizeof (errbuf)));
     return (-1);
   }
 
   for (i = 0; i < n_stats; i++)
   {
-    const char *stat_name;
+    char *stat_name;
 
     stat_name = (void *) &strings->data[i * ETH_GSTRING_LEN];
+    /* Remove leading spaces in key name */
+    while (isspace ((int) *stat_name))
+        stat_name++;
+
     DEBUG("ethstat plugin: device = \"%s\": %s = %"PRIu64,
         device, stat_name, (uint64_t) stats->data[i]);
     ethstat_submit_value (device,
         stat_name, (derive_t) stats->data[i]);
   }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/exec.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/exec.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/exec.c	2015-02-26 19:49:36.438060967 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/exec.c	2016-07-26 15:47:12.957713794 +0800
@@ -20,12 +20,13 @@
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  *   Sebastian Harl <sh at tokkee.org>
  *   Peter Holik <peter at holik.at>
  **/
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE /* For setgroups */
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
@@ -335,13 +336,13 @@
   {
     ERROR ("exec plugin: setuid (%i) failed: %s",
         uid, sstrerror (errno, errbuf, sizeof (errbuf)));
     exit (-1);
   }
 
-  status = execvp (pl->exec, pl->argv);
+  execvp (pl->exec, pl->argv);
 
   ERROR ("exec plugin: Failed to execute ``%s'': %s",
       pl->exec, sstrerror (errno, errbuf, sizeof (errbuf)));
   exit (-1);
 } /* void exec_child }}} */
 
@@ -351,23 +352,48 @@
 
   memset (&ss, 0, sizeof (ss));
   sigemptyset (&ss);
   sigprocmask (SIG_SETMASK, &ss, /* old mask = */ NULL);
 } /* }}} void reset_signal_mask */
 
+static int create_pipe (int fd_pipe[2]) /* {{{ */
+{
+  char errbuf[1024];
+  int status;
+
+  status = pipe (fd_pipe);
+  if (status != 0)
+  {
+    ERROR ("exec plugin: pipe failed: %s",
+        sstrerror (errno, errbuf, sizeof (errbuf)));
+    return (-1);
+  }
+
+  return 0;
+} /* }}} int create_pipe */
+
+static void close_pipe (int fd_pipe[2]) /* {{{ */
+{
+  if (fd_pipe[0] != -1)
+    close (fd_pipe[0]);
+
+  if (fd_pipe[1] != -1)
+    close (fd_pipe[1]);
+} /* }}} void close_pipe */
+
 /*
  * Creates three pipes (one for reading, one for writing and one for errors),
  * forks a child, sets up the pipes so that fd_in is connected to STDIN of
  * the child and fd_out is connected to STDOUT and fd_err is connected to STDERR
  * of the child. Then is calls `exec_child'.
  */
 static int fork_child (program_list_t *pl, int *fd_in, int *fd_out, int *fd_err) /* {{{ */
 {
-  int fd_pipe_in[2];
-  int fd_pipe_out[2];
-  int fd_pipe_err[2];
+  int fd_pipe_in[2] = {-1, -1};
+  int fd_pipe_out[2] = {-1, -1};
+  int fd_pipe_err[2] = {-1, -1};
   char errbuf[1024];
   int status;
   int pid;
 
   int uid;
   int gid;
@@ -377,56 +403,38 @@
   struct passwd sp;
   char nambuf[2048];
 
   if (pl->pid != 0)
     return (-1);
 
-  status = pipe (fd_pipe_in);
-  if (status != 0)
-  {
-    ERROR ("exec plugin: pipe failed: %s",
-        sstrerror (errno, errbuf, sizeof (errbuf)));
-    return (-1);
-  }
-
-  status = pipe (fd_pipe_out);
-  if (status != 0)
-  {
-    ERROR ("exec plugin: pipe failed: %s",
-        sstrerror (errno, errbuf, sizeof (errbuf)));
-    return (-1);
-  }
-
-  status = pipe (fd_pipe_err);
-  if (status != 0)
-  {
-    ERROR ("exec plugin: pipe failed: %s",
-        sstrerror (errno, errbuf, sizeof (errbuf)));
-    return (-1);
-  }
+  if ((create_pipe(fd_pipe_in) == -1)
+      || (create_pipe(fd_pipe_out) == -1)
+      || (create_pipe(fd_pipe_err) == -1))
+    goto failed;
 
   sp_ptr = NULL;
   status = getpwnam_r (pl->user, &sp, nambuf, sizeof (nambuf), &sp_ptr);
   if (status != 0)
   {
     ERROR ("exec plugin: Failed to get user information for user ``%s'': %s",
         pl->user, sstrerror (errno, errbuf, sizeof (errbuf)));
-    return (-1);
+    goto failed;
   }
+
   if (sp_ptr == NULL)
   {
     ERROR ("exec plugin: No such user: `%s'", pl->user);
-    return (-1);
+    goto failed;
   }
 
   uid = sp.pw_uid;
   gid = sp.pw_gid;
   if (uid == 0)
   {
     ERROR ("exec plugin: Cowardly refusing to exec program as root.");
-    return (-1);
+    goto failed;
   }
 
   /* The group configured in the configfile is set as effective group, because
    * this way the forked process can (re-)gain the user's primary group. */
   egid = -1;
   if (NULL != pl->group)
@@ -438,18 +446,18 @@
       status = getgrnam_r (pl->group, &gr, nambuf, sizeof (nambuf), &gr_ptr);
       if (0 != status)
       {
         ERROR ("exec plugin: Failed to get group information "
             "for group ``%s'': %s", pl->group,
             sstrerror (errno, errbuf, sizeof (errbuf)));
-        return (-1);
+        goto failed;
       }
       if (NULL == gr_ptr)
       {
         ERROR ("exec plugin: No such group: `%s'", pl->group);
-        return (-1);
+        goto failed;
       }
 
       egid = gr.gr_gid;
     }
     else
     {
@@ -459,13 +467,13 @@
 
   pid = fork ();
   if (pid < 0)
   {
     ERROR ("exec plugin: fork failed: %s",
         sstrerror (errno, errbuf, sizeof (errbuf)));
-    return (-1);
+    goto failed;
   }
   else if (pid == 0)
   {
     int fd_num;
     int fd;
 
@@ -527,12 +535,19 @@
   if (fd_err != NULL)
     *fd_err = fd_pipe_err[0];
   else
     close (fd_pipe_err[0]);
 
   return (pid);
+
+failed:
+  close_pipe(fd_pipe_in);
+  close_pipe(fd_pipe_out);
+  close_pipe(fd_pipe_err);
+
+  return (-1);
 } /* int fork_child }}} */
 
 static int parse_line (char *buffer) /* {{{ */
 {
   if (strncasecmp ("PUTVAL", buffer, strlen ("PUTVAL")) == 0)
     return (handle_putval (stdout, buffer));
@@ -726,14 +741,13 @@
   fh = fdopen (fd, "w");
   if (fh == NULL)
   {
     char errbuf[1024];
     ERROR ("exec plugin: fdopen (%i) failed: %s", fd,
         sstrerror (errno, errbuf, sizeof (errbuf)));
-    kill (pl->pid, SIGTERM);
-    pl->pid = 0;
+    kill (pid, SIGTERM);
     close (fd);
     sfree (arg);
     pthread_exit ((void *) 1);
   }
 
   severity = "FAILURE";
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/filecount.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/filecount.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/filecount.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/filecount.c	2016-07-26 15:47:12.957713794 +0800
@@ -353,12 +353,13 @@
   memset (dir, 0, sizeof (*dir));
 
   dir->path = strdup (ci->values[0].value.string);
   if (dir->path == NULL)
   {
     ERROR ("filecount plugin: strdup failed.");
+    sfree (dir);
     return (-1);
   }
 
   fc_config_set_instance (dir, dir->path);
 
   dir->options = FC_RECURSIVE;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/filter_chain.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/filter_chain.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/filter_chain.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/filter_chain.c	2016-07-26 15:47:12.957713794 +0800
@@ -384,13 +384,12 @@
         ci->values[0].value.string);
   }
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Match", option->key) == 0)
       status = fc_config_add_match (&rule->matches, option);
     else if (strcasecmp ("Target", option->key) == 0)
       status = fc_config_add_target (&rule->targets, option);
     else
@@ -468,13 +467,12 @@
   chain->targets = NULL;
   chain->next = NULL;
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Rule", option->key) == 0)
       status = fc_config_add_rule (chain, option);
     else if (strcasecmp ("Target", option->key) == 0)
       status = fc_config_add_target (&chain->targets, option);
     else
@@ -881,23 +879,23 @@
 
 int fc_process_chain (const data_set_t *ds, value_list_t *vl, /* {{{ */
     fc_chain_t *chain)
 {
   fc_rule_t *rule;
   fc_target_t *target;
-  int status;
+  int status = FC_TARGET_CONTINUE;
 
   if (chain == NULL)
     return (-1);
 
   DEBUG ("fc_process_chain (chain = %s);", chain->name);
 
-  status = FC_TARGET_CONTINUE;
   for (rule = chain->rules; rule != NULL; rule = rule->next)
   {
     fc_match_t *match;
+    status = FC_TARGET_CONTINUE;
 
     if (rule->name[0] != 0)
     {
       DEBUG ("fc_process_chain (%s): Testing the `%s' rule.",
           chain->name, rule->name);
     }
@@ -953,38 +951,27 @@
         WARNING ("fc_process_chain (%s): Unknown return value "
             "from target `%s': %i",
             chain->name, target->name, status);
       }
     }
 
-    if ((status == FC_TARGET_STOP)
-        || (status == FC_TARGET_RETURN))
+    if ((status == FC_TARGET_STOP) || (status == FC_TARGET_RETURN))
     {
       if (rule->name[0] != 0)
       {
         DEBUG ("fc_process_chain (%s): Rule `%s' signaled "
             "the %s condition.",
             chain->name, rule->name,
             (status == FC_TARGET_STOP) ? "stop" : "return");
       }
       break;
     }
-    else
-    {
-      status = FC_TARGET_CONTINUE;
-    }
   } /* for (rule) */
 
-  if (status == FC_TARGET_STOP)
-    return (FC_TARGET_STOP);
-  else if (status == FC_TARGET_RETURN)
-    return (FC_TARGET_CONTINUE);
-
-  /* for-loop has been aborted: A target returned `FC_TARGET_STOP' */
-  if (rule != NULL)
-    return (FC_TARGET_CONTINUE);
+  if ((status == FC_TARGET_STOP) || (status == FC_TARGET_RETURN))
+    return (status);
 
   DEBUG ("fc_process_chain (%s): Executing the default targets.",
       chain->name);
 
   status = FC_TARGET_CONTINUE;
   for (target = chain->targets; target != NULL; target = target->next)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/gmond.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/gmond.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/gmond.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/gmond.c	2016-07-26 15:47:12.961713803 +0800
@@ -1,9 +1,9 @@
 /**
  * collectd - src/gmond.c
- * Copyright (C) 2009,2010  Florian octo Forster
+ * Copyright (C) 2009-2015  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
  * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
@@ -214,19 +214,19 @@
 {
   struct addrinfo  ai_hints;
   struct addrinfo *ai_list;
   struct addrinfo *ai_ptr;
   int              ai_return;
 
-  socket_entry_t *sockets;
-  size_t          sockets_num;
+  socket_entry_t *sockets = NULL;
+  size_t          sockets_num = 0;
 
   int status;
-    
-  sockets     = *ret_sockets;
-  sockets_num = *ret_sockets_num;
+
+  if (*ret_sockets != NULL)
+    return (EINVAL);
 
   memset (&ai_hints, 0, sizeof (ai_hints));
   ai_hints.ai_flags    = 0;
 #ifdef AI_PASSIVE
   ai_hints.ai_flags |= AI_PASSIVE;
 #endif
@@ -283,14 +283,20 @@
       break;
     }
     else
     {
       int yes = 1;
 
-      setsockopt (sockets[sockets_num].fd, SOL_SOCKET, SO_REUSEADDR,
+      status = setsockopt (sockets[sockets_num].fd, SOL_SOCKET, SO_REUSEADDR,
           (void *) &yes, sizeof (yes));
+      if (status != 0)
+      {
+        char errbuf[1024];
+        WARNING ("gmond plugin: setsockopt(2) failed: %s",
+                 sstrerror (errno, errbuf, sizeof (errbuf)));
+      }
     }
 
     status = bind (sockets[sockets_num].fd, ai_ptr->ai_addr, ai_ptr->ai_addrlen);
     if (status != 0)
     {
       char errbuf[1024];
@@ -352,14 +358,17 @@
 
     sockets_num++;
   } /* }}} for (ai_ptr = ai_list; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next) */
 
   freeaddrinfo (ai_list);
 
-  if ((*ret_sockets_num) >= sockets_num)
+  if (sockets_num == 0)
+  {
+    sfree (sockets);
     return (-1);
+  }
 
   *ret_sockets = sockets;
   *ret_sockets_num = sockets_num;
   return (0);
 } /* }}} int create_sockets */
 
@@ -399,16 +408,25 @@
 
   DEBUG ("gmond plugin: Requesting meta data for %s/%s.",
       host, name);
 
   pthread_mutex_lock (&mc_send_sockets_lock);
   for (i = 0; i < mc_send_sockets_num; i++)
-    sendto (mc_send_sockets[i].fd, buffer, (size_t) buffer_size,
+  {
+    ssize_t status = sendto (mc_send_sockets[i].fd, buffer, (size_t) buffer_size,
         /* flags = */ 0,
         (struct sockaddr *) &mc_send_sockets[i].addr,
         mc_send_sockets[i].addrlen);
+    if (status == -1)
+    {
+      char errbuf[1024];
+      ERROR ("gmond plugin: sendto(2) failed: %s",
+             sstrerror (errno, errbuf, sizeof (errbuf)));
+      continue;
+    }
+  }
   pthread_mutex_unlock (&mc_send_sockets_lock);
 
   sfree (msg.Ganglia_metadata_msg_u.grequest.metric_id.host);
   sfree (msg.Ganglia_metadata_msg_u.grequest.metric_id.name);
   return (0);
 } /* }}} int request_meta_data */
@@ -468,42 +486,12 @@
     return (NULL);
   }
 
   return (se);
 } /* }}} staging_entry_t *staging_entry_get */
 
-static int staging_entry_submit (const char *host, const char *name, /* {{{ */
-    staging_entry_t *se)
-{
-  value_list_t vl;
-  value_t values[se->vl.values_len];
-
-  if (se->vl.interval == 0)
-  {
-    /* No meta data has been received for this metric yet. */
-    se->flags = 0;
-    pthread_mutex_unlock (&staging_lock);
-    request_meta_data (host, name);
-    return (0);
-  }
-
-  se->flags = 0;
-
-  memcpy (values, se->vl.values, sizeof (values));
-  memcpy (&vl, &se->vl, sizeof (vl));
-
-  /* Unlock before calling `plugin_dispatch_values'.. */
-  pthread_mutex_unlock (&staging_lock);
-
-  vl.values = values;
-
-  plugin_dispatch_values (&vl);
-
-  return (0);
-} /* }}} int staging_entry_submit */
-
 static int staging_entry_update (const char *host, const char *name, /* {{{ */
     const char *type, const char *type_instance,
     int ds_index, int ds_type, value_t value)
 {
   const data_set_t *ds;
   staging_entry_t *se;
@@ -547,23 +535,36 @@
     se->vl.values[ds_index].absolute = value.absolute;
   else
     assert (23 == 42);
 
   se->flags |= (0x01 << ds_index);
 
-  /* Check if all values have been set and submit if so. */
-  if (se->flags == ((0x01 << se->vl.values_len) - 1))
+  /* Check if all data sources have been set. If not, return here. */
+  if (se->flags != ((0x01 << se->vl.values_len) - 1))
   {
-    /* `staging_lock' is unlocked in `staging_entry_submit'. */
-    staging_entry_submit (host, name, se);
+    pthread_mutex_unlock (&staging_lock);
+    return (0);
   }
-  else
+
+  /* Check if the interval of this metric is known. If not, request meta data
+   * and return. */
+  if (se->vl.interval == 0)
   {
+    /* No meta data has been received for this metric yet. */
+    se->flags = 0;
     pthread_mutex_unlock (&staging_lock);
+
+    request_meta_data (host, name);
+    return (0);
   }
 
+  plugin_dispatch_values (&se->vl);
+
+  se->flags = 0;
+  pthread_mutex_unlock (&staging_lock);
+
   return (0);
 } /* }}} int staging_entry_update */
 
 static int mc_handle_value_msg (Ganglia_value_msg *msg) /* {{{ */
 {
   const char *host;
@@ -657,13 +658,13 @@
   {
     value_t val_copy;
 
     if ((map->ds_type == DS_TYPE_COUNTER)
         || (map->ds_type == DS_TYPE_ABSOLUTE))
       val_copy = value_counter;
-    if (map->ds_type == DS_TYPE_GAUGE)
+    else if (map->ds_type == DS_TYPE_GAUGE)
       val_copy = value_gauge;
     else if (map->ds_type == DS_TYPE_DERIVE)
       val_copy = value_derive;
     else
       assert (23 == 42);
 
@@ -864,12 +865,13 @@
     {
       if (mc_receive_sockets[i].revents != 0)
         mc_handle_socket (mc_receive_sockets + i);
     }
   } /* while (mc_receive_thread_loop != 0) */
 
+  free (mc_receive_socket_entries);
   return ((void *) 0);
 } /* }}} void *mc_receive_thread */
 
 static int mc_receive_thread_start (void) /* {{{ */
 {
   int status;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/iptables.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/iptables.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/iptables.c	2014-08-18 15:33:14.288460635 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/iptables.c	2016-07-26 15:47:12.961713803 +0800
@@ -108,136 +108,133 @@
 	protocol_version_t ip_version = 0;
 
 	if (strcasecmp (key, "Chain") == 0)
 		ip_version = IPV4;
 	else if (strcasecmp (key, "Chain6") == 0)
 		ip_version = IPV6;
+	else
+		return (1);
 
-	if (( ip_version == IPV4 ) || ( ip_version == IPV6 ))
-	{
-		ip_chain_t temp, *final, **list;
-		char *table;
-		int   table_len;
-		char *chain;
-		int   chain_len;
-
-		char *value_copy;
-		char *fields[4];
-		int   fields_num;
-		
-		memset (&temp, 0, sizeof (temp));
+	ip_chain_t temp, *final, **list;
+	char *table;
+	int   table_len;
+	char *chain;
+	int   chain_len;
+
+	char *value_copy;
+	char *fields[4];
+	int   fields_num;
 
-		value_copy = strdup (value);
-		if (value_copy == NULL)
-		{
-		    char errbuf[1024];
-		    ERROR ("strdup failed: %s",
-			    sstrerror (errno, errbuf, sizeof (errbuf)));
-		    return (1);
-		}
+	memset (&temp, 0, sizeof (temp));
 
-		/*
-	         *  Time to fill the temp element
-        	 *  Examine value string, it should look like:
-	         *  Chain[6] <table> <chain> [<comment|num> [name]]
-       		 */
-
-		/* set IPv4 or IPv6 */
-                temp.ip_version = ip_version;
-
-		/* Chain <table> <chain> [<comment|num> [name]] */
-		fields_num = strsplit (value_copy, fields, 4);
-		if (fields_num < 2)
-		{
-		    free (value_copy);
-		    return (1);
-		}
-
-		table = fields[0];
-		chain = fields[1];
-
-		table_len = strlen (table) + 1;
-		if ((unsigned int)table_len > sizeof(temp.table))
-		{
-			ERROR ("Table `%s' too long.", table);
-			free (value_copy);
-			return (1);
-		}
-		sstrncpy (temp.table, table, table_len);
+	value_copy = strdup (value);
+	if (value_copy == NULL)
+	{
+	    char errbuf[1024];
+	    ERROR ("strdup failed: %s",
+		    sstrerror (errno, errbuf, sizeof (errbuf)));
+	    return (1);
+	}
 
-		chain_len = strlen (chain) + 1;
-		if ((unsigned int)chain_len > sizeof(temp.chain))
-		{
-			ERROR ("Chain `%s' too long.", chain);
-			free (value_copy);
-			return (1);
-		}
-		sstrncpy (temp.chain, chain, chain_len);
+	/*
+	 *  Time to fill the temp element
+	 *  Examine value string, it should look like:
+	 *  Chain[6] <table> <chain> [<comment|num> [name]]
+	 */
+
+	/* set IPv4 or IPv6 */
+	temp.ip_version = ip_version;
+
+	/* Chain <table> <chain> [<comment|num> [name]] */
+	fields_num = strsplit (value_copy, fields, 4);
+	if (fields_num < 2)
+	{
+	    free (value_copy);
+	    return (1);
+	}
 
-		if (fields_num >= 3)
-		{
-		    char *comment = fields[2];
-		    int   rule = atoi (comment);
+	table = fields[0];
+	chain = fields[1];
 
-		    if (rule)
-		    {
-			temp.rule.num = rule;
-			temp.rule_type = RTYPE_NUM;
-		    }
-		    else
-		    {
-			temp.rule.comment = strdup (comment);
-			if (temp.rule.comment == NULL)
-			{
-			    free (value_copy);
-			    return (1);
-			}
-			temp.rule_type = RTYPE_COMMENT;
-		    }
-		}
-		else
-		{
-		    temp.rule_type = RTYPE_COMMENT_ALL;
-		}
-
-		if (fields_num >= 4)
-		    sstrncpy (temp.name, fields[3], sizeof (temp.name));
+	table_len = strlen (table) + 1;
+	if ((unsigned int)table_len > sizeof(temp.table))
+	{
+		ERROR ("Table `%s' too long.", table);
+		free (value_copy);
+		return (1);
+	}
+	sstrncpy (temp.table, table, table_len);
 
+	chain_len = strlen (chain) + 1;
+	if ((unsigned int)chain_len > sizeof(temp.chain))
+	{
+		ERROR ("Chain `%s' too long.", chain);
 		free (value_copy);
-		value_copy = NULL;
-		table = NULL;
-		chain = NULL;
+		return (1);
+	}
+	sstrncpy (temp.chain, chain, chain_len);
 
-		list = (ip_chain_t **) realloc (chain_list, (chain_num + 1) * sizeof (ip_chain_t *));
-		if (list == NULL)
-		{
-		    char errbuf[1024];
-		    ERROR ("realloc failed: %s",
-			    sstrerror (errno, errbuf, sizeof (errbuf)));
-		    return (1);
-		}
+	if (fields_num >= 3)
+	{
+	    char *comment = fields[2];
+	    int   rule = atoi (comment);
 
-		chain_list = list;
-		final = (ip_chain_t *) malloc( sizeof(temp) );
-		if (final == NULL) 
+	    if (rule)
+	    {
+		temp.rule.num = rule;
+		temp.rule_type = RTYPE_NUM;
+	    }
+	    else
+	    {
+		temp.rule.comment = strdup (comment);
+		if (temp.rule.comment == NULL)
 		{
-		    char errbuf[1024];
-		    ERROR ("malloc failed: %s",
-			    sstrerror (errno, errbuf, sizeof (errbuf)));
+		    free (value_copy);
 		    return (1);
 		}
-		memcpy (final, &temp, sizeof (temp));
-		chain_list[chain_num] = final;
-		chain_num++;
+		temp.rule_type = RTYPE_COMMENT;
+	    }
+	}
+	else
+	{
+	    temp.rule_type = RTYPE_COMMENT_ALL;
+	}
 
-		DEBUG ("Chain #%i: table = %s; chain = %s;", chain_num, final->table, final->chain);
+	if (fields_num >= 4)
+	    sstrncpy (temp.name, fields[3], sizeof (temp.name));
+
+	free (value_copy);
+	value_copy = NULL;
+	table = NULL;
+	chain = NULL;
+
+	list = (ip_chain_t **) realloc (chain_list, (chain_num + 1) * sizeof (ip_chain_t *));
+	if (list == NULL)
+	{
+	    char errbuf[1024];
+	    ERROR ("realloc failed: %s",
+		    sstrerror (errno, errbuf, sizeof (errbuf)));
+	    sfree (temp.rule.comment);
+	    return (1);
 	}
-	else 
+
+	chain_list = list;
+	final = (ip_chain_t *) malloc( sizeof(temp) );
+	if (final == NULL)
 	{
-		return (-1);
+	    char errbuf[1024];
+	    ERROR ("malloc failed: %s",
+		    sstrerror (errno, errbuf, sizeof (errbuf)));
+	    sfree (temp.rule.comment);
+	    return (1);
 	}
+	memcpy (final, &temp, sizeof (temp));
+	chain_list[chain_num] = final;
+	chain_num++;
+
+	DEBUG ("Chain #%i: table = %s; chain = %s;", chain_num, final->table, final->chain);
 
 	return (0);
 } /* int iptables_config */
 
 static int submit6_match (const struct ip6t_entry_match *match,
                 const struct ip6t_entry *entry,
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ipvs.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ipvs.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ipvs.c	2014-08-18 15:33:14.288460635 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ipvs.c	2016-07-26 15:47:12.961713803 +0800
@@ -292,13 +292,16 @@
 
 	char pi[DATA_MAX_NAME_LEN];
 
 	int i = 0;
 
 	if (0 != get_pi (se, pi, sizeof (pi)))
+	{
+		free (dests);
 		return;
+	}
 
 	cipvs_submit_connections (pi, NULL, stats.conns);
 	cipvs_submit_if (pi, "if_packets", NULL, stats.inpkts, stats.outpkts);
 	cipvs_submit_if (pi, "if_octets", NULL, stats.inbytes, stats.outbytes);
 
 	for (i = 0; i < dests->num_dests; ++i)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/irq.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/irq.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/irq.c	2014-09-05 16:57:01.456282539 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/irq.c	2016-07-19 16:42:46.635749808 +0800
@@ -117,12 +117,13 @@
 	if(fgets (buffer, sizeof (buffer), fh) != NULL) {
 		cpu_count = strsplit (buffer, fields,
 				STATIC_ARRAY_SIZE (fields));
 	} else {
 		ERROR ("irq plugin: unable to get CPU count from first line "
 				"of /proc/interrupts");
+		fclose (fh);
 		return (-1);
 	}
 
 	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
 		char *irq_name;
@@ -152,12 +153,16 @@
 
 		/* Check if irq name ends with colon.
 		 * Otherwise it's a header. */
 		if (irq_name[irq_name_len - 1] != ':')
 			continue;
 
+		/* Is it the the ARM fast interrupt (FIQ)? */
+		if (irq_name_len == 4 && (strncmp(irq_name, "FIQ:", 4) == 0))
+			continue;
+
 		irq_name[irq_name_len - 1] = 0;
 		irq_name_len--;
 
 		irq_value = 0;
 		for (i = 1; i <= irq_values_to_parse; i++)
 		{
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/java.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/java.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/java.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/java.c	2016-07-26 15:47:12.961713803 +0800
@@ -1787,41 +1787,47 @@
   cbi->name = strdup (c_name);
   if (cbi->name == NULL)
   {
     pthread_mutex_unlock (&java_callbacks_lock);
     ERROR ("java plugin: cjni_callback_info_create: strdup failed.");
     (*jvm_env)->ReleaseStringUTFChars (jvm_env, o_name, c_name);
+    sfree (cbi);
     return (NULL);
   }
 
   (*jvm_env)->ReleaseStringUTFChars (jvm_env, o_name, c_name);
 
   cbi->object = (*jvm_env)->NewGlobalRef (jvm_env, o_callback);
   if (cbi->object == NULL)
   {
     ERROR ("java plugin: cjni_callback_info_create: NewGlobalRef failed.");
-    free (cbi);
+    sfree (cbi->name);
+    sfree (cbi);
     return (NULL);
   }
 
   cbi->class  = (*jvm_env)->GetObjectClass (jvm_env, cbi->object);
   if (cbi->class == NULL)
   {
     ERROR ("java plugin: cjni_callback_info_create: GetObjectClass failed.");
-    free (cbi);
+    (*jvm_env)->DeleteGlobalRef (jvm_env, cbi->object);
+    sfree (cbi->name);
+    sfree (cbi);
     return (NULL);
   }
 
   cbi->method = (*jvm_env)->GetMethodID (jvm_env, cbi->class,
       method_name, method_signature);
   if (cbi->method == NULL)
   {
     ERROR ("java plugin: cjni_callback_info_create: "
         "Cannot find the `%s' method with signature `%s'.",
         method_name, method_signature);
-    free (cbi);
+    (*jvm_env)->DeleteGlobalRef (jvm_env, cbi->object);
+    sfree (cbi->name);
+    sfree (cbi);
     return (NULL);
   }
 
   return (cbi);
 } /* }}} cjni_callback_info_t cjni_callback_info_create */
 
@@ -3048,16 +3054,14 @@
         "the java plugin was found.");
     return (-1);
   }
 
   if (config_block != NULL)
   {
-
     cjni_config_perform (config_block);
     oconfig_free (config_block);
-    config_block = NULL;
   }
 
   if (jvm == NULL)
   {
     ERROR ("java plugin: cjni_init: jvm == NULL");
     return (-1);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/client.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/client.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/client.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/client.c	2016-07-26 15:47:12.961713803 +0800
@@ -497,44 +497,43 @@
   for (ai_ptr = ai_res; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next)
   {
     fd = socket (ai_ptr->ai_family, ai_ptr->ai_socktype, ai_ptr->ai_protocol);
     if (fd < 0)
     {
       status = errno;
-      fd = -1;
       continue;
     }
 
     status = connect (fd, ai_ptr->ai_addr, ai_ptr->ai_addrlen);
     if (status != 0)
     {
       status = errno;
       close (fd);
-      fd = -1;
       continue;
     }
 
     c->fh = fdopen (fd, "r+");
     if (c->fh == NULL)
     {
       status = errno;
       close (fd);
-      fd = -1;
       continue;
     }
 
     assert (status == 0);
     break;
   } /* for (ai_ptr) */
 
   if (status != 0)
   {
     lcc_set_errno (c, status);
+    freeaddrinfo (ai_res);
     return (-1);
   }
 
+  freeaddrinfo (ai_res);
   return (0);
 } /* }}} int lcc_open_netsocket */
 
 static int lcc_open_socket (lcc_connection_t *c, const char *addr) /* {{{ */
 {
   int status = 0;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/collectd/lcc_features.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/collectd/lcc_features.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/collectd/lcc_features.h	2015-02-26 22:08:40.502332554 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/collectd/lcc_features.h	2016-07-26 15:47:50.817806296 +0800
@@ -36,17 +36,17 @@
 #endif
 
 #define LCC_API_VERSION 0
 
 #define LCC_VERSION_MAJOR 5
 #define LCC_VERSION_MINOR 4
-#define LCC_VERSION_PATCH 2
+#define LCC_VERSION_PATCH 3
 
 #define LCC_VERSION_EXTRA ""
 
-#define LCC_VERSION_STRING "5.4.2"
+#define LCC_VERSION_STRING "5.4.3"
 
 #define LCC_VERSION_ENCODE(major, minor, patch) \
 	((major) * 10000 + (minor) * 100 + (patch))
 
 #define LCC_VERSION \
 	LCC_VERSION_ENCODE(LCC_VERSION_MAJOR, LCC_VERSION_MINOR, LCC_VERSION_PATCH)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/Makefile.in	2015-02-26 22:07:48.109244656 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/Makefile.in	2016-07-26 15:47:21.817735475 +0800
@@ -247,12 +247,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -392,12 +393,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/network_buffer.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/network_buffer.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/network_buffer.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/network_buffer.c	2016-07-26 15:47:12.961713803 +0800
@@ -131,19 +131,22 @@
   if (!need_init)
     return (result);
   need_init = 0;
 
 #if HAVE_LIBGCRYPT
 # if GCRYPT_VERSION_NUMBER < 0x010600
-  gcry_control (GCRYCTL_SET_THREAD_CBS, &gcry_threads_pthread);
+  if (gcry_control (GCRYCTL_SET_THREAD_CBS, &gcry_threads_pthread))
+    return (0);
 # endif
 
   if (!gcry_check_version (GCRYPT_VERSION))
     return (0);
 
-  gcry_control (GCRYCTL_INIT_SECMEM, 32768, 0);
+  if (!gcry_control (GCRYCTL_INIT_SECMEM, 32768, 0))
+    return (0);
+
   gcry_control (GCRYCTL_INITIALIZATION_FINISHED, 0);
 
   result = 1;
   return (1);
 #else
   return(0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/network.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/network.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libcollectdclient/network.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libcollectdclient/network.c	2016-07-26 15:47:12.961713803 +0800
@@ -80,12 +80,13 @@
     return (EINVAL);
 
   if (srv->fd < 0)
     return (0);
 
   close (srv->fd);
+  srv->fd = -1;
   free (srv->sa);
   srv->sa = NULL;
   srv->sa_len = 0;
 
   return (0);
 } /* }}} int server_close_socket */
@@ -98,18 +99,12 @@
     return;
 
   server_close_socket (srv);
 
   next = srv->next;
 
-  if (srv->fd >= 0)
-  {
-    close (srv->fd);
-    srv->fd = -1;
-  }
-
   free (srv->node);
   free (srv->service);
   free (srv->username);
   free (srv->password);
   free (srv);
 
@@ -154,30 +148,35 @@
 
       if (IN_MULTICAST (ntohl (addr->sin_addr.s_addr)))
         optname = IP_MULTICAST_TTL;
       else
         optname = IP_TTL;
 
-      setsockopt (srv->fd, IPPROTO_IP, optname,
-          &srv->ttl,
-          sizeof (srv->ttl));
+      status = setsockopt (srv->fd, IPPROTO_IP, optname,
+          &srv->ttl, sizeof (srv->ttl));
     }
     else if (ai_ptr->ai_family == AF_INET6)
     {
       /* Useful example: http://gsyc.escet.urjc.es/~eva/IPv6-web/examples/mcast.html */
       struct sockaddr_in6 *addr = (struct sockaddr_in6 *) ai_ptr->ai_addr;
       int optname;
 
       if (IN6_IS_ADDR_MULTICAST (&addr->sin6_addr))
         optname = IPV6_MULTICAST_HOPS;
       else
         optname = IPV6_UNICAST_HOPS;
 
-      setsockopt (srv->fd, IPPROTO_IPV6, optname,
-          &srv->ttl,
-          sizeof (srv->ttl));
+      status = setsockopt (srv->fd, IPPROTO_IPV6, optname,
+          &srv->ttl, sizeof (srv->ttl));
+    }
+    if (status != 0)
+    {
+      /* setsockopt failed. */
+      close (srv->fd);
+      srv->fd = -1;
+      continue;
     }
 
     srv->sa = malloc (ai_ptr->ai_addrlen);
     if (srv->sa == NULL)
     {
       close (srv->fd);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/Makefile.am	2012-09-13 19:10:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/Makefile.am	2016-07-26 15:47:12.961713803 +0800
@@ -3,8 +3,8 @@
 BUILT_SOURCES = parser.h
 #CLEANFILES = parser.[ch] scanner.c
 AM_YFLAGS = -d
 
 noinst_LTLIBRARIES = liboconfig.la
 
-liboconfig_la_LDFLAGS = -version-info 0:0:0 $(LEXLIB)
+liboconfig_la_LDFLAGS = -avoid-version $(LEXLIB)
 liboconfig_la_SOURCES = oconfig.c oconfig.h aux_types.h scanner.l parser.y
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/Makefile.in	2015-02-26 22:07:48.205246649 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/Makefile.in	2016-07-26 15:47:21.881735631 +0800
@@ -224,12 +224,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -369,12 +370,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
@@ -439,13 +442,13 @@
 top_srcdir = @top_srcdir@
 AUTOMAKE_OPTIONS = foreign no-dependencies
 BUILT_SOURCES = parser.h
 #CLEANFILES = parser.[ch] scanner.c
 AM_YFLAGS = -d
 noinst_LTLIBRARIES = liboconfig.la
-liboconfig_la_LDFLAGS = -version-info 0:0:0 $(LEXLIB)
+liboconfig_la_LDFLAGS = -avoid-version $(LEXLIB)
 liboconfig_la_SOURCES = oconfig.c oconfig.h aux_types.h scanner.l parser.y
 all: $(BUILT_SOURCES)
 	$(MAKE) $(AM_MAKEFLAGS) all-am
 
 .SUFFIXES:
 .SUFFIXES: .c .l .lo .o .obj .y
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/oconfig.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/oconfig.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/oconfig.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/oconfig.c	2016-07-26 15:47:12.961713803 +0800
@@ -22,12 +22,13 @@
 #include <assert.h>
 #include <errno.h>
 
 #include "oconfig.h"
 
 extern FILE *yyin;
+extern int yyparse (void);
 
 oconfig_item_t *ci_root;
 const char     *c_file;
 
 static void yyset_in  (FILE *fd)
 {
@@ -41,14 +42,12 @@
 
   char file[10];
 
   yyset_in (fh);
 
   if (NULL == c_file) {
-    int status;
-
     status = snprintf (file, sizeof (file), "<fd#%d>", fileno (fh));
 
     if ((status < 0) || (status >= sizeof (file))) {
       c_file = "<unknown>";
     }
     else {
@@ -184,13 +183,13 @@
     } /* for (i = 0; i < ci_copy->children_num; i++) */
   } /* }}} if (ci_orig->children_num > 0) */
 
   return (ci_copy);
 } /* oconfig_item_t *oconfig_clone */
 
-void oconfig_free (oconfig_item_t *ci)
+static void oconfig_free_all (oconfig_item_t *ci)
 {
   int i;
 
   if (ci == NULL)
     return;
 
@@ -203,15 +202,22 @@
       free (ci->values[i].value.string);
 
   if (ci->values != NULL)
     free (ci->values);
 
   for (i = 0; i < ci->children_num; i++)
-    oconfig_free (ci->children + i);
+    oconfig_free_all (ci->children + i);
 
   if (ci->children != NULL)
     free (ci->children);
 }
 
+void oconfig_free (oconfig_item_t *ci)
+{
+  oconfig_free_all (ci);
+  free (ci);
+  ci = NULL;
+}
+
 /*
  * vim:shiftwidth=2:tabstop=8:softtabstop=2:fdm=marker
  */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.c	2015-02-26 18:47:29.532572382 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.c	2016-07-26 15:48:09.017850632 +0800
@@ -72,17 +72,18 @@
 static char *unquote (const char *orig);
 static int yyerror (const char *s);
 
 /* Lexer variables */
 extern int yylineno;
 extern char *yytext;
+extern int yylex (void);
 
 extern oconfig_item_t *ci_root;
 extern char           *c_file;
 
-#line 83 "parser.c" /* yacc.c:339  */
+#line 84 "parser.c" /* yacc.c:339  */
 
 # ifndef YY_NULLPTR
 #  if defined __cplusplus && 201103L <= __cplusplus
 #   define YY_NULLPTR nullptr
 #  else
 #   define YY_NULLPTR 0
@@ -138,23 +139,23 @@
 
 /* Value type.  */
 #if ! defined YYSTYPE && ! defined YYSTYPE_IS_DECLARED
 typedef union YYSTYPE YYSTYPE;
 union YYSTYPE
 {
-#line 38 "parser.y" /* yacc.c:355  */
+#line 39 "parser.y" /* yacc.c:355  */
 
 	double  number;
 	int     boolean;
 	char   *string;
 	oconfig_value_t  cv;
 	oconfig_item_t   ci;
 	argument_list_t  al;
 	statement_list_t sl;
 
-#line 155 "parser.c" /* yacc.c:355  */
+#line 156 "parser.c" /* yacc.c:355  */
 };
 # define YYSTYPE_IS_TRIVIAL 1
 # define YYSTYPE_IS_DECLARED 1
 #endif
 
 
@@ -163,13 +164,13 @@
 int yyparse (void);
 
 #endif /* !YY_YY_Y_TAB_H_INCLUDED  */
 
 /* Copy the second part of user declarations.  */
 
-#line 170 "parser.c" /* yacc.c:358  */
+#line 171 "parser.c" /* yacc.c:358  */
 
 #ifdef short
 # undef short
 #endif
 
 #ifdef YYTYPE_UINT8
@@ -461,15 +462,15 @@
 };
 
 #if YYDEBUG
   /* YYRLINE[YYN] -- Source line where rule number YYN was defined.  */
 static const yytype_uint8 yyrline[] =
 {
-       0,    73,    73,    74,    78,    79,    80,    81,    85,    92,
-     101,   105,   115,   121,   131,   138,   151,   167,   168,   169,
-     173,   183,   200,   208
+       0,    74,    74,    75,    79,    80,    81,    82,    86,    93,
+     102,   106,   116,   122,   132,   139,   152,   168,   169,   170,
+     174,   184,   201,   209
 };
 #endif
 
 #if YYDEBUG || YYERROR_VERBOSE || 1
 /* YYTNAME[SYMBOL-NUM] -- String name of the symbol SYMBOL-NUM.
    First, the terminals, then, starting at YYNTOKENS, nonterminals.  */
@@ -1256,181 +1257,181 @@
 
 
   YY_REDUCE_PRINT (yyn);
   switch (yyn)
     {
         case 2:
-#line 73 "parser.y" /* yacc.c:1646  */
+#line 74 "parser.y" /* yacc.c:1646  */
     {(yyval.string) = unquote ((yyvsp[0].string));}
-#line 1265 "parser.c" /* yacc.c:1646  */
+#line 1266 "parser.c" /* yacc.c:1646  */
     break;
 
   case 3:
-#line 74 "parser.y" /* yacc.c:1646  */
+#line 75 "parser.y" /* yacc.c:1646  */
     {(yyval.string) = strdup ((yyvsp[0].string));}
-#line 1271 "parser.c" /* yacc.c:1646  */
+#line 1272 "parser.c" /* yacc.c:1646  */
     break;
 
   case 4:
-#line 78 "parser.y" /* yacc.c:1646  */
+#line 79 "parser.y" /* yacc.c:1646  */
     {(yyval.cv).value.number = (yyvsp[0].number); (yyval.cv).type = OCONFIG_TYPE_NUMBER;}
-#line 1277 "parser.c" /* yacc.c:1646  */
+#line 1278 "parser.c" /* yacc.c:1646  */
     break;
 
   case 5:
-#line 79 "parser.y" /* yacc.c:1646  */
+#line 80 "parser.y" /* yacc.c:1646  */
     {(yyval.cv).value.boolean = 1; (yyval.cv).type = OCONFIG_TYPE_BOOLEAN;}
-#line 1283 "parser.c" /* yacc.c:1646  */
+#line 1284 "parser.c" /* yacc.c:1646  */
     break;
 
   case 6:
-#line 80 "parser.y" /* yacc.c:1646  */
+#line 81 "parser.y" /* yacc.c:1646  */
     {(yyval.cv).value.boolean = 0; (yyval.cv).type = OCONFIG_TYPE_BOOLEAN;}
-#line 1289 "parser.c" /* yacc.c:1646  */
+#line 1290 "parser.c" /* yacc.c:1646  */
     break;
 
   case 7:
-#line 81 "parser.y" /* yacc.c:1646  */
+#line 82 "parser.y" /* yacc.c:1646  */
     {(yyval.cv).value.string = (yyvsp[0].string); (yyval.cv).type = OCONFIG_TYPE_STRING;}
-#line 1295 "parser.c" /* yacc.c:1646  */
+#line 1296 "parser.c" /* yacc.c:1646  */
     break;
 
   case 8:
-#line 86 "parser.y" /* yacc.c:1646  */
+#line 87 "parser.y" /* yacc.c:1646  */
     {
 	 (yyval.al) = (yyvsp[-1].al);
 	 (yyval.al).argument_num++;
 	 (yyval.al).argument = realloc ((yyval.al).argument, (yyval.al).argument_num * sizeof (oconfig_value_t));
 	 (yyval.al).argument[(yyval.al).argument_num-1] = (yyvsp[0].cv);
 	}
-#line 1306 "parser.c" /* yacc.c:1646  */
+#line 1307 "parser.c" /* yacc.c:1646  */
     break;
 
   case 9:
-#line 93 "parser.y" /* yacc.c:1646  */
+#line 94 "parser.y" /* yacc.c:1646  */
     {
 	 (yyval.al).argument = malloc (sizeof (oconfig_value_t));
 	 (yyval.al).argument[0] = (yyvsp[0].cv);
 	 (yyval.al).argument_num = 1;
 	}
-#line 1316 "parser.c" /* yacc.c:1646  */
+#line 1317 "parser.c" /* yacc.c:1646  */
     break;
 
   case 10:
-#line 101 "parser.y" /* yacc.c:1646  */
+#line 102 "parser.y" /* yacc.c:1646  */
     {(yyval.string) = strdup ((yyvsp[0].string));}
-#line 1322 "parser.c" /* yacc.c:1646  */
+#line 1323 "parser.c" /* yacc.c:1646  */
     break;
 
   case 11:
-#line 106 "parser.y" /* yacc.c:1646  */
+#line 107 "parser.y" /* yacc.c:1646  */
     {
 	 memset (&(yyval.ci), '\0', sizeof ((yyval.ci)));
 	 (yyval.ci).key = (yyvsp[-2].string);
 	 (yyval.ci).values = (yyvsp[-1].al).argument;
 	 (yyval.ci).values_num = (yyvsp[-1].al).argument_num;
 	}
-#line 1333 "parser.c" /* yacc.c:1646  */
+#line 1334 "parser.c" /* yacc.c:1646  */
     break;
 
   case 12:
-#line 116 "parser.y" /* yacc.c:1646  */
+#line 117 "parser.y" /* yacc.c:1646  */
     {
 	 memset (&(yyval.ci), '\0', sizeof ((yyval.ci)));
 	 (yyval.ci).key = (yyvsp[-2].string);
 	}
-#line 1342 "parser.c" /* yacc.c:1646  */
+#line 1343 "parser.c" /* yacc.c:1646  */
     break;
 
   case 13:
-#line 122 "parser.y" /* yacc.c:1646  */
+#line 123 "parser.y" /* yacc.c:1646  */
     {
 	 memset (&(yyval.ci), '\0', sizeof ((yyval.ci)));
 	 (yyval.ci).key = (yyvsp[-3].string);
 	 (yyval.ci).values = (yyvsp[-2].al).argument;
 	 (yyval.ci).values_num = (yyvsp[-2].al).argument_num;
 	}
-#line 1353 "parser.c" /* yacc.c:1646  */
+#line 1354 "parser.c" /* yacc.c:1646  */
     break;
 
   case 14:
-#line 132 "parser.y" /* yacc.c:1646  */
+#line 133 "parser.y" /* yacc.c:1646  */
     {
 	 (yyval.string) = (yyvsp[-2].string);
 	}
-#line 1361 "parser.c" /* yacc.c:1646  */
+#line 1362 "parser.c" /* yacc.c:1646  */
     break;
 
   case 15:
-#line 139 "parser.y" /* yacc.c:1646  */
+#line 140 "parser.y" /* yacc.c:1646  */
     {
 	 if (strcmp ((yyvsp[-2].ci).key, (yyvsp[0].string)) != 0)
 	 {
 		printf ("block_begin = %s; block_end = %s;\n", (yyvsp[-2].ci).key, (yyvsp[0].string));
 	 	yyerror ("Block not closed..\n");
 		exit (1);
 	 }
 	 free ((yyvsp[0].string)); (yyvsp[0].string) = NULL;
 	 (yyval.ci) = (yyvsp[-2].ci);
 	 (yyval.ci).children = (yyvsp[-1].sl).statement;
 	 (yyval.ci).children_num = (yyvsp[-1].sl).statement_num;
 	}
-#line 1378 "parser.c" /* yacc.c:1646  */
+#line 1379 "parser.c" /* yacc.c:1646  */
     break;
 
   case 16:
-#line 152 "parser.y" /* yacc.c:1646  */
+#line 153 "parser.y" /* yacc.c:1646  */
     {
 	 if (strcmp ((yyvsp[-1].ci).key, (yyvsp[0].string)) != 0)
 	 {
 		printf ("block_begin = %s; block_end = %s;\n", (yyvsp[-1].ci).key, (yyvsp[0].string));
 		yyerror ("Block not closed..\n");
 		exit (1);
 	 }
 	 free ((yyvsp[0].string)); (yyvsp[0].string) = NULL;
 	 (yyval.ci) = (yyvsp[-1].ci);
 	 (yyval.ci).children = NULL;
 	 (yyval.ci).children_num = 0;
 	}
-#line 1395 "parser.c" /* yacc.c:1646  */
+#line 1396 "parser.c" /* yacc.c:1646  */
     break;
 
   case 17:
-#line 167 "parser.y" /* yacc.c:1646  */
+#line 168 "parser.y" /* yacc.c:1646  */
     {(yyval.ci) = (yyvsp[0].ci);}
-#line 1401 "parser.c" /* yacc.c:1646  */
+#line 1402 "parser.c" /* yacc.c:1646  */
     break;
 
   case 18:
-#line 168 "parser.y" /* yacc.c:1646  */
+#line 169 "parser.y" /* yacc.c:1646  */
     {(yyval.ci) = (yyvsp[0].ci);}
-#line 1407 "parser.c" /* yacc.c:1646  */
+#line 1408 "parser.c" /* yacc.c:1646  */
     break;
 
   case 19:
-#line 169 "parser.y" /* yacc.c:1646  */
+#line 170 "parser.y" /* yacc.c:1646  */
     {(yyval.ci).values_num = 0;}
-#line 1413 "parser.c" /* yacc.c:1646  */
+#line 1414 "parser.c" /* yacc.c:1646  */
     break;
 
   case 20:
-#line 174 "parser.y" /* yacc.c:1646  */
+#line 175 "parser.y" /* yacc.c:1646  */
     {
 	 (yyval.sl) = (yyvsp[-1].sl);
 	 if (((yyvsp[0].ci).values_num > 0) || ((yyvsp[0].ci).children_num > 0))
 	 {
 		 (yyval.sl).statement_num++;
 		 (yyval.sl).statement = realloc ((yyval.sl).statement, (yyval.sl).statement_num * sizeof (oconfig_item_t));
 		 (yyval.sl).statement[(yyval.sl).statement_num-1] = (yyvsp[0].ci);
 	 }
 	}
-#line 1427 "parser.c" /* yacc.c:1646  */
+#line 1428 "parser.c" /* yacc.c:1646  */
     break;
 
   case 21:
-#line 184 "parser.y" /* yacc.c:1646  */
+#line 185 "parser.y" /* yacc.c:1646  */
     {
 	 if (((yyvsp[0].ci).values_num > 0) || ((yyvsp[0].ci).children_num > 0))
 	 {
 		 (yyval.sl).statement = malloc (sizeof (oconfig_item_t));
 		 (yyval.sl).statement[0] = (yyvsp[0].ci);
 		 (yyval.sl).statement_num = 1;
@@ -1438,39 +1439,39 @@
 	 else
 	 {
 	 	(yyval.sl).statement = NULL;
 		(yyval.sl).statement_num = 0;
 	 }
 	}
-#line 1445 "parser.c" /* yacc.c:1646  */
+#line 1446 "parser.c" /* yacc.c:1646  */
     break;
 
   case 22:
-#line 201 "parser.y" /* yacc.c:1646  */
+#line 202 "parser.y" /* yacc.c:1646  */
     {
 	 ci_root = malloc (sizeof (oconfig_item_t));
 	 memset (ci_root, '\0', sizeof (oconfig_item_t));
 	 ci_root->children = (yyvsp[0].sl).statement;
 	 ci_root->children_num = (yyvsp[0].sl).statement_num;
 	}
-#line 1456 "parser.c" /* yacc.c:1646  */
+#line 1457 "parser.c" /* yacc.c:1646  */
     break;
 
   case 23:
-#line 208 "parser.y" /* yacc.c:1646  */
+#line 209 "parser.y" /* yacc.c:1646  */
     {
 	 ci_root = malloc (sizeof (oconfig_item_t));
 	 memset (ci_root, '\0', sizeof (oconfig_item_t));
 	 ci_root->children = NULL;
 	 ci_root->children_num = 0;
 	}
-#line 1467 "parser.c" /* yacc.c:1646  */
+#line 1468 "parser.c" /* yacc.c:1646  */
     break;
 
 
-#line 1471 "parser.c" /* yacc.c:1646  */
+#line 1472 "parser.c" /* yacc.c:1646  */
       default: break;
     }
   /* User semantic actions sometimes alter yychar, and that requires
      that yytoken be updated with the new translation.  We take the
      approach of translating immediately before every use of yytoken.
      One alternative is translating here after every semantic action,
@@ -1692,13 +1693,13 @@
 #if YYERROR_VERBOSE
   if (yymsg != yymsgbuf)
     YYSTACK_FREE (yymsg);
 #endif
   return yyresult;
 }
-#line 216 "parser.y" /* yacc.c:1906  */
+#line 217 "parser.y" /* yacc.c:1906  */
 
 static int yyerror (const char *s)
 {
 	char *text;
 
 	if (*yytext == '\n')
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.h	2015-02-26 18:47:29.540572541 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.h	2016-07-26 15:36:37.772091094 +0800
@@ -69,13 +69,13 @@
 
 /* Value type.  */
 #if ! defined YYSTYPE && ! defined YYSTYPE_IS_DECLARED
 typedef union YYSTYPE YYSTYPE;
 union YYSTYPE
 {
-#line 38 "parser.y" /* yacc.c:1909  */
+#line 39 "parser.y" /* yacc.c:1909  */
 
 	double  number;
 	int     boolean;
 	char   *string;
 	oconfig_value_t  cv;
 	oconfig_item_t   ci;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.y /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.y
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/parser.y	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/parser.y	2016-07-26 15:47:12.961713803 +0800
@@ -25,12 +25,13 @@
 static char *unquote (const char *orig);
 static int yyerror (const char *s);
 
 /* Lexer variables */
 extern int yylineno;
 extern char *yytext;
+extern int yylex (void);
 
 extern oconfig_item_t *ci_root;
 extern char           *c_file;
 %}
 
 %start entire_file
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/scanner.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/scanner.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/scanner.c	2015-02-26 18:47:29.788577459 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/scanner.c	2016-07-26 15:48:08.949850466 +0800
@@ -642,12 +642,13 @@
  * You should have received a copy of the GNU General Public License along with
  * this program; if not, write to the Free Software Foundation, Inc.,
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  */
 #line 21 "scanner.l"
 #include <stdlib.h>
+#include <string.h>
 #include "oconfig.h"
 #include "aux_types.h"
 #include "parser.h"
 
 /* multiline string buffer */
 static char *ml_buffer = NULL;
@@ -661,14 +662,15 @@
 #ifdef yyterminate
 # undef yyterminate
 #endif
 #define yyterminate() \
 	do { free (ml_buffer); ml_buffer = NULL; ml_pos = 0; ml_len = 0; \
 		return YY_NULL; } while (0)
+#define YY_NO_INPUT 1
 
-#line 669 "scanner.c"
+#line 671 "scanner.c"
 
 #define INITIAL 0
 #define ML 1
 
 #ifndef YY_NO_UNISTD_H
 /* Special case for "unistd.h", since it is non-ANSI. We include it way
@@ -722,14 +724,12 @@
 extern "C" int yywrap (void );
 #else
 extern int yywrap (void );
 #endif
 #endif
 
-    static void yyunput (int c,char *buf_ptr  );
-    
 #ifndef yytext_ptr
 static void yy_flex_strncpy (char *,yyconst char *,int );
 #endif
 
 #ifdef YY_NEED_STRLEN
 static int yy_flex_strlen (yyconst char * );
@@ -880,13 +880,13 @@
 		}
 
 		yy_load_buffer_state( );
 		}
 
 	{
-#line 62 "scanner.l"
+#line 65 "scanner.l"
 
 #line 889 "scanner.c"
 
 	while ( 1 )		/* loops until end-of-file is reached */
 		{
 		yy_cp = (yy_c_buf_p);
@@ -951,80 +951,80 @@
 			*yy_cp = (yy_hold_char);
 			yy_cp = (yy_last_accepting_cpos);
 			yy_current_state = (yy_last_accepting_state);
 			goto yy_find_action;
 
 case 1:
-#line 64 "scanner.l"
+#line 67 "scanner.l"
 case 2:
 YY_RULE_SETUP
-#line 64 "scanner.l"
+#line 67 "scanner.l"
 {/* ignore */}
 	YY_BREAK
 case 3:
 /* rule 3 can match eol */
 YY_RULE_SETUP
-#line 66 "scanner.l"
+#line 69 "scanner.l"
 {/* continue line */}
 	YY_BREAK
 case 4:
 /* rule 4 can match eol */
 YY_RULE_SETUP
-#line 68 "scanner.l"
+#line 71 "scanner.l"
 {return (EOL);}
 	YY_BREAK
 case 5:
 YY_RULE_SETUP
-#line 69 "scanner.l"
+#line 72 "scanner.l"
 {return (SLASH);}
 	YY_BREAK
 case 6:
 YY_RULE_SETUP
-#line 70 "scanner.l"
+#line 73 "scanner.l"
 {return (OPENBRAC);}
 	YY_BREAK
 case 7:
 YY_RULE_SETUP
-#line 71 "scanner.l"
+#line 74 "scanner.l"
 {return (CLOSEBRAC);}
 	YY_BREAK
 case 8:
 YY_RULE_SETUP
-#line 72 "scanner.l"
+#line 75 "scanner.l"
 {yylval.boolean = 1; return (BTRUE);}
 	YY_BREAK
 case 9:
 YY_RULE_SETUP
-#line 73 "scanner.l"
+#line 76 "scanner.l"
 {yylval.boolean = 0; return (BFALSE);}
 	YY_BREAK
 case 10:
 YY_RULE_SETUP
-#line 75 "scanner.l"
+#line 78 "scanner.l"
 {yylval.string = yytext; return (UNQUOTED_STRING);}
 	YY_BREAK
 case 11:
 YY_RULE_SETUP
-#line 77 "scanner.l"
+#line 80 "scanner.l"
 {yylval.number = strtod (yytext, NULL); return (NUMBER);}
 	YY_BREAK
 case 12:
 /* rule 12 can match eol */
 YY_RULE_SETUP
-#line 79 "scanner.l"
+#line 82 "scanner.l"
 {yylval.string = yytext; return (QUOTED_STRING);}
 	YY_BREAK
 case 13:
 YY_RULE_SETUP
-#line 80 "scanner.l"
+#line 83 "scanner.l"
 {yylval.string = yytext; return (UNQUOTED_STRING);}
 	YY_BREAK
 case 14:
 /* rule 14 can match eol */
 YY_RULE_SETUP
-#line 82 "scanner.l"
+#line 85 "scanner.l"
 {
 	int len = strlen (yytext);
 
 	ml_pos = 0;
 
 	/* remove "\\<EOL>" */
@@ -1037,19 +1037,19 @@
 	ml_append (yytext);
 	BEGIN (ML);
 }
 	YY_BREAK
 case 15:
 YY_RULE_SETUP
-#line 97 "scanner.l"
+#line 100 "scanner.l"
 {/* remove leading white-space */}
 	YY_BREAK
 case 16:
 /* rule 16 can match eol */
 YY_RULE_SETUP
-#line 98 "scanner.l"
+#line 101 "scanner.l"
 {
 	int len = strlen (yytext);
 
 	/* remove "\\<EOL>" */
 	if ('\r' == yytext[len - 2])
 		len -= 3;
@@ -1060,24 +1060,24 @@
 	ml_append(yytext);
 }
 	YY_BREAK
 case 17:
 /* rule 17 can match eol */
 YY_RULE_SETUP
-#line 110 "scanner.l"
+#line 113 "scanner.l"
 {
 	ml_append(yytext);
 	yylval.string = ml_buffer;
 
 	BEGIN (INITIAL);
 	return (QUOTED_STRING);
 }
 	YY_BREAK
 case 18:
 YY_RULE_SETUP
-#line 117 "scanner.l"
+#line 120 "scanner.l"
 ECHO;
 	YY_BREAK
 #line 1081 "scanner.c"
 case YY_STATE_EOF(INITIAL):
 case YY_STATE_EOF(ML):
 	yyterminate();
@@ -1406,53 +1406,12 @@
 	yy_current_state = yy_nxt[yy_base[yy_current_state] + (unsigned int) yy_c];
 	yy_is_jam = (yy_current_state == 117);
 
 		return yy_is_jam ? 0 : yy_current_state;
 }
 
-    static void yyunput (int c, register char * yy_bp )
-{
-	register char *yy_cp;
-    
-    yy_cp = (yy_c_buf_p);
-
-	/* undo effects of setting up yytext */
-	*yy_cp = (yy_hold_char);
-
-	if ( yy_cp < YY_CURRENT_BUFFER_LVALUE->yy_ch_buf + 2 )
-		{ /* need to shift things up to make room */
-		/* +2 for EOB chars. */
-		register yy_size_t number_to_move = (yy_n_chars) + 2;
-		register char *dest = &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[
-					YY_CURRENT_BUFFER_LVALUE->yy_buf_size + 2];
-		register char *source =
-				&YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[number_to_move];
-
-		while ( source > YY_CURRENT_BUFFER_LVALUE->yy_ch_buf )
-			*--dest = *--source;
-
-		yy_cp += (int) (dest - source);
-		yy_bp += (int) (dest - source);
-		YY_CURRENT_BUFFER_LVALUE->yy_n_chars =
-			(yy_n_chars) = YY_CURRENT_BUFFER_LVALUE->yy_buf_size;
-
-		if ( yy_cp < YY_CURRENT_BUFFER_LVALUE->yy_ch_buf + 2 )
-			YY_FATAL_ERROR( "flex scanner push-back overflow" );
-		}
-
-	*--yy_cp = (char) c;
-
-    if ( c == '\n' ){
-        --yylineno;
-    }
-
-	(yytext_ptr) = yy_bp;
-	(yy_hold_char) = *yy_cp;
-	(yy_c_buf_p) = yy_cp;
-}
-
 #ifndef YY_NO_INPUT
 #ifdef __cplusplus
     static int yyinput (void)
 #else
     static int input  (void)
 #endif
@@ -2084,13 +2043,13 @@
 {
 	free( (char *) ptr );	/* see yyrealloc() for (char *) cast */
 }
 
 #define YYTABLES_NAME "yytables"
 
-#line 116 "scanner.l"
+#line 119 "scanner.l"
 
 
 static void ml_append (char *string)
 {
 	int len = strlen (string);
 	int s;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/scanner.l /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/scanner.l
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/liboconfig/scanner.l	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/liboconfig/scanner.l	2016-07-26 15:47:12.961713803 +0800
@@ -16,12 +16,13 @@
  * this program; if not, write to the Free Software Foundation, Inc.,
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  */
 
 %{
 #include <stdlib.h>
+#include <string.h>
 #include "oconfig.h"
 #include "aux_types.h"
 #include "parser.h"
 
 /* multiline string buffer */
 static char *ml_buffer = NULL;
@@ -38,12 +39,14 @@
 #define yyterminate() \
 	do { free (ml_buffer); ml_buffer = NULL; ml_pos = 0; ml_len = 0; \
 		return YY_NULL; } while (0)
 %}
 %option yylineno
 %option noyywrap
+%option noinput
+%option nounput
 %x ML
 WHITE_SPACE [\ \t\b]
 NON_WHITE_SPACE [^\ \t\b]
 EOL (\r\n|\n)
 QUOTED_STRING ([^\\"]+|\\.)*
 UNQUOTED_STRING [0-9A-Za-z_]+
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libvirt.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libvirt.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/libvirt.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/libvirt.c	2016-07-26 15:47:12.961713803 +0800
@@ -256,13 +256,13 @@
 
 static int
 lv_init (void)
 {
     if (virInitialize () != 0)
         return -1;
-
+    else
 	return 0;
 }
 
 static int
 lv_config (const char *key, const char *value)
 {
@@ -795,12 +795,15 @@
 add_interface_device (virDomainPtr dom, const char *path, const char *address, unsigned int number)
 {
     struct interface_device *new_ptr;
     int new_size = sizeof (interface_devices[0]) * (nr_interface_devices+1);
     char *path_copy, *address_copy, number_string[15];
 
+    if ((path == NULL) || (address == NULL))
+        return EINVAL;
+
     path_copy = strdup (path);
     if (!path_copy) return -1;
 
     address_copy = strdup (address);
     if (!address_copy) {
         sfree(path_copy);
@@ -830,12 +833,15 @@
 static int
 ignore_device_match (ignorelist_t *il, const char *domname, const char *devpath)
 {
     char *name;
     int n, r;
 
+    if ((domname == NULL) || (devpath == NULL))
+        return 0;
+
     n = sizeof (char) * (strlen (domname) + strlen (devpath) + 2);
     name = malloc (n);
     if (name == NULL) {
         ERROR ("libvirt plugin: malloc failed.");
         return 0;
     }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/load.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/load.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/load.c	2015-02-26 18:43:48.476180586 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/load.c	2016-07-26 15:47:12.961713803 +0800
@@ -18,12 +18,13 @@
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  *   Manuel Sanmartin
  **/
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/logfile.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/logfile.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/logfile.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/logfile.c	2016-07-26 15:47:12.961713803 +0800
@@ -193,13 +193,13 @@
 		buf_ptr += status;
 		buf_len -= status;
 	}
 
 #define APPEND(bufptr, buflen, key, value) \
 	if ((buflen > 0) && (strlen (value) > 0)) { \
-		int status = ssnprintf (bufptr, buflen, ", %s = %s", key, value); \
+		status = ssnprintf (bufptr, buflen, ", %s = %s", key, value); \
 		if (status > 0) { \
 			bufptr += status; \
 			buflen -= status; \
 		} \
 	}
 	APPEND (buf_ptr, buf_len, "host", n->host);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/madwifi.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/madwifi.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/madwifi.c	2014-08-18 15:33:14.292460715 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/madwifi.c	2016-07-26 15:47:12.961713803 +0800
@@ -818,21 +818,22 @@
 	char buf[PATH_MAX];
 	char buf2[PATH_MAX];
 	int i;
 
 	if (dev[0] == '.')
 		return 0;
-	
+
 	ssnprintf (buf, sizeof (buf), "/sys/class/net/%s/device/driver", dev);
-	buf[sizeof (buf) - 1] = 0;
+	buf[sizeof (buf) - 1] = '\0';
 
-	memset (buf2, 0, sizeof (buf2));
 	i = readlink (buf, buf2, sizeof (buf2) - 1);
 	if (i < 0)
 		return 0;
 
+	buf2[i] = '\0';
+
 	if (strstr (buf2, "/drivers/ath_") == NULL)
 		return 0;
 	return 1;
 }
 
 static int
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/Makefile.am	2015-02-26 19:49:16.677658950 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/Makefile.am	2016-07-26 15:47:12.949713774 +0800
@@ -126,12 +126,15 @@
 if BUILD_WITH_LIBRT
 collectd_tg_LDADD += -lrt
 endif
 if BUILD_AIX
 collectd_tg_LDADD += -lm
 endif
+if BUILD_WITH_LIBPTHREAD
+collectd_tg_LDADD += -lpthread
+endif
 collectd_tg_LDADD += libcollectdclient/libcollectdclient.la
 collectd_tg_DEPENDENCIES = libcollectdclient/libcollectdclient.la
 
 
 pkglib_LTLIBRARIES = 
 
@@ -149,12 +152,13 @@
 endif
 
 if BUILD_PLUGIN_AMQP
 pkglib_LTLIBRARIES += amqp.la
 amqp_la_SOURCES = amqp.c \
 		  utils_cmd_putval.c utils_cmd_putval.h \
+  	          utils_parse_option.c utils_parse_option.h \
 		  utils_format_graphite.c utils_format_graphite.h \
 		  utils_format_json.c utils_format_json.h
 amqp_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRABBITMQ_LDFLAGS)
 amqp_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_LIBRABBITMQ_CPPFLAGS)
 amqp_la_LIBADD = $(BUILD_WITH_LIBRABBITMQ_LIBS)
 collectd_LDADD += "-dlopen" amqp.la
@@ -820,13 +824,13 @@
 endif
 
 if BUILD_PLUGIN_NOTIFY_EMAIL
 pkglib_LTLIBRARIES += notify_email.la
 notify_email_la_SOURCES = notify_email.c
 notify_email_la_LDFLAGS = -module -avoid-version
-notify_email_la_LIBADD = -lesmtp -lssl -lcrypto -lpthread -ldl
+notify_email_la_LIBADD = -lesmtp -lssl -lcrypto -lpthread
 collectd_LDADD += "-dlopen" notify_email.la
 collectd_DEPENDENCIES += notify_email.la
 endif
 
 if BUILD_PLUGIN_NTPD
 pkglib_LTLIBRARIES += ntpd.la
@@ -1025,25 +1029,25 @@
 collectd_DEPENDENCIES += routeros.la
 endif
 
 if BUILD_PLUGIN_RRDCACHED
 pkglib_LTLIBRARIES += rrdcached.la
 rrdcached_la_SOURCES = rrdcached.c utils_rrdcreate.c utils_rrdcreate.h
-rrdcached_la_LDFLAGS = -module -avoid-version
+rrdcached_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRRD_LDFLAGS)
 rrdcached_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBRRD_CFLAGS)
-rrdcached_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
+rrdcached_la_LIBADD = $(BUILD_WITH_LIBRRD_LIBS)
 collectd_LDADD += "-dlopen" rrdcached.la
 collectd_DEPENDENCIES += rrdcached.la
 endif
 
 if BUILD_PLUGIN_RRDTOOL
 pkglib_LTLIBRARIES += rrdtool.la
 rrdtool_la_SOURCES = rrdtool.c utils_rrdcreate.c utils_rrdcreate.h
-rrdtool_la_LDFLAGS = -module -avoid-version
+rrdtool_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRRD_LDFLAGS)
 rrdtool_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBRRD_CFLAGS)
-rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
+rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LIBS)
 collectd_LDADD += "-dlopen" rrdtool.la
 collectd_DEPENDENCIES += rrdtool.la
 endif
 
 if BUILD_PLUGIN_SENSORS
 pkglib_LTLIBRARIES += sensors.la
@@ -1092,13 +1096,13 @@
 
 if BUILD_PLUGIN_STATSD
 pkglib_LTLIBRARIES += statsd.la
 statsd_la_SOURCES = statsd.c \
                     utils_latency.h utils_latency.c
 statsd_la_LDFLAGS = -module -avoid-version
-statsd_la_LIBADD = -lpthread
+statsd_la_LIBADD = -lpthread -lm
 collectd_LDADD += "-dlopen" statsd.la
 collectd_DEPENDENCIES += statsd.la
 endif
 
 if BUILD_PLUGIN_SWAP
 pkglib_LTLIBRARIES += swap.la
@@ -1494,31 +1498,36 @@
 		>.pod2man.tmp.$$$$ 2>/dev/null && mv -f .pod2man.tmp.$$$$ $@ || true
 	@if grep '\<POD ERRORS\>' $@ >/dev/null 2>&1; \
 	then \
 		echo "$@ has some POD errors!"; false; \
 	fi
 
+AM_V_PROTOC_C = $(am__v_PROTOC_C_@AM_V@)
+am__v_PROTOC_C_ = $(am__v_PROTOC_C_@AM_DEFAULT_V@)
+am__v_PROTOC_C_0 = @echo "  PROTOC-C    " $@;
+am__v_PROTOC_C_1 =
+
 # Protocol buffer for the "pinba" plugin.
 EXTRA_DIST += pinba.proto
-if HAVE_PROTOC_C
+if BUILD_PLUGIN_PINBA
 CLEANFILES += pinba.pb-c.c pinba.pb-c.h
 BUILT_SOURCES += pinba.pb-c.c pinba.pb-c.h
 
 pinba.pb-c.c pinba.pb-c.h: pinba.proto
-	protoc-c -I$(srcdir) --c_out . $(srcdir)/pinba.proto
+	$(AM_V_PROTOC_C)protoc-c -I$(srcdir) --c_out . $(srcdir)/pinba.proto
 endif
 
 # Protocol buffer for the "write_riemann" plugin.
 EXTRA_DIST += riemann.proto
-if HAVE_PROTOC_C
+if BUILD_PLUGIN_WRITE_RIEMANN
 CLEANFILES += riemann.pb-c.c riemann.pb-c.h
 
 BUILT_SOURCES += riemann.pb-c.c riemann.pb-c.h
 
 riemann.pb-c.c riemann.pb-c.h: riemann.proto
-	protoc-c -I$(srcdir) --c_out . $(srcdir)/riemann.proto
+	$(AM_V_PROTOC_C)protoc-c -I$(srcdir) --c_out . $(srcdir)/riemann.proto
 endif
 
 install-exec-hook:
 	$(mkinstalldirs) $(DESTDIR)$(sysconfdir)
 	if test -e $(DESTDIR)$(sysconfdir)/collectd.conf; \
 	then \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/Makefile.in	2015-02-26 22:07:47.985242080 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/Makefile.in	2016-07-26 15:47:21.733735269 +0800
@@ -106,445 +106,446 @@
 @BUILD_AIX_TRUE@am__append_17 = -lm
 @BUILD_WITH_LIBSOCKET_TRUE@am__append_18 = -lsocket
 @BUILD_AIX_TRUE@am__append_19 = -lm
 @BUILD_WITH_LIBSOCKET_TRUE@am__append_20 = -lsocket
 @BUILD_WITH_LIBRT_TRUE@am__append_21 = -lrt
 @BUILD_AIX_TRUE@am__append_22 = -lm
-@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_23 = aggregation.la
-@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_24 = "-dlopen" aggregation.la
-@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_25 = aggregation.la
-@BUILD_PLUGIN_AMQP_TRUE@am__append_26 = amqp.la
-@BUILD_PLUGIN_AMQP_TRUE@am__append_27 = "-dlopen" amqp.la
-@BUILD_PLUGIN_AMQP_TRUE@am__append_28 = amqp.la
-@BUILD_PLUGIN_APACHE_TRUE@am__append_29 = apache.la
-@BUILD_PLUGIN_APACHE_TRUE@am__append_30 = "-dlopen" apache.la
-@BUILD_PLUGIN_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_31 = $(BUILD_WITH_LIBCURL_CFLAGS)
-@BUILD_PLUGIN_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_32 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_PLUGIN_APACHE_TRUE@am__append_33 = apache.la
-@BUILD_PLUGIN_APCUPS_TRUE@am__append_34 = apcups.la
-@BUILD_PLUGIN_APCUPS_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_35 = -lsocket
-@BUILD_PLUGIN_APCUPS_TRUE@am__append_36 = "-dlopen" apcups.la
-@BUILD_PLUGIN_APCUPS_TRUE@am__append_37 = apcups.la
-@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_38 = apple_sensors.la
-@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_39 = "-dlopen" apple_sensors.la
-@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_40 = apple_sensors.la
-@BUILD_PLUGIN_AQUAERO_TRUE@am__append_41 = aquaero.la
-@BUILD_PLUGIN_AQUAERO_TRUE@am__append_42 = "-dlopen" aquaero.la
-@BUILD_PLUGIN_AQUAERO_TRUE@am__append_43 = aquaero.la
-@BUILD_PLUGIN_ASCENT_TRUE@am__append_44 = ascent.la
-@BUILD_PLUGIN_ASCENT_TRUE@am__append_45 = "-dlopen" ascent.la
-@BUILD_PLUGIN_ASCENT_TRUE@am__append_46 = ascent.la
-@BUILD_PLUGIN_BATTERY_TRUE@am__append_47 = battery.la
-@BUILD_PLUGIN_BATTERY_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_48 = -framework IOKit
-@BUILD_PLUGIN_BATTERY_TRUE@am__append_49 = "-dlopen" battery.la
-@BUILD_PLUGIN_BATTERY_TRUE@am__append_50 = battery.la
-@BUILD_PLUGIN_BIND_TRUE@am__append_51 = bind.la
-@BUILD_PLUGIN_BIND_TRUE@am__append_52 = "-dlopen" bind.la
-@BUILD_PLUGIN_BIND_TRUE@am__append_53 = bind.la
-@BUILD_PLUGIN_CGROUPS_TRUE@am__append_54 = cgroups.la
-@BUILD_PLUGIN_CGROUPS_TRUE@am__append_55 = "-dlopen" cgroups.la
-@BUILD_PLUGIN_CGROUPS_TRUE@am__append_56 = cgroups.la
-@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_57 = conntrack.la
-@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_58 = "-dlopen" conntrack.la
-@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_59 = conntrack.la
-@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_60 = contextswitch.la
-@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_61 = -lperfstat
-@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_62 = "-dlopen" contextswitch.la
-@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_63 = contextswitch.la
-@BUILD_PLUGIN_CPU_TRUE@am__append_64 = cpu.la
-@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_65 = -lkstat
-@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_66 = -ldevinfo
-@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_67 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_68 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_69 = -lperfstat
-@BUILD_PLUGIN_CPU_TRUE@am__append_70 = "-dlopen" cpu.la
-@BUILD_PLUGIN_CPU_TRUE@am__append_71 = cpu.la
-@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_72 = cpufreq.la
-@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_73 = "-dlopen" cpufreq.la
-@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_74 = cpufreq.la
-@BUILD_PLUGIN_CSV_TRUE@am__append_75 = csv.la
-@BUILD_PLUGIN_CSV_TRUE@am__append_76 = "-dlopen" csv.la
-@BUILD_PLUGIN_CSV_TRUE@am__append_77 = csv.la
-@BUILD_PLUGIN_CURL_TRUE@am__append_78 = curl.la
-@BUILD_PLUGIN_CURL_TRUE@am__append_79 = "-dlopen" curl.la
-@BUILD_PLUGIN_CURL_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_80 = $(BUILD_WITH_LIBCURL_CFLAGS)
-@BUILD_PLUGIN_CURL_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_81 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_PLUGIN_CURL_TRUE@am__append_82 = curl.la
-@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_83 = curl_json.la
-@BUILD_PLUGIN_CURL_JSON_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_84 = $(BUILD_WITH_LIBCURL_CFLAGS)
-@BUILD_PLUGIN_CURL_JSON_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_85 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_86 = "-dlopen" curl_json.la
-@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_87 = curl_json.la
-@BUILD_PLUGIN_CURL_XML_TRUE@am__append_88 = curl_xml.la
-@BUILD_PLUGIN_CURL_XML_TRUE@am__append_89 = "-dlopen" curl_xml.la
-@BUILD_PLUGIN_CURL_XML_TRUE@am__append_90 = curl_xml.la
-@BUILD_PLUGIN_DBI_TRUE@am__append_91 = dbi.la
-@BUILD_PLUGIN_DBI_TRUE@am__append_92 = "-dlopen" dbi.la
-@BUILD_PLUGIN_DBI_TRUE@am__append_93 = dbi.la
-@BUILD_PLUGIN_DF_TRUE@am__append_94 = df.la
-@BUILD_PLUGIN_DF_TRUE@am__append_95 = "-dlopen" df.la
-@BUILD_PLUGIN_DF_TRUE@am__append_96 = df.la
-@BUILD_PLUGIN_DISK_TRUE@am__append_97 = disk.la
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_98 = -lkstat
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_99 = -ldevinfo
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_100 = -framework IOKit
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_101 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)  
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_102 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_103 = -lperfstat
-@BUILD_PLUGIN_DISK_TRUE@am__append_104 = "-dlopen" disk.la
-@BUILD_PLUGIN_DISK_TRUE@am__append_105 = disk.la
-@BUILD_PLUGIN_DNS_TRUE@am__append_106 = dns.la
-@BUILD_PLUGIN_DNS_TRUE@am__append_107 = "-dlopen" dns.la
-@BUILD_PLUGIN_DNS_TRUE@am__append_108 = dns.la
-@BUILD_PLUGIN_EMAIL_TRUE@am__append_109 = email.la
-@BUILD_PLUGIN_EMAIL_TRUE@am__append_110 = "-dlopen" email.la
-@BUILD_PLUGIN_EMAIL_TRUE@am__append_111 = email.la
-@BUILD_PLUGIN_ENTROPY_TRUE@am__append_112 = entropy.la
-@BUILD_PLUGIN_ENTROPY_TRUE@am__append_113 = "-dlopen" entropy.la
-@BUILD_PLUGIN_ENTROPY_TRUE@am__append_114 = entropy.la
-@BUILD_PLUGIN_EXEC_TRUE@am__append_115 = exec.la
-@BUILD_PLUGIN_EXEC_TRUE@am__append_116 = "-dlopen" exec.la
-@BUILD_PLUGIN_EXEC_TRUE@am__append_117 = exec.la
-@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_118 = ethstat.la
-@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_119 = "-dlopen" ethstat.la
-@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_120 = ethstat.la
-@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_121 = filecount.la
-@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_122 = "-dlopen" filecount.la
-@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_123 = filecount.la
-@BUILD_PLUGIN_GMOND_TRUE@am__append_124 = gmond.la
-@BUILD_PLUGIN_GMOND_TRUE@am__append_125 = "-dlopen" gmond.la
-@BUILD_PLUGIN_GMOND_TRUE@am__append_126 = gmond.la
-@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_127 = hddtemp.la
-@BUILD_PLUGIN_HDDTEMP_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_128 = -lsocket
-@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_129 = "-dlopen" hddtemp.la
-@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_130 = hddtemp.la
-@BUILD_PLUGIN_INTERFACE_TRUE@am__append_131 = interface.la
-@BUILD_PLUGIN_INTERFACE_TRUE@am__append_132 = "-dlopen" interface.la
-@BUILD_PLUGIN_INTERFACE_TRUE@am__append_133 = interface.la
-@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_134 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_135 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_FALSE@am__append_136 = -lkstat
-@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@@BUILD_WITH_LIBSTATGRAB_FALSE@am__append_137 = -ldevinfo
-@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_138 = -lperfstat
-@BUILD_PLUGIN_IPTABLES_TRUE@am__append_139 = iptables.la
-@BUILD_PLUGIN_IPTABLES_TRUE@am__append_140 = "-dlopen" iptables.la
-@BUILD_PLUGIN_IPTABLES_TRUE@am__append_141 = iptables.la
-@BUILD_PLUGIN_IPMI_TRUE@am__append_142 = ipmi.la
-@BUILD_PLUGIN_IPMI_TRUE@am__append_143 = "-dlopen" ipmi.la
-@BUILD_PLUGIN_IPMI_TRUE@am__append_144 = ipmi.la
-@BUILD_PLUGIN_IPVS_TRUE@am__append_145 = ipvs.la
-@BUILD_PLUGIN_IPVS_TRUE@am__append_146 = "-dlopen" ipvs.la
-@BUILD_PLUGIN_IPVS_TRUE@am__append_147 = ipvs.la
-@BUILD_PLUGIN_IRQ_TRUE@am__append_148 = irq.la
-@BUILD_PLUGIN_IRQ_TRUE@am__append_149 = "-dlopen" irq.la
-@BUILD_PLUGIN_IRQ_TRUE@am__append_150 = irq.la
-@BUILD_PLUGIN_JAVA_TRUE@am__append_151 = java.la
-@BUILD_PLUGIN_JAVA_TRUE@am__append_152 = "-dlopen" java.la
-@BUILD_PLUGIN_JAVA_TRUE@am__append_153 = java.la
-@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_154 = libvirt.la
-@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_155 = "-dlopen" libvirt.la
-@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_156 = libvirt.la
-@BUILD_PLUGIN_LOAD_TRUE@am__append_157 = load.la
-@BUILD_PLUGIN_LOAD_TRUE@am__append_158 = "-dlopen" load.la
-@BUILD_PLUGIN_LOAD_TRUE@am__append_159 = load.la
-@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_160 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_161 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_162 = -lperfstat
-@BUILD_PLUGIN_LOGFILE_TRUE@am__append_163 = logfile.la
-@BUILD_PLUGIN_LOGFILE_TRUE@am__append_164 = "-dlopen" logfile.la
-@BUILD_PLUGIN_LOGFILE_TRUE@am__append_165 = logfile.la
-@BUILD_PLUGIN_LPAR_TRUE@am__append_166 = lpar.la
-@BUILD_PLUGIN_LPAR_TRUE@am__append_167 = "-dlopen" lpar.la
-@BUILD_PLUGIN_LPAR_TRUE@am__append_168 = lpar.la
-@BUILD_PLUGIN_LVM_TRUE@am__append_169 = lvm.la
-@BUILD_PLUGIN_LVM_TRUE@am__append_170 = "-dlopen" lvm.la
-@BUILD_PLUGIN_LVM_TRUE@am__append_171 = lvm.la
-@BUILD_PLUGIN_MADWIFI_TRUE@am__append_172 = madwifi.la
-@BUILD_PLUGIN_MADWIFI_TRUE@am__append_173 = "-dlopen" madwifi.la
-@BUILD_PLUGIN_MADWIFI_TRUE@am__append_174 = madwifi.la
-@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_175 = match_empty_counter.la
-@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_176 = "-dlopen" match_empty_counter.la
-@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_177 = match_empty_counter.la
-@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_178 = match_hashed.la
-@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_179 = "-dlopen" match_hashed.la
-@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_180 = match_hashed.la
-@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_181 = match_regex.la
-@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_182 = "-dlopen" match_regex.la
-@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_183 = match_regex.la
-@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_184 = match_timediff.la
-@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_185 = "-dlopen" match_timediff.la
-@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_186 = match_timediff.la
-@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_187 = match_value.la
-@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_188 = "-dlopen" match_value.la
-@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_189 = match_value.la
-@BUILD_PLUGIN_MBMON_TRUE@am__append_190 = mbmon.la
-@BUILD_PLUGIN_MBMON_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_191 = -lsocket
-@BUILD_PLUGIN_MBMON_TRUE@am__append_192 = "-dlopen" mbmon.la
-@BUILD_PLUGIN_MBMON_TRUE@am__append_193 = mbmon.la
-@BUILD_PLUGIN_MD_TRUE@am__append_194 = md.la
-@BUILD_PLUGIN_MD_TRUE@am__append_195 = "-dlopen" md.la
-@BUILD_PLUGIN_MD_TRUE@am__append_196 = md.la
-@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_197 = memcachec.la
-@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_198 = "-dlopen" memcachec.la
-@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_199 = memcachec.la
-@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_200 = memcached.la
-@BUILD_PLUGIN_MEMCACHED_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_201 = -lsocket
-@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_202 = "-dlopen" memcached.la
-@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_203 = memcached.la
-@BUILD_PLUGIN_MEMORY_TRUE@am__append_204 = memory.la
-@BUILD_PLUGIN_MEMORY_TRUE@am__append_205 = "-dlopen" memory.la
-@BUILD_PLUGIN_MEMORY_TRUE@am__append_206 = memory.la
-@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_207 = -lkstat
-@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_208 = -ldevinfo
-@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_209 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_210 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_211 = -lperfstat
-@BUILD_PLUGIN_MODBUS_TRUE@am__append_212 = modbus.la
-@BUILD_PLUGIN_MODBUS_TRUE@am__append_213 = "-dlopen" modbus.la
-@BUILD_PLUGIN_MODBUS_TRUE@am__append_214 = modbus.la
-@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_215 = multimeter.la
-@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_216 = "-dlopen" multimeter.la
-@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_217 = multimeter.la
-@BUILD_PLUGIN_MYSQL_TRUE@am__append_218 = mysql.la
-@BUILD_PLUGIN_MYSQL_TRUE@am__append_219 = "-dlopen" mysql.la
-@BUILD_PLUGIN_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_220 = $(BUILD_WITH_LIBMYSQL_CFLAGS)
-@BUILD_PLUGIN_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_221 = $(BUILD_WITH_LIBMYSQL_LIBS)
-@BUILD_PLUGIN_MYSQL_TRUE@am__append_222 = mysql.la
-@BUILD_PLUGIN_NETAPP_TRUE@am__append_223 = netapp.la
-@BUILD_PLUGIN_NETAPP_TRUE@am__append_224 = "-dlopen" netapp.la
-@BUILD_PLUGIN_NETAPP_TRUE@am__append_225 = netapp.la
-@BUILD_PLUGIN_NETLINK_TRUE@am__append_226 = netlink.la
-@BUILD_PLUGIN_NETLINK_TRUE@am__append_227 = "-dlopen" netlink.la
-@BUILD_PLUGIN_NETLINK_TRUE@am__append_228 = netlink.la
-@BUILD_PLUGIN_NETWORK_TRUE@am__append_229 = network.la
-@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_230 = -lsocket
-@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_231 = $(GCRYPT_CPPFLAGS)
-@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_232 = $(GCRYPT_LDFLAGS)
-@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_233 = $(GCRYPT_LIBS)
-@BUILD_PLUGIN_NETWORK_TRUE@am__append_234 = "-dlopen" network.la
-@BUILD_PLUGIN_NETWORK_TRUE@am__append_235 = network.la
-@BUILD_PLUGIN_NFS_TRUE@am__append_236 = nfs.la
-@BUILD_PLUGIN_NFS_TRUE@am__append_237 = "-dlopen" nfs.la
-@BUILD_PLUGIN_NFS_TRUE@am__append_238 = nfs.la
-@BUILD_PLUGIN_FSCACHE_TRUE@am__append_239 = fscache.la
-@BUILD_PLUGIN_FSCACHE_TRUE@am__append_240 = "-dlopen" fscache.la
-@BUILD_PLUGIN_FSCACHE_TRUE@am__append_241 = fscache.la
-@BUILD_PLUGIN_NGINX_TRUE@am__append_242 = nginx.la
-@BUILD_PLUGIN_NGINX_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_243 = $(BUILD_WITH_LIBCURL_CFLAGS)
-@BUILD_PLUGIN_NGINX_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_244 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_PLUGIN_NGINX_TRUE@am__append_245 = "-dlopen" nginx.la
-@BUILD_PLUGIN_NGINX_TRUE@am__append_246 = nginx.la
-@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_247 = notify_desktop.la
-@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_248 = "-dlopen" notify_desktop.la
-@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_249 = notify_desktop.la
-@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_250 = notify_email.la
-@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_251 = "-dlopen" notify_email.la
-@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_252 = notify_email.la
-@BUILD_PLUGIN_NTPD_TRUE@am__append_253 = ntpd.la
-@BUILD_PLUGIN_NTPD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_254 = -lsocket
-@BUILD_PLUGIN_NTPD_TRUE@am__append_255 = "-dlopen" ntpd.la
-@BUILD_PLUGIN_NTPD_TRUE@am__append_256 = ntpd.la
-@BUILD_PLUGIN_NUMA_TRUE@am__append_257 = numa.la
-@BUILD_PLUGIN_NUMA_TRUE@am__append_258 = "-dlopen" numa.la
-@BUILD_PLUGIN_NUMA_TRUE@am__append_259 = numa.la
-@BUILD_PLUGIN_NUT_TRUE@am__append_260 = nut.la
-@BUILD_PLUGIN_NUT_TRUE@am__append_261 = "-dlopen" nut.la
-@BUILD_PLUGIN_NUT_TRUE@am__append_262 = nut.la
-@BUILD_PLUGIN_OLSRD_TRUE@am__append_263 = olsrd.la
-@BUILD_PLUGIN_OLSRD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_264 = -lsocket
-@BUILD_PLUGIN_OLSRD_TRUE@am__append_265 = "-dlopen" olsrd.la
-@BUILD_PLUGIN_OLSRD_TRUE@am__append_266 = olsrd.la
-@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_267 = onewire.la
-@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_268 = "-dlopen" onewire.la
-@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_269 = onewire.la
-@BUILD_PLUGIN_OPENVPN_TRUE@am__append_270 = openvpn.la
-@BUILD_PLUGIN_OPENVPN_TRUE@am__append_271 = "-dlopen" openvpn.la
-@BUILD_PLUGIN_OPENVPN_TRUE@am__append_272 = openvpn.la
-@BUILD_PLUGIN_ORACLE_TRUE@am__append_273 = oracle.la
-@BUILD_PLUGIN_ORACLE_TRUE@am__append_274 = "-dlopen" oracle.la
-@BUILD_PLUGIN_ORACLE_TRUE@am__append_275 = oracle.la
-@BUILD_PLUGIN_PERL_TRUE@am__append_276 = perl.la
+@BUILD_WITH_LIBPTHREAD_TRUE@am__append_23 = -lpthread
+@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_24 = aggregation.la
+@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_25 = "-dlopen" aggregation.la
+@BUILD_PLUGIN_AGGREGATION_TRUE@am__append_26 = aggregation.la
+@BUILD_PLUGIN_AMQP_TRUE@am__append_27 = amqp.la
+@BUILD_PLUGIN_AMQP_TRUE@am__append_28 = "-dlopen" amqp.la
+@BUILD_PLUGIN_AMQP_TRUE@am__append_29 = amqp.la
+@BUILD_PLUGIN_APACHE_TRUE@am__append_30 = apache.la
+@BUILD_PLUGIN_APACHE_TRUE@am__append_31 = "-dlopen" apache.la
+@BUILD_PLUGIN_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_32 = $(BUILD_WITH_LIBCURL_CFLAGS)
+@BUILD_PLUGIN_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_33 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_PLUGIN_APACHE_TRUE@am__append_34 = apache.la
+@BUILD_PLUGIN_APCUPS_TRUE@am__append_35 = apcups.la
+@BUILD_PLUGIN_APCUPS_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_36 = -lsocket
+@BUILD_PLUGIN_APCUPS_TRUE@am__append_37 = "-dlopen" apcups.la
+@BUILD_PLUGIN_APCUPS_TRUE@am__append_38 = apcups.la
+@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_39 = apple_sensors.la
+@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_40 = "-dlopen" apple_sensors.la
+@BUILD_PLUGIN_APPLE_SENSORS_TRUE@am__append_41 = apple_sensors.la
+@BUILD_PLUGIN_AQUAERO_TRUE@am__append_42 = aquaero.la
+@BUILD_PLUGIN_AQUAERO_TRUE@am__append_43 = "-dlopen" aquaero.la
+@BUILD_PLUGIN_AQUAERO_TRUE@am__append_44 = aquaero.la
+@BUILD_PLUGIN_ASCENT_TRUE@am__append_45 = ascent.la
+@BUILD_PLUGIN_ASCENT_TRUE@am__append_46 = "-dlopen" ascent.la
+@BUILD_PLUGIN_ASCENT_TRUE@am__append_47 = ascent.la
+@BUILD_PLUGIN_BATTERY_TRUE@am__append_48 = battery.la
+@BUILD_PLUGIN_BATTERY_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_49 = -framework IOKit
+@BUILD_PLUGIN_BATTERY_TRUE@am__append_50 = "-dlopen" battery.la
+@BUILD_PLUGIN_BATTERY_TRUE@am__append_51 = battery.la
+@BUILD_PLUGIN_BIND_TRUE@am__append_52 = bind.la
+@BUILD_PLUGIN_BIND_TRUE@am__append_53 = "-dlopen" bind.la
+@BUILD_PLUGIN_BIND_TRUE@am__append_54 = bind.la
+@BUILD_PLUGIN_CGROUPS_TRUE@am__append_55 = cgroups.la
+@BUILD_PLUGIN_CGROUPS_TRUE@am__append_56 = "-dlopen" cgroups.la
+@BUILD_PLUGIN_CGROUPS_TRUE@am__append_57 = cgroups.la
+@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_58 = conntrack.la
+@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_59 = "-dlopen" conntrack.la
+@BUILD_PLUGIN_CONNTRACK_TRUE@am__append_60 = conntrack.la
+@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_61 = contextswitch.la
+@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_62 = -lperfstat
+@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_63 = "-dlopen" contextswitch.la
+@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@am__append_64 = contextswitch.la
+@BUILD_PLUGIN_CPU_TRUE@am__append_65 = cpu.la
+@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_66 = -lkstat
+@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_67 = -ldevinfo
+@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_68 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_69 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_CPU_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_70 = -lperfstat
+@BUILD_PLUGIN_CPU_TRUE@am__append_71 = "-dlopen" cpu.la
+@BUILD_PLUGIN_CPU_TRUE@am__append_72 = cpu.la
+@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_73 = cpufreq.la
+@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_74 = "-dlopen" cpufreq.la
+@BUILD_PLUGIN_CPUFREQ_TRUE@am__append_75 = cpufreq.la
+@BUILD_PLUGIN_CSV_TRUE@am__append_76 = csv.la
+@BUILD_PLUGIN_CSV_TRUE@am__append_77 = "-dlopen" csv.la
+@BUILD_PLUGIN_CSV_TRUE@am__append_78 = csv.la
+@BUILD_PLUGIN_CURL_TRUE@am__append_79 = curl.la
+@BUILD_PLUGIN_CURL_TRUE@am__append_80 = "-dlopen" curl.la
+@BUILD_PLUGIN_CURL_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_81 = $(BUILD_WITH_LIBCURL_CFLAGS)
+@BUILD_PLUGIN_CURL_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_82 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_PLUGIN_CURL_TRUE@am__append_83 = curl.la
+@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_84 = curl_json.la
+@BUILD_PLUGIN_CURL_JSON_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_85 = $(BUILD_WITH_LIBCURL_CFLAGS)
+@BUILD_PLUGIN_CURL_JSON_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_86 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_87 = "-dlopen" curl_json.la
+@BUILD_PLUGIN_CURL_JSON_TRUE@am__append_88 = curl_json.la
+@BUILD_PLUGIN_CURL_XML_TRUE@am__append_89 = curl_xml.la
+@BUILD_PLUGIN_CURL_XML_TRUE@am__append_90 = "-dlopen" curl_xml.la
+@BUILD_PLUGIN_CURL_XML_TRUE@am__append_91 = curl_xml.la
+@BUILD_PLUGIN_DBI_TRUE@am__append_92 = dbi.la
+@BUILD_PLUGIN_DBI_TRUE@am__append_93 = "-dlopen" dbi.la
+@BUILD_PLUGIN_DBI_TRUE@am__append_94 = dbi.la
+@BUILD_PLUGIN_DF_TRUE@am__append_95 = df.la
+@BUILD_PLUGIN_DF_TRUE@am__append_96 = "-dlopen" df.la
+@BUILD_PLUGIN_DF_TRUE@am__append_97 = df.la
+@BUILD_PLUGIN_DISK_TRUE@am__append_98 = disk.la
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_99 = -lkstat
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_100 = -ldevinfo
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_101 = -framework IOKit
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_102 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)  
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_103 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_DISK_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_104 = -lperfstat
+@BUILD_PLUGIN_DISK_TRUE@am__append_105 = "-dlopen" disk.la
+@BUILD_PLUGIN_DISK_TRUE@am__append_106 = disk.la
+@BUILD_PLUGIN_DNS_TRUE@am__append_107 = dns.la
+@BUILD_PLUGIN_DNS_TRUE@am__append_108 = "-dlopen" dns.la
+@BUILD_PLUGIN_DNS_TRUE@am__append_109 = dns.la
+@BUILD_PLUGIN_EMAIL_TRUE@am__append_110 = email.la
+@BUILD_PLUGIN_EMAIL_TRUE@am__append_111 = "-dlopen" email.la
+@BUILD_PLUGIN_EMAIL_TRUE@am__append_112 = email.la
+@BUILD_PLUGIN_ENTROPY_TRUE@am__append_113 = entropy.la
+@BUILD_PLUGIN_ENTROPY_TRUE@am__append_114 = "-dlopen" entropy.la
+@BUILD_PLUGIN_ENTROPY_TRUE@am__append_115 = entropy.la
+@BUILD_PLUGIN_EXEC_TRUE@am__append_116 = exec.la
+@BUILD_PLUGIN_EXEC_TRUE@am__append_117 = "-dlopen" exec.la
+@BUILD_PLUGIN_EXEC_TRUE@am__append_118 = exec.la
+@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_119 = ethstat.la
+@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_120 = "-dlopen" ethstat.la
+@BUILD_PLUGIN_ETHSTAT_TRUE@am__append_121 = ethstat.la
+@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_122 = filecount.la
+@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_123 = "-dlopen" filecount.la
+@BUILD_PLUGIN_FILECOUNT_TRUE@am__append_124 = filecount.la
+@BUILD_PLUGIN_GMOND_TRUE@am__append_125 = gmond.la
+@BUILD_PLUGIN_GMOND_TRUE@am__append_126 = "-dlopen" gmond.la
+@BUILD_PLUGIN_GMOND_TRUE@am__append_127 = gmond.la
+@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_128 = hddtemp.la
+@BUILD_PLUGIN_HDDTEMP_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_129 = -lsocket
+@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_130 = "-dlopen" hddtemp.la
+@BUILD_PLUGIN_HDDTEMP_TRUE@am__append_131 = hddtemp.la
+@BUILD_PLUGIN_INTERFACE_TRUE@am__append_132 = interface.la
+@BUILD_PLUGIN_INTERFACE_TRUE@am__append_133 = "-dlopen" interface.la
+@BUILD_PLUGIN_INTERFACE_TRUE@am__append_134 = interface.la
+@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_135 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_136 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_FALSE@am__append_137 = -lkstat
+@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@@BUILD_WITH_LIBSTATGRAB_FALSE@am__append_138 = -ldevinfo
+@BUILD_PLUGIN_INTERFACE_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_139 = -lperfstat
+@BUILD_PLUGIN_IPTABLES_TRUE@am__append_140 = iptables.la
+@BUILD_PLUGIN_IPTABLES_TRUE@am__append_141 = "-dlopen" iptables.la
+@BUILD_PLUGIN_IPTABLES_TRUE@am__append_142 = iptables.la
+@BUILD_PLUGIN_IPMI_TRUE@am__append_143 = ipmi.la
+@BUILD_PLUGIN_IPMI_TRUE@am__append_144 = "-dlopen" ipmi.la
+@BUILD_PLUGIN_IPMI_TRUE@am__append_145 = ipmi.la
+@BUILD_PLUGIN_IPVS_TRUE@am__append_146 = ipvs.la
+@BUILD_PLUGIN_IPVS_TRUE@am__append_147 = "-dlopen" ipvs.la
+@BUILD_PLUGIN_IPVS_TRUE@am__append_148 = ipvs.la
+@BUILD_PLUGIN_IRQ_TRUE@am__append_149 = irq.la
+@BUILD_PLUGIN_IRQ_TRUE@am__append_150 = "-dlopen" irq.la
+@BUILD_PLUGIN_IRQ_TRUE@am__append_151 = irq.la
+@BUILD_PLUGIN_JAVA_TRUE@am__append_152 = java.la
+@BUILD_PLUGIN_JAVA_TRUE@am__append_153 = "-dlopen" java.la
+@BUILD_PLUGIN_JAVA_TRUE@am__append_154 = java.la
+@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_155 = libvirt.la
+@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_156 = "-dlopen" libvirt.la
+@BUILD_PLUGIN_LIBVIRT_TRUE@am__append_157 = libvirt.la
+@BUILD_PLUGIN_LOAD_TRUE@am__append_158 = load.la
+@BUILD_PLUGIN_LOAD_TRUE@am__append_159 = "-dlopen" load.la
+@BUILD_PLUGIN_LOAD_TRUE@am__append_160 = load.la
+@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_161 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_162 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_LOAD_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_163 = -lperfstat
+@BUILD_PLUGIN_LOGFILE_TRUE@am__append_164 = logfile.la
+@BUILD_PLUGIN_LOGFILE_TRUE@am__append_165 = "-dlopen" logfile.la
+@BUILD_PLUGIN_LOGFILE_TRUE@am__append_166 = logfile.la
+@BUILD_PLUGIN_LPAR_TRUE@am__append_167 = lpar.la
+@BUILD_PLUGIN_LPAR_TRUE@am__append_168 = "-dlopen" lpar.la
+@BUILD_PLUGIN_LPAR_TRUE@am__append_169 = lpar.la
+@BUILD_PLUGIN_LVM_TRUE@am__append_170 = lvm.la
+@BUILD_PLUGIN_LVM_TRUE@am__append_171 = "-dlopen" lvm.la
+@BUILD_PLUGIN_LVM_TRUE@am__append_172 = lvm.la
+@BUILD_PLUGIN_MADWIFI_TRUE@am__append_173 = madwifi.la
+@BUILD_PLUGIN_MADWIFI_TRUE@am__append_174 = "-dlopen" madwifi.la
+@BUILD_PLUGIN_MADWIFI_TRUE@am__append_175 = madwifi.la
+@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_176 = match_empty_counter.la
+@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_177 = "-dlopen" match_empty_counter.la
+@BUILD_PLUGIN_MATCH_EMPTY_COUNTER_TRUE@am__append_178 = match_empty_counter.la
+@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_179 = match_hashed.la
+@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_180 = "-dlopen" match_hashed.la
+@BUILD_PLUGIN_MATCH_HASHED_TRUE@am__append_181 = match_hashed.la
+@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_182 = match_regex.la
+@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_183 = "-dlopen" match_regex.la
+@BUILD_PLUGIN_MATCH_REGEX_TRUE@am__append_184 = match_regex.la
+@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_185 = match_timediff.la
+@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_186 = "-dlopen" match_timediff.la
+@BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@am__append_187 = match_timediff.la
+@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_188 = match_value.la
+@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_189 = "-dlopen" match_value.la
+@BUILD_PLUGIN_MATCH_VALUE_TRUE@am__append_190 = match_value.la
+@BUILD_PLUGIN_MBMON_TRUE@am__append_191 = mbmon.la
+@BUILD_PLUGIN_MBMON_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_192 = -lsocket
+@BUILD_PLUGIN_MBMON_TRUE@am__append_193 = "-dlopen" mbmon.la
+@BUILD_PLUGIN_MBMON_TRUE@am__append_194 = mbmon.la
+@BUILD_PLUGIN_MD_TRUE@am__append_195 = md.la
+@BUILD_PLUGIN_MD_TRUE@am__append_196 = "-dlopen" md.la
+@BUILD_PLUGIN_MD_TRUE@am__append_197 = md.la
+@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_198 = memcachec.la
+@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_199 = "-dlopen" memcachec.la
+@BUILD_PLUGIN_MEMCACHEC_TRUE@am__append_200 = memcachec.la
+@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_201 = memcached.la
+@BUILD_PLUGIN_MEMCACHED_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_202 = -lsocket
+@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_203 = "-dlopen" memcached.la
+@BUILD_PLUGIN_MEMCACHED_TRUE@am__append_204 = memcached.la
+@BUILD_PLUGIN_MEMORY_TRUE@am__append_205 = memory.la
+@BUILD_PLUGIN_MEMORY_TRUE@am__append_206 = "-dlopen" memory.la
+@BUILD_PLUGIN_MEMORY_TRUE@am__append_207 = memory.la
+@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_208 = -lkstat
+@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_209 = -ldevinfo
+@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_210 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_211 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_MEMORY_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_212 = -lperfstat
+@BUILD_PLUGIN_MODBUS_TRUE@am__append_213 = modbus.la
+@BUILD_PLUGIN_MODBUS_TRUE@am__append_214 = "-dlopen" modbus.la
+@BUILD_PLUGIN_MODBUS_TRUE@am__append_215 = modbus.la
+@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_216 = multimeter.la
+@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_217 = "-dlopen" multimeter.la
+@BUILD_PLUGIN_MULTIMETER_TRUE@am__append_218 = multimeter.la
+@BUILD_PLUGIN_MYSQL_TRUE@am__append_219 = mysql.la
+@BUILD_PLUGIN_MYSQL_TRUE@am__append_220 = "-dlopen" mysql.la
+@BUILD_PLUGIN_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_221 = $(BUILD_WITH_LIBMYSQL_CFLAGS)
+@BUILD_PLUGIN_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_222 = $(BUILD_WITH_LIBMYSQL_LIBS)
+@BUILD_PLUGIN_MYSQL_TRUE@am__append_223 = mysql.la
+@BUILD_PLUGIN_NETAPP_TRUE@am__append_224 = netapp.la
+@BUILD_PLUGIN_NETAPP_TRUE@am__append_225 = "-dlopen" netapp.la
+@BUILD_PLUGIN_NETAPP_TRUE@am__append_226 = netapp.la
+@BUILD_PLUGIN_NETLINK_TRUE@am__append_227 = netlink.la
+@BUILD_PLUGIN_NETLINK_TRUE@am__append_228 = "-dlopen" netlink.la
+@BUILD_PLUGIN_NETLINK_TRUE@am__append_229 = netlink.la
+@BUILD_PLUGIN_NETWORK_TRUE@am__append_230 = network.la
+@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_231 = -lsocket
+@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_232 = $(GCRYPT_CPPFLAGS)
+@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_233 = $(GCRYPT_LDFLAGS)
+@BUILD_PLUGIN_NETWORK_TRUE@@BUILD_WITH_LIBGCRYPT_TRUE@am__append_234 = $(GCRYPT_LIBS)
+@BUILD_PLUGIN_NETWORK_TRUE@am__append_235 = "-dlopen" network.la
+@BUILD_PLUGIN_NETWORK_TRUE@am__append_236 = network.la
+@BUILD_PLUGIN_NFS_TRUE@am__append_237 = nfs.la
+@BUILD_PLUGIN_NFS_TRUE@am__append_238 = "-dlopen" nfs.la
+@BUILD_PLUGIN_NFS_TRUE@am__append_239 = nfs.la
+@BUILD_PLUGIN_FSCACHE_TRUE@am__append_240 = fscache.la
+@BUILD_PLUGIN_FSCACHE_TRUE@am__append_241 = "-dlopen" fscache.la
+@BUILD_PLUGIN_FSCACHE_TRUE@am__append_242 = fscache.la
+@BUILD_PLUGIN_NGINX_TRUE@am__append_243 = nginx.la
+@BUILD_PLUGIN_NGINX_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_244 = $(BUILD_WITH_LIBCURL_CFLAGS)
+@BUILD_PLUGIN_NGINX_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_245 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_PLUGIN_NGINX_TRUE@am__append_246 = "-dlopen" nginx.la
+@BUILD_PLUGIN_NGINX_TRUE@am__append_247 = nginx.la
+@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_248 = notify_desktop.la
+@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_249 = "-dlopen" notify_desktop.la
+@BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@am__append_250 = notify_desktop.la
+@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_251 = notify_email.la
+@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_252 = "-dlopen" notify_email.la
+@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@am__append_253 = notify_email.la
+@BUILD_PLUGIN_NTPD_TRUE@am__append_254 = ntpd.la
+@BUILD_PLUGIN_NTPD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_255 = -lsocket
+@BUILD_PLUGIN_NTPD_TRUE@am__append_256 = "-dlopen" ntpd.la
+@BUILD_PLUGIN_NTPD_TRUE@am__append_257 = ntpd.la
+@BUILD_PLUGIN_NUMA_TRUE@am__append_258 = numa.la
+@BUILD_PLUGIN_NUMA_TRUE@am__append_259 = "-dlopen" numa.la
+@BUILD_PLUGIN_NUMA_TRUE@am__append_260 = numa.la
+@BUILD_PLUGIN_NUT_TRUE@am__append_261 = nut.la
+@BUILD_PLUGIN_NUT_TRUE@am__append_262 = "-dlopen" nut.la
+@BUILD_PLUGIN_NUT_TRUE@am__append_263 = nut.la
+@BUILD_PLUGIN_OLSRD_TRUE@am__append_264 = olsrd.la
+@BUILD_PLUGIN_OLSRD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_265 = -lsocket
+@BUILD_PLUGIN_OLSRD_TRUE@am__append_266 = "-dlopen" olsrd.la
+@BUILD_PLUGIN_OLSRD_TRUE@am__append_267 = olsrd.la
+@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_268 = onewire.la
+@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_269 = "-dlopen" onewire.la
+@BUILD_PLUGIN_ONEWIRE_TRUE@am__append_270 = onewire.la
+@BUILD_PLUGIN_OPENVPN_TRUE@am__append_271 = openvpn.la
+@BUILD_PLUGIN_OPENVPN_TRUE@am__append_272 = "-dlopen" openvpn.la
+@BUILD_PLUGIN_OPENVPN_TRUE@am__append_273 = openvpn.la
+@BUILD_PLUGIN_ORACLE_TRUE@am__append_274 = oracle.la
+@BUILD_PLUGIN_ORACLE_TRUE@am__append_275 = "-dlopen" oracle.la
+@BUILD_PLUGIN_ORACLE_TRUE@am__append_276 = oracle.la
+@BUILD_PLUGIN_PERL_TRUE@am__append_277 = perl.la
 # Work-around for issues #41 and #42 - Perl 5.10 incorrectly introduced
 # __attribute__nonnull__(3) for Perl_load_module().
-@BUILD_PLUGIN_PERL_TRUE@@HAVE_BROKEN_PERL_LOAD_MODULE_TRUE@am__append_277 = -Wno-nonnull
-@BUILD_PLUGIN_PERL_TRUE@am__append_278 = "-dlopen" perl.la
-@BUILD_PLUGIN_PERL_TRUE@am__append_279 = perl.la
-@BUILD_PLUGIN_PF_TRUE@am__append_280 = pf.la
-@BUILD_PLUGIN_PF_TRUE@am__append_281 = "-dlopen" pf.la
-@BUILD_PLUGIN_PF_TRUE@am__append_282 = pf.la
-@BUILD_PLUGIN_PINBA_TRUE@am__append_283 = pinba.la
-@BUILD_PLUGIN_PINBA_TRUE@am__append_284 = "-dlopen" pinba.la
-@BUILD_PLUGIN_PINBA_TRUE@am__append_285 = pinba.la
-@BUILD_PLUGIN_PING_TRUE@am__append_286 = ping.la
-@BUILD_PLUGIN_PING_TRUE@am__append_287 = "-dlopen" ping.la
-@BUILD_PLUGIN_PING_TRUE@am__append_288 = ping.la
-@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_289 = postgresql.la
-@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_290 = "-dlopen" postgresql.la
-@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_291 = postgresql.la
-@BUILD_PLUGIN_POWERDNS_TRUE@am__append_292 = powerdns.la
-@BUILD_PLUGIN_POWERDNS_TRUE@am__append_293 = "-dlopen" powerdns.la
-@BUILD_PLUGIN_POWERDNS_TRUE@am__append_294 = powerdns.la
-@BUILD_PLUGIN_PYTHON_TRUE@am__append_295 = python.la
-@BUILD_PLUGIN_PYTHON_TRUE@@COMPILER_IS_GCC_TRUE@am__append_296 = -fno-strict-aliasing -Wno-strict-aliasing
-@BUILD_PLUGIN_PYTHON_TRUE@am__append_297 = "-dlopen" python.la
-@BUILD_PLUGIN_PYTHON_TRUE@am__append_298 = python.la
-@BUILD_PLUGIN_PROCESSES_TRUE@am__append_299 = processes.la
-@BUILD_PLUGIN_PROCESSES_TRUE@am__append_300 = "-dlopen" processes.la
-@BUILD_PLUGIN_PROCESSES_TRUE@am__append_301 = processes.la
-@BUILD_PLUGIN_PROCESSES_TRUE@@BUILD_WITH_LIBKVM_GETPROCS_TRUE@am__append_302 = -lkvm
-@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_303 = protocols.la
-@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_304 = "-dlopen" protocols.la
-@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_305 = protocols.la
-@BUILD_PLUGIN_REDIS_TRUE@am__append_306 = redis.la
-@BUILD_PLUGIN_REDIS_TRUE@am__append_307 = "-dlopen" redis.la
-@BUILD_PLUGIN_REDIS_TRUE@am__append_308 = redis.la
-@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_309 = routeros.la
-@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_310 = "-dlopen" routeros.la
-@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_311 = routeros.la
-@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_312 = rrdcached.la
-@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_313 = "-dlopen" rrdcached.la
-@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_314 = rrdcached.la
-@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_315 = rrdtool.la
-@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_316 = "-dlopen" rrdtool.la
-@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_317 = rrdtool.la
-@BUILD_PLUGIN_SENSORS_TRUE@am__append_318 = sensors.la
-@BUILD_PLUGIN_SENSORS_TRUE@am__append_319 = "-dlopen" sensors.la
-@BUILD_PLUGIN_SENSORS_TRUE@am__append_320 = sensors.la
-@BUILD_PLUGIN_SERIAL_TRUE@am__append_321 = serial.la
-@BUILD_PLUGIN_SERIAL_TRUE@am__append_322 = "-dlopen" serial.la
-@BUILD_PLUGIN_SERIAL_TRUE@am__append_323 = serial.la
-@BUILD_PLUGIN_SIGROK_TRUE@am__append_324 = sigrok.la
-@BUILD_PLUGIN_SIGROK_TRUE@am__append_325 = "-dlopen" sigrok.la
-@BUILD_PLUGIN_SIGROK_TRUE@am__append_326 = sigrok.la
-@BUILD_PLUGIN_SNMP_TRUE@am__append_327 = snmp.la
-@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBNETSNMP_TRUE@am__append_328 = $(BUILD_WITH_LIBSNMP_CFLAGS)
-@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBNETSNMP_TRUE@am__append_329 = $(BUILD_WITH_LIBSNMP_LIBS)
-@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_330 = -lpthread
-@BUILD_PLUGIN_SNMP_TRUE@am__append_331 = "-dlopen" snmp.la
-@BUILD_PLUGIN_SNMP_TRUE@am__append_332 = snmp.la
-@BUILD_PLUGIN_STATSD_TRUE@am__append_333 = statsd.la
-@BUILD_PLUGIN_STATSD_TRUE@am__append_334 = "-dlopen" statsd.la
-@BUILD_PLUGIN_STATSD_TRUE@am__append_335 = statsd.la
-@BUILD_PLUGIN_SWAP_TRUE@am__append_336 = swap.la
-@BUILD_PLUGIN_SWAP_TRUE@am__append_337 = "-dlopen" swap.la
-@BUILD_PLUGIN_SWAP_TRUE@am__append_338 = swap.la
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_339 = -lkstat
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_340 = -ldevinfo
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBKVM_GETSWAPINFO_TRUE@am__append_341 = -lkvm
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_342 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_343 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_344 = -lperfstat
-@BUILD_PLUGIN_SYSLOG_TRUE@am__append_345 = syslog.la
-@BUILD_PLUGIN_SYSLOG_TRUE@am__append_346 = "-dlopen" syslog.la
-@BUILD_PLUGIN_SYSLOG_TRUE@am__append_347 = syslog.la
-@BUILD_PLUGIN_TABLE_TRUE@am__append_348 = table.la
-@BUILD_PLUGIN_TABLE_TRUE@am__append_349 = "-dlopen" table.la
-@BUILD_PLUGIN_TABLE_TRUE@am__append_350 = table.la
-@BUILD_PLUGIN_TAIL_TRUE@am__append_351 = tail.la
-@BUILD_PLUGIN_TAIL_TRUE@am__append_352 = "-dlopen" tail.la
-@BUILD_PLUGIN_TAIL_TRUE@am__append_353 = tail.la
-@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_354 = tail_csv.la
-@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_355 = "-dlopen" tail_csv.la
-@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_356 = tail_csv.la
-@BUILD_PLUGIN_TAPE_TRUE@am__append_357 = tape.la
-@BUILD_PLUGIN_TAPE_TRUE@am__append_358 = "-dlopen" tape.la
-@BUILD_PLUGIN_TAPE_TRUE@am__append_359 = tape.la
-@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_360 = target_notification.la
-@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_361 = "-dlopen" target_notification.la
-@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_362 = target_notification.la
-@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_363 = target_replace.la
-@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_364 = "-dlopen" target_replace.la
-@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_365 = target_replace.la
-@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_366 = target_scale.la
-@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_367 = "-dlopen" target_scale.la
-@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_368 = target_scale.la
-@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_369 = target_set.la
-@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_370 = "-dlopen" target_set.la
-@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_371 = target_set.la
-@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_372 = target_v5upgrade.la
-@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_373 = "-dlopen" target_v5upgrade.la
-@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_374 = target_v5upgrade.la
-@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_375 = tcpconns.la
-@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_376 = "-dlopen" tcpconns.la
-@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_377 = tcpconns.la
-@BUILD_PLUGIN_TCPCONNS_TRUE@@BUILD_WITH_LIBKVM_NLIST_TRUE@am__append_378 = -lkvm
-@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_379 = teamspeak2.la
-@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_380 = "-dlopen" teamspeak2.la
-@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_381 = teamspeak2.la
-@BUILD_PLUGIN_TED_TRUE@am__append_382 = ted.la
-@BUILD_PLUGIN_TED_TRUE@am__append_383 = "-dlopen" ted.la
-@BUILD_PLUGIN_TED_TRUE@am__append_384 = ted.la
-@BUILD_PLUGIN_THERMAL_TRUE@am__append_385 = thermal.la
-@BUILD_PLUGIN_THERMAL_TRUE@am__append_386 = "-dlopen" thermal.la
-@BUILD_PLUGIN_THERMAL_TRUE@am__append_387 = thermal.la
-@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_388 = threshold.la
-@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_389 = "-dlopen" threshold.la
-@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_390 = threshold.la
-@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_391 = tokyotyrant.la
-@BUILD_PLUGIN_TOKYOTYRANT_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_392 = -lsocket
-@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_393 = "-dlopen" tokyotyrant.la
-@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_394 = tokyotyrant.la
-@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_395 = unixsock.la
-@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_396 = "-dlopen" unixsock.la
-@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_397 = unixsock.la
-@BUILD_PLUGIN_UPTIME_TRUE@am__append_398 = uptime.la
-@BUILD_PLUGIN_UPTIME_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_399 = -lkstat
-@BUILD_PLUGIN_UPTIME_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_400 = -lperfstat
-@BUILD_PLUGIN_UPTIME_TRUE@am__append_401 = "-dlopen" uptime.la
-@BUILD_PLUGIN_UPTIME_TRUE@am__append_402 = uptime.la
-@BUILD_PLUGIN_USERS_TRUE@am__append_403 = users.la
-@BUILD_PLUGIN_USERS_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_404 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
-@BUILD_PLUGIN_USERS_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_405 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
-@BUILD_PLUGIN_USERS_TRUE@am__append_406 = "-dlopen" users.la
-@BUILD_PLUGIN_USERS_TRUE@am__append_407 = users.la
-@BUILD_PLUGIN_UUID_TRUE@am__append_408 = uuid.la
-@BUILD_PLUGIN_UUID_TRUE@am__append_409 = "-dlopen" uuid.la
-@BUILD_PLUGIN_UUID_TRUE@am__append_410 = uuid.la
-@BUILD_PLUGIN_MIC_TRUE@am__append_411 = mic.la
-@BUILD_PLUGIN_MIC_TRUE@am__append_412 = "-dlopen" mic.la
-@BUILD_PLUGIN_MIC_TRUE@am__append_413 = mic.la
-@BUILD_PLUGIN_VARNISH_TRUE@am__append_414 = varnish.la
-@BUILD_PLUGIN_VARNISH_TRUE@am__append_415 = "-dlopen" varnish.la
-@BUILD_PLUGIN_VARNISH_TRUE@am__append_416 = varnish.la
-@BUILD_PLUGIN_VMEM_TRUE@am__append_417 = vmem.la
-@BUILD_PLUGIN_VMEM_TRUE@am__append_418 = "-dlopen" vmem.la
-@BUILD_PLUGIN_VMEM_TRUE@am__append_419 = vmem.la
-@BUILD_PLUGIN_VSERVER_TRUE@am__append_420 = vserver.la
-@BUILD_PLUGIN_VSERVER_TRUE@am__append_421 = "-dlopen" vserver.la
-@BUILD_PLUGIN_VSERVER_TRUE@am__append_422 = vserver.la
-@BUILD_PLUGIN_WIRELESS_TRUE@am__append_423 = wireless.la
-@BUILD_PLUGIN_WIRELESS_TRUE@am__append_424 = "-dlopen" wireless.la
-@BUILD_PLUGIN_WIRELESS_TRUE@am__append_425 = wireless.la
-@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_426 = write_graphite.la
-@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_427 = "-dlopen" write_graphite.la
-@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_428 = write_graphite.la
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_429 = write_http.la
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_430 = "-dlopen" write_http.la
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_431 = $(BUILD_WITH_LIBCURL_CFLAGS)
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_432 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_433 = write_http.la
-@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_434 = write_mongodb.la
-@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_435 = "-dlopen" write_mongodb.la
-@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_436 = write_mongodb.la
-@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_437 = write_redis.la
-@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_438 = "-dlopen" write_redis.la
-@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_439 = write_redis.la
-@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_440 = write_riemann.la
-@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_441 = "-dlopen" write_riemann.la
-@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_442 = write_riemann.la
-@BUILD_PLUGIN_XMMS_TRUE@am__append_443 = xmms.la
-@BUILD_PLUGIN_XMMS_TRUE@am__append_444 = "-dlopen" xmms.la
-@BUILD_PLUGIN_XMMS_TRUE@am__append_445 = xmms.la
-@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_446 = zfs_arc.la
-@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_447 = "-dlopen" zfs_arc.la
-@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_448 = zfs_arc.la
-@HAVE_PROTOC_C_TRUE@am__append_449 = pinba.pb-c.c pinba.pb-c.h \
-@HAVE_PROTOC_C_TRUE@	riemann.pb-c.c riemann.pb-c.h
-@HAVE_PROTOC_C_TRUE@am__append_450 = pinba.pb-c.c pinba.pb-c.h \
-@HAVE_PROTOC_C_TRUE@	riemann.pb-c.c riemann.pb-c.h
-@BUILD_FEATURE_DEBUG_TRUE@am__append_451 = utils_vl_lookup_test
+@BUILD_PLUGIN_PERL_TRUE@@HAVE_BROKEN_PERL_LOAD_MODULE_TRUE@am__append_278 = -Wno-nonnull
+@BUILD_PLUGIN_PERL_TRUE@am__append_279 = "-dlopen" perl.la
+@BUILD_PLUGIN_PERL_TRUE@am__append_280 = perl.la
+@BUILD_PLUGIN_PF_TRUE@am__append_281 = pf.la
+@BUILD_PLUGIN_PF_TRUE@am__append_282 = "-dlopen" pf.la
+@BUILD_PLUGIN_PF_TRUE@am__append_283 = pf.la
+@BUILD_PLUGIN_PINBA_TRUE@am__append_284 = pinba.la
+@BUILD_PLUGIN_PINBA_TRUE@am__append_285 = "-dlopen" pinba.la
+@BUILD_PLUGIN_PINBA_TRUE@am__append_286 = pinba.la
+@BUILD_PLUGIN_PING_TRUE@am__append_287 = ping.la
+@BUILD_PLUGIN_PING_TRUE@am__append_288 = "-dlopen" ping.la
+@BUILD_PLUGIN_PING_TRUE@am__append_289 = ping.la
+@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_290 = postgresql.la
+@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_291 = "-dlopen" postgresql.la
+@BUILD_PLUGIN_POSTGRESQL_TRUE@am__append_292 = postgresql.la
+@BUILD_PLUGIN_POWERDNS_TRUE@am__append_293 = powerdns.la
+@BUILD_PLUGIN_POWERDNS_TRUE@am__append_294 = "-dlopen" powerdns.la
+@BUILD_PLUGIN_POWERDNS_TRUE@am__append_295 = powerdns.la
+@BUILD_PLUGIN_PYTHON_TRUE@am__append_296 = python.la
+@BUILD_PLUGIN_PYTHON_TRUE@@COMPILER_IS_GCC_TRUE@am__append_297 = -fno-strict-aliasing -Wno-strict-aliasing
+@BUILD_PLUGIN_PYTHON_TRUE@am__append_298 = "-dlopen" python.la
+@BUILD_PLUGIN_PYTHON_TRUE@am__append_299 = python.la
+@BUILD_PLUGIN_PROCESSES_TRUE@am__append_300 = processes.la
+@BUILD_PLUGIN_PROCESSES_TRUE@am__append_301 = "-dlopen" processes.la
+@BUILD_PLUGIN_PROCESSES_TRUE@am__append_302 = processes.la
+@BUILD_PLUGIN_PROCESSES_TRUE@@BUILD_WITH_LIBKVM_GETPROCS_TRUE@am__append_303 = -lkvm
+@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_304 = protocols.la
+@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_305 = "-dlopen" protocols.la
+@BUILD_PLUGIN_PROTOCOLS_TRUE@am__append_306 = protocols.la
+@BUILD_PLUGIN_REDIS_TRUE@am__append_307 = redis.la
+@BUILD_PLUGIN_REDIS_TRUE@am__append_308 = "-dlopen" redis.la
+@BUILD_PLUGIN_REDIS_TRUE@am__append_309 = redis.la
+@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_310 = routeros.la
+@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_311 = "-dlopen" routeros.la
+@BUILD_PLUGIN_ROUTEROS_TRUE@am__append_312 = routeros.la
+@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_313 = rrdcached.la
+@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_314 = "-dlopen" rrdcached.la
+@BUILD_PLUGIN_RRDCACHED_TRUE@am__append_315 = rrdcached.la
+@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_316 = rrdtool.la
+@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_317 = "-dlopen" rrdtool.la
+@BUILD_PLUGIN_RRDTOOL_TRUE@am__append_318 = rrdtool.la
+@BUILD_PLUGIN_SENSORS_TRUE@am__append_319 = sensors.la
+@BUILD_PLUGIN_SENSORS_TRUE@am__append_320 = "-dlopen" sensors.la
+@BUILD_PLUGIN_SENSORS_TRUE@am__append_321 = sensors.la
+@BUILD_PLUGIN_SERIAL_TRUE@am__append_322 = serial.la
+@BUILD_PLUGIN_SERIAL_TRUE@am__append_323 = "-dlopen" serial.la
+@BUILD_PLUGIN_SERIAL_TRUE@am__append_324 = serial.la
+@BUILD_PLUGIN_SIGROK_TRUE@am__append_325 = sigrok.la
+@BUILD_PLUGIN_SIGROK_TRUE@am__append_326 = "-dlopen" sigrok.la
+@BUILD_PLUGIN_SIGROK_TRUE@am__append_327 = sigrok.la
+@BUILD_PLUGIN_SNMP_TRUE@am__append_328 = snmp.la
+@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBNETSNMP_TRUE@am__append_329 = $(BUILD_WITH_LIBSNMP_CFLAGS)
+@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBNETSNMP_TRUE@am__append_330 = $(BUILD_WITH_LIBSNMP_LIBS)
+@BUILD_PLUGIN_SNMP_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_331 = -lpthread
+@BUILD_PLUGIN_SNMP_TRUE@am__append_332 = "-dlopen" snmp.la
+@BUILD_PLUGIN_SNMP_TRUE@am__append_333 = snmp.la
+@BUILD_PLUGIN_STATSD_TRUE@am__append_334 = statsd.la
+@BUILD_PLUGIN_STATSD_TRUE@am__append_335 = "-dlopen" statsd.la
+@BUILD_PLUGIN_STATSD_TRUE@am__append_336 = statsd.la
+@BUILD_PLUGIN_SWAP_TRUE@am__append_337 = swap.la
+@BUILD_PLUGIN_SWAP_TRUE@am__append_338 = "-dlopen" swap.la
+@BUILD_PLUGIN_SWAP_TRUE@am__append_339 = swap.la
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_340 = -lkstat
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_341 = -ldevinfo
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBKVM_GETSWAPINFO_TRUE@am__append_342 = -lkvm
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_343 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_344 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_SWAP_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_345 = -lperfstat
+@BUILD_PLUGIN_SYSLOG_TRUE@am__append_346 = syslog.la
+@BUILD_PLUGIN_SYSLOG_TRUE@am__append_347 = "-dlopen" syslog.la
+@BUILD_PLUGIN_SYSLOG_TRUE@am__append_348 = syslog.la
+@BUILD_PLUGIN_TABLE_TRUE@am__append_349 = table.la
+@BUILD_PLUGIN_TABLE_TRUE@am__append_350 = "-dlopen" table.la
+@BUILD_PLUGIN_TABLE_TRUE@am__append_351 = table.la
+@BUILD_PLUGIN_TAIL_TRUE@am__append_352 = tail.la
+@BUILD_PLUGIN_TAIL_TRUE@am__append_353 = "-dlopen" tail.la
+@BUILD_PLUGIN_TAIL_TRUE@am__append_354 = tail.la
+@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_355 = tail_csv.la
+@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_356 = "-dlopen" tail_csv.la
+@BUILD_PLUGIN_TAIL_CSV_TRUE@am__append_357 = tail_csv.la
+@BUILD_PLUGIN_TAPE_TRUE@am__append_358 = tape.la
+@BUILD_PLUGIN_TAPE_TRUE@am__append_359 = "-dlopen" tape.la
+@BUILD_PLUGIN_TAPE_TRUE@am__append_360 = tape.la
+@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_361 = target_notification.la
+@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_362 = "-dlopen" target_notification.la
+@BUILD_PLUGIN_TARGET_NOTIFICATION_TRUE@am__append_363 = target_notification.la
+@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_364 = target_replace.la
+@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_365 = "-dlopen" target_replace.la
+@BUILD_PLUGIN_TARGET_REPLACE_TRUE@am__append_366 = target_replace.la
+@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_367 = target_scale.la
+@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_368 = "-dlopen" target_scale.la
+@BUILD_PLUGIN_TARGET_SCALE_TRUE@am__append_369 = target_scale.la
+@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_370 = target_set.la
+@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_371 = "-dlopen" target_set.la
+@BUILD_PLUGIN_TARGET_SET_TRUE@am__append_372 = target_set.la
+@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_373 = target_v5upgrade.la
+@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_374 = "-dlopen" target_v5upgrade.la
+@BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@am__append_375 = target_v5upgrade.la
+@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_376 = tcpconns.la
+@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_377 = "-dlopen" tcpconns.la
+@BUILD_PLUGIN_TCPCONNS_TRUE@am__append_378 = tcpconns.la
+@BUILD_PLUGIN_TCPCONNS_TRUE@@BUILD_WITH_LIBKVM_NLIST_TRUE@am__append_379 = -lkvm
+@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_380 = teamspeak2.la
+@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_381 = "-dlopen" teamspeak2.la
+@BUILD_PLUGIN_TEAMSPEAK2_TRUE@am__append_382 = teamspeak2.la
+@BUILD_PLUGIN_TED_TRUE@am__append_383 = ted.la
+@BUILD_PLUGIN_TED_TRUE@am__append_384 = "-dlopen" ted.la
+@BUILD_PLUGIN_TED_TRUE@am__append_385 = ted.la
+@BUILD_PLUGIN_THERMAL_TRUE@am__append_386 = thermal.la
+@BUILD_PLUGIN_THERMAL_TRUE@am__append_387 = "-dlopen" thermal.la
+@BUILD_PLUGIN_THERMAL_TRUE@am__append_388 = thermal.la
+@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_389 = threshold.la
+@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_390 = "-dlopen" threshold.la
+@BUILD_PLUGIN_THRESHOLD_TRUE@am__append_391 = threshold.la
+@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_392 = tokyotyrant.la
+@BUILD_PLUGIN_TOKYOTYRANT_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_393 = -lsocket
+@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_394 = "-dlopen" tokyotyrant.la
+@BUILD_PLUGIN_TOKYOTYRANT_TRUE@am__append_395 = tokyotyrant.la
+@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_396 = unixsock.la
+@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_397 = "-dlopen" unixsock.la
+@BUILD_PLUGIN_UNIXSOCK_TRUE@am__append_398 = unixsock.la
+@BUILD_PLUGIN_UPTIME_TRUE@am__append_399 = uptime.la
+@BUILD_PLUGIN_UPTIME_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_400 = -lkstat
+@BUILD_PLUGIN_UPTIME_TRUE@@BUILD_WITH_PERFSTAT_TRUE@am__append_401 = -lperfstat
+@BUILD_PLUGIN_UPTIME_TRUE@am__append_402 = "-dlopen" uptime.la
+@BUILD_PLUGIN_UPTIME_TRUE@am__append_403 = uptime.la
+@BUILD_PLUGIN_USERS_TRUE@am__append_404 = users.la
+@BUILD_PLUGIN_USERS_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_405 = $(BUILD_WITH_LIBSTATGRAB_CFLAGS)
+@BUILD_PLUGIN_USERS_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_406 = $(BUILD_WITH_LIBSTATGRAB_LDFLAGS)
+@BUILD_PLUGIN_USERS_TRUE@am__append_407 = "-dlopen" users.la
+@BUILD_PLUGIN_USERS_TRUE@am__append_408 = users.la
+@BUILD_PLUGIN_UUID_TRUE@am__append_409 = uuid.la
+@BUILD_PLUGIN_UUID_TRUE@am__append_410 = "-dlopen" uuid.la
+@BUILD_PLUGIN_UUID_TRUE@am__append_411 = uuid.la
+@BUILD_PLUGIN_MIC_TRUE@am__append_412 = mic.la
+@BUILD_PLUGIN_MIC_TRUE@am__append_413 = "-dlopen" mic.la
+@BUILD_PLUGIN_MIC_TRUE@am__append_414 = mic.la
+@BUILD_PLUGIN_VARNISH_TRUE@am__append_415 = varnish.la
+@BUILD_PLUGIN_VARNISH_TRUE@am__append_416 = "-dlopen" varnish.la
+@BUILD_PLUGIN_VARNISH_TRUE@am__append_417 = varnish.la
+@BUILD_PLUGIN_VMEM_TRUE@am__append_418 = vmem.la
+@BUILD_PLUGIN_VMEM_TRUE@am__append_419 = "-dlopen" vmem.la
+@BUILD_PLUGIN_VMEM_TRUE@am__append_420 = vmem.la
+@BUILD_PLUGIN_VSERVER_TRUE@am__append_421 = vserver.la
+@BUILD_PLUGIN_VSERVER_TRUE@am__append_422 = "-dlopen" vserver.la
+@BUILD_PLUGIN_VSERVER_TRUE@am__append_423 = vserver.la
+@BUILD_PLUGIN_WIRELESS_TRUE@am__append_424 = wireless.la
+@BUILD_PLUGIN_WIRELESS_TRUE@am__append_425 = "-dlopen" wireless.la
+@BUILD_PLUGIN_WIRELESS_TRUE@am__append_426 = wireless.la
+@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_427 = write_graphite.la
+@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_428 = "-dlopen" write_graphite.la
+@BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@am__append_429 = write_graphite.la
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_430 = write_http.la
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_431 = "-dlopen" write_http.la
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_432 = $(BUILD_WITH_LIBCURL_CFLAGS)
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_433 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@am__append_434 = write_http.la
+@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_435 = write_mongodb.la
+@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_436 = "-dlopen" write_mongodb.la
+@BUILD_PLUGIN_WRITE_MONGODB_TRUE@am__append_437 = write_mongodb.la
+@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_438 = write_redis.la
+@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_439 = "-dlopen" write_redis.la
+@BUILD_PLUGIN_WRITE_REDIS_TRUE@am__append_440 = write_redis.la
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_441 = write_riemann.la
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_442 = "-dlopen" write_riemann.la
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_443 = write_riemann.la
+@BUILD_PLUGIN_XMMS_TRUE@am__append_444 = xmms.la
+@BUILD_PLUGIN_XMMS_TRUE@am__append_445 = "-dlopen" xmms.la
+@BUILD_PLUGIN_XMMS_TRUE@am__append_446 = xmms.la
+@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_447 = zfs_arc.la
+@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_448 = "-dlopen" zfs_arc.la
+@BUILD_PLUGIN_ZFS_ARC_TRUE@am__append_449 = zfs_arc.la
+@BUILD_PLUGIN_PINBA_TRUE@am__append_450 = pinba.pb-c.c pinba.pb-c.h
+@BUILD_PLUGIN_PINBA_TRUE@am__append_451 = pinba.pb-c.c pinba.pb-c.h
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_452 = riemann.pb-c.c riemann.pb-c.h
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@am__append_453 = riemann.pb-c.c riemann.pb-c.h
+@BUILD_FEATURE_DEBUG_TRUE@am__append_454 = utils_vl_lookup_test
 subdir = src
 DIST_COMMON = $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
 	$(srcdir)/config.h.in $(srcdir)/collectd.conf.in \
 	$(top_srcdir)/libltdl/config/depcomp $(dist_man_MANS)
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/configure.ac
@@ -602,17 +603,18 @@
 	$@
 @BUILD_PLUGIN_AGGREGATION_TRUE@am_aggregation_la_rpath = -rpath \
 @BUILD_PLUGIN_AGGREGATION_TRUE@	$(pkglibdir)
 am__DEPENDENCIES_1 =
 @BUILD_PLUGIN_AMQP_TRUE@amqp_la_DEPENDENCIES = $(am__DEPENDENCIES_1)
 am__amqp_la_SOURCES_DIST = amqp.c utils_cmd_putval.c \
-	utils_cmd_putval.h utils_format_graphite.c \
-	utils_format_graphite.h utils_format_json.c \
-	utils_format_json.h
+	utils_cmd_putval.h utils_parse_option.c utils_parse_option.h \
+	utils_format_graphite.c utils_format_graphite.h \
+	utils_format_json.c utils_format_json.h
 @BUILD_PLUGIN_AMQP_TRUE@am_amqp_la_OBJECTS = amqp_la-amqp.lo \
 @BUILD_PLUGIN_AMQP_TRUE@	amqp_la-utils_cmd_putval.lo \
+@BUILD_PLUGIN_AMQP_TRUE@	amqp_la-utils_parse_option.lo \
 @BUILD_PLUGIN_AMQP_TRUE@	amqp_la-utils_format_graphite.lo \
 @BUILD_PLUGIN_AMQP_TRUE@	amqp_la-utils_format_json.lo
 amqp_la_OBJECTS = $(am_amqp_la_OBJECTS)
 amqp_la_LINK = $(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(amqp_la_LDFLAGS) $(LDFLAGS) -o $@
@@ -2102,12 +2104,13 @@
 BUILD_WITH_LIBRABBITMQ_LDFLAGS = @BUILD_WITH_LIBRABBITMQ_LDFLAGS@
 BUILD_WITH_LIBRABBITMQ_LIBS = @BUILD_WITH_LIBRABBITMQ_LIBS@
 BUILD_WITH_LIBROUTEROS_CPPFLAGS = @BUILD_WITH_LIBROUTEROS_CPPFLAGS@
 BUILD_WITH_LIBROUTEROS_LDFLAGS = @BUILD_WITH_LIBROUTEROS_LDFLAGS@
 BUILD_WITH_LIBRRD_CFLAGS = @BUILD_WITH_LIBRRD_CFLAGS@
 BUILD_WITH_LIBRRD_LDFLAGS = @BUILD_WITH_LIBRRD_LDFLAGS@
+BUILD_WITH_LIBRRD_LIBS = @BUILD_WITH_LIBRRD_LIBS@
 BUILD_WITH_LIBSENSORS_CFLAGS = @BUILD_WITH_LIBSENSORS_CFLAGS@
 BUILD_WITH_LIBSENSORS_LDFLAGS = @BUILD_WITH_LIBSENSORS_LDFLAGS@
 BUILD_WITH_LIBSIGROK_CFLAGS = @BUILD_WITH_LIBSIGROK_CFLAGS@
 BUILD_WITH_LIBSIGROK_LDFLAGS = @BUILD_WITH_LIBSIGROK_LDFLAGS@
 BUILD_WITH_LIBSNMP_CFLAGS = @BUILD_WITH_LIBSNMP_CFLAGS@
 BUILD_WITH_LIBSNMP_LIBS = @BUILD_WITH_LIBSNMP_LIBS@
@@ -2247,12 +2250,14 @@
 PERL_CFLAGS = @PERL_CFLAGS@
 PERL_LIBS = @PERL_LIBS@
 PKG_CONFIG = @PKG_CONFIG@
 PKG_CONFIG_LIBDIR = @PKG_CONFIG_LIBDIR@
 PKG_CONFIG_PATH = @PKG_CONFIG_PATH@
 RANLIB = @RANLIB@
+RRD_CFLAGS = @RRD_CFLAGS@
+RRD_LIBS = @RRD_LIBS@
 SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
 YACC = @YACC@
@@ -2347,177 +2352,178 @@
 collectd_CPPFLAGS = $(AM_CPPFLAGS) $(LTDLINCL)
 collectd_CFLAGS = $(AM_CFLAGS) $(am__append_11)
 collectd_LDFLAGS = -export-dynamic $(am__append_10)
 collectd_LDADD = -lm $(am__append_3) $(am__append_4) $(am__append_5) \
 	$(am__append_6) $(am__append_7) $(am__append_8) \
 	$(am__append_9) $(am__append_12) $(am__append_13) \
-	$(am__append_15) $(am__append_24) $(am__append_27) \
-	$(am__append_30) $(am__append_36) $(am__append_39) \
-	$(am__append_42) $(am__append_45) $(am__append_49) \
-	$(am__append_52) $(am__append_55) $(am__append_58) \
-	$(am__append_62) $(am__append_70) $(am__append_73) \
-	$(am__append_76) $(am__append_79) $(am__append_86) \
-	$(am__append_89) $(am__append_92) $(am__append_95) \
-	$(am__append_104) $(am__append_107) $(am__append_110) \
-	$(am__append_113) $(am__append_116) $(am__append_119) \
-	$(am__append_122) $(am__append_125) $(am__append_129) \
-	$(am__append_132) $(am__append_140) $(am__append_143) \
-	$(am__append_146) $(am__append_149) $(am__append_152) \
-	$(am__append_155) $(am__append_158) $(am__append_164) \
-	$(am__append_167) $(am__append_170) $(am__append_173) \
-	$(am__append_176) $(am__append_179) $(am__append_182) \
-	$(am__append_185) $(am__append_188) $(am__append_192) \
-	$(am__append_195) $(am__append_198) $(am__append_202) \
-	$(am__append_205) $(am__append_213) $(am__append_216) \
-	$(am__append_219) $(am__append_224) $(am__append_227) \
-	$(am__append_234) $(am__append_237) $(am__append_240) \
-	$(am__append_245) $(am__append_248) $(am__append_251) \
-	$(am__append_255) $(am__append_258) $(am__append_261) \
-	$(am__append_265) $(am__append_268) $(am__append_271) \
-	$(am__append_274) $(am__append_278) $(am__append_281) \
-	$(am__append_284) $(am__append_287) $(am__append_290) \
-	$(am__append_293) $(am__append_297) $(am__append_300) \
-	$(am__append_304) $(am__append_307) $(am__append_310) \
-	$(am__append_313) $(am__append_316) $(am__append_319) \
-	$(am__append_322) $(am__append_325) $(am__append_331) \
-	$(am__append_334) $(am__append_337) $(am__append_346) \
-	$(am__append_349) $(am__append_352) $(am__append_355) \
-	$(am__append_358) $(am__append_361) $(am__append_364) \
-	$(am__append_367) $(am__append_370) $(am__append_373) \
-	$(am__append_376) $(am__append_380) $(am__append_383) \
-	$(am__append_386) $(am__append_389) $(am__append_393) \
-	$(am__append_396) $(am__append_401) $(am__append_406) \
-	$(am__append_409) $(am__append_412) $(am__append_415) \
-	$(am__append_418) $(am__append_421) $(am__append_424) \
-	$(am__append_427) $(am__append_430) $(am__append_435) \
-	$(am__append_438) $(am__append_441) $(am__append_444) \
-	$(am__append_447)
-collectd_DEPENDENCIES = $(am__append_14) $(am__append_25) \
-	$(am__append_28) $(am__append_33) $(am__append_37) \
-	$(am__append_40) $(am__append_43) $(am__append_46) \
-	$(am__append_50) $(am__append_53) $(am__append_56) \
-	$(am__append_59) $(am__append_63) $(am__append_71) \
-	$(am__append_74) $(am__append_77) $(am__append_82) \
-	$(am__append_87) $(am__append_90) $(am__append_93) \
-	$(am__append_96) $(am__append_105) $(am__append_108) \
-	$(am__append_111) $(am__append_114) $(am__append_117) \
-	$(am__append_120) $(am__append_123) $(am__append_126) \
-	$(am__append_130) $(am__append_133) $(am__append_141) \
-	$(am__append_144) $(am__append_147) $(am__append_150) \
-	$(am__append_153) $(am__append_156) $(am__append_159) \
-	$(am__append_165) $(am__append_168) $(am__append_171) \
-	$(am__append_174) $(am__append_177) $(am__append_180) \
-	$(am__append_183) $(am__append_186) $(am__append_189) \
-	$(am__append_193) $(am__append_196) $(am__append_199) \
-	$(am__append_203) $(am__append_206) $(am__append_214) \
-	$(am__append_217) $(am__append_222) $(am__append_225) \
-	$(am__append_228) $(am__append_235) $(am__append_238) \
-	$(am__append_241) $(am__append_246) $(am__append_249) \
-	$(am__append_252) $(am__append_256) $(am__append_259) \
-	$(am__append_262) $(am__append_266) $(am__append_269) \
-	$(am__append_272) $(am__append_275) $(am__append_279) \
-	$(am__append_282) $(am__append_285) $(am__append_288) \
-	$(am__append_291) $(am__append_294) $(am__append_298) \
-	$(am__append_301) $(am__append_305) $(am__append_308) \
-	$(am__append_311) $(am__append_314) $(am__append_317) \
-	$(am__append_320) $(am__append_323) $(am__append_326) \
-	$(am__append_332) $(am__append_335) $(am__append_338) \
-	$(am__append_347) $(am__append_350) $(am__append_353) \
-	$(am__append_356) $(am__append_359) $(am__append_362) \
-	$(am__append_365) $(am__append_368) $(am__append_371) \
-	$(am__append_374) $(am__append_377) $(am__append_381) \
-	$(am__append_384) $(am__append_387) $(am__append_390) \
-	$(am__append_394) $(am__append_397) $(am__append_402) \
-	$(am__append_407) $(am__append_410) $(am__append_413) \
-	$(am__append_416) $(am__append_419) $(am__append_422) \
-	$(am__append_425) $(am__append_428) $(am__append_433) \
-	$(am__append_436) $(am__append_439) $(am__append_442) \
-	$(am__append_445) $(am__append_448)
-collectdmon_SOURCES = collectdmon.c
-collectdmon_CPPFLAGS = $(AM_CPPFLAGS)
-collectd_nagios_SOURCES = collectd-nagios.c
-collectd_nagios_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
-collectd_nagios_LDADD = $(am__append_16) $(am__append_17) \
-	libcollectdclient/libcollectdclient.la
-collectd_nagios_DEPENDENCIES = libcollectdclient/libcollectdclient.la
-collectdctl_SOURCES = collectdctl.c
-collectdctl_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
-collectdctl_LDADD = $(am__append_18) $(am__append_19) \
-	libcollectdclient/libcollectdclient.la
-collectdctl_DEPENDENCIES = libcollectdclient/libcollectdclient.la
-collectd_tg_SOURCES = collectd-tg.c \
-		      utils_heap.c utils_heap.h
-
-collectd_tg_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
-collectd_tg_LDADD = $(am__append_20) $(am__append_21) $(am__append_22) \
-	libcollectdclient/libcollectdclient.la
-collectd_tg_DEPENDENCIES = libcollectdclient/libcollectdclient.la
-pkglib_LTLIBRARIES = $(am__append_23) $(am__append_26) \
+	$(am__append_15) $(am__append_25) $(am__append_28) \
+	$(am__append_31) $(am__append_37) $(am__append_40) \
+	$(am__append_43) $(am__append_46) $(am__append_50) \
+	$(am__append_53) $(am__append_56) $(am__append_59) \
+	$(am__append_63) $(am__append_71) $(am__append_74) \
+	$(am__append_77) $(am__append_80) $(am__append_87) \
+	$(am__append_90) $(am__append_93) $(am__append_96) \
+	$(am__append_105) $(am__append_108) $(am__append_111) \
+	$(am__append_114) $(am__append_117) $(am__append_120) \
+	$(am__append_123) $(am__append_126) $(am__append_130) \
+	$(am__append_133) $(am__append_141) $(am__append_144) \
+	$(am__append_147) $(am__append_150) $(am__append_153) \
+	$(am__append_156) $(am__append_159) $(am__append_165) \
+	$(am__append_168) $(am__append_171) $(am__append_174) \
+	$(am__append_177) $(am__append_180) $(am__append_183) \
+	$(am__append_186) $(am__append_189) $(am__append_193) \
+	$(am__append_196) $(am__append_199) $(am__append_203) \
+	$(am__append_206) $(am__append_214) $(am__append_217) \
+	$(am__append_220) $(am__append_225) $(am__append_228) \
+	$(am__append_235) $(am__append_238) $(am__append_241) \
+	$(am__append_246) $(am__append_249) $(am__append_252) \
+	$(am__append_256) $(am__append_259) $(am__append_262) \
+	$(am__append_266) $(am__append_269) $(am__append_272) \
+	$(am__append_275) $(am__append_279) $(am__append_282) \
+	$(am__append_285) $(am__append_288) $(am__append_291) \
+	$(am__append_294) $(am__append_298) $(am__append_301) \
+	$(am__append_305) $(am__append_308) $(am__append_311) \
+	$(am__append_314) $(am__append_317) $(am__append_320) \
+	$(am__append_323) $(am__append_326) $(am__append_332) \
+	$(am__append_335) $(am__append_338) $(am__append_347) \
+	$(am__append_350) $(am__append_353) $(am__append_356) \
+	$(am__append_359) $(am__append_362) $(am__append_365) \
+	$(am__append_368) $(am__append_371) $(am__append_374) \
+	$(am__append_377) $(am__append_381) $(am__append_384) \
+	$(am__append_387) $(am__append_390) $(am__append_394) \
+	$(am__append_397) $(am__append_402) $(am__append_407) \
+	$(am__append_410) $(am__append_413) $(am__append_416) \
+	$(am__append_419) $(am__append_422) $(am__append_425) \
+	$(am__append_428) $(am__append_431) $(am__append_436) \
+	$(am__append_439) $(am__append_442) $(am__append_445) \
+	$(am__append_448)
+collectd_DEPENDENCIES = $(am__append_14) $(am__append_26) \
 	$(am__append_29) $(am__append_34) $(am__append_38) \
 	$(am__append_41) $(am__append_44) $(am__append_47) \
 	$(am__append_51) $(am__append_54) $(am__append_57) \
 	$(am__append_60) $(am__append_64) $(am__append_72) \
 	$(am__append_75) $(am__append_78) $(am__append_83) \
 	$(am__append_88) $(am__append_91) $(am__append_94) \
 	$(am__append_97) $(am__append_106) $(am__append_109) \
 	$(am__append_112) $(am__append_115) $(am__append_118) \
 	$(am__append_121) $(am__append_124) $(am__append_127) \
-	$(am__append_131) $(am__append_139) $(am__append_142) \
+	$(am__append_131) $(am__append_134) $(am__append_142) \
 	$(am__append_145) $(am__append_148) $(am__append_151) \
-	$(am__append_154) $(am__append_157) $(am__append_163) \
+	$(am__append_154) $(am__append_157) $(am__append_160) \
 	$(am__append_166) $(am__append_169) $(am__append_172) \
 	$(am__append_175) $(am__append_178) $(am__append_181) \
 	$(am__append_184) $(am__append_187) $(am__append_190) \
 	$(am__append_194) $(am__append_197) $(am__append_200) \
-	$(am__append_204) $(am__append_212) $(am__append_215) \
+	$(am__append_204) $(am__append_207) $(am__append_215) \
 	$(am__append_218) $(am__append_223) $(am__append_226) \
 	$(am__append_229) $(am__append_236) $(am__append_239) \
 	$(am__append_242) $(am__append_247) $(am__append_250) \
 	$(am__append_253) $(am__append_257) $(am__append_260) \
 	$(am__append_263) $(am__append_267) $(am__append_270) \
 	$(am__append_273) $(am__append_276) $(am__append_280) \
 	$(am__append_283) $(am__append_286) $(am__append_289) \
 	$(am__append_292) $(am__append_295) $(am__append_299) \
-	$(am__append_303) $(am__append_306) $(am__append_309) \
+	$(am__append_302) $(am__append_306) $(am__append_309) \
 	$(am__append_312) $(am__append_315) $(am__append_318) \
 	$(am__append_321) $(am__append_324) $(am__append_327) \
-	$(am__append_333) $(am__append_336) $(am__append_345) \
+	$(am__append_333) $(am__append_336) $(am__append_339) \
 	$(am__append_348) $(am__append_351) $(am__append_354) \
 	$(am__append_357) $(am__append_360) $(am__append_363) \
 	$(am__append_366) $(am__append_369) $(am__append_372) \
-	$(am__append_375) $(am__append_379) $(am__append_382) \
+	$(am__append_375) $(am__append_378) $(am__append_382) \
 	$(am__append_385) $(am__append_388) $(am__append_391) \
 	$(am__append_395) $(am__append_398) $(am__append_403) \
 	$(am__append_408) $(am__append_411) $(am__append_414) \
 	$(am__append_417) $(am__append_420) $(am__append_423) \
 	$(am__append_426) $(am__append_429) $(am__append_434) \
 	$(am__append_437) $(am__append_440) $(am__append_443) \
-	$(am__append_446)
-BUILT_SOURCES = $(dist_man_MANS) $(am__append_450)
-CLEANFILES = $(am__append_449)
+	$(am__append_446) $(am__append_449)
+collectdmon_SOURCES = collectdmon.c
+collectdmon_CPPFLAGS = $(AM_CPPFLAGS)
+collectd_nagios_SOURCES = collectd-nagios.c
+collectd_nagios_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
+collectd_nagios_LDADD = $(am__append_16) $(am__append_17) \
+	libcollectdclient/libcollectdclient.la
+collectd_nagios_DEPENDENCIES = libcollectdclient/libcollectdclient.la
+collectdctl_SOURCES = collectdctl.c
+collectdctl_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
+collectdctl_LDADD = $(am__append_18) $(am__append_19) \
+	libcollectdclient/libcollectdclient.la
+collectdctl_DEPENDENCIES = libcollectdclient/libcollectdclient.la
+collectd_tg_SOURCES = collectd-tg.c \
+		      utils_heap.c utils_heap.h
+
+collectd_tg_CPPFLAGS = $(AM_CPPFLAGS) -I$(top_builddir)/src/libcollectdclient/collectd
+collectd_tg_LDADD = $(am__append_20) $(am__append_21) $(am__append_22) \
+	$(am__append_23) libcollectdclient/libcollectdclient.la
+collectd_tg_DEPENDENCIES = libcollectdclient/libcollectdclient.la
+pkglib_LTLIBRARIES = $(am__append_24) $(am__append_27) \
+	$(am__append_30) $(am__append_35) $(am__append_39) \
+	$(am__append_42) $(am__append_45) $(am__append_48) \
+	$(am__append_52) $(am__append_55) $(am__append_58) \
+	$(am__append_61) $(am__append_65) $(am__append_73) \
+	$(am__append_76) $(am__append_79) $(am__append_84) \
+	$(am__append_89) $(am__append_92) $(am__append_95) \
+	$(am__append_98) $(am__append_107) $(am__append_110) \
+	$(am__append_113) $(am__append_116) $(am__append_119) \
+	$(am__append_122) $(am__append_125) $(am__append_128) \
+	$(am__append_132) $(am__append_140) $(am__append_143) \
+	$(am__append_146) $(am__append_149) $(am__append_152) \
+	$(am__append_155) $(am__append_158) $(am__append_164) \
+	$(am__append_167) $(am__append_170) $(am__append_173) \
+	$(am__append_176) $(am__append_179) $(am__append_182) \
+	$(am__append_185) $(am__append_188) $(am__append_191) \
+	$(am__append_195) $(am__append_198) $(am__append_201) \
+	$(am__append_205) $(am__append_213) $(am__append_216) \
+	$(am__append_219) $(am__append_224) $(am__append_227) \
+	$(am__append_230) $(am__append_237) $(am__append_240) \
+	$(am__append_243) $(am__append_248) $(am__append_251) \
+	$(am__append_254) $(am__append_258) $(am__append_261) \
+	$(am__append_264) $(am__append_268) $(am__append_271) \
+	$(am__append_274) $(am__append_277) $(am__append_281) \
+	$(am__append_284) $(am__append_287) $(am__append_290) \
+	$(am__append_293) $(am__append_296) $(am__append_300) \
+	$(am__append_304) $(am__append_307) $(am__append_310) \
+	$(am__append_313) $(am__append_316) $(am__append_319) \
+	$(am__append_322) $(am__append_325) $(am__append_328) \
+	$(am__append_334) $(am__append_337) $(am__append_346) \
+	$(am__append_349) $(am__append_352) $(am__append_355) \
+	$(am__append_358) $(am__append_361) $(am__append_364) \
+	$(am__append_367) $(am__append_370) $(am__append_373) \
+	$(am__append_376) $(am__append_380) $(am__append_383) \
+	$(am__append_386) $(am__append_389) $(am__append_392) \
+	$(am__append_396) $(am__append_399) $(am__append_404) \
+	$(am__append_409) $(am__append_412) $(am__append_415) \
+	$(am__append_418) $(am__append_421) $(am__append_424) \
+	$(am__append_427) $(am__append_430) $(am__append_435) \
+	$(am__append_438) $(am__append_441) $(am__append_444) \
+	$(am__append_447)
+BUILT_SOURCES = $(dist_man_MANS) $(am__append_451) $(am__append_453)
+CLEANFILES = $(am__append_450) $(am__append_452)
 @BUILD_PLUGIN_AGGREGATION_TRUE@aggregation_la_SOURCES = aggregation.c \
 @BUILD_PLUGIN_AGGREGATION_TRUE@                         utils_vl_lookup.c utils_vl_lookup.h
 
 @BUILD_PLUGIN_AGGREGATION_TRUE@aggregation_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_AGGREGATION_TRUE@aggregation_la_LIBADD = -lm
 @BUILD_PLUGIN_AMQP_TRUE@amqp_la_SOURCES = amqp.c \
 @BUILD_PLUGIN_AMQP_TRUE@		  utils_cmd_putval.c utils_cmd_putval.h \
+@BUILD_PLUGIN_AMQP_TRUE@  	          utils_parse_option.c utils_parse_option.h \
 @BUILD_PLUGIN_AMQP_TRUE@		  utils_format_graphite.c utils_format_graphite.h \
 @BUILD_PLUGIN_AMQP_TRUE@		  utils_format_json.c utils_format_json.h
 
 @BUILD_PLUGIN_AMQP_TRUE@amqp_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRABBITMQ_LDFLAGS)
 @BUILD_PLUGIN_AMQP_TRUE@amqp_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_LIBRABBITMQ_CPPFLAGS)
 @BUILD_PLUGIN_AMQP_TRUE@amqp_la_LIBADD = $(BUILD_WITH_LIBRABBITMQ_LIBS)
 @BUILD_PLUGIN_APACHE_TRUE@apache_la_SOURCES = apache.c
 @BUILD_PLUGIN_APACHE_TRUE@apache_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_APACHE_TRUE@apache_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_APACHE_TRUE@	$(am__append_31)
-@BUILD_PLUGIN_APACHE_TRUE@apache_la_LIBADD = $(am__append_32)
+@BUILD_PLUGIN_APACHE_TRUE@	$(am__append_32)
+@BUILD_PLUGIN_APACHE_TRUE@apache_la_LIBADD = $(am__append_33)
 @BUILD_PLUGIN_APCUPS_TRUE@apcups_la_SOURCES = apcups.c
 @BUILD_PLUGIN_APCUPS_TRUE@apcups_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_APCUPS_TRUE@apcups_la_LIBADD = $(am__append_35)
+@BUILD_PLUGIN_APCUPS_TRUE@apcups_la_LIBADD = $(am__append_36)
 @BUILD_PLUGIN_APPLE_SENSORS_TRUE@apple_sensors_la_SOURCES = apple_sensors.c
 @BUILD_PLUGIN_APPLE_SENSORS_TRUE@apple_sensors_la_LDFLAGS = -module \
 @BUILD_PLUGIN_APPLE_SENSORS_TRUE@	-avoid-version -framework \
 @BUILD_PLUGIN_APPLE_SENSORS_TRUE@	IOKit
 @BUILD_PLUGIN_AQUAERO_TRUE@aquaero_la_SOURCES = aquaero.c
 @BUILD_PLUGIN_AQUAERO_TRUE@aquaero_la_LDFLAGS = -module -avoid-version
@@ -2528,13 +2534,13 @@
 @BUILD_PLUGIN_ASCENT_TRUE@ascent_la_CFLAGS = $(AM_CFLAGS) \
 @BUILD_PLUGIN_ASCENT_TRUE@		$(BUILD_WITH_LIBCURL_CFLAGS) $(BUILD_WITH_LIBXML2_CFLAGS)
 
 @BUILD_PLUGIN_ASCENT_TRUE@ascent_la_LIBADD = $(BUILD_WITH_LIBCURL_LIBS) $(BUILD_WITH_LIBXML2_LIBS)
 @BUILD_PLUGIN_BATTERY_TRUE@battery_la_SOURCES = battery.c
 @BUILD_PLUGIN_BATTERY_TRUE@battery_la_LDFLAGS = -module -avoid-version \
-@BUILD_PLUGIN_BATTERY_TRUE@	$(am__append_48)
+@BUILD_PLUGIN_BATTERY_TRUE@	$(am__append_49)
 @BUILD_PLUGIN_BATTERY_TRUE@battery_la_LIBADD = 
 @BUILD_PLUGIN_BIND_TRUE@bind_la_SOURCES = bind.c
 @BUILD_PLUGIN_BIND_TRUE@bind_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_BIND_TRUE@bind_la_CFLAGS = $(AM_CFLAGS) \
 @BUILD_PLUGIN_BIND_TRUE@		$(BUILD_WITH_LIBCURL_CFLAGS) $(BUILD_WITH_LIBXML2_CFLAGS)
 
@@ -2543,35 +2549,35 @@
 @BUILD_PLUGIN_CGROUPS_TRUE@cgroups_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CONNTRACK_TRUE@conntrack_la_SOURCES = conntrack.c
 @BUILD_PLUGIN_CONNTRACK_TRUE@conntrack_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CONTEXTSWITCH_TRUE@contextswitch_la_SOURCES = contextswitch.c
 @BUILD_PLUGIN_CONTEXTSWITCH_TRUE@contextswitch_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CONTEXTSWITCH_TRUE@contextswitch_la_LIBADD =  \
-@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@	$(am__append_61)
+@BUILD_PLUGIN_CONTEXTSWITCH_TRUE@	$(am__append_62)
 @BUILD_PLUGIN_CPU_TRUE@cpu_la_SOURCES = cpu.c
-@BUILD_PLUGIN_CPU_TRUE@cpu_la_CFLAGS = $(AM_CFLAGS) $(am__append_67)
+@BUILD_PLUGIN_CPU_TRUE@cpu_la_CFLAGS = $(AM_CFLAGS) $(am__append_68)
 @BUILD_PLUGIN_CPU_TRUE@cpu_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_CPU_TRUE@cpu_la_LIBADD = $(am__append_65) \
-@BUILD_PLUGIN_CPU_TRUE@	$(am__append_66) $(am__append_68) \
-@BUILD_PLUGIN_CPU_TRUE@	$(am__append_69)
+@BUILD_PLUGIN_CPU_TRUE@cpu_la_LIBADD = $(am__append_66) \
+@BUILD_PLUGIN_CPU_TRUE@	$(am__append_67) $(am__append_69) \
+@BUILD_PLUGIN_CPU_TRUE@	$(am__append_70)
 @BUILD_PLUGIN_CPUFREQ_TRUE@cpufreq_la_SOURCES = cpufreq.c
 @BUILD_PLUGIN_CPUFREQ_TRUE@cpufreq_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CSV_TRUE@csv_la_SOURCES = csv.c
 @BUILD_PLUGIN_CSV_TRUE@csv_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CURL_TRUE@curl_la_SOURCES = curl.c
 @BUILD_PLUGIN_CURL_TRUE@curl_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_CURL_TRUE@curl_la_CFLAGS = $(AM_CFLAGS) $(am__append_80)
-@BUILD_PLUGIN_CURL_TRUE@curl_la_LIBADD = $(am__append_81)
+@BUILD_PLUGIN_CURL_TRUE@curl_la_CFLAGS = $(AM_CFLAGS) $(am__append_81)
+@BUILD_PLUGIN_CURL_TRUE@curl_la_LIBADD = $(am__append_82)
 @BUILD_PLUGIN_CURL_JSON_TRUE@curl_json_la_SOURCES = curl_json.c
 @BUILD_PLUGIN_CURL_JSON_TRUE@curl_json_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_CURL_JSON_TRUE@	$(am__append_84)
+@BUILD_PLUGIN_CURL_JSON_TRUE@	$(am__append_85)
 @BUILD_PLUGIN_CURL_JSON_TRUE@curl_json_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBYAJL_LDFLAGS)
 @BUILD_PLUGIN_CURL_JSON_TRUE@curl_json_la_CPPFLAGS = $(BUILD_WITH_LIBYAJL_CPPFLAGS)
 @BUILD_PLUGIN_CURL_JSON_TRUE@curl_json_la_LIBADD =  \
 @BUILD_PLUGIN_CURL_JSON_TRUE@	$(BUILD_WITH_LIBYAJL_LIBS) \
-@BUILD_PLUGIN_CURL_JSON_TRUE@	$(am__append_85)
+@BUILD_PLUGIN_CURL_JSON_TRUE@	$(am__append_86)
 @BUILD_PLUGIN_CURL_XML_TRUE@curl_xml_la_SOURCES = curl_xml.c
 @BUILD_PLUGIN_CURL_XML_TRUE@curl_xml_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_CURL_XML_TRUE@curl_xml_la_CFLAGS = $(AM_CFLAGS) \
 @BUILD_PLUGIN_CURL_XML_TRUE@		$(BUILD_WITH_LIBCURL_CFLAGS) $(BUILD_WITH_LIBXML2_CFLAGS)
 
 @BUILD_PLUGIN_CURL_XML_TRUE@curl_xml_la_LIBADD = $(BUILD_WITH_LIBCURL_LIBS) $(BUILD_WITH_LIBXML2_LIBS)
@@ -2582,18 +2588,18 @@
 @BUILD_PLUGIN_DBI_TRUE@dbi_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBDBI_LDFLAGS)
 @BUILD_PLUGIN_DBI_TRUE@dbi_la_LIBADD = $(BUILD_WITH_LIBDBI_LIBS)
 @BUILD_PLUGIN_DF_TRUE@df_la_SOURCES = df.c utils_mount.c utils_mount.h
 @BUILD_PLUGIN_DF_TRUE@df_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_DISK_TRUE@disk_la_SOURCES = disk.c
 @BUILD_PLUGIN_DISK_TRUE@disk_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_DISK_TRUE@	$(am__append_101)
+@BUILD_PLUGIN_DISK_TRUE@	$(am__append_102)
 @BUILD_PLUGIN_DISK_TRUE@disk_la_LDFLAGS = -module -avoid-version \
-@BUILD_PLUGIN_DISK_TRUE@	$(am__append_100)
-@BUILD_PLUGIN_DISK_TRUE@disk_la_LIBADD = $(am__append_98) \
-@BUILD_PLUGIN_DISK_TRUE@	$(am__append_99) $(am__append_102) \
-@BUILD_PLUGIN_DISK_TRUE@	$(am__append_103)
+@BUILD_PLUGIN_DISK_TRUE@	$(am__append_101)
+@BUILD_PLUGIN_DISK_TRUE@disk_la_LIBADD = $(am__append_99) \
+@BUILD_PLUGIN_DISK_TRUE@	$(am__append_100) $(am__append_103) \
+@BUILD_PLUGIN_DISK_TRUE@	$(am__append_104)
 @BUILD_PLUGIN_DNS_TRUE@dns_la_SOURCES = dns.c utils_dns.c utils_dns.h
 @BUILD_PLUGIN_DNS_TRUE@dns_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_DNS_TRUE@dns_la_LIBADD = -lpcap -lpthread
 @BUILD_PLUGIN_EMAIL_TRUE@email_la_SOURCES = email.c
 @BUILD_PLUGIN_EMAIL_TRUE@email_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_EMAIL_TRUE@email_la_LIBADD = -lpthread
@@ -2612,21 +2618,21 @@
 @BUILD_PLUGIN_GMOND_TRUE@gmond_la_SOURCES = gmond.c
 @BUILD_PLUGIN_GMOND_TRUE@gmond_la_CPPFLAGS = $(AM_CPPFLAGS) $(GANGLIA_CPPFLAGS)
 @BUILD_PLUGIN_GMOND_TRUE@gmond_la_LDFLAGS = -module -avoid-version $(GANGLIA_LDFLAGS)
 @BUILD_PLUGIN_GMOND_TRUE@gmond_la_LIBADD = $(GANGLIA_LIBS)
 @BUILD_PLUGIN_HDDTEMP_TRUE@hddtemp_la_SOURCES = hddtemp.c
 @BUILD_PLUGIN_HDDTEMP_TRUE@hddtemp_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_HDDTEMP_TRUE@hddtemp_la_LIBADD = $(am__append_128)
+@BUILD_PLUGIN_HDDTEMP_TRUE@hddtemp_la_LIBADD = $(am__append_129)
 @BUILD_PLUGIN_INTERFACE_TRUE@interface_la_SOURCES = interface.c
 @BUILD_PLUGIN_INTERFACE_TRUE@interface_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_134)
+@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_135)
 @BUILD_PLUGIN_INTERFACE_TRUE@interface_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_INTERFACE_TRUE@interface_la_LIBADD = $(am__append_135) \
-@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_136) \
+@BUILD_PLUGIN_INTERFACE_TRUE@interface_la_LIBADD = $(am__append_136) \
 @BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_137) \
-@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_138)
+@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_138) \
+@BUILD_PLUGIN_INTERFACE_TRUE@	$(am__append_139)
 @BUILD_PLUGIN_IPTABLES_TRUE@iptables_la_SOURCES = iptables.c
 @BUILD_PLUGIN_IPTABLES_TRUE@iptables_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_LIBIPTC_CPPFLAGS)
 @BUILD_PLUGIN_IPTABLES_TRUE@iptables_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_IPTABLES_TRUE@iptables_la_LIBADD = $(BUILD_WITH_LIBIPTC_LDFLAGS)
 @BUILD_PLUGIN_IPMI_TRUE@ipmi_la_SOURCES = ipmi.c
 @BUILD_PLUGIN_IPMI_TRUE@ipmi_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_OPENIPMI_CFLAGS)
@@ -2647,16 +2653,16 @@
 @BUILD_PLUGIN_LIBVIRT_TRUE@		$(BUILD_WITH_LIBVIRT_CFLAGS) $(BUILD_WITH_LIBXML2_CFLAGS)
 
 @BUILD_PLUGIN_LIBVIRT_TRUE@libvirt_la_LIBADD = $(BUILD_WITH_LIBVIRT_LIBS) $(BUILD_WITH_LIBXML2_LIBS)
 @BUILD_PLUGIN_LIBVIRT_TRUE@libvirt_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_LOAD_TRUE@load_la_SOURCES = load.c
 @BUILD_PLUGIN_LOAD_TRUE@load_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_LOAD_TRUE@	$(am__append_160)
+@BUILD_PLUGIN_LOAD_TRUE@	$(am__append_161)
 @BUILD_PLUGIN_LOAD_TRUE@load_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_LOAD_TRUE@load_la_LIBADD = $(am__append_161) \
-@BUILD_PLUGIN_LOAD_TRUE@	$(am__append_162)
+@BUILD_PLUGIN_LOAD_TRUE@load_la_LIBADD = $(am__append_162) \
+@BUILD_PLUGIN_LOAD_TRUE@	$(am__append_163)
 @BUILD_PLUGIN_LOGFILE_TRUE@logfile_la_SOURCES = logfile.c
 @BUILD_PLUGIN_LOGFILE_TRUE@logfile_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_LPAR_TRUE@lpar_la_SOURCES = lpar.c
 @BUILD_PLUGIN_LPAR_TRUE@lpar_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_LPAR_TRUE@lpar_la_LIBADD = -lperfstat
 @BUILD_PLUGIN_LVM_TRUE@lvm_la_SOURCES = lvm.c
@@ -2673,85 +2679,85 @@
 @BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@match_timediff_la_SOURCES = match_timediff.c
 @BUILD_PLUGIN_MATCH_TIMEDIFF_TRUE@match_timediff_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MATCH_VALUE_TRUE@match_value_la_SOURCES = match_value.c
 @BUILD_PLUGIN_MATCH_VALUE_TRUE@match_value_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MBMON_TRUE@mbmon_la_SOURCES = mbmon.c
 @BUILD_PLUGIN_MBMON_TRUE@mbmon_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_MBMON_TRUE@mbmon_la_LIBADD = $(am__append_191)
+@BUILD_PLUGIN_MBMON_TRUE@mbmon_la_LIBADD = $(am__append_192)
 @BUILD_PLUGIN_MD_TRUE@md_la_SOURCES = md.c
 @BUILD_PLUGIN_MD_TRUE@md_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MEMCACHEC_TRUE@memcachec_la_SOURCES = memcachec.c
 @BUILD_PLUGIN_MEMCACHEC_TRUE@memcachec_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBMEMCACHED_LDFLAGS)
 @BUILD_PLUGIN_MEMCACHEC_TRUE@memcachec_la_CPPFLAGS = $(BUILD_WITH_LIBMEMCACHED_CPPFLAGS)
 @BUILD_PLUGIN_MEMCACHEC_TRUE@memcachec_la_LIBADD = $(BUILD_WITH_LIBMEMCACHED_LIBS)
 @BUILD_PLUGIN_MEMCACHED_TRUE@memcached_la_SOURCES = memcached.c
 @BUILD_PLUGIN_MEMCACHED_TRUE@memcached_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_MEMCACHED_TRUE@memcached_la_LIBADD = $(am__append_201)
+@BUILD_PLUGIN_MEMCACHED_TRUE@memcached_la_LIBADD = $(am__append_202)
 @BUILD_PLUGIN_MEMORY_TRUE@memory_la_SOURCES = memory.c
 @BUILD_PLUGIN_MEMORY_TRUE@memory_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_209)
+@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_210)
 @BUILD_PLUGIN_MEMORY_TRUE@memory_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_MEMORY_TRUE@memory_la_LIBADD = $(am__append_207) \
-@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_208) $(am__append_210) \
-@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_211)
+@BUILD_PLUGIN_MEMORY_TRUE@memory_la_LIBADD = $(am__append_208) \
+@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_209) $(am__append_211) \
+@BUILD_PLUGIN_MEMORY_TRUE@	$(am__append_212)
 @BUILD_PLUGIN_MODBUS_TRUE@modbus_la_SOURCES = modbus.c
 @BUILD_PLUGIN_MODBUS_TRUE@modbus_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MODBUS_TRUE@modbus_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBMODBUS_CFLAGS)
 @BUILD_PLUGIN_MODBUS_TRUE@modbus_la_LIBADD = $(BUILD_WITH_LIBMODBUS_LIBS)
 @BUILD_PLUGIN_MULTIMETER_TRUE@multimeter_la_SOURCES = multimeter.c
 @BUILD_PLUGIN_MULTIMETER_TRUE@multimeter_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MYSQL_TRUE@mysql_la_SOURCES = mysql.c
 @BUILD_PLUGIN_MYSQL_TRUE@mysql_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MYSQL_TRUE@mysql_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_MYSQL_TRUE@	$(am__append_220)
-@BUILD_PLUGIN_MYSQL_TRUE@mysql_la_LIBADD = $(am__append_221)
+@BUILD_PLUGIN_MYSQL_TRUE@	$(am__append_221)
+@BUILD_PLUGIN_MYSQL_TRUE@mysql_la_LIBADD = $(am__append_222)
 @BUILD_PLUGIN_NETAPP_TRUE@netapp_la_SOURCES = netapp.c
 @BUILD_PLUGIN_NETAPP_TRUE@netapp_la_CPPFLAGS = $(AM_CPPFLAGS) $(LIBNETAPP_CPPFLAGS)
 @BUILD_PLUGIN_NETAPP_TRUE@netapp_la_LDFLAGS = -module -avoid-version $(LIBNETAPP_LDFLAGS)
 @BUILD_PLUGIN_NETAPP_TRUE@netapp_la_LIBADD = $(LIBNETAPP_LIBS)
 @BUILD_PLUGIN_NETLINK_TRUE@netlink_la_SOURCES = netlink.c
 @BUILD_PLUGIN_NETLINK_TRUE@netlink_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NETLINK_TRUE@netlink_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBMNL_CFLAGS)
 @BUILD_PLUGIN_NETLINK_TRUE@netlink_la_LIBADD = $(BUILD_WITH_LIBMNL_LIBS)
 @BUILD_PLUGIN_NETWORK_TRUE@network_la_SOURCES = network.c network.h \
 @BUILD_PLUGIN_NETWORK_TRUE@		     utils_fbhash.c utils_fbhash.h
 
 @BUILD_PLUGIN_NETWORK_TRUE@network_la_CPPFLAGS = $(AM_CPPFLAGS) \
-@BUILD_PLUGIN_NETWORK_TRUE@	$(am__append_231)
-@BUILD_PLUGIN_NETWORK_TRUE@network_la_LDFLAGS = -module -avoid-version \
 @BUILD_PLUGIN_NETWORK_TRUE@	$(am__append_232)
+@BUILD_PLUGIN_NETWORK_TRUE@network_la_LDFLAGS = -module -avoid-version \
+@BUILD_PLUGIN_NETWORK_TRUE@	$(am__append_233)
 @BUILD_PLUGIN_NETWORK_TRUE@network_la_LIBADD = -lpthread \
-@BUILD_PLUGIN_NETWORK_TRUE@	$(am__append_230) $(am__append_233)
+@BUILD_PLUGIN_NETWORK_TRUE@	$(am__append_231) $(am__append_234)
 @BUILD_PLUGIN_NFS_TRUE@nfs_la_SOURCES = nfs.c
 @BUILD_PLUGIN_NFS_TRUE@nfs_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_FSCACHE_TRUE@fscache_la_SOURCES = fscache.c
 @BUILD_PLUGIN_FSCACHE_TRUE@fscache_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NGINX_TRUE@nginx_la_SOURCES = nginx.c
 @BUILD_PLUGIN_NGINX_TRUE@nginx_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_NGINX_TRUE@	$(am__append_243)
-@BUILD_PLUGIN_NGINX_TRUE@nginx_la_LIBADD = $(am__append_244)
+@BUILD_PLUGIN_NGINX_TRUE@	$(am__append_244)
+@BUILD_PLUGIN_NGINX_TRUE@nginx_la_LIBADD = $(am__append_245)
 @BUILD_PLUGIN_NGINX_TRUE@nginx_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@notify_desktop_la_SOURCES = notify_desktop.c
 @BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@notify_desktop_la_CFLAGS = $(AM_CFLAGS) $(LIBNOTIFY_CFLAGS)
 @BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@notify_desktop_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NOTIFY_DESKTOP_TRUE@notify_desktop_la_LIBADD = $(LIBNOTIFY_LIBS)
 @BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@notify_email_la_SOURCES = notify_email.c
 @BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@notify_email_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@notify_email_la_LIBADD = -lesmtp -lssl -lcrypto -lpthread -ldl
+@BUILD_PLUGIN_NOTIFY_EMAIL_TRUE@notify_email_la_LIBADD = -lesmtp -lssl -lcrypto -lpthread
 @BUILD_PLUGIN_NTPD_TRUE@ntpd_la_SOURCES = ntpd.c
 @BUILD_PLUGIN_NTPD_TRUE@ntpd_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_NTPD_TRUE@ntpd_la_LIBADD = $(am__append_254)
+@BUILD_PLUGIN_NTPD_TRUE@ntpd_la_LIBADD = $(am__append_255)
 @BUILD_PLUGIN_NUMA_TRUE@numa_la_SOURCES = numa.c
 @BUILD_PLUGIN_NUMA_TRUE@numa_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NUT_TRUE@nut_la_SOURCES = nut.c
 @BUILD_PLUGIN_NUT_TRUE@nut_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBUPSCLIENT_CFLAGS)
 @BUILD_PLUGIN_NUT_TRUE@nut_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_NUT_TRUE@nut_la_LIBADD = -lpthread $(BUILD_WITH_LIBUPSCLIENT_LIBS)
 @BUILD_PLUGIN_OLSRD_TRUE@olsrd_la_SOURCES = olsrd.c
 @BUILD_PLUGIN_OLSRD_TRUE@olsrd_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_OLSRD_TRUE@olsrd_la_LIBADD = $(am__append_264)
+@BUILD_PLUGIN_OLSRD_TRUE@olsrd_la_LIBADD = $(am__append_265)
 @BUILD_PLUGIN_ONEWIRE_TRUE@onewire_la_SOURCES = onewire.c
 @BUILD_PLUGIN_ONEWIRE_TRUE@onewire_la_CFLAGS = $(AM_CFLAGS)
 @BUILD_PLUGIN_ONEWIRE_TRUE@onewire_la_CPPFLAGS = $(BUILD_WITH_LIBOWCAPI_CPPFLAGS)
 @BUILD_PLUGIN_ONEWIRE_TRUE@onewire_la_LIBADD = $(BUILD_WITH_LIBOWCAPI_LIBS)
 @BUILD_PLUGIN_ONEWIRE_TRUE@onewire_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_OPENVPN_TRUE@openvpn_la_SOURCES = openvpn.c
@@ -2768,13 +2774,13 @@
 # Despite C99 providing the "bool" type thru stdbool.h, Perl defines its own
 # version of that type if HAS_BOOL is not defined... *sigh*
 @BUILD_PLUGIN_PERL_TRUE@perl_la_CPPFLAGS = $(AM_CPPFLAGS) -DHAS_BOOL=1
 @BUILD_PLUGIN_PERL_TRUE@perl_la_CFLAGS = $(AM_CFLAGS) $(PERL_CFLAGS) \
 @BUILD_PLUGIN_PERL_TRUE@	-DXS_VERSION=\"$(VERSION)\" \
 @BUILD_PLUGIN_PERL_TRUE@	-DVERSION=\"$(VERSION)\" \
-@BUILD_PLUGIN_PERL_TRUE@	$(am__append_277)
+@BUILD_PLUGIN_PERL_TRUE@	$(am__append_278)
 @BUILD_PLUGIN_PERL_TRUE@perl_la_LDFLAGS = -module -avoid-version \
 @BUILD_PLUGIN_PERL_TRUE@		$(PERL_LDFLAGS)
 
 @BUILD_PLUGIN_PERL_TRUE@perl_la_LIBADD = $(PERL_LIBS)
 @BUILD_PLUGIN_PF_TRUE@pf_la_SOURCES = pf.c
 @BUILD_PLUGIN_PF_TRUE@pf_la_LDFLAGS = -module -avoid-version
@@ -2796,36 +2802,36 @@
 @BUILD_PLUGIN_POSTGRESQL_TRUE@postgresql_la_LIBADD = -lpq
 @BUILD_PLUGIN_POWERDNS_TRUE@powerdns_la_SOURCES = powerdns.c
 @BUILD_PLUGIN_POWERDNS_TRUE@powerdns_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_PYTHON_TRUE@python_la_SOURCES = python.c pyconfig.c pyvalues.c cpython.h
 @BUILD_PLUGIN_PYTHON_TRUE@python_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_PYTHON_CPPFLAGS)
 @BUILD_PLUGIN_PYTHON_TRUE@python_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_PYTHON_TRUE@	$(am__append_296)
+@BUILD_PLUGIN_PYTHON_TRUE@	$(am__append_297)
 @BUILD_PLUGIN_PYTHON_TRUE@python_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_PYTHON_LDFLAGS)
 @BUILD_PLUGIN_PYTHON_TRUE@python_la_LIBADD = $(BUILD_WITH_PYTHON_LIBS)
 @BUILD_PLUGIN_PROCESSES_TRUE@processes_la_SOURCES = processes.c
 @BUILD_PLUGIN_PROCESSES_TRUE@processes_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_PROCESSES_TRUE@processes_la_LIBADD = $(am__append_302)
+@BUILD_PLUGIN_PROCESSES_TRUE@processes_la_LIBADD = $(am__append_303)
 @BUILD_PLUGIN_PROTOCOLS_TRUE@protocols_la_SOURCES = protocols.c
 @BUILD_PLUGIN_PROTOCOLS_TRUE@protocols_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_REDIS_TRUE@redis_la_SOURCES = redis.c
 @BUILD_PLUGIN_REDIS_TRUE@redis_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBCREDIS_LDFLAGS)
 @BUILD_PLUGIN_REDIS_TRUE@redis_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBCREDIS_CPPFLAGS)
 @BUILD_PLUGIN_REDIS_TRUE@redis_la_LIBADD = -lcredis
 @BUILD_PLUGIN_ROUTEROS_TRUE@routeros_la_SOURCES = routeros.c
 @BUILD_PLUGIN_ROUTEROS_TRUE@routeros_la_CPPFLAGS = $(BUILD_WITH_LIBROUTEROS_CPPFLAGS)
 @BUILD_PLUGIN_ROUTEROS_TRUE@routeros_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBROUTEROS_LDFLAGS)
 @BUILD_PLUGIN_ROUTEROS_TRUE@routeros_la_LIBADD = -lrouteros
 @BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_SOURCES = rrdcached.c utils_rrdcreate.c utils_rrdcreate.h
-@BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_LDFLAGS = -module -avoid-version
+@BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRRD_LDFLAGS)
 @BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBRRD_CFLAGS)
-@BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
+@BUILD_PLUGIN_RRDCACHED_TRUE@rrdcached_la_LIBADD = $(BUILD_WITH_LIBRRD_LIBS)
 @BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_SOURCES = rrdtool.c utils_rrdcreate.c utils_rrdcreate.h
-@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LDFLAGS = -module -avoid-version
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBRRD_LDFLAGS)
 @BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBRRD_CFLAGS)
-@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LDFLAGS)
+@BUILD_PLUGIN_RRDTOOL_TRUE@rrdtool_la_LIBADD = $(BUILD_WITH_LIBRRD_LIBS)
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_SOURCES = sensors.c
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBSENSORS_CFLAGS)
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBSENSORS_LDFLAGS)
 @BUILD_PLUGIN_SENSORS_TRUE@sensors_la_LIBADD = -lsensors
 @BUILD_PLUGIN_SERIAL_TRUE@serial_la_SOURCES = serial.c
 @BUILD_PLUGIN_SERIAL_TRUE@serial_la_LDFLAGS = -module -avoid-version
@@ -2833,27 +2839,27 @@
 @BUILD_PLUGIN_SIGROK_TRUE@sigrok_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBSIGROK_CFLAGS)
 @BUILD_PLUGIN_SIGROK_TRUE@sigrok_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBSIGROK_LDFLAGS)
 @BUILD_PLUGIN_SIGROK_TRUE@sigrok_la_LIBADD = -lsigrok
 @BUILD_PLUGIN_SNMP_TRUE@snmp_la_SOURCES = snmp.c
 @BUILD_PLUGIN_SNMP_TRUE@snmp_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_SNMP_TRUE@snmp_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_SNMP_TRUE@	$(am__append_328)
-@BUILD_PLUGIN_SNMP_TRUE@snmp_la_LIBADD = $(am__append_329) \
-@BUILD_PLUGIN_SNMP_TRUE@	$(am__append_330)
+@BUILD_PLUGIN_SNMP_TRUE@	$(am__append_329)
+@BUILD_PLUGIN_SNMP_TRUE@snmp_la_LIBADD = $(am__append_330) \
+@BUILD_PLUGIN_SNMP_TRUE@	$(am__append_331)
 @BUILD_PLUGIN_STATSD_TRUE@statsd_la_SOURCES = statsd.c \
 @BUILD_PLUGIN_STATSD_TRUE@                    utils_latency.h utils_latency.c
 
 @BUILD_PLUGIN_STATSD_TRUE@statsd_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_STATSD_TRUE@statsd_la_LIBADD = -lpthread
+@BUILD_PLUGIN_STATSD_TRUE@statsd_la_LIBADD = -lpthread -lm
 @BUILD_PLUGIN_SWAP_TRUE@swap_la_SOURCES = swap.c
 @BUILD_PLUGIN_SWAP_TRUE@swap_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_342)
+@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_343)
 @BUILD_PLUGIN_SWAP_TRUE@swap_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_SWAP_TRUE@swap_la_LIBADD = $(am__append_339) \
-@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_340) $(am__append_341) \
-@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_343) $(am__append_344)
+@BUILD_PLUGIN_SWAP_TRUE@swap_la_LIBADD = $(am__append_340) \
+@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_341) $(am__append_342) \
+@BUILD_PLUGIN_SWAP_TRUE@	$(am__append_344) $(am__append_345)
 @BUILD_PLUGIN_SYSLOG_TRUE@syslog_la_SOURCES = syslog.c
 @BUILD_PLUGIN_SYSLOG_TRUE@syslog_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TABLE_TRUE@table_la_SOURCES = table.c
 @BUILD_PLUGIN_TABLE_TRUE@table_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TAIL_TRUE@tail_la_SOURCES = tail.c
 @BUILD_PLUGIN_TAIL_TRUE@tail_la_LDFLAGS = -module -avoid-version
@@ -2871,45 +2877,45 @@
 @BUILD_PLUGIN_TARGET_SET_TRUE@target_set_la_SOURCES = target_set.c
 @BUILD_PLUGIN_TARGET_SET_TRUE@target_set_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@target_v5upgrade_la_SOURCES = target_v5upgrade.c
 @BUILD_PLUGIN_TARGET_V5UPGRADE_TRUE@target_v5upgrade_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TCPCONNS_TRUE@tcpconns_la_SOURCES = tcpconns.c
 @BUILD_PLUGIN_TCPCONNS_TRUE@tcpconns_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_TCPCONNS_TRUE@tcpconns_la_LIBADD = $(am__append_378)
+@BUILD_PLUGIN_TCPCONNS_TRUE@tcpconns_la_LIBADD = $(am__append_379)
 @BUILD_PLUGIN_TEAMSPEAK2_TRUE@teamspeak2_la_SOURCES = teamspeak2.c
 @BUILD_PLUGIN_TEAMSPEAK2_TRUE@teamspeak2_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TED_TRUE@ted_la_SOURCES = ted.c
 @BUILD_PLUGIN_TED_TRUE@ted_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_THERMAL_TRUE@thermal_la_SOURCES = thermal.c
 @BUILD_PLUGIN_THERMAL_TRUE@thermal_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_THRESHOLD_TRUE@threshold_la_SOURCES = threshold.c
 @BUILD_PLUGIN_THRESHOLD_TRUE@threshold_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_TOKYOTYRANT_TRUE@tokyotyrant_la_SOURCES = tokyotyrant.c
 @BUILD_PLUGIN_TOKYOTYRANT_TRUE@tokyotyrant_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_LIBTOKYOTYRANT_CPPFLAGS)
 @BUILD_PLUGIN_TOKYOTYRANT_TRUE@tokyotyrant_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBTOKYOTYRANT_LDFLAGS)
 @BUILD_PLUGIN_TOKYOTYRANT_TRUE@tokyotyrant_la_LIBADD = $(BUILD_WITH_LIBTOKYOTYRANT_LIBS) \
-@BUILD_PLUGIN_TOKYOTYRANT_TRUE@	$(am__append_392)
+@BUILD_PLUGIN_TOKYOTYRANT_TRUE@	$(am__append_393)
 @BUILD_PLUGIN_UNIXSOCK_TRUE@unixsock_la_SOURCES = unixsock.c \
 @BUILD_PLUGIN_UNIXSOCK_TRUE@		      utils_cmd_flush.h utils_cmd_flush.c \
 @BUILD_PLUGIN_UNIXSOCK_TRUE@		      utils_cmd_getval.h utils_cmd_getval.c \
 @BUILD_PLUGIN_UNIXSOCK_TRUE@		      utils_cmd_listval.h utils_cmd_listval.c \
 @BUILD_PLUGIN_UNIXSOCK_TRUE@		      utils_cmd_putval.h utils_cmd_putval.c \
 @BUILD_PLUGIN_UNIXSOCK_TRUE@		      utils_cmd_putnotif.h utils_cmd_putnotif.c
 
 @BUILD_PLUGIN_UNIXSOCK_TRUE@unixsock_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_UNIXSOCK_TRUE@unixsock_la_LIBADD = -lpthread
 @BUILD_PLUGIN_UPTIME_TRUE@uptime_la_SOURCES = uptime.c
 @BUILD_PLUGIN_UPTIME_TRUE@uptime_la_CFLAGS = $(AM_CFLAGS)
 @BUILD_PLUGIN_UPTIME_TRUE@uptime_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_UPTIME_TRUE@uptime_la_LIBADD = $(am__append_399) \
-@BUILD_PLUGIN_UPTIME_TRUE@	$(am__append_400)
+@BUILD_PLUGIN_UPTIME_TRUE@uptime_la_LIBADD = $(am__append_400) \
+@BUILD_PLUGIN_UPTIME_TRUE@	$(am__append_401)
 @BUILD_PLUGIN_USERS_TRUE@users_la_SOURCES = users.c
 @BUILD_PLUGIN_USERS_TRUE@users_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_USERS_TRUE@	$(am__append_404)
+@BUILD_PLUGIN_USERS_TRUE@	$(am__append_405)
 @BUILD_PLUGIN_USERS_TRUE@users_la_LDFLAGS = -module -avoid-version
-@BUILD_PLUGIN_USERS_TRUE@users_la_LIBADD = $(am__append_405)
+@BUILD_PLUGIN_USERS_TRUE@users_la_LIBADD = $(am__append_406)
 @BUILD_PLUGIN_UUID_TRUE@uuid_la_SOURCES = uuid.c
 @BUILD_PLUGIN_UUID_TRUE@uuid_la_CFLAGS = $(AM_CFLAGS) $(BUILD_WITH_LIBHAL_CFLAGS)
 @BUILD_PLUGIN_UUID_TRUE@uuid_la_LIBADD = $(BUILD_WITH_LIBHAL_LIBS)
 @BUILD_PLUGIN_UUID_TRUE@uuid_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_MIC_TRUE@mic_la_SOURCES = mic.c
 @BUILD_PLUGIN_MIC_TRUE@mic_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_MIC_LIBPATH)
@@ -2932,15 +2938,15 @@
 @BUILD_PLUGIN_WRITE_GRAPHITE_TRUE@write_graphite_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_WRITE_HTTP_TRUE@write_http_la_SOURCES = write_http.c \
 @BUILD_PLUGIN_WRITE_HTTP_TRUE@			utils_format_json.c utils_format_json.h
 
 @BUILD_PLUGIN_WRITE_HTTP_TRUE@write_http_la_LDFLAGS = -module -avoid-version
 @BUILD_PLUGIN_WRITE_HTTP_TRUE@write_http_la_CFLAGS = $(AM_CFLAGS) \
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@	$(am__append_431)
-@BUILD_PLUGIN_WRITE_HTTP_TRUE@write_http_la_LIBADD =  \
 @BUILD_PLUGIN_WRITE_HTTP_TRUE@	$(am__append_432)
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@write_http_la_LIBADD =  \
+@BUILD_PLUGIN_WRITE_HTTP_TRUE@	$(am__append_433)
 @BUILD_PLUGIN_WRITE_MONGODB_TRUE@write_mongodb_la_SOURCES = write_mongodb.c
 @BUILD_PLUGIN_WRITE_MONGODB_TRUE@write_mongodb_la_CPPFLAGS = $(AM_CPPFLAGS) $(BUILD_WITH_LIBMONGOC_CPPFLAGS)
 @BUILD_PLUGIN_WRITE_MONGODB_TRUE@write_mongodb_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBMONGOC_LDFLAGS)
 @BUILD_PLUGIN_WRITE_MONGODB_TRUE@write_mongodb_la_LIBADD = -lmongoc
 @BUILD_PLUGIN_WRITE_REDIS_TRUE@write_redis_la_SOURCES = write_redis.c
 @BUILD_PLUGIN_WRITE_REDIS_TRUE@write_redis_la_LDFLAGS = -module -avoid-version $(BUILD_WITH_LIBCREDIS_LDFLAGS)
@@ -2984,12 +2990,16 @@
 EXTRA_DIST = types.db collectd.conf.pod collectd-email.pod \
 	collectd-exec.pod collectdctl.pod collectd-java.pod \
 	collectdmon.pod collectd-nagios.pod collectd-perl.pod \
 	collectd-python.pod collectd.pod collectd-snmp.pod \
 	collectd-tg.pod collectd-threshold.pod collectd-unixsock.pod \
 	postgresql_default.conf types.db.pod pinba.proto riemann.proto
+AM_V_PROTOC_C = $(am__v_PROTOC_C_@AM_V@)
+am__v_PROTOC_C_ = $(am__v_PROTOC_C_@AM_DEFAULT_V@)
+am__v_PROTOC_C_0 = @echo "  PROTOC-C    " $@;
+am__v_PROTOC_C_1 = 
 @BUILD_FEATURE_DEBUG_TRUE@utils_vl_lookup_test_SOURCES = utils_vl_lookup_test.c \
 @BUILD_FEATURE_DEBUG_TRUE@                               utils_vl_lookup.h utils_vl_lookup.c \
 @BUILD_FEATURE_DEBUG_TRUE@                               utils_avltree.c utils_avltree.h \
 @BUILD_FEATURE_DEBUG_TRUE@                               common.h
 
 @BUILD_FEATURE_DEBUG_TRUE@utils_vl_lookup_test_CPPFLAGS = $(AM_CPPFLAGS) $(LTDLINCL) -DBUILD_TEST=1
@@ -3574,12 +3584,13 @@
 
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/aggregation.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/amqp_la-amqp.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/amqp_la-utils_cmd_putval.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/amqp_la-utils_format_graphite.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/amqp_la-utils_format_json.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/amqp_la-utils_parse_option.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/apache_la-apache.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/apcups.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/apple_sensors.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/aquaero_la-aquaero.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ascent_la-ascent.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/battery.Plo@am__quote@
@@ -3778,12 +3789,19 @@
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT amqp_la-utils_cmd_putval.lo -MD -MP -MF $(DEPDIR)/amqp_la-utils_cmd_putval.Tpo -c -o amqp_la-utils_cmd_putval.lo `test -f 'utils_cmd_putval.c' || echo '$(srcdir)/'`utils_cmd_putval.c
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) $(DEPDIR)/amqp_la-utils_cmd_putval.Tpo $(DEPDIR)/amqp_la-utils_cmd_putval.Plo
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='utils_cmd_putval.c' object='amqp_la-utils_cmd_putval.lo' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o amqp_la-utils_cmd_putval.lo `test -f 'utils_cmd_putval.c' || echo '$(srcdir)/'`utils_cmd_putval.c
 
+amqp_la-utils_parse_option.lo: utils_parse_option.c
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT amqp_la-utils_parse_option.lo -MD -MP -MF $(DEPDIR)/amqp_la-utils_parse_option.Tpo -c -o amqp_la-utils_parse_option.lo `test -f 'utils_parse_option.c' || echo '$(srcdir)/'`utils_parse_option.c
+@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) $(DEPDIR)/amqp_la-utils_parse_option.Tpo $(DEPDIR)/amqp_la-utils_parse_option.Plo
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='utils_parse_option.c' object='amqp_la-utils_parse_option.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o amqp_la-utils_parse_option.lo `test -f 'utils_parse_option.c' || echo '$(srcdir)/'`utils_parse_option.c
+
 amqp_la-utils_format_graphite.lo: utils_format_graphite.c
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT amqp_la-utils_format_graphite.lo -MD -MP -MF $(DEPDIR)/amqp_la-utils_format_graphite.Tpo -c -o amqp_la-utils_format_graphite.lo `test -f 'utils_format_graphite.c' || echo '$(srcdir)/'`utils_format_graphite.c
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) $(DEPDIR)/amqp_la-utils_format_graphite.Tpo $(DEPDIR)/amqp_la-utils_format_graphite.Plo
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='utils_format_graphite.c' object='amqp_la-utils_format_graphite.lo' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(amqp_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o amqp_la-utils_format_graphite.lo `test -f 'utils_format_graphite.c' || echo '$(srcdir)/'`utils_format_graphite.c
@@ -5029,17 +5047,17 @@
 		>.pod2man.tmp.$$$$ 2>/dev/null && mv -f .pod2man.tmp.$$$$ $@ || true
 	@if grep '\<POD ERRORS\>' $@ >/dev/null 2>&1; \
 	then \
 		echo "$@ has some POD errors!"; false; \
 	fi
 
-@HAVE_PROTOC_C_TRUE@pinba.pb-c.c pinba.pb-c.h: pinba.proto
-@HAVE_PROTOC_C_TRUE@	protoc-c -I$(srcdir) --c_out . $(srcdir)/pinba.proto
+@BUILD_PLUGIN_PINBA_TRUE@pinba.pb-c.c pinba.pb-c.h: pinba.proto
+@BUILD_PLUGIN_PINBA_TRUE@	$(AM_V_PROTOC_C)protoc-c -I$(srcdir) --c_out . $(srcdir)/pinba.proto
 
-@HAVE_PROTOC_C_TRUE@riemann.pb-c.c riemann.pb-c.h: riemann.proto
-@HAVE_PROTOC_C_TRUE@	protoc-c -I$(srcdir) --c_out . $(srcdir)/riemann.proto
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@riemann.pb-c.c riemann.pb-c.h: riemann.proto
+@BUILD_PLUGIN_WRITE_RIEMANN_TRUE@	$(AM_V_PROTOC_C)protoc-c -I$(srcdir) --c_out . $(srcdir)/riemann.proto
 
 install-exec-hook:
 	$(mkinstalldirs) $(DESTDIR)$(sysconfdir)
 	if test -e $(DESTDIR)$(sysconfdir)/collectd.conf; \
 	then \
 		$(INSTALL) -m 0640 collectd.conf $(DESTDIR)$(sysconfdir)/collectd.conf.pkg-orig; \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/memcachec.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/memcachec.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/memcachec.c	2015-02-26 18:43:48.480180666 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/memcachec.c	2016-07-26 15:47:12.961713803 +0800
@@ -260,13 +260,16 @@
     }
 
     break;
   } /* while (status == 0) */
 
   if (status != 0)
+  {
+    cmc_web_match_free (match);
     return (status);
+  }
 
   match->match = match_create_simple (match->regex, match->exclude_regex,
       match->dstype);
   if (match->match == NULL)
   {
     ERROR ("memcachec plugin: tail_match_add_match_simple failed.");
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/memcached.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/memcached.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/memcached.c	2015-02-26 19:44:34.035896566 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/memcached.c	2016-07-26 15:47:12.961713803 +0800
@@ -59,12 +59,13 @@
     return;
 
   sfree (st->name);
   sfree (st->socket);
   sfree (st->host);
   sfree (st->port);
+  sfree (st);
 }
 
 static int memcached_connect_unix (memcached_t *st)
 {
   struct sockaddr_un serv_addr;
   int fd;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/meta_data.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/meta_data.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/meta_data.c	2015-02-26 18:43:48.480180666 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/meta_data.c	2016-07-26 15:47:12.961713803 +0800
@@ -106,12 +106,14 @@
   meta_entry_t *copy;
 
   if (orig == NULL)
     return (NULL);
 
   copy = md_entry_alloc (orig->key);
+  if (copy == NULL)
+    return (NULL);
   copy->type = orig->type;
   if (copy->type == MD_TYPE_STRING)
     copy->value.mv_string = strdup (orig->value.mv_string);
   else
     copy->value = orig->value;
 
@@ -247,13 +249,12 @@
 
 void meta_data_destroy (meta_data_t *md) /* {{{ */
 {
   if (md == NULL)
     return;
 
-  pthread_mutex_destroy(&md->lock);
   md_entry_free (md->head);
   pthread_mutex_destroy (&md->lock);
   free (md);
 } /* }}} void meta_data_destroy */
 
 int meta_data_exists (meta_data_t *md, const char *key) /* {{{ */
@@ -486,13 +487,13 @@
     pthread_mutex_unlock (&md->lock);
     return (-ENOENT);
   }
 
   if (e->type != MD_TYPE_STRING)
   {
-    ERROR ("meta_data_get_signed_int: Type mismatch for key `%s'", e->key);
+    ERROR ("meta_data_get_string: Type mismatch for key `%s'", e->key);
     pthread_mutex_unlock (&md->lock);
     return (-ENOENT);
   }
 
   temp = md_strdup (e->value.mv_string);
   if (temp == NULL)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/modbus.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/modbus.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/modbus.c	2014-08-18 15:33:14.292460715 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/modbus.c	2016-07-26 15:47:12.961713803 +0800
@@ -24,13 +24,13 @@
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
 
 #include <netdb.h>
 
-#include <modbus/modbus.h>
+#include <modbus.h>
 
 #ifndef LIBMODBUS_VERSION_CHECK
 /* Assume version 2.0.3 */
 # define LEGACY_LIBMODBUS 1
 #else
 /* Assume version 2.9.2 */
@@ -285,13 +285,15 @@
 {
   int status;
 
   if (host == NULL)
     return (EINVAL);
 
+#if COLLECT_DEBUG
   modbus_set_debug (&host->connection, 1);
+#endif
 
   /* We'll do the error handling ourselves. */
   modbus_set_error_handling (&host->connection, NOP_ON_ERROR);
 
   if ((host->port < 1) || (host->port > 65535))
     host->port = MODBUS_TCP_DEFAULT_PORT;
@@ -338,13 +340,15 @@
   if (host->connection == NULL)
   {
     ERROR ("Modbus plugin: Creating new Modbus/TCP object failed.");
     return (-1);
   }
 
+#if COLLECT_DEBUG
   modbus_set_debug (host->connection, 1);
+#endif
 
   /* We'll do the error handling ourselves. */
   modbus_set_error_recovery (host->connection, 0);
 
   status = modbus_connect (host->connection);
   if (status != 0)
@@ -374,13 +378,13 @@
 static int mb_read_data (mb_host_t *host, mb_slave_t *slave, /* {{{ */
     mb_data_t *data)
 {
   uint16_t values[2];
   int values_num;
   const data_set_t *ds;
-  int status;
+  int status = 0;
 
   if ((host == NULL) || (slave == NULL) || (data == NULL))
     return (EINVAL);
 
   ds = plugin_get_ds (data->type);
   if (ds == NULL)
@@ -411,13 +415,12 @@
       || (data->register_type == REG_TYPE_UINT32)
       || (data->register_type == REG_TYPE_FLOAT))
     values_num = 2;
   else
     values_num = 1;
 
-  status = 0;
   if (host->connection == NULL)
   {
     status = EBADF;
   }
   else
   {
@@ -674,13 +677,12 @@
   if (status != 0)
     return (status);
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *child = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Type", child->key) == 0)
       status = cf_util_get_string_buffer (child,
           data.type, sizeof (data.type));
     else if (strcasecmp ("Instance", child->key) == 0)
       status = cf_util_get_string_buffer (child,
@@ -813,13 +815,12 @@
   if (status != 0)
     return (status);
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *child = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Instance", child->key) == 0)
       status = cf_util_get_string_buffer (child,
           slave->instance, sizeof (slave->instance));
     else if (strcasecmp ("Collect", child->key) == 0)
     {
@@ -864,15 +865,21 @@
     return (ENOMEM);
   memset (host, 0, sizeof (*host));
   host->slaves = NULL;
 
   status = cf_util_get_string_buffer (ci, host->host, sizeof (host->host));
   if (status != 0)
+  {
+    sfree (host);
     return (status);
+  }
   if (host->host[0] == 0)
+  {
+    sfree (host);
     return (EINVAL);
+  }
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *child = ci->children + i;
     status = 0;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/multimeter.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/multimeter.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/multimeter.c	2012-09-13 19:10:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/multimeter.c	2016-07-19 16:42:46.639749817 +0800
@@ -150,31 +150,32 @@
 {
 	int i;
 	char device[] = "/dev/ttyS ";
 
 	for (i = 0; i < 10; i++)
 	{
-		device[strlen(device)-1] = i + '0'; 
+		device[strlen(device)-1] = i + '0';
 
-		if ((fd = open(device, O_RDWR | O_NOCTTY)) > 0)
+		if ((fd = open(device, O_RDWR | O_NOCTTY)) != -1)
 		{
 			struct termios tios;
 			int rts = TIOCM_RTS;
 			double value;
 
+			memset (&tios, 0, sizeof (tios));
 			tios.c_cflag = B1200 | CS7 | CSTOPB | CREAD | CLOCAL;
 			tios.c_iflag = IGNBRK | IGNPAR;
 	    		tios.c_oflag = 0;
 			tios.c_lflag = 0;
 			tios.c_cc[VTIME] = 3;
 			tios.c_cc[VMIN]  = LINE_LENGTH;
 
 			tcflush(fd, TCIFLUSH);
 			tcsetattr(fd, TCSANOW, &tios);
 			ioctl(fd, TIOCMBIC, &rts);
-			
+
     			if (multimeter_read_value (&value) < -1)
 			{
 				close (fd);
 				fd = -1;
 			}
 			else
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/netapp.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/netapp.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/netapp.c	2014-08-18 15:33:14.292460715 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/netapp.c	2016-07-26 15:47:12.965713813 +0800
@@ -1521,13 +1521,13 @@
  * notification. */
 static int cna_change_volume_status (const char *hostname, /* {{{ */
 		data_volume_usage_t *v)
 {
 	notification_t n;
 
-	memset (&n, 0, sizeof (&n));
+	memset (&n, 0, sizeof (n));
 	n.time = cdtime ();
 	sstrncpy (n.host, hostname, sizeof (n.host));
 	sstrncpy (n.plugin, "netapp", sizeof (n.plugin));
 	sstrncpy (n.plugin_instance, v->name, sizeof (n.plugin_instance));
 
 	if ((v->flags & IS_VOLUME_USAGE_OFFLINE) != 0) {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/network.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/network.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/network.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/network.c	2016-07-26 15:47:12.965713813 +0800
@@ -19,12 +19,13 @@
  *
  * Authors:
  *   Florian octo Forster <octo at collectd.org>
  *   Aman Gupta <aman at tmm1.net>
  **/
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE /* For struct ip_mreq */
 
 #include "collectd.h"
 #include "plugin.h"
 #include "common.h"
 #include "configfile.h"
@@ -494,12 +495,14 @@
   return (status);
 } /* }}} int network_dispatch_notification */
 
 #if HAVE_LIBGCRYPT
 static void network_init_gcrypt (void) /* {{{ */
 {
+  gcry_error_t err;
+
   /* http://lists.gnupg.org/pipermail/gcrypt-devel/2003-August/000458.html
    * Because you can't know in a library whether another library has
    * already initialized the library */
   if (gcry_control (GCRYCTL_ANY_INITIALIZATION_P))
     return;
 
@@ -508,16 +511,29 @@
   * *before* initalizing Libgcrypt with gcry_check_version(), which itself must
   * be called before any other gcry_* function. GCRYCTL_ANY_INITIALIZATION_P
   * above doesn't count, as it doesn't implicitly initalize Libgcrypt.
   *
   * tl;dr: keep all these gry_* statements in this exact order please. */
 # if GCRYPT_VERSION_NUMBER < 0x010600
-  gcry_control (GCRYCTL_SET_THREAD_CBS, &gcry_threads_pthread);
+  err = gcry_control (GCRYCTL_SET_THREAD_CBS, &gcry_threads_pthread);
+  if (err)
+  {
+    ERROR ("network plugin: gcry_control (GCRYCTL_SET_THREAD_CBS) failed: %s", gcry_strerror (err));
+    abort ();
+  }
 # endif
+
   gcry_check_version (NULL);
-  gcry_control (GCRYCTL_INIT_SECMEM, 32768);
+
+  err = gcry_control (GCRYCTL_INIT_SECMEM, 32768);
+  if (err)
+  {
+    ERROR ("network plugin: gcry_control (GCRYCTL_INIT_SECMEM) failed: %s", gcry_strerror (err));
+    abort ();
+  }
+
   gcry_control (GCRYCTL_INITIALIZATION_FINISHED);
 } /* }}} void network_init_gcrypt */
 
 static gcry_cipher_hd_t network_get_aes256_cypher (sockent_t *se, /* {{{ */
     const void *iv, size_t iv_size, const char *username)
 {
@@ -1431,12 +1447,13 @@
 			{
 				INFO ("network plugin: Unencrypted packet or "
 						"part has been ignored.");
 				printed_ignore_warning = 1;
 			}
 			buffer = ((char *) buffer) + pkg_length;
+			buffer_size -= (size_t) pkg_length;
 			continue;
 		}
 #endif /* HAVE_LIBGCRYPT */
 		else if (pkg_type == TYPE_SIGN_SHA256)
 		{
 			status = parse_part_sign_sha256 (se,
@@ -1458,12 +1475,13 @@
 			{
 				INFO ("network plugin: Unsigned packet or "
 						"part has been ignored.");
 				printed_ignore_warning = 1;
 			}
 			buffer = ((char *) buffer) + pkg_length;
+			buffer_size -= (size_t) pkg_length;
 			continue;
 		}
 #endif /* HAVE_LIBGCRYPT */
 		else if (pkg_type == TYPE_VALUES)
 		{
 			status = parse_part_values (&buffer, &buffer_size,
@@ -1599,12 +1617,13 @@
 		}
 		else
 		{
 			DEBUG ("network plugin: parse_packet: Unknown part"
 					" type: 0x%04hx", pkg_type);
 			buffer = ((char *) buffer) + pkg_length;
+			buffer_size -= (size_t) pkg_length;
 		}
 	} /* while (buffer_size > sizeof (part_header_t)) */
 
 	if (status == 0 && buffer_size > 0)
 		WARNING ("network plugin: parse_packet: Received truncated "
 				"packet, try increasing `MaxPacketSize'");
@@ -2014,12 +2033,13 @@
 	se->interface = 0;
 	se->next = NULL;
 
 	if (type == SOCKENT_TYPE_SERVER)
 	{
 		se->data.server.fd = NULL;
+		se->data.server.fd_num = 0;
 #if HAVE_LIBGCRYPT
 		se->data.server.security_level = SECURITY_LEVEL_NONE;
 		se->data.server.auth_file = NULL;
 		se->data.server.userdb = NULL;
 		se->data.server.cypher = NULL;
 #endif
@@ -2209,12 +2229,15 @@
         const char *node;
         const char *service;
 
 	if (se == NULL)
 		return (-1);
 
+	assert (se->data.server.fd == NULL);
+	assert (se->data.server.fd_num == 0);
+
         node = se->node;
         service = se->service;
 
         if (service == NULL)
           service = NET_DEFAULT_PORT;
 
@@ -2408,13 +2431,13 @@
 static int network_receive (void) /* {{{ */
 {
 	char buffer[network_config_packet_size];
 	int  buffer_len;
 
 	int i;
-	int status;
+	int status = 0;
 
 	receive_list_entry_t *private_list_head;
 	receive_list_entry_t *private_list_tail;
 	uint64_t              private_list_length;
 
         assert (listen_sockets_num > 0);
@@ -2423,21 +2446,20 @@
 	private_list_tail = NULL;
 	private_list_length = 0;
 
 	while (listen_loop == 0)
 	{
 		status = poll (listen_sockets_pollfd, listen_sockets_num, -1);
-
 		if (status <= 0)
 		{
 			char errbuf[1024];
 			if (errno == EINTR)
 				continue;
-			ERROR ("poll failed: %s",
+			ERROR ("network plugin: poll(2) failed: %s",
 					sstrerror (errno, errbuf, sizeof (errbuf)));
-			return (-1);
+			break;
 		}
 
 		for (i = 0; (i < listen_sockets_num) && (status > 0); i++)
 		{
 			receive_list_entry_t *ent;
 
@@ -2449,16 +2471,16 @@
 			buffer_len = recv (listen_sockets_pollfd[i].fd,
 					buffer, sizeof (buffer),
 					0 /* no flags */);
 			if (buffer_len < 0)
 			{
 				char errbuf[1024];
-				ERROR ("recv failed: %s",
-						sstrerror (errno, errbuf,
-							sizeof (errbuf)));
-				return (-1);
+				status = (errno != 0) ? errno : -1;
+				ERROR ("network plugin: recv(2) failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
+				break;
 			}
 
 			stats_octets_rx += ((uint64_t) buffer_len);
 			stats_packets_rx++;
 
 			/* TODO: Possible performance enhancement: Do not free
@@ -2466,21 +2488,23 @@
 			 * another list, so we don't have to allocate more and
 			 * more of these structures. */
 			ent = malloc (sizeof (receive_list_entry_t));
 			if (ent == NULL)
 			{
 				ERROR ("network plugin: malloc failed.");
-				return (-1);
+				status = ENOMEM;
+				break;
 			}
 			memset (ent, 0, sizeof (receive_list_entry_t));
 			ent->data = malloc (network_config_packet_size);
 			if (ent->data == NULL)
 			{
 				sfree (ent);
 				ERROR ("network plugin: malloc failed.");
-				return (-1);
+				status = ENOMEM;
+				break;
 			}
 			ent->fd = listen_sockets_pollfd[i].fd;
 			ent->next = NULL;
 
 			memcpy (ent->data, buffer, buffer_len);
 			ent->data_len = buffer_len;
@@ -2510,13 +2534,18 @@
 				pthread_mutex_unlock (&receive_list_lock);
 
 				private_list_head = NULL;
 				private_list_tail = NULL;
 				private_list_length = 0;
 			}
+
+			status = 0;
 		} /* for (listen_sockets_pollfd) */
+
+		if (status != 0)
+			break;
 	} /* while (listen_loop == 0) */
 
 	/* Make sure everything is dispatched before exiting. */
 	if (private_list_head != NULL)
 	{
 		pthread_mutex_lock (&receive_list_lock);
@@ -2525,21 +2554,17 @@
 			receive_list_head = private_list_head;
 		else
 			receive_list_tail->next = private_list_head;
 		receive_list_tail = private_list_tail;
 		receive_list_length += private_list_length;
 
-		private_list_head = NULL;
-		private_list_tail = NULL;
-		private_list_length = 0;
-
 		pthread_cond_signal (&receive_list_cond);
 		pthread_mutex_unlock (&receive_list_lock);
 	}
 
-	return (0);
+	return (status);
 } /* }}} int network_receive */
 
 static void *receive_thread (void __attribute__((unused)) *arg)
 {
 	return (network_receive () ? (void *) 1 : (void *) 0);
 } /* void *receive_thread */
@@ -2974,12 +2999,16 @@
     return (-1);
   }
 
   tmp = (int) ci->values[0].value.number;
   if ((tmp > 0) && (tmp <= 255))
     network_config_ttl = tmp;
+  else {
+    WARNING ("network plugin: The `TimeToLive' must be between 1 and 255.");
+    return (-1);
+  }
 
   return (0);
 } /* }}} int network_config_set_ttl */
 
 static int network_config_set_interface (const oconfig_item_t *ci, /* {{{ */
     int *interface)
@@ -3245,22 +3274,31 @@
 } /* }}} int network_config_add_server */
 
 static int network_config (oconfig_item_t *ci) /* {{{ */
 {
   int i;
 
+  /* The options need to be applied first */
+  for (i = 0; i < ci->children_num; i++)
+  {
+    oconfig_item_t *child = ci->children + i;
+    if (strcasecmp ("TimeToLive", child->key) == 0)
+      network_config_set_ttl (child);
+  }
+
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *child = ci->children + i;
 
     if (strcasecmp ("Listen", child->key) == 0)
       network_config_add_listen (child);
     else if (strcasecmp ("Server", child->key) == 0)
       network_config_add_server (child);
-    else if (strcasecmp ("TimeToLive", child->key) == 0)
-      network_config_set_ttl (child);
+    else if (strcasecmp ("TimeToLive", child->key) == 0) {
+      /* Handled earlier */
+    }
     else if (strcasecmp ("MaxPacketSize", child->key) == 0)
       network_config_set_buffer_size (child);
     else if (strcasecmp ("Forward", child->key) == 0)
       network_config_set_boolean (child, &network_config_forward);
     else if (strcasecmp ("ReportStats", child->key) == 0)
       network_config_set_boolean (child, &network_config_stats);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/notify_email.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/notify_email.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/notify_email.c	2014-08-18 15:33:14.296460794 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/notify_email.c	2016-07-26 15:47:12.965713813 +0800
@@ -290,13 +290,12 @@
 
   for (i = 0; i < recipients_len; i++)
     smtp_add_recipient (message, recipients[i]);
 
   /* Initiate a connection to the SMTP server and transfer the message. */
   if (!smtp_start_session (session)) {
-    char buf[MAXSTRING];
     ERROR ("notify_email plugin: SMTP server problem: %s",
         smtp_strerror (smtp_errno (), buf, sizeof buf));
     pthread_mutex_unlock (&session_lock);
     return (-1);
   } else {
     #if COLLECT_DEBUG
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ntpd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ntpd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ntpd.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ntpd.c	2016-07-26 15:47:12.965713813 +0800
@@ -16,12 +16,13 @@
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at collectd.org>
  **/
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE /* For NI_MAXHOST */
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
@@ -157,22 +158,22 @@
 			(v_i) = ~(v_i); \
 		} \
 	} while(0)
 /* l_fp to double */
 #define M_LFPTOD(r_i, r_uf, d) \
 	do { \
-		register int32_t  i; \
-		register uint32_t f; \
+		register int32_t  ri; \
+		register uint32_t rf; \
 		\
-		i = (r_i); \
-		f = (r_uf); \
-		if (i < 0) { \
-			M_NEG(i, f); \
-			(d) = -((double) i + ((double) f) / 4294967296.0); \
+		ri = (r_i); \
+		rf = (r_uf); \
+		if (ri < 0) { \
+			M_NEG(ri, rf); \
+			(d) = -((double) ri + ((double) rf) / 4294967296.0); \
 		} else { \
-			(d) = (double) i + ((double) f) / 4294967296.0; \
+			(d) = (double) ri + ((double) rf) / 4294967296.0; \
 		} \
 	} while (0)
 
 #define REQ_PEER_LIST_SUM 1
 struct info_peer_summary
 {
@@ -301,13 +302,13 @@
 		return (-1);
 	}
 
 	return (0);
 }
 
-static void ntpd_submit (char *type, char *type_inst, double value)
+static void ntpd_submit (char *type, char *type_inst, gauge_t value)
 {
 	value_t values[1];
 	value_list_t vl = VALUE_LIST_INIT;
 
 	values[0].gauge = value;
 
@@ -323,13 +324,13 @@
 }
 
 /* Each time a peer is polled, ntpd shifts the reach register to the left and
  * sets the LSB based on whether the peer was reachable. If the LSB is zero,
  * the values are out of date. */
 static void ntpd_submit_reach (char *type, char *type_inst, uint8_t reach,
-		double value)
+		gauge_t value)
 {
 	if (!(reach & 1))
 		value = NAN;
 
 	ntpd_submit (type, type_inst, value);
 }
@@ -478,13 +479,13 @@
 		if (timeout <= 0)
 			break;
 
 		poll_s.fd      = sd;
 		poll_s.events  = POLLIN | POLLPRI;
 		poll_s.revents = 0;
-		
+
 		DEBUG ("Polling for %ims", timeout);
 		status = poll (&poll_s, 1, timeout);
 
 		if ((status < 0) && ((errno == EAGAIN) || (errno == EINTR)))
 			continue;
 
@@ -518,13 +519,13 @@
 			sock_descr = sd = -1;
 			return (-1);
 		}
 
 		DEBUG ("recv'd %i bytes", status);
 
-		/* 
+		/*
 		 * Do some sanity checks first
 		 */
 		if (status < RESP_HEADER_SIZE)
 		{
 			WARNING ("ntpd plugin: Short (%i bytes) packet received",
 					(int) status);
@@ -661,13 +662,12 @@
 		DEBUG ("realloc (%p, %zu)", (void *) *res_data,
 				(items_num + pkt_item_num) * res_item_size);
 		items = realloc ((void *) *res_data,
 				(items_num + pkt_item_num) * res_item_size);
 		if (items == NULL)
 		{
-			items = *res_data;
 			ERROR ("ntpd plugin: realloc failed.");
 			continue;
 		}
 		items_num += pkt_item_num;
 		*res_data = items;
 
@@ -728,13 +728,13 @@
 
 	assert (((req_data != NULL) && (req_data_len > 0))
 			|| ((req_data == NULL) && (req_items == 0) && (req_size == 0)));
 
 	req.err_nitems   = ERR_NITEMS (0, req_items);
 	req.mbz_itemsize = MBZ_ITEMSIZE (req_size);
-	
+
 	if (req_data != NULL)
 		memcpy ((void *) req.data, (const void *) req_data, req_data_len);
 
 	DEBUG ("req_items = %i; req_size = %i; req_data = %p;",
 			req_items, req_size, (void *) req_data);
 
@@ -897,15 +897,25 @@
 	int                 ik_size;
 
 	struct info_peer_summary *ps;
 	int                       ps_num;
 	int                       ps_size;
 
+	gauge_t offset_loop;
+	gauge_t freq_loop;
+	gauge_t offset_error;
+
 	int status;
 	int i;
 
+	/* On Linux, if the STA_NANO bit is set in ik->status, then ik->offset
+	 * is is nanoseconds, otherwise it's microseconds.
+	 * TODO(octo): STA_NANO is defined in the Linux specific <sys/timex.h> header. */
+	double scale_loop  = 1e-6;
+	double scale_error = 1e-6;
+
 	ik      = NULL;
 	ik_num  = 0;
 	ik_size = 0;
 
 	status = ntpd_do_query (REQ_GET_KERNEL,
 			0, 0, NULL, /* request data */
@@ -922,24 +932,25 @@
 				"(ik = %p; ik_num = %i; ik_size = %i)",
 				(void *) ik, ik_num, ik_size);
 		return (-1);
 	}
 
 	/* kerninfo -> estimated error */
+	offset_loop  = scale_loop * ((gauge_t) ntohl (ik->offset));
+	freq_loop    = ntpd_read_fp (ik->freq);
+	offset_error = scale_error * ((gauge_t) ntohl (ik->esterror));
 
 	DEBUG ("info_kernel:\n"
-			"  pll offset    = %.8f\n"
-			"  pll frequency = %.8f\n" /* drift compensation */
-			"  est error     = %.8f\n",
-			ntpd_read_fp (ik->offset),
-			ntpd_read_fp (ik->freq),
-			ntpd_read_fp (ik->esterror));
-
-	ntpd_submit ("frequency_offset", "loop",  ntpd_read_fp (ik->freq));
-	ntpd_submit ("time_offset",      "loop",  ntpd_read_fp (ik->offset));
-	ntpd_submit ("time_offset",      "error", ntpd_read_fp (ik->esterror));
+			"  pll offset    = %.8g\n"
+			"  pll frequency = %.8g\n" /* drift compensation */
+			"  est error     = %.8g\n",
+			offset_loop, freq_loop, offset_error);
+
+	ntpd_submit ("frequency_offset", "loop",  freq_loop);
+	ntpd_submit ("time_offset",      "loop",  offset_loop);
+	ntpd_submit ("time_offset",      "error", offset_error);
 
 	free (ik);
 	ik = NULL;
 
 	status = ntpd_do_query (REQ_PEER_LIST_SUM,
 			0, 0, NULL, /* request data */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/onewire.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/onewire.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/onewire.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/onewire.c	2016-07-26 15:47:12.965713813 +0800
@@ -168,13 +168,12 @@
 
     endptr = NULL;
     values[0].gauge = strtod (buffer, &endptr);
     if (endptr == NULL)
     {
       ERROR ("onewire plugin: Buffer is not a number: %s", buffer);
-      status = -1;
       continue;
     }
 
     sstrncpy (vl.type, family_info->features[i].type, sizeof (vl.type));
     sstrncpy (vl.type_instance, family_info->features[i].type_instance,
         sizeof (vl.type_instance));
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/openvpn.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/openvpn.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/openvpn.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/openvpn.c	2016-07-26 15:47:12.965713813 +0800
@@ -184,14 +184,12 @@
 	tun_rx = 0;
 	tun_tx = 0;
 	pre_compress = 0;
 	post_compress = 0;
 	pre_decompress = 0;
 	post_decompress = 0;
-	overhead_rx = 0;
-	overhead_tx = 0;
 
 	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
 		fields_num = openvpn_strsplit (buffer, fields, max_fields);
 
 		/* status file is generated by openvpn/sig.c:print_status()
@@ -262,13 +260,13 @@
 
 /* for reading status version 1 */
 static int multi1_read (char *name, FILE *fh)
 {
 	char buffer[1024];
 	char *fields[10];
-	int  fields_num, read = 0, found_header = 0;
+	int  fields_num, found_header = 0;
 	long long sum_users = 0;
 
 	/* read the file until the "ROUTING TABLE" line is found (no more info after) */
 	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
 		if (strcmp (buffer, "ROUTING TABLE\n") == 0)
@@ -309,23 +307,21 @@
 				iostats_submit (fields[0],          /* "Common Name" */
 						NULL,               /* unused when in multimode */
 						atoll (fields[2]),  /* "Bytes Received" */
 						atoll (fields[3])); /* "Bytes Sent" */
 			}
 		}
-
-		read = 1;
 	}
 
+	if (ferror (fh))
+		return (0);
+
 	if (collect_user_count)
-	{
 		numusers_submit(name, name, sum_users);
-		read = 1;
-	}
 
-	return (read);
+	return (1);
 } /* int multi1_read */
 
 /* for reading status version 2 */
 static int multi2_read (char *name, FILE *fh)
 {
 	char buffer[1024];
@@ -618,21 +614,29 @@
 				return (1);
 			}
 		}
 
 		/* create a new vpn element since file, version and name are ok */
 		temp = (vpn_status_t *) malloc (sizeof (vpn_status_t));
+		if (temp == NULL)
+		{
+			char errbuf[1024];
+			ERROR ("openvpn plugin: malloc failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
+			sfree (status_file);
+			return (1);
+		}
 		temp->file = status_file;
 		temp->version = status_version;
 		temp->name = status_name;
 
 		vpn_list = (vpn_status_t **) realloc (vpn_list, (vpn_num + 1) * sizeof (vpn_status_t *));
 		if (vpn_list == NULL)
 		{
 			char errbuf[1024];
-			ERROR ("openvpn plugin: malloc failed: %s",
+			ERROR ("openvpn plugin: realloc failed: %s",
 					sstrerror (errno, errbuf, sizeof (errbuf)));
 
 			sfree (temp->file);
 			sfree (temp);
 			return (1);
 		}
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/perl.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/perl.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/perl.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/perl.c	2016-07-26 15:47:12.965713813 +0800
@@ -21,13 +21,13 @@
 
 /*
  * This plugin embeds a Perl interpreter into collectd and provides an
  * interface for collectd plugins written in perl.
  */
 
-/* do not automatically get the thread specific perl interpreter */
+/* do not automatically get the thread specific Perl interpreter */
 #define PERL_NO_GET_CONTEXT
 
 #define DONT_POISON_SPRINTF_YET 1
 #include "collectd.h"
 #undef DONT_POISON_SPRINTF_YET
 
@@ -114,12 +114,15 @@
  * private data types
  */
 
 typedef struct c_ithread_s {
 	/* the thread's Perl interpreter */
 	PerlInterpreter *interp;
+	_Bool running;  /* thread is inside Perl interpreter */
+	_Bool shutdown;
+	pthread_t pthread;
 
 	/* double linked list of threads */
 	struct c_ithread_s *prev;
 	struct c_ithread_s *next;
 } c_ithread_t;
 
@@ -130,12 +133,13 @@
 #if COLLECT_DEBUG
 	/* some usage stats */
 	int number_of_threads;
 #endif /* COLLECT_DEBUG */
 
 	pthread_mutex_t mutex;
+	pthread_mutexattr_t mutexattr;
 } c_ithread_list_t;
 
 /* name / user_data for Perl matches / targets */
 typedef struct {
 	char *name;
 	SV   *user_data;
@@ -507,13 +511,12 @@
 		}
 		sstrncpy ((*m)->name, SvPV_nolen (*tmp), sizeof ((*m)->name));
 
 		if (NULL == (tmp = hv_fetch (hash, "value", 5, 0))) {
 			log_warn ("av2notification_meta: Skipping invalid "
 					"meta information.");
-			free ((*m)->name);
 			free (*m);
 			continue;
 		}
 
 		if (SvNOK (*tmp)) {
 			(*m)->nm_value.nm_double = SvNVX (*tmp);
@@ -1000,12 +1003,38 @@
 	ret = plugin_dispatch_notification (&n);
 	plugin_notification_meta_free (n.meta);
 	return ret;
 } /* static int pplugin_dispatch_notification (HV *) */
 
 /*
+ * Call perl sub with thread locking flags handled.
+ */
+static int call_pv_locked (pTHX_ const char* sub_name)
+{
+	_Bool old_running;
+	int ret;
+
+	c_ithread_t *t = (c_ithread_t *)pthread_getspecific(perl_thr_key);
+	if (t == NULL) /* thread destroyed */
+		return 0;
+
+	old_running = t->running;
+	t->running = 1;
+
+	if (t->shutdown) {
+		t->running = old_running;
+		return 0;
+	}
+
+	ret = call_pv (sub_name, G_SCALAR);
+
+	t->running = old_running;
+	return ret;
+} /* static int call_pv_locked (pTHX, *sub_name) */
+
+/*
  * Call all working functions of the given type.
  */
 static int pplugin_call_all (pTHX_ int type, ...)
 {
 	int retvals = 0;
 
@@ -1128,13 +1157,13 @@
 		XPUSHs (sv_2mortal (newSVnv (CDTIME_T_TO_DOUBLE (timeout))));
 		XPUSHs (sv_2mortal (newSVpv (va_arg (ap, char *), 0)));
 	}
 
 	PUTBACK;
 
-	retvals = call_pv ("Collectd::plugin_call_all", G_SCALAR);
+	retvals = call_pv_locked (aTHX_ "Collectd::plugin_call_all");
 
 	SPAGAIN;
 	if (0 < retvals) {
 		SV *tmp = POPs;
 		if (! SvTRUE (tmp))
 			ret = -1;
@@ -1146,13 +1175,13 @@
 
 	va_end (ap);
 	return ret;
 } /* static int pplugin_call_all (int, ...) */
 
 /*
- * collectd's perl interpreter based thread implementation.
+ * collectd's Perl interpreter based thread implementation.
  *
  * This has been inspired by Perl's ithreads introduced in version 5.6.0.
  */
 
 /* must be called with perl_threads->mutex locked */
 static void c_ithread_destroy (c_ithread_t *ithread)
@@ -1200,13 +1229,16 @@
 	for (t = perl_threads->head; NULL != t; t = t->next)
 		if (t == ithread)
 			break;
 
 	/* the ithread no longer exists */
 	if (NULL == t)
+	{
+		pthread_mutex_unlock (&perl_threads->mutex);
 		return;
+	}
 
 	c_ithread_destroy (ithread);
 
 	pthread_mutex_unlock (&perl_threads->mutex);
 	return;
 } /* static void c_ithread_destructor (void *) */
@@ -1246,12 +1278,15 @@
 	}
 	else {
 		perl_threads->tail->next = t;
 		t->prev = perl_threads->tail;
 	}
 
+	t->pthread = pthread_self();
+	t->running = 0;
+	t->shutdown = 0;
 	perl_threads->tail = t;
 
 	pthread_setspecific (perl_thr_key, (const void *)t);
 	return t;
 } /* static c_ithread_t *c_ithread_create (PerlInterpreter *) */
 
@@ -1366,13 +1401,13 @@
 	}
 
 	XPUSHs (sv_2mortal (newRV_inc (data->user_data)));
 
 	PUTBACK;
 
-	retvals = call_pv ("Collectd::fc_call", G_SCALAR);
+	retvals = call_pv_locked (aTHX_ "Collectd::fc_call");
 
 	if ((FC_CB_EXEC == cb_type) && (meta != NULL)) {
 		assert (pmeta != NULL);
 
 		plugin_notification_meta_free (*meta);
 		av2notification_meta (aTHX_ pmeta, meta);
@@ -1641,21 +1676,21 @@
 
 	log_debug ("Collectd::plugin_dispatch_values: values=\"%s\"",
 			SvPV_nolen (ST (/* stack index = */ 0)));
 
 	values = ST (/* stack index = */ 0);
 
+	if (NULL == values)
+		XSRETURN_EMPTY;
+
 	/* Make sure the argument is a hash reference. */
 	if (! (SvROK (values) && (SVt_PVHV == SvTYPE (SvRV (values))))) {
 		log_err ("Collectd::plugin_dispatch_values: Invalid values.");
 		XSRETURN_EMPTY;
 	}
 
-	if (NULL == values)
-		XSRETURN_EMPTY;
-
 	ret = pplugin_dispatch_values (aTHX_ (HV *)SvRV (values));
 
 	if (0 == ret)
 		XSRETURN_YES;
 	else
 		XSRETURN_EMPTY;
@@ -1906,12 +1941,13 @@
 /*
  * Interface to collectd.
  */
 
 static int perl_init (void)
 {
+	int status;
 	dTHX;
 
 	if (NULL == perl_threads)
 		return 0;
 
 	if (NULL == aTHX) {
@@ -1923,13 +1959,25 @@
 
 		aTHX = t->interp;
 	}
 
 	log_debug ("perl_init: c_ithread: interp = %p (active threads: %i)",
 			aTHX, perl_threads->number_of_threads);
-	return pplugin_call_all (aTHX_ PLUGIN_INIT);
+
+	/* Lock the base thread to avoid race conditions with c_ithread_create().
+	 * See https://github.com/collectd/collectd/issues/9 and
+	 *     https://github.com/collectd/collectd/issues/1706 for details.
+	*/
+	assert (aTHX == perl_threads->head->interp);
+	pthread_mutex_lock (&perl_threads->mutex);
+
+	status = pplugin_call_all (aTHX_ PLUGIN_INIT);
+
+	pthread_mutex_unlock (&perl_threads->mutex);
+
+	return status;
 } /* static int perl_init (void) */
 
 static int perl_read (void)
 {
 	dTHX;
 
@@ -2008,13 +2056,15 @@
 
 		aTHX = t->interp;
 	}
 
 	/* Lock the base thread if this is not called from one of the read threads
 	 * to avoid race conditions with c_ithread_create(). See
-	 * https://github.com/collectd/collectd/issues/9 for details. */
+	 * https://github.com/collectd/collectd/issues/9 for details.
+	*/
+
 	if (aTHX == perl_threads->head->interp)
 		pthread_mutex_lock (&perl_threads->mutex);
 
 	pplugin_call_all (aTHX_ PLUGIN_LOG, level, msg);
 
 	if (aTHX == perl_threads->head->interp)
@@ -2074,13 +2124,13 @@
 	plugin_unregister_complex_config ("perl");
 
 	if (NULL == perl_threads)
 		return 0;
 
 	if (NULL == aTHX) {
-		c_ithread_t *t = NULL;
+		t = NULL;
 
 		pthread_mutex_lock (&perl_threads->mutex);
 		t = c_ithread_create (perl_threads->head->interp);
 		pthread_mutex_unlock (&perl_threads->mutex);
 
 		aTHX = t->interp;
@@ -2099,23 +2149,37 @@
 	ret = pplugin_call_all (aTHX_ PLUGIN_SHUTDOWN);
 
 	pthread_mutex_lock (&perl_threads->mutex);
 	t = perl_threads->tail;
 
 	while (NULL != t) {
+		struct timespec ts_wait;
 		c_ithread_t *thr = t;
 
 		/* the pointer has to be advanced before destroying
 		 * the thread as this will free the memory */
 		t = t->prev;
 
+		thr->shutdown = 1;
+		if (thr->running) {
+			/* Give some time to thread to exit from Perl interpreter */
+			WARNING ("perl shutdown: Thread is running inside Perl. Waiting.");
+			ts_wait.tv_sec = 0;
+			ts_wait.tv_nsec = 500000;
+			nanosleep (&ts_wait, NULL);
+		}
+		if (thr->running) {
+			pthread_kill (thr->pthread, SIGTERM);
+			ERROR ("perl shutdown: Thread hangs inside Perl. Thread killed.");
+		}
 		c_ithread_destroy (thr);
 	}
 
 	pthread_mutex_unlock (&perl_threads->mutex);
 	pthread_mutex_destroy (&perl_threads->mutex);
+	pthread_mutexattr_destroy (&perl_threads->mutexattr);
 
 	sfree (perl_threads);
 
 	pthread_key_delete (perl_thr_key);
 
 	PERL_SYS_TERM ();
@@ -2253,13 +2317,15 @@
 #endif
 	PERL_SYS_INIT3 (&argc, &argv, &environ);
 
 	perl_threads = (c_ithread_list_t *)smalloc (sizeof (c_ithread_list_t));
 	memset (perl_threads, 0, sizeof (c_ithread_list_t));
 
-	pthread_mutex_init (&perl_threads->mutex, NULL);
+	pthread_mutexattr_init(&perl_threads->mutexattr);
+	pthread_mutexattr_settype(&perl_threads->mutexattr, PTHREAD_MUTEX_RECURSIVE);
+	pthread_mutex_init (&perl_threads->mutex, &perl_threads->mutexattr);
 	/* locking the mutex should not be necessary at this point
 	 * but let's just do it for the sake of completeness */
 	pthread_mutex_lock (&perl_threads->mutex);
 
 	perl_threads->head = c_ithread_create (NULL);
 	perl_threads->tail = perl_threads->head;
@@ -2334,13 +2400,13 @@
 
 	assert (NULL != perl_threads);
 	assert (NULL != perl_threads->head);
 
 	aTHX = perl_threads->head->interp;
 
-	log_debug ("perl_config: loading perl plugin \"%s\"", value);
+	log_debug ("perl_config: Loading Perl plugin \"%s\"", value);
 	load_module (PERL_LOADMOD_NOIMPORT,
 			newSVpv (module_name, strlen (module_name)), Nullsv);
 	return 0;
 } /* static int perl_config_loadplugin (oconfig_item_it *) */
 
 /*
@@ -2507,13 +2573,16 @@
 
 	for (i = 0; i < ci->children_num; ++i) {
 		oconfig_item_t *c = ci->children + i;
 		int current_status = 0;
 
 		if (NULL != perl_threads)
-			aTHX = PERL_GET_CONTEXT;
+		{
+			if ((aTHX = PERL_GET_CONTEXT) == NULL)
+				return -1;
+		}
 
 		if (0 == strcasecmp (c->key, "LoadPlugin"))
 			current_status = perl_config_loadplugin (aTHX_ c);
 		else if (0 == strcasecmp (c->key, "BaseName"))
 			current_status = perl_config_basename (aTHX_ c);
 		else if (0 == strcasecmp (c->key, "EnableDebugger"))
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/pf.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/pf.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/pf.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/pf.c	2016-07-26 15:47:12.965713813 +0800
@@ -25,12 +25,15 @@
 #if HAVE_SYS_SOCKET_H
 # include <sys/socket.h>
 #endif
 #if HAVE_NET_IF_H
 # include <net/if.h>
 #endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
 
 #include <net/pfvar.h>
 
 #ifndef FCNT_NAMES
 # if FCNT_MAX != 3
 #  error "Unexpected value for FCNT_MAX"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/pinba.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/pinba.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/pinba.c	2015-02-26 19:44:34.035896566 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/pinba.c	2016-07-26 15:47:12.965713813 +0800
@@ -333,12 +333,13 @@
   status = bind (fd, ai->ai_addr, ai->ai_addrlen);
   if (status != 0)
   {
     char errbuf[1024];
     ERROR ("pinba plugin: bind(2) failed: %s",
         sstrerror (errno, errbuf, sizeof (errbuf)));
+    close (fd);
     return (0);
   }
 
   s->fd[s->fd_num].fd = fd;
   s->fd[s->fd_num].events = POLLIN | POLLPRI;
   s->fd[s->fd_num].revents = 0;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ping.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ping.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ping.c	2015-02-26 18:43:48.484180745 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ping.c	2016-07-26 15:47:12.965713813 +0800
@@ -233,13 +233,13 @@
 
   return (0);
 } /* }}} int ping_dispatch_all */
 
 static void *ping_thread (void *arg) /* {{{ */
 {
-  static pingobj_t *pingobj = NULL;
+  pingobj_t *pingobj = NULL;
 
   struct timeval  tv_begin;
   struct timeval  tv_end;
   struct timespec ts_wait;
   struct timespec ts_int;
 
@@ -351,13 +351,13 @@
     }
 
     /* Calculate the absolute time until which to wait and store it in
      * `ts_wait'. */
     time_calc (&ts_wait, &ts_int, &tv_begin, &tv_end);
 
-    status = pthread_cond_timedwait (&ping_cond, &ping_lock, &ts_wait);
+    pthread_cond_timedwait (&ping_cond, &ping_lock, &ts_wait);
     if (ping_thread_loop <= 0)
       break;
   } /* while (ping_thread_loop > 0) */
 
   pthread_mutex_unlock (&ping_lock);
   ping_destroy (pingobj);
@@ -413,14 +413,16 @@
   if (status != 0)
   {
     ERROR ("ping plugin: Stopping thread failed.");
     status = -1;
   }
 
+  pthread_mutex_lock (&ping_lock);
   memset (&ping_thread_id, 0, sizeof (ping_thread_id));
   ping_thread_error = 0;
+  pthread_mutex_unlock (&ping_lock);
 
   return (status);
 } /* }}} int stop_thread */
 
 static int ping_init (void) /* {{{ */
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/plugin.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/plugin.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/plugin.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/plugin.c	2016-07-26 15:47:12.965713813 +0800
@@ -178,19 +178,19 @@
 {
 	if (read_heap == NULL)
 		return;
 
 	while (42)
 	{
-		callback_func_t *cf;
+		read_func_t *rf;
 
-		cf = c_heap_get_root (read_heap);
-		if (cf == NULL)
+		rf = c_heap_get_root (read_heap);
+		if (rf == NULL)
 			break;
-
-		destroy_callback (cf);
+		sfree (rf->rf_name);
+		destroy_callback ((callback_func_t *) rf);
 	}
 
 	c_heap_destroy (read_heap);
 	read_heap = NULL;
 } /* }}} void destroy_read_heap */
 
@@ -867,13 +867,13 @@
 
 	status = c_avl_insert (plugins_loaded,
 			/* key = */ name_copy, /* value = */ NULL);
 	return (status);
 }
 
-static void plugin_free_loaded ()
+static void plugin_free_loaded (void)
 {
 	void *key;
 	void *value;
 
 	if (plugins_loaded == NULL)
 		return;
@@ -892,13 +892,12 @@
 int plugin_load (char const *plugin_name, uint32_t flags)
 {
 	DIR  *dh;
 	const char *dir;
 	char  filename[BUFSIZE] = "";
 	char  typename[BUFSIZE];
-	int   typename_len;
 	int   ret;
 	struct stat    statbuf;
 	struct dirent *de;
 	int status;
 
 	if (plugin_name == NULL)
@@ -932,25 +931,24 @@
 	status = ssnprintf (typename, sizeof (typename), "%s.so", plugin_name);
 	if ((status < 0) || ((size_t) status >= sizeof (typename)))
 	{
 		WARNING ("plugin_load: Filename too long: \"%s.so\"", plugin_name);
 		return (-1);
 	}
-	typename_len = strlen (typename);
 
 	if ((dh = opendir (dir)) == NULL)
 	{
 		char errbuf[1024];
 		ERROR ("plugin_load: opendir (%s) failed: %s", dir,
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 
 	while ((de = readdir (dh)) != NULL)
 	{
-		if (strncasecmp (de->d_name, typename, typename_len))
+		if (strcasecmp (de->d_name, typename))
 			continue;
 
 		status = ssnprintf (filename, sizeof (filename),
 				"%s/%s", dir, de->d_name);
 		if ((status < 0) || ((size_t) status >= sizeof (filename)))
 		{
@@ -1132,14 +1130,16 @@
 	rf->rf_group[0] = '\0';
 	rf->rf_name = strdup (name);
 	rf->rf_type = RF_SIMPLE;
 	rf->rf_interval = plugin_get_interval ();
 
 	status = plugin_insert_read (rf);
-	if (status != 0)
+	if (status != 0) {
+		sfree (rf->rf_name);
 		sfree (rf);
+	}
 
 	return (status);
 } /* int plugin_register_read */
 
 int plugin_register_complex_read (const char *group, const char *name,
 		plugin_read_cb callback,
@@ -1180,14 +1180,16 @@
 		rf->rf_udata = *user_data;
 	}
 
 	rf->rf_ctx = plugin_get_ctx ();
 
 	status = plugin_insert_read (rf);
-	if (status != 0)
+	if (status != 0) {
+		sfree (rf->rf_name);
 		sfree (rf);
+	}
 
 	return (status);
 } /* int plugin_register_complex_read */
 
 int plugin_register_write (const char *name,
 		plugin_write_cb callback, user_data_t *ud)
@@ -1453,13 +1455,12 @@
 	return (plugin_unregister (list_notification, name));
 }
 
 void plugin_init_all (void)
 {
 	char const *chain_name;
-	long write_threads_num;
 	llentry_t *le;
 	int status;
 
 	/* Init the value cache */
 	uc_init ();
 
@@ -1496,14 +1497,12 @@
 	if (write_threads_num < 1)
 	{
 		ERROR ("WriteThreads must be positive.");
 		write_threads_num = 5;
 	}
 
-	start_write_threads ((size_t) write_threads_num);
-
 	if ((list_init == NULL) && (read_heap == NULL))
 		return;
 
 	/* Calling all init callbacks before checking if read callbacks
 	 * are available allows the init callbacks to register the read
 	 * callback. */
@@ -1533,12 +1532,14 @@
 			plugin_unregister_read (le->key);
 		}
 
 		le = le->next;
 	}
 
+	start_write_threads ((size_t) write_threads_num);
+
 	/* Start read-threads */
 	if (read_heap != NULL)
 	{
 		const char *rt;
 		int num;
 		rt = global_option_get ("ReadThreads");
@@ -1600,12 +1601,13 @@
 		{
 			NOTICE ("read-function of plugin `%s' failed.",
 					rf->rf_name);
 			return_status = -1;
 		}
 
+		sfree (rf->rf_name);
 		destroy_callback ((void *) rf);
 	}
 
 	return (return_status);
 } /* int plugin_read_all_once */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/plugin.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/plugin.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/plugin.h	2015-02-26 19:44:34.035896566 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/plugin.h	2016-07-26 15:47:12.965713813 +0800
@@ -396,7 +396,13 @@
  * Context-aware thread management.
  */
 
 int plugin_thread_create (pthread_t *thread, const pthread_attr_t *attr,
 		void *(*start_routine) (void *), void *arg);
 
+/*
+ * Plugins need to implement this
+ */
+
+void module_register (void);
+
 #endif /* PLUGIN_H */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/postgresql.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/postgresql.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/postgresql.c	2015-02-26 18:43:48.488180825 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/postgresql.c	2016-07-26 15:47:12.965713813 +0800
@@ -772,13 +772,13 @@
 			sfree (rates);
 			return NULL;
 		}
 
 		if (ds->ds[i].type == DS_TYPE_GAUGE)
 			status = ssnprintf (str_ptr, str_len,
-					",%f", vl->values[i].gauge);
+					","GAUGE_FORMAT, vl->values[i].gauge);
 		else if (store_rates) {
 			if (rates == NULL)
 				rates = uc_get_rate (ds, vl);
 
 			if (rates == NULL) {
 				log_err ("c_psql_write: Failed to determine rate");
@@ -1039,23 +1039,25 @@
 	const char *param_str;
 
 	c_psql_param_t *tmp;
 
 	data = udb_query_get_user_data (q);
 	if (NULL == data) {
-		data = (c_psql_user_data_t *) smalloc (sizeof (*data));
+		data = malloc (sizeof (*data));
 		if (NULL == data) {
 			log_err ("Out of memory.");
 			return -1;
 		}
 		memset (data, 0, sizeof (*data));
 		data->params = NULL;
+		data->params_num = 0;
+
+		udb_query_set_user_data (q, data);
 	}
 
-	tmp = (c_psql_param_t *) realloc (data->params,
-			(data->params_num + 1) * sizeof (c_psql_param_t));
+	tmp = realloc (data->params, (data->params_num + 1) * sizeof (*data->params));
 	if (NULL == tmp) {
 		log_err ("Out of memory.");
 		return -1;
 	}
 	data->params = tmp;
 
@@ -1073,14 +1075,12 @@
 	else {
 		log_err ("Invalid parameter \"%s\".", param_str);
 		return 1;
 	}
 
 	data->params_num++;
-	udb_query_set_user_data (q, data);
-
 	return (0);
 } /* config_query_param_add */
 
 static int config_query_callback (udb_query_t *q, oconfig_item_t *ci)
 {
 	if (0 == strcasecmp ("Param", ci->key))
@@ -1158,13 +1158,13 @@
 		log_err ("Out of memory.");
 		return -1;
 	}
 
 	writers = tmp;
 	writer  = writers + writers_num;
-	++writers_num;
+	memset (writer, 0, sizeof (*writer));
 
 	writer->name = sstrdup (ci->values[0].value.string);
 	writer->statement = NULL;
 	writer->store_rates = 1;
 
 	for (i = 0; i < ci->children_num; ++i) {
@@ -1178,16 +1178,16 @@
 			log_warn ("Ignoring unknown config key \"%s\".", c->key);
 	}
 
 	if (status != 0) {
 		sfree (writer->statement);
 		sfree (writer->name);
-		sfree (writer);
 		return status;
 	}
 
+	++writers_num;
 	return 0;
 } /* c_psql_config_writer */
 
 static int c_psql_config_database (oconfig_item_t *ci)
 {
 	c_psql_database_t *db;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/powerdns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/powerdns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/powerdns.c	2015-02-26 18:43:48.488180825 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/powerdns.c	2016-07-26 15:47:12.965713813 +0800
@@ -81,16 +81,16 @@
   char *type_instance;
 };
 typedef struct statname_lookup_s statname_lookup_t;
 
 /* Description of statistics returned by the recursor: {{{
 all-outqueries      counts the number of outgoing UDP queries since starting
-answers0-1          counts the number of queries answered within 1 milisecond
+answers0-1          counts the number of queries answered within 1 millisecond
 answers100-1000     counts the number of queries answered within 1 second
-answers10-100       counts the number of queries answered within 100 miliseconds
-answers1-10         counts the number of queries answered within 10 miliseconds
+answers10-100       counts the number of queries answered within 100 milliseconds
+answers1-10         counts the number of queries answered within 10 milliseconds
 answers-slow        counts the number of queries answered after 1 second
 cache-entries       shows the number of entries in the cache
 cache-hits          counts the number of cache hits since starting
 cache-misses        counts the number of cache misses since starting
 chain-resends       number of queries chained to existing outstanding query
 client-parse-errors counts number of client packets that could not be parsed
@@ -120,13 +120,13 @@
 uptime              number of seconds process has been running (since 3.1.5)
 user-msec           number of CPU milliseconds spent in 'user' mode
 }}} */
 
 const char* const default_server_fields[] = /* {{{ */
 {
-  "latency"
+  "latency",
   "packetcache-hit",
   "packetcache-miss",
   "packetcache-size",
   "query-cache-hit",
   "query-cache-miss",
   "recursing-answers",
@@ -256,22 +256,22 @@
   int i;
 
   for (i = 0; i < lookup_table_length; i++)
     if (strcmp (lookup_table[i].name, pdns_type) == 0)
       break;
 
-  if (lookup_table[i].type == NULL)
-    return;
-
   if (i >= lookup_table_length)
   {
     INFO ("powerdns plugin: submit: Not found in lookup table: %s = %s;",
         pdns_type, value);
     return;
   }
 
+  if (lookup_table[i].type == NULL)
+    return;
+
   type = lookup_table[i].type;
   type_instance = lookup_table[i].type_instance;
 
   ds = plugin_get_ds (type);
   if (ds == NULL)
   {
@@ -444,12 +444,18 @@
   }
 
   struct timeval timeout;
   timeout.tv_sec=5;
   timeout.tv_usec=0;
   status = setsockopt (sd, SOL_SOCKET, SO_RCVTIMEO, &timeout, sizeof (timeout));
+  if (status != 0)
+  {
+    FUNC_ERROR ("setsockopt");
+    close (sd);
+    return (-1);
+  }
 
   status = connect (sd, (struct sockaddr *) &item->sockaddr,
       sizeof (item->sockaddr));
   if (status != 0)
   {
     FUNC_ERROR ("connect");
@@ -491,13 +497,12 @@
 
     memcpy (buffer + buffer_size, temp, status);
     buffer_size += status;
     buffer[buffer_size] = 0;
   } /* while (42) */
   close (sd);
-  sd = -1;
 
   if (status < 0)
   {
     sfree (buffer);
   }
   else
@@ -714,31 +719,12 @@
   sfree (buffer);
   sfree (keys_list);
 
   return (0);
 } /* }}} int powerdns_read_recursor */
 
-static int powerdns_config_add_string (const char *name, /* {{{ */
-    char **dest,
-    oconfig_item_t *ci)
-{
-  if ((ci->values_num != 1) || (ci->values[0].type != OCONFIG_TYPE_STRING))
-  {
-    WARNING ("powerdns plugin: `%s' needs exactly one string argument.",
-	name);
-    return (-1);
-  }
-
-  sfree (*dest);
-  *dest = strdup (ci->values[0].value.string);
-  if (*dest == NULL)
-    return (-1);
-
-  return (0);
-} /* }}} int powerdns_config_add_string */
-
 static int powerdns_config_add_collect (list_item_t *li, /* {{{ */
     oconfig_item_t *ci)
 {
   int i;
   char **temp;
 
@@ -843,13 +829,13 @@
   {
     oconfig_item_t *option = ci->children + i;
 
     if (strcasecmp ("Collect", option->key) == 0)
       status = powerdns_config_add_collect (item, option);
     else if (strcasecmp ("Socket", option->key) == 0)
-      status = powerdns_config_add_string ("Socket", &socket_temp, option);
+      status = cf_util_get_string (option, &socket_temp);
     else
     {
       ERROR ("powerdns plugin: Option `%s' not allowed here.", option->key);
       status = -1;
     }
 
@@ -883,18 +869,20 @@
 
     break;
   }
 
   if (status != 0)
   {
+    sfree (socket_temp);
     sfree (item);
     return (-1);
   }
 
   DEBUG ("powerdns plugin: Add server: instance = %s;", item->instance);
 
+  sfree (socket_temp);
   return (0);
 } /* }}} int powerdns_config_add_server */
 
 static int powerdns_config (oconfig_item_t *ci) /* {{{ */
 {
   int i;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/processes.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/processes.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/processes.c	2015-02-26 19:44:34.035896566 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/processes.c	2016-07-26 15:47:12.969713822 +0800
@@ -109,14 +109,35 @@
 #define MAXPROCENTRY 32
 #define MAXTHRDENTRY 16
 #define MAXARGLN 1024
 /* #endif HAVE_PROCINFO_H */
 
 #elif KERNEL_SOLARIS
+/* Hack: Avoid #error when building a 32-bit binary with
+ * _FILE_OFFSET_BITS=64. There is a reason for this #error, as one
+ * of the structures in <sys/procfs.h> uses an off_t, but that
+ * isn't relevant to our usage of procfs. */
+#if !defined(_LP64) && _FILE_OFFSET_BITS == 64
+#  define SAVE_FOB_64
+#  undef _FILE_OFFSET_BITS
+#endif
+
 # include <procfs.h>
+
+#ifdef SAVE_FOB_64
+#  define _FILE_OFFSET_BITS 64
+#  undef SAVE_FOB_64
+#endif
+
+# include <sys/user.h>
 # include <dirent.h>
+
+#ifndef MAXCOMLEN
+#  define MAXCOMLEN 16
+#endif
+
 /* #endif KERNEL_SOLARIS */
 
 #else
 # error "No applicable input method."
 #endif
 
@@ -258,12 +279,13 @@
 
 		status = regcomp (new->re, regexp, REG_EXTENDED | REG_NOSUB);
 		if (status != 0)
 		{
 			DEBUG ("ProcessMatch: compiling the regular expression \"%s\" failed.", regexp);
 			sfree(new->re);
+			sfree(new);
 			return;
 		}
 	}
 #else
 	if (regexp != NULL)
 	{
@@ -283,13 +305,15 @@
 		{
 			WARNING ("processes plugin: You have configured more "
 					"than one `Process' or "
 					"`ProcessMatch' with the same name. "
 					"All but the first setting will be "
 					"ignored.");
+#if HAVE_REGEX_H
 			sfree (new->re);
+#endif
 			sfree (new);
 			return;
 		}
 
 		if (ptr->next == NULL)
 			break;
@@ -525,12 +549,18 @@
 
 /* put all pre-defined 'Process' names from config to list_head_g tree */
 static int ps_config (oconfig_item_t *ci)
 {
 	int i;
 
+#if KERNEL_LINUX
+	const size_t max_procname_len = 15;
+#elif KERNEL_SOLARIS || KERNEL_FREEBSD
+	const size_t max_procname_len = MAXCOMLEN -1;
+#endif
+
 	for (i = 0; i < ci->children_num; ++i) {
 		oconfig_item_t *c = ci->children + i;
 
 		if (strcasecmp (c->key, "Process") == 0)
 		{
 			if ((c->values_num != 1)
@@ -545,12 +575,21 @@
 				WARNING ("processes plugin: the `Process' config option "
 						"does not expect any child elements -- ignoring "
 						"content (%i elements) of the <Process '%s'> block.",
 						c->children_num, c->values[0].value.string);
 			}
 
+#if KERNEL_LINUX || KERNEL_SOLARIS || KERNEL_FREEBSD
+			if (strlen (c->values[0].value.string) > max_procname_len) {
+				WARNING ("processes plugin: this platform has a %zu character limit "
+						"to process names. The `Process \"%s\"' option will "
+						"not work as expected.",
+						max_procname_len, c->values[0].value.string);
+			}
+#endif
+
 			ps_list_register (c->values[0].value.string, NULL);
 		}
 		else if (strcasecmp (c->key, "ProcessMatch") == 0)
 		{
 			if ((c->values_num != 2)
 					|| (OCONFIG_TYPE_STRING != c->values[0].type)
@@ -756,20 +795,20 @@
 	plugin_dispatch_values(&vl);
 }
 #endif /* KERNEL_LINUX || KERNEL_SOLARIS*/
 
 /* ------- additional functions for KERNEL_LINUX/HAVE_THREAD_INFO ------- */
 #if KERNEL_LINUX
-static int ps_read_tasks (int pid)
+static int ps_read_tasks (long pid)
 {
 	char           dirname[64];
 	DIR           *dh;
 	struct dirent *ent;
 	int count = 0;
 
-	ssnprintf (dirname, sizeof (dirname), "/proc/%i/task", pid);
+	ssnprintf (dirname, sizeof (dirname), "/proc/%li/task", pid);
 
 	if ((dh = opendir (dirname)) == NULL)
 	{
 		DEBUG ("Failed to open directory `%s'", dirname);
 		return (-1);
 	}
@@ -784,24 +823,24 @@
 	closedir (dh);
 
 	return ((count >= 1) ? count : 1);
 } /* int *ps_read_tasks */
 
 /* Read advanced virtual memory data from /proc/pid/status */
-static procstat_t *ps_read_vmem (int pid, procstat_t *ps)
+static procstat_t *ps_read_vmem (long pid, procstat_t *ps)
 {
 	FILE *fh;
 	char buffer[1024];
 	char filename[64];
 	unsigned long long lib = 0;
 	unsigned long long exe = 0;
 	unsigned long long data = 0;
 	char *fields[8];
 	int numfields;
 
-	ssnprintf (filename, sizeof (filename), "/proc/%i/status", pid);
+	ssnprintf (filename, sizeof (filename), "/proc/%li/status", pid);
 	if ((fh = fopen (filename, "r")) == NULL)
 		return (NULL);
 
 	while (fgets (buffer, sizeof(buffer), fh) != NULL)
 	{
 		long long tmp;
@@ -846,22 +885,22 @@
 	ps->vmem_data = data * 1024;
 	ps->vmem_code = (exe + lib) * 1024;
 
 	return (ps);
 } /* procstat_t *ps_read_vmem */
 
-static procstat_t *ps_read_io (int pid, procstat_t *ps)
+static procstat_t *ps_read_io (long pid, procstat_t *ps)
 {
 	FILE *fh;
 	char buffer[1024];
 	char filename[64];
 
 	char *fields[8];
 	int numfields;
 
-	ssnprintf (filename, sizeof (filename), "/proc/%i/io", pid);
+	ssnprintf (filename, sizeof (filename), "/proc/%li/io", pid);
 	if ((fh = fopen (filename, "r")) == NULL)
 		return (NULL);
 
 	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
 		derive_t *val = NULL;
@@ -901,13 +940,13 @@
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 	}
 
 	return (ps);
 } /* procstat_t *ps_read_io */
 
-int ps_read_process (int pid, procstat_t *ps, char *state)
+static int ps_read_process (long pid, procstat_t *ps, char *state)
 {
 	char  filename[64];
 	char  buffer[1024];
 
 	char *fields[64];
 	char  fields_len;
@@ -924,13 +963,13 @@
 	long long unsigned vmem_size;
 	long long unsigned vmem_rss;
 	long long unsigned stack_size;
 
 	memset (ps, 0, sizeof (procstat_t));
 
-	ssnprintf (filename, sizeof (filename), "/proc/%i/stat", pid);
+	ssnprintf (filename, sizeof (filename), "/proc/%li/stat", pid);
 
 	buffer_len = read_file_contents (filename,
 			buffer, sizeof(buffer) - 1);
 	if (buffer_len <= 0)
 		return (-1);
 	buffer[buffer_len] = 0;
@@ -969,15 +1008,15 @@
 		return (-1);
 	buffer_ptr = &buffer[name_end_pos + 2];
 
 	fields_len = strsplit (buffer_ptr, fields, STATIC_ARRAY_SIZE (fields));
 	if (fields_len < 22)
 	{
-		DEBUG ("processes plugin: ps_read_process (pid = %i):"
+		DEBUG ("processes plugin: ps_read_process (pid = %li):"
 				" `%s' has only %i fields..",
-				(int) pid, filename, fields_len);
+				pid, filename, fields_len);
 		return (-1);
 	}
 
 	*state = fields[0][0];
 
 	if (*state == 'Z')
@@ -995,13 +1034,13 @@
 		ps->num_proc = 1;
 	}
 
 	/* Leave the rest at zero if this is only a zombi */
 	if (ps->num_proc == 0)
 	{
-		DEBUG ("processes plugin: This is only a zombi: pid = %i; "
+		DEBUG ("processes plugin: This is only a zombie: pid = %li; "
 				"name = %s;", pid, ps->name);
 		return (0);
 	}
 
 	cpu_user_counter   = atoll (fields[11]);
 	cpu_system_counter = atoll (fields[12]);
@@ -1026,13 +1065,13 @@
 
 	if ( (ps_read_vmem(pid, ps)) == NULL)
 	{
 		/* No VMem data */
 		ps->vmem_data = -1;
 		ps->vmem_code = -1;
-		DEBUG("ps_read_process: did not get vmem data for pid %i",pid);
+		DEBUG("ps_read_process: did not get vmem data for pid %li", pid);
 	}
 
 	ps->cpu_user_counter = cpu_user_counter;
 	ps->cpu_system_counter = cpu_system_counter;
 	ps->vmem_size = (unsigned long) vmem_size;
 	ps->vmem_rss = (unsigned long) vmem_rss;
@@ -1043,34 +1082,33 @@
 		/* no io data */
 		ps->io_rchar = -1;
 		ps->io_wchar = -1;
 		ps->io_syscr = -1;
 		ps->io_syscw = -1;
 
-		DEBUG("ps_read_process: not get io data for pid %i",pid);
+		DEBUG("ps_read_process: not get io data for pid %li", pid);
 	}
 
 	/* success */
 	return (0);
 } /* int ps_read_process (...) */
 
-static char *ps_get_cmdline (pid_t pid, char *name, char *buf, size_t buf_len)
+static char *ps_get_cmdline (long pid, char *name, char *buf, size_t buf_len)
 {
 	char  *buf_ptr;
 	size_t len;
 
 	char file[PATH_MAX];
 	int  fd;
 
 	size_t n;
 
 	if ((pid < 1) || (NULL == buf) || (buf_len < 2))
 		return NULL;
 
-	ssnprintf (file, sizeof (file), "/proc/%u/cmdline",
-		       	(unsigned int) pid);
+	ssnprintf (file, sizeof (file), "/proc/%li/cmdline", pid);
 
 	errno = 0;
 	fd = open (file, O_RDONLY);
 	if (fd < 0) {
 		char errbuf[4096];
 		/* ENOENT means the process exited while we were handling it.
@@ -1145,13 +1183,13 @@
 			buf[n] = ' ';
 		--n;
 	}
 	return buf;
 } /* char *ps_get_cmdline (...) */
 
-static int read_fork_rate ()
+static int read_fork_rate (void)
 {
 	FILE *proc_stat;
 	char buffer[1024];
 	value_t value;
 	_Bool value_valid = 0;
 
@@ -1192,23 +1230,23 @@
 	ps_submit_fork_rate (value.derive);
 	return (0);
 }
 #endif /*KERNEL_LINUX */
 
 #if KERNEL_SOLARIS
-static const char *ps_get_cmdline (pid_t pid, /* {{{ */
-		char *buffer, size_t buffer_size)
+static char *ps_get_cmdline (long pid, char *name __attribute__((unused)), /* {{{ */
+    char *buffer, size_t buffer_size)
 {
 	char path[PATH_MAX];
 	psinfo_t info;
 	int status;
 
-	snprintf(path, sizeof (path), "/proc/%i/psinfo", pid);
+	snprintf(path, sizeof (path), "/proc/%li/psinfo", pid);
 
 	status = read_file_contents (path, (void *) &info, sizeof (info));
-	if (status != ((int) buffer_size))
+	if (status != sizeof (info))
 	{
 		ERROR ("processes plugin: Unexpected return value "
 				"while reading \"%s\": "
 				"Returned %i but expected %zu.",
 				path, status, buffer_size);
 		return (NULL);
@@ -1223,25 +1261,25 @@
 /*
  * Reads process information on the Solaris OS. The information comes mainly from
  * /proc/PID/status, /proc/PID/psinfo and /proc/PID/usage
  * The values for input and ouput chars are calculated "by hand"
  * Added a few "solaris" specific process states as well
  */
-static int ps_read_process(int pid, procstat_t *ps, char *state)
+static int ps_read_process(long pid, procstat_t *ps, char *state)
 {
 	char filename[64];
 	char f_psinfo[64], f_usage[64];
 	char *buffer;
 
 	pstatus_t *myStatus;
 	psinfo_t *myInfo;
 	prusage_t *myUsage;
 
-	snprintf(filename, sizeof (filename), "/proc/%i/status", pid);
-	snprintf(f_psinfo, sizeof (f_psinfo), "/proc/%i/psinfo", pid);
-	snprintf(f_usage, sizeof (f_usage), "/proc/%i/usage", pid);
+	snprintf(filename, sizeof (filename), "/proc/%li/status", pid);
+	snprintf(f_psinfo, sizeof (f_psinfo), "/proc/%li/psinfo", pid);
+	snprintf(f_usage, sizeof (f_usage), "/proc/%li/usage", pid);
 
 
 	buffer = malloc(sizeof (pstatus_t));
 	memset(buffer, 0, sizeof (pstatus_t));
 	read_file_contents(filename, buffer, sizeof (pstatus_t));
 	myStatus = (pstatus_t *) buffer;
@@ -1259,12 +1297,16 @@
 	sstrncpy(ps->name, myInfo->pr_fname, sizeof (myInfo->pr_fname));
 	ps->num_lwp = myStatus->pr_nlwp;
 	if (myInfo->pr_wstat != 0) {
 		ps->num_proc = 0;
 		ps->num_lwp = 0;
 		*state = (char) 'Z';
+
+		sfree(myStatus);
+		sfree(myInfo);
+		sfree(myUsage);
 		return (0);
 	} else {
 		ps->num_proc = 1;
 		ps->num_lwp = myInfo->pr_nlwp;
 	}
 
@@ -1681,13 +1723,13 @@
 	int stopped  = 0;
 	int paging   = 0;
 	int blocked  = 0;
 
 	struct dirent *ent;
 	DIR           *proc;
-	int            pid;
+	long           pid;
 
 	char cmdline[ARG_MAX];
 
 	int        status;
 	procstat_t ps;
 	procstat_entry_t pse;
@@ -1708,13 +1750,13 @@
 
 	while ((ent = readdir (proc)) != NULL)
 	{
 		if (!isdigit (ent->d_name[0]))
 			continue;
 
-		if ((pid = atoi (ent->d_name)) < 1)
+		if ((pid = atol (ent->d_name)) < 1)
 			continue;
 
 		status = ps_read_process (pid, &ps, &state);
 		if (status != 0)
 		{
 			DEBUG ("ps_read_process failed: %i", status);
@@ -1784,25 +1826,25 @@
 	int stopped  = 0;
 	int blocked  = 0;
 	int idle     = 0;
 	int wait     = 0;
 
 	kvm_t *kd;
-	char errbuf[1024];
+	char errbuf[_POSIX2_LINE_MAX];
 	struct kinfo_proc *procs;          /* array of processes */
 	struct kinfo_proc *proc_ptr = NULL;
 	int count;                         /* returns number of processes */
 	int i;
 
 	procstat_t *ps_ptr;
 	procstat_entry_t pse;
 
 	ps_list_reset ();
 
 	/* Open the kvm interface, get a descriptor */
-	kd = kvm_open (NULL, NULL, NULL, 0, errbuf);
+	kd = kvm_openfiles (NULL, "/dev/null", NULL, 0, errbuf);
 	if (kd == NULL)
 	{
 		ERROR ("processes plugin: Cannot open kvm interface: %s",
 				errbuf);
 		return (0);
 	}
@@ -1890,24 +1932,24 @@
 			pse.io_rchar = -1;
 			pse.io_wchar = -1;
 			pse.io_syscr = -1;
 			pse.io_syscw = -1;
 
 			ps_list_add (procs[i].ki_comm, have_cmdline ? cmdline : NULL, &pse);
-		} /* if ((proc_ptr == NULL) || (proc_ptr->ki_pid != procs[i].ki_pid)) */
 
-		switch (procs[i].ki_stat)
-		{
-			case SSTOP: 	stopped++;	break;
-			case SSLEEP:	sleeping++;	break;
-			case SRUN:	running++;	break;
-			case SIDL:	idle++;		break;
-			case SWAIT:	wait++;		break;
-			case SLOCK:	blocked++;	break;
-			case SZOMB:	zombies++;	break;
-		}
+			switch (procs[i].ki_stat)
+			{
+				case SSTOP:	stopped++;	break;
+				case SSLEEP:	sleeping++;	break;
+				case SRUN:	running++;	break;
+				case SIDL:	idle++;		break;
+				case SWAIT:	wait++;		break;
+				case SLOCK:	blocked++;	break;
+				case SZOMB:	zombies++;	break;
+			}
+		} /* if ((proc_ptr == NULL) || (proc_ptr->ki_pid != procs[i].ki_pid)) */
 	}
 
 	kvm_close(kd);
 
 	ps_submit_state ("running",  running);
 	ps_submit_state ("sleeping", sleeping);
@@ -2085,20 +2127,22 @@
 	proc = opendir ("/proc");
 	if (proc == NULL)
 		return (-1);
 
 	while ((ent = readdir(proc)) != NULL)
 	{
-		int pid;
+		long pid;
 		struct procstat ps;
 		procstat_entry_t pse;
+		char *endptr;
 
 		if (!isdigit ((int) ent->d_name[0]))
 			continue;
 
-		if ((pid = atoi (ent->d_name)) < 1)
+		pid = strtol (ent->d_name, &endptr, 10);
+		if (*endptr != 0) /* value didn't completely parse as a number */
 			continue;
 
 		status = ps_read_process (pid, &ps, &state);
 		if (status != 0)
 		{
 			DEBUG("ps_read_process failed: %i", status);
@@ -2142,14 +2186,13 @@
 			case 'Y': system++;   break;
 			case 'O': orphan++;   break;
 		}
 
 
 		ps_list_add (ps.name,
-				ps_get_cmdline ((pid_t) pid,
-					cmdline, sizeof (cmdline)),
+				ps_get_cmdline (pid, ps.name, cmdline, sizeof (cmdline)),
 				&pse);
 	} /* while(readdir) */
 	closedir (proc);
 
 	ps_submit_state ("running",  running);
 	ps_submit_state ("sleeping", sleeping);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/python.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/python.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/python.c	2015-02-26 18:43:48.488180825 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/python.c	2016-07-26 15:47:12.969713822 +0800
@@ -286,35 +286,45 @@
 		PyErr_Clear();
 		Py_DECREF(type);
 		Py_XDECREF(value);
 		Py_XDECREF(traceback);
 		return;
 	}
-	list = PyObject_CallFunction(cpy_format_exception, "NNN", type, value, traceback); /* New reference. */
+	list = PyObject_CallFunction(cpy_format_exception, "NNN", type, value, traceback); /* New reference. Steals references from "type", "value" and "traceback". */
 	if (list)
 		l = PyObject_Length(list);
+
 	for (i = 0; i < l; ++i) {
-		char *s;
 		PyObject *line;
-		
+		char const *msg;
+		char *cpy;
+
 		line = PyList_GET_ITEM(list, i); /* Borrowed reference. */
 		Py_INCREF(line);
-		s = strdup(cpy_unicode_or_bytes_to_string(&line));
+
+		msg = cpy_unicode_or_bytes_to_string(&line);
 		Py_DECREF(line);
-		if (s[strlen(s) - 1] == '\n')
-			s[strlen(s) - 1] = 0;
+		if (msg == NULL)
+			continue;
+
+		cpy = strdup(msg);
+		if (cpy == NULL)
+			continue;
+
+		if (cpy[strlen(cpy) - 1] == '\n')
+			cpy[strlen(cpy) - 1] = 0;
+
 		Py_BEGIN_ALLOW_THREADS
-		ERROR("%s", s);
+		ERROR("%s", cpy);
 		Py_END_ALLOW_THREADS
-		free(s);
+
+		free(cpy);
 	}
+
 	Py_XDECREF(list);
 	PyErr_Clear();
-	Py_DECREF(type);
-	Py_XDECREF(value);
-	Py_XDECREF(traceback);
 }
 
 static int cpy_read_callback(user_data_t *data) {
 	cpy_callback_t *c = data->data;
 	PyObject *ret;
 
@@ -373,13 +383,13 @@
 				Py_DECREF(list);
 				CPY_RETURN_FROM_THREADS 0;
 			}
 		}
 		dict = PyDict_New();  /* New reference. */
 		if (value_list->meta) {
-			int i, num;
+			int num;
 			char **table;
 			meta_data_t *meta = value_list->meta;
 
 			num = meta_data_toc(meta, &table);
 			for (i = 0; i < num; ++i) {
 				int type;
@@ -534,13 +544,18 @@
 		return NULL;
 	}
 	cpy_build_name(buf, sizeof(buf), callback, name);
 
 	Py_INCREF(callback);
 	Py_XINCREF(data);
+
 	c = malloc(sizeof(*c));
+	if (c == NULL)
+		return NULL;
+	memset (c, 0, sizeof (*c));
+
 	c->name = strdup(buf);
 	c->callback = callback;
 	c->data = data;
 	c->next = *list_head;
 	*list_head = c;
 	Py_XDECREF(mod);
@@ -573,13 +588,13 @@
 typedef int reg_function_t(const char *name, void *callback, void *data);
 
 static PyObject *cpy_register_generic_userdata(void *reg, void *handler, PyObject *args, PyObject *kwds) {
 	char buf[512];
 	reg_function_t *register_function = (reg_function_t *) reg;
 	cpy_callback_t *c = NULL;
-	user_data_t *user_data = NULL;
+	user_data_t user_data;
 	char *name = NULL;
 	PyObject *callback = NULL, *data = NULL;
 	static char *kwlist[] = {"callback", "data", "name", NULL};
 	
 	if (PyArg_ParseTupleAndKeywords(args, kwds, "O|Oet", kwlist, &callback, &data, NULL, &name) == 0) return NULL;
 	if (PyCallable_Check(callback) == 0) {
@@ -589,28 +604,35 @@
 	}
 	cpy_build_name(buf, sizeof(buf), callback, name);
 	PyMem_Free(name);
 	
 	Py_INCREF(callback);
 	Py_XINCREF(data);
+
 	c = malloc(sizeof(*c));
+	if (c == NULL)
+		return NULL;
+	memset (c, 0, sizeof (*c));
+
 	c->name = strdup(buf);
 	c->callback = callback;
 	c->data = data;
 	c->next = NULL;
-	user_data = malloc(sizeof(*user_data));
-	user_data->free_func = cpy_destroy_user_data;
-	user_data->data = c;
-	register_function(buf, handler, user_data);
+
+	memset (&user_data, 0, sizeof (user_data));
+	user_data.free_func = cpy_destroy_user_data;
+	user_data.data = c;
+
+	register_function(buf, handler, &user_data);
 	return cpy_string_to_unicode_or_bytes(buf);
 }
 
 static PyObject *cpy_register_read(PyObject *self, PyObject *args, PyObject *kwds) {
 	char buf[512];
 	cpy_callback_t *c = NULL;
-	user_data_t *user_data = NULL;
+	user_data_t user_data;
 	double interval = 0;
 	char *name = NULL;
 	PyObject *callback = NULL, *data = NULL;
 	struct timespec ts;
 	static char *kwlist[] = {"callback", "interval", "data", "name", NULL};
 	
@@ -622,24 +644,32 @@
 	}
 	cpy_build_name(buf, sizeof(buf), callback, name);
 	PyMem_Free(name);
 	
 	Py_INCREF(callback);
 	Py_XINCREF(data);
+
 	c = malloc(sizeof(*c));
+	if (c == NULL)
+		return NULL;
+	memset (c, 0, sizeof (*c));
+
 	c->name = strdup(buf);
 	c->callback = callback;
 	c->data = data;
 	c->next = NULL;
-	user_data = malloc(sizeof(*user_data));
-	user_data->free_func = cpy_destroy_user_data;
-	user_data->data = c;
+
+	memset (&user_data, 0, sizeof (user_data));
+	user_data.free_func = cpy_destroy_user_data;
+	user_data.data = c;
+
 	ts.tv_sec = interval;
 	ts.tv_nsec = (interval - ts.tv_sec) * 1000000000;
-	plugin_register_complex_read(/* group = */ NULL, buf,
-			cpy_read_callback, &ts, user_data);
+	plugin_register_complex_read(/* group = */ "python", buf,
+			cpy_read_callback, &ts, &user_data);
+
 	return cpy_string_to_unicode_or_bytes(buf);
 }
 
 static PyObject *cpy_register_log(PyObject *self, PyObject *args, PyObject *kwds) {
 	return cpy_register_generic_userdata((void *) plugin_register_log,
 			(void *) cpy_log_callback, args, kwds);
@@ -733,13 +763,13 @@
 		cpy_build_name(buf, sizeof(buf), arg, NULL);
 		name = buf;
 	}
 	for (tmp = *list_head; tmp; prev = tmp, tmp = tmp->next)
 		if (strcmp(name, tmp->name) == 0)
 			break;
-	
+
 	Py_DECREF(arg);
 	if (tmp == NULL) {
 		PyErr_Format(PyExc_RuntimeError, "Unable to unregister %s callback '%s'.", desc, name);
 		return NULL;
 	}
 	/* Yes, this is actually save. To call this function the caller has to
@@ -984,13 +1014,13 @@
 
 PyMODINIT_FUNC PyInit_collectd(void) {
 	return PyModule_Create(&collectdmodule);
 }
 #endif
 
-static int cpy_init_python() {
+static int cpy_init_python(void) {
 	char *argv = "";
 	PyObject *sys;
 	PyObject *module;
 
 #ifdef IS_PY3K
 	/* Add a builtin module, before Py_Initialize */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/routeros.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/routeros.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/routeros.c	2015-02-26 18:43:48.488180825 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/routeros.c	2016-07-26 15:47:12.969713822 +0800
@@ -323,13 +323,13 @@
   int status;
   int i;
 
   router_data = malloc (sizeof (*router_data));
   if (router_data == NULL)
     return (-1);
-  memset (router_data, 0, sizeof (router_data));
+  memset (router_data, 0, sizeof (*router_data));
   router_data->connection = NULL;
   router_data->node = NULL;
   router_data->service = NULL;
   router_data->username = NULL;
   router_data->password = NULL;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/rrdtool.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/rrdtool.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/rrdtool.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/rrdtool.c	2016-07-26 15:47:12.969713822 +0800
@@ -224,13 +224,13 @@
 
 		if (ds->ds[i].type == DS_TYPE_COUNTER)
 			status = ssnprintf (buffer + offset, buffer_len - offset,
 					":%llu", vl->values[i].counter);
 		else if (ds->ds[i].type == DS_TYPE_GAUGE)
 			status = ssnprintf (buffer + offset, buffer_len - offset,
-					":%lf", vl->values[i].gauge);
+					":"GAUGE_FORMAT, vl->values[i].gauge);
 		else if (ds->ds[i].type == DS_TYPE_DERIVE)
 			status = ssnprintf (buffer + offset, buffer_len - offset,
 					":%"PRIi64, vl->values[i].derive);
 		else /*if (ds->ds[i].type == DS_TYPE_ABSOLUTE) */
 			status = ssnprintf (buffer + offset, buffer_len - offset,
 					":%"PRIu64, vl->values[i].absolute);
@@ -259,13 +259,13 @@
 	{
 		case DS_TYPE_DERIVE:
 			status = ssnprintf (buffer, buffer_len, "%u:%"PRIi64,
 				(unsigned) tt, vl->values[0].derive);
 			break;
 		case DS_TYPE_GAUGE:
-			status = ssnprintf (buffer, buffer_len, "%u:%lf",
+			status = ssnprintf (buffer, buffer_len, "%u:"GAUGE_FORMAT,
 				(unsigned) tt, vl->values[0].gauge);
 			break;
 		case DS_TYPE_COUNTER:
 			status = ssnprintf (buffer, buffer_len, "%u:%llu",
 				(unsigned) tt, vl->values[0].counter);
 			break;
@@ -730,22 +730,26 @@
 	c_avl_get (cache, filename, (void *) &rc);
 
 	if (rc == NULL)
 	{
 		rc = malloc (sizeof (*rc));
 		if (rc == NULL)
+		{
+			pthread_mutex_unlock (&cache_lock);
 			return (-1);
+		}
 		rc->values_num = 0;
 		rc->values = NULL;
 		rc->first_value = 0;
 		rc->last_value = 0;
 		rc->random_variation = rrd_get_random_variation ();
 		rc->flags = FLAG_NONE;
 		new_rc = 1;
 	}
 
+	assert (value_time > 0); /* plugin_dispatch() ensures this. */
 	if (rc->last_value >= value_time)
 	{
 		pthread_mutex_unlock (&cache_lock);
 		DEBUG ("rrdtool plugin: (rc->last_value = %"PRIu64") "
 				">= (value_time = %"PRIu64")",
 				rc->last_value, value_time);
@@ -1001,29 +1005,42 @@
 			return (1);
 		}
 		cache_flush_timeout = tmp;
 	}
 	else if (strcasecmp ("DataDir", key) == 0)
 	{
-		if (datadir != NULL)
-			free (datadir);
-		datadir = strdup (value);
+		char *tmp;
+		size_t len;
+
+		tmp = strdup (value);
+		if (tmp == NULL)
+		{
+			ERROR ("rrdtool plugin: strdup failed.");
+			return (1);
+		}
+
+		len = strlen (tmp);
+		while ((len > 0) && (tmp[len - 1] == '/'))
+		{
+			len--;
+			tmp[len] = 0;
+		}
+
+		if (len == 0)
+		{
+			ERROR ("rrdtool plugin: Invalid \"DataDir\" option.");
+			sfree (tmp);
+			return (1);
+		}
+
 		if (datadir != NULL)
 		{
-			int len = strlen (datadir);
-			while ((len > 0) && (datadir[len - 1] == '/'))
-			{
-				len--;
-				datadir[len] = '\0';
-			}
-			if (len <= 0)
-			{
-				free (datadir);
-				datadir = NULL;
-			}
+			sfree (datadir);
 		}
+
+		datadir = tmp;
 	}
 	else if (strcasecmp ("StepSize", key) == 0)
 	{
 		unsigned long temp = strtoul (value, NULL, 0);
 		if (temp > 0)
 			rrdcreate_config.stepsize = temp;
@@ -1200,12 +1217,13 @@
 	/* Set the cache up */
 	pthread_mutex_lock (&cache_lock);
 
 	cache = c_avl_create ((int (*) (const void *, const void *)) strcmp);
 	if (cache == NULL)
 	{
+		pthread_mutex_unlock (&cache_lock);
 		ERROR ("rrdtool plugin: c_avl_create failed.");
 		return (-1);
 	}
 
 	cache_flush_last = cdtime ();
 	if (cache_timeout == 0)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/sensors.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/sensors.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/sensors.c	2015-02-26 18:43:48.488180825 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/sensors.c	2016-07-26 15:47:12.969713822 +0800
@@ -259,13 +259,13 @@
 		return (-1);
 	}
 
 	return (0);
 }
 
-void sensors_free_features (void)
+static void sensors_free_features (void)
 {
 	featurelist_t *thisft;
 	featurelist_t *nextft;
 
 	if (first_feature == NULL)
 		return;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/sigrok.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/sigrok.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/sigrok.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/sigrok.c	2016-07-26 15:47:12.969713822 +0800
@@ -354,16 +354,19 @@
 
 	if (sr_thread_running) {
 		ERROR("sigrok plugin: Thread already running.");
 		return -1;
 	}
 
-	if ((status = plugin_thread_create(&sr_thread, NULL, sigrok_read_thread,
-			NULL)) != 0) {
+	status = plugin_thread_create(&sr_thread, NULL, sigrok_read_thread,
+			NULL);
+	if (status != 0)
+	{
+		char errbuf[1024];
 		ERROR("sigrok plugin: Failed to create thread: %s.",
-				strerror(status));
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return -1;
 	}
 	sr_thread_running = TRUE;
 
 	return 0;
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/snmp.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/snmp.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/snmp.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/snmp.c	2016-07-26 15:47:12.969713822 +0800
@@ -399,13 +399,12 @@
   dd->scale = 1.0;
   dd->shift = 0.0;
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Type", option->key) == 0)
       status = csnmp_config_add_data_type (dd, option);
     else if (strcasecmp ("Table", option->key) == 0)
       status = csnmp_config_add_data_table (dd, option);
     else if (strcasecmp ("Instance", option->key) == 0)
@@ -769,14 +768,13 @@
 #endif
       || (vl->type == ASN_GAUGE))
   {
     tmp_unsigned = (uint32_t) *vl->val.integer;
     tmp_signed = (int32_t) *vl->val.integer;
 
-    if ((vl->type == ASN_INTEGER)
-        || (vl->type == ASN_GAUGE))
+    if (vl->type == ASN_INTEGER)
       prefer_signed = 1;
 
     DEBUG ("snmp plugin: Parsed int32 value is %"PRIu64".", tmp_unsigned);
   }
   else if (vl->type == ASN_COUNTER64)
   {
@@ -1051,22 +1049,23 @@
   if (!ds)
   {
     ERROR ("snmp plugin: DataSet `%s' not defined.", data->type);
     return (-1);
   }
   assert (ds->ds_num == data->values_len);
+  assert (data->values_len > 0);
 
   instance_list_ptr = instance_list;
 
-  value_table_ptr = malloc (sizeof (*value_table_ptr) * data->values_len);
+  value_table_ptr = calloc ((size_t) data->values_len, sizeof (*value_table_ptr));
   if (value_table_ptr == NULL)
     return (-1);
   for (i = 0; i < data->values_len; i++)
     value_table_ptr[i] = value_table[i];
 
-  vl.values_len = ds->ds_num;
+  vl.values_len = data->values_len;
   vl.values = malloc (sizeof (*vl.values) * vl.values_len);
   if (vl.values == NULL)
   {
     ERROR ("snmp plugin: malloc failed.");
     sfree (value_table_ptr);
     return (-1);
@@ -1192,13 +1191,13 @@
   return (0);
 } /* int csnmp_dispatch_table */
 
 static int csnmp_read_table (host_definition_t *host, data_definition_t *data)
 {
   struct snmp_pdu *req;
-  struct snmp_pdu *res;
+  struct snmp_pdu *res = NULL;
   struct variable_list *vb;
 
   const data_set_t *ds;
 
   uint32_t oid_list_len = (uint32_t) (data->values_len + 1);
   /* Holds the last OID returned by the device. We use this in the GETNEXT
@@ -1239,12 +1238,13 @@
   if (ds->ds_num != data->values_len)
   {
     ERROR ("snmp plugin: DataSet `%s' requires %i values, but config talks about %i",
         data->type, ds->ds_num, data->values_len);
     return (-1);
   }
+  assert (data->values_len > 0);
 
   /* We need a copy of all the OIDs, because GETNEXT will destroy them. */
   memcpy (oid_list, data->values, data->values_len * sizeof (oid_t));
   if (data->instance.oid.oid_len > 0)
     memcpy (oid_list + data->values_len, &data->instance.oid, sizeof (oid_t));
   else /* no InstanceFrom option specified. */
@@ -1338,13 +1338,13 @@
       break;
     }
 
     for (vb = res->variables, i = 0; (vb != NULL); vb = vb->next_variable, i++)
     {
       /* Calculate value index from todo list */
-      while (!oid_list_todo[i] && (i < oid_list_len))
+      while ((i < oid_list_len) && !oid_list_todo[i])
         i++;
 
       /* An instance is configured and the res variable we process is the
        * instance value (last index) */
       if ((data->instance.oid.oid_len > 0) && (i == data->values_len))
       {
@@ -1484,13 +1484,13 @@
 
   DEBUG ("snmp plugin: csnmp_read_value (host = %s, data = %s)",
       host->name, data->name);
 
   if (host->sess_handle == NULL)
   {
-    DEBUG ("snmp plugin: csnmp_read_table: host->sess_handle == NULL");
+    DEBUG ("snmp plugin: csnmp_read_value: host->sess_handle == NULL");
     return (-1);
   }
 
   ds = plugin_get_ds (data->type);
   if (!ds)
   {
@@ -1548,12 +1548,13 @@
 
     if (res != NULL)
       snmp_free_pdu (res);
     res = NULL;
 
     sfree (errstr);
+    sfree (vl.values);
     csnmp_host_close_session (host);
 
     return (-1);
   }
 
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/statsd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/statsd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/statsd.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/statsd.c	2016-07-26 15:47:12.969713822 +0800
@@ -187,12 +187,41 @@
 
   pthread_mutex_unlock (&metrics_lock);
 
   return (0);
 } /* }}} int statsd_metric_add */
 
+static void statsd_metric_free (statsd_metric_t *metric) /* {{{ */
+{
+  if (metric == NULL)
+    return;
+
+  if (metric->latency != NULL)
+  {
+    latency_counter_destroy (metric->latency);
+    metric->latency = NULL;
+  }
+
+  if (metric->set != NULL)
+  {
+    void *key;
+    void *value;
+
+    while (c_avl_pick (metric->set, &key, &value) == 0)
+    {
+      sfree (key);
+      assert (value == NULL);
+    }
+
+    c_avl_destroy (metric->set);
+    metric->set = NULL;
+  }
+
+  sfree (metric);
+} /* }}} void statsd_metric_free */
+
 static int statsd_parse_value (char const *str, value_t *ret_value) /* {{{ */
 {
   char *endptr = NULL;
 
   ret_value->gauge = (gauge_t) strtod (str, &endptr);
   if ((str == endptr) || ((endptr != NULL) && (*endptr != 0)))
@@ -525,12 +554,13 @@
     }
 
     tmp = realloc (fds, sizeof (*fds) * (fds_num + 1));
     if (tmp == NULL)
     {
       ERROR ("statsd plugin: realloc failed.");
+      close (fd);
       continue;
     }
     fds = tmp;
     tmp = fds + fds_num;
     fds_num++;
 
@@ -745,55 +775,58 @@
 
   if (metric->type == STATSD_GAUGE)
     values[0].gauge = (gauge_t) metric->value;
   else if (metric->type == STATSD_TIMER)
   {
     size_t i;
+    _Bool have_events = (metric->updates_num > 0);
 
-    if (metric->updates_num == 0)
-      return (0);
-
+    /* Make sure all timer metrics share the *same* timestamp. */
     vl.time = cdtime ();
 
     ssnprintf (vl.type_instance, sizeof (vl.type_instance),
         "%s-average", name);
-    values[0].gauge = CDTIME_T_TO_DOUBLE (
-        latency_counter_get_average (metric->latency));
+    values[0].gauge = have_events
+      ? CDTIME_T_TO_DOUBLE (latency_counter_get_average (metric->latency))
+      : NAN;
     plugin_dispatch_values (&vl);
 
     if (conf_timer_lower) {
       ssnprintf (vl.type_instance, sizeof (vl.type_instance),
           "%s-lower", name);
-      values[0].gauge = CDTIME_T_TO_DOUBLE (
-          latency_counter_get_min (metric->latency));
+      values[0].gauge = have_events
+        ? CDTIME_T_TO_DOUBLE (latency_counter_get_min (metric->latency))
+        : NAN;
       plugin_dispatch_values (&vl);
     }
 
     if (conf_timer_upper) {
       ssnprintf (vl.type_instance, sizeof (vl.type_instance),
           "%s-upper", name);
-      values[0].gauge = CDTIME_T_TO_DOUBLE (
-          latency_counter_get_max (metric->latency));
+      values[0].gauge = have_events
+        ? CDTIME_T_TO_DOUBLE (latency_counter_get_max (metric->latency))
+        : NAN;
       plugin_dispatch_values (&vl);
     }
 
     if (conf_timer_sum) {
       ssnprintf (vl.type_instance, sizeof (vl.type_instance),
           "%s-sum", name);
-      values[0].gauge = CDTIME_T_TO_DOUBLE (
-          latency_counter_get_sum (metric->latency));
+      values[0].gauge = have_events
+        ? CDTIME_T_TO_DOUBLE (latency_counter_get_sum (metric->latency))
+        : NAN;
       plugin_dispatch_values (&vl);
     }
 
     for (i = 0; i < conf_timer_percentile_num; i++)
     {
       ssnprintf (vl.type_instance, sizeof (vl.type_instance),
           "%s-percentile-%.0f", name, conf_timer_percentile[i]);
-      values[0].gauge = CDTIME_T_TO_DOUBLE (
-          latency_counter_get_percentile (
-            metric->latency, conf_timer_percentile[i]));
+      values[0].gauge = have_events
+        ? CDTIME_T_TO_DOUBLE (latency_counter_get_percentile (metric->latency, conf_timer_percentile[i]))
+        : NAN;
       plugin_dispatch_values (&vl);
     }
 
     /* Keep this at the end, since vl.type is set to "gauge" here. The
      * vl.type's above are implicitly set to "latency". */
     if (conf_timer_count) {
@@ -811,14 +844,25 @@
   {
     if (metric->set == NULL)
       values[0].gauge = 0.0;
     else
       values[0].gauge = (gauge_t) c_avl_size (metric->set);
   }
-  else
-    values[0].derive = (derive_t) metric->value;
+  else { /* STATSD_COUNTER */
+      /*
+       * Expand a single value to two metrics:
+       *
+       * - The absolute counter, as a gauge
+       * - A derived rate for this counter
+       */
+      values[0].derive = (derive_t) metric->value;
+      plugin_dispatch_values(&vl);
+
+      sstrncpy(vl.type, "gauge", sizeof (vl.type));
+      values[0].gauge = (gauge_t) metric->value;
+  }
 
   return (plugin_dispatch_values (&vl));
 } /* }}} int statsd_metric_submit_unsafe */
 
 static int statsd_read (void) /* {{{ */
 {
@@ -874,13 +918,13 @@
       ERROR ("stats plugin: c_avl_remove (\"%s\") failed with status %i.",
           to_be_deleted[i], status);
       continue;
     }
 
     sfree (name);
-    sfree (metric);
+    statsd_metric_free (metric);
   }
 
   pthread_mutex_unlock (&metrics_lock);
 
   strarray_free (to_be_deleted, to_be_deleted_num);
 
@@ -889,26 +933,26 @@
 
 static int statsd_shutdown (void) /* {{{ */
 {
   void *key;
   void *value;
 
-  pthread_mutex_lock (&metrics_lock);
-
   if (network_thread_running)
   {
     network_thread_shutdown = 1;
     pthread_kill (network_thread, SIGTERM);
     pthread_join (network_thread, /* retval = */ NULL);
   }
   network_thread_running = 0;
 
+  pthread_mutex_lock (&metrics_lock);
+
   while (c_avl_pick (metrics_tree, &key, &value) == 0)
   {
     sfree (key);
-    sfree (value);
+    statsd_metric_free (value);
   }
   c_avl_destroy (metrics_tree);
   metrics_tree = NULL;
 
   sfree (conf_node);
   sfree (conf_service);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/swap.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/swap.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/swap.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/swap.c	2016-07-26 15:47:12.969713822 +0800
@@ -157,28 +157,27 @@
 
 #elif defined(VM_SWAPUSAGE)
 	/* No init stuff */
 /* #endif defined(VM_SWAPUSAGE) */
 
 #elif HAVE_LIBKVM_GETSWAPINFO
+	char errbuf[_POSIX2_LINE_MAX];
+
 	if (kvm_obj != NULL)
 	{
 		kvm_close (kvm_obj);
 		kvm_obj = NULL;
 	}
 
 	kvm_pagesize = getpagesize ();
 
-	if ((kvm_obj = kvm_open (NULL, /* execfile */
-					NULL, /* corefile */
-					NULL, /* swapfile */
-					O_RDONLY, /* flags */
-					NULL)) /* errstr */
-			== NULL)
+	kvm_obj = kvm_openfiles (NULL, "/dev/null", NULL, O_RDONLY, errbuf);
+
+	if (kvm_obj == NULL)
 	{
-		ERROR ("swap plugin: kvm_open failed.");
+		ERROR ("swap plugin: kvm_openfiles failed, %s", errbuf);
 		return (-1);
 	}
 /* #endif HAVE_LIBKVM_GETSWAPINFO */
 
 #elif HAVE_LIBSTATGRAB
 	/* No init stuff */
@@ -532,26 +531,26 @@
                 return (-1);
         }
         else if (swap_num == 0)
                 return (0);
 
 	/* Allocate and initialize the swaptbl_t structure */
-        s = (swaptbl_t *) smalloc (swap_num * sizeof (swapent_t) + sizeof (struct swaptable));
+        s = malloc (swap_num * sizeof (swapent_t) + sizeof (struct swaptable));
         if (s == NULL)
         {
-                ERROR ("swap plugin: smalloc failed.");
+                ERROR ("swap plugin: malloc failed.");
                 return (-1);
         }
 
 	/* Memory to store the path names. We only use these paths when the
 	 * separate option has been configured, but it's easier to just
 	 * allocate enough memory in any case. */
 	s_paths = calloc (swap_num, PATH_MAX);
 	if (s_paths == NULL)
 	{
-		ERROR ("swap plugin: malloc failed.");
+		ERROR ("swap plugin: calloc failed.");
 		sfree (s);
 		return (-1);
 	}
         for (i = 0; i < swap_num; i++)
 		s->swt_ent[i].ste_path = s_paths + (i * PATH_MAX);
         s->swt_n = swap_num;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/table.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/table.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/table.c	2015-02-26 18:43:48.492180905 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/table.c	2016-07-26 15:47:12.969713822 +0800
@@ -180,13 +180,13 @@
 		log_err ("<Result> does not expect any arguments.");
 		return 1;
 	}
 
 	res = (tbl_result_t *)realloc (tbl->results,
 			(tbl->results_num + 1) * sizeof (*tbl->results));
-	if (NULL == tbl) {
+	if (res == NULL) {
 		char errbuf[1024];
 		log_err ("realloc failed: %s.",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return -1;
 	}
 
@@ -275,14 +275,15 @@
 					"in <Table %s>.", c->key, tbl->file);
 	}
 
 	if (NULL == tbl->sep) {
 		log_err ("Table \"%s\" does not specify any separator.", tbl->file);
 		status = 1;
+	} else {
+		strunescape (tbl->sep, strlen (tbl->sep) + 1);
 	}
-	strunescape (tbl->sep, strlen (tbl->sep) + 1);
 
 	if (NULL == tbl->instance) {
 		tbl->instance = sstrdup (tbl->file);
 		replace_special (tbl->instance, strlen (tbl->instance));
 	}
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tail.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tail.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tail.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tail.c	2016-07-26 15:47:12.969713822 +0800
@@ -208,13 +208,12 @@
 
 static int ctail_config_add_file (oconfig_item_t *ci)
 {
   cu_tail_match_t *tm;
   char *plugin_instance = NULL;
   int num_matches = 0;
-  int status;
   int i;
 
   if ((ci->values_num != 1) || (ci->values[0].type != OCONFIG_TYPE_STRING))
   {
     WARNING ("tail plugin: `File' needs exactly one string argument.");
     return (-1);
@@ -225,16 +224,16 @@
   {
     ERROR ("tail plugin: tail_match_create (%s) failed.",
 	ci->values[0].value.string);
     return (-1);
   }
 
-  status = 0;
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
+    int status = 0;
 
     if (strcasecmp ("Match", option->key) == 0)
     {
       status = ctail_config_add_match (tm, plugin_instance, option);
       if (status == 0)
 	num_matches++;
@@ -250,12 +249,14 @@
     }
 
     if (status != 0)
       break;
   } /* for (i = 0; i < ci->children_num; i++) */
 
+  sfree (plugin_instance);
+
   if (num_matches == 0)
   {
     ERROR ("tail plugin: No (valid) matches found for file `%s'.",
 	ci->values[0].value.string);
     tail_match_destroy (tm);
     return (-1);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tail_csv.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tail_csv.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tail_csv.c	2014-08-18 15:33:14.300460874 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tail_csv.c	2016-07-26 15:47:12.969713822 +0800
@@ -103,13 +103,16 @@
     cdtime_t t;
     int status;
 
     if (md->data_source_type == -1)
         return (EINVAL);
 
-    if ((md->value_from >= fields_num) || (id->time_from >= fields_num))
+    if (md->value_from >= fields_num)
+        return (EINVAL);
+
+    if (id->time_from >= 0 && (id->time_from >= fields_num))
         return (EINVAL);
 
     t = 0;
     if (id->time_from >= 0)
         t = parse_time (fields[id->time_from]);
 
@@ -306,13 +309,12 @@
         sfree (md);
         return (-1);
     }
 
     for (i = 0; i < ci->children_num; ++i){
         oconfig_item_t *option = ci->children + i;
-        status = 0;
 
         if (strcasecmp("Type", option->key) == 0)
             status = cf_util_get_string(option, &md->type);
         else if (strcasecmp("Instance", option->key) == 0)
             status = cf_util_get_string(option, &md->instance);
         else if (strcasecmp("ValueFrom", option->key) == 0)
@@ -371,43 +373,48 @@
     sfree(id->instance);
     sfree(id->path);
     sfree(id->metric_list);
     sfree(id);
 }
 
-static int tcsv_config_add_instance_collect(instance_definition_t *id, oconfig_item_t *ci){
+static int tcsv_config_add_instance_collect(instance_definition_t *id, oconfig_item_t *ci) {
     metric_definition_t *metric;
+    metric_definition_t **metric_list;
+    size_t metric_list_size;
     int i;
 
-    if (ci->values_num < 1){
+    if (ci->values_num < 1) {
         WARNING("tail_csv plugin: The `Collect' config option needs at least one argument.");
         return (-1);
     }
 
-    /* Verify string arguments */
-    for (i = 0; i < ci->values_num; ++i)
-        if (ci->values[i].type != OCONFIG_TYPE_STRING){
+    metric_list_size = id->metric_list_len + (size_t) ci->values_num;
+    metric_list = realloc (id->metric_list, sizeof (*id->metric_list) * metric_list_size);
+    if (metric_list == NULL)
+        return (-1);
+    id->metric_list = metric_list;
+
+    for (i = 0; i < ci->values_num; i++) {
+        char *metric_name;
+
+        if (ci->values[i].type != OCONFIG_TYPE_STRING) {
             WARNING("tail_csv plugin: All arguments to `Collect' must be strings.");
-            return (-1);
+            continue;
         }
+        metric_name = ci->values[i].value.string;
 
-    id->metric_list = (metric_definition_t **)malloc(sizeof(metric_definition_t *) * ci->values_num);
-    if (id->metric_list == NULL)
-        return (-1);
-
-    for (i = 0; i < ci->values_num; ++i){
         for (metric = metric_head; metric != NULL; metric = metric->next)
-            if (strcasecmp(ci->values[i].value.string, metric->name) == 0)
+            if (strcasecmp(metric_name, metric->name) == 0)
                 break;
 
-        if (metric == NULL){
-            WARNING("tail_csv plugin: `Collect' argument not found `%s'.", ci->values[i].value.string);
-            return (-1);
+        if (metric == NULL) {
+            WARNING ("tail_csv plugin: `Collect' argument not found `%s'.", metric_name);
+            continue;
         }
 
-        id->metric_list[i] = metric;
+        id->metric_list[id->metric_list_len] = metric;
         id->metric_list_len++;
     }
 
     return (0);
 }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/target_notification.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/target_notification.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/target_notification.c	2015-02-26 18:43:48.492180905 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/target_notification.c	2016-07-26 15:47:12.969713822 +0800
@@ -173,13 +173,13 @@
 
     break;
   }
 
   if (status != 0)
   {
-    tn_destroy ((void *) data);
+    tn_destroy ((void *) &data);
     return (status);
   }
 
   *user_data = data;
   return (0);
 } /* }}} int tn_create */
@@ -248,18 +248,18 @@
       }
     }
 
     /* If this is a gauge value, use the current value. */
     if (ds->ds[i].type == DS_TYPE_GAUGE)
       ssnprintf (value_str, sizeof (value_str),
-          "%g", (double) vl->values[i].gauge);
+          GAUGE_FORMAT, (double) vl->values[i].gauge);
     /* If it's a counter, try to use the current rate. This may fail, if the
      * value has been renamed. */
     else if (rates != NULL)
       ssnprintf (value_str, sizeof (value_str),
-          "%g", (double) rates[i]);
+          GAUGE_FORMAT, (double) rates[i]);
     /* Since we don't know any better, use the string `unknown'. */
     else
       sstrncpy (value_str, "unknown", sizeof (value_str));
 
     REPLACE_FIELD (template, value_str);
   }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tcpconns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tcpconns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tcpconns.c	2015-02-26 18:43:48.492180905 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tcpconns.c	2016-07-26 15:47:12.969713822 +0800
@@ -406,12 +406,13 @@
     }
 
     memset (pe->count_local, '\0', sizeof (pe->count_local));
     memset (pe->count_remote, '\0', sizeof (pe->count_remote));
     pe->flags &= ~PORT_IS_LISTENING;
 
+    prev = pe;
     pe = pe->next;
   }
 } /* void conn_reset_port_entry */
 
 static int conn_handle_ports (uint16_t port_local, uint16_t port_remote, uint8_t state)
 {
@@ -927,13 +928,15 @@
   /* Get the first pcb */
   next = (struct inpcb *)CIRCLEQ_FIRST (&table.inpt_queue);
 
   while (next != head)
   {
     /* Read the pcb pointed to by `next' into `inpcb' */
-    kread ((u_long) next, &inpcb, sizeof (inpcb));
+    status = kread ((u_long) next, &inpcb, sizeof (inpcb));
+    if (status != 0)
+      return (-1);
 
     /* Advance `next' */
     next = (struct inpcb *)CIRCLEQ_NEXT (&inpcb, inp_queue);
 
     /* Ignore sockets, that are not connected. */
 #ifdef __NetBSD__
@@ -945,13 +948,15 @@
       continue;
     if ((inpcb.inp_flags & INP_IPV6)
 	&& IN6_IS_ADDR_UNSPECIFIED (&inpcb.inp_laddr6))
       continue;
 #endif
 
-    kread ((u_long) inpcb.inp_ppcb, &tcpcb, sizeof (tcpcb));
+    status = kread ((u_long) inpcb.inp_ppcb, &tcpcb, sizeof (tcpcb));
+    if (status != 0)
+      return (-1);
     conn_handle_ports (ntohs(inpcb.inp_lport), ntohs(inpcb.inp_fport), tcpcb.t_state);
   } /* while (next != head) */
 
   conn_submit_all ();
 
   return (0);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/teamspeak2.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/teamspeak2.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/teamspeak2.c	2015-02-26 18:43:48.492180905 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/teamspeak2.c	2016-07-26 15:47:12.969713822 +0800
@@ -255,12 +255,13 @@
 		if (status != 0)
 		{
 			char errbuf[1024];
 			WARNING ("teamspeak2 plugin: connect failed: %s",
 					sstrerror (errno, errbuf, sizeof (errbuf)));
 			close (sd);
+			sd = -1;
 			continue;
 		}
 
 		/*
 		 * Success, we can break. Don't need more than one connection
 		 */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ted.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ted.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/ted.c	2014-08-18 15:33:14.304460953 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/ted.c	2016-07-26 15:47:12.969713822 +0800
@@ -101,13 +101,12 @@
         ERROR ("ted plugin: swrite failed.");
         return (-1);
     }
 
     /* Loop until we find the end of the package */
     end_flag = 0;
-    escape_flag = 0;
     package_buffer_pos = 0;
     while (end_flag == 0)
     {
         ssize_t receive_buffer_length;
         ssize_t i;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/threshold.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/threshold.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/threshold.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/threshold.c	2016-07-26 15:47:12.969713822 +0800
@@ -358,13 +358,12 @@
   th.hysteresis = 0;
   th.flags = UT_FLAG_INTERESTING; /* interesting by default */
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Instance", option->key) == 0)
       status = ut_config_type_instance (&th, option);
     else if (strcasecmp ("DataSource", option->key) == 0)
       status = ut_config_type_datasource (&th, option);
     else if ((strcasecmp ("WarningMax", option->key) == 0)
@@ -446,13 +445,12 @@
   memcpy (&th, th_orig, sizeof (th));
   sstrncpy (th.plugin, ci->values[0].value.string, sizeof (th.plugin));
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Type", option->key) == 0)
       status = ut_config_type (&th, option);
     else if (strcasecmp ("Instance", option->key) == 0)
       status = ut_config_plugin_instance (&th, option);
     else
@@ -493,13 +491,12 @@
   memcpy (&th, th_orig, sizeof (th));
   sstrncpy (th.host, ci->values[0].value.string, sizeof (th.host));
 
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Type", option->key) == 0)
       status = ut_config_type (&th, option);
     else if (strcasecmp ("Plugin", option->key) == 0)
       status = ut_config_plugin (&th, option);
     else
@@ -622,19 +619,15 @@
   plugin_notification_meta_add_double (&n, "FailureMax", th->failure_max);
 
   /* Send an okay notification */
   if (state == STATE_OKAY)
   {
     if (state_old == STATE_MISSING)
-      status = ssnprintf (buf, bufsize,
-          ": Value is no longer missing.");
+      ssnprintf (buf, bufsize, ": Value is no longer missing.");
     else
-      status = ssnprintf (buf, bufsize,
-          ": All data sources are within range again.");
-    buf += status;
-    bufsize -= status;
+      ssnprintf (buf, bufsize, ": All data sources are within range again.");
   }
   else
   {
     double min;
     double max;
 
@@ -642,22 +635,22 @@
     max = (state == STATE_ERROR) ? th->failure_max : th->warning_max;
 
     if (th->flags & UT_FLAG_INVERT)
     {
       if (!isnan (min) && !isnan (max))
       {
-        status = ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
+        ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
             "%f. That is within the %s region of %f%s and %f%s.",
             ds->ds[ds_index].name, values[ds_index],
             (state == STATE_ERROR) ? "failure" : "warning",
             min, ((th->flags & UT_FLAG_PERCENTAGE) != 0) ? "%" : "",
             max, ((th->flags & UT_FLAG_PERCENTAGE) != 0) ? "%" : "");
       }
       else
       {
-	status = ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
+        ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
 	    "%f. That is %s the %s threshold of %f%s.",
 	    ds->ds[ds_index].name, values[ds_index],
 	    isnan (min) ? "below" : "above",
 	    (state == STATE_ERROR) ? "failure" : "warning",
 	    isnan (min) ? max : min,
 	    ((th->flags & UT_FLAG_PERCENTAGE) != 0) ? "%" : "");
@@ -680,30 +673,28 @@
 
       if (sum == 0.0)
         value = NAN;
       else
         value = 100.0 * values[ds_index] / sum;
 
-      status = ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
+      ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
           "%g (%.2f%%). That is %s the %s threshold of %.2f%%.",
           ds->ds[ds_index].name, values[ds_index], value,
           (value < min) ? "below" : "above",
           (state == STATE_ERROR) ? "failure" : "warning",
           (value < min) ? min : max);
     }
     else /* is not inverted */
     {
-      status = ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
+      ssnprintf (buf, bufsize, ": Data source \"%s\" is currently "
 	  "%f. That is %s the %s threshold of %f.",
 	  ds->ds[ds_index].name, values[ds_index],
 	  (values[ds_index] < min) ? "below" : "above",
 	  (state == STATE_ERROR) ? "failure" : "warning",
 	  (values[ds_index] < min) ? min : max);
     }
-    buf += status;
-    bufsize -= status;
   }
 
   plugin_dispatch_notification (&n);
 
   plugin_notification_meta_free (n.meta);
   return (0);
@@ -964,16 +955,17 @@
 
   plugin_dispatch_notification (&n);
 
   return (0);
 } /* }}} int ut_missing */
 
-int ut_config (oconfig_item_t *ci)
+static int ut_config (oconfig_item_t *ci)
 { /* {{{ */
   int i;
   int status = 0;
+  int old_size = c_avl_size (threshold_tree);
 
   threshold_t th;
 
   if (threshold_tree == NULL)
   {
     threshold_tree = c_avl_create ((void *) strcmp);
@@ -994,13 +986,12 @@
   th.hysteresis = 0;
   th.flags = UT_FLAG_INTERESTING; /* interesting by default */
     
   for (i = 0; i < ci->children_num; i++)
   {
     oconfig_item_t *option = ci->children + i;
-    status = 0;
 
     if (strcasecmp ("Type", option->key) == 0)
       status = ut_config_type (&th, option);
     else if (strcasecmp ("Plugin", option->key) == 0)
       status = ut_config_plugin (&th, option);
     else if (strcasecmp ("Host", option->key) == 0)
@@ -1012,13 +1003,15 @@
     }
 
     if (status != 0)
       break;
   }
 
-  if (c_avl_size (threshold_tree) > 0) {
+  /* register callbacks if this is the first time we see a valid config */
+  if ((old_size == 0) && (c_avl_size (threshold_tree) > 0))
+  {
     plugin_register_missing ("threshold", ut_missing,
         /* user data = */ NULL);
     plugin_register_write ("threshold", ut_check_threshold,
         /* user data = */ NULL);
   }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tokyotyrant.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tokyotyrant.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/tokyotyrant.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/tokyotyrant.c	2016-07-26 15:47:12.969713822 +0800
@@ -76,13 +76,13 @@
 		return (-1);
 	}
 
 	return (0);
 }
 
-static void printerr()
+static void printerr (void)
 {
 	int ecode = tcrdbecode(rdb);
 	ERROR ("tokyotyrant plugin: error: %d, %s",
 			ecode, tcrdberrmsg(ecode));
 }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/types.db.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/types.db.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/types.db.5	2015-02-26 18:47:26.752517254 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/types.db.5	2016-07-26 15:48:08.573849551 +0800
@@ -130,13 +130,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "TYPES.DB 5"
-.TH TYPES.DB 5 "2015-02-26" "5.3.1.139.gd14f0e3" "collectd"
+.TH TYPES.DB 5 "2016-07-26" "5.4.3" "collectd"
 .\" For nroff, turn off justification.  Always turn off hyphenation; it makes
 .\" way too many mistakes in technical documents.
 .if n .ad l
 .nh
 .SH "NAME"
 types.db \- Data\-set specifications for the system statistics collection daemon
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/types_list.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/types_list.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/types_list.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/types_list.c	2016-07-26 15:47:12.973713833 +0800
@@ -21,12 +21,13 @@
 
 #include "collectd.h"
 #include "common.h"
 
 #include "plugin.h"
 #include "configfile.h"
+#include "types_list.h"
 
 static int parse_ds (data_source_t *dsrc, char *buf, size_t buf_len)
 {
   char *dummy;
   char *saveptr;
   char *fields[8];
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/unixsock.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/unixsock.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/unixsock.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/unixsock.c	2016-07-26 15:47:12.973713833 +0800
@@ -119,13 +119,22 @@
 		ERROR ("unixsock plugin: bind failed: %s", errbuf);
 		close (sock_fd);
 		sock_fd = -1;
 		return (-1);
 	}
 
-	chmod (sa.sun_path, sock_perms);
+	status = chmod (sa.sun_path, sock_perms);
+	if (status == -1)
+	{
+		char errbuf[1024];
+		ERROR ("unixsock plugin: chmod failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		close (sock_fd);
+		sock_fd = -1;
+		return (-1);
+	}
 
 	status = listen (sock_fd, 8);
 	if (status != 0)
 	{
 		char errbuf[1024];
 		ERROR ("unixsock plugin: listen failed: %s",
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/users.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/users.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/users.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/users.c	2016-07-26 15:47:12.973713833 +0800
@@ -37,15 +37,12 @@
 # include <utmpx.h>
 /* #endif HAVE_UTMPX_H */
 
 #elif HAVE_UTMP_H
 # include <utmp.h>
 /* #endif HAVE_UTMP_H */
-
-#else
-# error "No applicable input method."
 #endif
 
 static void users_submit (gauge_t value)
 {
 	value_t values[1];
 	value_list_t vl = VALUE_LIST_INIT;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_avltree.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_avltree.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_avltree.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_avltree.c	2016-07-26 15:47:12.973713833 +0800
@@ -139,12 +139,15 @@
 static c_avl_node_t *rotate_right (c_avl_tree_t *t, c_avl_node_t *x)
 {
 	c_avl_node_t *p;
 	c_avl_node_t *y;
 	c_avl_node_t *b;
 
+	assert (x != NULL);
+	assert (x->left != NULL);
+
 	p = x->parent;
 	y = x->left;
 	b = y->right;
 
 	x->left = b;
 	if (b != NULL)
@@ -163,13 +166,13 @@
 		p->right = y;
 
 	x->height = calc_height (x);
 	y->height = calc_height (y);
 
 	return (y);
-} /* void rotate_left */
+} /* void rotate_right */
 
 /*
  *    (x)                   (y)
  *   /   \                 /   \
  *  /\    (y)           (x)    /\
  * /_a\  /   \   ==>   /   \  / c\
@@ -180,12 +183,15 @@
 static c_avl_node_t *rotate_left (c_avl_tree_t *t, c_avl_node_t *x)
 {
 	c_avl_node_t *p;
 	c_avl_node_t *y;
 	c_avl_node_t *b;
 
+	assert (x != NULL);
+	assert (x->right != NULL);
+
 	p = x->parent;
 	y = x->right;
 	b = y->left;
 
 	x->right = b;
 	if (b != NULL)
@@ -232,23 +238,23 @@
 		assert ((b_top >= -2) && (b_top <= 2));
 
 		if (b_top == -2)
 		{
 			assert (n->right != NULL);
 			b_bottom = BALANCE (n->right);
-			assert ((b_bottom >= -1) || (b_bottom <= 1));
+			assert ((b_bottom >= -1) && (b_bottom <= 1));
 			if (b_bottom == 1)
 				n = rotate_right_left (t, n);
 			else
 				n = rotate_left (t, n);
 		}
 		else if (b_top == 2)
 		{
 			assert (n->left != NULL);
 			b_bottom = BALANCE (n->left);
-			assert ((b_bottom >= -1) || (b_bottom <= 1));
+			assert ((b_bottom >= -1) && (b_bottom <= 1));
 			if (b_bottom == -1)
 				n = rotate_left_right (t, n);
 			else
 				n = rotate_right (t, n);
 		}
 		else
@@ -610,16 +616,24 @@
 	if (t->root == NULL)
 		return (-1);
 
 	n = t->root;
 	while ((n->left != NULL) || (n->right != NULL))
 	{
-		int height_left  = (n->left  == NULL) ? 0 : n->left->height;
-		int height_right = (n->right == NULL) ? 0 : n->right->height;
+		if (n->left == NULL)
+		{
+			n = n->right;
+			continue;
+		}
+		else if (n->right == NULL)
+		{
+			n = n->left;
+			continue;
+		}
 
-		if (height_left > height_right)
+		if (n->left->height > n->right->height)
 			n = n->left;
 		else
 			n = n->right;
 	}
 
 	p = n->parent;
@@ -631,12 +645,13 @@
 		p->right = NULL;
 
 	*key   = n->key;
 	*value = n->value;
 
 	free_node (n);
+	--t->size;
 	rebalance (t, p);
 
 	return (0);
 } /* int c_avl_pick */
 
 c_avl_iterator_t *c_avl_get_iterator (c_avl_tree_t *t)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cache.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cache.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cache.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cache.c	2016-07-26 15:47:12.973713833 +0800
@@ -183,17 +183,19 @@
 	ce->values_gauge[i] = NAN;
 	if (vl->interval > 0)
 	  ce->values_gauge[i] = ((double) vl->values[i].absolute)
 	    / CDTIME_T_TO_DOUBLE (vl->interval);
 	ce->values_raw[i].absolute = vl->values[i].absolute;
 	break;
-	
+
       default:
 	/* This shouldn't happen. */
 	ERROR ("uc_insert: Don't know how to handle data source type %i.",
 	    ds->ds[i].type);
+	sfree (key_copy);
+	cache_free (ce);
 	return (-1);
     } /* switch (ds->ds[i].type) */
   } /* for (i) */
 
   /* Prune invalid gauge data */
   uc_check_range (ds, ce);
@@ -293,13 +295,19 @@
   } /* while (c_avl_iterator_next) */
 
   c_avl_iterator_destroy (iter);
   pthread_mutex_unlock (&cache_lock);
 
   if (keys_len == 0)
+  {
+    /* realloc() may have been called for these. */
+    sfree (keys);
+    sfree (keys_time);
+    sfree (keys_interval);
     return (0);
+  }
 
   /* Call the "missing" callback for each value. Do this before removing the
    * value from the cache, so that callbacks can still access the data stored,
    * including plugin specific meta data, rates, history, …. This must be done
    * without holding the lock, otherwise we will run into a deadlock if a
    * plugin calls the cache interface. */
@@ -312,13 +320,12 @@
     vl.meta = NULL;
 
     status = parse_identifier_vl (keys[i], &vl);
     if (status != 0)
     {
       ERROR ("uc_check_timeout: parse_identifier_vl (\"%s\") failed.", keys[i]);
-      cache_free (ce);
       continue;
     }
 
     vl.time = keys_time[i];
     vl.interval = keys_interval[i];
 
@@ -628,25 +635,28 @@
   c_avl_iterator_destroy (iter);
   pthread_mutex_unlock (&cache_lock);
 
   if (status != 0)
   {
     size_t i;
-    
+
     for (i = 0; i < number; i++)
     {
       sfree (names[i]);
     }
     sfree (names);
+    sfree (times);
 
     return (-1);
   }
 
   *ret_names = names;
   if (ret_times != NULL)
     *ret_times = times;
+  else
+    sfree (times);
   *ret_number = number;
 
   return (0);
 } /* int uc_get_names */
 
 int uc_get_state (const data_set_t *ds, const value_list_t *vl)
@@ -679,13 +689,13 @@
   char name[6 * DATA_MAX_NAME_LEN];
   cache_entry_t *ce = NULL;
   int ret = -1;
 
   if (FORMAT_VL (name, sizeof (name), vl) != 0)
   {
-    ERROR ("uc_get_state: FORMAT_VL failed.");
+    ERROR ("uc_set_state: FORMAT_VL failed.");
     return (STATE_ERROR);
   }
 
   pthread_mutex_lock (&cache_lock);
 
   if (c_avl_get (cache_tree, name, (void *) &ce) == 0)
@@ -724,13 +734,12 @@
 
   /* Check if there are enough values available. If not, increase the buffer
    * size. */
   if (ce->history_length < num_steps)
   {
     gauge_t *tmp;
-    size_t i;
 
     tmp = realloc (ce->history, sizeof (*ce->history)
 	* num_steps * ce->values_num);
     if (tmp == NULL)
     {
       pthread_mutex_unlock (&cache_lock);
@@ -788,13 +797,13 @@
   char name[6 * DATA_MAX_NAME_LEN];
   cache_entry_t *ce = NULL;
   int ret = STATE_ERROR;
 
   if (FORMAT_VL (name, sizeof (name), vl) != 0)
   {
-    ERROR ("uc_get_state: FORMAT_VL failed.");
+    ERROR ("uc_get_hits: FORMAT_VL failed.");
     return (STATE_ERROR);
   }
 
   pthread_mutex_lock (&cache_lock);
 
   if (c_avl_get (cache_tree, name, (void *) &ce) == 0)
@@ -813,13 +822,13 @@
   char name[6 * DATA_MAX_NAME_LEN];
   cache_entry_t *ce = NULL;
   int ret = -1;
 
   if (FORMAT_VL (name, sizeof (name), vl) != 0)
   {
-    ERROR ("uc_get_state: FORMAT_VL failed.");
+    ERROR ("uc_set_hits: FORMAT_VL failed.");
     return (STATE_ERROR);
   }
 
   pthread_mutex_lock (&cache_lock);
 
   if (c_avl_get (cache_tree, name, (void *) &ce) == 0)
@@ -839,13 +848,13 @@
   char name[6 * DATA_MAX_NAME_LEN];
   cache_entry_t *ce = NULL;
   int ret = -1;
 
   if (FORMAT_VL (name, sizeof (name), vl) != 0)
   {
-    ERROR ("uc_get_state: FORMAT_VL failed.");
+    ERROR ("uc_inc_hits: FORMAT_VL failed.");
     return (STATE_ERROR);
   }
 
   pthread_mutex_lock (&cache_lock);
 
   if (c_avl_get (cache_tree, name, (void *) &ce) == 0)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_flush.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_flush.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_flush.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_flush.c	2016-07-26 15:47:12.973713833 +0800
@@ -22,61 +22,49 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "utils_parse_option.h"
-
-#define print_to_socket(fh, ...) \
-	do { \
-		if (fprintf (fh, __VA_ARGS__) < 0) { \
-			char errbuf[1024]; \
-			WARNING ("handle_flush: failed to write to socket #%i: %s", \
-					fileno (fh), sstrerror (errno, errbuf, sizeof (errbuf))); \
-			return -1; \
-		} \
-		fflush(fh); \
-	} while (0)
-
-static int add_to_array (char ***array, int *array_num, char *value)
-{
-	char **temp;
-
-	temp = (char **) realloc (*array, sizeof (char *) * (*array_num + 1));
-	if (temp == NULL)
-		return (-1);
-
-	*array = temp;
-	(*array)[*array_num] = value;
-	(*array_num)++;
-
-	return (0);
-} /* int add_to_array */
+#include "utils_cmd_flush.h"
 
 int handle_flush (FILE *fh, char *buffer)
 {
 	int success = 0;
 	int error   = 0;
 
 	double timeout = 0.0;
 	char **plugins = NULL;
-	int plugins_num = 0;
+	size_t plugins_num = 0;
 	char **identifiers = NULL;
-	int identifiers_num = 0;
+	size_t identifiers_num = 0;
 
-	int i;
+	size_t i;
+
+#define PRINT_TO_SOCK(fh, ...) \
+	do { \
+		if (fprintf (fh, __VA_ARGS__) < 0) { \
+			char errbuf[1024]; \
+			WARNING ("handle_flush: failed to write to socket #%i: %s", \
+					fileno (fh), sstrerror (errno, errbuf, sizeof (errbuf))); \
+			strarray_free (plugins, plugins_num); \
+			strarray_free (identifiers, identifiers_num); \
+			return -1; \
+		} \
+		fflush(fh); \
+	} while (0)
 
 	if ((fh == NULL) || (buffer == NULL))
 		return (-1);
 
 	DEBUG ("utils_cmd_flush: handle_flush (fh = %p, buffer = %s);",
 			(void *) fh, buffer);
 
 	if (strncasecmp ("FLUSH", buffer, strlen ("FLUSH")) != 0)
 	{
-		print_to_socket (fh, "-1 Cannot parse command.\n");
+		PRINT_TO_SOCK (fh, "-1 Cannot parse command.\n");
 		return (-1);
 	}
 	buffer += strlen ("FLUSH");
 
 	while (*buffer != 0)
 	{
@@ -86,99 +74,83 @@
 
 		opt_key = NULL;
 		opt_value = NULL;
 		status = parse_option (&buffer, &opt_key, &opt_value);
 		if (status != 0)
 		{
-			print_to_socket (fh, "-1 Parsing options failed.\n");
-			sfree (plugins);
-			sfree (identifiers);
+			PRINT_TO_SOCK (fh, "-1 Parsing options failed.\n");
+			strarray_free (plugins, plugins_num);
+			strarray_free (identifiers, identifiers_num);
 			return (-1);
 		}
 
 		if (strcasecmp ("plugin", opt_key) == 0)
-		{
-			add_to_array (&plugins, &plugins_num, opt_value);
-		}
+			strarray_add (&plugins, &plugins_num, opt_value);
 		else if (strcasecmp ("identifier", opt_key) == 0)
-		{
-			add_to_array (&identifiers, &identifiers_num, opt_value);
-		}
+			strarray_add (&identifiers, &identifiers_num, opt_value);
 		else if (strcasecmp ("timeout", opt_key) == 0)
 		{
 			char *endptr;
-			
+
 			errno = 0;
 			endptr = NULL;
 			timeout = strtod (opt_value, &endptr);
 
 			if ((endptr == opt_value) || (errno != 0) || (!isfinite (timeout)))
 			{
-				print_to_socket (fh, "-1 Invalid value for option `timeout': "
+				PRINT_TO_SOCK (fh, "-1 Invalid value for option `timeout': "
 						"%s\n", opt_value);
-				sfree (plugins);
-				sfree (identifiers);
+				strarray_free (plugins, plugins_num);
+				strarray_free (identifiers, identifiers_num);
 				return (-1);
 			}
 			else if (timeout < 0.0)
 			{
 				timeout = 0.0;
 			}
 		}
 		else
 		{
-			print_to_socket (fh, "-1 Cannot parse option %s\n", opt_key);
-			sfree (plugins);
-			sfree (identifiers);
+			PRINT_TO_SOCK (fh, "-1 Cannot parse option %s\n", opt_key);
+			strarray_free (plugins, plugins_num);
+			strarray_free (identifiers, identifiers_num);
 			return (-1);
 		}
 	} /* while (*buffer != 0) */
 
-	/* Add NULL entries for `any plugin' and/or `any value' if nothing was
-	 * specified. */
-	if (plugins_num == 0)
-		add_to_array (&plugins, &plugins_num, NULL);
-
-	if (identifiers_num == 0)
-		add_to_array (&identifiers, &identifiers_num, NULL);
-
-	for (i = 0; i < plugins_num; i++)
+	for (i = 0; (i == 0) || (i < plugins_num); i++)
 	{
-		char *plugin;
+		char *plugin = NULL;
 		int j;
 
-		plugin = plugins[i];
+		if (plugins_num != 0)
+			plugin = plugins[i];
 
-		for (j = 0; j < identifiers_num; j++)
+		for (j = 0; (j == 0) || (j < identifiers_num); j++)
 		{
-			char *identifier;
+			char *identifier = NULL;
 			int status;
 
-			identifier = identifiers[j];
+			if (identifiers_num != 0)
+				identifier = identifiers[j];
+
 			status = plugin_flush (plugin,
 					DOUBLE_TO_CDTIME_T (timeout),
 					identifier);
 			if (status == 0)
 				success++;
 			else
 				error++;
 		}
 	}
 
-	if ((success + error) > 0)
-	{
-		print_to_socket (fh, "0 Done: %i successful, %i errors\n",
-				success, error);
-	}
-	else
-	{
-		plugin_flush (NULL, timeout, NULL);
-		print_to_socket (fh, "0 Done\n");
-	}
+	PRINT_TO_SOCK (fh, "0 Done: %i successful, %i errors\n",
+			success, error);
 
-	sfree (plugins);
-	sfree (identifiers);
+	strarray_free (plugins, plugins_num);
+	strarray_free (identifiers, identifiers_num);
 	return (0);
+#undef PRINT_TO_SOCK
 } /* int handle_flush */
 
 /* vim: set sw=4 ts=4 tw=78 noexpandtab : */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_getval.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_getval.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_getval.c	2015-02-26 19:49:16.681659031 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_getval.c	2016-07-26 15:47:12.973713833 +0800
@@ -22,12 +22,13 @@
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
 #include "utils_cache.h"
 #include "utils_parse_option.h"
+#include "utils_cmd_getval.h"
 
 #define print_to_socket(fh, ...) \
   do { \
     if (fprintf (fh, __VA_ARGS__) < 0) { \
       char errbuf[1024]; \
       WARNING ("handle_getval: failed to write to socket #%i: %s", \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_putnotif.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_putnotif.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_putnotif.c	2015-02-26 19:49:16.685659113 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_putnotif.c	2016-07-26 15:47:12.973713833 +0800
@@ -21,12 +21,13 @@
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
 #include "utils_parse_option.h"
+#include "utils_cmd_putnotif.h"
 
 #define print_to_socket(fh, ...) \
   do { \
     if (fprintf (fh, __VA_ARGS__) < 0) { \
       char errbuf[1024]; \
       WARNING ("handle_putnotif: failed to write to socket #%i: %s", \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_putval.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_putval.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_cmd_putval.c	2015-02-26 19:49:16.685659113 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_cmd_putval.c	2016-07-26 15:47:12.973713833 +0800
@@ -21,40 +21,26 @@
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
 #include "utils_parse_option.h"
+#include "utils_cmd_putval.h"
 
 #define print_to_socket(fh, ...) \
     do { \
         if (fprintf (fh, __VA_ARGS__) < 0) { \
             char errbuf[1024]; \
             WARNING ("handle_putval: failed to write to socket #%i: %s", \
                     fileno (fh), sstrerror (errno, errbuf, sizeof (errbuf))); \
+            sfree (vl.values); \
             return -1; \
         } \
         fflush(fh); \
     } while (0)
 
-static int dispatch_values (const data_set_t *ds, value_list_t *vl,
-	       	FILE *fh, char *buffer)
-{
-	int status;
-
-	status = parse_values (buffer, vl, ds);
-	if (status != 0)
-	{
-		print_to_socket (fh, "-1 Parsing the values string failed.\n");
-		return (-1);
-	}
-
-	plugin_dispatch_values (vl);
-	return (0);
-} /* int dispatch_values */
-
 static int set_option (value_list_t *vl, const char *key, const char *value)
 {
 	if ((vl == NULL) || (key == NULL) || (value == NULL))
 		return (-1);
 
 	if (strcasecmp ("interval", key) == 0)
@@ -89,12 +75,13 @@
 	int   values_submitted;
 
 	char *identifier_copy;
 
 	const data_set_t *ds;
 	value_list_t vl = VALUE_LIST_INIT;
+	vl.values = NULL;
 
 	DEBUG ("utils_cmd_putval: handle_putval (fh = %p, buffer = %s);",
 			(void *) fh, buffer);
 
 	command = NULL;
 	status = parse_string (&buffer, &command);
@@ -188,12 +175,13 @@
 		status = parse_option (&buffer, &string, &value);
 		if (status < 0)
 		{
 			/* parse_option failed, buffer has been modified.
 			 * => we need to abort */
 			print_to_socket (fh, "-1 Misformatted option.\n");
+			sfree (vl.values);
 			return (-1);
 		}
 		else if (status == 0)
 		{
 			assert (string != NULL);
 			assert (value != NULL);
@@ -204,32 +192,35 @@
 		 * the default if no `=' is found.. */
 
 		status = parse_string (&buffer, &string);
 		if (status != 0)
 		{
 			print_to_socket (fh, "-1 Misformatted value.\n");
+			sfree (vl.values);
 			return (-1);
 		}
 		assert (string != NULL);
 
-		status = dispatch_values (ds, &vl, fh, string);
+		status = parse_values (string, &vl, ds);
 		if (status != 0)
 		{
-			/* An error has already been printed. */
+			print_to_socket (fh, "-1 Parsing the values string failed.\n");
+			sfree (vl.values);
 			return (-1);
 		}
+
+		plugin_dispatch_values (&vl);
 		values_submitted++;
 	} /* while (*buffer != 0) */
 	/* Done parsing the options. */
 
 	print_to_socket (fh, "0 Success: %i %s been dispatched.\n",
 			values_submitted,
 			(values_submitted == 1) ? "value has" : "values have");
 
-	sfree (vl.values); 
-
+	sfree (vl.values);
 	return (0);
 } /* int handle_putval */
 
 int create_putval (char *ret, size_t ret_len, /* {{{ */
 	const data_set_t *ds, const value_list_t *vl)
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_db_query.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_db_query.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_db_query.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_db_query.c	2016-07-26 15:47:12.973713833 +0800
@@ -189,14 +189,15 @@
   value_list_t vl = VALUE_LIST_INIT;
   size_t i;
 
   assert (r != NULL);
   assert (r_area->ds != NULL);
   assert (((size_t) r_area->ds->ds_num) == r->values_num);
+  assert (r->values_num > 0);
 
-  vl.values = (value_t *) calloc (r_area->ds->ds_num, sizeof (value_t));
+  vl.values = (value_t *) calloc (r->values_num, sizeof (value_t));
   if (vl.values == NULL)
   {
     ERROR ("db query utils: malloc failed.");
     return (-1);
   }
   vl.values_len = r_area->ds->ds_num;
@@ -539,13 +540,13 @@
   return (0);
 } /* }}} int udb_result_create */
 
 /*
  * Query private functions
  */
-void udb_query_free_one (udb_query_t *q) /* {{{ */
+static void udb_query_free_one (udb_query_t *q) /* {{{ */
 {
   if (q == NULL)
     return;
 
   sfree (q->name);
   sfree (q->statement);
@@ -973,16 +974,15 @@
 udb_query_allocate_preparation_area (udb_query_t *q) /* {{{ */
 {
   udb_query_preparation_area_t   *q_area;
   udb_result_preparation_area_t **next_r_area;
   udb_result_t *r;
 
-  q_area = (udb_query_preparation_area_t *)malloc (sizeof (*q_area));
+  q_area = malloc (sizeof (*q_area));
   if (q_area == NULL)
     return NULL;
-
   memset (q_area, 0, sizeof (*q_area));
 
   next_r_area = &q_area->result_prep_areas;
   for (r = q->results; r != NULL; r = r->next)
   {
     udb_result_preparation_area_t *r_area;
@@ -984,20 +984,24 @@
 
   next_r_area = &q_area->result_prep_areas;
   for (r = q->results; r != NULL; r = r->next)
   {
     udb_result_preparation_area_t *r_area;
 
-    r_area = (udb_result_preparation_area_t *)malloc (sizeof (*r_area));
+    r_area = malloc (sizeof (*r_area));
     if (r_area == NULL)
     {
-      for (r_area = q_area->result_prep_areas;
-          r_area != NULL; r_area = r_area->next)
+      udb_result_preparation_area_t *a = q_area->result_prep_areas;
+
+      while (a != NULL)
       {
-        free (r_area);
+        udb_result_preparation_area_t *next = a->next;
+        sfree (a);
+        a = next;
       }
+
       free (q_area);
       return NULL;
     }
 
     memset (r_area, 0, sizeof (*r_area));
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_dns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_dns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_dns.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_dns.c	2016-07-26 15:47:12.973713833 +0800
@@ -1,15 +1,15 @@
 /*
  * collectd - src/utils_dns.c
  * Modifications Copyright (C) 2006  Florian octo Forster
  * Copyright (C) 2002  The Measurement Factory, Inc.
  * All rights reserved.
- * 
+ *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions are met:
- * 
+ *
  * 1. Redistributions of source code must retain the above copyright notice,
  *    this list of conditions and the following disclaimer.
  * 2. Redistributions in binary form must reproduce the above copyright notice,
  *    this list of conditions and the following disclaimer in the documentation
  *    and/or other materials provided with the distribution.
  * 3. Neither the name of The Measurement Factory nor the names of its
@@ -30,12 +30,13 @@
  *
  * Authors:
  *   The Measurement Factory, Inc. <http://www.measurement-factory.com/>
  *   Florian octo Forster <octo at verplant.org>
  */
 
+#define _DEFAULT_SOURCE
 #define _BSD_SOURCE
 
 #include "collectd.h"
 #include "plugin.h"
 #include "common.h"
 
@@ -126,12 +127,16 @@
 # define UDP_DEST dest
 # define UDP_SRC  source
 #else
 # error "`struct udphdr' is unusable."
 #endif
 
+#if HAVE_NETINET_IP6_H && HAVE_STRUCT_IP6_EXT
+# define HAVE_IPV6 1
+#endif
+
 #include "utils_dns.h"
 
 /*
  * Type definitions
  */
 struct ip_list_s
@@ -441,13 +446,13 @@
     memcpy(buf, udp + 1, len - sizeof(*udp));
     if (0 == handle_dns(buf, len - sizeof(*udp)))
 	return 0;
     return 1;
 }
 
-#if HAVE_NETINET_IP6_H
+#if HAVE_IPV6
 static int
 handle_ipv6 (struct ip6_hdr *ipv6, int len)
 {
     char buf[PCAP_SNAPLEN];
     unsigned int offset;
     int nexthdr;
@@ -510,22 +515,22 @@
     memcpy (buf, (char *) ipv6 + offset, payload_len);
     if (handle_udp ((struct udphdr *) buf, payload_len) == 0)
 	return (0);
 
     return (1); /* Success */
 } /* int handle_ipv6 */
-/* #endif HAVE_NETINET_IP6_H */
+/* #endif HAVE_IPV6 */
 
-#else /* if !HAVE_NETINET_IP6_H */
+#else /* if !HAVE_IPV6 */
 static int
 handle_ipv6 (__attribute__((unused)) void *pkg,
 	__attribute__((unused)) int len)
 {
     return (0);
 }
-#endif /* !HAVE_NETINET_IP6_H */
+#endif /* !HAVE_IPV6 */
 
 static int
 handle_ip(const struct ip *ip, int len)
 {
     char buf[PCAP_SNAPLEN];
     int offset = ip->ip_hl << 2;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_fbhash.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_fbhash.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_fbhash.c	2015-02-26 18:43:48.496180984 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_fbhash.c	2016-07-26 15:47:12.973713833 +0800
@@ -33,13 +33,13 @@
   time_t mtime;
 
   pthread_mutex_t lock;
   c_avl_tree_t *tree;
 };
 
-/* 
+/*
  * Private functions
  */
 static void fbh_free_tree (c_avl_tree_t *tree) /* {{{ */
 {
   int status;
 
@@ -190,13 +190,13 @@
   if (status == 0)
     h->mtime = statbuf.st_mtime;
 
   return (status);
 } /* }}} int fbh_check_file */
 
-/* 
+/*
  * Public functions
  */
 fbhash_t *fbh_create (const char *file) /* {{{ */
 {
   fbhash_t *h;
   int status;
@@ -220,12 +220,13 @@
   pthread_mutex_init (&h->lock, /* attr = */ NULL);
 
   status = fbh_check_file (h);
   if (status != 0)
   {
     fbh_destroy (h);
+    free (h);
     return (NULL);
   }
 
   return (h);
 } /* }}} fbhash_t *fbh_create */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_graphite.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_graphite.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_graphite.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_graphite.c	2016-07-26 15:47:12.973713833 +0800
@@ -58,13 +58,13 @@
     } \
     else \
     offset += ((size_t) status); \
 } while (0)
 
     if (ds->ds[ds_num].type == DS_TYPE_GAUGE)
-        BUFFER_ADD ("%f", vl->values[ds_num].gauge);
+        BUFFER_ADD (GAUGE_FORMAT, vl->values[ds_num].gauge);
     else if (rates != NULL)
         BUFFER_ADD ("%f", rates[ds_num]);
     else if (ds->ds[ds_num].type == DS_TYPE_COUNTER)
         BUFFER_ADD ("%llu", vl->values[ds_num].counter);
     else if (ds->ds[ds_num].type == DS_TYPE_DERIVE)
         BUFFER_ADD ("%"PRIi64, vl->values[ds_num].derive);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_json.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_json.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_json.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_json.c	2016-07-26 15:47:12.973713833 +0800
@@ -105,13 +105,13 @@
     if (i > 0)
       BUFFER_ADD (",");
 
     if (ds->ds[i].type == DS_TYPE_GAUGE)
     {
       if(isfinite (vl->values[i].gauge))
-        BUFFER_ADD ("%g", vl->values[i].gauge);
+        BUFFER_ADD (JSON_GAUGE_FORMAT, vl->values[i].gauge);
       else
         BUFFER_ADD ("null");
     }
     else if (store_rates)
     {
       if (rates == NULL)
@@ -121,13 +121,13 @@
         WARNING ("utils_format_json: uc_get_rate failed.");
         sfree(rates);
         return (-1);
       }
 
       if(isfinite (rates[i]))
-        BUFFER_ADD ("%g", rates[i]);
+        BUFFER_ADD (JSON_GAUGE_FORMAT, rates[i]);
       else
         BUFFER_ADD ("null");
     }
     else if (ds->ds[i].type == DS_TYPE_COUNTER)
       BUFFER_ADD ("%llu", vl->values[i].counter);
     else if (ds->ds[i].type == DS_TYPE_DERIVE)
@@ -222,44 +222,32 @@
 
   DEBUG ("format_json: dsnames_to_json: buffer = %s;", buffer);
 
   return (0);
 } /* }}} int dsnames_to_json */
 
-static int meta_data_to_json (char *buffer, size_t buffer_size, /* {{{ */
-    meta_data_t *meta)
+static int meta_data_keys_to_json (char *buffer, size_t buffer_size, /* {{{ */
+    meta_data_t *meta, char **keys, size_t keys_num)
 {
   size_t offset = 0;
-  char **keys = NULL;
-  int keys_num;
   int status;
-  int i;
+  size_t i;
 
   buffer[0] = 0;
 
-  if (meta == NULL)
-    return (EINVAL);
-
 #define BUFFER_ADD(...) do { \
   status = ssnprintf (buffer + offset, buffer_size - offset, \
       __VA_ARGS__); \
   if (status < 1) \
     return (-1); \
   else if (((size_t) status) >= (buffer_size - offset)) \
     return (-ENOMEM); \
   else \
     offset += ((size_t) status); \
 } while (0)
 
-  keys_num = meta_data_toc (meta, &keys);
-  if (keys_num == 0)
-  {
-    sfree (keys);
-    return (0);
-  }
-
   for (i = 0; i < keys_num; ++i)
   {
     int type;
     char *key = keys[i];
 
     type = meta_data_type (meta, key);
@@ -295,26 +283,48 @@
     else if (type == MD_TYPE_BOOLEAN)
     {
       _Bool value = 0;
       if (meta_data_get_boolean (meta, key, &value) == 0)
         BUFFER_ADD (",\"%s\":%s", key, value ? "true" : "false");
     }
-
-    free (key);
   } /* for (keys) */
-  free (keys);
 
   if (offset <= 0)
     return (ENOENT);
 
   buffer[0] = '{'; /* replace leading ',' */
   BUFFER_ADD ("}");
 
 #undef BUFFER_ADD
 
   return (0);
+} /* }}} int meta_data_keys_to_json */
+
+static int meta_data_to_json (char *buffer, size_t buffer_size, /* {{{ */
+    meta_data_t *meta)
+{
+  char **keys = NULL;
+  size_t keys_num;
+  int status;
+  size_t i;
+
+  if ((buffer == NULL) || (buffer_size == 0) || (meta == NULL))
+    return (EINVAL);
+
+  status = meta_data_toc (meta, &keys);
+  if (status <= 0)
+    return (status);
+  keys_num = (size_t) status;
+
+  status = meta_data_keys_to_json (buffer, buffer_size, meta, keys, keys_num);
+
+  for (i = 0; i < keys_num; ++i)
+    sfree (keys[i]);
+  sfree (keys);
+
+  return status;
 } /* }}} int meta_data_to_json */
 
 static int value_list_to_json (char *buffer, size_t buffer_size, /* {{{ */
                 const data_set_t *ds, const value_list_t *vl, int store_rates)
 {
   char temp[512];
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_json.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_json.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_format_json.h	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_format_json.h	2016-07-26 15:47:12.973713833 +0800
@@ -22,12 +22,16 @@
 #ifndef UTILS_FORMAT_JSON_H
 #define UTILS_FORMAT_JSON_H 1
 
 #include "collectd.h"
 #include "plugin.h"
 
+#ifndef JSON_GAUGE_FORMAT
+# define JSON_GAUGE_FORMAT GAUGE_FORMAT
+#endif
+
 int format_json_initialize (char *buffer,
     size_t *ret_buffer_fill, size_t *ret_buffer_free);
 int format_json_value_list (char *buffer,
     size_t *ret_buffer_fill, size_t *ret_buffer_free,
     const data_set_t *ds, const value_list_t *vl, int store_rates);
 int format_json_finalize (char *buffer,
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_ignorelist.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_ignorelist.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_ignorelist.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_ignorelist.c	2016-07-26 15:47:12.973713833 +0800
@@ -10,16 +10,15 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Lubos Stanek <lubek at users.sourceforge.net>
  *   Florian Forster <octo at verplant.org>
  **/
 /**
@@ -88,68 +87,51 @@
 	il->head = item;
 }
 
 #if HAVE_REGEX_H
 static int ignorelist_append_regex(ignorelist_t *il, const char *entry)
 {
-	int rcompile;
-	regex_t *regtemp;
-	int errsize;
-	char *regerr = NULL;
-	ignorelist_item_t *new;
+	regex_t *re;
+	ignorelist_item_t *item;
+	int status;
 
 	/* create buffer */
-	if ((regtemp = malloc(sizeof(regex_t))) == NULL)
+	re = malloc (sizeof (*re));
+	if (re == NULL)
 	{
-		ERROR ("cannot allocate new config entry");
-		return (1);
+		ERROR ("ignorelist_append_regex: malloc failed.");
+		return ENOMEM;
 	}
-	memset (regtemp, '\0', sizeof(regex_t));
+	memset (re, 0, sizeof (*re));
 
 	/* compile regex */
-	if ((rcompile = regcomp (regtemp, entry, REG_EXTENDED)) != 0)
+	status = regcomp (re, entry, REG_EXTENDED);
+	if (status != 0)
 	{
-		/* prepare message buffer */
-		errsize = regerror(rcompile, regtemp, NULL, 0);
-		if (errsize)
-			regerr = smalloc(errsize);
-		/* get error message */
-		if (regerror (rcompile, regtemp, regerr, errsize))
-		{
-			fprintf (stderr, "Cannot compile regex %s: %i/%s",
-					entry, rcompile, regerr);
-			ERROR ("Cannot compile regex %s: %i/%s",
-					entry, rcompile, regerr);
-		}
-		else
-		{
-			fprintf (stderr, "Cannot compile regex %s: %i",
-					entry, rcompile);
-			ERROR ("Cannot compile regex %s: %i",
-					entry, rcompile);
-		}
+		char errbuf[1024];
 
-		if (errsize)
-			sfree (regerr);
-		regfree (regtemp);
-		return (1);
+		(void) regerror (status, re, errbuf, sizeof (errbuf));
+		ERROR ("ignorelist_append_regex: Compiling regular expression \"%s\" failed: %s", entry, errbuf);
+		sfree (re);
+		return status;
 	}
-	DEBUG("regex compiled: %s - %i", entry, rcompile);
 
 	/* create new entry */
-	if ((new = malloc(sizeof(ignorelist_item_t))) == NULL)
+	item = malloc (sizeof (*item));
+	if (item == NULL)
 	{
-		ERROR ("cannot allocate new config entry");
-		regfree (regtemp);
-		return (1);
+		ERROR ("ignorelist_append_regex: malloc failed.");
+		regfree (re);
+		sfree (re);
+		return ENOMEM;
 	}
-	memset (new, '\0', sizeof(ignorelist_item_t));
-	new->rmatch = regtemp;
+	memset (item, 0, sizeof (*item));
+	item->rmatch = re;
 
 	/* append new entry */
-	ignorelist_append (il, new);
+	ignorelist_append (il, item);
 
 	return (0);
 } /* int ignorelist_append_regex(ignorelist_t *il, const char *entry) */
 #endif
 
 static int ignorelist_append_string(ignorelist_t *il, const char *entry)
@@ -214,15 +196,16 @@
  * return pointer to ignorelist_t
  */
 ignorelist_t *ignorelist_create (int invert)
 {
 	ignorelist_t *il;
 
-	/* smalloc exits if it failes */
-	il = (ignorelist_t *) smalloc (sizeof (ignorelist_t));
-	memset (il, '\0', sizeof (ignorelist_t));
+	il = malloc (sizeof (*il));
+	if (il == NULL)
+		return NULL;
+	memset (il, 0, sizeof (*il));
 
 	/*
 	 * ->ignore == 0  =>  collect
 	 * ->ignore == 1  =>  ignore
 	 */
 	il->ignore = invert ? 0 : 1;
@@ -245,12 +228,13 @@
 	{
 		next = this->next;
 #if HAVE_REGEX_H
 		if (this->rmatch != NULL)
 		{
 			regfree (this->rmatch);
+			sfree (this->rmatch);
 			this->rmatch = NULL;
 		}
 #endif
 		if (this->smatch != NULL)
 		{
 			sfree (this->smatch);
@@ -280,54 +264,51 @@
 /*
  * append entry into ignorelist_t
  * return 1 for success
  */
 int ignorelist_add (ignorelist_t *il, const char *entry)
 {
-	int ret;
-	size_t entry_len;
+	size_t len;
 
 	if (il == NULL)
 	{
 		DEBUG ("add called with ignorelist_t == NULL");
 		return (1);
 	}
 
-	entry_len = strlen (entry);
+	len = strlen (entry);
 
 	/* append nothing */
-	if (entry_len == 0)
+	if (len == 0)
 	{
 		DEBUG("not appending: empty entry");
 		return (1);
 	}
 
 #if HAVE_REGEX_H
 	/* regex string is enclosed in "/.../" */
-	if ((entry_len > 2) && (entry[0] == '/') && entry[entry_len - 1] == '/')
+	if ((len > 2) && (entry[0] == '/') && entry[len - 1] == '/')
 	{
-		char *entry_copy;
-		size_t entry_copy_size;
+		char *copy;
+		int status;
 
-		/* We need to copy `entry' since it's const */
-		entry_copy_size = entry_len - 1;
-		entry_copy = smalloc (entry_copy_size);
-		sstrncpy (entry_copy, entry + 1, entry_copy_size);
-
-		DEBUG("I'm about to add regex entry: %s", entry_copy);
-		ret = ignorelist_append_regex(il, entry_copy);
-		sfree (entry_copy);
+		/* skip leading slash */
+		copy = strdup (entry + 1);
+		if (copy == NULL)
+			return ENOMEM;
+
+		/* trim trailing slash */
+		copy[strlen (copy) - 1] = 0;
+
+		status = ignorelist_append_regex (il, copy);
+		sfree (copy);
+		return status;
 	}
-	else
 #endif
-	{
-		DEBUG("to add entry: %s", entry);
-		ret = ignorelist_append_string(il, entry);
-	}
 
-	return (ret);
+	return ignorelist_append_string(il, entry);
 } /* int ignorelist_add (ignorelist_t *il, const char *entry) */
 
 /*
  * check list for entry
  * return 1 for ignored entry
  */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_ignorelist.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_ignorelist.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_ignorelist.h	2014-09-20 12:42:58.283280006 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_ignorelist.h	2016-07-26 15:47:12.973713833 +0800
@@ -9,16 +9,15 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Lubos Stanek <lubek at users.sourceforge.net>
  **/
 /**
  * ignorelist handles plugin's list of configured collectable
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_latency.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_latency.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_latency.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_latency.c	2016-07-26 15:47:12.973713833 +0800
@@ -22,54 +22,128 @@
  *
  * Authors:
  *   Florian Forster <ff at octo.it>
  **/
 
 #include "collectd.h"
+#include "plugin.h"
 #include "utils_latency.h"
 #include "common.h"
 
-#ifndef LATENCY_HISTOGRAM_SIZE
-# define LATENCY_HISTOGRAM_SIZE 1000
+#include <math.h>
+#include <limits.h>
+
+#ifndef LLONG_MAX
+# define LLONG_MAX 9223372036854775807LL
+#endif
+
+#ifndef HISTOGRAM_NUM_BINS
+# define HISTOGRAM_NUM_BINS 1000
+#endif
+
+#ifndef HISTOGRAM_DEFAULT_BIN_WIDTH
+/* 1048576 = 2^20 ^= 1/1024 s */
+# define HISTOGRAM_DEFAULT_BIN_WIDTH 1048576
 #endif
 
 struct latency_counter_s
 {
   cdtime_t start_time;
 
   cdtime_t sum;
   size_t num;
 
   cdtime_t min;
   cdtime_t max;
 
-  int histogram[LATENCY_HISTOGRAM_SIZE];
+  cdtime_t bin_width;
+  int histogram[HISTOGRAM_NUM_BINS];
 };
 
-latency_counter_t *latency_counter_create () /* {{{ */
+/*
+* Histogram represents the distribution of data, it has a list of "bins".
+* Each bin represents an interval and has a count (frequency) of
+* number of values fall within its interval.
+*
+* Histogram's range is determined by the number of bins and the bin width,
+* There are 1000 bins and all bins have the same width of default 1 millisecond.
+* When a value above this range is added, Histogram's range is increased by
+* increasing the bin width (note that number of bins remains always at 1000).
+* This operation of increasing bin width is little expensive as each bin need
+* to be visited to update it's count. To reduce frequent change of bin width,
+* new bin width will be the next nearest power of 2. Example: 2, 4, 8, 16, 32,
+* 64, 128, 256, 512, 1024, 2048, 5086, ...
+*
+* So, if the required bin width is 300, then new bin width will be 512 as it is
+* the next nearest power of 2.
+*/
+static void change_bin_width (latency_counter_t *lc, cdtime_t latency) /* {{{ */
+{
+  /* This function is called because the new value is above histogram's range.
+   * First find the required bin width:
+   *           requiredBinWidth = (value + 1) / numBins
+   * then get the next nearest power of 2
+   *           newBinWidth = 2^(ceil(log2(requiredBinWidth)))
+   */
+  double required_bin_width = ((double) (latency + 1)) / ((double) HISTOGRAM_NUM_BINS);
+  double required_bin_width_logbase2 = log (required_bin_width) / log (2.0);
+  cdtime_t new_bin_width = (cdtime_t) (pow (2.0, ceil (required_bin_width_logbase2)) + .5);
+  cdtime_t old_bin_width = lc->bin_width;
+
+  lc->bin_width = new_bin_width;
+
+  /* bin_width has been increased, now iterate through all bins and move the
+   * old bin's count to new bin. */
+  if (lc->num > 0) // if the histogram has data then iterate else skip
+  {
+      double width_change_ratio = ((double) old_bin_width) / ((double) new_bin_width);
+      size_t i;
+
+      for (i = 0; i < HISTOGRAM_NUM_BINS; i++)
+      {
+         size_t new_bin = (size_t) (((double) i) * width_change_ratio);
+         if (i == new_bin)
+             continue;
+         assert (new_bin < i);
+
+         lc->histogram[new_bin] += lc->histogram[i];
+         lc->histogram[i] = 0;
+      }
+  }
+
+  DEBUG("utils_latency: change_bin_width: latency = %.3f; "
+      "old_bin_width = %.3f; new_bin_width = %.3f;",
+      CDTIME_T_TO_DOUBLE (latency),
+      CDTIME_T_TO_DOUBLE (old_bin_width),
+      CDTIME_T_TO_DOUBLE (new_bin_width));
+} /* }}} void change_bin_width */
+
+latency_counter_t *latency_counter_create (void) /* {{{ */
 {
   latency_counter_t *lc;
 
   lc = malloc (sizeof (*lc));
   if (lc == NULL)
     return (NULL);
+  memset (lc, 0, sizeof (*lc));
 
   latency_counter_reset (lc);
+  lc->bin_width = HISTOGRAM_DEFAULT_BIN_WIDTH;
   return (lc);
 } /* }}} latency_counter_t *latency_counter_create */
 
 void latency_counter_destroy (latency_counter_t *lc) /* {{{ */
 {
   sfree (lc);
 } /* }}} void latency_counter_destroy */
 
 void latency_counter_add (latency_counter_t *lc, cdtime_t latency) /* {{{ */
 {
-  size_t latency_ms;
+  cdtime_t bin;
 
-  if ((lc == NULL) || (latency == 0))
+  if ((lc == NULL) || (latency == 0) || (latency > ((cdtime_t) LLONG_MAX)))
     return;
 
   lc->sum += latency;
   lc->num++;
 
   if ((lc->min == 0) && (lc->max == 0))
@@ -79,23 +153,36 @@
   if (lc->max < latency)
     lc->max = latency;
 
   /* A latency of _exactly_ 1.0 ms should be stored in the buffer 0, so
    * subtract one from the cdtime_t value so that exactly 1.0 ms get sorted
    * accordingly. */
-  latency_ms = (size_t) CDTIME_T_TO_MS (latency - 1);
-  if (latency_ms < STATIC_ARRAY_SIZE (lc->histogram))
-    lc->histogram[latency_ms]++;
+  bin = (latency - 1) / lc->bin_width;
+  if (bin >= HISTOGRAM_NUM_BINS)
+  {
+      change_bin_width (lc, latency);
+      bin = (latency - 1) / lc->bin_width;
+      if (bin >= HISTOGRAM_NUM_BINS)
+      {
+          ERROR ("utils_latency: latency_counter_add: Invalid bin: %"PRIu64, bin);
+          return;
+      }
+  }
+  lc->histogram[bin]++;
 } /* }}} void latency_counter_add */
 
 void latency_counter_reset (latency_counter_t *lc) /* {{{ */
 {
   if (lc == NULL)
     return;
 
+  cdtime_t bin_width = lc->bin_width;
   memset (lc, 0, sizeof (*lc));
+
+  /* preserve bin width */
+  lc->bin_width = bin_width;
   lc->start_time = cdtime ();
 } /* }}} void latency_counter_reset */
 
 cdtime_t latency_counter_get_min (latency_counter_t *lc) /* {{{ */
 {
   if (lc == NULL)
@@ -125,63 +212,65 @@
 } /* }}} size_t latency_counter_get_num */
 
 cdtime_t latency_counter_get_average (latency_counter_t *lc) /* {{{ */
 {
   double average;
 
-  if (lc == NULL)
+  if ((lc == NULL) || (lc->num == 0))
     return (0);
 
   average = CDTIME_T_TO_DOUBLE (lc->sum) / ((double) lc->num);
   return (DOUBLE_TO_CDTIME_T (average));
 } /* }}} cdtime_t latency_counter_get_average */
 
-cdtime_t latency_counter_get_percentile (latency_counter_t *lc,
+cdtime_t latency_counter_get_percentile (latency_counter_t *lc, /* {{{ */
     double percent)
 {
   double percent_upper;
   double percent_lower;
-  double ms_upper;
-  double ms_lower;
-  double ms_interpolated;
+  double p;
+  cdtime_t latency_lower;
+  cdtime_t latency_interpolated;
   int sum;
   size_t i;
 
-  if ((lc == NULL) || !((percent > 0.0) && (percent < 100.0)))
+  if ((lc == NULL) || (lc->num == 0) || !((percent > 0.0) && (percent < 100.0)))
     return (0);
 
   /* Find index i so that at least "percent" events are within i+1 ms. */
   percent_upper = 0.0;
   percent_lower = 0.0;
   sum = 0;
-  for (i = 0; i < LATENCY_HISTOGRAM_SIZE; i++)
+  for (i = 0; i < HISTOGRAM_NUM_BINS; i++)
   {
     percent_lower = percent_upper;
     sum += lc->histogram[i];
     if (sum == 0)
       percent_upper = 0.0;
     else
       percent_upper = 100.0 * ((double) sum) / ((double) lc->num);
 
     if (percent_upper >= percent)
       break;
   }
 
-  if (i >= LATENCY_HISTOGRAM_SIZE)
+  if (i >= HISTOGRAM_NUM_BINS)
     return (0);
 
   assert (percent_upper >= percent);
   assert (percent_lower < percent);
 
-  ms_upper = (double) (i + 1);
-  ms_lower = (double) i;
   if (i == 0)
-    return (MS_TO_CDTIME_T (ms_upper));
+    return (lc->bin_width);
+
+  latency_lower = ((cdtime_t) i) * lc->bin_width;
+  p = (percent - percent_lower) / (percent_upper - percent_lower);
 
-  ms_interpolated = (((percent_upper - percent) * ms_lower)
-      + ((percent - percent_lower) * ms_upper))
-    / (percent_upper - percent_lower);
+  latency_interpolated = latency_lower
+    + DOUBLE_TO_CDTIME_T (p * CDTIME_T_TO_DOUBLE (lc->bin_width));
 
-  return (MS_TO_CDTIME_T (ms_interpolated));
+  DEBUG ("latency_counter_get_percentile: latency_interpolated = %.3f",
+      CDTIME_T_TO_DOUBLE (latency_interpolated));
+  return (latency_interpolated);
 } /* }}} cdtime_t latency_counter_get_percentile */
 
 /* vim: set sw=2 sts=2 et fdm=marker : */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_latency.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_latency.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_latency.h	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_latency.h	2016-07-26 15:47:12.973713833 +0800
@@ -27,13 +27,13 @@
 #include "collectd.h"
 #include "utils_time.h"
 
 struct latency_counter_s;
 typedef struct latency_counter_s latency_counter_t;
 
-latency_counter_t *latency_counter_create ();
+latency_counter_t *latency_counter_create (void);
 void latency_counter_destroy (latency_counter_t *lc);
 
 void latency_counter_add (latency_counter_t *lc, cdtime_t latency);
 void latency_counter_reset (latency_counter_t *lc);
 
 cdtime_t latency_counter_get_min (latency_counter_t *lc);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_llist.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_llist.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_llist.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_llist.c	2016-07-26 15:47:12.973713833 +0800
@@ -9,16 +9,15 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian Forster <octo at verplant.org>
  */
 
 #include "config.h"
@@ -117,12 +116,15 @@
 }
 
 void llist_remove (llist_t *l, llentry_t *e)
 {
 	llentry_t *prev;
 
+	if ((l == NULL) || (e == NULL))
+		return;
+
 	prev = l->head;
 	while ((prev != NULL) && (prev->next != e))
 		prev = prev->next;
 
 	if (prev != NULL)
 		prev->next = e->next;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_llist.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_llist.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_llist.h	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_llist.h	2016-07-26 15:47:12.973713833 +0800
@@ -9,16 +9,15 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian Forster <octo at verplant.org>
  */
 
 #ifndef UTILS_LLIST_H
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_mount.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_mount.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_mount.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_mount.c	2016-07-26 15:47:12.973713833 +0800
@@ -9,32 +9,32 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Author:
  *   Niki W. Waibel <niki.waibel@gmx.net>
 **/
 
 #if HAVE_CONFIG_H
 # include "config.h"
 #endif
 
-#include "common.h"
 #if HAVE_XFS_XQM_H
+# define _GNU_SOURCE
 # include <xfs/xqm.h>
 #define XFS_SUPER_MAGIC_STR "XFSB"
 #define XFS_SUPER_MAGIC2_STR "BSFX"
 #endif
 
+#include "common.h"
 #include "plugin.h"
 #include "utils_mount.h"
 
 #if HAVE_GETVFSSTAT
 #  if HAVE_SYS_TYPES_H
 #    include <sys/types.h>
@@ -429,22 +429,22 @@
 /* #endif HAVE_LISTMNTENT */
 
 /* 4.4BSD and Mac OS X (getfsstat) or NetBSD (getvfsstat) */
 #elif HAVE_GETVFSSTAT || HAVE_GETFSSTAT
 static cu_mount_t *cu_mount_getfsstat (void)
 {
-#if HAVE_GETVFSSTAT
-#  define STRUCT_STATFS struct statvfs
-#  define CMD_STATFS    getvfsstat
-#  define FLAGS_STATFS  ST_NOWAIT
-/* #endif HAVE_GETVFSSTAT */
-#elif HAVE_GETFSSTAT
+#if HAVE_GETFSSTAT
 #  define STRUCT_STATFS struct statfs
 #  define CMD_STATFS    getfsstat
 #  define FLAGS_STATFS  MNT_NOWAIT
-#endif /* HAVE_GETFSSTAT */
+/* #endif HAVE_GETFSSTAT */
+#elif HAVE_GETVFSSTAT
+#  define STRUCT_STATFS struct statvfs
+#  define CMD_STATFS    getvfsstat
+#  define FLAGS_STATFS  ST_NOWAIT
+#endif /* HAVE_GETVFSSTAT */
 
 	int bufsize;
 	STRUCT_STATFS *buf;
 
 	int num;
 	int i;
@@ -570,12 +570,70 @@
 /* #endif HAVE_TWO_GETMNTENT || HAVE_GEN_GETMNTENT || HAVE_SUN_GETMNTENT */
 
 #elif HAVE_SEQ_GETMNTENT
 #warn "This version of `getmntent' hat not yet been implemented!"
 /* #endif HAVE_SEQ_GETMNTENT */
 
+#elif HAVE_GETMNTENT_R
+static cu_mount_t *cu_mount_getmntent (void)
+{
+	FILE *fp;
+	struct mntent me;
+	char mntbuf[1024];
+
+	cu_mount_t *first = NULL;
+	cu_mount_t *last  = NULL;
+	cu_mount_t *new   = NULL;
+
+	DEBUG ("utils_mount: (void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
+
+	if ((fp = setmntent (COLLECTD_MNTTAB, "r")) == NULL)
+	{
+		char errbuf[1024];
+		ERROR ("setmntent (%s): %s", COLLECTD_MNTTAB,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (NULL);
+	}
+
+	while (getmntent_r (fp, &me, mntbuf, sizeof (mntbuf) ))
+	{
+		if ((new = malloc (sizeof (cu_mount_t))) == NULL)
+			break;
+		memset (new, '\0', sizeof (cu_mount_t));
+
+		/* Copy values from `struct mntent *' */
+		new->dir         = sstrdup (me.mnt_dir);
+		new->spec_device = sstrdup (me.mnt_fsname);
+		new->type        = sstrdup (me.mnt_type);
+		new->options     = sstrdup (me.mnt_opts);
+		new->device      = get_device_name (new->options);
+		new->next        = NULL;
+
+		DEBUG ("utils_mount: new = {dir = %s, spec_device = %s, type = %s, options = %s, device = %s}",
+				new->dir, new->spec_device, new->type, new->options, new->device);
+
+		/* Append to list */
+		if (first == NULL)
+		{
+			first = new;
+			last  = new;
+		}
+		else
+		{
+			last->next = new;
+			last       = new;
+		}
+	}
+
+	endmntent (fp);
+
+	DEBUG ("utils_mount: return (0x%p)", (void *) first);
+
+	return (first);
+} /* HAVE_GETMNTENT_R */
+
 #elif HAVE_ONE_GETMNTENT
 static cu_mount_t *cu_mount_getmntent (void)
 {
 	FILE *fp;
 	struct mntent *me;
 
@@ -701,19 +759,19 @@
 	}
 } /* void cu_mount_freelist(cu_mount_t *list) */
 
 char *
 cu_mount_checkoption(char *line, char *keyword, int full)
 {
-	char *line2, *l2;
-	int l = strlen(keyword);
-	char *p1, *p2;
+	char *line2, *l2, *p1, *p2;
+	int l;
 
 	if(line == NULL || keyword == NULL) {
 		return NULL;
 	}
+
 	if(full != 0) {
 		full = 1;
 	}
 
 	line2 = sstrdup(line);
 	l2 = line2;
@@ -721,12 +779,13 @@
 		if(*l2 == ',') {
 			*l2 = '\0';
 		}
 		l2++;
 	}
 
+	l = strlen(keyword);
 	p1 = line - 1;
 	p2 = strchr(line, ',');
 	do {
 		if(strncmp(line2+(p1-line)+1, keyword, l+full) == 0) {
 			free(line2);
 			return p1+1;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_mount.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_mount.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_mount.h	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_mount.h	2016-07-26 15:47:12.973713833 +0800
@@ -9,16 +9,15 @@
  *
  * This program is distributed in the hope that it will be use-
  * ful, but WITHOUT ANY WARRANTY; without even the implied war-
  * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  * See the GNU General Public Licence for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Author:
  *   Niki W. Waibel <niki.waibel@gmx.net>
 **/
 
 /* See below for instructions how to use the public functions. */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_random.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_random.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_random.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_random.c	2016-07-26 15:47:12.973713833 +0800
@@ -23,15 +23,17 @@
  * Authors:
  *   Florian Forster <octo at collectd.org>
  **/
 
 #include "collectd.h"
 #include "utils_time.h"
+#include "utils_random.h"
 
 #include <pthread.h>
 
+
 static pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;
 static _Bool have_seed = 0;
 static unsigned short seed[3];
 
 static void cdrand_seed (void)
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_rrdcreate.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_rrdcreate.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_rrdcreate.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_rrdcreate.c	2016-07-26 15:47:12.973713833 +0800
@@ -163,20 +163,16 @@
 
   int *rts;
   int  rts_num;
 
   int rra_max;
 
-  int span;
-
   int cdp_num;
   int cdp_len;
   int i, j;
 
-  char buffer[128];
-
   /* The stepsize we use here: If it is user-set, use it. If not, use the
    * interval of the value-list. */
   int ss;
 
   if (cfg->rrarows <= 0)
   {
@@ -210,22 +206,23 @@
   {
     rts = rra_timespans;
     rts_num = rra_timespans_num;
   }
 
   rra_max = rts_num * rra_types_num;
+  assert (rra_max > 0);
 
-  if ((rra_def = (char **) malloc ((rra_max + 1) * sizeof (char *))) == NULL)
+  if ((rra_def = malloc ((rra_max + 1) * sizeof (*rra_def))) == NULL)
     return (-1);
-  memset (rra_def, '\0', (rra_max + 1) * sizeof (char *));
+  memset (rra_def, 0, (rra_max + 1) * sizeof (*rra_def));
   rra_num = 0;
 
   cdp_len = 0;
   for (i = 0; i < rts_num; i++)
   {
-    span = rts[i];
+    int span = rts[i];
 
     if ((span / ss) < cfg->rrarows)
       span = ss * cfg->rrarows;
 
     if (cdp_len == 0)
       cdp_len = 1;
@@ -235,12 +232,13 @@
 
     cdp_num = (int) ceil (((double) span)
         / ((double) (cdp_len * ss)));
 
     for (j = 0; j < rra_types_num; j++)
     {
+      char buffer[128];
       int status;
 
       if (rra_num >= rra_max)
         break;
 
       status = ssnprintf (buffer, sizeof (buffer), "RRA:%s:%.10f:%u:%u",
@@ -253,12 +251,18 @@
       }
 
       rra_def[rra_num++] = sstrdup (buffer);
     }
   }
 
+  if (rra_num <= 0)
+  {
+    sfree (rra_def);
+    return (0);
+  }
+
   *ret = rra_def;
   return (rra_num);
 } /* }}} int rra_get */
 
 static void ds_free (int ds_num, char **ds_def) /* {{{ */
 {
@@ -278,21 +282,23 @@
   int ds_num;
 
   char min[32];
   char max[32];
   char buffer[128];
 
-  ds_def = (char **) malloc (ds->ds_num * sizeof (char *));
+  assert (ds->ds_num > 0);
+
+  ds_def = malloc (ds->ds_num * sizeof (*ds_def));
   if (ds_def == NULL)
   {
     char errbuf[1024];
     ERROR ("rrdtool plugin: malloc failed: %s",
         sstrerror (errno, errbuf, sizeof (errbuf)));
     return (-1);
   }
-  memset (ds_def, '\0', ds->ds_num * sizeof (char *));
+  memset (ds_def, 0, ds->ds_num * sizeof (*ds_def));
 
   for (ds_num = 0; ds_num < ds->ds_num; ds_num++)
   {
     data_source_t *d = ds->ds + ds_num;
     char *type;
     int status;
@@ -344,12 +350,18 @@
   if (ds_num != ds->ds_num)
   {
     ds_free (ds_num, ds_def);
     return (-1);
   }
 
+  if (ds_num <= 0)
+  {
+    sfree (ds_def);
+    return (0);
+  }
+
   *ret = ds_def;
   return (ds_num);
 } /* }}} int ds_get */
 
 #if HAVE_THREADSAFE_LIBRRD
 static int srrd_create (const char *filename, /* {{{ */
@@ -643,15 +655,15 @@
 int cu_rrd_create_file (const char *filename, /* {{{ */
     const data_set_t *ds, const value_list_t *vl,
     const rrdcreate_config_t *cfg)
 {
   char **argv;
   int argc;
-  char **rra_def;
+  char **rra_def = NULL;
   int rra_num;
-  char **ds_def;
+  char **ds_def = NULL;
   int ds_num;
   int status = 0;
   time_t last_up;
   unsigned long stepsize;
 
   if (check_create_dir (filename))
@@ -663,22 +675,25 @@
     return (-1);
   }
 
   if ((ds_num = ds_get (&ds_def, ds, vl, cfg)) < 1)
   {
     ERROR ("cu_rrd_create_file failed: Could not calculate DSes");
+    rra_free (rra_num, rra_def);
     return (-1);
   }
 
   argc = ds_num + rra_num;
 
   if ((argv = (char **) malloc (sizeof (char *) * (argc + 1))) == NULL)
   {
     char errbuf[1024];
     ERROR ("cu_rrd_create_file failed: %s",
         sstrerror (errno, errbuf, sizeof (errbuf)));
+    rra_free (rra_num, rra_def);
+    ds_free (ds_num, ds_def);
     return (-1);
   }
 
   memcpy (argv, ds_def, ds_num * sizeof (char *));
   memcpy (argv + ds_num, rra_def, rra_num * sizeof (char *));
   argv[ds_num + rra_num] = NULL;
@@ -701,24 +716,38 @@
       WARNING ("cu_rrd_create_file: srrd_create_async (%s) "
           "returned status %i.",
           filename, status);
   }
   else /* synchronous */
   {
-    status = srrd_create (filename, stepsize, last_up,
-        argc, (const char **) argv);
-
+    status = lock_file (filename);
     if (status != 0)
     {
-      WARNING ("cu_rrd_create_file: srrd_create (%s) returned status %i.",
-          filename, status);
+      if (status == EEXIST)
+        NOTICE ("cu_rrd_create_file: File \"%s\" is already being created.",
+            filename);
+      else
+        ERROR ("cu_rrd_create_file: Unable to lock file \"%s\".",
+            filename);
     }
     else
     {
-      DEBUG ("cu_rrd_create_file: Successfully created RRD file \"%s\".",
-          filename);
+      status = srrd_create (filename, stepsize, last_up,
+          argc, (const char **) argv);
+
+      if (status != 0)
+      {
+        WARNING ("cu_rrd_create_file: srrd_create (%s) returned status %i.",
+            filename, status);
+      }
+      else
+      {
+        DEBUG ("cu_rrd_create_file: Successfully created RRD file \"%s\".",
+            filename);
+      }
+      unlock_file (filename);
     }
   }
 
   free (argv);
   ds_free (ds_num, ds_def);
   rra_free (rra_num, rra_def);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_subst.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_subst.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_subst.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_subst.c	2016-07-26 15:47:12.973713833 +0800
@@ -22,12 +22,13 @@
 /*
  * This module provides functions for string substitution.
  */
 
 #include "collectd.h"
 #include "common.h"
+#include "utils_subst.h"
 
 char *subst (char *buf, size_t buflen, const char *string, int off1, int off2,
 		const char *replacement)
 {
 	char  *buf_ptr = buf;
 	size_t len     = buflen;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_vl_lookup.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_vl_lookup.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/utils_vl_lookup.c	2015-02-26 18:43:48.500181064 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/utils_vl_lookup.c	2016-07-26 15:47:12.977713842 +0800
@@ -301,15 +301,16 @@
   pthread_mutex_lock (&user_class->lock);
   user_obj = lu_find_user_obj (user_class, vl);
   if (user_obj == NULL)
   {
     /* call lookup_class_callback_t() and insert into the list of user objects. */
     user_obj = lu_create_user_obj (obj, ds, vl, user_class);
-    pthread_mutex_unlock (&user_class->lock);
-    if (user_obj == NULL)
+    if (user_obj == NULL) {
+      pthread_mutex_unlock (&user_class->lock);
       return (-1);
+    }
   }
   pthread_mutex_unlock (&user_class->lock);
 
   status = obj->cb_user_obj (ds, vl,
       user_class->user_class, user_obj->user_obj);
   if (status != 0)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/varnish.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/varnish.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/varnish.c	2015-02-26 19:44:34.039896648 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/varnish.c	2016-07-26 15:47:12.977713842 +0800
@@ -502,13 +502,13 @@
 		return (-1);
 	}
 
 	stats = VSC_Main(vd);
 
 	varnish_monitor (conf, stats);
-	VSM_Close (vd);
+	VSM_Delete (vd);
 
 	return (0);
 } /* }}} */
 #else /* if HAVE_VARNISH_V2 */
 static int varnish_read (user_data_t *ud) /* {{{ */
 {
@@ -648,12 +648,13 @@
 		}
 	}
 	else if (ci->values_num > 1)
 	{
 		WARNING ("Varnish plugin: \"Instance\" blocks accept only "
 				"one argument.");
+		sfree (conf);
 		return (EINVAL);
 	}
 
 	for (i = 0; i < ci->children_num; i++)
 	{
 		oconfig_item_t *child = ci->children + i;
@@ -747,12 +748,13 @@
 			&& !conf->collect_vcl
 			&& !conf->collect_workers)
 	{
 		WARNING ("Varnish plugin: No metric has been configured for "
 				"instance \"%s\". Disabling this instance.",
 				(conf->instance == NULL) ? "localhost" : conf->instance);
+		sfree (conf);
 		return (EINVAL);
 	}
 
 	ssnprintf (callback_name, sizeof (callback_name), "varnish/%s",
 			(conf->instance == NULL) ? "localhost" : conf->instance);
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/vmem.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/vmem.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/vmem.c	2015-02-26 18:43:48.504181143 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/vmem.c	2016-07-26 15:47:12.977713842 +0800
@@ -147,14 +147,22 @@
      *
      * The total number of {inst} pages, e. g dirty pages.
      */
     if (strncmp ("nr_", key, strlen ("nr_")) == 0)
     {
       char *inst = key + strlen ("nr_");
-      value_t value = { .gauge = gauge };
-      submit_one (NULL, "vmpage_number", inst, value);
+      if (strcmp(inst, "dirtied") == 0 || strcmp(inst, "written") == 0)
+      {
+        value_t value = { .derive = counter };
+        submit_one (NULL, "vmpage_action", inst, value);
+      }
+      else
+      {
+        value_t value = { .gauge = gauge };
+        submit_one (NULL, "vmpage_number", inst, value);
+      }
     }
 
     /* 
      * Page in and page outs. For memory and swap.
      */
     else if (strcmp ("pgpgin", key) == 0)
@@ -211,12 +219,25 @@
     else if (strncmp ("pgrefill_", key, strlen ("pgrefill_")) == 0)
     {
       char *inst = key + strlen ("pgrefill_");
       value_t value  = { .derive = counter };
       submit_one (inst, "vmpage_action", "refill", value);
     }
+    else if (strncmp ("pgsteal_kswapd_", key, strlen ("pgsteal_kswapd_")) == 0)
+    {
+      char *inst = key + strlen ("pgsteal_kswapd_");
+      value_t value  = { .derive = counter };
+      submit_one (inst, "vmpage_action", "steal_kswapd", value);
+    }
+    else if (strncmp ("pgsteal_direct_", key, strlen ("pgsteal_direct_")) == 0)
+    {
+      char *inst = key + strlen ("pgsteal_direct_");
+      value_t value  = { .derive = counter };
+      submit_one (inst, "vmpage_action", "steal_direct", value);
+    }
+    /* For backwards compatibility (somewhen before 4.2.3) */
     else if (strncmp ("pgsteal_", key, strlen ("pgsteal_")) == 0)
     {
       char *inst = key + strlen ("pgsteal_");
       value_t value  = { .derive = counter };
       submit_one (inst, "vmpage_action", "steal", value);
     }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_graphite.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_graphite.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_graphite.c	2015-02-26 19:49:16.685659113 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_graphite.c	2016-07-26 15:47:12.977713842 +0800
@@ -125,13 +125,13 @@
 
 static int wg_send_buffer (struct wg_callback *cb)
 {
     ssize_t status = 0;
 
     status = swrite (cb->sock_fd, cb->send_buf, strlen (cb->send_buf));
-    if (status < 0)
+    if (status != 0)
     {
         const char *protocol = cb->protocol ? cb->protocol : WG_DEFAULT_PROTOCOL;
 
         if (cb->log_send_errors)
         {
             char errbuf[1024];
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_http.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_http.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_http.c	2015-02-26 19:49:16.685659113 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_http.c	2016-07-26 15:47:12.977713842 +0800
@@ -53,12 +53,13 @@
 
 #define WH_FORMAT_COMMAND 0
 #define WH_FORMAT_JSON    1
         int format;
 
         CURL *curl;
+        struct curl_slist *headers;
         char curl_errbuf[CURL_ERROR_SIZE];
 
         char   send_buffer[4096];
         size_t send_buffer_free;
         size_t send_buffer_fill;
         cdtime_t send_buffer_init_time;
@@ -96,14 +97,12 @@
         }
         return (status);
 } /* }}} wh_send_buffer */
 
 static int wh_callback_init (wh_callback_t *cb) /* {{{ */
 {
-        struct curl_slist *headers;
-
         if (cb->curl != NULL)
                 return (0);
 
         cb->curl = curl_easy_init ();
         if (cb->curl == NULL)
         {
@@ -111,20 +110,20 @@
                 return (-1);
         }
 
         curl_easy_setopt (cb->curl, CURLOPT_NOSIGNAL, 1L);
         curl_easy_setopt (cb->curl, CURLOPT_USERAGENT, PACKAGE_NAME"/"PACKAGE_VERSION);
 
-        headers = NULL;
-        headers = curl_slist_append (headers, "Accept:  */*");
+        cb->headers = NULL;
+        cb->headers = curl_slist_append (cb->headers, "Accept:  */*");
         if (cb->format == WH_FORMAT_JSON)
-                headers = curl_slist_append (headers, "Content-Type: application/json");
+                cb->headers = curl_slist_append (cb->headers, "Content-Type: application/json");
         else
-                headers = curl_slist_append (headers, "Content-Type: text/plain");
-        headers = curl_slist_append (headers, "Expect:");
-        curl_easy_setopt (cb->curl, CURLOPT_HTTPHEADER, headers);
+                cb->headers = curl_slist_append (cb->headers, "Content-Type: text/plain");
+        cb->headers = curl_slist_append (cb->headers, "Expect:");
+        curl_easy_setopt (cb->curl, CURLOPT_HTTPHEADER, cb->headers);
 
         curl_easy_setopt (cb->curl, CURLOPT_ERRORBUFFER, cb->curl_errbuf);
         curl_easy_setopt (cb->curl, CURLOPT_URL, cb->location);
 
         if (cb->user != NULL)
         {
@@ -261,12 +260,19 @@
 
         cb = data;
 
         wh_flush_nolock (/* timeout = */ 0, cb);
 
         curl_easy_cleanup (cb->curl);
+
+        if (cb->headers != NULL)
+        {
+                curl_slist_free_all (cb->headers);
+                cb->headers = NULL;
+        }
+
         sfree (cb->location);
         sfree (cb->user);
         sfree (cb->pass);
         sfree (cb->credentials);
         sfree (cb->cacert);
 
@@ -522,12 +528,13 @@
         cb->credentials = NULL;
         cb->verify_peer = 1;
         cb->verify_host = 1;
         cb->cacert = NULL;
         cb->format = WH_FORMAT_COMMAND;
         cb->curl = NULL;
+        cb->headers = NULL;
 
         pthread_mutex_init (&cb->send_lock, /* attr = */ NULL);
 
         config_set_string (&cb->location, ci);
         if (cb->location == NULL)
                 return (-1);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_mongodb.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_mongodb.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_mongodb.c	2014-08-18 15:33:14.308461033 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_mongodb.c	2016-07-26 15:47:12.977713842 +0800
@@ -40,12 +40,17 @@
 # define MONGO_HAVE_STDINT 1
 #else
 # define MONGO_USE_LONG_LONG_INT 1
 #endif
 #include <mongo.h>
 
+#if (MONGO_MAJOR == 0) && (MONGO_MINOR < 8)
+# define bson_alloc()    bson_create()
+# define bson_dealloc(b) bson_dispose(b)
+#endif
+
 struct wm_node_s
 {
   char name[DATA_MAX_NAME_LEN];
 
   char *host;
   int port;
@@ -71,13 +76,13 @@
     _Bool store_rates)
 {
   bson *ret;
   gauge_t *rates;
   int i;
 
-  ret = bson_create ();
+  ret = bson_alloc (); /* matched by bson_dealloc() */
   if (ret == NULL)
   {
     ERROR ("write_mongodb plugin: bson_create failed.");
     return (NULL);
   }
 
@@ -92,13 +97,13 @@
   }
   else
   {
     rates = NULL;
   }
 
-  bson_init (ret);
+  bson_init (ret); /* matched by bson_destroy() */
   bson_append_date (ret, "time", (bson_date_t) CDTIME_T_TO_MS (vl->time));
   bson_append_string (ret, "host", vl->host);
   bson_append_string (ret, "plugin", vl->plugin);
   bson_append_string (ret, "plugin_instance", vl->plugin_instance);
   bson_append_string (ret, "type", vl->type);
   bson_append_string (ret, "type_instance", vl->type_instance);
@@ -240,13 +245,14 @@
       mongo_destroy (node->conn);
   }
 
   pthread_mutex_unlock (&node->lock);
 
   /* free our resource as not to leak memory */
-  bson_dispose (bson_record);
+  bson_destroy (bson_record); /* matches bson_init() */
+  bson_dealloc (bson_record); /* matches bson_alloc() */
 
   return (0);
 } /* }}} int wm_write */
 
 static void wm_config_free (void *ptr) /* {{{ */
 {
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_redis.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_redis.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/write_redis.c	2015-02-26 19:49:16.685659113 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/write_redis.c	2016-07-26 15:47:12.977713842 +0800
@@ -56,53 +56,25 @@
   char ident[512];
   char key[512];
   char value[512];
   size_t value_size;
   char *value_ptr;
   int status;
-  int i;
 
   status = FORMAT_VL (ident, sizeof (ident), vl);
   if (status != 0)
     return (status);
   ssnprintf (key, sizeof (key), "collectd/%s", ident);
 
   memset (value, 0, sizeof (value));
   value_size = sizeof (value);
   value_ptr = &value[0];
 
-#define APPEND(...) do {                                             \
-  status = snprintf (value_ptr, value_size, __VA_ARGS__);            \
-  if (((size_t) status) > value_size)                                \
-  {                                                                  \
-    value_ptr += value_size;                                         \
-    value_size = 0;                                                  \
-  }                                                                  \
-  else                                                               \
-  {                                                                  \
-    value_ptr += status;                                             \
-    value_size -= status;                                            \
-  }                                                                  \
-} while (0)
-
-  APPEND ("%lu:", (unsigned long) vl->time);
-  for (i = 0; i < ds->ds_num; i++)
-  {
-    if (ds->ds[i].type == DS_TYPE_COUNTER)
-      APPEND ("%llu", vl->values[i].counter);
-    else if (ds->ds[i].type == DS_TYPE_GAUGE)
-      APPEND ("%g", vl->values[i].gauge);
-    else if (ds->ds[i].type == DS_TYPE_DERIVE)
-      APPEND ("%"PRIi64, vl->values[i].derive);
-    else if (ds->ds[i].type == DS_TYPE_ABSOLUTE)
-      APPEND ("%"PRIu64, vl->values[i].absolute);
-    else
-      assert (23 == 42);
-  }
-
-#undef APPEND
+  status = format_values (value_ptr, value_size, ds, vl, /* store rates = */ 0);
+  if (status != 0)
+    return (status);
 
   pthread_mutex_lock (&node->lock);
 
   if (node->conn == NULL)
   {
     node->conn = credis_connect (node->host, node->port, node->timeout);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/xmms.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/xmms.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/xmms.c	2015-02-26 18:43:48.504181143 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/xmms.c	2016-07-26 15:47:12.977713842 +0800
@@ -40,13 +40,13 @@
 	sstrncpy (vl.plugin, "xmms", sizeof (vl.plugin));
 	sstrncpy (vl.type, type, sizeof (vl.type));
 
 	plugin_dispatch_values (&vl);
 } /* void cxmms_submit */
 
-int cxmms_read (void)
+static int cxmms_read (void)
 {
   gint rate;
   gint freq;
   gint nch;
 
   if (!xmms_remote_is_running (xmms_session))
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/zfs_arc.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/zfs_arc.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/src/zfs_arc.c	2015-02-26 19:44:34.043896729 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/src/zfs_arc.c	2016-07-26 15:47:12.977713842 +0800
@@ -155,20 +155,30 @@
 		return (-1);
 	}
 #endif
 
 	/* Sizes */
 	za_read_gauge (ksp, "size",    "cache_size", "arc");
-	za_read_gauge (ksp, "l2_size", "cache_size", "L2");
+
+	/* The "l2_size" value has disappeared from Solaris some time in
+	 * early 2013, and has only reappeared recently in Solaris 11.2.
+	 * Stop trying if we ever fail to read it, so we don't spam the log.
+	 */
+	static int l2_size_avail = 1;
+	if (l2_size_avail && za_read_gauge (ksp, "l2_size", "cache_size", "L2") != 0)
+		l2_size_avail = 0;
 
 	/* Operations */
 	za_read_derive (ksp, "deleted",  "cache_operation", "deleted");
 #if __FreeBSD__
 	za_read_derive (ksp, "allocated","cache_operation", "allocated");
+#if defined(__FreeBSD_version) && (__FreeBSD_version < 1002501)
+	/* stolen removed from sysctl kstat.zfs.misc.arcstats on FreeBSD 10.2+ */
 	za_read_derive (ksp, "stolen",   "cache_operation", "stolen");
 #endif
+#endif
 
 	/* Issue indicators */
 	za_read_derive (ksp, "mutex_miss", "mutex_operations", "miss");
 	za_read_derive (ksp, "hash_collisions", "hash_collisions", "");
 	
 	/* Evictions */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/version-gen.sh /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/version-gen.sh
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.2/version-gen.sh	2015-02-26 22:07:35.800989009 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-5.4.3/version-gen.sh	2016-07-26 15:47:12.977713842 +0800
@@ -1,13 +1,13 @@
-#!/usr/bin/env bash
+#!/bin/sh
 
-DEFAULT_VERSION="5.4.2.git"
+DEFAULT_VERSION="5.4.3.git"
 
 VERSION="`git describe 2> /dev/null | sed -e 's/^collectd-//'`"
 
 if test -z "$VERSION"; then
 	VERSION="$DEFAULT_VERSION"
 fi
 
 VERSION="`echo \"$VERSION\" | sed -e 's/-/./g'`"
 
-echo -n "$VERSION"
+printf "%s" "$VERSION"
