diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/aclocal.m4 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/aclocal.m4
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/aclocal.m4	2007-09-28 19:00:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/aclocal.m4	2007-06-04 01:13:06.000000000 +0800
@@ -10,13 +10,13 @@
 # but WITHOUT ANY WARRANTY, to the extent permitted by law; without
 # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 # PARTICULAR PURPOSE.
 
 # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-
 
-# serial 51 Debian 1.5.24-1 AC_PROG_LIBTOOL
+# serial 48 Debian 1.5.22-4 AC_PROG_LIBTOOL
 
 
 # AC_PROVIDE_IFELSE(MACRO-NAME, IF-PROVIDED, IF-NOT-PROVIDED)
 # -----------------------------------------------------------
 # If this macro is not defined by Autoconf, define it here.
 m4_ifdef([AC_PROVIDE_IFELSE],
@@ -173,13 +173,13 @@
 test -z "$OBJDUMP" && OBJDUMP=objdump
 test -z "$RANLIB" && RANLIB=:
 test -z "$STRIP" && STRIP=:
 test -z "$ac_objext" && ac_objext=o
 
 # Determine commands to create old-style static archives.
-old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs'
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
 old_postinstall_cmds='chmod 644 $oldlib'
 old_postuninstall_cmds=
 
 if test -n "$RANLIB"; then
   case $host_os in
   openbsd*)
@@ -260,29 +260,27 @@
 
 # _LT_COMPILER_BOILERPLATE
 # ------------------------
 # Check for compiler boilerplate output or warnings with
 # the simple compiler test code.
 AC_DEFUN([_LT_COMPILER_BOILERPLATE],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 ])# _LT_COMPILER_BOILERPLATE
 
 
 # _LT_LINKER_BOILERPLATE
 # ----------------------
 # Check for linker boilerplate output or warnings with
 # the simple link test code.
 AC_DEFUN([_LT_LINKER_BOILERPLATE],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 ])# _LT_LINKER_BOILERPLATE
 
 
@@ -292,26 +290,18 @@
 # for the system default hardcoded library path. In most cases,
 # this is /usr/lib:/lib, but when the MPI compilers are used
 # the location of the communication and MPI libs are included too.
 # If we don't find anything, use the default library path according
 # to the aix ld manual.
 AC_DEFUN([_LT_AC_SYS_LIBPATH_AIX],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_LINK_IFELSE(AC_LANG_PROGRAM,[
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+[AC_LINK_IFELSE(AC_LANG_PROGRAM,[
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi],[])
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi],[])
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 ])# _LT_AC_SYS_LIBPATH_AIX
 
 
 # _LT_AC_SHELL_INIT(ARG)
 # ----------------------
@@ -536,23 +526,19 @@
     esac
    fi
   fi
   rm -rf conftest*
   ;;
 
-x86_64-*kfreebsd*-gnu|x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*| \
-s390*-*linux*|sparc*-*linux*)
+x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if AC_TRY_EVAL(ac_compile); then
     case `/usr/bin/file conftest.o` in
     *32-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_i386_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_i386"
           ;;
         ppc64-*linux*|powerpc64-*linux*)
           LD="${LD-ld} -m elf32ppclinux"
           ;;
@@ -563,15 +549,12 @@
           LD="${LD-ld} -m elf32_sparc"
           ;;
       esac
       ;;
     *64-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_x86_64_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_x86_64"
           ;;
         ppc*-*linux*|powerpc*-*linux*)
           LD="${LD-ld} -m elf64ppc"
           ;;
@@ -637,13 +620,13 @@
 # Check whether the given compiler option works
 AC_DEFUN([AC_LIBTOOL_COMPILER_OPTION],
 [AC_REQUIRE([LT_AC_PROG_SED])
 AC_CACHE_CHECK([$1], [$2],
   [$2=no
   ifelse([$4], , [ac_outfile=conftest.$ac_objext], [ac_outfile=$4])
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$3"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
@@ -678,18 +661,17 @@
 
 # AC_LIBTOOL_LINKER_OPTION(MESSAGE, VARIABLE-NAME, FLAGS,
 #                          [ACTION-SUCCESS], [ACTION-FAILURE])
 # ------------------------------------------------------------
 # Check whether the given compiler option works
 AC_DEFUN([AC_LIBTOOL_LINKER_OPTION],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_CACHE_CHECK([$1], [$2],
+[AC_CACHE_CHECK([$1], [$2],
   [$2=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $3"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&AS_MESSAGE_LOG_FD
@@ -797,33 +779,30 @@
       lt_cv_sys_max_cmd_len=`echo $kargmax | sed 's/.*[[ 	]]//'`
     else
       lt_cv_sys_max_cmd_len=32768
     fi
     ;;
   *)
-    lt_cv_sys_max_cmd_len=`(getconf ARG_MAX) 2> /dev/null`
-    if test -n "$lt_cv_sys_max_cmd_len"; then
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    else
-      SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-      while (test "X"`$SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
+    # If test is not a shell built-in, we'll probably end up computing a
+    # maximum length that is only half of the actual maximum length, but
+    # we can't tell.
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
-	      new_result=`expr "X$teststring" : ".*" 2>&1` &&
-	      lt_cv_sys_max_cmd_len=$new_result &&
-	      test $i != 17 # 1/2 MB should be enough
-      do
-        i=`expr $i + 1`
-        teststring=$teststring$teststring
-      done
-      teststring=
-      # Add a significant safety factor because C++ compilers can tack on massive
-      # amounts of additional arguments before passing them to the linker.
-      # It appears as though 1/2 is a usable value.
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
-    fi
+	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
+	    lt_cv_sys_max_cmd_len=$new_result &&
+	    test $i != 17 # 1/2 MB should be enough
+    do
+      i=`expr $i + 1`
+      teststring=$teststring$teststring
+    done
+    teststring=
+    # Add a significant safety factor because C++ compilers can tack on massive
+    # amounts of additional arguments before passing them to the linker.
+    # It appears as though 1/2 is a usable value.
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
     ;;
   esac
 ])
 if test -n $lt_cv_sys_max_cmd_len ; then
   AC_MSG_RESULT($lt_cv_sys_max_cmd_len)
 else
@@ -1044,22 +1023,21 @@
 
 
 # AC_LIBTOOL_PROG_CC_C_O([TAGNAME])
 # ---------------------------------
 # Check to see if options -c and -o are simultaneously supported by compiler
 AC_DEFUN([AC_LIBTOOL_PROG_CC_C_O],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_REQUIRE([_LT_AC_SYS_COMPILER])dnl
+[AC_REQUIRE([_LT_AC_SYS_COMPILER])dnl
 AC_CACHE_CHECK([if $compiler supports -c -o file.$ac_objext],
   [_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)],
   [_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
@@ -1193,13 +1171,12 @@
 else
 # FIXME - insert some real tests, host_os isn't really good enough
   case $host_os in
    darwin*)
        if test -n "$STRIP" ; then
          striplib="$STRIP -x"
-         old_striplib="$STRIP -S"
          AC_MSG_RESULT([yes])
        else
   AC_MSG_RESULT([no])
 fi
        ;;
    *)
@@ -1211,14 +1188,13 @@
 
 
 # AC_LIBTOOL_SYS_DYNAMIC_LINKER
 # -----------------------------
 # PORTME Fill in your ld.so characteristics
 AC_DEFUN([AC_LIBTOOL_SYS_DYNAMIC_LINKER],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_MSG_CHECKING([dynamic linker characteristics])
+[AC_MSG_CHECKING([dynamic linker characteristics])
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -1226,64 +1202,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-m4_if($1,[],[
 if test "$GCC" = yes; then
-  case $host_os in
-    darwin*) lt_awk_arg="/^libraries:/,/LR/" ;;
-    *) lt_awk_arg="/^libraries:/" ;;
-  esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$lt_search_path_spec" | grep ';' >/dev/null ; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
     # if the path contains ";" then we assume it to be the separator
     # otherwise default to the standard path separator (i.e. ":") - it is
     # assumed that no part of a normal pathname contains ";" but that should
     # okay in the real world where ";" in dirpaths is itself problematic.
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED -e 's/;/ /g'`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
   else
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
   fi
-  # Ok, now we have the path, separated by spaces, we can step through it
-  # and add multilib dir if necessary.
-  lt_tmp_lt_search_path_spec=
-  lt_multi_os_dir=`$CC $CPPFLAGS $CFLAGS $LDFLAGS -print-multi-os-directory 2>/dev/null`
-  for lt_sys_path in $lt_search_path_spec; do
-    if test -d "$lt_sys_path/$lt_multi_os_dir"; then
-      lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path/$lt_multi_os_dir"
-    else
-      test -d "$lt_sys_path" && \
-	lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path"
-    fi
-  done
-  lt_search_path_spec=`echo $lt_tmp_lt_search_path_spec | awk '
-BEGIN {RS=" "; FS="/|\n";} {
-  lt_foo="";
-  lt_count=0;
-  for (lt_i = NF; lt_i > 0; lt_i--) {
-    if ($lt_i != "" && $lt_i != ".") {
-      if ($lt_i == "..") {
-        lt_count++;
-      } else {
-        if (lt_count == 0) {
-          lt_foo="/" $lt_i lt_foo;
-        } else {
-          lt_count--;
-        }
-      }
-    }
-  }
-  if (lt_foo != "") { lt_freq[[lt_foo]]++; }
-  if (lt_freq[[lt_foo]] == 1) { print lt_foo; }
-}'`
-  sys_lib_search_path_spec=`echo $lt_search_path_spec`
 else
   sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi])
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -1434,14 +1372,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-  m4_if([$1], [],[
-  sys_lib_search_path_spec="$sys_lib_search_path_spec /usr/local/lib"]) 
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -1489,13 +1431,13 @@
     ;;
   freebsd3.[[2-9]]* | freebsdelf3.[[2-9]]* | \
   freebsd4.[[0-5]] | freebsdelf4.[[0-5]] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -1552,13 +1494,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[[3-9]]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -1623,13 +1565,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -1729,16 +1671,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -1838,14 +1776,13 @@
 ])# AC_LIBTOOL_SYS_DYNAMIC_LINKER
 
 
 # _LT_AC_TAGCONFIG
 # ----------------
 AC_DEFUN([_LT_AC_TAGCONFIG],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_ARG_WITH([tags],
+[AC_ARG_WITH([tags],
     [AC_HELP_STRING([--with-tags@<:@=TAGS@:>@],
         [include additional configurations @<:@automatic@:>@])],
     [tagnames="$withval"])
 
 if test -f "$ltmain" && test -n "$tagnames"; then
   if test ! -f "${ofile}"; then
@@ -2100,13 +2037,13 @@
  AC_SUBST([EGREP])
 ])])
 
 
 # AC_PATH_TOOL_PREFIX
 # -------------------
-# find a file program which can recognize shared library
+# find a file program which can recognise shared library
 AC_DEFUN([AC_PATH_TOOL_PREFIX],
 [AC_REQUIRE([AC_PROG_EGREP])dnl
 AC_MSG_CHECKING([for $1])
 AC_CACHE_VAL(lt_cv_path_MAGIC_CMD,
 [case $MAGIC_CMD in
 [[\\/*] |  ?:[\\/]*])
@@ -2163,13 +2100,13 @@
 fi
 ])# AC_PATH_TOOL_PREFIX
 
 
 # AC_PATH_MAGIC
 # -------------
-# find a file program which can recognize a shared library
+# find a file program which can recognise a shared library
 AC_DEFUN([AC_PATH_MAGIC],
 [AC_PATH_TOOL_PREFIX(${ac_tool_prefix}file, /usr/bin$PATH_SEPARATOR$PATH)
 if test -z "$lt_cv_path_MAGIC_CMD"; then
   if test -n "$ac_tool_prefix"; then
     AC_PATH_TOOL_PREFIX(file, /usr/bin$PATH_SEPARATOR$PATH)
   else
@@ -2310,13 +2247,13 @@
 
 # AC_DEPLIBS_CHECK_METHOD
 # -----------------------
 # how to check for library dependencies
 #  -- PORTME fill in with the dynamic library characteristics
 AC_DEFUN([AC_DEPLIBS_CHECK_METHOD],
-[AC_CACHE_CHECK([how to recognize dependent libraries],
+[AC_CACHE_CHECK([how to recognise dependent libraries],
 lt_cv_deplibs_check_method,
 [lt_cv_file_magic_cmd='$MAGIC_CMD'
 lt_cv_file_magic_test_file=
 lt_cv_deplibs_check_method='unknown'
 # Need to set the preceding variable on all platforms that support
 # interlibrary dependencies.
@@ -2349,21 +2286,15 @@
   lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
   lt_cv_file_magic_cmd='func_win32_libid'
   ;;
 
 mingw* | pw32*)
   # Base MSYS/MinGW do not provide the 'file' command needed by
-  # func_win32_libid shell function, so use a weaker test based on 'objdump',
-  # unless we find 'file', for example because we are cross-compiling.
-  if ( file / ) >/dev/null 2>&1; then
-    lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
-    lt_cv_file_magic_cmd='func_win32_libid'
-  else
-    lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
-    lt_cv_file_magic_cmd='$OBJDUMP -f'
-  fi
+  # func_win32_libid shell function, so use a weaker test based on 'objdump'.
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
   ;;
 
 darwin* | rhapsody*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
@@ -2402,13 +2333,13 @@
     lt_cv_deplibs_check_method='file_magic (s[[0-9]][[0-9]][[0-9]]|PA-RISC[[0-9]].[[0-9]]) shared library'
     lt_cv_file_magic_test_file=/usr/lib/libc.sl
     ;;
   esac
   ;;
 
-interix[[3-9]]*)
+interix3*)
   # PIC code is broken on Interix 3.x, that's why |\.a not |_pic\.a here
   lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so|\.a)$'
   ;;
 
 irix5* | irix6* | nonstopux*)
   case $LD in
@@ -2452,16 +2383,12 @@
   ;;
 
 osf3* | osf4* | osf5*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-rdos*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
 solaris*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
 sysv4 | sysv4.3*)
   case $host_vendor in
@@ -2508,13 +2435,13 @@
 [AC_CACHE_CHECK([for BSD-compatible nm], lt_cv_path_NM,
 [if test -n "$NM"; then
   # Let the user override the test.
   lt_cv_path_NM="$NM"
 else
   lt_nm_to_check="${ac_tool_prefix}nm"
-  if test -n "$ac_tool_prefix" && test "$build" = "$host"; then
+  if test -n "$ac_tool_prefix" && test "$build" = "$host"; then 
     lt_nm_to_check="$lt_nm_to_check nm"
   fi
   for lt_tmp_nm in $lt_nm_to_check; do
     lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
     for ac_dir in $PATH /usr/ccs/bin/elf /usr/ccs/bin /usr/ucb /bin; do
       IFS="$lt_save_ifs"
@@ -2724,16 +2651,16 @@
 
 # Object file extension for compiled C test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(){return(0);}'
+lt_simple_link_test_code='int main(){return(0);}\n'
 
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
 _LT_LINKER_BOILERPLATE
@@ -2829,16 +2756,16 @@
 
 # Object file extension for compiled C++ test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(int, char *[[]]) { return(0); }'
+lt_simple_link_test_code='int main(int, char *[[]]) { return(0); }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -2978,13 +2905,13 @@
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
 	if test -f "$collect2name" && \
 	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	then
 	  # We have reworked collect2
-	  :
+	  _LT_AC_TAGVAR(hardcode_direct, $1)=yes
 	else
 	  # We have old collect2
 	  _LT_AC_TAGVAR(hardcode_direct, $1)=unsupported
 	  # It fails to find uninstalled libraries when the uninstalled
 	  # path is not listed in the libpath.  Setting hardcode_minus_L
 	  # to unsupported forces relinking
@@ -3137,16 +3064,16 @@
           fi
             _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
           _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          _LT_AC_TAGVAR(ld_shlibs, $1)=no
           ;;
       esac
@@ -3223,13 +3150,15 @@
   hpux10*|hpux11*)
     if test $with_gnu_ld = no; then
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}+b ${wl}$libdir'
       _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
 
       case $host_cpu in
-      hppa*64*|ia64*) ;;
+      hppa*64*|ia64*)
+	_LT_AC_TAGVAR(hardcode_libdir_flag_spec_ld, $1)='+b $libdir'
+        ;;
       *)
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
         ;;
       esac
     fi
     case $host_cpu in
@@ -3291,13 +3220,13 @@
 	  # FIXME: insert proper C++ library support
 	  _LT_AC_TAGVAR(ld_shlibs, $1)=no
 	fi
 	;;
     esac
     ;;
-  interix[[3-9]]*)
+  interix3*)
     _LT_AC_TAGVAR(hardcode_direct, $1)=no
     _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
     _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
     # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
     # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -3411,35 +3340,12 @@
 	# There doesn't appear to be a way to prevent this compiler from
 	# explicitly linking system object files so we need to strip them
 	# from the output so that they don't get included in the library
 	# dependencies.
 	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
 	;;
-      *)
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C++ 5.9
-	  _LT_AC_TAGVAR(no_undefined_flag, $1)=' -zdefs'
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file ${wl}$export_symbols'
-	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-
-	  # Not sure whether something based on
-	  # $CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1
-	  # would be better.
-	  output_verbose_link_cmd='echo'
-
-	  # Archives containing C++ object files must be created using
-	  # "CC -xar", where "CC" is the Sun C++ compiler.  This is
-	  # necessary to make sure instantiated templates are included
-	  # in the archive.
-	  _LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -xar -o $oldlib $oldobjs'
-	  ;;
-	esac
-	;;
     esac
     ;;
   lynxos*)
     # FIXME: insert proper C++ library support
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
@@ -3472,26 +3378,22 @@
     ;;
   openbsd2*)
     # C++ shared libraries are fairly broken
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
   openbsd*)
-    if test -f /usr/libexec/ld.so; then
-      _LT_AC_TAGVAR(hardcode_direct, $1)=yes
-      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
-      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
-	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      fi
-      output_verbose_link_cmd='echo'
-    else
-      _LT_AC_TAGVAR(ld_shlibs, $1)=no
+    _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     fi
+    output_verbose_link_cmd='echo'
     ;;
   osf3*)
     case $cc_basename in
       KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
@@ -3647,16 +3549,21 @@
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
 	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
 	case $host_os in
 	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
 	  *)
-	    # The compiler driver will combine and reorder linker options,
-	    # but understands `-z linker_flag'.
+	    # The C++ compiler is used as linker so we must use $wl
+	    # flag to pass the commands to the underlying system
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract'
+	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
 	output_verbose_link_cmd='echo'
 
@@ -3697,18 +3604,12 @@
 	    # what "hidden" libraries, object files and flags are used when
 	    # linking a shared library.
 	    output_verbose_link_cmd="$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
 	  fi
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-R $wl$libdir'
-	  case $host_os in
-	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
-	  *)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	    ;;
-	  esac
 	fi
 	;;
     esac
     ;;
   sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7* | sco3.2v5.0.[[024]]*)
     _LT_AC_TAGVAR(no_undefined_flag, $1)='${wl}-z,text'
@@ -3946,60 +3847,27 @@
 
 $rm -f confest.$objext
 
 # PORTME: override above test on systems where it is broken
 ifelse([$1],[CXX],
 [case $host_os in
-interix[[3-9]]*)
+interix3*)
   # Interix 3.5 installs completely hosed .la files for C++, so rather than
   # hack all around it, let's just trust "g++" to DTRT.
   _LT_AC_TAGVAR(predep_objects,$1)=
   _LT_AC_TAGVAR(postdep_objects,$1)=
   _LT_AC_TAGVAR(postdeps,$1)=
   ;;
 
-linux*)
-  case `$CC -V 2>&1 | sed 5q` in
-  *Sun\ C*)
-    # Sun C++ 5.9
-    #
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-    if test "$solaris_use_stlport4" != yes; then
-      _LT_AC_TAGVAR(postdeps,$1)='-library=Cstd -library=Crun'
-    fi
-    ;;
-  esac
-  ;;
-
 solaris*)
   case $cc_basename in
   CC*)
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-
     # Adding this requires a known-good setup of shared libraries for
     # Sun compiler versions before 5.6, else PIC objects from an old
     # archive will be linked into the output, leading to subtle bugs.
-    if test "$solaris_use_stlport4" != yes; then
-      _LT_AC_TAGVAR(postdeps,$1)='-library=Cstd -library=Crun'
-    fi
+    _LT_AC_TAGVAR(postdeps,$1)='-lCstd -lCrun'
     ;;
   esac
   ;;
 esac
 ])
 
@@ -4042,23 +3910,16 @@
 
 # Object file extension for compiled f77 test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="\
-      subroutine t
-      return
-      end
-"
+lt_simple_compile_test_code="      subroutine t\n      return\n      end\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code="\
-      program t
-      end
-"
+lt_simple_link_test_code="      program t\n      end\n"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -4131,16 +3992,16 @@
 
 # Object file extension for compiled Java test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="class foo {}"
+lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }'
+lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -4187,13 +4048,13 @@
 
 # Object file extension for compiled RC test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }'
+lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }\n'
 
 # Code to be used in simple link tests
 lt_simple_link_test_code="$lt_simple_compile_test_code"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
@@ -4276,13 +4137,12 @@
     _LT_AC_TAGVAR(hardcode_libdir_flag_spec_ld, $1) \
     _LT_AC_TAGVAR(hardcode_libdir_separator, $1) \
     _LT_AC_TAGVAR(hardcode_automatic, $1) \
     _LT_AC_TAGVAR(module_cmds, $1) \
     _LT_AC_TAGVAR(module_expsym_cmds, $1) \
     _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1) \
-    _LT_AC_TAGVAR(fix_srcfile_path, $1) \
     _LT_AC_TAGVAR(exclude_expsyms, $1) \
     _LT_AC_TAGVAR(include_expsyms, $1); do
 
     case $var in
     _LT_AC_TAGVAR(old_archive_cmds, $1) | \
     _LT_AC_TAGVAR(old_archive_from_new_cmds, $1) | \
@@ -4323,13 +4183,13 @@
 [#! $SHELL
 
 # `$echo "$cfgfile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
 # Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
 # NOTE: Changes made to this file will be lost: look at ltmain.sh.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
 # Free Software Foundation, Inc.
 #
 # This file is part of GNU Libtool:
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
@@ -4648,13 +4508,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$_LT_AC_TAGVAR(fix_srcfile_path, $1)"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$_LT_AC_TAGVAR(always_export_symbols, $1)
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_[]_LT_AC_TAGVAR(export_symbols_cmds, $1)
@@ -4731,13 +4591,12 @@
 
 
 # AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE
 # ---------------------------------
 AC_DEFUN([AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE],
 [AC_REQUIRE([AC_CANONICAL_HOST])
-AC_REQUIRE([LT_AC_PROG_SED])
 AC_REQUIRE([AC_PROG_NM])
 AC_REQUIRE([AC_OBJEXT])
 # Check for command to grab the raw symbol name followed by C symbol from nm.
 AC_MSG_CHECKING([command to parse $NM output from $compiler object])
 AC_CACHE_VAL([lt_cv_sys_global_symbol_pipe],
 [
@@ -4958,32 +4817,30 @@
     amigaos*)
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-m68020 -resident32 -malways-restore-a4'
       ;;
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
-    mingw* | cygwin* | os2* | pw32*)
+    mingw* | os2* | pw32*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fno-common'
       ;;
     *djgpp*)
       # DJGPP does not support shared libraries at all
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=
       ;;
-    interix[[3-9]]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
     sysv4*MP*)
       if test -d /usr/nec; then
 	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=-Kconform_pic
@@ -5113,20 +4970,12 @@
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
-	    *Sun\ C*)
-	      # Sun C++ 5.9
-	      _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	      _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld '
-	      ;;
-	    esac
 	    ;;
 	esac
 	;;
       lynxos*)
 	;;
       m88k*)
@@ -5241,31 +5090,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fno-common'
       ;;
 
-    interix[[3-9]]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -5317,13 +5164,13 @@
          _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
          _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -5369,41 +5216,21 @@
         ;;
       ccc*)
         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
         # All Alpha code is PIC.
         _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	  _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	  _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	  _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	  _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
       # All OSF/1 code is PIC.
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
       ;;
 
-    rdos*)
-      _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
-      ;;
-
     solaris*)
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld ';;
@@ -5492,14 +5319,13 @@
 
 
 # AC_LIBTOOL_PROG_LD_SHLIBS([TAGNAME])
 # ------------------------------------
 # See if the linker supports building shared libraries.
 AC_DEFUN([AC_LIBTOOL_PROG_LD_SHLIBS],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
+[AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
 ifelse([$1],[CXX],[
   _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix4* | aix5*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
@@ -5510,13 +5336,13 @@
     fi
     ;;
   pw32*)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([[^ ]]*\) [[^ ]]*/\1 DATA/;/^I /d;/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   linux* | k*bsd*-gnu)
     _LT_AC_TAGVAR(link_all_deplibs, $1)=no
   ;;
   *)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
@@ -5652,13 +5478,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1) is actually meaningless,
       # as there is no search path for DLLs.
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-L$libdir'
       _LT_AC_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_AC_TAGVAR(always_export_symbols, $1)=no
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -5670,13 +5496,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
-    interix[[3-9]]*)
+    interix3*)
       _LT_AC_TAGVAR(hardcode_direct, $1)=no
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
       _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -5685,13 +5511,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -5703,28 +5529,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=no
       else
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
@@ -5759,13 +5576,13 @@
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
       case `$LD -v 2>&1` in
-        *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*)
+        *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*) 
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
 
 *** Warning: Releases of the GNU linker prior to 2.16.91.0.3 can not
 *** reliably create shared libraries on SCO systems.  Therefore, libtool
 *** is disabling shared libraries support.  We urge you to upgrade GNU
@@ -5878,13 +5695,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  _LT_AC_TAGVAR(hardcode_direct, $1)=yes
 	  else
   	  # We have old collect2
   	  _LT_AC_TAGVAR(hardcode_direct, $1)=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -5971,13 +5788,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       _LT_AC_TAGVAR(old_archive_From_new_cmds, $1)='true'
       # FIXME: Should let the user specify the lib program.
-      _LT_AC_TAGVAR(old_archive_cmds, $1)='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      _LT_AC_TAGVAR(old_archive_cmds, $1)='lib /OUT:$oldlib$oldobjs$old_deplibs'
       _LT_AC_TAGVAR(fix_srcfile_path, $1)='`cygpath -w "$srcfile"`'
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -6013,16 +5830,16 @@
       _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          _LT_AC_TAGVAR(ld_shlibs, $1)=no
           ;;
       esac
@@ -6178,34 +5995,30 @@
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
       _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	_LT_AC_TAGVAR(hardcode_direct, $1)=yes
-	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	  _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[[01]].* | openbsd2.[[0-7]] | openbsd2.[[0-7]].*)
-	     _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
-	     ;;
-	   *)
-	     _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       else
-	_LT_AC_TAGVAR(ld_shlibs, $1)=no
+       case $host_os in
+	 openbsd[[01]].* | openbsd2.[[0-7]] | openbsd2.[[0-7]].*)
+	   _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
+	   ;;
+	 *)
+	   _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-L$libdir'
       _LT_AC_TAGVAR(hardcode_minus_L, $1)=yes
@@ -6258,22 +6071,23 @@
       fi
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       case $host_os in
       solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -6324,13 +6138,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	_LT_AC_TAGVAR(ld_shlibs, $1)=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7* | sco3.2v5.0.[[024]]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7*)
       _LT_AC_TAGVAR(no_undefined_flag, $1)='${wl}-z,text'
       _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -6399,13 +6213,13 @@
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       AC_MSG_CHECKING([whether -lc should be explicitly linked in])
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if AC_TRY_EVAL(ac_compile) 2>conftest.err; then
         soname=conftest
         lib=conftest
         libobjs=conftest.$ac_objext
         deplibs=
@@ -6502,36 +6316,12 @@
 ])
 
 AC_DEFUN([LT_AC_PROG_RC],
 [AC_CHECK_TOOL(RC, windres, no)
 ])
 
-
-# Cheap backport of AS_EXECUTABLE_P and required macros
-# from Autoconf 2.59; we should not use $as_executable_p directly.
-
-# _AS_TEST_PREPARE
-# ----------------
-m4_ifndef([_AS_TEST_PREPARE],
-[m4_defun([_AS_TEST_PREPARE],
-[if test -x / >/dev/null 2>&1; then
-  as_executable_p='test -x'
-else
-  as_executable_p='test -f'
-fi
-])])# _AS_TEST_PREPARE
-
-# AS_EXECUTABLE_P
-# ---------------
-# Check whether a file is executable.
-m4_ifndef([AS_EXECUTABLE_P],
-[m4_defun([AS_EXECUTABLE_P],
-[AS_REQUIRE([_AS_TEST_PREPARE])dnl
-$as_executable_p $1[]dnl
-])])# AS_EXECUTABLE_P
-
 # NOTE: This macro has been submitted for inclusion into   #
 #  GNU Autoconf as AC_PROG_SED.  When it is available in   #
 #  a released version of Autoconf we should remove this    #
 #  macro and use it instead.                               #
 # LT_AC_PROG_SED
 # --------------
@@ -6546,19 +6336,18 @@
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for lt_ac_prog in sed gsed; do
     for ac_exec_ext in '' $ac_executable_extensions; do
-      if AS_EXECUTABLE_P(["$as_dir/$lt_ac_prog$ac_exec_ext"]); then
+      if $as_executable_p "$as_dir/$lt_ac_prog$ac_exec_ext"; then
         lt_ac_sed_list="$lt_ac_sed_list $as_dir/$lt_ac_prog$ac_exec_ext"
       fi
     done
   done
 done
-IFS=$as_save_IFS
 lt_ac_max=0
 lt_ac_count=0
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
   test ! -f $lt_ac_sed && continue
@@ -6585,13 +6374,12 @@
       lt_cv_path_SED=$lt_ac_sed
     fi
   done
 done
 ])
 SED=$lt_cv_path_SED
-AC_SUBST([SED])
 AC_MSG_RESULT([$SED])
 ])
 
 # Copyright (C) 2002, 2003, 2005  Free Software Foundation, Inc.
 #
 # This file is free software; the Free Software Foundation
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/AUTHORS /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/AUTHORS
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/AUTHORS	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/AUTHORS	2007-05-30 18:33:14.000000000 +0800
@@ -1,24 +1,30 @@
 This package was written by:
   Florian octo Forster <octo at verplant.org>
 
 apcups plugin by:
   Anthony Gialluca <tonyabg at charter.net>
 
-cpufreq and multimeter module by:
+cpufreq, multimeter and irq module by:
   Peter Holik <peter at holik.at>
 
 hddtemp module by:
   Vincent Stehl <vincent.stehle at free.fr>
 
+iptables module by:
+  Sjoerd van der Berg <harekiet at gmail.com>
+
 mbmon plugin by:
   Flavio Stanchina <flavio at stanchina.net>
 
 nfs module by:
   Jason Pepas <cell at ices.utexas.edu>
 
+perl module by:
+  Sebastian Harl <sh at tokkee.org>
+
 processes module by:
   Lyonel Vincent <lyonel at ezix.org>
 
 sensors plugin has been improved by:
   Lubo Stank <kolektor at atlas.cz>
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/ChangeLog /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/ChangeLog
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/ChangeLog	2007-09-28 18:54:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/ChangeLog	2007-05-31 23:33:12.000000000 +0800
@@ -1,12 +1,50 @@
-2007-09-28, Version 3.11.7
-	* wireless plugin: Correct the handling of cards returning signal and
-	  noise quality as percentage.
-
-2007-08-31, Version 3.11.6
-	* processes plugin: Fix a potential segmentation fault.
+2007-04-02, Version 4.0.0
+	* collectd: The plugin-infrastructure has been changed to allow for
+	  more types of plugins, namely `write' and `log' plugins.
+	* collectd: The read-function has been changed to read many plugins in
+	  parallel, using threads. Thus, plugins generally need to use
+	  thread-safe functions from now on.
+	* collectd: The '-t' command line options allows to perform syntax tests
+	  of the configuration file and exit immediately.
+	* csv plugin: The new `csv' plugin handles output to `comma separated
+	  values'-files.
+	* rrdtool plugin: The new `rrdtool' plugin handles output to
+	  RRD-files. Data can be cached to combine multiple updates into one
+	  write to increase IO-performance.
+	* network plugin: The new `network' plugin handles IO via the network.
+	  It implements a different, much more extensible protocol which can
+	  combine many values in one packet, decreasing the number of UDP-
+	  packets being sent. It can read from and send to the network and
+	  with the appropriate configuration even forward packets to other
+	  networks.
+	* unixsock plugin: The new `unixsock' plugin provides an interface to
+	  communicate with the daemon while it is running. Right now the
+	  commands `GETVAL' and `PUTVAL' are implemented, but more are to
+	  come.
+	* perl plugin: The new `perl' plugin allows you to write extensions
+	  for collectd in the scripting-language Perl.
+	* logfile plugin: The new `logfile' plugin writes logmessages to files
+	  or STDOUT or STDERR.
+	* syslog plugin: The new `syslog' plugin sends logmessages to the
+	  system's syslog daemon.
+	* entropy plugin: The new `entropy' plugin collects the amount of
+	  entropy currently being available to the system.
+	* exec plugin: The new `exec' plugin forks child processes and reads
+	  back values provided by the forked processes.
+	* iptables plugin: The new `iptables' plugin reads counters from
+	  iptables rules. Thanks to Sjoerd van der Berg for contributing this
+	  plugin.
+	* irq plugin: The new `irq' plugin collects the IRQ-counters. Thanks
+	  to Peter Holik for contributing this plugin.
+	* nut plugin: The new `nut' plugin connects the upsd of the `network
+	  ups tools' and reads information about the connected UPS.
+	* apache plugin: Support for lighttpd's `BusyServers' (aka.
+	  connections) field was added by Florent Monbillard.
+	* collectd-nagios: The new `collectd-nagios' binary queries values
+	  from collectd, parses them and exits according to Nagios-standards.
 
 2007-05-29, Version 3.11.5
 	* configure: Added `AC_SYS_LARGEFILE' for LFS.
 	* ntpd plugin: Fix a potential buffer overflow.
 	* processes plugin: Fix a bug when run under Linux 2.4. All processes
 	  were accounted as `zombies'.
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7: collectd.spec
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/config.guess /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/config.guess
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/config.guess	2007-08-17 11:14:13.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/config.guess	2007-04-20 10:09:10.000000000 +0800
@@ -1,13 +1,13 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
 #   2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation,
 #   Inc.
 
-timestamp='2007-07-22'
+timestamp='2007-03-06'
 
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
 #
@@ -327,13 +327,13 @@
     sun4H:SunOS:5.*:*)
 	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
 	exit ;;
     sun4*:SunOS:5.*:* | tadpole*:SunOS:5.*:*)
 	echo sparc-sun-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
 	exit ;;
-    i86pc:SunOS:5.*:* | i86xen:SunOS:5.*:*)
+    i86pc:SunOS:5.*:*)
 	echo i386-pc-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
 	exit ;;
     sun4*:SunOS:6*:*)
 	# According to config.sub, this is the proper way to canonicalize
 	# SunOS6.  Hard to guess exactly what SunOS6 will be like, but
 	# it's likely to be more like Solaris than SunOS4.
@@ -790,13 +790,13 @@
 	exit ;;
     i*:PW*:*)
 	echo ${UNAME_MACHINE}-pc-pw32
 	exit ;;
     *:Interix*:[3456]*)
     	case ${UNAME_MACHINE} in
-	    x86)
+	    x86) 
 		echo i586-pc-interix${UNAME_RELEASE}
 		exit ;;
 	    EM64T | authenticamd)
 		echo x86_64-unknown-interix${UNAME_RELEASE}
 		exit ;;
 	esac ;;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/config.sub /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/config.sub
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/config.sub	2007-08-17 11:14:13.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/config.sub	2007-04-20 10:09:10.000000000 +0800
@@ -1,13 +1,13 @@
 #! /bin/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
 #   2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation,
 #   Inc.
 
-timestamp='2007-06-28'
+timestamp='2007-01-18'
 
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
 # can handle that machine.  It does not imply ALL GNU software can.
 #
 # This file is free software; you can redistribute it and/or modify
@@ -472,14 +472,14 @@
 		os=-unicos
 		;;
 	craynv)
 		basic_machine=craynv-cray
 		os=-unicosmp
 		;;
-	cr16)
-		basic_machine=cr16-unknown
+	cr16c)
+		basic_machine=cr16c-unknown
 		os=-elf
 		;;
 	crds | unos)
 		basic_machine=m68k-crds
 		;;
 	crisv32 | crisv32-* | etraxfs*)
@@ -680,16 +680,12 @@
 		os=-sysv
 		;;
 	mingw32)
 		basic_machine=i386-pc
 		os=-mingw32
 		;;
-	mingw32ce)
-		basic_machine=arm-unknown
-		os=-mingw32ce
-		;;
 	miniframe)
 		basic_machine=m68000-convergent
 		;;
 	*mint | -mint[0-9]* | *MiNT | *MiNT[0-9]*)
 		basic_machine=m68k-atari
 		os=-mint
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/configure	2007-09-28 19:01:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/configure	2007-06-04 01:13:33.000000000 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61 for collectd 3.11.7.
+# Generated by GNU Autoconf 2.61 for collectd 4.0.0.
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 # 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
@@ -723,14 +723,14 @@
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
 # Identity of this package.
 PACKAGE_NAME='collectd'
 PACKAGE_TARNAME='collectd'
-PACKAGE_VERSION='3.11.7'
-PACKAGE_STRING='collectd 3.11.7'
+PACKAGE_VERSION='4.0.0'
+PACKAGE_STRING='collectd 4.0.0'
 PACKAGE_BUGREPORT=''
 
 ac_unique_file="src/collectd.c"
 ac_default_prefix="/opt/collectd"
 # Factoring default headers for most tests.
 ac_includes_default="\
@@ -853,13 +853,12 @@
 build_vendor
 build_os
 host
 host_cpu
 host_vendor
 host_os
-SED
 GREP
 EGREP
 ECHO
 AR
 RANLIB
 CXX
@@ -870,12 +869,17 @@
 am__fastdepCXX_FALSE
 CXXCPP
 F77
 FFLAGS
 ac_ct_F77
 LIBTOOL
+LEX
+LEX_OUTPUT_ROOT
+LEXLIB
+YACC
+YFLAGS
 subdirs
 BUILD_WITH_LIBSOCKET_TRUE
 BUILD_WITH_LIBSOCKET_FALSE
 BUILD_WITH_LIBRT_TRUE
 BUILD_WITH_LIBRT_FALSE
 BUILD_WITH_LIBRESOLV_TRUE
@@ -900,18 +904,28 @@
 BUILD_WITH_LIBKVM_TRUE
 BUILD_WITH_LIBKVM_FALSE
 BUILD_WITH_LM_SENSORS_TRUE
 BUILD_WITH_LM_SENSORS_FALSE
 BUILD_WITH_LIBMYSQL_TRUE
 BUILD_WITH_LIBMYSQL_FALSE
+BUILD_WITH_OWN_LIBOCONFIG_TRUE
+BUILD_WITH_OWN_LIBOCONFIG_FALSE
 BUILD_WITH_LIBOPING_TRUE
 BUILD_WITH_LIBOPING_FALSE
 BUILD_WITH_OWN_LIBOPING_TRUE
 BUILD_WITH_OWN_LIBOPING_FALSE
 BUILD_WITH_LIBPCAP_TRUE
 BUILD_WITH_LIBPCAP_FALSE
+PERL_CFLAGS
+PERL_LDFLAGS
+BUILD_WITH_LIBPERL_TRUE
+BUILD_WITH_LIBPERL_FALSE
+BUILD_WITH_LIBIPTC_TRUE
+BUILD_WITH_LIBIPTC_FALSE
+BUILD_WITH_LIBUPSCLIENT_TRUE
+BUILD_WITH_LIBUPSCLIENT_FALSE
 BUILD_FEATURE_DEBUG_TRUE
 BUILD_FEATURE_DEBUG_FALSE
 BUILD_FEATURE_DAEMON_TRUE
 BUILD_FEATURE_DAEMON_FALSE
 BUILD_FEATURE_GETIFADDRS_TRUE
 BUILD_FEATURE_GETIFADDRS_FALSE
@@ -926,50 +940,70 @@
 BUILD_MODULE_CPU_TRUE
 BUILD_MODULE_CPU_FALSE
 BUILD_MODULE_CPUFREQ_TRUE
 BUILD_MODULE_CPUFREQ_FALSE
 BUILD_MODULE_DISK_TRUE
 BUILD_MODULE_DISK_FALSE
+BUILD_MODULE_CSV_TRUE
+BUILD_MODULE_CSV_FALSE
 BUILD_MODULE_DF_TRUE
 BUILD_MODULE_DF_FALSE
 BUILD_MODULE_DNS_TRUE
 BUILD_MODULE_DNS_FALSE
 BUILD_MODULE_EMAIL_TRUE
 BUILD_MODULE_EMAIL_FALSE
-BUILD_MODULE_QUOTA_TRUE
-BUILD_MODULE_QUOTA_FALSE
+BUILD_MODULE_ENTROPY_TRUE
+BUILD_MODULE_ENTROPY_FALSE
+BUILD_MODULE_EXEC_TRUE
+BUILD_MODULE_EXEC_FALSE
 BUILD_MODULE_HDDTEMP_TRUE
 BUILD_MODULE_HDDTEMP_FALSE
+BUILD_MODULE_INTERFACE_TRUE
+BUILD_MODULE_INTERFACE_FALSE
+BUILD_MODULE_IPTABLES_TRUE
+BUILD_MODULE_IPTABLES_FALSE
+BUILD_MODULE_IRQ_TRUE
+BUILD_MODULE_IRQ_FALSE
 BUILD_MODULE_LOAD_TRUE
 BUILD_MODULE_LOAD_FALSE
 BUILD_MODULE_MBMON_TRUE
 BUILD_MODULE_MBMON_FALSE
 BUILD_MODULE_MEMORY_TRUE
 BUILD_MODULE_MEMORY_FALSE
 BUILD_MODULE_MULTIMETER_TRUE
 BUILD_MODULE_MULTIMETER_FALSE
 BUILD_MODULE_MYSQL_TRUE
 BUILD_MODULE_MYSQL_FALSE
+BUILD_MODULE_NETWORK_TRUE
+BUILD_MODULE_NETWORK_FALSE
 BUILD_MODULE_NFS_TRUE
 BUILD_MODULE_NFS_FALSE
 BUILD_MODULE_NTPD_TRUE
 BUILD_MODULE_NTPD_FALSE
+BUILD_MODULE_NUT_TRUE
+BUILD_MODULE_NUT_FALSE
+BUILD_MODULE_PERL_TRUE
+BUILD_MODULE_PERL_FALSE
 BUILD_MODULE_PING_TRUE
 BUILD_MODULE_PING_FALSE
 BUILD_MODULE_PROCESSES_TRUE
 BUILD_MODULE_PROCESSES_FALSE
 BUILD_MODULE_SENSORS_TRUE
 BUILD_MODULE_SENSORS_FALSE
 BUILD_MODULE_SERIAL_TRUE
 BUILD_MODULE_SERIAL_FALSE
+BUILD_MODULE_LOGFILE_TRUE
+BUILD_MODULE_LOGFILE_FALSE
 BUILD_MODULE_SWAP_TRUE
 BUILD_MODULE_SWAP_FALSE
+BUILD_MODULE_SYSLOG_TRUE
+BUILD_MODULE_SYSLOG_FALSE
 BUILD_MODULE_TAPE_TRUE
 BUILD_MODULE_TAPE_FALSE
-BUILD_MODULE_TRAFFIC_TRUE
-BUILD_MODULE_TRAFFIC_FALSE
+BUILD_MODULE_UNIXSOCK_TRUE
+BUILD_MODULE_UNIXSOCK_FALSE
 BUILD_MODULE_USERS_TRUE
 BUILD_MODULE_USERS_FALSE
 BUILD_MODULE_VSERVER_TRUE
 BUILD_MODULE_VSERVER_FALSE
 BUILD_MODULE_WIRELESS_TRUE
 BUILD_MODULE_WIRELESS_FALSE
@@ -987,13 +1021,15 @@
 CPP
 CXX
 CXXFLAGS
 CCC
 CXXCPP
 F77
-FFLAGS'
+FFLAGS
+YACC
+YFLAGS'
 ac_subdirs_all='libltdl'
 
 # Initialize some variables set by options.
 ac_init_help=
 ac_init_version=false
 # The variables have the same names as the options, with
@@ -1490,13 +1526,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures collectd 3.11.7 to adapt to many kinds of systems.
+\`configure' configures collectd 4.0.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -1560,13 +1596,13 @@
   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of collectd 3.11.7:";;
+     short | recursive ) echo "Configuration of collectd 4.0.0:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
@@ -1590,33 +1626,42 @@
   --disable-apple_sensors disable Apple's hardware sensors (enabled by def)
   --disable-battery       disable battery statistics (enabled by def)
   --disable-cpu           disable cpu usage statistics (enabled by def)
   --disable-cpufreq       disable system cpu frequency statistics (enabled by
                           def)
   --disable-disk          disable disk/partition statistics (enabled by def)
+  --disable-csv           disable csv output plugin (enabled by def)
   --disable-df            disable df statistics (enabled by def)
   --disable-dns           disable dns statistics (enabled by def)
   --disable-email         disable email statistics (enabled by def)
-  --enable-quota          enable quota statistics (experimental) (disabled by
-                          def)
+  --disable-entropy       disable entropy statistics (enabled by def)
+  --disable-exec          disable exec of external programs (enabled by def)
   --disable-hddtemp       disable hdd temperature statistics (enabled by def)
+  --disable-interface     disable interface statistics (enabled by def)
+  --disable-iptables      disable IPtables statistics (enabled by def)
+  --disable-irq           disable irq statistics (enabled by def)
   --disable-load          disable system load statistics (enabled by def)
   --disable-mbmon         disable motherboard monitor statistics (enabled by
                           def)
   --disable-memory        disable memory statistics (enabled by def)
   --disable-multimeter    disable multimeter statistics (enabled by def)
   --disable-mysql         disable mysql statistics (enabled by def)
+  --disable-network       disable network functionality (enabled by def)
   --disable-nfs           disable nfs statistics (enabled by def)
-  --disable-ntpd          disable nfs statistics (enabled by def)
+  --disable-ntpd          disable ntpd statistics (enabled by def)
+  --disable-nut           disable network UPS tools statistics (enabled by def)
+  --disable-perl          disable embedded perl interpreter (enabled by def)
   --disable-ping          disable ping statistics (enabled by def)
   --disable-processes     disable processes statistics (enabled by def)
   --disable-sensors       disable lm_sensors statistics (enabled by def)
   --disable-serial        disable serial statistics (enabled by def)
+  --disable-logfile       disable logfile log facility (enabled by def)
   --disable-swap          disable swap statistics (enabled by def)
+  --disable-syslog        disable syslog log facility (enabled by def)
   --disable-tape          disable tape statistics (enabled by def)
-  --disable-traffic       disable system traffic statistics (enabled by def)
+  --disable-unixsock      disable UNIX socket plugin (enabled by def)
   --disable-users         disable user count statistics (enabled by def)
   --disable-vserver       disable vserver statistics (enabled by def)
   --disable-wireless      disable wireless link statistics (enabled by def)
 
 Optional Packages:
   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
@@ -1634,18 +1679,21 @@
   --with-libstatgrab[=PREFIX]
                           Path to libstatgrab.
   --with-lm-sensors[=PREFIX]
                           Path to lm_sensors.
   --with-libmysql[=PREFIX]
                           Path to libmysql.
+  --with-liboconfig[=PREFIX]
+                          Path to liboconfig.
   --with-liboping[=PREFIX]
                           Path to liboping.
   --with-libpcap[=PREFIX] Path to libpcap.
-  --with-step=SECONDS     Interval in which plugins are queried.
-  --with-heartbeat=SECONDS
-                          Heartbeat of the DS in generated RRD files.
+  --with-libperl[=PREFIX] Path to libperl.
+  --with-libiptc[=PREFIX] Path to libiptc.
+  --with-libupsclient[=PREFIX]
+                          Path to libupsclient.
 
 Some influential environment variables:
   CC          C compiler command
   CFLAGS      C compiler flags
   LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
               nonstandard directory <lib dir>
@@ -1655,12 +1703,17 @@
   CPP         C preprocessor
   CXX         C++ compiler command
   CXXFLAGS    C++ compiler flags
   CXXCPP      C++ preprocessor
   F77         Fortran 77 compiler command
   FFLAGS      Fortran 77 compiler flags
+  YACC        The `Yet Another C Compiler' implementation to use. Defaults to
+              the first program found out of: `bison -y', `byacc', `yacc'.
+  YFLAGS      The list of arguments that will be passed by default to $YACC.
+              This script will default YFLAGS to the empty string to avoid a
+              default value of `-d' given by some make applications.
 
 Use these variables to override the choices made by `configure' or to help
 it to find libraries and programs with nonstandard names/locations.
 
 _ACEOF
 ac_status=$?
@@ -1719,13 +1772,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-collectd configure 3.11.7
+collectd configure 4.0.0
 generated by GNU Autoconf 2.61
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
@@ -1733,13 +1786,13 @@
   exit
 fi
 cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by collectd $as_me 3.11.7, which was
+It was created by collectd $as_me 4.0.0, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 exec 5>>config.log
@@ -2406,13 +2459,13 @@
   fi
 fi
 
 
 # Define the identity of the package.
  PACKAGE='collectd'
- VERSION='3.11.7'
+ VERSION='4.0.0'
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -5342,19 +5395,18 @@
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for lt_ac_prog in sed gsed; do
     for ac_exec_ext in '' $ac_executable_extensions; do
-      if { test -f "$as_dir/$lt_ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$lt_ac_prog$ac_exec_ext"; }; then
+      if $as_executable_p "$as_dir/$lt_ac_prog$ac_exec_ext"; then
         lt_ac_sed_list="$lt_ac_sed_list $as_dir/$lt_ac_prog$ac_exec_ext"
       fi
     done
   done
 done
-IFS=$as_save_IFS
 lt_ac_max=0
 lt_ac_count=0
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
   test ! -f $lt_ac_sed && continue
@@ -5734,14 +5785,14 @@
 fi
 fi
 { echo "$as_me:$LINENO: result: $lt_cv_path_NM" >&5
 echo "${ECHO_T}$lt_cv_path_NM" >&6; }
 NM="$lt_cv_path_NM"
 
-{ echo "$as_me:$LINENO: checking how to recognize dependent libraries" >&5
-echo $ECHO_N "checking how to recognize dependent libraries... $ECHO_C" >&6; }
+{ echo "$as_me:$LINENO: checking how to recognise dependent libraries" >&5
+echo $ECHO_N "checking how to recognise dependent libraries... $ECHO_C" >&6; }
 if test "${lt_cv_deplibs_check_method+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_file_magic_cmd='$MAGIC_CMD'
 lt_cv_file_magic_test_file=
 lt_cv_deplibs_check_method='unknown'
@@ -5776,21 +5827,15 @@
   lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
   lt_cv_file_magic_cmd='func_win32_libid'
   ;;
 
 mingw* | pw32*)
   # Base MSYS/MinGW do not provide the 'file' command needed by
-  # func_win32_libid shell function, so use a weaker test based on 'objdump',
-  # unless we find 'file', for example because we are cross-compiling.
-  if ( file / ) >/dev/null 2>&1; then
-    lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
-    lt_cv_file_magic_cmd='func_win32_libid'
-  else
-    lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
-    lt_cv_file_magic_cmd='$OBJDUMP -f'
-  fi
+  # func_win32_libid shell function, so use a weaker test based on 'objdump'.
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
   ;;
 
 darwin* | rhapsody*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
@@ -5829,13 +5874,13 @@
     lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library'
     lt_cv_file_magic_test_file=/usr/lib/libc.sl
     ;;
   esac
   ;;
 
-interix[3-9]*)
+interix3*)
   # PIC code is broken on Interix 3.x, that's why |\.a not |_pic\.a here
   lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|\.a)$'
   ;;
 
 irix5* | irix6* | nonstopux*)
   case $LD in
@@ -5879,16 +5924,12 @@
   ;;
 
 osf3* | osf4* | osf5*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-rdos*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
 solaris*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
 sysv4 | sysv4.3*)
   case $host_vendor in
@@ -5969,13 +6010,13 @@
     esac
   fi
   rm -rf conftest*
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 5975 "configure"' > conftest.$ac_ext
+  echo '#line 6016 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
    if test "$lt_cv_prog_gnu_ld" = yes; then
@@ -6004,27 +6045,23 @@
     esac
    fi
   fi
   rm -rf conftest*
   ;;
 
-x86_64-*kfreebsd*-gnu|x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*| \
-s390*-*linux*|sparc*-*linux*)
+x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
     case `/usr/bin/file conftest.o` in
     *32-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_i386_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_i386"
           ;;
         ppc64-*linux*|powerpc64-*linux*)
           LD="${LD-ld} -m elf32ppclinux"
           ;;
@@ -6035,15 +6072,12 @@
           LD="${LD-ld} -m elf32_sparc"
           ;;
       esac
       ;;
     *64-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_x86_64_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_x86_64"
           ;;
         ppc*-*linux*|powerpc*-*linux*)
           LD="${LD-ld} -m elf64ppc"
           ;;
@@ -7596,33 +7630,30 @@
       lt_cv_sys_max_cmd_len=`echo $kargmax | sed 's/.*[ 	]//'`
     else
       lt_cv_sys_max_cmd_len=32768
     fi
     ;;
   *)
-    lt_cv_sys_max_cmd_len=`(getconf ARG_MAX) 2> /dev/null`
-    if test -n "$lt_cv_sys_max_cmd_len"; then
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    else
-      SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-      while (test "X"`$SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
+    # If test is not a shell built-in, we'll probably end up computing a
+    # maximum length that is only half of the actual maximum length, but
+    # we can't tell.
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
-	      new_result=`expr "X$teststring" : ".*" 2>&1` &&
-	      lt_cv_sys_max_cmd_len=$new_result &&
-	      test $i != 17 # 1/2 MB should be enough
-      do
-        i=`expr $i + 1`
-        teststring=$teststring$teststring
-      done
-      teststring=
-      # Add a significant safety factor because C++ compilers can tack on massive
-      # amounts of additional arguments before passing them to the linker.
-      # It appears as though 1/2 is a usable value.
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
-    fi
+	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
+	    lt_cv_sys_max_cmd_len=$new_result &&
+	    test $i != 17 # 1/2 MB should be enough
+    do
+      i=`expr $i + 1`
+      teststring=$teststring$teststring
+    done
+    teststring=
+    # Add a significant safety factor because C++ compilers can tack on massive
+    # amounts of additional arguments before passing them to the linker.
+    # It appears as though 1/2 is a usable value.
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
     ;;
   esac
 
 fi
 
 if test -n $lt_cv_sys_max_cmd_len ; then
@@ -8222,13 +8252,13 @@
 test -z "$OBJDUMP" && OBJDUMP=objdump
 test -z "$RANLIB" && RANLIB=:
 test -z "$STRIP" && STRIP=:
 test -z "$ac_objext" && ac_objext=o
 
 # Determine commands to create old-style static archives.
-old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs'
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
 old_postinstall_cmds='chmod 644 $oldlib'
 old_postuninstall_cmds=
 
 if test -n "$RANLIB"; then
   case $host_os in
   openbsd*)
@@ -8422,16 +8452,16 @@
 
 # Object file extension for compiled C test sources.
 objext=o
 objext=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(){return(0);}'
+lt_simple_link_test_code='int main(){return(0);}\n'
 
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
 # If no C compiler flags were specified, use CFLAGS.
@@ -8440,19 +8470,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 
@@ -8466,28 +8496,28 @@
 echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6; }
 if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_rtti_exceptions=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="-fno-rtti -fno-exceptions"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8483: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8513: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:8487: \$? = $ac_status" >&5
+   echo "$as_me:8517: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -8532,31 +8562,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -8608,13 +8636,13 @@
          lt_prog_compiler_pic='-qnocommon'
          lt_prog_compiler_wl='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -8660,41 +8688,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic='-KPIC'
-	  lt_prog_compiler_static='-Bstatic'
-	  lt_prog_compiler_wl='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic='-KPIC'
-	  lt_prog_compiler_static='-Bstatic'
-	  lt_prog_compiler_wl=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic='-KPIC'
       lt_prog_compiler_static='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl='-Qoption ld ';;
@@ -8756,28 +8764,28 @@
 echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic works... $ECHO_C" >&6; }
 if test "${lt_prog_compiler_pic_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic -DPIC"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8773: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8781: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:8777: \$? = $ac_status" >&5
+   echo "$as_me:8785: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -8820,13 +8828,13 @@
 if test "${lt_prog_compiler_static_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -8860,28 +8868,28 @@
 else
   lt_cv_prog_compiler_c_o=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8877: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8885: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8881: \$? = $ac_status" >&5
+   echo "$as_me:8889: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -9067,13 +9075,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, ) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec='-L$libdir'
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -9085,13 +9093,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct=no
       hardcode_shlibpath_var=no
       hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
       export_dynamic_flag_spec='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -9100,13 +9108,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -9118,28 +9126,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs=no
       else
 	ld_shlibs=no
       fi
       ;;
@@ -9293,13 +9292,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -9367,24 +9366,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -9433,24 +9425,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -9498,13 +9483,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -9540,16 +9525,16 @@
       archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs=no
           ;;
       esac
@@ -9705,34 +9690,30 @@
       hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator=:
       hardcode_shlibpath_var=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct=yes
-	hardcode_shlibpath_var=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct=yes
+      hardcode_shlibpath_var=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec='${wl}-E'
       else
-	ld_shlibs=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec='-L$libdir'
       hardcode_minus_L=yes
@@ -9785,22 +9766,23 @@
       fi
       hardcode_libdir_flag_spec='-R$libdir'
       hardcode_shlibpath_var=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -9851,13 +9833,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag='${wl}-z,text'
       archive_cmds_need_lc=no
       hardcode_shlibpath_var=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -9928,13 +9910,13 @@
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
 echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -9986,61 +9968,23 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
 if test "$GCC" = yes; then
-  case $host_os in
-    darwin*) lt_awk_arg="/^libraries:/,/LR/" ;;
-    *) lt_awk_arg="/^libraries:/" ;;
-  esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$lt_search_path_spec" | grep ';' >/dev/null ; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
     # if the path contains ";" then we assume it to be the separator
     # otherwise default to the standard path separator (i.e. ":") - it is
     # assumed that no part of a normal pathname contains ";" but that should
     # okay in the real world where ";" in dirpaths is itself problematic.
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED -e 's/;/ /g'`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
   else
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
   fi
-  # Ok, now we have the path, separated by spaces, we can step through it
-  # and add multilib dir if necessary.
-  lt_tmp_lt_search_path_spec=
-  lt_multi_os_dir=`$CC $CPPFLAGS $CFLAGS $LDFLAGS -print-multi-os-directory 2>/dev/null`
-  for lt_sys_path in $lt_search_path_spec; do
-    if test -d "$lt_sys_path/$lt_multi_os_dir"; then
-      lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path/$lt_multi_os_dir"
-    else
-      test -d "$lt_sys_path" && \
-	lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path"
-    fi
-  done
-  lt_search_path_spec=`echo $lt_tmp_lt_search_path_spec | awk '
-BEGIN {RS=" "; FS="/|\n";} {
-  lt_foo="";
-  lt_count=0;
-  for (lt_i = NF; lt_i > 0; lt_i--) {
-    if ($lt_i != "" && $lt_i != ".") {
-      if ($lt_i == "..") {
-        lt_count++;
-      } else {
-        if (lt_count == 0) {
-          lt_foo="/" $lt_i lt_foo;
-        } else {
-          lt_count--;
-        }
-      }
-    }
-  }
-  if (lt_foo != "") { lt_freq[lt_foo]++; }
-  if (lt_freq[lt_foo] == 1) { print lt_foo; }
-}'`
-  sys_lib_search_path_spec=`echo $lt_search_path_spec`
 else
   sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
 fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
@@ -10194,14 +10138,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
-  sys_lib_search_path_spec="$sys_lib_search_path_spec /usr/local/lib"
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -10249,13 +10197,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -10312,13 +10260,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -10383,13 +10331,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -10489,16 +10437,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -10646,13 +10590,12 @@
 else
 # FIXME - insert some real tests, host_os isn't really good enough
   case $host_os in
    darwin*)
        if test -n "$STRIP" ; then
          striplib="$STRIP -x"
-         old_striplib="$STRIP -S"
          { echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6; }
        else
   { echo "$as_me:$LINENO: result: no" >&5
 echo "${ECHO_T}no" >&6; }
 fi
@@ -11233,13 +11176,13 @@
   	  if test "$cross_compiling" = yes; then :
   lt_cv_dlopen_self=cross
 else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 11239 "configure"
+#line 11182 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
 #include <dlfcn.h>
 #endif
 
@@ -11333,13 +11276,13 @@
   	  if test "$cross_compiling" = yes; then :
   lt_cv_dlopen_self_static=cross
 else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 11339 "configure"
+#line 11282 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
 #include <dlfcn.h>
 #endif
 
@@ -11531,13 +11474,12 @@
     hardcode_libdir_flag_spec_ld \
     hardcode_libdir_separator \
     hardcode_automatic \
     module_cmds \
     module_expsym_cmds \
     lt_cv_prog_compiler_c_o \
-    fix_srcfile_path \
     exclude_expsyms \
     include_expsyms; do
 
     case $var in
     old_archive_cmds | \
     old_archive_from_new_cmds | \
@@ -11576,13 +11518,13 @@
 #! $SHELL
 
 # `$echo "$cfgfile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
 # Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
 # NOTE: Changes made to this file will be lost: look at ltmain.sh.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
 # Free Software Foundation, Inc.
 #
 # This file is part of GNU Libtool:
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
@@ -11900,13 +11842,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds
@@ -12069,16 +12011,16 @@
 
 # Object file extension for compiled C++ test sources.
 objext=o
 objext_CXX=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(int, char *[]) { return(0); }'
+lt_simple_link_test_code='int main(int, char *[]) { return(0); }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -12088,19 +12030,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -12353,13 +12295,13 @@
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
 	if test -f "$collect2name" && \
 	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	then
 	  # We have reworked collect2
-	  :
+	  hardcode_direct_CXX=yes
 	else
 	  # We have old collect2
 	  hardcode_direct_CXX=unsupported
 	  # It fails to find uninstalled libraries when the uninstalled
 	  # path is not listed in the libpath.  Setting hardcode_minus_L
 	  # to unsupported forces relinking
@@ -12427,24 +12369,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -12494,24 +12429,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_cxx_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -12624,16 +12552,16 @@
           fi
             module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
           module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-          archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_CXX=no
           ;;
       esac
@@ -12710,13 +12638,15 @@
   hpux10*|hpux11*)
     if test $with_gnu_ld = no; then
       hardcode_libdir_flag_spec_CXX='${wl}+b ${wl}$libdir'
       hardcode_libdir_separator_CXX=:
 
       case $host_cpu in
-      hppa*64*|ia64*) ;;
+      hppa*64*|ia64*)
+	hardcode_libdir_flag_spec_ld_CXX='+b $libdir'
+        ;;
       *)
 	export_dynamic_flag_spec_CXX='${wl}-E'
         ;;
       esac
     fi
     case $host_cpu in
@@ -12778,13 +12708,13 @@
 	  # FIXME: insert proper C++ library support
 	  ld_shlibs_CXX=no
 	fi
 	;;
     esac
     ;;
-  interix[3-9]*)
+  interix3*)
     hardcode_direct_CXX=no
     hardcode_shlibpath_var_CXX=no
     hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
     export_dynamic_flag_spec_CXX='${wl}-E'
     # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
     # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -12898,35 +12828,12 @@
 	# There doesn't appear to be a way to prevent this compiler from
 	# explicitly linking system object files so we need to strip them
 	# from the output so that they don't get included in the library
 	# dependencies.
 	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
 	;;
-      *)
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C++ 5.9
-	  no_undefined_flag_CXX=' -zdefs'
-	  archive_cmds_CXX='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	  archive_expsym_cmds_CXX='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file ${wl}$export_symbols'
-	  hardcode_libdir_flag_spec_CXX='-R$libdir'
-	  whole_archive_flag_spec_CXX='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-
-	  # Not sure whether something based on
-	  # $CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1
-	  # would be better.
-	  output_verbose_link_cmd='echo'
-
-	  # Archives containing C++ object files must be created using
-	  # "CC -xar", where "CC" is the Sun C++ compiler.  This is
-	  # necessary to make sure instantiated templates are included
-	  # in the archive.
-	  old_archive_cmds_CXX='$CC -xar -o $oldlib $oldobjs'
-	  ;;
-	esac
-	;;
     esac
     ;;
   lynxos*)
     # FIXME: insert proper C++ library support
     ld_shlibs_CXX=no
     ;;
@@ -12959,26 +12866,22 @@
     ;;
   openbsd2*)
     # C++ shared libraries are fairly broken
     ld_shlibs_CXX=no
     ;;
   openbsd*)
-    if test -f /usr/libexec/ld.so; then
-      hardcode_direct_CXX=yes
-      hardcode_shlibpath_var_CXX=no
-      archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-      hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-	export_dynamic_flag_spec_CXX='${wl}-E'
-	whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      fi
-      output_verbose_link_cmd='echo'
-    else
-      ld_shlibs_CXX=no
+    hardcode_direct_CXX=yes
+    hardcode_shlibpath_var_CXX=no
+    archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      export_dynamic_flag_spec_CXX='${wl}-E'
+      whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     fi
+    output_verbose_link_cmd='echo'
     ;;
   osf3*)
     case $cc_basename in
       KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
@@ -13134,16 +13037,21 @@
 
 	hardcode_libdir_flag_spec_CXX='-R$libdir'
 	hardcode_shlibpath_var_CXX=no
 	case $host_os in
 	  solaris2.[0-5] | solaris2.[0-5].*) ;;
 	  *)
-	    # The compiler driver will combine and reorder linker options,
-	    # but understands `-z linker_flag'.
+	    # The C++ compiler is used as linker so we must use $wl
+	    # flag to pass the commands to the underlying system
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    whole_archive_flag_spec_CXX='-z allextract$convenience -z defaultextract'
+	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	link_all_deplibs_CXX=yes
 
 	output_verbose_link_cmd='echo'
 
@@ -13184,18 +13092,12 @@
 	    # what "hidden" libraries, object files and flags are used when
 	    # linking a shared library.
 	    output_verbose_link_cmd="$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
 	  fi
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
-	  case $host_os in
-	  solaris2.[0-5] | solaris2.[0-5].*) ;;
-	  *)
-	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	    ;;
-	  esac
 	fi
 	;;
     esac
     ;;
   sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
     no_undefined_flag_CXX='${wl}-z,text'
@@ -13381,60 +13283,27 @@
 fi
 
 $rm -f confest.$objext
 
 # PORTME: override above test on systems where it is broken
 case $host_os in
-interix[3-9]*)
+interix3*)
   # Interix 3.5 installs completely hosed .la files for C++, so rather than
   # hack all around it, let's just trust "g++" to DTRT.
   predep_objects_CXX=
   postdep_objects_CXX=
   postdeps_CXX=
   ;;
 
-linux*)
-  case `$CC -V 2>&1 | sed 5q` in
-  *Sun\ C*)
-    # Sun C++ 5.9
-    #
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-    if test "$solaris_use_stlport4" != yes; then
-      postdeps_CXX='-library=Cstd -library=Crun'
-    fi
-    ;;
-  esac
-  ;;
-
 solaris*)
   case $cc_basename in
   CC*)
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-
     # Adding this requires a known-good setup of shared libraries for
     # Sun compiler versions before 5.6, else PIC objects from an old
     # archive will be linked into the output, leading to subtle bugs.
-    if test "$solaris_use_stlport4" != yes; then
-      postdeps_CXX='-library=Cstd -library=Crun'
-    fi
+    postdeps_CXX='-lCstd -lCrun'
     ;;
   esac
   ;;
 esac
 
 
@@ -13465,32 +13334,30 @@
     amigaos*)
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_CXX='-m68020 -resident32 -malways-restore-a4'
       ;;
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
-    mingw* | cygwin* | os2* | pw32*)
+    mingw* | os2* | pw32*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_CXX='-DDLL_EXPORT'
       ;;
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_CXX='-fno-common'
       ;;
     *djgpp*)
       # DJGPP does not support shared libraries at all
       lt_prog_compiler_pic_CXX=
       ;;
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
     sysv4*MP*)
       if test -d /usr/nec; then
 	lt_prog_compiler_pic_CXX=-Kconform_pic
@@ -13620,20 +13487,12 @@
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
 	    lt_prog_compiler_pic_CXX=
 	    lt_prog_compiler_static_CXX='-non_shared'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
-	    *Sun\ C*)
-	      # Sun C++ 5.9
-	      lt_prog_compiler_pic_CXX='-KPIC'
-	      lt_prog_compiler_static_CXX='-Bstatic'
-	      lt_prog_compiler_wl_CXX='-Qoption ld '
-	      ;;
-	    esac
 	    ;;
 	esac
 	;;
       lynxos*)
 	;;
       m88k*)
@@ -13742,28 +13601,28 @@
 echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works... $ECHO_C" >&6; }
 if test "${lt_prog_compiler_pic_works_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_CXX=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_CXX -DPIC"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13759: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13618: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:13763: \$? = $ac_status" >&5
+   echo "$as_me:13622: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -13806,13 +13665,13 @@
 if test "${lt_prog_compiler_static_works_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_CXX=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -13846,28 +13705,28 @@
 else
   lt_cv_prog_compiler_c_o_CXX=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13863: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13722: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:13867: \$? = $ac_status" >&5
+   echo "$as_me:13726: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -13927,13 +13786,13 @@
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([^ ]*\) [^ ]*/\1 DATA/;/^I /d;/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   linux* | k*bsd*-gnu)
     link_all_deplibs_CXX=no
   ;;
   *)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
@@ -13961,13 +13820,13 @@
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
 echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -14019,13 +13878,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -14176,13 +14048,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -14230,13 +14107,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -14293,13 +14170,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -14364,13 +14241,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -14470,16 +14347,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -14668,13 +14541,12 @@
     hardcode_libdir_flag_spec_ld_CXX \
     hardcode_libdir_separator_CXX \
     hardcode_automatic_CXX \
     module_cmds_CXX \
     module_expsym_cmds_CXX \
     lt_cv_prog_compiler_c_o_CXX \
-    fix_srcfile_path_CXX \
     exclude_expsyms_CXX \
     include_expsyms_CXX; do
 
     case $var in
     old_archive_cmds_CXX | \
     old_archive_from_new_cmds_CXX | \
@@ -14989,13 +14861,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_CXX"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_CXX
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_CXX
@@ -15080,23 +14952,16 @@
 
 # Object file extension for compiled f77 test sources.
 objext=o
 objext_F77=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="\
-      subroutine t
-      return
-      end
-"
+lt_simple_compile_test_code="      subroutine t\n      return\n      end\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code="\
-      program t
-      end
-"
+lt_simple_link_test_code="      program t\n      end\n"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -15106,19 +14971,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -15199,31 +15064,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_F77='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_F77='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_F77='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -15275,13 +15138,13 @@
          lt_prog_compiler_pic_F77='-qnocommon'
          lt_prog_compiler_wl_F77='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic_F77='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -15327,41 +15190,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl_F77='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static_F77='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic_F77='-KPIC'
-	  lt_prog_compiler_static_F77='-Bstatic'
-	  lt_prog_compiler_wl_F77='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic_F77='-KPIC'
-	  lt_prog_compiler_static_F77='-Bstatic'
-	  lt_prog_compiler_wl_F77=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl_F77='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static_F77='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static_F77='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic_F77='-KPIC'
       lt_prog_compiler_static_F77='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl_F77='-Qoption ld ';;
@@ -15423,28 +15266,28 @@
 echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works... $ECHO_C" >&6; }
 if test "${lt_prog_compiler_pic_works_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_F77=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_F77"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15440: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:15283: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:15444: \$? = $ac_status" >&5
+   echo "$as_me:15287: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -15487,13 +15330,13 @@
 if test "${lt_prog_compiler_static_works_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_F77=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -15527,28 +15370,28 @@
 else
   lt_cv_prog_compiler_c_o_F77=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15544: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:15387: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:15548: \$? = $ac_status" >&5
+   echo "$as_me:15391: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -15734,13 +15577,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, F77) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec_F77='-L$libdir'
       allow_undefined_flag_F77=unsupported
       always_export_symbols_F77=no
       enable_shared_with_static_runtimes_F77=yes
-      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds_F77='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -15752,13 +15595,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs_F77=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct_F77=no
       hardcode_shlibpath_var_F77=no
       hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
       export_dynamic_flag_spec_F77='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -15767,13 +15610,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds_F77='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds_F77='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec_F77='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -15785,28 +15628,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec_F77='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds_F77='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_F77='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds_F77='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs_F77=no
       else
 	ld_shlibs_F77=no
       fi
       ;;
@@ -15960,13 +15794,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct_F77=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct_F77=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -16024,24 +15858,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_f77_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -16080,24 +15907,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_f77_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -16145,13 +15965,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds_F77='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds_F77='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_F77='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds_F77='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path_F77='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_F77=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -16187,16 +16007,16 @@
       archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_F77=no
           ;;
       esac
@@ -16352,34 +16172,30 @@
       hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator_F77=:
       hardcode_shlibpath_var_F77=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct_F77=yes
-	hardcode_shlibpath_var_F77=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec_F77='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec_F77='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct_F77=yes
+      hardcode_shlibpath_var_F77=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec_F77='${wl}-E'
       else
-	ld_shlibs_F77=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec_F77='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec_F77='-L$libdir'
       hardcode_minus_L_F77=yes
@@ -16432,22 +16248,23 @@
       fi
       hardcode_libdir_flag_spec_F77='-R$libdir'
       hardcode_shlibpath_var_F77=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_F77=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -16498,13 +16315,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs_F77=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag_F77='${wl}-z,text'
       archive_cmds_need_lc_F77=no
       hardcode_shlibpath_var_F77=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -16575,13 +16392,13 @@
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
 echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -16633,13 +16450,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -16790,13 +16620,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -16844,13 +16679,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -16907,13 +16742,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -16978,13 +16813,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -17084,16 +16919,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -17282,13 +17113,12 @@
     hardcode_libdir_flag_spec_ld_F77 \
     hardcode_libdir_separator_F77 \
     hardcode_automatic_F77 \
     module_cmds_F77 \
     module_expsym_cmds_F77 \
     lt_cv_prog_compiler_c_o_F77 \
-    fix_srcfile_path_F77 \
     exclude_expsyms_F77 \
     include_expsyms_F77; do
 
     case $var in
     old_archive_cmds_F77 | \
     old_archive_from_new_cmds_F77 | \
@@ -17603,13 +17433,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_F77"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_F77
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_F77
@@ -17661,16 +17491,16 @@
 
 # Object file extension for compiled Java test sources.
 objext=o
 objext_GCJ=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="class foo {}"
+lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }'
+lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -17680,19 +17510,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -17727,28 +17557,28 @@
 echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6; }
 if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_rtti_exceptions=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="-fno-rtti -fno-exceptions"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:17744: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:17574: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:17748: \$? = $ac_status" >&5
+   echo "$as_me:17578: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -17793,31 +17623,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_GCJ='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_GCJ='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -17869,13 +17697,13 @@
          lt_prog_compiler_pic_GCJ='-qnocommon'
          lt_prog_compiler_wl_GCJ='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -17921,41 +17749,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl_GCJ='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static_GCJ='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic_GCJ='-KPIC'
-	  lt_prog_compiler_static_GCJ='-Bstatic'
-	  lt_prog_compiler_wl_GCJ='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic_GCJ='-KPIC'
-	  lt_prog_compiler_static_GCJ='-Bstatic'
-	  lt_prog_compiler_wl_GCJ=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl_GCJ='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static_GCJ='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static_GCJ='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic_GCJ='-KPIC'
       lt_prog_compiler_static_GCJ='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl_GCJ='-Qoption ld ';;
@@ -18017,28 +17825,28 @@
 echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works... $ECHO_C" >&6; }
 if test "${lt_prog_compiler_pic_works_GCJ+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_GCJ=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_GCJ"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18034: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:17842: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:18038: \$? = $ac_status" >&5
+   echo "$as_me:17846: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
@@ -18081,13 +17889,13 @@
 if test "${lt_prog_compiler_static_works_GCJ+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_GCJ=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -18121,28 +17929,28 @@
 else
   lt_cv_prog_compiler_c_o_GCJ=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18138: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:17946: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:18142: \$? = $ac_status" >&5
+   echo "$as_me:17950: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -18328,13 +18136,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, GCJ) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec_GCJ='-L$libdir'
       allow_undefined_flag_GCJ=unsupported
       always_export_symbols_GCJ=no
       enable_shared_with_static_runtimes_GCJ=yes
-      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds_GCJ='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -18346,13 +18154,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs_GCJ=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct_GCJ=no
       hardcode_shlibpath_var_GCJ=no
       hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
       export_dynamic_flag_spec_GCJ='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -18361,13 +18169,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds_GCJ='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds_GCJ='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec_GCJ='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -18379,28 +18187,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec_GCJ='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds_GCJ='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_GCJ='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds_GCJ='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs_GCJ=no
       else
 	ld_shlibs_GCJ=no
       fi
       ;;
@@ -18554,13 +18353,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct_GCJ=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct_GCJ=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -18628,24 +18427,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -18694,24 +18486,17 @@
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
 
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 
 fi
@@ -18759,13 +18544,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds_GCJ='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds_GCJ='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_GCJ='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds_GCJ='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path_GCJ='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_GCJ=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -18801,16 +18586,16 @@
       archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_GCJ=no
           ;;
       esac
@@ -18966,34 +18751,30 @@
       hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator_GCJ=:
       hardcode_shlibpath_var_GCJ=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct_GCJ=yes
-	hardcode_shlibpath_var_GCJ=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec_GCJ='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec_GCJ='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct_GCJ=yes
+      hardcode_shlibpath_var_GCJ=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec_GCJ='${wl}-E'
       else
-	ld_shlibs_GCJ=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec_GCJ='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec_GCJ='-L$libdir'
       hardcode_minus_L_GCJ=yes
@@ -19046,22 +18827,23 @@
       fi
       hardcode_libdir_flag_spec_GCJ='-R$libdir'
       hardcode_shlibpath_var_GCJ=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_GCJ=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -19112,13 +18894,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs_GCJ=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag_GCJ='${wl}-z,text'
       archive_cmds_need_lc_GCJ=no
       hardcode_shlibpath_var_GCJ=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -19189,13 +18971,13 @@
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
 echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -19247,13 +19029,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -19404,13 +19199,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -19458,13 +19258,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -19521,13 +19321,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -19592,13 +19392,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -19698,16 +19498,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -19896,13 +19692,12 @@
     hardcode_libdir_flag_spec_ld_GCJ \
     hardcode_libdir_separator_GCJ \
     hardcode_automatic_GCJ \
     module_cmds_GCJ \
     module_expsym_cmds_GCJ \
     lt_cv_prog_compiler_c_o_GCJ \
-    fix_srcfile_path_GCJ \
     exclude_expsyms_GCJ \
     include_expsyms_GCJ; do
 
     case $var in
     old_archive_cmds_GCJ | \
     old_archive_from_new_cmds_GCJ | \
@@ -20217,13 +20012,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_GCJ"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_GCJ
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_GCJ
@@ -20274,13 +20069,13 @@
 
 # Object file extension for compiled RC test sources.
 objext=o
 objext_RC=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }'
+lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }\n'
 
 # Code to be used in simple link tests
 lt_simple_link_test_code="$lt_simple_compile_test_code"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
@@ -20293,19 +20088,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -20377,13 +20172,12 @@
     hardcode_libdir_flag_spec_ld_RC \
     hardcode_libdir_separator_RC \
     hardcode_automatic_RC \
     module_cmds_RC \
     module_expsym_cmds_RC \
     lt_cv_prog_compiler_c_o_RC \
-    fix_srcfile_path_RC \
     exclude_expsyms_RC \
     include_expsyms_RC; do
 
     case $var in
     old_archive_cmds_RC | \
     old_archive_from_new_cmds_RC | \
@@ -20698,13 +20492,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_RC"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_RC
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_RC
@@ -20797,13 +20591,259 @@
 
 
 
 
 
 
-#AC_PROG_RANLIB
+for ac_prog in flex lex
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_LEX+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -n "$LEX"; then
+  ac_cv_prog_LEX="$LEX" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_LEX="$ac_prog"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+fi
+fi
+LEX=$ac_cv_prog_LEX
+if test -n "$LEX"; then
+  { echo "$as_me:$LINENO: result: $LEX" >&5
+echo "${ECHO_T}$LEX" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+  test -n "$LEX" && break
+done
+test -n "$LEX" || LEX=":"
+
+if test "x$LEX" != "x:"; then
+  cat >conftest.l <<_ACEOF
+%%
+a { ECHO; }
+b { REJECT; }
+c { yymore (); }
+d { yyless (1); }
+e { yyless (input () != 0); }
+f { unput (yytext[0]); }
+. { BEGIN INITIAL; }
+%%
+#ifdef YYTEXT_POINTER
+extern char *yytext;
+#endif
+int
+main (void)
+{
+  return ! yylex () + ! yywrap ();
+}
+_ACEOF
+{ (ac_try="$LEX conftest.l"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$LEX conftest.l") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }
+{ echo "$as_me:$LINENO: checking lex output file root" >&5
+echo $ECHO_N "checking lex output file root... $ECHO_C" >&6; }
+if test "${ac_cv_prog_lex_root+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+if test -f lex.yy.c; then
+  ac_cv_prog_lex_root=lex.yy
+elif test -f lexyy.c; then
+  ac_cv_prog_lex_root=lexyy
+else
+  { { echo "$as_me:$LINENO: error: cannot find output from $LEX; giving up" >&5
+echo "$as_me: error: cannot find output from $LEX; giving up" >&2;}
+   { (exit 1); exit 1; }; }
+fi
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_prog_lex_root" >&5
+echo "${ECHO_T}$ac_cv_prog_lex_root" >&6; }
+LEX_OUTPUT_ROOT=$ac_cv_prog_lex_root
+
+if test -z "${LEXLIB+set}"; then
+  { echo "$as_me:$LINENO: checking lex library" >&5
+echo $ECHO_N "checking lex library... $ECHO_C" >&6; }
+if test "${ac_cv_lib_lex+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+    ac_save_LIBS=$LIBS
+    ac_cv_lib_lex='none needed'
+    for ac_lib in '' -lfl -ll; do
+      LIBS="$ac_lib $ac_save_LIBS"
+      cat >conftest.$ac_ext <<_ACEOF
+`cat $LEX_OUTPUT_ROOT.c`
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_lex=$ac_lib
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+      test "$ac_cv_lib_lex" != 'none needed' && break
+    done
+    LIBS=$ac_save_LIBS
+
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_lex" >&5
+echo "${ECHO_T}$ac_cv_lib_lex" >&6; }
+  test "$ac_cv_lib_lex" != 'none needed' && LEXLIB=$ac_cv_lib_lex
+fi
+
+
+{ echo "$as_me:$LINENO: checking whether yytext is a pointer" >&5
+echo $ECHO_N "checking whether yytext is a pointer... $ECHO_C" >&6; }
+if test "${ac_cv_prog_lex_yytext_pointer+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  # POSIX says lex can declare yytext either as a pointer or an array; the
+# default is implementation-dependent.  Figure out which it is, since
+# not all implementations provide the %pointer and %array declarations.
+ac_cv_prog_lex_yytext_pointer=no
+ac_save_LIBS=$LIBS
+LIBS="$LEXLIB $ac_save_LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+#define YYTEXT_POINTER 1
+`cat $LEX_OUTPUT_ROOT.c`
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_prog_lex_yytext_pointer=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_save_LIBS
+
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_prog_lex_yytext_pointer" >&5
+echo "${ECHO_T}$ac_cv_prog_lex_yytext_pointer" >&6; }
+if test $ac_cv_prog_lex_yytext_pointer = yes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define YYTEXT_POINTER 1
+_ACEOF
+
+fi
+rm -f conftest.l $LEX_OUTPUT_ROOT.c
+
+fi
+for ac_prog in 'bison -y' byacc
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_prog_YACC+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -n "$YACC"; then
+  ac_cv_prog_YACC="$YACC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_YACC="$ac_prog"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+fi
+fi
+YACC=$ac_cv_prog_YACC
+if test -n "$YACC"; then
+  { echo "$as_me:$LINENO: result: $YACC" >&5
+echo "${ECHO_T}$YACC" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+  test -n "$YACC" && break
+done
+test -n "$YACC" || YACC="yacc"
+
 subdirs="$subdirs libltdl"
 
 
 #
 # Checks for header files.
 #
@@ -22827,13 +22867,13 @@
 
 fi
 
 done
 
 
-for ac_header in sys/poll.h
+for ac_header in poll.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
@@ -23527,36 +23567,35 @@
 
 fi
 
 done
 
 
-# For ping library
-
-for ac_header in netinet/in_systm.h
+for ac_header in kstat.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#if HAVE_STDINT_H
-# include <stdint.h>
-#endif
-#if HAVE_SYS_TYPES_H
-# include <sys/types.h>
-#endif
-
-
+$ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
 if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
@@ -23570,36 +23609,113 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  eval "$as_ac_Header=yes"
+  ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_Header=no"
+	ac_header_compiler=no
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
 fi
 ac_res=`eval echo '${'$as_ac_Header'}'`
 	       { echo "$as_me:$LINENO: result: $ac_res" >&5
 echo "${ECHO_T}$ac_res" >&6; }
+
+fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
 fi
 
 done
 
 
-for ac_header in netinet/in.h
+# For ping library
+
+for ac_header in netinet/in_systm.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -23613,15 +23729,12 @@
 #if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
-#if HAVE_NETINET_IN_SYSTM_H
-# include <netinet/in_systm.h>
-#endif
 
 
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
 if { (ac_try="$ac_compile"
@@ -23660,13 +23773,13 @@
 
 fi
 
 done
 
 
-for ac_header in netinet/ip.h
+for ac_header in netinet/in.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -23683,14 +23796,81 @@
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
 #if HAVE_NETINET_IN_SYSTM_H
 # include <netinet/in_systm.h>
 #endif
-#if HAVE_NETINET_IN_H
-# include <netinet/in.h>
+
+
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  eval "$as_ac_Header=yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	eval "$as_ac_Header=no"
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
+for ac_header in netinet/ip.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
 #endif
 
 
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
@@ -24019,12 +24199,85 @@
 
 fi
 
 done
 
 
+for ac_header in netinet/tcp.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP_H
+# include <netinet/ip.h>
+#endif
+
+
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  eval "$as_ac_Header=yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	eval "$as_ac_Header=no"
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
 for ac_header in netinet/udp.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
@@ -26757,12 +27010,152 @@
 
 fi
 
 done
 
 
+for ac_header in libgen.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
 # For the apple_sensors module
 
 for ac_header in CoreFoundation/CoreFoundation.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
@@ -28376,13 +28769,13 @@
 
 fi
 
 done
 
 
-# For traffic plugin
+# For interface plugin
 
 for ac_header in ifaddrs.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   { echo "$as_me:$LINENO: checking for $ac_header" >&5
@@ -28861,14 +29254,13 @@
 done
 
 
 # For quota module
 
 
-
-for ac_header in grp.h pwd.h sys/ucred.h
+for ac_header in pwd.h sys/ucred.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
@@ -32712,155 +33104,178 @@
 
 fi
 
 done
 
 
+# For the multimeter plugin
 
-{ echo "$as_me:$LINENO: checking for ext in -lm" >&5
-echo $ECHO_N "checking for ext in -lm... $ECHO_C" >&6; }
-if test "${ac_cv_lib_m_ext+set}" = set; then
+for ac_header in termios.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lm  $LIBS"
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char ext ();
-int
-main ()
-{
-return ext ();
-  ;
-  return 0;
-}
+$ac_includes_default
+#include <$ac_header>
 _ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
 esac
 eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_m_ext=yes
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_m_ext=no
+	ac_header_compiler=no
 fi
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_m_ext" >&5
-echo "${ECHO_T}$ac_cv_lib_m_ext" >&6; }
-if test $ac_cv_lib_m_ext = yes; then
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
-#define HAVE_LIBM 1
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
-  LIBS="-lm $LIBS"
-
 fi
 
+done
 
-#
-# Checks for typedefs, structures, and compiler characteristics.
-#
-{ echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
-echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6; }
-if test "${ac_cv_c_const+set}" = set; then
+
+for ac_header in sys/ioctl.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 else
-  cat >conftest.$ac_ext <<_ACEOF
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-
-int
-main ()
-{
-/* FIXME: Include the comments suggested by Paul. */
-#ifndef __cplusplus
-  /* Ultrix mips cc rejects this.  */
-  typedef int charset[2];
-  const charset cs;
-  /* SunOS 4.1.1 cc rejects this.  */
-  char const *const *pcpcc;
-  char **ppc;
-  /* NEC SVR4.0.2 mips cc rejects this.  */
-  struct point {int x, y;};
-  static struct point const zero = {0,0};
-  /* AIX XL C 1.02.0.0 rejects this.
-     It does not let you subtract one const X* pointer from another in
-     an arm of an if-expression whose if-part is not a constant
-     expression */
-  const char *g = "string";
-  pcpcc = &g + (g ? g-g : 0);
-  /* HPUX 7.0 cc rejects these. */
-  ++pcpcc;
-  ppc = (char**) pcpcc;
-  pcpcc = (char const *const *) ppc;
-  { /* SCO 3.2v4 cc rejects this.  */
-    char *t;
-    char const *s = 0 ? (char *) 0 : (char const *) 0;
-
-    *t++ = 0;
-    if (s) return 0;
-  }
-  { /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
-    int x[] = {25, 17};
-    const int *foo = &x[0];
-    ++foo;
-  }
-  { /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
-    typedef const int *iptr;
-    iptr p = 0;
-    ++p;
-  }
-  { /* AIX XL C 1.02.0.0 rejects this saying
-       "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
-    struct s { int j; const int *ap[3]; };
-    struct s *b; b->j = 5;
-  }
-  { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
-    const int foo = 10;
-    if (!foo) return 0;
-  }
-  return !cs[0] && !zero.x;
-#endif
-
-  ;
-  return 0;
-}
+$ac_includes_default
+#include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
 if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
@@ -32873,27 +33288,289 @@
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest.$ac_objext; then
-  ac_cv_c_const=yes
+  ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_c_const=no
+	ac_header_compiler=no
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
-echo "${ECHO_T}$ac_cv_c_const" >&6; }
-if test $ac_cv_c_const = no; then
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-cat >>confdefs.h <<\_ACEOF
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
+#
+# Checking for libraries
+#
+
+{ echo "$as_me:$LINENO: checking for ext in -lm" >&5
+echo $ECHO_N "checking for ext in -lm... $ECHO_C" >&6; }
+if test "${ac_cv_lib_m_ext+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lm  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char ext ();
+int
+main ()
+{
+return ext ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_m_ext=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_m_ext=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_m_ext" >&5
+echo "${ECHO_T}$ac_cv_lib_m_ext" >&6; }
+if test $ac_cv_lib_m_ext = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_LIBM 1
+_ACEOF
+
+  LIBS="-lm $LIBS"
+
+fi
+
+
+#
+# Checks for typedefs, structures, and compiler characteristics.
+#
+{ echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
+echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6; }
+if test "${ac_cv_c_const+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+int
+main ()
+{
+/* FIXME: Include the comments suggested by Paul. */
+#ifndef __cplusplus
+  /* Ultrix mips cc rejects this.  */
+  typedef int charset[2];
+  const charset cs;
+  /* SunOS 4.1.1 cc rejects this.  */
+  char const *const *pcpcc;
+  char **ppc;
+  /* NEC SVR4.0.2 mips cc rejects this.  */
+  struct point {int x, y;};
+  static struct point const zero = {0,0};
+  /* AIX XL C 1.02.0.0 rejects this.
+     It does not let you subtract one const X* pointer from another in
+     an arm of an if-expression whose if-part is not a constant
+     expression */
+  const char *g = "string";
+  pcpcc = &g + (g ? g-g : 0);
+  /* HPUX 7.0 cc rejects these. */
+  ++pcpcc;
+  ppc = (char**) pcpcc;
+  pcpcc = (char const *const *) ppc;
+  { /* SCO 3.2v4 cc rejects this.  */
+    char *t;
+    char const *s = 0 ? (char *) 0 : (char const *) 0;
+
+    *t++ = 0;
+    if (s) return 0;
+  }
+  { /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
+    int x[] = {25, 17};
+    const int *foo = &x[0];
+    ++foo;
+  }
+  { /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
+    typedef const int *iptr;
+    iptr p = 0;
+    ++p;
+  }
+  { /* AIX XL C 1.02.0.0 rejects this saying
+       "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
+    struct s { int j; const int *ap[3]; };
+    struct s *b; b->j = 5;
+  }
+  { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
+    const int foo = 10;
+    if (!foo) return 0;
+  }
+  return !cs[0] && !zero.x;
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_c_const=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_c_const=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
+echo "${ECHO_T}$ac_cv_c_const" >&6; }
+if test $ac_cv_c_const = no; then
+
+cat >>confdefs.h <<\_ACEOF
 #define const
 _ACEOF
 
 fi
 
 { echo "$as_me:$LINENO: checking for pid_t" >&5
@@ -34784,13 +35461,13 @@
 _ACEOF
 
 fi
 done
 
 
-# For traffic module
+# For interface module
 
 for ac_func in getifaddrs
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_func" >&5
 echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
@@ -34880,12 +35557,255 @@
 _ACEOF
 
 fi
 done
 
 
+# Check for NAN
+nan_type="none"
+if test "x$nan_type" = "xnone"; then
+  { echo "$as_me:$LINENO: checking whether NAN is defined by default" >&5
+echo $ECHO_N "checking whether NAN is defined by default... $ECHO_C" >&6; }
+if test "${have_nan_default+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <stdlib.h>
+#include <math.h>
+static float foo = NAN;
+
+int
+main ()
+{
+
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  have_nan_default="yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	have_nan_default="no"
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+fi
+{ echo "$as_me:$LINENO: result: $have_nan_default" >&5
+echo "${ECHO_T}$have_nan_default" >&6; }
+  if test "x$have_nan_default" = "xyes"
+  then
+   nan_type="default"
+
+cat >>confdefs.h <<\_ACEOF
+#define NAN_STATIC_DEFAULT 1
+_ACEOF
+
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  { echo "$as_me:$LINENO: checking whether NAN is defined by __USE_ISOC99" >&5
+echo $ECHO_N "checking whether NAN is defined by __USE_ISOC99... $ECHO_C" >&6; }
+if test "${have_nan_isoc+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <stdlib.h>
+#define __USE_ISOC99 1
+#include <math.h>
+static float foo = NAN;
+
+int
+main ()
+{
+
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  have_nan_isoc="yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	have_nan_isoc="no"
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+fi
+{ echo "$as_me:$LINENO: result: $have_nan_isoc" >&5
+echo "${ECHO_T}$have_nan_isoc" >&6; }
+  if test "x$have_nan_isoc" = "xyes"
+  then
+   nan_type="isoc99"
+
+cat >>confdefs.h <<\_ACEOF
+#define NAN_STATIC_ISOC 1
+_ACEOF
+
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  { echo "$as_me:$LINENO: checking whether NAN can be defined by 0/0" >&5
+echo $ECHO_N "checking whether NAN can be defined by 0/0... $ECHO_C" >&6; }
+if test "${have_nan_zero+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test "$cross_compiling" = yes; then
+  { { echo "$as_me:$LINENO: error: cannot run test program while cross compiling
+See \`config.log' for more details." >&5
+echo "$as_me: error: cannot run test program while cross compiling
+See \`config.log' for more details." >&2;}
+   { (exit 1); exit 1; }; }
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <stdlib.h>
+#include <math.h>
+#ifdef NAN
+# undef NAN
+#endif
+#define NAN (0.0 / 0.0)
+#ifndef isnan
+# define isnan(f) ((f) != (f))
+#endif
+static float foo = NAN;
+
+int
+main ()
+{
+
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  have_nan_zero="yes"
+else
+  echo "$as_me: program exited with status $ac_status" >&5
+echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+( exit $ac_status )
+have_nan_zero="no"
+
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+fi
+
+
+
+fi
+{ echo "$as_me:$LINENO: result: $have_nan_zero" >&5
+echo "${ECHO_T}$have_nan_zero" >&6; }
+  if test "x$have_nan_zero" = "xyes"
+  then
+   nan_type="zero"
+
+cat >>confdefs.h <<\_ACEOF
+#define NAN_ZERO_ZERO 1
+_ACEOF
+
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  { { echo "$as_me:$LINENO: error: Didn't find out how to statically initialize variables to NAN. Sorry." >&5
+echo "$as_me: error: Didn't find out how to statically initialize variables to NAN. Sorry." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+
 # For mount interface
 #AC_CHECK_FUNCS(getfsent getvfsent)
 
 have_getfsstat="no"
 
 for ac_func in getfsstat
@@ -36887,100 +37807,546 @@
 _ACEOF
 
 
 fi
 
 
-{ echo "$as_me:$LINENO: checking for kernel type ($host_os)" >&5
-echo $ECHO_N "checking for kernel type ($host_os)... $ECHO_C" >&6; }
-case $host_os in
-	*linux*)
-
-cat >>confdefs.h <<\_ACEOF
-#define KERNEL_LINUX 1
-_ACEOF
-
-	ac_system="Linux"
-	;;
-	*solaris*)
-
-cat >>confdefs.h <<\_ACEOF
-#define KERNEL_SOLARIS 1
-_ACEOF
-
-	ac_system="Solaris"
-	;;
-	*)
-	ac_system="unknown"
-esac
-{ echo "$as_me:$LINENO: result: $ac_system" >&5
-echo "${ECHO_T}$ac_system" >&6; }
-
-with_libresolv="yes"
-{ echo "$as_me:$LINENO: checking for res_search in -lresolv" >&5
-echo $ECHO_N "checking for res_search in -lresolv... $ECHO_C" >&6; }
-if test "${ac_cv_lib_resolv_res_search+set}" = set; then
+{ echo "$as_me:$LINENO: checking for kstat_io_t.nwritten" >&5
+echo $ECHO_N "checking for kstat_io_t.nwritten... $ECHO_C" >&6; }
+if test "${ac_cv_member_kstat_io_t_nwritten+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
+  cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
+#if HAVE_KSTAT_H
+# include <kstat.h>
 #endif
-char res_search ();
+
+
 int
 main ()
 {
-return res_search ();
+static kstat_io_t ac_aggr;
+if (ac_aggr.nwritten)
+return 0;
   ;
   return 0;
 }
 _ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
 esac
 eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+  (eval "$ac_compile") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_resolv_res_search=yes
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_nwritten=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_resolv_res_search=no
-fi
+	cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_resolv_res_search" >&5
-echo "${ECHO_T}$ac_cv_lib_resolv_res_search" >&6; }
-if test $ac_cv_lib_resolv_res_search = yes; then
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (sizeof ac_aggr.nwritten)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_nwritten=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_member_kstat_io_t_nwritten=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_member_kstat_io_t_nwritten" >&5
+echo "${ECHO_T}$ac_cv_member_kstat_io_t_nwritten" >&6; }
+if test $ac_cv_member_kstat_io_t_nwritten = yes; then
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_KSTAT_IO_T_NWRITTEN 1
+_ACEOF
+
+
+fi
+{ echo "$as_me:$LINENO: checking for kstat_io_t.writes" >&5
+echo $ECHO_N "checking for kstat_io_t.writes... $ECHO_C" >&6; }
+if test "${ac_cv_member_kstat_io_t_writes+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (ac_aggr.writes)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_writes=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (sizeof ac_aggr.writes)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_writes=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_member_kstat_io_t_writes=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_member_kstat_io_t_writes" >&5
+echo "${ECHO_T}$ac_cv_member_kstat_io_t_writes" >&6; }
+if test $ac_cv_member_kstat_io_t_writes = yes; then
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_KSTAT_IO_T_WRITES 1
+_ACEOF
+
+
+fi
+{ echo "$as_me:$LINENO: checking for kstat_io_t.nwrites" >&5
+echo $ECHO_N "checking for kstat_io_t.nwrites... $ECHO_C" >&6; }
+if test "${ac_cv_member_kstat_io_t_nwrites+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (ac_aggr.nwrites)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_nwrites=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (sizeof ac_aggr.nwrites)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_nwrites=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_member_kstat_io_t_nwrites=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_member_kstat_io_t_nwrites" >&5
+echo "${ECHO_T}$ac_cv_member_kstat_io_t_nwrites" >&6; }
+if test $ac_cv_member_kstat_io_t_nwrites = yes; then
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_KSTAT_IO_T_NWRITES 1
+_ACEOF
+
+
+fi
+{ echo "$as_me:$LINENO: checking for kstat_io_t.wtime" >&5
+echo $ECHO_N "checking for kstat_io_t.wtime... $ECHO_C" >&6; }
+if test "${ac_cv_member_kstat_io_t_wtime+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (ac_aggr.wtime)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_wtime=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+
+
+int
+main ()
+{
+static kstat_io_t ac_aggr;
+if (sizeof ac_aggr.wtime)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_member_kstat_io_t_wtime=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_member_kstat_io_t_wtime=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_member_kstat_io_t_wtime" >&5
+echo "${ECHO_T}$ac_cv_member_kstat_io_t_wtime" >&6; }
+if test $ac_cv_member_kstat_io_t_wtime = yes; then
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_KSTAT_IO_T_WTIME 1
+_ACEOF
+
+
+fi
+
+
+{ echo "$as_me:$LINENO: checking for kernel type ($host_os)" >&5
+echo $ECHO_N "checking for kernel type ($host_os)... $ECHO_C" >&6; }
+case $host_os in
+	*linux*)
+
+cat >>confdefs.h <<\_ACEOF
+#define KERNEL_LINUX 1
+_ACEOF
+
+	ac_system="Linux"
+	;;
+	*solaris*)
+
+cat >>confdefs.h <<\_ACEOF
+#define KERNEL_SOLARIS 1
+_ACEOF
+
+	ac_system="Solaris"
+	;;
+	*)
+	ac_system="unknown"
+esac
+{ echo "$as_me:$LINENO: result: $ac_system" >&5
+echo "${ECHO_T}$ac_system" >&6; }
+
+with_libresolv="yes"
+{ echo "$as_me:$LINENO: checking for res_search in -lresolv" >&5
+echo $ECHO_N "checking for res_search in -lresolv... $ECHO_C" >&6; }
+if test "${ac_cv_lib_resolv_res_search+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lresolv  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char res_search ();
+int
+main ()
+{
+return res_search ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_resolv_res_search=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_resolv_res_search=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_resolv_res_search" >&5
+echo "${ECHO_T}$ac_cv_lib_resolv_res_search" >&6; }
+if test $ac_cv_lib_resolv_res_search = yes; then
 
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_LIBRESOLV 1
 _ACEOF
 
@@ -39039,12 +40405,139 @@
 else
   BUILD_WITH_LIBMYSQL_TRUE='#'
   BUILD_WITH_LIBMYSQL_FALSE=
 fi
 
 
+with_own_liboconfig="no"
+liboconfig_LDFLAGS="$LDFLAGS"
+liboconfig_CPPFLAGS="$CPPFLAGS"
+
+# Check whether --with-liboconfig was given.
+if test "${with_liboconfig+set}" = set; then
+  withval=$with_liboconfig;
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		if test -d "$withval/lib"
+		then
+			liboconfig_LDFLAGS="$LDFLAGS -L$withval/lib"
+		fi
+		if test -d "$withval/include"
+		then
+			liboconfig_CPPFLAGS="$CPPFLAGS -I$withval/include"
+		fi
+	fi
+	if test "x$withval" = "xno"
+	then
+		{ { echo "$as_me:$LINENO: error: \"liboconfig is required\"" >&5
+echo "$as_me: error: \"liboconfig is required\"" >&2;}
+   { (exit 1); exit 1; }; }
+	fi
+
+else
+
+	with_liboconfig="yes"
+
+fi
+
+
+save_LDFLAGS="$LDFLAGS"
+save_CPPFLAGS="$CPPFLAGS"
+LDFLAGS="$liboconfig_LDFLAGS"
+CPPFLAGS="$liboconfig_CPPFLAGS"
+{ echo "$as_me:$LINENO: checking for oconfig_parse_fh in -loconfig" >&5
+echo $ECHO_N "checking for oconfig_parse_fh in -loconfig... $ECHO_C" >&6; }
+if test "${ac_cv_lib_oconfig_oconfig_parse_fh+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-loconfig  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char oconfig_parse_fh ();
+int
+main ()
+{
+return oconfig_parse_fh ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_oconfig_oconfig_parse_fh=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_oconfig_oconfig_parse_fh=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_oconfig_oconfig_parse_fh" >&5
+echo "${ECHO_T}$ac_cv_lib_oconfig_oconfig_parse_fh" >&6; }
+if test $ac_cv_lib_oconfig_oconfig_parse_fh = yes; then
+
+	with_liboconfig="yes"
+	with_own_liboconfig="no"
+
+else
+
+	with_liboconfig="yes"
+	with_own_liboconfig="yes"
+	LDFLAGS="$save_LDFLAGS"
+	CPPFLAGS="$save_CPPFLAGS"
+
+fi
+
+
+
+
+if test "x$with_own_liboconfig" = "xyes"; then
+  BUILD_WITH_OWN_LIBOCONFIG_TRUE=
+  BUILD_WITH_OWN_LIBOCONFIG_FALSE='#'
+else
+  BUILD_WITH_OWN_LIBOCONFIG_TRUE='#'
+  BUILD_WITH_OWN_LIBOCONFIG_FALSE=
+fi
+
+if test "x$with_own_liboconfig" = "xyes"
+then
+	with_liboconfig="yes (shipped version)"
+fi
+
 #with_liboping="yes"
 with_own_liboping="no"
 liboping_LDFLAGS="$LDFLAGS"
 liboping_CPPFLAGS="$CPPFLAGS"
 
 # Check whether --with-liboping was given.
@@ -39066,151 +40559,801 @@
 		with_liboping="no"
 		with_own_liboping="no"
 	fi
 
 else
 
- 	#753
-	with_liboping="yes"
-
+ 	#753
+	with_liboping="yes"
+
+fi
+
+
+if test "x$with_liboping" = "xyes"
+then
+	save_LDFLAGS="$LDFLAGS"
+	save_CPPFLAGS="$CPPFLAGS"
+	LDFLAGS="$liboping_LDFLAGS"
+	CPPFLAGS="$liboping_CPPFLAGS"
+	{ echo "$as_me:$LINENO: checking for ping_construct in -loping" >&5
+echo $ECHO_N "checking for ping_construct in -loping... $ECHO_C" >&6; }
+if test "${ac_cv_lib_oping_ping_construct+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-loping  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char ping_construct ();
+int
+main ()
+{
+return ping_construct ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_oping_ping_construct=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_oping_ping_construct=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_oping_ping_construct" >&5
+echo "${ECHO_T}$ac_cv_lib_oping_ping_construct" >&6; }
+if test $ac_cv_lib_oping_ping_construct = yes; then
+
+		with_liboping="yes"
+		with_own_liboping="no"
+
+else
+
+		with_liboping="yes"
+		with_own_liboping="yes"
+		LDFLAGS="$save_LDFLAGS"
+		CPPFLAGS="$save_CPPFLAGS"
+
+fi
+
+fi
+
+
+if test "x$with_liboping" = "xyes"; then
+  BUILD_WITH_LIBOPING_TRUE=
+  BUILD_WITH_LIBOPING_FALSE='#'
+else
+  BUILD_WITH_LIBOPING_TRUE='#'
+  BUILD_WITH_LIBOPING_FALSE=
+fi
+
+
+
+if test "x$with_own_liboping" = "xyes"; then
+  BUILD_WITH_OWN_LIBOPING_TRUE=
+  BUILD_WITH_OWN_LIBOPING_FALSE='#'
+else
+  BUILD_WITH_OWN_LIBOPING_TRUE='#'
+  BUILD_WITH_OWN_LIBOPING_FALSE=
+fi
+
+if test "x$with_liboping" = "xyes" -a "x$with_own_liboping" = "xyes"
+then
+	with_liboping="yes (shipped version)"
+fi
+
+
+# Check whether --with-libpcap was given.
+if test "${with_libpcap+set}" = set; then
+  withval=$with_libpcap;
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		with_libpcap="yes"
+	fi
+
+else
+
+	with_libpcap="yes"
+
+fi
+
+if test "x$with_libpcap" = "xyes"
+then
+	{ echo "$as_me:$LINENO: checking for pcap_open_live in -lpcap" >&5
+echo $ECHO_N "checking for pcap_open_live in -lpcap... $ECHO_C" >&6; }
+if test "${ac_cv_lib_pcap_pcap_open_live+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-lpcap  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char pcap_open_live ();
+int
+main ()
+{
+return pcap_open_live ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_pcap_pcap_open_live=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_pcap_pcap_open_live=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_pcap_pcap_open_live" >&5
+echo "${ECHO_T}$ac_cv_lib_pcap_pcap_open_live" >&6; }
+if test $ac_cv_lib_pcap_pcap_open_live = yes; then
+
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_LIBPCAP 1
+_ACEOF
+
+
+else
+  with_libpcap="no (libpcap not found)"
+fi
+
+fi
+if test "x$with_libpcap" = "xyes"
+then
+
+for ac_header in pcap.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_PCAP_H 1
+_ACEOF
+
+
+else
+  with_libpcap="no (pcap.h not found)"
+fi
+
+done
+
+fi
+if test "x$with_libpcap" = "xyes"
+then
+	collect_libpcap=1
+else
+	collect_libpcap=0
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_LIBPCAP $collect_libpcap
+_ACEOF
+
+
+
+if test "x$with_libpcap" = "xyes"; then
+  BUILD_WITH_LIBPCAP_TRUE=
+  BUILD_WITH_LIBPCAP_FALSE='#'
+else
+  BUILD_WITH_LIBPCAP_TRUE='#'
+  BUILD_WITH_LIBPCAP_FALSE=
+fi
+
+
+perl_interpreter="perl"
+
+# Check whether --with-libperl was given.
+if test "${with_libperl+set}" = set; then
+  withval=$with_libperl;
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		perl_interpreter="$withval/bin/perl"
+		with_libperl="yes"
+	fi
+
+else
+
+	with_libperl="yes"
+
+fi
+
+if test "x$with_libperl" = "xyes"
+then
+  SAVE_CFLAGS=$CFLAGS
+  SAVE_LDFLAGS=$LDFLAGS
+  PERL_CFLAGS=`$perl_interpreter -MExtUtils::Embed -e ccopts`
+  PERL_LDFLAGS=`$perl_interpreter -MExtUtils::Embed -e ldopts`
+  CFLAGS="$CFLAGS $PERL_CFLAGS"
+  LDFLAGS="$LDFLAGS $PERL_LDFLAGS"
+
+  { echo "$as_me:$LINENO: checking for libperl" >&5
+echo $ECHO_N "checking for libperl... $ECHO_C" >&6; }
+if test "${have_libperl+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <EXTERN.h>
+#include <perl.h>
+#include <XSUB.h>
+
+int
+main ()
+{
+
+       PerlInterpreter *perl = NULL;
+       Perl_load_module (perl, PERL_LOADMOD_NOIMPORT,
+			 newSVpv ("Collectd::Plugin::FooBar", 24),
+			 Nullsv);
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  have_libperl="yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	have_libperl="no"
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+
+fi
+{ echo "$as_me:$LINENO: result: $have_libperl" >&5
+echo "${ECHO_T}$have_libperl" >&6; }
+
+  if test "x$have_libperl" = "xyes"
+  then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_LIBPERL 1
+_ACEOF
+
+
+
+  else
+	  with_libperl="no"
+  fi
+
+  CFLAGS=$SAVE_CFLAGS
+  LDFLAGS=$SAVE_LDFLAGS
+fi
+
+
+if test "x$with_libperl" = "xyes"; then
+  BUILD_WITH_LIBPERL_TRUE=
+  BUILD_WITH_LIBPERL_FALSE='#'
+else
+  BUILD_WITH_LIBPERL_TRUE='#'
+  BUILD_WITH_LIBPERL_FALSE=
+fi
+
+
+
+# Check whether --with-libiptc was given.
+if test "${with_libiptc+set}" = set; then
+  withval=$with_libiptc;
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		with_libiptc="yes"
+	fi
+
+else
+
+ 	if test "x$ac_system" = "xLinux"
+	then
+		with_libiptc="yes"
+	else
+		with_libiptc="no (Linux only)"
+	fi
+
+fi
+
+if test "x$with_libiptc" = "xyes"
+then
+	{ echo "$as_me:$LINENO: checking for iptc_init in -liptc" >&5
+echo $ECHO_N "checking for iptc_init in -liptc... $ECHO_C" >&6; }
+if test "${ac_cv_lib_iptc_iptc_init+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS="-liptc  $LIBS"
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char iptc_init ();
+int
+main ()
+{
+return iptc_init ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  ac_cv_lib_iptc_iptc_init=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_lib_iptc_iptc_init=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_iptc_iptc_init" >&5
+echo "${ECHO_T}$ac_cv_lib_iptc_iptc_init" >&6; }
+if test $ac_cv_lib_iptc_iptc_init = yes; then
+
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_LIBIPTC 1
+_ACEOF
+
+
+else
+  with_libiptc="no (libiptc not found)"
+fi
+
+fi
+if test "x$with_libiptc" = "xyes"
+then
+
+for ac_header in libiptc/libiptc.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
 fi
 
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
 
-if test "x$with_liboping" = "xyes"
-then
-	save_LDFLAGS="$LDFLAGS"
-	save_CPPFLAGS="$CPPFLAGS"
-	LDFLAGS="$liboping_LDFLAGS"
-	CPPFLAGS="$liboping_CPPFLAGS"
-	{ echo "$as_me:$LINENO: checking for ping_construct in -loping" >&5
-echo $ECHO_N "checking for ping_construct in -loping... $ECHO_C" >&6; }
-if test "${ac_cv_lib_oping_ping_construct+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-loping  $LIBS"
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char ping_construct ();
-int
-main ()
-{
-return ping_construct ();
-  ;
-  return 0;
-}
+#include <$ac_header>
 _ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
+if { (ac_try="$ac_cpp conftest.$ac_ext"
 case "(($ac_try" in
   *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
   *) ac_try_echo=$ac_try;;
 esac
 eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
 	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_oping_ping_construct=yes
+       }; then
+  ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_oping_ping_construct=no
+  ac_header_preproc=no
 fi
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_oping_ping_construct" >&5
-echo "${ECHO_T}$ac_cv_lib_oping_ping_construct" >&6; }
-if test $ac_cv_lib_oping_ping_construct = yes; then
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
 
-		with_liboping="yes"
-		with_own_liboping="no"
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
 
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-
-		with_liboping="yes"
-		with_own_liboping="yes"
-		LDFLAGS="$save_LDFLAGS"
-		CPPFLAGS="$save_CPPFLAGS"
-
+  eval "$as_ac_Header=\$ac_header_preproc"
 fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
 
 fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_LIBIPTC_LIBIPTC_H 1
+_ACEOF
 
 
-if test "x$with_liboping" = "xyes"; then
-  BUILD_WITH_LIBOPING_TRUE=
-  BUILD_WITH_LIBOPING_FALSE='#'
 else
-  BUILD_WITH_LIBOPING_TRUE='#'
-  BUILD_WITH_LIBOPING_FALSE=
+  with_libiptc="no (libiptc/libiptc.h not found)"
 fi
 
+done
 
-
-if test "x$with_own_liboping" = "xyes"; then
-  BUILD_WITH_OWN_LIBOPING_TRUE=
-  BUILD_WITH_OWN_LIBOPING_FALSE='#'
+fi
+if test "x$with_libiptc" = "xyes"
+then
+	collect_libiptc=1
 else
-  BUILD_WITH_OWN_LIBOPING_TRUE='#'
-  BUILD_WITH_OWN_LIBOPING_FALSE=
+	collect_libiptc=0
 fi
 
-if test "x$with_liboping" = "xyes" -a "x$with_own_liboping" = "xyes"
-then
-	with_liboping="yes (shipped version)"
+
+if test "x$with_libiptc" = "xyes"; then
+  BUILD_WITH_LIBIPTC_TRUE=
+  BUILD_WITH_LIBIPTC_FALSE='#'
+else
+  BUILD_WITH_LIBIPTC_TRUE='#'
+  BUILD_WITH_LIBIPTC_FALSE=
 fi
 
 
-# Check whether --with-libpcap was given.
-if test "${with_libpcap+set}" = set; then
-  withval=$with_libpcap;
+
+# Check whether --with-libupsclient was given.
+if test "${with_libupsclient+set}" = set; then
+  withval=$with_libupsclient;
 	if test "x$withval" != "xno" && test "x$withval" != "xyes"
 	then
 		LDFLAGS="$LDFLAGS -L$withval/lib"
 		CPPFLAGS="$CPPFLAGS -I$withval/include"
-		with_libpcap="yes"
+		with_libupsclient="yes"
 	fi
 
 else
 
-	with_libpcap="yes"
+	with_libupsclient="yes"
 
 fi
 
-if test "x$with_libpcap" = "xyes"
+if test "x$with_libupsclient" = "xyes"
 then
-	{ echo "$as_me:$LINENO: checking for pcap_open_live in -lpcap" >&5
-echo $ECHO_N "checking for pcap_open_live in -lpcap... $ECHO_C" >&6; }
-if test "${ac_cv_lib_pcap_pcap_open_live+set}" = set; then
+	{ echo "$as_me:$LINENO: checking for upscli_connect in -lupsclient" >&5
+echo $ECHO_N "checking for upscli_connect in -lupsclient... $ECHO_C" >&6; }
+if test "${ac_cv_lib_upsclient_upscli_connect+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpcap  $LIBS"
+LIBS="-lupsclient  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
@@ -39218,17 +41361,17 @@
 /* Override any GCC internal prototype to avoid an error.
    Use char because int might match the return type of a GCC
    builtin and then its argument prototype would still apply.  */
 #ifdef __cplusplus
 extern "C"
 #endif
-char pcap_open_live ();
+char upscli_connect ();
 int
 main ()
 {
-return pcap_open_live ();
+return upscli_connect ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
 if { (ac_try="$ac_link"
@@ -39245,43 +41388,43 @@
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && {
 	 test -z "$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        } && test -s conftest$ac_exeext &&
        $as_test_x conftest$ac_exeext; then
-  ac_cv_lib_pcap_pcap_open_live=yes
+  ac_cv_lib_upsclient_upscli_connect=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_pcap_pcap_open_live=no
+	ac_cv_lib_upsclient_upscli_connect=no
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_pcap_pcap_open_live" >&5
-echo "${ECHO_T}$ac_cv_lib_pcap_pcap_open_live" >&6; }
-if test $ac_cv_lib_pcap_pcap_open_live = yes; then
+{ echo "$as_me:$LINENO: result: $ac_cv_lib_upsclient_upscli_connect" >&5
+echo "${ECHO_T}$ac_cv_lib_upsclient_upscli_connect" >&6; }
+if test $ac_cv_lib_upsclient_upscli_connect = yes; then
 
 
 cat >>confdefs.h <<\_ACEOF
-#define HAVE_LIBPCAP 1
+#define HAVE_LIBUPSCLIENT 1
 _ACEOF
 
 
 else
-  with_libpcap="no (libpcap not found)"
+  with_libupsclient="no (libupsclient not found)"
 fi
 
 fi
-if test "x$with_libpcap" = "xyes"
+if test "x$with_libupsclient" = "xyes"
 then
 
-for ac_header in pcap.h
+for ac_header in upsclient.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
@@ -39412,96 +41555,33 @@
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
 
 cat >>confdefs.h <<\_ACEOF
-#define HAVE_PCAP_H 1
+#define HAVE_UPSCLIENT_H 1
 _ACEOF
 
 
 else
-  with_libpcap="no (pcap.h not found)"
+  with_libupsclient="no (upsclient.h not found)"
 fi
 
 done
 
 fi
-if test "x$with_libpcap" = "xyes"
-then
-	collect_libpcap=1
-else
-	collect_libpcap=0
-fi
-
-cat >>confdefs.h <<_ACEOF
-#define COLLECT_LIBPCAP $collect_libpcap
-_ACEOF
-
 
 
-if test "x$with_libpcap" = "xyes"; then
-  BUILD_WITH_LIBPCAP_TRUE=
-  BUILD_WITH_LIBPCAP_FALSE='#'
+if test "x$with_libupsclient" = "xyes"; then
+  BUILD_WITH_LIBUPSCLIENT_TRUE=
+  BUILD_WITH_LIBUPSCLIENT_FALSE='#'
 else
-  BUILD_WITH_LIBPCAP_TRUE='#'
-  BUILD_WITH_LIBPCAP_FALSE=
-fi
-
-
-# Define `step' and `hearbeat' values..
-declare -i collectd_step=10
-declare -i collectd_heartbeat=25
-
-# Check whether --with-step was given.
-if test "${with_step+set}" = set; then
-  withval=$with_step;
-	if test "x$withval" != "xno" -a "x$withval" != "xyes"
-	then
-		declare -i tmp_collectd_step="$withval"
-		if test $tmp_collectd_step -gt 0
-		then
-			collectd_step=$tmp_collectd_step
-			let "collectd_heartbeat=$collectd_step*2"
-		fi
-	fi
-
-fi
-
-
-# Check whether --with-heartbeat was given.
-if test "${with_heartbeat+set}" = set; then
-  withval=$with_heartbeat;
-	if test "x$withval" != "xno" -a "x$withval" != "xyes"
-	then
-		declare -i tmp_collectd_heartbeat="$withval"
-		if test $tmp_collectd_heartbeat -gt 0
-		then
-			collectd_heartbeat=$tmp_collectd_heartbeat
-		fi
-	fi
-
-fi
-
-
-if test $collectd_step -ne 10
-then
-
-cat >>confdefs.h <<_ACEOF
-#define COLLECTD_STEP "$collectd_step"
-_ACEOF
-
+  BUILD_WITH_LIBUPSCLIENT_TRUE='#'
+  BUILD_WITH_LIBUPSCLIENT_FALSE=
 fi
-if test $collectd_heartbeat -ne 25
-then
-
-cat >>confdefs.h <<_ACEOF
-#define COLLECTD_HEARTBEAT "$collectd_heartbeat"
-_ACEOF
 
-fi
 
 # Check for enabled/disabled features
 #
 
 # AC_COLLECTD(name, enable/disable, info-text, feature/module)
 # ------------------------------------------------------------
@@ -39879,12 +41959,49 @@
 else
   BUILD_MODULE_DISK_TRUE='#'
   BUILD_MODULE_DISK_FALSE=
 fi
 
 
+																	# Check whether --enable-csv was given.
+if test "${enable_csv+set}" = set; then
+  enableval=$enable_csv;
+else
+  enable_csv='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_csv" = "xno"
+then
+	collectd_csv=0
+else
+	if test "x$enable_csv" = "xyes"
+	then
+		collectd_csv=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-csv or --disable-csv; enabling csv." >&5
+echo "$as_me: please specify either --enable-csv or --disable-csv; enabling csv." >&6;}
+		collectd_csv=1
+		enable_csv='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_CSV $collectd_csv
+_ACEOF
+
+
+
+if test "x$enable_csv" = "xyes"; then
+  BUILD_MODULE_CSV_TRUE=
+  BUILD_MODULE_CSV_FALSE='#'
+else
+  BUILD_MODULE_CSV_TRUE='#'
+  BUILD_MODULE_CSV_FALSE=
+fi
+
+
 																	# Check whether --enable-df was given.
 if test "${enable_df+set}" = set; then
   enableval=$enable_df;
 else
   enable_df='yes'
 fi
@@ -39990,46 +42107,83 @@
 else
   BUILD_MODULE_EMAIL_TRUE='#'
   BUILD_MODULE_EMAIL_FALSE=
 fi
 
 
-											# Check whether --enable-quota was given.
-if test "${enable_quota+set}" = set; then
-  enableval=$enable_quota;
+																	# Check whether --enable-entropy was given.
+if test "${enable_entropy+set}" = set; then
+  enableval=$enable_entropy;
+else
+  enable_entropy='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_entropy" = "xno"
+then
+	collectd_entropy=0
+else
+	if test "x$enable_entropy" = "xyes"
+	then
+		collectd_entropy=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-entropy or --disable-entropy; enabling entropy." >&5
+echo "$as_me: please specify either --enable-entropy or --disable-entropy; enabling entropy." >&6;}
+		collectd_entropy=1
+		enable_entropy='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_ENTROPY $collectd_entropy
+_ACEOF
+
+
+
+if test "x$enable_entropy" = "xyes"; then
+  BUILD_MODULE_ENTROPY_TRUE=
+  BUILD_MODULE_ENTROPY_FALSE='#'
+else
+  BUILD_MODULE_ENTROPY_TRUE='#'
+  BUILD_MODULE_ENTROPY_FALSE=
+fi
+
+
+																	# Check whether --enable-exec was given.
+if test "${enable_exec+set}" = set; then
+  enableval=$enable_exec;
 else
-  enable_quota='no'
+  enable_exec='yes'
 fi
 # AC_ARG_ENABLE
-if test "x$enable_quota" = "xno"
+if test "x$enable_exec" = "xno"
 then
-	collectd_quota=0
+	collectd_exec=0
 else
-	if test "x$enable_quota" = "xyes"
+	if test "x$enable_exec" = "xyes"
 	then
-		collectd_quota=1
+		collectd_exec=1
 	else
-		{ echo "$as_me:$LINENO: please specify either --enable-quota or --disable-quota; enabling quota." >&5
-echo "$as_me: please specify either --enable-quota or --disable-quota; enabling quota." >&6;}
-		collectd_quota=1
-		enable_quota='yes'
+		{ echo "$as_me:$LINENO: please specify either --enable-exec or --disable-exec; enabling exec." >&5
+echo "$as_me: please specify either --enable-exec or --disable-exec; enabling exec." >&6;}
+		collectd_exec=1
+		enable_exec='yes'
 	fi
 fi
 
 cat >>confdefs.h <<_ACEOF
-#define COLLECT_QUOTA $collectd_quota
+#define COLLECT_EXEC $collectd_exec
 _ACEOF
 
 
 
-if test "x$enable_quota" = "xyes"; then
-  BUILD_MODULE_QUOTA_TRUE=
-  BUILD_MODULE_QUOTA_FALSE='#'
+if test "x$enable_exec" = "xyes"; then
+  BUILD_MODULE_EXEC_TRUE=
+  BUILD_MODULE_EXEC_FALSE='#'
 else
-  BUILD_MODULE_QUOTA_TRUE='#'
-  BUILD_MODULE_QUOTA_FALSE=
+  BUILD_MODULE_EXEC_TRUE='#'
+  BUILD_MODULE_EXEC_FALSE=
 fi
 
 
 																	# Check whether --enable-hddtemp was given.
 if test "${enable_hddtemp+set}" = set; then
   enableval=$enable_hddtemp;
@@ -40064,12 +42218,123 @@
 else
   BUILD_MODULE_HDDTEMP_TRUE='#'
   BUILD_MODULE_HDDTEMP_FALSE=
 fi
 
 
+																	# Check whether --enable-interface was given.
+if test "${enable_interface+set}" = set; then
+  enableval=$enable_interface;
+else
+  enable_interface='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_interface" = "xno"
+then
+	collectd_interface=0
+else
+	if test "x$enable_interface" = "xyes"
+	then
+		collectd_interface=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-interface or --disable-interface; enabling interface." >&5
+echo "$as_me: please specify either --enable-interface or --disable-interface; enabling interface." >&6;}
+		collectd_interface=1
+		enable_interface='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_INTERFACE $collectd_interface
+_ACEOF
+
+
+
+if test "x$enable_interface" = "xyes"; then
+  BUILD_MODULE_INTERFACE_TRUE=
+  BUILD_MODULE_INTERFACE_FALSE='#'
+else
+  BUILD_MODULE_INTERFACE_TRUE='#'
+  BUILD_MODULE_INTERFACE_FALSE=
+fi
+
+
+																	# Check whether --enable-iptables was given.
+if test "${enable_iptables+set}" = set; then
+  enableval=$enable_iptables;
+else
+  enable_iptables='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_iptables" = "xno"
+then
+	collectd_iptables=0
+else
+	if test "x$enable_iptables" = "xyes"
+	then
+		collectd_iptables=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-iptables or --disable-iptables; enabling iptables." >&5
+echo "$as_me: please specify either --enable-iptables or --disable-iptables; enabling iptables." >&6;}
+		collectd_iptables=1
+		enable_iptables='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_IPTABLES $collectd_iptables
+_ACEOF
+
+
+
+if test "x$enable_iptables" = "xyes"; then
+  BUILD_MODULE_IPTABLES_TRUE=
+  BUILD_MODULE_IPTABLES_FALSE='#'
+else
+  BUILD_MODULE_IPTABLES_TRUE='#'
+  BUILD_MODULE_IPTABLES_FALSE=
+fi
+
+
+																	# Check whether --enable-irq was given.
+if test "${enable_irq+set}" = set; then
+  enableval=$enable_irq;
+else
+  enable_irq='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_irq" = "xno"
+then
+	collectd_irq=0
+else
+	if test "x$enable_irq" = "xyes"
+	then
+		collectd_irq=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-irq or --disable-irq; enabling irq." >&5
+echo "$as_me: please specify either --enable-irq or --disable-irq; enabling irq." >&6;}
+		collectd_irq=1
+		enable_irq='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_IRQ $collectd_irq
+_ACEOF
+
+
+
+if test "x$enable_irq" = "xyes"; then
+  BUILD_MODULE_IRQ_TRUE=
+  BUILD_MODULE_IRQ_FALSE='#'
+else
+  BUILD_MODULE_IRQ_TRUE='#'
+  BUILD_MODULE_IRQ_FALSE=
+fi
+
+
 																	# Check whether --enable-load was given.
 if test "${enable_load+set}" = set; then
   enableval=$enable_load;
 else
   enable_load='yes'
 fi
@@ -40249,12 +42514,49 @@
 else
   BUILD_MODULE_MYSQL_TRUE='#'
   BUILD_MODULE_MYSQL_FALSE=
 fi
 
 
+																	# Check whether --enable-network was given.
+if test "${enable_network+set}" = set; then
+  enableval=$enable_network;
+else
+  enable_network='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_network" = "xno"
+then
+	collectd_network=0
+else
+	if test "x$enable_network" = "xyes"
+	then
+		collectd_network=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-network or --disable-network; enabling network." >&5
+echo "$as_me: please specify either --enable-network or --disable-network; enabling network." >&6;}
+		collectd_network=1
+		enable_network='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_NETWORK $collectd_network
+_ACEOF
+
+
+
+if test "x$enable_network" = "xyes"; then
+  BUILD_MODULE_NETWORK_TRUE=
+  BUILD_MODULE_NETWORK_FALSE='#'
+else
+  BUILD_MODULE_NETWORK_TRUE='#'
+  BUILD_MODULE_NETWORK_FALSE=
+fi
+
+
 																	# Check whether --enable-nfs was given.
 if test "${enable_nfs+set}" = set; then
   enableval=$enable_nfs;
 else
   enable_nfs='yes'
 fi
@@ -40323,12 +42625,86 @@
 else
   BUILD_MODULE_NTPD_TRUE='#'
   BUILD_MODULE_NTPD_FALSE=
 fi
 
 
+																	# Check whether --enable-nut was given.
+if test "${enable_nut+set}" = set; then
+  enableval=$enable_nut;
+else
+  enable_nut='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_nut" = "xno"
+then
+	collectd_nut=0
+else
+	if test "x$enable_nut" = "xyes"
+	then
+		collectd_nut=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-nut or --disable-nut; enabling nut." >&5
+echo "$as_me: please specify either --enable-nut or --disable-nut; enabling nut." >&6;}
+		collectd_nut=1
+		enable_nut='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_NUT $collectd_nut
+_ACEOF
+
+
+
+if test "x$enable_nut" = "xyes"; then
+  BUILD_MODULE_NUT_TRUE=
+  BUILD_MODULE_NUT_FALSE='#'
+else
+  BUILD_MODULE_NUT_TRUE='#'
+  BUILD_MODULE_NUT_FALSE=
+fi
+
+
+																	# Check whether --enable-perl was given.
+if test "${enable_perl+set}" = set; then
+  enableval=$enable_perl;
+else
+  enable_perl='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_perl" = "xno"
+then
+	collectd_perl=0
+else
+	if test "x$enable_perl" = "xyes"
+	then
+		collectd_perl=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-perl or --disable-perl; enabling perl." >&5
+echo "$as_me: please specify either --enable-perl or --disable-perl; enabling perl." >&6;}
+		collectd_perl=1
+		enable_perl='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_PERL $collectd_perl
+_ACEOF
+
+
+
+if test "x$enable_perl" = "xyes"; then
+  BUILD_MODULE_PERL_TRUE=
+  BUILD_MODULE_PERL_FALSE='#'
+else
+  BUILD_MODULE_PERL_TRUE='#'
+  BUILD_MODULE_PERL_FALSE=
+fi
+
+
 																	# Check whether --enable-ping was given.
 if test "${enable_ping+set}" = set; then
   enableval=$enable_ping;
 else
   enable_ping='yes'
 fi
@@ -40471,12 +42847,49 @@
 else
   BUILD_MODULE_SERIAL_TRUE='#'
   BUILD_MODULE_SERIAL_FALSE=
 fi
 
 
+																	# Check whether --enable-logfile was given.
+if test "${enable_logfile+set}" = set; then
+  enableval=$enable_logfile;
+else
+  enable_logfile='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_logfile" = "xno"
+then
+	collectd_logfile=0
+else
+	if test "x$enable_logfile" = "xyes"
+	then
+		collectd_logfile=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-logfile or --disable-logfile; enabling logfile." >&5
+echo "$as_me: please specify either --enable-logfile or --disable-logfile; enabling logfile." >&6;}
+		collectd_logfile=1
+		enable_logfile='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_LOGFILE $collectd_logfile
+_ACEOF
+
+
+
+if test "x$enable_logfile" = "xyes"; then
+  BUILD_MODULE_LOGFILE_TRUE=
+  BUILD_MODULE_LOGFILE_FALSE='#'
+else
+  BUILD_MODULE_LOGFILE_TRUE='#'
+  BUILD_MODULE_LOGFILE_FALSE=
+fi
+
+
 																	# Check whether --enable-swap was given.
 if test "${enable_swap+set}" = set; then
   enableval=$enable_swap;
 else
   enable_swap='yes'
 fi
@@ -40508,12 +42921,49 @@
 else
   BUILD_MODULE_SWAP_TRUE='#'
   BUILD_MODULE_SWAP_FALSE=
 fi
 
 
+																	# Check whether --enable-syslog was given.
+if test "${enable_syslog+set}" = set; then
+  enableval=$enable_syslog;
+else
+  enable_syslog='yes'
+fi
+# AC_ARG_ENABLE
+if test "x$enable_syslog" = "xno"
+then
+	collectd_syslog=0
+else
+	if test "x$enable_syslog" = "xyes"
+	then
+		collectd_syslog=1
+	else
+		{ echo "$as_me:$LINENO: please specify either --enable-syslog or --disable-syslog; enabling syslog." >&5
+echo "$as_me: please specify either --enable-syslog or --disable-syslog; enabling syslog." >&6;}
+		collectd_syslog=1
+		enable_syslog='yes'
+	fi
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define COLLECT_SYSLOG $collectd_syslog
+_ACEOF
+
+
+
+if test "x$enable_syslog" = "xyes"; then
+  BUILD_MODULE_SYSLOG_TRUE=
+  BUILD_MODULE_SYSLOG_FALSE='#'
+else
+  BUILD_MODULE_SYSLOG_TRUE='#'
+  BUILD_MODULE_SYSLOG_FALSE=
+fi
+
+
 																	# Check whether --enable-tape was given.
 if test "${enable_tape+set}" = set; then
   enableval=$enable_tape;
 else
   enable_tape='yes'
 fi
@@ -40545,46 +42995,46 @@
 else
   BUILD_MODULE_TAPE_TRUE='#'
   BUILD_MODULE_TAPE_FALSE=
 fi
 
 
-																	# Check whether --enable-traffic was given.
-if test "${enable_traffic+set}" = set; then
-  enableval=$enable_traffic;
+																	# Check whether --enable-unixsock was given.
+if test "${enable_unixsock+set}" = set; then
+  enableval=$enable_unixsock;
 else
-  enable_traffic='yes'
+  enable_unixsock='yes'
 fi
 # AC_ARG_ENABLE
-if test "x$enable_traffic" = "xno"
+if test "x$enable_unixsock" = "xno"
 then
-	collectd_traffic=0
+	collectd_unixsock=0
 else
-	if test "x$enable_traffic" = "xyes"
+	if test "x$enable_unixsock" = "xyes"
 	then
-		collectd_traffic=1
+		collectd_unixsock=1
 	else
-		{ echo "$as_me:$LINENO: please specify either --enable-traffic or --disable-traffic; enabling traffic." >&5
-echo "$as_me: please specify either --enable-traffic or --disable-traffic; enabling traffic." >&6;}
-		collectd_traffic=1
-		enable_traffic='yes'
+		{ echo "$as_me:$LINENO: please specify either --enable-unixsock or --disable-unixsock; enabling unixsock." >&5
+echo "$as_me: please specify either --enable-unixsock or --disable-unixsock; enabling unixsock." >&6;}
+		collectd_unixsock=1
+		enable_unixsock='yes'
 	fi
 fi
 
 cat >>confdefs.h <<_ACEOF
-#define COLLECT_TRAFFIC $collectd_traffic
+#define COLLECT_UNIXSOCK $collectd_unixsock
 _ACEOF
 
 
 
-if test "x$enable_traffic" = "xyes"; then
-  BUILD_MODULE_TRAFFIC_TRUE=
-  BUILD_MODULE_TRAFFIC_FALSE='#'
+if test "x$enable_unixsock" = "xyes"; then
+  BUILD_MODULE_UNIXSOCK_TRUE=
+  BUILD_MODULE_UNIXSOCK_FALSE='#'
 else
-  BUILD_MODULE_TRAFFIC_TRUE='#'
-  BUILD_MODULE_TRAFFIC_FALSE=
+  BUILD_MODULE_UNIXSOCK_TRUE='#'
+  BUILD_MODULE_UNIXSOCK_FALSE=
 fi
 
 
 																	# Check whether --enable-users was given.
 if test "${enable_users+set}" = set; then
   enableval=$enable_users;
@@ -40693,13 +43143,13 @@
 else
   BUILD_MODULE_WIRELESS_TRUE='#'
   BUILD_MODULE_WIRELESS_FALSE=
 fi
 
 
-ac_config_files="$ac_config_files Makefile src/Makefile src/collectd.conf src/libconfig/Makefile src/liboping/Makefile"
+ac_config_files="$ac_config_files Makefile src/Makefile src/collectd.conf src/liboconfig/Makefile src/liboping/Makefile"
 
 cat >confcache <<\_ACEOF
 # This file is a shell script that caches the results of configure
 # tests run on this system so they can be shared between configure
 # scripts and configure runs, see configure's option --config-cache.
 # It is not useful on other systems.  If it contains results you don't
@@ -40924,12 +43374,19 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBMYSQL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_WITH_LIBMYSQL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_WITH_OWN_LIBOCONFIG_TRUE}" && test -z "${BUILD_WITH_OWN_LIBOCONFIG_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_OWN_LIBOCONFIG\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_WITH_OWN_LIBOCONFIG\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_WITH_LIBOPING_TRUE}" && test -z "${BUILD_WITH_LIBOPING_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBOPING\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_WITH_LIBOPING\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -40945,12 +43402,33 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBPCAP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_WITH_LIBPCAP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_WITH_LIBPERL_TRUE}" && test -z "${BUILD_WITH_LIBPERL_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBPERL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_WITH_LIBPERL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_WITH_LIBIPTC_TRUE}" && test -z "${BUILD_WITH_LIBIPTC_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBIPTC\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_WITH_LIBIPTC\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_WITH_LIBUPSCLIENT_TRUE}" && test -z "${BUILD_WITH_LIBUPSCLIENT_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_WITH_LIBUPSCLIENT\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_WITH_LIBUPSCLIENT\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_FEATURE_DEBUG_TRUE}" && test -z "${BUILD_FEATURE_DEBUG_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_FEATURE_DEBUG\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_FEATURE_DEBUG\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -41015,12 +43493,19 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_DISK\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_DISK\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_CSV_TRUE}" && test -z "${BUILD_MODULE_CSV_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_CSV\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_CSV\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_DF_TRUE}" && test -z "${BUILD_MODULE_DF_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_DF\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_DF\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -41036,26 +43521,54 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_EMAIL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_EMAIL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
-if test -z "${BUILD_MODULE_QUOTA_TRUE}" && test -z "${BUILD_MODULE_QUOTA_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_QUOTA\" was never defined.
+if test -z "${BUILD_MODULE_ENTROPY_TRUE}" && test -z "${BUILD_MODULE_ENTROPY_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_ENTROPY\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"BUILD_MODULE_QUOTA\" was never defined.
+echo "$as_me: error: conditional \"BUILD_MODULE_ENTROPY\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_MODULE_EXEC_TRUE}" && test -z "${BUILD_MODULE_EXEC_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_EXEC\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_EXEC\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
 if test -z "${BUILD_MODULE_HDDTEMP_TRUE}" && test -z "${BUILD_MODULE_HDDTEMP_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_HDDTEMP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_HDDTEMP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_INTERFACE_TRUE}" && test -z "${BUILD_MODULE_INTERFACE_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_INTERFACE\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_INTERFACE\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_MODULE_IPTABLES_TRUE}" && test -z "${BUILD_MODULE_IPTABLES_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_IPTABLES\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_IPTABLES\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_MODULE_IRQ_TRUE}" && test -z "${BUILD_MODULE_IRQ_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_IRQ\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_IRQ\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_LOAD_TRUE}" && test -z "${BUILD_MODULE_LOAD_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_LOAD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_LOAD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -41085,12 +43598,19 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_MYSQL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_MYSQL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_NETWORK_TRUE}" && test -z "${BUILD_MODULE_NETWORK_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_NETWORK\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_NETWORK\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_NFS_TRUE}" && test -z "${BUILD_MODULE_NFS_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_NFS\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_NFS\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -41099,12 +43619,26 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_NTPD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_NTPD\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_NUT_TRUE}" && test -z "${BUILD_MODULE_NUT_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_NUT\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_NUT\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
+if test -z "${BUILD_MODULE_PERL_TRUE}" && test -z "${BUILD_MODULE_PERL_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_PERL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_PERL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_PING_TRUE}" && test -z "${BUILD_MODULE_PING_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_PING\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_PING\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
@@ -41127,30 +43661,44 @@
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_SERIAL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_SERIAL\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_LOGFILE_TRUE}" && test -z "${BUILD_MODULE_LOGFILE_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_LOGFILE\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_LOGFILE\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_SWAP_TRUE}" && test -z "${BUILD_MODULE_SWAP_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_SWAP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_SWAP\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${BUILD_MODULE_SYSLOG_TRUE}" && test -z "${BUILD_MODULE_SYSLOG_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_SYSLOG\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"BUILD_MODULE_SYSLOG\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_MODULE_TAPE_TRUE}" && test -z "${BUILD_MODULE_TAPE_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_TAPE\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
 echo "$as_me: error: conditional \"BUILD_MODULE_TAPE\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
-if test -z "${BUILD_MODULE_TRAFFIC_TRUE}" && test -z "${BUILD_MODULE_TRAFFIC_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_TRAFFIC\" was never defined.
+if test -z "${BUILD_MODULE_UNIXSOCK_TRUE}" && test -z "${BUILD_MODULE_UNIXSOCK_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_UNIXSOCK\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"BUILD_MODULE_TRAFFIC\" was never defined.
+echo "$as_me: error: conditional \"BUILD_MODULE_UNIXSOCK\" was never defined.
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
 if test -z "${BUILD_MODULE_USERS_TRUE}" && test -z "${BUILD_MODULE_USERS_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_MODULE_USERS\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
@@ -41469,13 +44017,13 @@
 exec 6>&1
 
 # Save the log message, to keep $[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by collectd $as_me 3.11.7, which was
+This file was extended by collectd $as_me 4.0.0, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -41522,13 +44070,13 @@
 
 Report bugs to <bug-autoconf@gnu.org>."
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-collectd config.status 3.11.7
+collectd config.status 4.0.0
 configured by $0, generated by GNU Autoconf 2.61,
   with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
 Copyright (C) 2006 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
@@ -41640,13 +44188,13 @@
   case $ac_config_target in
     "src/config.h") CONFIG_HEADERS="$CONFIG_HEADERS src/config.h" ;;
     "depfiles") CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
     "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
     "src/Makefile") CONFIG_FILES="$CONFIG_FILES src/Makefile" ;;
     "src/collectd.conf") CONFIG_FILES="$CONFIG_FILES src/collectd.conf" ;;
-    "src/libconfig/Makefile") CONFIG_FILES="$CONFIG_FILES src/libconfig/Makefile" ;;
+    "src/liboconfig/Makefile") CONFIG_FILES="$CONFIG_FILES src/liboconfig/Makefile" ;;
     "src/liboping/Makefile") CONFIG_FILES="$CONFIG_FILES src/liboping/Makefile" ;;
 
   *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
 echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
    { (exit 1); exit 1; }; };;
   esac
@@ -41792,21 +44340,21 @@
 build_vendor!$build_vendor$ac_delim
 build_os!$build_os$ac_delim
 host!$host$ac_delim
 host_cpu!$host_cpu$ac_delim
 host_vendor!$host_vendor$ac_delim
 host_os!$host_os$ac_delim
-SED!$SED$ac_delim
 GREP!$GREP$ac_delim
 EGREP!$EGREP$ac_delim
 ECHO!$ECHO$ac_delim
 AR!$AR$ac_delim
 RANLIB!$RANLIB$ac_delim
 CXX!$CXX$ac_delim
 CXXFLAGS!$CXXFLAGS$ac_delim
 ac_ct_CXX!$ac_ct_CXX$ac_delim
+CXXDEPMODE!$CXXDEPMODE$ac_delim
 _ACEOF
 
   if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 97; then
     break
   elif $ac_last_try; then
     { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
@@ -41842,20 +44390,24 @@
 _ACEOF
 
 
 ac_delim='%!_!# '
 for ac_last_try in false false false false false :; do
   cat >conf$$subs.sed <<_ACEOF
-CXXDEPMODE!$CXXDEPMODE$ac_delim
 am__fastdepCXX_TRUE!$am__fastdepCXX_TRUE$ac_delim
 am__fastdepCXX_FALSE!$am__fastdepCXX_FALSE$ac_delim
 CXXCPP!$CXXCPP$ac_delim
 F77!$F77$ac_delim
 FFLAGS!$FFLAGS$ac_delim
 ac_ct_F77!$ac_ct_F77$ac_delim
 LIBTOOL!$LIBTOOL$ac_delim
+LEX!$LEX$ac_delim
+LEX_OUTPUT_ROOT!$LEX_OUTPUT_ROOT$ac_delim
+LEXLIB!$LEXLIB$ac_delim
+YACC!$YACC$ac_delim
+YFLAGS!$YFLAGS$ac_delim
 subdirs!$subdirs$ac_delim
 BUILD_WITH_LIBSOCKET_TRUE!$BUILD_WITH_LIBSOCKET_TRUE$ac_delim
 BUILD_WITH_LIBSOCKET_FALSE!$BUILD_WITH_LIBSOCKET_FALSE$ac_delim
 BUILD_WITH_LIBRT_TRUE!$BUILD_WITH_LIBRT_TRUE$ac_delim
 BUILD_WITH_LIBRT_FALSE!$BUILD_WITH_LIBRT_FALSE$ac_delim
 BUILD_WITH_LIBRESOLV_TRUE!$BUILD_WITH_LIBRESOLV_TRUE$ac_delim
@@ -41880,18 +44432,28 @@
 BUILD_WITH_LIBKVM_TRUE!$BUILD_WITH_LIBKVM_TRUE$ac_delim
 BUILD_WITH_LIBKVM_FALSE!$BUILD_WITH_LIBKVM_FALSE$ac_delim
 BUILD_WITH_LM_SENSORS_TRUE!$BUILD_WITH_LM_SENSORS_TRUE$ac_delim
 BUILD_WITH_LM_SENSORS_FALSE!$BUILD_WITH_LM_SENSORS_FALSE$ac_delim
 BUILD_WITH_LIBMYSQL_TRUE!$BUILD_WITH_LIBMYSQL_TRUE$ac_delim
 BUILD_WITH_LIBMYSQL_FALSE!$BUILD_WITH_LIBMYSQL_FALSE$ac_delim
+BUILD_WITH_OWN_LIBOCONFIG_TRUE!$BUILD_WITH_OWN_LIBOCONFIG_TRUE$ac_delim
+BUILD_WITH_OWN_LIBOCONFIG_FALSE!$BUILD_WITH_OWN_LIBOCONFIG_FALSE$ac_delim
 BUILD_WITH_LIBOPING_TRUE!$BUILD_WITH_LIBOPING_TRUE$ac_delim
 BUILD_WITH_LIBOPING_FALSE!$BUILD_WITH_LIBOPING_FALSE$ac_delim
 BUILD_WITH_OWN_LIBOPING_TRUE!$BUILD_WITH_OWN_LIBOPING_TRUE$ac_delim
 BUILD_WITH_OWN_LIBOPING_FALSE!$BUILD_WITH_OWN_LIBOPING_FALSE$ac_delim
 BUILD_WITH_LIBPCAP_TRUE!$BUILD_WITH_LIBPCAP_TRUE$ac_delim
 BUILD_WITH_LIBPCAP_FALSE!$BUILD_WITH_LIBPCAP_FALSE$ac_delim
+PERL_CFLAGS!$PERL_CFLAGS$ac_delim
+PERL_LDFLAGS!$PERL_LDFLAGS$ac_delim
+BUILD_WITH_LIBPERL_TRUE!$BUILD_WITH_LIBPERL_TRUE$ac_delim
+BUILD_WITH_LIBPERL_FALSE!$BUILD_WITH_LIBPERL_FALSE$ac_delim
+BUILD_WITH_LIBIPTC_TRUE!$BUILD_WITH_LIBIPTC_TRUE$ac_delim
+BUILD_WITH_LIBIPTC_FALSE!$BUILD_WITH_LIBIPTC_FALSE$ac_delim
+BUILD_WITH_LIBUPSCLIENT_TRUE!$BUILD_WITH_LIBUPSCLIENT_TRUE$ac_delim
+BUILD_WITH_LIBUPSCLIENT_FALSE!$BUILD_WITH_LIBUPSCLIENT_FALSE$ac_delim
 BUILD_FEATURE_DEBUG_TRUE!$BUILD_FEATURE_DEBUG_TRUE$ac_delim
 BUILD_FEATURE_DEBUG_FALSE!$BUILD_FEATURE_DEBUG_FALSE$ac_delim
 BUILD_FEATURE_DAEMON_TRUE!$BUILD_FEATURE_DAEMON_TRUE$ac_delim
 BUILD_FEATURE_DAEMON_FALSE!$BUILD_FEATURE_DAEMON_FALSE$ac_delim
 BUILD_FEATURE_GETIFADDRS_TRUE!$BUILD_FEATURE_GETIFADDRS_TRUE$ac_delim
 BUILD_FEATURE_GETIFADDRS_FALSE!$BUILD_FEATURE_GETIFADDRS_FALSE$ac_delim
@@ -41906,45 +44468,31 @@
 BUILD_MODULE_CPU_TRUE!$BUILD_MODULE_CPU_TRUE$ac_delim
 BUILD_MODULE_CPU_FALSE!$BUILD_MODULE_CPU_FALSE$ac_delim
 BUILD_MODULE_CPUFREQ_TRUE!$BUILD_MODULE_CPUFREQ_TRUE$ac_delim
 BUILD_MODULE_CPUFREQ_FALSE!$BUILD_MODULE_CPUFREQ_FALSE$ac_delim
 BUILD_MODULE_DISK_TRUE!$BUILD_MODULE_DISK_TRUE$ac_delim
 BUILD_MODULE_DISK_FALSE!$BUILD_MODULE_DISK_FALSE$ac_delim
+BUILD_MODULE_CSV_TRUE!$BUILD_MODULE_CSV_TRUE$ac_delim
+BUILD_MODULE_CSV_FALSE!$BUILD_MODULE_CSV_FALSE$ac_delim
 BUILD_MODULE_DF_TRUE!$BUILD_MODULE_DF_TRUE$ac_delim
 BUILD_MODULE_DF_FALSE!$BUILD_MODULE_DF_FALSE$ac_delim
 BUILD_MODULE_DNS_TRUE!$BUILD_MODULE_DNS_TRUE$ac_delim
 BUILD_MODULE_DNS_FALSE!$BUILD_MODULE_DNS_FALSE$ac_delim
 BUILD_MODULE_EMAIL_TRUE!$BUILD_MODULE_EMAIL_TRUE$ac_delim
 BUILD_MODULE_EMAIL_FALSE!$BUILD_MODULE_EMAIL_FALSE$ac_delim
-BUILD_MODULE_QUOTA_TRUE!$BUILD_MODULE_QUOTA_TRUE$ac_delim
-BUILD_MODULE_QUOTA_FALSE!$BUILD_MODULE_QUOTA_FALSE$ac_delim
+BUILD_MODULE_ENTROPY_TRUE!$BUILD_MODULE_ENTROPY_TRUE$ac_delim
+BUILD_MODULE_ENTROPY_FALSE!$BUILD_MODULE_ENTROPY_FALSE$ac_delim
+BUILD_MODULE_EXEC_TRUE!$BUILD_MODULE_EXEC_TRUE$ac_delim
+BUILD_MODULE_EXEC_FALSE!$BUILD_MODULE_EXEC_FALSE$ac_delim
 BUILD_MODULE_HDDTEMP_TRUE!$BUILD_MODULE_HDDTEMP_TRUE$ac_delim
 BUILD_MODULE_HDDTEMP_FALSE!$BUILD_MODULE_HDDTEMP_FALSE$ac_delim
-BUILD_MODULE_LOAD_TRUE!$BUILD_MODULE_LOAD_TRUE$ac_delim
-BUILD_MODULE_LOAD_FALSE!$BUILD_MODULE_LOAD_FALSE$ac_delim
-BUILD_MODULE_MBMON_TRUE!$BUILD_MODULE_MBMON_TRUE$ac_delim
-BUILD_MODULE_MBMON_FALSE!$BUILD_MODULE_MBMON_FALSE$ac_delim
-BUILD_MODULE_MEMORY_TRUE!$BUILD_MODULE_MEMORY_TRUE$ac_delim
-BUILD_MODULE_MEMORY_FALSE!$BUILD_MODULE_MEMORY_FALSE$ac_delim
-BUILD_MODULE_MULTIMETER_TRUE!$BUILD_MODULE_MULTIMETER_TRUE$ac_delim
-BUILD_MODULE_MULTIMETER_FALSE!$BUILD_MODULE_MULTIMETER_FALSE$ac_delim
-BUILD_MODULE_MYSQL_TRUE!$BUILD_MODULE_MYSQL_TRUE$ac_delim
-BUILD_MODULE_MYSQL_FALSE!$BUILD_MODULE_MYSQL_FALSE$ac_delim
-BUILD_MODULE_NFS_TRUE!$BUILD_MODULE_NFS_TRUE$ac_delim
-BUILD_MODULE_NFS_FALSE!$BUILD_MODULE_NFS_FALSE$ac_delim
-BUILD_MODULE_NTPD_TRUE!$BUILD_MODULE_NTPD_TRUE$ac_delim
-BUILD_MODULE_NTPD_FALSE!$BUILD_MODULE_NTPD_FALSE$ac_delim
-BUILD_MODULE_PING_TRUE!$BUILD_MODULE_PING_TRUE$ac_delim
-BUILD_MODULE_PING_FALSE!$BUILD_MODULE_PING_FALSE$ac_delim
-BUILD_MODULE_PROCESSES_TRUE!$BUILD_MODULE_PROCESSES_TRUE$ac_delim
-BUILD_MODULE_PROCESSES_FALSE!$BUILD_MODULE_PROCESSES_FALSE$ac_delim
-BUILD_MODULE_SENSORS_TRUE!$BUILD_MODULE_SENSORS_TRUE$ac_delim
-BUILD_MODULE_SENSORS_FALSE!$BUILD_MODULE_SENSORS_FALSE$ac_delim
-BUILD_MODULE_SERIAL_TRUE!$BUILD_MODULE_SERIAL_TRUE$ac_delim
-BUILD_MODULE_SERIAL_FALSE!$BUILD_MODULE_SERIAL_FALSE$ac_delim
-BUILD_MODULE_SWAP_TRUE!$BUILD_MODULE_SWAP_TRUE$ac_delim
+BUILD_MODULE_INTERFACE_TRUE!$BUILD_MODULE_INTERFACE_TRUE$ac_delim
+BUILD_MODULE_INTERFACE_FALSE!$BUILD_MODULE_INTERFACE_FALSE$ac_delim
+BUILD_MODULE_IPTABLES_TRUE!$BUILD_MODULE_IPTABLES_TRUE$ac_delim
+BUILD_MODULE_IPTABLES_FALSE!$BUILD_MODULE_IPTABLES_FALSE$ac_delim
+BUILD_MODULE_IRQ_TRUE!$BUILD_MODULE_IRQ_TRUE$ac_delim
 _ACEOF
 
   if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 97; then
     break
   elif $ac_last_try; then
     { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
@@ -41980,28 +44528,62 @@
 _ACEOF
 
 
 ac_delim='%!_!# '
 for ac_last_try in false false false false false :; do
   cat >conf$$subs.sed <<_ACEOF
+BUILD_MODULE_IRQ_FALSE!$BUILD_MODULE_IRQ_FALSE$ac_delim
+BUILD_MODULE_LOAD_TRUE!$BUILD_MODULE_LOAD_TRUE$ac_delim
+BUILD_MODULE_LOAD_FALSE!$BUILD_MODULE_LOAD_FALSE$ac_delim
+BUILD_MODULE_MBMON_TRUE!$BUILD_MODULE_MBMON_TRUE$ac_delim
+BUILD_MODULE_MBMON_FALSE!$BUILD_MODULE_MBMON_FALSE$ac_delim
+BUILD_MODULE_MEMORY_TRUE!$BUILD_MODULE_MEMORY_TRUE$ac_delim
+BUILD_MODULE_MEMORY_FALSE!$BUILD_MODULE_MEMORY_FALSE$ac_delim
+BUILD_MODULE_MULTIMETER_TRUE!$BUILD_MODULE_MULTIMETER_TRUE$ac_delim
+BUILD_MODULE_MULTIMETER_FALSE!$BUILD_MODULE_MULTIMETER_FALSE$ac_delim
+BUILD_MODULE_MYSQL_TRUE!$BUILD_MODULE_MYSQL_TRUE$ac_delim
+BUILD_MODULE_MYSQL_FALSE!$BUILD_MODULE_MYSQL_FALSE$ac_delim
+BUILD_MODULE_NETWORK_TRUE!$BUILD_MODULE_NETWORK_TRUE$ac_delim
+BUILD_MODULE_NETWORK_FALSE!$BUILD_MODULE_NETWORK_FALSE$ac_delim
+BUILD_MODULE_NFS_TRUE!$BUILD_MODULE_NFS_TRUE$ac_delim
+BUILD_MODULE_NFS_FALSE!$BUILD_MODULE_NFS_FALSE$ac_delim
+BUILD_MODULE_NTPD_TRUE!$BUILD_MODULE_NTPD_TRUE$ac_delim
+BUILD_MODULE_NTPD_FALSE!$BUILD_MODULE_NTPD_FALSE$ac_delim
+BUILD_MODULE_NUT_TRUE!$BUILD_MODULE_NUT_TRUE$ac_delim
+BUILD_MODULE_NUT_FALSE!$BUILD_MODULE_NUT_FALSE$ac_delim
+BUILD_MODULE_PERL_TRUE!$BUILD_MODULE_PERL_TRUE$ac_delim
+BUILD_MODULE_PERL_FALSE!$BUILD_MODULE_PERL_FALSE$ac_delim
+BUILD_MODULE_PING_TRUE!$BUILD_MODULE_PING_TRUE$ac_delim
+BUILD_MODULE_PING_FALSE!$BUILD_MODULE_PING_FALSE$ac_delim
+BUILD_MODULE_PROCESSES_TRUE!$BUILD_MODULE_PROCESSES_TRUE$ac_delim
+BUILD_MODULE_PROCESSES_FALSE!$BUILD_MODULE_PROCESSES_FALSE$ac_delim
+BUILD_MODULE_SENSORS_TRUE!$BUILD_MODULE_SENSORS_TRUE$ac_delim
+BUILD_MODULE_SENSORS_FALSE!$BUILD_MODULE_SENSORS_FALSE$ac_delim
+BUILD_MODULE_SERIAL_TRUE!$BUILD_MODULE_SERIAL_TRUE$ac_delim
+BUILD_MODULE_SERIAL_FALSE!$BUILD_MODULE_SERIAL_FALSE$ac_delim
+BUILD_MODULE_LOGFILE_TRUE!$BUILD_MODULE_LOGFILE_TRUE$ac_delim
+BUILD_MODULE_LOGFILE_FALSE!$BUILD_MODULE_LOGFILE_FALSE$ac_delim
+BUILD_MODULE_SWAP_TRUE!$BUILD_MODULE_SWAP_TRUE$ac_delim
 BUILD_MODULE_SWAP_FALSE!$BUILD_MODULE_SWAP_FALSE$ac_delim
+BUILD_MODULE_SYSLOG_TRUE!$BUILD_MODULE_SYSLOG_TRUE$ac_delim
+BUILD_MODULE_SYSLOG_FALSE!$BUILD_MODULE_SYSLOG_FALSE$ac_delim
 BUILD_MODULE_TAPE_TRUE!$BUILD_MODULE_TAPE_TRUE$ac_delim
 BUILD_MODULE_TAPE_FALSE!$BUILD_MODULE_TAPE_FALSE$ac_delim
-BUILD_MODULE_TRAFFIC_TRUE!$BUILD_MODULE_TRAFFIC_TRUE$ac_delim
-BUILD_MODULE_TRAFFIC_FALSE!$BUILD_MODULE_TRAFFIC_FALSE$ac_delim
+BUILD_MODULE_UNIXSOCK_TRUE!$BUILD_MODULE_UNIXSOCK_TRUE$ac_delim
+BUILD_MODULE_UNIXSOCK_FALSE!$BUILD_MODULE_UNIXSOCK_FALSE$ac_delim
 BUILD_MODULE_USERS_TRUE!$BUILD_MODULE_USERS_TRUE$ac_delim
 BUILD_MODULE_USERS_FALSE!$BUILD_MODULE_USERS_FALSE$ac_delim
 BUILD_MODULE_VSERVER_TRUE!$BUILD_MODULE_VSERVER_TRUE$ac_delim
 BUILD_MODULE_VSERVER_FALSE!$BUILD_MODULE_VSERVER_FALSE$ac_delim
 BUILD_MODULE_WIRELESS_TRUE!$BUILD_MODULE_WIRELESS_TRUE$ac_delim
 BUILD_MODULE_WIRELESS_FALSE!$BUILD_MODULE_WIRELESS_FALSE$ac_delim
 LIBOBJS!$LIBOBJS$ac_delim
 LTLIBOBJS!$LTLIBOBJS$ac_delim
 _ACEOF
 
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 13; then
+  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 47; then
     break
   elif $ac_last_try; then
     { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
 echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
    { (exit 1); exit 1; }; }
   else
@@ -42767,58 +45349,78 @@
 
     cd "$ac_popdir"
   done
 fi
 
 
+if test "x$with_libperl" = "xyes"
+then
+	with_libperl="yes (version `perl -MConfig -e 'print $Config{version};'`)"
+else
+	enable_perl="no (needs libperl)"
+fi
+
 cat <<EOF;
 
 Configuration:
   Libraries:
     libcurl . . . . . . $with_libcurl
     libiokit  . . . . . $with_libiokit
-    liboping  . . . . . $with_liboping
-    librrd  . . . . . . $with_rrdtool
-    lm_sensors  . . . . $with_lm_sensors
-    libstatgrab . . . . $with_libstatgrab
+    libiptc . . . . . . $with_libiptc
     libkstat  . . . . . $with_kstat
     libmysql  . . . . . $with_libmysql
+    liboconfig  . . . . $with_liboconfig
+    liboping  . . . . . $with_liboping
     libpcap . . . . . . $with_libpcap
+    libperl . . . . . . $with_libperl
     libpthread  . . . . $with_libpthread
+    librrd  . . . . . . $with_rrdtool
+    libsensors  . . . . $with_lm_sensors
+    libstatgrab . . . . $with_libstatgrab
+    libupsclient  . . . $with_libupsclient
 
   Features:
-    debug . . . . . . . $enable_debug
     daemon mode . . . . $enable_daemon
-    step  . . . . . . . $collectd_step seconds
-    heartbeat . . . . . $collectd_heartbeat seconds
+    debug . . . . . . . $enable_debug
 
   Modules:
     apache  . . . . . . $enable_apache
     apcups  . . . . . . $enable_apcups
     apple_sensors . . . $enable_apple_sensors
     battery . . . . . . $enable_battery
     cpu . . . . . . . . $enable_cpu
     cpufreq . . . . . . $enable_cpufreq
+    csv . . . . . . . . $enable_csv
     df  . . . . . . . . $enable_df
     disk  . . . . . . . $enable_disk
     dns . . . . . . . . $enable_dns
     email . . . . . . . $enable_email
+    entropy . . . . . . $enable_entropy
+    exec  . . . . . . . $enable_exec
     hddtemp . . . . . . $enable_hddtemp
+    interface . . . . . $enable_interface
+    iptables  . . . . . $enable_iptables
+    irq . . . . . . . . $enable_irq
     load  . . . . . . . $enable_load
+    logfile . . . . . . $enable_logfile
     mbmon . . . . . . . $enable_mbmon
     memory  . . . . . . $enable_memory
     multimeter  . . . . $enable_multimeter
     mysql . . . . . . . $enable_mysql
+    network . . . . . . $enable_network
     nfs . . . . . . . . $enable_nfs
     ntpd  . . . . . . . $enable_ntpd
+    nut . . . . . . . . $enable_nut
+    perl  . . . . . . . $enable_perl
     ping  . . . . . . . $enable_ping
     processes . . . . . $enable_processes
     sensors . . . . . . $enable_sensors
     serial  . . . . . . $enable_serial
     swap  . . . . . . . $enable_swap
+    syslog  . . . . . . $enable_syslog
     tape  . . . . . . . $enable_tape
-    traffic . . . . . . $enable_traffic
+    unixsock  . . . . . $enable_unixsock
     users . . . . . . . $enable_users
     vserver . . . . . . $enable_vserver
     wireless  . . . . . $enable_wireless
 
 EOF
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/configure.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/configure.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/configure.in	2007-09-28 18:59:49.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/configure.in	2007-06-04 01:11:59.000000000 +0800
@@ -1,8 +1,8 @@
 dnl Process this file with autoconf to produce a configure script.
-AC_INIT(collectd, 3.11.7)
+AC_INIT(collectd, 4.0.0)
 AC_CONFIG_SRCDIR(src/collectd.c)
 AC_CONFIG_HEADERS(src/config.h)
 AM_INIT_AUTOMAKE(dist-bzip2)
 AC_LANG(C)
 
 AC_PREFIX_DEFAULT("/opt/collectd")
@@ -23,13 +23,14 @@
 AC_DISABLE_STATIC
 AC_LIBLTDL_CONVENIENCE
 AC_SUBST(LTDLINCL)
 AC_SUBST(LIBLTDL)
 AC_LIBTOOL_DLOPEN
 AC_PROG_LIBTOOL
-#AC_PROG_RANLIB
+AC_PROG_LEX
+AC_PROG_YACC
 AC_CONFIG_SUBDIRS(libltdl)
 
 #
 # Checks for header files.
 #
 AC_HEADER_STDC
@@ -43,17 +44,18 @@
 AC_CHECK_HEADERS(fcntl.h)
 AC_CHECK_HEADERS(signal.h)
 AC_CHECK_HEADERS(assert.h)
 AC_CHECK_HEADERS(sys/types.h)
 AC_CHECK_HEADERS(sys/socket.h)
 AC_CHECK_HEADERS(sys/select.h)
-AC_CHECK_HEADERS(sys/poll.h)
+AC_CHECK_HEADERS(poll.h)
 AC_CHECK_HEADERS(netdb.h)
 AC_CHECK_HEADERS(arpa/inet.h)
 AC_CHECK_HEADERS(sys/resource.h)
 AC_CHECK_HEADERS(sys/param.h)
+AC_CHECK_HEADERS(kstat.h)
 
 # For ping library
 AC_CHECK_HEADERS(netinet/in_systm.h, [], [],
 [#if HAVE_STDINT_H
 # include <stdint.h>
 #endif
@@ -148,12 +150,29 @@
 # include <netinet/in.h>
 #endif
 #if HAVE_NETINET_IP6_H
 # include <netinet/ip6.h>
 #endif
 ])
+AC_CHECK_HEADERS(netinet/tcp.h, [], [],
+[#if HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#if HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#if HAVE_NETINET_IN_SYSTM_H
+# include <netinet/in_systm.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_NETINET_IP_H
+# include <netinet/ip.h>
+#endif
+])
 AC_CHECK_HEADERS(netinet/udp.h, [], [],
 [#if HAVE_STDINT_H
 # include <stdint.h>
 #endif
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
@@ -188,12 +207,13 @@
 AC_CHECK_HEADERS(mach/vm_prot.h)
 AC_CHECK_HEADERS(mach/vm_statistics.h)
 AC_CHECK_HEADERS(mach/kern_return.h)
 
 # For hddtemp module
 AC_CHECK_HEADERS(linux/major.h)
+AC_CHECK_HEADERS(libgen.h)
 
 # For the apple_sensors module
 AC_CHECK_HEADERS(CoreFoundation/CoreFoundation.h)
 AC_CHECK_HEADERS(IOKit/IOKitLib.h)
 AC_CHECK_HEADERS(IOKit/IOTypes.h)
 
@@ -223,13 +243,13 @@
 AC_CHECK_HEADERS(sys/swap.h)
 
 # For users module
 AC_CHECK_HEADERS(utmp.h)
 AC_CHECK_HEADERS(utmpx.h)
 
-# For traffic plugin
+# For interface plugin
 AC_CHECK_HEADERS(ifaddrs.h)
 AC_CHECK_HEADERS(net/if.h, [], [],
 [
 #if HAVE_SYS_TYPES_H
 #  include <sys/types.h>
 #endif
@@ -260,13 +280,13 @@
 ])
 
 # For apache plugin
 AC_CHECK_HEADERS(curl/curl.h)
 
 # For quota module
-AC_CHECK_HEADERS(grp.h pwd.h sys/ucred.h)
+AC_CHECK_HEADERS(pwd.h sys/ucred.h)
 AC_CHECK_HEADERS(ctype.h)
 AC_CHECK_HEADERS(limits.h)
 AC_CHECK_HEADERS(sys/quota.h)
 AC_CHECK_HEADERS(xfs/xqm.h)
 
 # For mount interface
@@ -328,13 +348,19 @@
 #endif
 #if HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
 ])
 
-dnl Checking for libraries
+# For the multimeter plugin
+AC_CHECK_HEADERS(termios.h)
+AC_CHECK_HEADERS(sys/ioctl.h)
+
+#
+# Checking for libraries
+#
 AC_CHECK_LIB(m, ext)
 
 #
 # Checks for typedefs, structures, and compiler characteristics.
 #
 AC_C_CONST
@@ -380,15 +406,110 @@
 AC_CHECK_FUNCS(getutent getutxent)
 
 # For quota module
 AC_CHECK_FUNCS(quotactl)
 AC_CHECK_FUNCS(getgrgid getpwuid)
 
-# For traffic module
+# For interface module
 AC_CHECK_FUNCS(getifaddrs)
 
+# Check for NAN
+nan_type="none"
+if test "x$nan_type" = "xnone"; then
+  AC_CACHE_CHECK([whether NAN is defined by default],
+    [have_nan_default],
+    AC_COMPILE_IFELSE(
+      AC_LANG_PROGRAM(
+      [[
+#include <stdlib.h>
+#include <math.h>
+static float foo = NAN;
+      ]],
+      [[
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+      ]]),
+      [have_nan_default="yes"],
+      [have_nan_default="no"]
+    )
+  )
+  if test "x$have_nan_default" = "xyes"
+  then
+   nan_type="default"
+   AC_DEFINE(NAN_STATIC_DEFAULT, 1,
+     [Define if NAN is defined by default and can initialize static variables.])
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  AC_CACHE_CHECK([whether NAN is defined by __USE_ISOC99],
+    [have_nan_isoc],
+    AC_COMPILE_IFELSE(
+      AC_LANG_PROGRAM(
+      [[
+#include <stdlib.h>
+#define __USE_ISOC99 1
+#include <math.h>
+static float foo = NAN;
+      ]],
+      [[
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+      ]]),
+      [have_nan_isoc="yes"],
+      [have_nan_isoc="no"]
+    )
+  )
+  if test "x$have_nan_isoc" = "xyes"
+  then
+   nan_type="isoc99"
+   AC_DEFINE(NAN_STATIC_ISOC, 1,
+     [Define if NAN is defined by __USE_ISOC99 and can initialize static variables.])
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  AC_CACHE_CHECK([whether NAN can be defined by 0/0],
+    [have_nan_zero],
+    AC_RUN_IFELSE(
+      AC_LANG_PROGRAM(
+      [[
+#include <stdlib.h>
+#include <math.h>
+#ifdef NAN
+# undef NAN
+#endif
+#define NAN (0.0 / 0.0)
+#ifndef isnan
+# define isnan(f) ((f) != (f))
+#endif
+static float foo = NAN;
+      ]],
+      [[
+       if (isnan (foo))
+        return 0;
+       else
+	return 1;
+      ]]),
+      [have_nan_zero="yes"],
+      [have_nan_zero="no"]
+    )
+  )
+  if test "x$have_nan_zero" = "xyes"
+  then
+   nan_type="zero"
+   AC_DEFINE(NAN_ZERO_ZERO, 1,
+     [Define if NAN can be defined as (0.0 / 0.0)])
+  fi
+fi
+if test "x$nan_type" = "xnone"; then
+  AC_MSG_ERROR([Didn't find out how to statically initialize variables to NAN. Sorry.])
+fi
+
 # For mount interface
 #AC_CHECK_FUNCS(getfsent getvfsent)
 
 have_getfsstat="no"
 AC_CHECK_FUNCS(getfsstat, [have_getfsstat="yes"])
 have_getvfsstat="no"
@@ -528,12 +649,21 @@
 #endif
 #if HAVE_NETINET_UDP_H
 # include <netinet/udp.h>
 #endif
 ])
 
+AC_CHECK_MEMBERS([kstat_io_t.nwritten, kstat_io_t.writes, kstat_io_t.nwrites, kstat_io_t.wtime],
+	[],
+	[],
+	[
+#if HAVE_KSTAT_H
+# include <kstat.h>
+#endif
+	])
+
 AC_MSG_CHECKING([for kernel type ($host_os)])
 case $host_os in
 	*linux*)
 	AC_DEFINE([KERNEL_LINUX], 1, [True if program is to be compiled for a Linux kernel])
 	ac_system="Linux"
 	;;
@@ -854,12 +984,59 @@
 	collect_libmysql=0
 fi
 AC_DEFINE_UNQUOTED(COLLECT_LIBMYSQL, [$collect_libmysql],
 	[Wether or not to use mysql library])
 AM_CONDITIONAL(BUILD_WITH_LIBMYSQL, test "x$with_libmysql" = "xyes")
 
+with_own_liboconfig="no"
+liboconfig_LDFLAGS="$LDFLAGS"
+liboconfig_CPPFLAGS="$CPPFLAGS"
+AC_ARG_WITH(liboconfig, [AS_HELP_STRING([--with-liboconfig@<:@=PREFIX@:>@], [Path to liboconfig.])],
+[
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		if test -d "$withval/lib"
+		then
+			liboconfig_LDFLAGS="$LDFLAGS -L$withval/lib"
+		fi
+		if test -d "$withval/include"
+		then
+			liboconfig_CPPFLAGS="$CPPFLAGS -I$withval/include"
+		fi
+	fi
+	if test "x$withval" = "xno"
+	then
+		AC_MSG_ERROR("liboconfig is required")
+	fi
+],
+[
+	with_liboconfig="yes"
+])
+
+save_LDFLAGS="$LDFLAGS"
+save_CPPFLAGS="$CPPFLAGS"
+LDFLAGS="$liboconfig_LDFLAGS"
+CPPFLAGS="$liboconfig_CPPFLAGS"
+AC_CHECK_LIB(oconfig, oconfig_parse_fh,
+[
+	with_liboconfig="yes"
+	with_own_liboconfig="no"
+],
+[
+	with_liboconfig="yes"
+	with_own_liboconfig="yes"
+	LDFLAGS="$save_LDFLAGS"
+	CPPFLAGS="$save_CPPFLAGS"
+])
+
+AM_CONDITIONAL(BUILD_WITH_OWN_LIBOCONFIG, test "x$with_own_liboconfig" = "xyes")
+if test "x$with_own_liboconfig" = "xyes"
+then
+	with_liboconfig="yes (shipped version)"
+fi
+
 #with_liboping="yes"
 with_own_liboping="no"
 liboping_LDFLAGS="$LDFLAGS"
 liboping_CPPFLAGS="$CPPFLAGS"
 AC_ARG_WITH(liboping, [AS_HELP_STRING([--with-liboping@<:@=PREFIX@:>@], [Path to liboping.])],
 [
@@ -943,47 +1120,135 @@
 	collect_libpcap=0
 fi
 AC_DEFINE_UNQUOTED(COLLECT_LIBPCAP, [$collect_libpcap],
 	[Wether or not to use the pcap library])
 AM_CONDITIONAL(BUILD_WITH_LIBPCAP, test "x$with_libpcap" = "xyes")
 
-# Define `step' and `hearbeat' values..
-declare -i collectd_step=10
-declare -i collectd_heartbeat=25
-AC_ARG_WITH(step, [AS_HELP_STRING([--with-step=SECONDS], [Interval in which plugins are queried.])],
+perl_interpreter="perl"
+AC_ARG_WITH(libperl, [AS_HELP_STRING([--with-libperl@<:@=PREFIX@:>@], [Path to libperl.])],
 [
-	if test "x$withval" != "xno" -a "x$withval" != "xyes"
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
 	then
-		declare -i tmp_collectd_step="$withval"
-		if test $tmp_collectd_step -gt 0
-		then
-			collectd_step=$tmp_collectd_step
-			let "collectd_heartbeat=$collectd_step*2"
-		fi
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		perl_interpreter="$withval/bin/perl"
+		with_libperl="yes"
 	fi
-], [])
-AC_ARG_WITH(heartbeat, [AS_HELP_STRING([--with-heartbeat=SECONDS], [Heartbeat of the DS in generated RRD files.])],
+],
 [
-	if test "x$withval" != "xno" -a "x$withval" != "xyes"
+	with_libperl="yes"
+])
+if test "x$with_libperl" = "xyes"
+then
+  SAVE_CFLAGS=$CFLAGS
+  SAVE_LDFLAGS=$LDFLAGS
+  PERL_CFLAGS=`$perl_interpreter -MExtUtils::Embed -e ccopts`
+  PERL_LDFLAGS=`$perl_interpreter -MExtUtils::Embed -e ldopts`
+  CFLAGS="$CFLAGS $PERL_CFLAGS"
+  LDFLAGS="$LDFLAGS $PERL_LDFLAGS"
+
+  AC_CACHE_CHECK([for libperl],
+    [have_libperl],
+    AC_LINK_IFELSE(
+      AC_LANG_PROGRAM(
+      [[
+#include <EXTERN.h>
+#include <perl.h>
+#include <XSUB.h>
+      ]],
+      [[
+       PerlInterpreter *perl = NULL;
+       Perl_load_module (perl, PERL_LOADMOD_NOIMPORT,
+			 newSVpv ("Collectd::Plugin::FooBar", 24),
+			 Nullsv);
+      ]]),
+      [have_libperl="yes"],
+      [have_libperl="no"]
+    )
+  )
+
+  if test "x$have_libperl" = "xyes"
+  then
+	  AC_DEFINE(HAVE_LIBPERL, 1, [Define if libperl is present and usable.])
+	  AC_SUBST(PERL_CFLAGS)
+	  AC_SUBST(PERL_LDFLAGS)
+  else
+	  with_libperl="no"
+  fi
+
+  CFLAGS=$SAVE_CFLAGS
+  LDFLAGS=$SAVE_LDFLAGS
+fi
+AM_CONDITIONAL(BUILD_WITH_LIBPERL, test "x$with_libperl" = "xyes")
+
+AC_ARG_WITH(libiptc, [AS_HELP_STRING([--with-libiptc@<:@=PREFIX@:>@], [Path to libiptc.])],
+[
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
 	then
-		declare -i tmp_collectd_heartbeat="$withval"
-		if test $tmp_collectd_heartbeat -gt 0
-		then
-			collectd_heartbeat=$tmp_collectd_heartbeat
-		fi
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		with_libiptc="yes"
+	fi
+],
+[
+ 	if test "x$ac_system" = "xLinux"
+	then
+		with_libiptc="yes"
+	else
+		with_libiptc="no (Linux only)"
 	fi
-], [])
+])
+if test "x$with_libiptc" = "xyes"
+then
+	AC_CHECK_LIB(iptc, iptc_init,
+	[
+		AC_DEFINE(HAVE_LIBIPTC, 1, [Define to 1 if you have the iptc library (-liptc).])
+	], [with_libiptc="no (libiptc not found)"])
+fi
+if test "x$with_libiptc" = "xyes"
+then
+	AC_CHECK_HEADERS(libiptc/libiptc.h,
+	[
+		AC_DEFINE(HAVE_LIBIPTC_LIBIPTC_H, 1, [Define to 1 if you have the <libiptc/libiptc.h> header file.])
+	], [with_libiptc="no (libiptc/libiptc.h not found)"])
+fi
+if test "x$with_libiptc" = "xyes"
+then
+	collect_libiptc=1
+else
+	collect_libiptc=0
+fi
+AM_CONDITIONAL(BUILD_WITH_LIBIPTC, test "x$with_libiptc" = "xyes")
 
-if test $collectd_step -ne 10
+AC_ARG_WITH(libupsclient, [AS_HELP_STRING([--with-libupsclient@<:@=PREFIX@:>@], [Path to libupsclient.])],
+[
+	if test "x$withval" != "xno" && test "x$withval" != "xyes"
+	then
+		LDFLAGS="$LDFLAGS -L$withval/lib"
+		CPPFLAGS="$CPPFLAGS -I$withval/include"
+		with_libupsclient="yes"
+	fi
+],
+[
+	with_libupsclient="yes"
+])
+if test "x$with_libupsclient" = "xyes"
 then
-	AC_DEFINE_UNQUOTED(COLLECTD_STEP, "$collectd_step", [Interval in which plugins are queried.])
+	AC_CHECK_LIB(upsclient, upscli_connect,
+	[
+		AC_DEFINE(HAVE_LIBUPSCLIENT, 1, [Define to 1 if you have the upsclient library (-lupsclient).])
+	], [with_libupsclient="no (libupsclient not found)"])
 fi
-if test $collectd_heartbeat -ne 25
+if test "x$with_libupsclient" = "xyes"
 then
-	AC_DEFINE_UNQUOTED(COLLECTD_HEARTBEAT, "$collectd_heartbeat", [Interval in which plugins are queried.])
+	AC_CHECK_HEADERS(upsclient.h,
+	[
+		AC_DEFINE(HAVE_UPSCLIENT_H, 1, [Define to 1 if you have the <upsclient.h> header file.])
+	], [with_libupsclient="no (upsclient.h not found)"])
 fi
+AM_CONDITIONAL(BUILD_WITH_LIBUPSCLIENT, test "x$with_libupsclient" = "xyes")
 
 # Check for enabled/disabled features
 #
 
 # AC_COLLECTD(name, enable/disable, info-text, feature/module)
 # ------------------------------------------------------------
@@ -1057,83 +1322,113 @@
 AC_COLLECTD([apcups],    [disable], [module], [Statistics of UPSes by APC])
 AC_COLLECTD([apple_sensors], [disable], [module], [Apple's hardware sensors])
 AC_COLLECTD([battery],   [disable], [module], [battery statistics])
 AC_COLLECTD([cpu],       [disable], [module], [cpu usage statistics])
 AC_COLLECTD([cpufreq],   [disable], [module], [system cpu frequency statistics])
 AC_COLLECTD([disk],      [disable], [module], [disk/partition statistics])
+AC_COLLECTD([csv],       [disable], [module], [csv output plugin])
 AC_COLLECTD([df],        [disable], [module], [df statistics])
 AC_COLLECTD([dns],       [disable], [module], [dns statistics])
 AC_COLLECTD([email],     [disable], [module], [email statistics])
-AC_COLLECTD([quota],     [enable],  [module], [quota statistics (experimental)])
+AC_COLLECTD([entropy],   [disable], [module], [entropy statistics])
+AC_COLLECTD([exec],      [disable], [module], [exec of external programs])
 AC_COLLECTD([hddtemp],   [disable], [module], [hdd temperature statistics])
+AC_COLLECTD([interface], [disable], [module], [interface statistics])
+AC_COLLECTD([iptables],  [disable], [module], [IPtables statistics])
+AC_COLLECTD([irq],       [disable], [module], [irq statistics])
 AC_COLLECTD([load],      [disable], [module], [system load statistics])
 AC_COLLECTD([mbmon],     [disable], [module], [motherboard monitor statistics])
 AC_COLLECTD([memory],    [disable], [module], [memory statistics])
 AC_COLLECTD([multimeter],[disable], [module], [multimeter statistics])
 AC_COLLECTD([mysql],     [disable], [module], [mysql statistics])
+AC_COLLECTD([network],   [disable], [module], [network functionality])
 AC_COLLECTD([nfs],       [disable], [module], [nfs statistics])
-AC_COLLECTD([ntpd],      [disable], [module], [nfs statistics])
+AC_COLLECTD([ntpd],      [disable], [module], [ntpd statistics])
+AC_COLLECTD([nut],       [disable], [module], [network UPS tools statistics])
+AC_COLLECTD([perl],      [disable], [module], [embedded perl interpreter])
 AC_COLLECTD([ping],      [disable], [module], [ping statistics])
 AC_COLLECTD([processes], [disable], [module], [processes statistics])
 AC_COLLECTD([sensors],   [disable], [module], [lm_sensors statistics])
 AC_COLLECTD([serial],    [disable], [module], [serial statistics])
+AC_COLLECTD([logfile],   [disable], [module], [logfile log facility])
 AC_COLLECTD([swap],      [disable], [module], [swap statistics])
+AC_COLLECTD([syslog],    [disable], [module], [syslog log facility])
 AC_COLLECTD([tape],      [disable], [module], [tape statistics])
-AC_COLLECTD([traffic],   [disable], [module], [system traffic statistics])
+AC_COLLECTD([unixsock],  [disable], [module], [UNIX socket plugin])
 AC_COLLECTD([users],     [disable], [module], [user count statistics])
 AC_COLLECTD([vserver],   [disable], [module], [vserver statistics])
 AC_COLLECTD([wireless],  [disable], [module], [wireless link statistics])
 
-AC_OUTPUT(Makefile src/Makefile src/collectd.conf src/libconfig/Makefile src/liboping/Makefile)
+AC_OUTPUT(Makefile src/Makefile src/collectd.conf src/liboconfig/Makefile src/liboping/Makefile)
+
+if test "x$with_libperl" = "xyes"
+then
+	with_libperl="yes (version `perl -MConfig -e 'print $Config{version};'`)"
+else
+	enable_perl="no (needs libperl)"
+fi
 
 cat <<EOF;
 
 Configuration:
   Libraries:
     libcurl . . . . . . $with_libcurl
     libiokit  . . . . . $with_libiokit
-    liboping  . . . . . $with_liboping
-    librrd  . . . . . . $with_rrdtool
-    lm_sensors  . . . . $with_lm_sensors
-    libstatgrab . . . . $with_libstatgrab
+    libiptc . . . . . . $with_libiptc
     libkstat  . . . . . $with_kstat
     libmysql  . . . . . $with_libmysql
+    liboconfig  . . . . $with_liboconfig
+    liboping  . . . . . $with_liboping
     libpcap . . . . . . $with_libpcap
+    libperl . . . . . . $with_libperl
     libpthread  . . . . $with_libpthread
+    librrd  . . . . . . $with_rrdtool
+    libsensors  . . . . $with_lm_sensors
+    libstatgrab . . . . $with_libstatgrab
+    libupsclient  . . . $with_libupsclient
 
   Features:
-    debug . . . . . . . $enable_debug
     daemon mode . . . . $enable_daemon
-    step  . . . . . . . $collectd_step seconds
-    heartbeat . . . . . $collectd_heartbeat seconds
+    debug . . . . . . . $enable_debug
 
   Modules:
     apache  . . . . . . $enable_apache
     apcups  . . . . . . $enable_apcups
     apple_sensors . . . $enable_apple_sensors
     battery . . . . . . $enable_battery
     cpu . . . . . . . . $enable_cpu
     cpufreq . . . . . . $enable_cpufreq
+    csv . . . . . . . . $enable_csv
     df  . . . . . . . . $enable_df
     disk  . . . . . . . $enable_disk
     dns . . . . . . . . $enable_dns
     email . . . . . . . $enable_email
+    entropy . . . . . . $enable_entropy
+    exec  . . . . . . . $enable_exec
     hddtemp . . . . . . $enable_hddtemp
+    interface . . . . . $enable_interface
+    iptables  . . . . . $enable_iptables
+    irq . . . . . . . . $enable_irq
     load  . . . . . . . $enable_load
+    logfile . . . . . . $enable_logfile
     mbmon . . . . . . . $enable_mbmon
     memory  . . . . . . $enable_memory
     multimeter  . . . . $enable_multimeter
     mysql . . . . . . . $enable_mysql
+    network . . . . . . $enable_network
     nfs . . . . . . . . $enable_nfs
     ntpd  . . . . . . . $enable_ntpd
+    nut . . . . . . . . $enable_nut
+    perl  . . . . . . . $enable_perl
     ping  . . . . . . . $enable_ping
     processes . . . . . $enable_processes
     sensors . . . . . . $enable_sensors
     serial  . . . . . . $enable_serial
     swap  . . . . . . . $enable_swap
+    syslog  . . . . . . $enable_syslog
     tape  . . . . . . . $enable_tape
-    traffic . . . . . . $enable_traffic
+    unixsock  . . . . . $enable_unixsock
     users . . . . . . . $enable_users
     vserver . . . . . . $enable_vserver
     wireless  . . . . . $enable_wireless
 
 EOF
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib: collectd-snmp.conf
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib/collection.cgi /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib/collection.cgi
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib/collection.cgi	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib/collection.cgi	2007-05-30 18:33:14.000000000 +0800
@@ -1,2216 +1,1947 @@
 #!/usr/bin/perl
 
 use strict;
 use warnings;
 
-no warnings ('qw');
+use Carp (qw(cluck confess));
+use CGI (':cgi');
+use CGI::Carp ('fatalsToBrowser');
+use HTML::Entities ('encode_entities');
+use URI::Escape ('uri_escape');
+use RRDs ();
+use Data::Dumper ();
+
+our $Config = "/etc/collection.conf";
+our @DataDirs = ();
+our $LibDir;
 
-use CGI;
-use RRDs;
-use Fcntl (qw(:flock));
-use Carp (qw(carp cluck confess croak));
-
-our $Config = read_config ();
-
-our $AbsDir;
-our $RelDir;
-our $Type;
-our $Inst;
-our $TimeSpan;
+our @RRDDefaultArgs = ('-w', '800');
 
-for (qw(Red Green Blue Yellow Cyan Magenta))
-{
-	$Config->{'Colors'}{"Half$_"} = color_calculate_transparent ($Config->{'Colors'}{'Alpha'},
-		$Config->{'Colors'}{'Canvas'}, $Config->{'Colors'}{"Full$_"});
-}
-
-$Config->{'Colors'}{'HalfBlueGreen'} = color_calculate_transparent ($Config->{'Colors'}{'Alpha'},
-	$Config->{'Colors'}{'Canvas'}, $Config->{'Colors'}{'FullGreen'}, $Config->{'Colors'}{'FullBlue'});
-$Config->{'Colors'}{'HalfRedBlue'} = color_calculate_transparent ($Config->{'Colors'}{'Alpha'},
-	$Config->{'Colors'}{'Canvas'}, $Config->{'Colors'}{'FullBlue'}, $Config->{'Colors'}{'FullRed'});
+our $Args = {};
 
 our $GraphDefs;
-{
-	my $Alpha  = $Config->{'Colors'}{'Alpha'};
-	my $Canvas = $Config->{'Colors'}{'Canvas'};
-
-	my $FullRed    = $Config->{'Colors'}{'FullRed'};
-	my $FullGreen  = $Config->{'Colors'}{'FullGreen'};
-	my $FullBlue   = $Config->{'Colors'}{'FullBlue'};
-	my $FullYellow = $Config->{'Colors'}{'FullYellow'};
-	my $FullCyan   = $Config->{'Colors'}{'FullCyan'};
-	my $FullMagenta= $Config->{'Colors'}{'FullMagenta'};
-
-	my $HalfRed    = $Config->{'Colors'}{'HalfRed'};
-	my $HalfGreen  = $Config->{'Colors'}{'HalfGreen'};
-	my $HalfBlue   = $Config->{'Colors'}{'HalfBlue'};
-	my $HalfYellow = $Config->{'Colors'}{'HalfYellow'};
-	my $HalfCyan   = $Config->{'Colors'}{'HalfCyan'};
-	my $HalfMagenta= $Config->{'Colors'}{'HalfMagenta'};
-
-	my $HalfBlueGreen = $Config->{'Colors'}{'HalfBlueGreen'};
-	my $HalfRedBlue   = $Config->{'Colors'}{'HalfRedBlue'};
-	
-	$GraphDefs =
-	{
-		apache_bytes => ['DEF:min_raw={file}:count:MIN',
-			'DEF:avg_raw={file}:count:AVERAGE',
-			'DEF:max_raw={file}:count:MAX',
-			'CDEF:min=min_raw,8,*',
-			'CDEF:avg=avg_raw,8,*',
-			'CDEF:max=max_raw,8,*',
-			'CDEF:mytime=avg_raw,TIME,TIME,IF',
-			'CDEF:sample_len_raw=mytime,PREV(mytime),-',
-			'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
-			'CDEF:avg_sample=avg_raw,UN,0,avg_raw,IF,sample_len,*',
-			'CDEF:avg_sum=PREV,UN,0,PREV,IF,avg_sample,+',
-			"AREA:avg#$HalfBlue",
-			"LINE1:avg#$FullBlue:Bit/s",
-			'GPRINT:min:MIN:%5.1lf%s Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:max:MAX:%5.1lf%s Max,',
-			'GPRINT:avg:LAST:%5.1lf%s Last',
-			'GPRINT:avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
-		],
-		apache_requests => ['DEF:min={file}:count:MIN',
-			'DEF:avg={file}:count:AVERAGE',
-			'DEF:max={file}:count:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Requests/s",
-			'GPRINT:min:MIN:%6.2lf Min,',
-			'GPRINT:avg:AVERAGE:%6.2lf Avg,',
-			'GPRINT:max:MAX:%6.2lf Max,',
-			'GPRINT:avg:LAST:%6.2lf Last'
-		],
-		apache_scoreboard => ['DEF:min={file}:count:MIN',
-			'DEF:avg={file}:count:AVERAGE',
-			'DEF:max={file}:count:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Processes",
-			'GPRINT:min:MIN:%6.2lf Min,',
-			'GPRINT:avg:AVERAGE:%6.2lf Avg,',
-			'GPRINT:max:MAX:%6.2lf Max,',
-			'GPRINT:avg:LAST:%6.2lf Last'
-		],
-		charge => [
-			'DEF:avg={file}:charge:AVERAGE',
-			'DEF:min={file}:charge:MIN',
-			'DEF:max={file}:charge:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Charge",
-			'GPRINT:min:MIN:%5.1lf%sAh Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%sAh Avg,',
-			'GPRINT:max:MAX:%5.1lf%sAh Max,',
-			'GPRINT:avg:LAST:%5.1lf%sAh Last\l'
-		],
-		charge_percent => [
-			'DEF:avg={file}:percent:AVERAGE',
-			'DEF:min={file}:percent:MIN',
-			'DEF:max={file}:percent:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Charge",
-			'GPRINT:min:MIN:%5.1lf%s%% Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%s%% Avg,',
-			'GPRINT:max:MAX:%5.1lf%s%% Max,',
-			'GPRINT:avg:LAST:%5.1lf%s%% Last\l'
-		],
-		cpu => ['DEF:user_avg={file}:user:AVERAGE',
-			'DEF:user_min={file}:user:MIN',
-			'DEF:user_max={file}:user:MAX',
-			'DEF:nice_avg={file}:nice:AVERAGE',
-			'DEF:nice_min={file}:nice:MIN',
-			'DEF:nice_max={file}:nice:MAX',
-			'DEF:syst_avg={file}:syst:AVERAGE',
-			'DEF:syst_min={file}:syst:MIN',
-			'DEF:syst_max={file}:syst:MAX',
-			'DEF:idle_avg={file}:idle:AVERAGE',
-			'DEF:idle_min={file}:idle:MIN',
-			'DEF:idle_max={file}:idle:MAX',
-			'DEF:wait_avg={file}:wait:AVERAGE',
-			'DEF:wait_min={file}:wait:MIN',
-			'DEF:wait_max={file}:wait:MAX',
-			'CDEF:user_avg_notnull=user_avg,UN,0,user_avg,IF',
-			'CDEF:nice_avg_notnull=nice_avg,UN,0,nice_avg,IF',
-			'CDEF:syst_avg_notnull=syst_avg,UN,0,syst_avg,IF',
-			'CDEF:idle_avg_notnull=idle_avg,UN,0,idle_avg,IF',
-			'CDEF:wait_avg_notnull=wait_avg,UN,0,wait_avg,IF',
-			'CDEF:totl_avg_notnull=user_avg_notnull,nice_avg_notnull,+,syst_avg_notnull,+,idle_avg_notnull,+,wait_avg_notnull,+',
-			'CDEF:user_avg_pct=user_avg_notnull,100,*,totl_avg_notnull,/',
-			'CDEF:nice_avg_pct=nice_avg_notnull,100,*,totl_avg_notnull,/',
-			'CDEF:syst_avg_pct=syst_avg_notnull,100,*,totl_avg_notnull,/',
-			'CDEF:wait_avg_pct=wait_avg_notnull,100,*,totl_avg_notnull,/',
-			'CDEF:nice_acc=syst_avg_pct,wait_avg_pct,user_avg_pct,nice_avg_pct,+,+,+',
-			'CDEF:user_acc=syst_avg_pct,wait_avg_pct,user_avg_pct,+,+',
-			'CDEF:wait_acc=syst_avg_pct,wait_avg_pct,+',
-			'CDEF:syst_acc=syst_avg_pct',
-#			'CDEF:nice_acc=syst_avg_notnull,wait_avg_notnull,user_avg_notnull,nice_avg_notnull,+,+,+',
-#			'CDEF:user_acc=syst_avg_notnull,wait_avg_notnull,user_avg_notnull,+,+',
-#			'CDEF:wait_acc=syst_avg_notnull,wait_avg_notnull,+',
-#			'CDEF:syst_acc=syst_avg_notnull',
-			"AREA:nice_acc#$HalfGreen",
-			"AREA:user_acc#$HalfBlue",
-			"AREA:wait_acc#$HalfYellow",
-			"AREA:syst_acc#$HalfRed",
-			"LINE1:nice_acc#$FullGreen:Nice   ",
-			'GPRINT:nice_min:MIN:%5.1lf%% Min,',
-			'GPRINT:nice_avg:AVERAGE:%5.1lf%% Avg,',
-			'GPRINT:nice_max:MAX:%5.1lf%% Max,',
-			'GPRINT:nice_avg:LAST:%5.1lf%% Last\l',
-			"LINE1:user_acc#$FullBlue:User   ",
-			'GPRINT:user_min:MIN:%5.1lf%% Min,',
-			'GPRINT:user_avg:AVERAGE:%5.1lf%% Avg,',
-			'GPRINT:user_max:MAX:%5.1lf%% Max,',
-			'GPRINT:user_avg:LAST:%5.1lf%% Last\l',
-			"LINE1:wait_acc#$FullYellow:Wait-IO",
-			'GPRINT:wait_min:MIN:%5.1lf%% Min,',
-			'GPRINT:wait_avg:AVERAGE:%5.1lf%% Avg,',
-			'GPRINT:wait_max:MAX:%5.1lf%% Max,',
-			'GPRINT:wait_avg:LAST:%5.1lf%% Last\l',
-			"LINE1:syst_acc#$FullRed:System ",
-			'GPRINT:syst_min:MIN:%5.1lf%% Min,',
-			'GPRINT:syst_avg:AVERAGE:%5.1lf%% Avg,',
-			'GPRINT:syst_max:MAX:%5.1lf%% Max,',
-			'GPRINT:syst_avg:LAST:%5.1lf%% Last\l'
-		],
-		current => [
-			'DEF:avg={file}:current:AVERAGE',
-			'DEF:min={file}:current:MIN',
-			'DEF:max={file}:current:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Current",
-			'GPRINT:min:MIN:%5.1lf%sA Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%sA Avg,',
-			'GPRINT:max:MAX:%5.1lf%sA Max,',
-			'GPRINT:avg:LAST:%5.1lf%sA Last\l'
-		],
-		df => [
-			'DEF:free_avg={file}:free:AVERAGE',
-			'DEF:free_min={file}:free:MIN',
-			'DEF:free_max={file}:free:MAX',
-			'DEF:used_avg={file}:used:AVERAGE',
-			'DEF:used_min={file}:used:MIN',
-			'DEF:used_max={file}:used:MAX',
-			'CDEF:total=free_avg,used_avg,+',
-			'CDEF:free_pct=100,free_avg,*,total,/',
-			'CDEF:used_pct=100,used_avg,*,total,/',
-			'CDEF:free_acc=free_pct,used_pct,+',
-			'CDEF:used_acc=used_pct',
-			"AREA:free_acc#$HalfGreen",
-			"AREA:used_acc#$HalfRed",
-			"LINE1:free_acc#$FullGreen:Free",
-			'GPRINT:free_min:MIN:%5.1lf%sB Min,',
-			'GPRINT:free_avg:AVERAGE:%5.1lf%sB Avg,',
-			'GPRINT:free_max:MAX:%5.1lf%sB Max,',
-			'GPRINT:free_avg:LAST:%5.1lf%sB Last\l',
-			"LINE1:used_acc#$FullRed:Used",
-			'GPRINT:used_min:MIN:%5.1lf%sB Min,',
-			'GPRINT:used_avg:AVERAGE:%5.1lf%sB Avg,',
-			'GPRINT:used_max:MAX:%5.1lf%sB Max,',
-			'GPRINT:used_avg:LAST:%5.1lf%sB Last\l'
-		],
-		disk => [
-			'DEF:rtime_avg={file}:rtime:AVERAGE',
-			'DEF:rtime_min={file}:rtime:MIN',
-			'DEF:rtime_max={file}:rtime:MAX',
-			'DEF:wtime_avg={file}:wtime:AVERAGE',
-			'DEF:wtime_min={file}:wtime:MIN',
-			'DEF:wtime_max={file}:wtime:MAX',
-			'CDEF:rtime_avg_ms=rtime_avg,1000,/',
-			'CDEF:rtime_min_ms=rtime_min,1000,/',
-			'CDEF:rtime_max_ms=rtime_max,1000,/',
-			'CDEF:wtime_avg_ms=wtime_avg,1000,/',
-			'CDEF:wtime_min_ms=wtime_min,1000,/',
-			'CDEF:wtime_max_ms=wtime_max,1000,/',
-			'CDEF:total_avg_ms=rtime_avg_ms,wtime_avg_ms,+',
-			'CDEF:total_min_ms=rtime_min_ms,wtime_min_ms,+',
-			'CDEF:total_max_ms=rtime_max_ms,wtime_max_ms,+',
-			"AREA:total_max_ms#$HalfRed",
-			"AREA:total_min_ms#$Canvas",
-			"LINE1:wtime_avg_ms#$FullGreen:Write",
-			'GPRINT:wtime_min_ms:MIN:%5.1lf%s Min,',
-			'GPRINT:wtime_avg_ms:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:wtime_max_ms:MAX:%5.1lf%s Max,',
-			'GPRINT:wtime_avg_ms:LAST:%5.1lf%s Last\n',
-			"LINE1:rtime_avg_ms#$FullBlue:Read ",
-			'GPRINT:rtime_min_ms:MIN:%5.1lf%s Min,',
-			'GPRINT:rtime_avg_ms:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:rtime_max_ms:MAX:%5.1lf%s Max,',
-			'GPRINT:rtime_avg_ms:LAST:%5.1lf%s Last\n',
-			"LINE1:total_avg_ms#$FullRed:Total",
-			'GPRINT:total_min_ms:MIN:%5.1lf%s Min,',
-			'GPRINT:total_avg_ms:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:total_max_ms:MAX:%5.1lf%s Max,',
-			'GPRINT:total_avg_ms:LAST:%5.1lf%s Last'
-		],
-		dns_traffic => ['DEF:rsp_min_raw={file}:responses:MIN',
-			'DEF:rsp_avg_raw={file}:responses:AVERAGE',
-			'DEF:rsp_max_raw={file}:responses:MAX',
-			'DEF:qry_min_raw={file}:queries:MIN',
-			'DEF:qry_avg_raw={file}:queries:AVERAGE',
-			'DEF:qry_max_raw={file}:queries:MAX',
-			'CDEF:rsp_min=rsp_min_raw,8,*',
-			'CDEF:rsp_avg=rsp_avg_raw,8,*',
-			'CDEF:rsp_max=rsp_max_raw,8,*',
-			'CDEF:qry_min=qry_min_raw,8,*',
-			'CDEF:qry_avg=qry_avg_raw,8,*',
-			'CDEF:qry_max=qry_max_raw,8,*',
-			'CDEF:overlap=rsp_avg,qry_avg,GT,qry_avg,rsp_avg,IF',
-			'CDEF:mytime=rsp_avg_raw,TIME,TIME,IF',
-			'CDEF:sample_len_raw=mytime,PREV(mytime),-',
-			'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
-			'CDEF:rsp_avg_sample=rsp_avg_raw,UN,0,rsp_avg_raw,IF,sample_len,*',
-			'CDEF:rsp_avg_sum=PREV,UN,0,PREV,IF,rsp_avg_sample,+',
-			'CDEF:qry_avg_sample=qry_avg_raw,UN,0,qry_avg_raw,IF,sample_len,*',
-			'CDEF:qry_avg_sum=PREV,UN,0,PREV,IF,qry_avg_sample,+',
-			"AREA:rsp_avg#$HalfGreen",
-			"AREA:qry_avg#$HalfBlue",
-			"AREA:overlap#$HalfBlueGreen",
-			"LINE1:rsp_avg#$FullGreen:Responses",
-			'GPRINT:rsp_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:rsp_max:MAX:%5.1lf%s Max,',
-			'GPRINT:rsp_avg:LAST:%5.1lf%s Last',
-			'GPRINT:rsp_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
-			"LINE1:qry_avg#$FullBlue:Queries  ",
-			#'GPRINT:qry_min:MIN:%5.1lf %s Min,',
-			'GPRINT:qry_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:qry_max:MAX:%5.1lf%s Max,',
-			'GPRINT:qry_avg:LAST:%5.1lf%s Last',
-			'GPRINT:qry_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
-		],
-		email => [
-			'DEF:avg={file}:count:AVERAGE',
-			'DEF:min={file}:count:MIN',
-			'DEF:max={file}:count:MAX',
-			"AREA:max#$HalfMagenta",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullMagenta:Count ",
-			'GPRINT:min:MIN:%4.1lf Min,',
-			'GPRINT:avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:max:MAX:%4.1lf Max,',
-			'GPRINT:avg:LAST:%4.1lf Last\l'
-		],
-		email_size => [
-			'DEF:avg={file}:size:AVERAGE',
-			'DEF:min={file}:size:MIN',
-			'DEF:max={file}:size:MAX',
-			"AREA:max#$HalfMagenta",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullMagenta:Count ",
-			'GPRINT:min:MIN:%4.1lf Min,',
-			'GPRINT:avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:max:MAX:%4.1lf Max,',
-			'GPRINT:avg:LAST:%4.1lf Last\l'
-		],
-		spam_score => [
-			'DEF:avg={file}:score:AVERAGE',
-			'DEF:min={file}:score:MIN',
-			'DEF:max={file}:score:MAX',
-			"AREA:max#$HalfMagenta",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullMagenta:Count ",
-			'GPRINT:min:MIN:%4.1lf Min,',
-			'GPRINT:avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:max:MAX:%4.1lf Max,',
-			'GPRINT:avg:LAST:%4.1lf Last\l'
-		],
-		spam_check => [
-			'DEF:avg={file}:hits:AVERAGE',
-			'DEF:min={file}:hits:MIN',
-			'DEF:max={file}:hits:MAX',
-			"AREA:max#$HalfMagenta",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullMagenta:Count ",
-			'GPRINT:min:MIN:%4.1lf Min,',
-			'GPRINT:avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:max:MAX:%4.1lf Max,',
-			'GPRINT:avg:LAST:%4.1lf Last\l'
-		],
-		fanspeed => [
-			'DEF:temp_avg={file}:value:AVERAGE',
-			'DEF:temp_min={file}:value:MIN',
-			'DEF:temp_max={file}:value:MAX',
-			"AREA:temp_max#$HalfMagenta",
-			"AREA:temp_min#$Canvas",
-			"LINE1:temp_avg#$FullMagenta:RPM",
-			'GPRINT:temp_min:MIN:%4.1lf Min,',
-			'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:temp_max:MAX:%4.1lf Max,',
-			'GPRINT:temp_avg:LAST:%4.1lf Last\l'
-		],
-		frequency_offset => [ # NTPd
-			'DEF:ppm_avg={file}:ppm:AVERAGE',
-			'DEF:ppm_min={file}:ppm:MIN',
-			'DEF:ppm_max={file}:ppm:MAX',
-			"AREA:ppm_max#$HalfBlue",
-			"AREA:ppm_min#$Canvas",
-			"LINE1:ppm_avg#$FullBlue:{inst}",
-			'GPRINT:ppm_min:MIN:%5.2lf Min,',
-			'GPRINT:ppm_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:ppm_max:MAX:%5.2lf Max,',
-			'GPRINT:ppm_avg:LAST:%5.2lf Last'
-		],
-		hddtemp => [
-			'DEF:temp_avg={file}:value:AVERAGE',
-			'DEF:temp_min={file}:value:MIN',
-			'DEF:temp_max={file}:value:MAX',
-			"AREA:temp_max#$HalfRed",
-			"AREA:temp_min#$Canvas",
-			"LINE1:temp_avg#$FullRed:Temperature",
-			'GPRINT:temp_min:MIN:%4.1lf Min,',
-			'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:temp_max:MAX:%4.1lf Max,',
-			'GPRINT:temp_avg:LAST:%4.1lf Last\l'
-		],
-		if_packets => ['DEF:tx_min={file}:tx:MIN',
-			'DEF:tx_avg={file}:tx:AVERAGE',
-			'DEF:tx_max={file}:tx:MAX',
-			'DEF:rx_min={file}:rx:MIN',
-			'DEF:rx_avg={file}:rx:AVERAGE',
-			'DEF:rx_max={file}:rx:MAX',
-			'CDEF:overlap=tx_avg,rx_avg,GT,rx_avg,tx_avg,IF',
-			'CDEF:mytime=tx_avg,TIME,TIME,IF',
-			'CDEF:sample_len_raw=mytime,PREV(mytime),-',
-			'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
-			'CDEF:tx_avg_sample=tx_avg,UN,0,tx_avg,IF,sample_len,*',
-			'CDEF:tx_avg_sum=PREV,UN,0,PREV,IF,tx_avg_sample,+',
-			'CDEF:rx_avg_sample=rx_avg,UN,0,rx_avg,IF,sample_len,*',
-			'CDEF:rx_avg_sum=PREV,UN,0,PREV,IF,rx_avg_sample,+',
-			"AREA:tx_avg#$HalfGreen",
-			"AREA:rx_avg#$HalfBlue",
-			"AREA:overlap#$HalfBlueGreen",
-			"LINE1:tx_avg#$FullGreen:TX",
-			'GPRINT:tx_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:tx_max:MAX:%5.1lf%s Max,',
-			'GPRINT:tx_avg:LAST:%5.1lf%s Last',
-			'GPRINT:tx_avg_sum:LAST:(ca. %4.0lf%s Total)\l',
-			"LINE1:rx_avg#$FullBlue:RX",
-			#'GPRINT:rx_min:MIN:%5.1lf %s Min,',
-			'GPRINT:rx_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:rx_max:MAX:%5.1lf%s Max,',
-			'GPRINT:rx_avg:LAST:%5.1lf%s Last',
-			'GPRINT:rx_avg_sum:LAST:(ca. %4.0lf%s Total)\l'
-		],
-		load => ['DEF:s_avg={file}:shortterm:AVERAGE',
-			'DEF:s_min={file}:shortterm:MIN',
-			'DEF:s_max={file}:shortterm:MAX',
-			'DEF:m_avg={file}:midterm:AVERAGE',
-			'DEF:m_min={file}:midterm:MIN',
-			'DEF:m_max={file}:midterm:MAX',
-			'DEF:l_avg={file}:longterm:AVERAGE',
-			'DEF:l_min={file}:longterm:MIN',
-			'DEF:l_max={file}:longterm:MAX',
-			"AREA:s_max#$HalfGreen",
-			"AREA:s_min#$Canvas",
-			"LINE1:s_avg#$FullGreen: 1m average",
-			'GPRINT:s_min:MIN:%4.2lf Min,',
-			'GPRINT:s_avg:AVERAGE:%4.2lf Avg,',
-			'GPRINT:s_max:MAX:%4.2lf Max,',
-			'GPRINT:s_avg:LAST:%4.2lf Last\n',
-			"LINE1:m_avg#$FullBlue: 5m average",
-			'GPRINT:m_min:MIN:%4.2lf Min,',
-			'GPRINT:m_avg:AVERAGE:%4.2lf Avg,',
-			'GPRINT:m_max:MAX:%4.2lf Max,',
-			'GPRINT:m_avg:LAST:%4.2lf Last\n',
-			"LINE1:l_avg#$FullRed:15m average",
-			'GPRINT:l_min:MIN:%4.2lf Min,',
-			'GPRINT:l_avg:AVERAGE:%4.2lf Avg,',
-			'GPRINT:l_max:MAX:%4.2lf Max,',
-			'GPRINT:l_avg:LAST:%4.2lf Last'
-		],
-		load_percent => [
-			'DEF:avg={file}:percent:AVERAGE',
-			'DEF:min={file}:percent:MIN',
-			'DEF:max={file}:percent:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Load",
-			'GPRINT:min:MIN:%5.1lf%s%% Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%s%% Avg,',
-			'GPRINT:max:MAX:%5.1lf%s%% Max,',
-			'GPRINT:avg:LAST:%5.1lf%s%% Last\l'
-		],
-		mails => ['DEF:rawgood={file}:good:AVERAGE',
-			'DEF:rawspam={file}:spam:AVERAGE',
-			'CDEF:good=rawgood,UN,0,rawgood,IF',
-			'CDEF:spam=rawspam,UN,0,rawspam,IF',
-			'CDEF:negspam=spam,-1,*',
-			"AREA:good#$HalfGreen",
-			"LINE1:good#$FullGreen:Good mails",
-			'GPRINT:good:AVERAGE:%4.1lf Avg,',
-			'GPRINT:good:MAX:%4.1lf Max,',
-			'GPRINT:good:LAST:%4.1lf Last\n',
-			"AREA:negspam#$HalfRed",
-			"LINE1:negspam#$FullRed:Spam mails",
-			'GPRINT:spam:AVERAGE:%4.1lf Avg,',
-			'GPRINT:spam:MAX:%4.1lf Max,',
-			'GPRINT:spam:LAST:%4.1lf Last',
-			'HRULE:0#000000'],
-		memory => [
-			'DEF:used_avg={file}:used:AVERAGE',
-			'DEF:free_avg={file}:free:AVERAGE',
-			'DEF:buffers_avg={file}:buffers:AVERAGE',
-			'DEF:cached_avg={file}:cached:AVERAGE',
-			'DEF:used_min={file}:used:MIN',
-			'DEF:free_min={file}:free:MIN',
-			'DEF:buffers_min={file}:buffers:MIN',
-			'DEF:cached_min={file}:cached:MIN',
-			'DEF:used_max={file}:used:MAX',
-			'DEF:free_max={file}:free:MAX',
-			'DEF:buffers_max={file}:buffers:MAX',
-			'DEF:cached_max={file}:cached:MAX',
-			'CDEF:cached_avg_nn=cached_avg,UN,0,cached_avg,IF',
-			'CDEF:buffers_avg_nn=buffers_avg,UN,0,buffers_avg,IF',
-			'CDEF:free_cached_buffers_used=free_avg,cached_avg_nn,+,buffers_avg_nn,+,used_avg,+',
-			'CDEF:cached_buffers_used=cached_avg,buffers_avg_nn,+,used_avg,+',
-			'CDEF:buffers_used=buffers_avg,used_avg,+',
-			"AREA:free_cached_buffers_used#$HalfGreen",
-			"AREA:cached_buffers_used#$HalfBlue",
-			"AREA:buffers_used#$HalfYellow",
-			"AREA:used_avg#$HalfRed",
-			"LINE1:free_cached_buffers_used#$FullGreen:Free        ",
-			'GPRINT:free_min:MIN:%5.1lf%s Min,',
-			'GPRINT:free_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:free_max:MAX:%5.1lf%s Max,',
-			'GPRINT:free_avg:LAST:%5.1lf%s Last\n',
-			"LINE1:cached_buffers_used#$FullBlue:Page cache  ",
-			'GPRINT:cached_min:MIN:%5.1lf%s Min,',
-			'GPRINT:cached_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:cached_max:MAX:%5.1lf%s Max,',
-			'GPRINT:cached_avg:LAST:%5.1lf%s Last\n',
-			"LINE1:buffers_used#$FullYellow:Buffer cache",
-			'GPRINT:buffers_min:MIN:%5.1lf%s Min,',
-			'GPRINT:buffers_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:buffers_max:MAX:%5.1lf%s Max,',
-			'GPRINT:buffers_avg:LAST:%5.1lf%s Last\n',
-			"LINE1:used_avg#$FullRed:Used        ",
-			'GPRINT:used_min:MIN:%5.1lf%s Min,',
-			'GPRINT:used_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:used_max:MAX:%5.1lf%s Max,',
-			'GPRINT:used_avg:LAST:%5.1lf%s Last'
-		],
-		mysql_commands => [
-			"DEF:val_avg={file}:value:AVERAGE",
-			"DEF:val_min={file}:value:MIN",
-			"DEF:val_max={file}:value:MAX",
-			"AREA:val_max#$HalfBlue",
-			"AREA:val_min#$Canvas",
-			"LINE1:val_avg#$FullBlue:{inst}",
-			'GPRINT:val_min:MIN:%5.2lf Min,',
-			'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:val_max:MAX:%5.2lf Max,',
-			'GPRINT:val_avg:LAST:%5.2lf Last'
-		],
-		mysql_handler => [
-			"DEF:val_avg={file}:value:AVERAGE",
-			"DEF:val_min={file}:value:MIN",
-			"DEF:val_max={file}:value:MAX",
-			"AREA:val_max#$HalfBlue",
-			"AREA:val_min#$Canvas",
-			"LINE1:val_avg#$FullBlue:{inst}",
-			'GPRINT:val_min:MIN:%5.2lf Min,',
-			'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:val_max:MAX:%5.2lf Max,',
-			'GPRINT:val_avg:LAST:%5.2lf Last'
-		],
-		mysql_qcache => [
-			"DEF:hits_min={file}:hits:MIN",
-			"DEF:hits_avg={file}:hits:AVERAGE",
-			"DEF:hits_max={file}:hits:MAX",
-			"DEF:inserts_min={file}:inserts:MIN",
-			"DEF:inserts_avg={file}:inserts:AVERAGE",
-			"DEF:inserts_max={file}:inserts:MAX",
-			"DEF:not_cached_min={file}:not_cached:MIN",
-			"DEF:not_cached_avg={file}:not_cached:AVERAGE",
-			"DEF:not_cached_max={file}:not_cached:MAX",
-			"DEF:lowmem_prunes_min={file}:lowmem_prunes:MIN",
-			"DEF:lowmem_prunes_avg={file}:lowmem_prunes:AVERAGE",
-			"DEF:lowmem_prunes_max={file}:lowmem_prunes:MAX",
-			"DEF:queries_min={file}:queries_in_cache:MIN",
-			"DEF:queries_avg={file}:queries_in_cache:AVERAGE",
-			"DEF:queries_max={file}:queries_in_cache:MAX",
-			"CDEF:unknown=queries_avg,UNKN,+",
-			"CDEF:not_cached_agg=hits_avg,inserts_avg,+,not_cached_avg,+",
-			"CDEF:inserts_agg=hits_avg,inserts_avg,+",
-			"CDEF:hits_agg=hits_avg",
-			"AREA:not_cached_agg#$HalfYellow",
-			"AREA:inserts_agg#$HalfBlue",
-			"AREA:hits_agg#$HalfGreen",
-			"LINE1:not_cached_agg#$FullYellow:Not Cached      ",
-			'GPRINT:not_cached_min:MIN:%5.2lf Min,',
-			'GPRINT:not_cached_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:not_cached_max:MAX:%5.2lf Max,',
-			'GPRINT:not_cached_avg:LAST:%5.2lf Last\l',
-			"LINE1:inserts_agg#$FullBlue:Inserts         ",
-			'GPRINT:inserts_min:MIN:%5.2lf Min,',
-			'GPRINT:inserts_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:inserts_max:MAX:%5.2lf Max,',
-			'GPRINT:inserts_avg:LAST:%5.2lf Last\l',
-			"LINE1:hits_agg#$FullGreen:Hits            ",
-			'GPRINT:hits_min:MIN:%5.2lf Min,',
-			'GPRINT:hits_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:hits_max:MAX:%5.2lf Max,',
-			'GPRINT:hits_avg:LAST:%5.2lf Last\l',
-			"LINE1:lowmem_prunes_avg#$FullRed:Lowmem Prunes   ",
-			'GPRINT:lowmem_prunes_min:MIN:%5.2lf Min,',
-			'GPRINT:lowmem_prunes_avg:AVERAGE:%5.2lf Avg,',
-			'GPRINT:lowmem_prunes_max:MAX:%5.2lf Max,',
-			'GPRINT:lowmem_prunes_avg:LAST:%5.2lf Last\l',
-			"LINE1:unknown#$Canvas:Queries in cache",
-			'GPRINT:queries_min:MIN:%5.0lf Min,',
-			'GPRINT:queries_avg:AVERAGE:%5.0lf Avg,',
-			'GPRINT:queries_max:MAX:%5.0lf Max,',
-			'GPRINT:queries_avg:LAST:%5.0lf Last\l'
-		],
-		mysql_threads => [
-			"DEF:running_min={file}:running:MIN",
-			"DEF:running_avg={file}:running:AVERAGE",
-			"DEF:running_max={file}:running:MAX",
-			"DEF:connected_min={file}:connected:MIN",
-			"DEF:connected_avg={file}:connected:AVERAGE",
-			"DEF:connected_max={file}:connected:MAX",
-			"DEF:cached_min={file}:cached:MIN",
-			"DEF:cached_avg={file}:cached:AVERAGE",
-			"DEF:cached_max={file}:cached:MAX",
-			"DEF:created_min={file}:created:MIN",
-			"DEF:created_avg={file}:created:AVERAGE",
-			"DEF:created_max={file}:created:MAX",
-			"CDEF:unknown=created_avg,UNKN,+",
-			"CDEF:cached_agg=connected_avg,cached_avg,+",
-			"AREA:cached_agg#$HalfGreen",
-			"AREA:connected_avg#$HalfBlue",
-			"AREA:running_avg#$HalfRed",
-			"LINE1:cached_agg#$FullGreen:Cached   ",
-			'GPRINT:cached_min:MIN:%5.1lf Min,',
-			'GPRINT:cached_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:cached_max:MAX:%5.1lf Max,',
-			'GPRINT:cached_avg:LAST:%5.1lf Last\l',
-			"LINE1:connected_avg#$FullBlue:Connected",
-			'GPRINT:connected_min:MIN:%5.1lf Min,',
-			'GPRINT:connected_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:connected_max:MAX:%5.1lf Max,',
-			'GPRINT:connected_avg:LAST:%5.1lf Last\l',
-			"LINE1:running_avg#$FullRed:Running  ",
-			'GPRINT:running_min:MIN:%5.1lf Min,',
-			'GPRINT:running_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:running_max:MAX:%5.1lf Max,',
-			'GPRINT:running_avg:LAST:%5.1lf Last\l',
-			"LINE1:unknown#$Canvas:Created  ",
-			'GPRINT:created_min:MIN:%5.0lf Min,',
-			'GPRINT:created_avg:AVERAGE:%5.0lf Avg,',
-			'GPRINT:created_max:MAX:%5.0lf Max,',
-			'GPRINT:created_avg:LAST:%5.0lf Last\l'
-		],
-		nfs3_procedures => [
-			"DEF:null_avg={file}:null:AVERAGE",
-			"DEF:getattr_avg={file}:getattr:AVERAGE",
-			"DEF:setattr_avg={file}:setattr:AVERAGE",
-			"DEF:lookup_avg={file}:lookup:AVERAGE",
-			"DEF:access_avg={file}:access:AVERAGE",
-			"DEF:readlink_avg={file}:readlink:AVERAGE",
-			"DEF:read_avg={file}:read:AVERAGE",
-			"DEF:write_avg={file}:write:AVERAGE",
-			"DEF:create_avg={file}:create:AVERAGE",
-			"DEF:mkdir_avg={file}:mkdir:AVERAGE",
-			"DEF:symlink_avg={file}:symlink:AVERAGE",
-			"DEF:mknod_avg={file}:mknod:AVERAGE",
-			"DEF:remove_avg={file}:remove:AVERAGE",
-			"DEF:rmdir_avg={file}:rmdir:AVERAGE",
-			"DEF:rename_avg={file}:rename:AVERAGE",
-			"DEF:link_avg={file}:link:AVERAGE",
-			"DEF:readdir_avg={file}:readdir:AVERAGE",
-			"DEF:readdirplus_avg={file}:readdirplus:AVERAGE",
-			"DEF:fsstat_avg={file}:fsstat:AVERAGE",
-			"DEF:fsinfo_avg={file}:fsinfo:AVERAGE",
-			"DEF:pathconf_avg={file}:pathconf:AVERAGE",
-			"DEF:commit_avg={file}:commit:AVERAGE",
-			"DEF:null_max={file}:null:MAX",
-			"DEF:getattr_max={file}:getattr:MAX",
-			"DEF:setattr_max={file}:setattr:MAX",
-			"DEF:lookup_max={file}:lookup:MAX",
-			"DEF:access_max={file}:access:MAX",
-			"DEF:readlink_max={file}:readlink:MAX",
-			"DEF:read_max={file}:read:MAX",
-			"DEF:write_max={file}:write:MAX",
-			"DEF:create_max={file}:create:MAX",
-			"DEF:mkdir_max={file}:mkdir:MAX",
-			"DEF:symlink_max={file}:symlink:MAX",
-			"DEF:mknod_max={file}:mknod:MAX",
-			"DEF:remove_max={file}:remove:MAX",
-			"DEF:rmdir_max={file}:rmdir:MAX",
-			"DEF:rename_max={file}:rename:MAX",
-			"DEF:link_max={file}:link:MAX",
-			"DEF:readdir_max={file}:readdir:MAX",
-			"DEF:readdirplus_max={file}:readdirplus:MAX",
-			"DEF:fsstat_max={file}:fsstat:MAX",
-			"DEF:fsinfo_max={file}:fsinfo:MAX",
-			"DEF:pathconf_max={file}:pathconf:MAX",
-			"DEF:commit_max={file}:commit:MAX",
-			"CDEF:other_avg=null_avg,readlink_avg,create_avg,mkdir_avg,symlink_avg,mknod_avg,remove_avg,rmdir_avg,rename_avg,link_avg,readdir_avg,readdirplus_avg,fsstat_avg,fsinfo_avg,pathconf_avg,+,+,+,+,+,+,+,+,+,+,+,+,+,+",
-			"CDEF:other_max=null_max,readlink_max,create_max,mkdir_max,symlink_max,mknod_max,remove_max,rmdir_max,rename_max,link_max,readdir_max,readdirplus_max,fsstat_max,fsinfo_max,pathconf_max,+,+,+,+,+,+,+,+,+,+,+,+,+,+",
-			"CDEF:stack_read=read_avg",
-			"CDEF:stack_getattr=stack_read,getattr_avg,+",
-			"CDEF:stack_access=stack_getattr,access_avg,+",
-			"CDEF:stack_lookup=stack_access,lookup_avg,+",
-			"CDEF:stack_write=stack_lookup,write_avg,+",
-			"CDEF:stack_commit=stack_write,commit_avg,+",
-			"CDEF:stack_setattr=stack_commit,setattr_avg,+",
-			"CDEF:stack_other=stack_setattr,other_avg,+",
-			"AREA:stack_other#$HalfRed",
-			"AREA:stack_setattr#$HalfGreen",
-			"AREA:stack_commit#$HalfYellow",
-			"AREA:stack_write#$HalfGreen",
-			"AREA:stack_lookup#$HalfBlue",
-			"AREA:stack_access#$HalfMagenta",
-			"AREA:stack_getattr#$HalfCyan",
-			"AREA:stack_read#$HalfBlue",
-			"LINE1:stack_other#$FullRed:Other  ",
-			'GPRINT:other_max:MAX:%5.1lf Max,',
-			'GPRINT:other_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:other_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_setattr#$FullGreen:setattr",
-			'GPRINT:setattr_max:MAX:%5.1lf Max,',
-			'GPRINT:setattr_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:setattr_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_commit#$FullYellow:commit ",
-			'GPRINT:commit_max:MAX:%5.1lf Max,',
-			'GPRINT:commit_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:commit_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_write#$FullGreen:write  ",
-			'GPRINT:write_max:MAX:%5.1lf Max,',
-			'GPRINT:write_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:write_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_lookup#$FullBlue:lookup ",
-			'GPRINT:lookup_max:MAX:%5.1lf Max,',
-			'GPRINT:lookup_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:lookup_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_access#$FullMagenta:access ",
-			'GPRINT:access_max:MAX:%5.1lf Max,',
-			'GPRINT:access_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:access_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_getattr#$FullCyan:getattr",
-			'GPRINT:getattr_max:MAX:%5.1lf Max,',
-			'GPRINT:getattr_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:getattr_avg:LAST:%5.1lf Last\l',
-			"LINE1:stack_read#$FullBlue:read   ",
-			'GPRINT:read_max:MAX:%5.1lf Max,',
-			'GPRINT:read_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:read_avg:LAST:%5.1lf Last\l'
-		],
-		opcode => [
-			'DEF:avg={file}:value:AVERAGE',
-			'DEF:min={file}:value:MIN',
-			'DEF:max={file}:value:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Queries/s",
-			'GPRINT:min:MIN:%9.3lf Min,',
-			'GPRINT:avg:AVERAGE:%9.3lf Average,',
-			'GPRINT:max:MAX:%9.3lf Max,',
-			'GPRINT:avg:LAST:%9.3lf Last\l'
-		],
-		partition => [
-			"DEF:rbyte_avg={file}:rbytes:AVERAGE",
-			"DEF:rbyte_min={file}:rbytes:MIN",
-			"DEF:rbyte_max={file}:rbytes:MAX",
-			"DEF:wbyte_avg={file}:wbytes:AVERAGE",
-			"DEF:wbyte_min={file}:wbytes:MIN",
-			"DEF:wbyte_max={file}:wbytes:MAX",
-			'CDEF:overlap=wbyte_avg,rbyte_avg,GT,rbyte_avg,wbyte_avg,IF',
-			"AREA:wbyte_avg#$HalfGreen",
-			"AREA:rbyte_avg#$HalfBlue",
-			"AREA:overlap#$HalfBlueGreen",
-			"LINE1:wbyte_avg#$FullGreen:Write",
-			'GPRINT:wbyte_min:MIN:%5.1lf%s Min,',
-			'GPRINT:wbyte_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:wbyte_max:MAX:%5.1lf%s Max,',
-			'GPRINT:wbyte_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:rbyte_avg#$FullBlue:Read ",
-			'GPRINT:rbyte_min:MIN:%5.1lf%s Min,',
-			'GPRINT:rbyte_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:rbyte_max:MAX:%5.1lf%s Max,',
-			'GPRINT:rbyte_avg:LAST:%5.1lf%s Last\l'
-		],
-		ping => ['DEF:ping_avg={file}:ping:AVERAGE',
-			'DEF:ping_min={file}:ping:MIN',
-			'DEF:ping_max={file}:ping:MAX',
-			"AREA:ping_max#$HalfBlue",
-			"AREA:ping_min#$Canvas",
-			"LINE1:ping_avg#$FullBlue:Ping",
-			'GPRINT:ping_min:MIN:%4.1lf ms Min,',
-			'GPRINT:ping_avg:AVERAGE:%4.1lf ms Avg,',
-			'GPRINT:ping_max:MAX:%4.1lf ms Max,',
-			'GPRINT:ping_avg:LAST:%4.1lf ms Last'],
-		processes => [
-			"DEF:running_avg={file}:running:AVERAGE",
-			"DEF:running_min={file}:running:MIN",
-			"DEF:running_max={file}:running:MAX",
-			"DEF:sleeping_avg={file}:sleeping:AVERAGE",
-			"DEF:sleeping_min={file}:sleeping:MIN",
-			"DEF:sleeping_max={file}:sleeping:MAX",
-			"DEF:zombies_avg={file}:zombies:AVERAGE",
-			"DEF:zombies_min={file}:zombies:MIN",
-			"DEF:zombies_max={file}:zombies:MAX",
-			"DEF:stopped_avg={file}:stopped:AVERAGE",
-			"DEF:stopped_min={file}:stopped:MIN",
-			"DEF:stopped_max={file}:stopped:MAX",
-			"DEF:paging_avg={file}:paging:AVERAGE",
-			"DEF:paging_min={file}:paging:MIN",
-			"DEF:paging_max={file}:paging:MAX",
-			"DEF:blocked_avg={file}:blocked:AVERAGE",
-			"DEF:blocked_min={file}:blocked:MIN",
-			"DEF:blocked_max={file}:blocked:MAX",
-			'CDEF:paging_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,blocked_avg,paging_avg,+,+,+,+,+',
-			'CDEF:blocked_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,blocked_avg,+,+,+,+',
-			'CDEF:zombies_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,+,+,+',
-			'CDEF:stopped_acc=sleeping_avg,running_avg,stopped_avg,+,+',
-			'CDEF:running_acc=sleeping_avg,running_avg,+',
-			'CDEF:sleeping_acc=sleeping_avg',
-			"AREA:paging_acc#$HalfYellow",
-			"AREA:blocked_acc#$HalfCyan",
-			"AREA:zombies_acc#$HalfRed",
-			"AREA:stopped_acc#$HalfMagenta",
-			"AREA:running_acc#$HalfGreen",
-			"AREA:sleeping_acc#$HalfBlue",
-			"LINE1:paging_acc#$FullYellow:Paging  ",
-			'GPRINT:paging_min:MIN:%5.1lf Min,',
-			'GPRINT:paging_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:paging_max:MAX:%5.1lf Max,',
-			'GPRINT:paging_avg:LAST:%5.1lf Last\l',
-			"LINE1:blocked_acc#$FullCyan:Blocked ",
-			'GPRINT:blocked_min:MIN:%5.1lf Min,',
-			'GPRINT:blocked_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:blocked_max:MAX:%5.1lf Max,',
-			'GPRINT:blocked_avg:LAST:%5.1lf Last\l',
-			"LINE1:zombies_acc#$FullRed:Zombies ",
-			'GPRINT:zombies_min:MIN:%5.1lf Min,',
-			'GPRINT:zombies_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:zombies_max:MAX:%5.1lf Max,',
-			'GPRINT:zombies_avg:LAST:%5.1lf Last\l',
-			"LINE1:stopped_acc#$FullMagenta:Stopped ",
-			'GPRINT:stopped_min:MIN:%5.1lf Min,',
-			'GPRINT:stopped_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:stopped_max:MAX:%5.1lf Max,',
-			'GPRINT:stopped_avg:LAST:%5.1lf Last\l',
-			"LINE1:running_acc#$FullGreen:Running ",
-			'GPRINT:running_min:MIN:%5.1lf Min,',
-			'GPRINT:running_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:running_max:MAX:%5.1lf Max,',
-			'GPRINT:running_avg:LAST:%5.1lf Last\l',
-			"LINE1:sleeping_acc#$FullBlue:Sleeping",
-			'GPRINT:sleeping_min:MIN:%5.1lf Min,',
-			'GPRINT:sleeping_avg:AVERAGE:%5.1lf Average,',
-			'GPRINT:sleeping_max:MAX:%5.1lf Max,',
-			'GPRINT:sleeping_avg:LAST:%5.1lf Last\l'
-		],
-		ps_rss => [
-			'DEF:avg={file}:byte:AVERAGE',
-			'DEF:min={file}:byte:MIN',
-			'DEF:max={file}:byte:MAX',
-			"AREA:avg#$HalfBlue",
-			"LINE1:avg#$FullBlue:RSS",
-			'GPRINT:min:MIN:%5.1lf%s Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:max:MAX:%5.1lf%s Max,',
-			'GPRINT:avg:LAST:%5.1lf%s Last\l'
-		],
-		ps_cputime => [
-			'DEF:user_avg_raw={file}:user:AVERAGE',
-			'DEF:user_min_raw={file}:user:MIN',
-			'DEF:user_max_raw={file}:user:MAX',
-			'DEF:syst_avg_raw={file}:syst:AVERAGE',
-			'DEF:syst_min_raw={file}:syst:MIN',
-			'DEF:syst_max_raw={file}:syst:MAX',
-			'CDEF:user_avg=user_avg_raw,1000000,/',
-			'CDEF:user_min=user_min_raw,1000000,/',
-			'CDEF:user_max=user_max_raw,1000000,/',
-			'CDEF:syst_avg=syst_avg_raw,1000000,/',
-			'CDEF:syst_min=syst_min_raw,1000000,/',
-			'CDEF:syst_max=syst_max_raw,1000000,/',
-			'CDEF:user_syst=syst_avg,UN,0,syst_avg,IF,user_avg,+',
-			"AREA:user_syst#$HalfBlue",
-			"AREA:syst_avg#$HalfRed",
-			"LINE1:user_syst#$FullBlue:User  ",
-			'GPRINT:user_min:MIN:%5.1lf%s Min,',
-			'GPRINT:user_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:user_max:MAX:%5.1lf%s Max,',
-			'GPRINT:user_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:syst_avg#$FullRed:System",
-			'GPRINT:syst_min:MIN:%5.1lf%s Min,',
-			'GPRINT:syst_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:syst_max:MAX:%5.1lf%s Max,',
-			'GPRINT:syst_avg:LAST:%5.1lf%s Last\l'
-		],
-		ps_count => [
-			'DEF:procs_avg={file}:processes:AVERAGE',
-			'DEF:procs_min={file}:processes:MIN',
-			'DEF:procs_max={file}:processes:MAX',
-			'DEF:thrds_avg={file}:threads:AVERAGE',
-			'DEF:thrds_min={file}:threads:MIN',
-			'DEF:thrds_max={file}:threads:MAX',
-			"AREA:thrds_avg#$HalfBlue",
-			"AREA:procs_avg#$HalfRed",
-			"LINE1:thrds_avg#$FullBlue:Threads  ",
-			'GPRINT:thrds_min:MIN:%5.1lf Min,',
-			'GPRINT:thrds_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:thrds_max:MAX:%5.1lf Max,',
-			'GPRINT:thrds_avg:LAST:%5.1lf Last\l',
-			"LINE1:procs_avg#$FullRed:Processes",
-			'GPRINT:procs_min:MIN:%5.1lf Min,',
-			'GPRINT:procs_avg:AVERAGE:%5.1lf Avg,',
-			'GPRINT:procs_max:MAX:%5.1lf Max,',
-			'GPRINT:procs_avg:LAST:%5.1lf Last\l'
-		],
-		ps_pagefaults => [
-			'DEF:minor_avg={file}:minflt:AVERAGE',
-			'DEF:minor_min={file}:minflt:MIN',
-			'DEF:minor_max={file}:minflt:MAX',
-			'DEF:major_avg={file}:majflt:AVERAGE',
-			'DEF:major_min={file}:majflt:MIN',
-			'DEF:major_max={file}:majflt:MAX',
-			'CDEF:minor_major=major_avg,UN,0,major_avg,IF,minor_avg,+',
-			"AREA:minor_major#$HalfBlue",
-			"AREA:major_avg#$HalfRed",
-			"LINE1:minor_major#$FullBlue:Minor",
-			'GPRINT:minor_min:MIN:%5.1lf%s Min,',
-			'GPRINT:minor_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:minor_max:MAX:%5.1lf%s Max,',
-			'GPRINT:minor_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:major_avg#$FullRed:Major",
-			'GPRINT:major_min:MIN:%5.1lf%s Min,',
-			'GPRINT:major_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:major_max:MAX:%5.1lf%s Max,',
-			'GPRINT:major_avg:LAST:%5.1lf%s Last\l'
-		],
-		qtype => [
-			'DEF:avg={file}:value:AVERAGE',
-			'DEF:min={file}:value:MIN',
-			'DEF:max={file}:value:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Queries/s",
-			'GPRINT:min:MIN:%9.3lf Min,',
-			'GPRINT:avg:AVERAGE:%9.3lf Average,',
-			'GPRINT:max:MAX:%9.3lf Max,',
-			'GPRINT:avg:LAST:%9.3lf Last\l'
-		],
-		rcode => [
-			'DEF:avg={file}:value:AVERAGE',
-			'DEF:min={file}:value:MIN',
-			'DEF:max={file}:value:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Queries/s",
-			'GPRINT:min:MIN:%9.3lf Min,',
-			'GPRINT:avg:AVERAGE:%9.3lf Average,',
-			'GPRINT:max:MAX:%9.3lf Max,',
-			'GPRINT:avg:LAST:%9.3lf Last\l'
-		],
-		swap => [
-			'DEF:used_avg={file}:used:AVERAGE',
-			'DEF:used_min={file}:used:MIN',
-			'DEF:used_max={file}:used:MAX',
-			'DEF:free_avg={file}:free:AVERAGE',
-			'DEF:free_min={file}:free:MIN',
-			'DEF:free_max={file}:free:MAX',
-			'DEF:cach_avg={file}:cached:AVERAGE',
-			'DEF:cach_min={file}:cached:MIN',
-			'DEF:cach_max={file}:cached:MAX',
-			'DEF:resv_avg={file}:resv:AVERAGE',
-			'DEF:resv_min={file}:resv:MIN',
-			'DEF:resv_max={file}:resv:MAX',
-			'CDEF:cach_avg_notnull=cach_avg,UN,0,cach_avg,IF',
-			'CDEF:resv_avg_notnull=resv_avg,UN,0,resv_avg,IF',
-			'CDEF:used_acc=used_avg',
-			'CDEF:resv_acc=used_acc,resv_avg_notnull,+',
-			'CDEF:cach_acc=resv_acc,cach_avg_notnull,+',
-			'CDEF:free_acc=cach_acc,free_avg,+',
-			"AREA:free_acc#$HalfGreen",
-			"AREA:cach_acc#$HalfBlue",
-			"AREA:resv_acc#$HalfYellow",
-			"AREA:used_acc#$HalfRed",
-			"LINE1:free_acc#$FullGreen:Free    ",
-			'GPRINT:free_min:MIN:%5.1lf%s Min,',
-			'GPRINT:free_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:free_max:MAX:%5.1lf%s Max,',
-			'GPRINT:free_avg:LAST:%5.1lf%s Last\n',
-			"LINE1:cach_acc#$FullBlue:Cached  ",
-			'GPRINT:cach_min:MIN:%5.1lf%s Min,',
-			'GPRINT:cach_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:cach_max:MAX:%5.1lf%s Max,',
-			'GPRINT:cach_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:resv_acc#$FullYellow:Reserved",
-			'GPRINT:resv_min:MIN:%5.1lf%s Min,',
-			'GPRINT:resv_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:resv_max:MAX:%5.1lf%s Max,',
-			'GPRINT:resv_avg:LAST:%5.1lf%s Last\n',
-			"LINE1:used_acc#$FullRed:Used    ",
-			'GPRINT:used_min:MIN:%5.1lf%s Min,',
-			'GPRINT:used_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:used_max:MAX:%5.1lf%s Max,',
-			'GPRINT:used_avg:LAST:%5.1lf%s Last\l'
-		],
-		temperature => [
-			'DEF:temp_avg={file}:value:AVERAGE',
-			'DEF:temp_min={file}:value:MIN',
-			'DEF:temp_max={file}:value:MAX',
-			"AREA:temp_max#$HalfRed",
-			"AREA:temp_min#$Canvas",
-			"LINE1:temp_avg#$FullRed:Temperature",
-			'GPRINT:temp_min:MIN:%4.1lf Min,',
-			'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
-			'GPRINT:temp_max:MAX:%4.1lf Max,',
-			'GPRINT:temp_avg:LAST:%4.1lf Last\l'
-		],
-		timeleft => [
-			'DEF:avg={file}:timeleft:AVERAGE',
-			'DEF:min={file}:timeleft:MIN',
-			'DEF:max={file}:timeleft:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Time left [min]",
-			'GPRINT:min:MIN:%5.1lf%s Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:max:MAX:%5.1lf%s Max,',
-			'GPRINT:avg:LAST:%5.1lf%s Last\l'
-		],
-		time_offset => [ # NTPd
-			'DEF:s_avg={file}:seconds:AVERAGE',
-			'DEF:s_min={file}:seconds:MIN',
-			'DEF:s_max={file}:seconds:MAX',
-			"AREA:s_max#$HalfBlue",
-			"AREA:s_min#$Canvas",
-			"LINE1:s_avg#$FullBlue:{inst}",
-			'GPRINT:s_min:MIN:%7.3lf%s Min,',
-			'GPRINT:s_avg:AVERAGE:%7.3lf%s Avg,',
-			'GPRINT:s_max:MAX:%7.3lf%s Max,',
-			'GPRINT:s_avg:LAST:%7.3lf%s Last'
-		],
-		traffic => ['DEF:out_min_raw={file}:outgoing:MIN',
-			'DEF:out_avg_raw={file}:outgoing:AVERAGE',
-			'DEF:out_max_raw={file}:outgoing:MAX',
-			'DEF:inc_min_raw={file}:incoming:MIN',
-			'DEF:inc_avg_raw={file}:incoming:AVERAGE',
-			'DEF:inc_max_raw={file}:incoming:MAX',
-			'CDEF:out_min=out_min_raw,8,*',
-			'CDEF:out_avg=out_avg_raw,8,*',
-			'CDEF:out_max=out_max_raw,8,*',
-			'CDEF:inc_min=inc_min_raw,8,*',
-			'CDEF:inc_avg=inc_avg_raw,8,*',
-			'CDEF:inc_max=inc_max_raw,8,*',
-			'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
-			'CDEF:mytime=out_avg_raw,TIME,TIME,IF',
-			'CDEF:sample_len_raw=mytime,PREV(mytime),-',
-			'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
-			'CDEF:out_avg_sample=out_avg_raw,UN,0,out_avg_raw,IF,sample_len,*',
-			'CDEF:out_avg_sum=PREV,UN,0,PREV,IF,out_avg_sample,+',
-			'CDEF:inc_avg_sample=inc_avg_raw,UN,0,inc_avg_raw,IF,sample_len,*',
-			'CDEF:inc_avg_sum=PREV,UN,0,PREV,IF,inc_avg_sample,+',
-			"AREA:out_avg#$HalfGreen",
-			"AREA:inc_avg#$HalfBlue",
-			"AREA:overlap#$HalfBlueGreen",
-			"LINE1:out_avg#$FullGreen:Outgoing",
-			'GPRINT:out_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:out_max:MAX:%5.1lf%s Max,',
-			'GPRINT:out_avg:LAST:%5.1lf%s Last',
-			'GPRINT:out_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
-			"LINE1:inc_avg#$FullBlue:Incoming",
-			#'GPRINT:inc_min:MIN:%5.1lf %s Min,',
-			'GPRINT:inc_avg:AVERAGE:%5.1lf%s Avg,',
-			'GPRINT:inc_max:MAX:%5.1lf%s Max,',
-			'GPRINT:inc_avg:LAST:%5.1lf%s Last',
-			'GPRINT:inc_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
-		],
-                cpufreq => [
-                        'DEF:cpufreq_avg={file}:value:AVERAGE',
-                        'DEF:cpufreq_min={file}:value:MIN',
-                        'DEF:cpufreq_max={file}:value:MAX',
-                        "AREA:cpufreq_max#$HalfBlue",
-                        "AREA:cpufreq_min#$Canvas",
-                        "LINE1:cpufreq_avg#$FullBlue:Frequency",
-                        'GPRINT:cpufreq_min:MIN:%5.1lf%s Min,',
-                        'GPRINT:cpufreq_avg:AVERAGE:%5.1lf%s Avg,',
-                        'GPRINT:cpufreq_max:MAX:%5.1lf%s Max,',
-                        'GPRINT:cpufreq_avg:LAST:%5.1lf%s Last\l'
-                ],
-		multimeter => [
-			    'DEF:multimeter_avg={file}:value:AVERAGE',
-			    'DEF:multimeter_min={file}:value:MIN',
-			    'DEF:multimeter_max={file}:value:MAX',
-			    "AREA:multimeter_max#$HalfBlue",
-			    "AREA:multimeter_min#$Canvas",
-			    "LINE1:multimeter_avg#$FullBlue:Multimeter",
-			    'GPRINT:multimeter_min:MIN:%4.1lf Min,',
-			    'GPRINT:multimeter_avg:AVERAGE:%4.1lf Average,',
-			    'GPRINT:multimeter_max:MAX:%4.1lf Max,',
-			    'GPRINT:multimeter_avg:LAST:%4.1lf Last\l'
-		],
-		users => [
-			    'DEF:users_avg={file}:users:AVERAGE',
-			    'DEF:users_min={file}:users:MIN',
-			    'DEF:users_max={file}:users:MAX',
-			    "AREA:users_max#$HalfBlue",
-			    "AREA:users_min#$Canvas",
-			    "LINE1:users_avg#$FullBlue:Users",
-			    'GPRINT:users_min:MIN:%4.1lf Min,',
-			    'GPRINT:users_avg:AVERAGE:%4.1lf Average,',
-			    'GPRINT:users_max:MAX:%4.1lf Max,',
-			    'GPRINT:users_avg:LAST:%4.1lf Last\l'
-		],
-		voltage => [
-			'DEF:avg={file}:voltage:AVERAGE',
-			'DEF:min={file}:voltage:MIN',
-			'DEF:max={file}:voltage:MAX',
-			"AREA:max#$HalfBlue",
-			"AREA:min#$Canvas",
-			"LINE1:avg#$FullBlue:Voltage",
-			'GPRINT:min:MIN:%5.1lf%sV Min,',
-			'GPRINT:avg:AVERAGE:%5.1lf%sV Avg,',
-			'GPRINT:max:MAX:%5.1lf%sV Max,',
-			'GPRINT:avg:LAST:%5.1lf%sV Last\l'
-		],
-		vs_threads => [
-			"DEF:total_avg={file}:total:AVERAGE",
-			"DEF:total_min={file}:total:MIN",
-			"DEF:total_max={file}:total:MAX",
-			"DEF:running_avg={file}:running:AVERAGE",
-			"DEF:running_min={file}:running:MIN",
-			"DEF:running_max={file}:running:MAX",
-			"DEF:uninterruptible_avg={file}:uninterruptible:AVERAGE",
-			"DEF:uninterruptible_min={file}:uninterruptible:MIN",
-			"DEF:uninterruptible_max={file}:uninterruptible:MAX",
-			"DEF:onhold_avg={file}:onhold:AVERAGE",
-			"DEF:onhold_min={file}:onhold:MIN",
-			"DEF:onhold_max={file}:onhold:MAX",
-			"LINE1:total_avg#$FullYellow:Total   ",
-			'GPRINT:total_min:MIN:%5.1lf Min,',
-			'GPRINT:total_avg:AVERAGE:%5.1lf Avg.,',
-			'GPRINT:total_max:MAX:%5.1lf Max,',
-			'GPRINT:total_avg:LAST:%5.1lf Last\l',
-			"LINE1:running_avg#$FullRed:Running ",
-			'GPRINT:running_min:MIN:%5.1lf Min,',
-			'GPRINT:running_avg:AVERAGE:%5.1lf Avg.,',          
-			'GPRINT:running_max:MAX:%5.1lf Max,',
-			'GPRINT:running_avg:LAST:%5.1lf Last\l',
-			"LINE1:uninterruptible_avg#$FullGreen:Unintr  ",
-			'GPRINT:uninterruptible_min:MIN:%5.1lf Min,',
-			'GPRINT:uninterruptible_avg:AVERAGE:%5.1lf Avg.,',
-			'GPRINT:uninterruptible_max:MAX:%5.1lf Max,',
-			'GPRINT:uninterruptible_avg:LAST:%5.1lf Last\l',
-			"LINE1:onhold_avg#$FullBlue:Onhold  ",
-			'GPRINT:onhold_min:MIN:%5.1lf Min,',
-			'GPRINT:onhold_avg:AVERAGE:%5.1lf Avg.,',
-			'GPRINT:onhold_max:MAX:%5.1lf Max,',
-			'GPRINT:onhold_avg:LAST:%5.1lf Last\l'
-		],
-		vs_memory => [
-			'DEF:vm_avg={file}:vm:AVERAGE',
-			'DEF:vm_min={file}:vm:MIN',
-			'DEF:vm_max={file}:vm:MAX',
-			'DEF:vml_avg={file}:vml:AVERAGE',
-			'DEF:vml_min={file}:vml:MIN',
-			'DEF:vml_max={file}:vml:MAX',
-			'DEF:rss_avg={file}:rss:AVERAGE',
-			'DEF:rss_min={file}:rss:MIN',
-			'DEF:rss_max={file}:rss:MAX',
-			'DEF:anon_avg={file}:anon:AVERAGE',
-			'DEF:anon_min={file}:anon:MIN',
-			'DEF:anon_max={file}:anon:MAX',
-			"LINE1:vm_avg#$FullYellow:VM     ",
-			'GPRINT:vm_min:MIN:%5.1lf%s Min,',
-			'GPRINT:vm_avg:AVERAGE:%5.1lf%s Avg.,',
-			'GPRINT:vm_max:MAX:%5.1lf%s Avg.,',
-			'GPRINT:vm_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:vml_avg#$FullRed:Locked ",
-			'GPRINT:vml_min:MIN:%5.1lf%s Min,',
-			'GPRINT:vml_avg:AVERAGE:%5.1lf%s Avg.,',
-			'GPRINT:vml_max:MAX:%5.1lf%s Avg.,',
-			'GPRINT:vml_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:rss_avg#$FullGreen:RSS    ",
-			'GPRINT:rss_min:MIN:%5.1lf%s Min,',
-			'GPRINT:rss_avg:AVERAGE:%5.1lf%s Avg.,',
-			'GPRINT:rss_max:MAX:%5.1lf%s Avg.,',
-			'GPRINT:rss_avg:LAST:%5.1lf%s Last\l',
-			"LINE1:anon_avg#$FullBlue:Anon.  ",
-			'GPRINT:anon_min:MIN:%5.1lf%s Min,',
-			'GPRINT:anon_avg:AVERAGE:%5.1lf%s Avg.,',
-			'GPRINT:anon_max:MAX:%5.1lf%s Avg.,',
-			'GPRINT:anon_avg:LAST:%5.1lf%s Last\l',
-		],
-		vs_processes => [
-			'DEF:proc_avg={file}:total:AVERAGE',
-			'DEF:proc_min={file}:total:MIN',
-			'DEF:proc_max={file}:total:MAX',
-			"AREA:proc_max#$HalfBlue",
-			"AREA:proc_min#$Canvas",
-			"LINE1:proc_avg#$FullBlue:Processes",
-			'GPRINT:proc_min:MIN:%4.1lf Min,',
-			'GPRINT:proc_avg:AVERAGE:%4.1lf Avg.,',
-			'GPRINT:proc_max:MAX:%4.1lf Max,',
-			'GPRINT:proc_avg:LAST:%4.1lf Last\l'
-		],
-	};
-	$GraphDefs->{'disk'} = $GraphDefs->{'partition'};
-	$GraphDefs->{'if_errors'} = $GraphDefs->{'if_packets'};
-	$GraphDefs->{'meminfo'} = $GraphDefs->{'memory'};
-	$GraphDefs->{'sensors'} = $GraphDefs->{'temperature'};
-
-	$GraphDefs->{'delay'}           = $GraphDefs->{'time_offset'};
-	$GraphDefs->{'time_dispersion'} = $GraphDefs->{'time_offset'};
-}
-
-our $GraphArgs =
-{
-	apache_bytes => ['-t', 'apache traffic', '-v', 'Bit/s'],
-	apache_requests => ['-t', 'apache requests', '-v', 'Requests/s'],
-	apache_scoreboard => ['-t', 'apache scoreboard {inst}', '-v', 'Processes'],
-	charge => ['-t', '{host} charge', '-v', 'Ampere hours'],
-	charge_percent => ['-t', '{host} charge', '-v', 'Percent'],
-	cpu => ['-t', '{host} cpu{inst} usage', '-v', 'Percent', '-l', '0'],
-	cpufreq => ['-t', '{host} cpu{inst} usage', '-v', 'Mhz'],
-	current => ['-t', '{host} current', '-v', 'Ampere'],
-	#disk => ['-t', '{host} disk {inst} IO wait', '-v', 'Seconds'],
-	delay => ['-t', 'NTPd peer delay ({inst})', '-v', 'Seconds'],
-	df => ['-t', '{host}:{inst} usage', '-v', 'Percent', '-l', '0'],
-	disk => ['-t', '{host} disk {inst} usage', '-v', 'Byte/s'],
-	dns_traffic => ['-t', '{host} DNS traffic', '-v', 'Bit/s'],
-	email => ['-t', '{host} E-Mail {inst} count', '-v', 'E-Mails'],
-	email_size => ['-t', '{host} E-Mail {inst} size', '-v', 'Bytes'],
-	spam_score => ['-t', '{host} spam score', '-v', 'score'],
-	spam_check => ['-t', '{host} spam checks {inst}', '-v', 'hits'],
-	fanspeed => ['-t', '{host} fanspeed {inst}', '-v', 'RPM'],
-	frequency_offset => ['-t', 'NTPd frequency offset ({inst})', '-v', 'Parts per million'],
-	hddtemp => ['-t', '{host} hdd temperature {inst}', '-v', 'Celsius'],
-	if_errors => ['-t', '{host} {inst} errors', '-v', 'Errors/s'],
-	if_packets => ['-t', '{host} {inst} packets', '-v', 'Packets/s'],
-	load => ['-t', '{host} load average', '-v', 'System load', '-X', '0'],
-	load_percent => ['-t', '{host} load', '-v', 'Percent'],
-	mails   => ['-t', '{host} mail count', '-v', 'Amount', '-X', '0'],
-	memory => ['-t', '{host} memory usage', '-v', 'Bytes', '-b', '1024', '-l', '0'],
-	mysql_commands => ['-t', 'mysql command {inst}', '-v', 'Issues/s' ],
-	mysql_handler => ['-t', 'mysql handler {inst}', '-v', 'Issues/s' ],
-	mysql_qcache => ['-t', 'mysql query cache', '-v', 'Queries/s' ],
-	mysql_threads => ['-t', 'mysql threads', '-v', 'Threads' ],
-	nfs3_procedures => ['-t', '{host} NFSv3 {inst} procedures', '-v', 'Procedures/s' ],
-	opcode => ['-t', 'OpCode {inst}', '-v', 'Queries/s'],
-	partition => ['-t', '{host} partition {inst} usage', '-v', 'Byte/s'],
-	ping => ['-t', '{host} ping to {inst}', '-v', 'ms'],
-	processes => ['-t', '{host} processes', '-v', 'Processes'],
-	ps_rss => ['-t', '{host} process {inst} RSS', '-v', 'Bytes', '-b', '1024'],
-	ps_cputime => ['-t', '{host} process {inst} CPU usage', '-v', 'Seconds'],
-	ps_count => ['-t', '{host} process {inst} count', '-v', 'Threads/Processes'],
-	ps_pagefaults => ['-t', '{host} process {inst} pagefaults', '-v', 'Pagefaults/s'],
-	qtype => ['-t', 'QType {inst}', '-v', 'Queries/s'],
-	rcode => ['-t', 'RCode {inst}', '-v', 'Queries/s'],
-	sensors => ['-t', '{host} sensor {inst}', '-v', 'Celsius'],
-	swap => ['-t', '{host} swap usage', '-v', 'Bytes', '-b', '1024', '-l', '0'],
-	temperature => ['-t', '{host} temperature {inst}', '-v', 'Celsius'],
-	timeleft => ['-t', '{host} UPS time left', '-v', 'Time [min]'],
-	time_offset => ['-t', 'NTPd time offset ({inst})', '-v', 'Seconds'],
-	time_dispersion => ['-t', 'NTPd time dispersion ({inst})', '-v', 'Seconds'],
-	traffic => ['-t', '{host} {inst} traffic', '-v', 'Bit/s'],
-	users => ['-t', '{host} users', '-v', 'Users'],
-	multimeter => ['-t', '{host} multimeter', '-v', 'Value'],
-	voltage => ['-t', '{host} voltage {inst}', '-v', 'Volts'],
-	vs_threads => ['-t', '{host} threads', '-v', 'Threads'],
-	vs_memory => ['-t', '{host} memory usage', '-v', 'Bytes'],
-	vs_processes => ['-t', '{host} processes', '-v', 'Processes'],
-};
-
-our $GraphMulti =
-{
-	apache_scoreboard => \&output_graph_apache_scoreboard,
-	cpu	=> \&output_graph_cpu,
-	cpufreq => 1,
-	disk	=> 1,
-	email	=> \&output_graph_email_count,
-	email_size => \&output_graph_email_size,
-	spam_score => 1,
-	spam_check => \&output_graph_spam_check,
-	load	=> 0,
-	mails	=> 0,
-	memory	=> 0,
-	mysql_commands => \&output_graph_mysql_commands,
-	mysql_handler => \&output_graph_mysql_handler,
-	partition => 1,
-	ping	=> \&output_graph_ping,
-	qtype => \&output_graph_named_qtype,
-	rcode => \&output_graph_named_rcode,
-	sensors	=> 1,
-	traffic	=> 1,
-	users => 1,
-	multimeter => 1
-};
+load_graph_definitions ();
 
-our @Info;
-if (defined ($ENV{'GATEWAY_INTERFACE'}))
+for (qw(action host plugin plugin_instance type type_instance timespan))
 {
-	@Info = ($ENV{'PATH_INFO'} || '') =~ m#([\w\-\.]+)#g;
-}
-else
-{
-	@Info = @ARGV;
+	$Args->{$_} = param ($_);
 }
 
-parse_pathinfo (@Info);
+exit (main ());
 
-if ($TimeSpan)
-{
-	output_graph ();
-}
-else
-{
-	output_page ();
-}
-
-exit (0);
-
-sub output_graph_cpu
+sub read_config
 {
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	for (@inst)
-	{
-		push (@ret,
-			"DEF:user_avg_$_=$AbsDir/cpu-$_.rrd:user:AVERAGE",
-			"DEF:user_min_$_=$AbsDir/cpu-$_.rrd:user:MIN",
-			"DEF:user_max_$_=$AbsDir/cpu-$_.rrd:user:MAX",
-			"DEF:nice_avg_$_=$AbsDir/cpu-$_.rrd:nice:AVERAGE",
-			"DEF:nice_min_$_=$AbsDir/cpu-$_.rrd:nice:MIN",
-			"DEF:nice_max_$_=$AbsDir/cpu-$_.rrd:nice:MAX",
-			"DEF:syst_avg_$_=$AbsDir/cpu-$_.rrd:syst:AVERAGE",
-			"DEF:syst_min_$_=$AbsDir/cpu-$_.rrd:syst:MIN",
-			"DEF:syst_max_$_=$AbsDir/cpu-$_.rrd:syst:MAX",
-			"DEF:wait_avg_$_=$AbsDir/cpu-$_.rrd:wait:AVERAGE",
-			"DEF:wait_min_$_=$AbsDir/cpu-$_.rrd:wait:MIN",
-			"DEF:wait_max_$_=$AbsDir/cpu-$_.rrd:wait:MAX");
-	}
-
-	for (qw(user nice syst wait))
+	my $fh;
+	open ($fh, "< $Config") or confess ("open ($Config): $!");
+	while (my $line = <$fh>)
 	{
-		my $def = $_;
-		my $cdef;
+		chomp ($line);
+		next if (!$line);
+		next if ($line =~ m/^\s*#/);
+		next if ($line =~ m/^\s*$/);
 
-		my $default_value = ($def eq 'user' or $def eq 'syst') ? 'UNKN' : '0';
+		my $key;
+		my $value;
 
-		for (qw(avg min max))
+		if ($line =~ m/^([A-Za-z]+):\s*"((?:[^"\\]+|\\.)*)"$/)
 		{
-			my $cf = $_;
-
-			for (@inst)
-			{
-				push (@ret, "CDEF:${def}_${cf}_notnull_${_}=${def}_${cf}_${_},UN,0,${def}_${cf}_${_},IF");
-				push (@ret, "CDEF:${def}_${cf}_defined_${_}=${def}_${cf}_${_},UN,0,1,IF");
-			}
-
-			$cdef = "CDEF:${def}_${cf}_num=" . join (',', map { "${def}_${cf}_defined_${_}" } (@inst));
-			$cdef .= ',+' x (scalar (@inst) - 1);
-			push (@ret, $cdef);
-
-			$cdef = "CDEF:${def}_${cf}=${def}_${cf}_num," . join (',', map { "${def}_${cf}_notnull_${_}" } (@inst));
-			$cdef .= ',+' x (scalar (@inst) - 1);
-			$cdef .= ",${def}_${cf}_num,${def}_${cf}_num,1,IF,/,$default_value,IF";
-			push (@ret, $cdef);
-			push (@ret, "CDEF:${def}_${cf}_notnull=${def}_${cf},UN,0,${def}_${cf},IF");
+			$key = lc ($1); $value = $2;
+			$value =~ s/\\(.)/$1/g;
 		}
-	}
-
-	push (@ret,
-		"CDEF:nice_acc=syst_avg_notnull,wait_avg_notnull,user_avg_notnull,nice_avg_notnull,+,+,+",
-		"CDEF:user_acc=syst_avg_notnull,wait_avg_notnull,user_avg_notnull,+,+",
-		"CDEF:wait_acc=syst_avg_notnull,wait_avg_notnull,+",
-		"CDEF:syst_acc=syst_avg_notnull");
-
-	push (@ret, grep { $_ !~ m/^C?DEF/ } (@{$GraphDefs->{'cpu'}}));
-
-	return (@ret);
-}
-
-sub output_graph_apache_scoreboard
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/apache_scoreboard-$inst.rrd:count:AVERAGE",
-			"DEF:min_$i=$AbsDir/apache_scoreboard-$inst.rrd:count:MIN",
-			"DEF:max_$i=$AbsDir/apache_scoreboard-$inst.rrd:count:MAX");
-	}
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-
-		if (length ($inst) > 15)
+		elsif ($line =~ m/([A-Za-z]+):\s*([0-9]+)$/)
 		{
-			$inst = substr ($inst, 0, 12) . '...';
+			$key = lc ($1); $value = 0 + $2;
 		}
 		else
 		{
-			$inst = sprintf ('%-15s', $inst);
+			print STDERR "Cannot parse line: $line\n";
+			next;
 		}
 
-		push (@ret,
-			"LINE1:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%6.2lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%6.2lf Avg,",
-			"GPRINT:max_$i:MAX:%6.2lf Max,",
-			"GPRINT:avg_$i:LAST:%6.2lf Last\\l");
-	}
-
-	return (@ret);
-}
-
-sub output_graph_ping
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/ping-$inst.rrd:ping:AVERAGE",
-			"DEF:min_$i=$AbsDir/ping-$inst.rrd:ping:MIN",
-			"DEF:max_$i=$AbsDir/ping-$inst.rrd:ping:MAX");
-	}
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-
-		if (length ($inst) > 15)
+		if ($key eq 'datadir')
 		{
-			$inst = substr ($inst, 0, 12) . '...';
+			$value =~ s#/*$##;
+			push (@DataDirs, $value);
 		}
-		else
+		elsif ($key eq 'libdir')
 		{
-			$inst = sprintf ('%-15s', $inst);
-		}
-
-		push (@ret,
-			"LINE1:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%4.1lf ms Min,",
-			"GPRINT:avg_$i:AVERAGE:%4.1lf ms Avg,",
-			"GPRINT:max_$i:MAX:%4.1lf ms Max,",
-			"GPRINT:avg_$i:LAST:%4.1lf ms Last\\l");
-	}
-
-	return (@ret);
-}
-
-sub output_graph_email_count
-{
-	my @inst = @_;
-	my @ret  = ();
-
-	my $c = scalar @inst;
-
-	my @colors = get_n_colors ($c);
-
-	for (my $i = 0; $i < $c; ++$i) {
-		push @ret,
-			"DEF:min_$i=$AbsDir/email-$inst[$i].rrd:count:MIN",
-			"DEF:avg_$i=$AbsDir/email-$inst[$i].rrd:count:AVERAGE",
-			"DEF:max_$i=$AbsDir/email-$inst[$i].rrd:count:MAX";
-	}
-
-	for (my $i = 0; $i < $c; ++$i) {
-		my $s = "";
-
-		if (length $inst[$i] > 10) {
-			$s = substr ($inst[$i], 0, 7) . '...';
-		}
-		else {
-			$s = sprintf '%-10s', $inst[$i];
-		}
-
-		push @ret,
-			"LINE1:avg_$i#$colors[$i]:$s",
-			"GPRINT:min_$i:MIN:%4.1lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%4.1lf Avg,",
-			"GPRINT:max_$i:MAX:%4.1lf Max,",
-			"GPRINT:avg_$i:LAST:%4.1lf Last\\l";
-	}
-	return @ret;
-}
-
-sub output_graph_email_size
-{
-	my @inst = @_;
-	my @ret  = ();
-
-	my $c = scalar @inst;
-
-	my @colors = get_n_colors ($c);
-
-	for (my $i = 0; $i < $c; ++$i) {
-		push @ret,
-			"DEF:min_$i=$AbsDir/email_size-$inst[$i].rrd:size:MIN",
-			"DEF:avg_$i=$AbsDir/email_size-$inst[$i].rrd:size:AVERAGE",
-			"DEF:max_$i=$AbsDir/email_size-$inst[$i].rrd:size:MAX";
-	}
-
-	for (my $i = 0; $i < $c; ++$i) {
-		my $s = "";
-
-		if (length $inst[$i] > 10) {
-			$s = substr ($inst[$i], 0, 7) . '...';
-		}
-		else {
-			$s = sprintf '%-10s', $inst[$i];
-		}
-
-		push @ret,
-			"LINE1:avg_$i#$colors[$i]:$s",
-			"GPRINT:min_$i:MIN:%4.1lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%4.1lf Avg,",
-			"GPRINT:max_$i:MAX:%4.1lf Max,",
-			"GPRINT:avg_$i:LAST:%4.1lf Last\\l";
-	}
-	return @ret;
-}
-
-sub output_graph_spam_check
-{
-	my @inst = sort @_;
-	my @ret  = ();
-
-	my $c = scalar @inst;
-
-	my @colors = get_n_colors ($c);
-
-	for (my $i = 0; $i < $c; ++$i) {
-		push @ret,
-			"DEF:min_$i=$AbsDir/spam_check-$inst[$i].rrd:hits:MIN",
-			"DEF:avg_$i=$AbsDir/spam_check-$inst[$i].rrd:hits:AVERAGE",
-			"DEF:max_$i=$AbsDir/spam_check-$inst[$i].rrd:hits:MAX";
-	}
-
-	for (my $i = 0; $i < $c; ++$i) {
-		my $s = "";
-
-		if (length $inst[$i] > 25) {
-			$s = substr ($inst[$i], 0, 22) . '...';
-		}
-		else {
-			$s = sprintf '%-25s', $inst[$i];
-		}
-
-		push @ret,
-			"LINE1:avg_$i#$colors[$i]:$s",
-			"GPRINT:min_$i:MIN:%4.1lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%4.1lf Avg,",
-			"GPRINT:max_$i:MAX:%4.1lf Max,",
-			"GPRINT:avg_$i:LAST:%4.1lf Last\\l";
-	}
-	return @ret;
-}
-
-sub output_graph_mysql_commands
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/mysql_commands-$inst.rrd:value:AVERAGE",
-			"DEF:min_$i=$AbsDir/mysql_commands-$inst.rrd:value:MIN",
-			"DEF:max_$i=$AbsDir/mysql_commands-$inst.rrd:value:MAX");
-	}
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-
-		if (length ($inst) > 18)
-		{
-			$inst = substr ($inst, 0, 15) . '...';
-		}
-		else
-		{
-			$inst = sprintf ('%-18s', $inst);
-		}
-
-		push (@ret,
-			"LINE1:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%6.1lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%6.1lf Avg,",
-			"GPRINT:max_$i:MAX:%6.1lf Max,",
-			"GPRINT:avg_$i:LAST:%6.1lf Last\\l");
-	}
-
-	return (@ret);
-}
-
-sub output_graph_mysql_handler
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/mysql_handler-$inst.rrd:value:AVERAGE",
-			"DEF:min_$i=$AbsDir/mysql_handler-$inst.rrd:value:MIN",
-			"DEF:max_$i=$AbsDir/mysql_handler-$inst.rrd:value:MAX");
-	}
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-
-		if (length ($inst) > 18)
-		{
-			$inst = substr ($inst, 0, 15) . '...';
-		}
-		else
-		{
-			$inst = sprintf ('%-18s', $inst);
-		}
-
-		push (@ret,
-			"LINE1:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%6.1lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%6.1lf Avg,",
-			"GPRINT:max_$i:MAX:%6.1lf Max,",
-			"GPRINT:avg_$i:LAST:%6.1lf Last\\l");
-	}
-
-	return (@ret);
-}
-
-sub output_graph_named_qtype
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/qtype-$inst.rrd:value:AVERAGE",
-			"DEF:min_$i=$AbsDir/qtype-$inst.rrd:value:MIN",
-			"DEF:max_$i=$AbsDir/qtype-$inst.rrd:value:MAX");
-	}
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-		my $type = ($i == 0) ? 'AREA' : 'STACK';
-
-		if (length ($inst) > 5)
-		{
-			$inst = substr ($inst, 0, 5);
+			$value =~ s#/*$##;
+			$LibDir = $value;
 		}
 		else
 		{
-			$inst = sprintf ('%-5s', $inst);
+			print STDERR "Unknown key: $key\n";
 		}
-
-		push (@ret,
-			"$type:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%9.3lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%9.3lf Avg,",
-			"GPRINT:max_$i:MAX:%9.3lf Max,",
-			"GPRINT:avg_$i:LAST:%9.3lf Last\\l");
-	}
-
-	return (@ret);
-}
-
-sub output_graph_named_rcode
-{
-	my @inst = @_;
-	my @ret = ();
-
-	die if (@inst < 2);
-
-	my @colors = get_n_colors (scalar (@inst));
-
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		push (@ret,
-			"DEF:avg_$i=$AbsDir/rcode-$inst.rrd:value:AVERAGE",
-			"DEF:min_$i=$AbsDir/rcode-$inst.rrd:value:MIN",
-			"DEF:max_$i=$AbsDir/rcode-$inst.rrd:value:MAX");
 	}
+	close ($fh);
+} # read_config
 
-	for (my $i = 0; $i < scalar (@inst); $i++)
-	{
-		my $inst = $inst[$i];
-		my $color = $colors[$i];
-		my $type = ($i == 0) ? 'AREA' : 'STACK';
-
-		if (length ($inst) > 8)
-		{
-			$inst = substr ($inst, 0, 6) . '..';
-		}
-		else
-		{
-			$inst = sprintf ('%-8s', $inst);
-		}
-
-		push (@ret,
-			"$type:avg_$i#$color:$inst",
-			"GPRINT:min_$i:MIN:%9.3lf Min,",
-			"GPRINT:avg_$i:AVERAGE:%9.3lf Avg,",
-			"GPRINT:max_$i:MAX:%9.3lf Max,",
-			"GPRINT:avg_$i:LAST:%9.3lf Last\\l");
-	}
+#sub validate_args
+#{
+#	if (!$Args->{'host'} || ($Args->{'host'} =~ m#/#)
+#		|| !$Args->{'plugin'} || ($Args->{'plugin'} =~ m#/#)
+#		|| (defined ($Args->{'plugin_instance'}) && ($Args->{'plugin_instance'} =~ m#/#))
+#		|| !$Args->{'type'} || ($Args->{'type'} =~ m#/#)
+#		|| (defined ($Args->{'type_instance'}) && ($Args->{'type_instance'} =~ m#/#)))
+#	{
+#		delete ($Args->{'host'});
+#		delete ($Args->{'plugin'});
+#		delete ($Args->{'plugin_instance'});
+#		delete ($Args->{'type'});
+#		delete ($Args->{'type_instance'});
+#	}
+#	elsif ($Args->{'type_instance'} eq '*')
+#	{
+#		my $subdir = $Args->{'host'} . '/'
+#		. $Args->{'plugin'} . (defined ($Args->{'plugin_instance'}) ? ('-' . $Args->{'plugin_instance'}) : '');
+#		my %type_instances = ();
+#		my $regex_str = '^' . quotemeta ($Args->{'type'}) . '-(.*)\.rrd';
+#		my $regex = qr/$regex_str/;
+#		my $mtime = 0;
+#
+#		for (my $i = 0; $i < @DataDirs; $i++)
+#		{
+#			my $dh;
+#			my @files = ();
+#			opendir ($dh, $DataDirs[$i] . '/' . $subdir) or next;
+#			for (readdir ($dh))
+#			{
+#				my $file = $_;
+#				if ($file =~ $regex)
+#				{
+#					my $tmp_mtime;
+#					my $type_instance = $1;
+#					my $filename = $DataDirs[$i] . '/' . $subdir . '/' . $Args->{'type'} . '-' . $type_instance . '.rrd';
+#
+#					$type_instances{$type_instance} = [] if (!exists ($type_instances{$type_instance}));
+#					$tmp_mtime = (stat ($filename))[9];
+#					next if (!$tmp_mtime);
+#
+#					push (@{$type_instances{$type_instance}}, $filename);
+#					$mtime = $tmp_mtime if ($mtime < $tmp_mtime);
+#				}
+#			}
+#			closedir ($dh);
+#		}
+#
+#		if (!keys %type_instances)
+#		{
+#			print STDOUT header (-Status => '404 File not found', -Content_Type => 'text/plain');
+#			print STDOUT <<MSG;
+#Sorry, the requested file could not be found anywhere.
+#DataDirs = ${\join ('; ', @DataDirs)}
+#subdir   = $subdir
+#MSG
+#			exit (0);
+#		}
+#
+#		$Args->{'files'} = \%type_instances;
+#		$Args->{'mtime'} = $mtime;
+#	}
+#	else
+#	{
+#		my $filename = $Args->{'host'} . '/'
+#		. $Args->{'plugin'} . (defined ($Args->{'plugin_instance'}) ? ('-' . $Args->{'plugin_instance'}) : '') . '/'
+#		. $Args->{'type'} . (defined ($Args->{'type_instance'}) ? ('-' . $Args->{'type_instance'}) : '') . '.rrd';
+#		my @files = ();
+#		my $mtime = 0;
+#
+#		for (my $i = 0; $i < @DataDirs; $i++)
+#		{
+#			my $tmp_file;
+#			my $tmp_mtime;
+#			$tmp_file = $DataDirs[$i] . '/' . $filename;
+#			next if (!-e $tmp_file);
+#			$tmp_mtime = (stat ($tmp_file))[9];
+#			next if (!$tmp_mtime);
+#
+#			push (@files, $tmp_file);
+#			$mtime = $tmp_mtime if ($mtime < $tmp_mtime);
+#		}
+#
+#		if (!@files)
+#		{
+#			print STDOUT header (-Status => '404 File not found', -Content_Type => 'text/plain');
+#			print STDOUT <<MSG;
+#Sorry, the requested file could not be found anywhere.
+#DataDirs = ${\join ('; ', @DataDirs)}
+#filename = $filename
+#MSG
+#			exit (0);
+#		}
+#		$Args->{'files'} = \@files;
+#		$Args->{'mtime'} = $mtime;
+#	}
+#
+#	if ($Args->{'timespan'})
+#	{
+#		if ($Args->{'timespan'} =~ m/^([0-9]+)$/)
+#		{
+#			$Args->{'timespan'} = (-1) * $1;
+#		}
+#		elsif ($Args->{'timespan'} =~ m/^(hour|day|week|month|year)$/)
+#		{
+#			my %map =
+#			(
+#				hour => -3600,
+#				day => -86400,
+#				week => 7 * -86400,
+#				month => 31 * -86400,
+#				year => 366 * -86400
+#			);
+#			$Args->{'timespan'} = $map{$1};
+#		}
+#		else
+#		{
+#			$Args->{'timespan'} = -86400;
+#		}
+#	}
+#} # validate_args
 
-	return (@ret);
-}
-sub output_graph
+sub validate_args
 {
-	die unless (defined ($GraphDefs->{$Type}));
-
-	my $host;
-	my @cmd = ();
-	my $file = $AbsDir . '/';
-	my $files = get_all_files ($AbsDir);
-
-	#
-	# get hostname
-	#
-	if ($RelDir =~ m#([^/]+)$#)
+	if ($Args->{'action'} && ($Args->{'action'} =~ m/^(overview|show_host|show_plugin|show_type|show_graph)$/))
 	{
-		$host = $1;
+		$Args->{'action'} = $1;
 	}
 	else
 	{
-		$host = $Config->{'HostName'};
+		$Args->{'action'} = 'overview';
 	}
 
-	#
-	# get timespan
-	#
-	if ($TimeSpan =~ m/(\d+)/)
+	if ($Args->{'host'} && ($Args->{'host'} =~ m#/#))
 	{
-		$TimeSpan = -1 * int ($1);
-	}
-	else
-	{
-		my %t = (hour => -3600, day => -86400, week => -604800, month => -2678400, year => -31622400);
-		die unless (defined ($t{$TimeSpan}));
-		$TimeSpan = $t{$TimeSpan};
+		delete ($Args->{'host'});
 	}
 
-	if (scalar (@{$files->{$Type}}) == 1)
+	if ($Args->{'plugin'} && ($Args->{'plugin'} =~ m#/#))
 	{
-		$Inst = $files->{$Type}[0];
+		delete ($Args->{'plugin'});
 	}
 
-	#push (@cmd, '-', '-a', 'PNG', '-s', $TimeSpan, '-w', 800, '-h', 150);
-	push (@cmd, '-', '-a', 'PNG', '-s', $TimeSpan);
-	push (@cmd, @{$GraphArgs->{$Type}}) if (defined ($GraphArgs->{$Type}));
-
-	for (qw(Back ShadeA ShadeB Font Canvas Grid MGrid Frame Arrow))
+	if ($Args->{'type'} && ($Args->{'type'} =~ m#/#))
 	{
-		push (@cmd, '-c', uc ($_) . '#' . $Config->{'Colors'}{$_});
+		delete ($Args->{'type'});
 	}
 
-	if ((length ($Inst) == 0) and (ref ($GraphMulti->{$Type}) eq 'CODE'))
+	if (!$Args->{'plugin'} || ($Args->{'plugin_instance'}
+		&& ($Args->{'plugin_instance'} =~ m#/#)))
 	{
-		push (@cmd, $GraphMulti->{$Type}->(@{$files->{$Type}}));
+		delete ($Args->{'plugin_instance'});
 	}
-	else
-	{
-		if (length ("$Inst"))
-		{
-			$file .= "$Type-$Inst.rrd";
-		}
-		else
-		{
-			$file .= "$Type.rrd";
-		}
 
-		die ("File not found: $file") unless (-e $file);
-
-		push (@cmd, @{$GraphDefs->{$Type}});
-	}
-
-	for (@cmd)
+	if (!$Args->{'type'} || ($Args->{'type_instance'}
+		&& ($Args->{'type_instance'} =~ m#/#)))
 	{
-		$_ =~ s/{file}/$file/g;
-		$_ =~ s/{host}/$host/g;
-		$_ =~ s/{inst}/$Inst/g;
-		$_ =~ s/{type}/$Type/g;
+		delete ($Args->{'type_instance'});
 	}
 
-	$| = 1;
-
-	print STDOUT <<HEADER if (defined ($ENV{'GATEWAY_INTERFACE'}));
-Content-Type: image/png
-Cache-Control: no-cache
-
-HEADER
-
-	if (1)
+	if (defined ($Args->{'timespan'})
+	  && ($Args->{'timespan'} =~ m/^(hour|day|week|month|year)$/))
 	{
-		my $fh;
-		open ($fh, ">/tmp/collection.log") or die ("open: $!");
-		flock ($fh, LOCK_EX) or die ("flock: $!");
-
-		print $fh join ("\n\t", @cmd) . "\n";
-
-		close ($fh);
-	}
-
-	RRDs::graph (@cmd);
-
-	die ('RRDs::error: ' . RRDs::error ()) if (RRDs::error ());
-}
-
-sub output_page
-{
-	my $files = get_all_files ($AbsDir);
-	my $dirs  = get_all_dirs  ($AbsDir);
-
-	print STDOUT <<HEADER if (defined ($ENV{'GATEWAY_INTERFACE'}));
-Content-Type: text/html
-Cache-Control: no-cache
-
-<html>
-	<head>
-		<title>Collection: $RelDir</title>
-		<style type="text/css">
-			img { border: none; display: block; }
-		</style>
-	</head>
-
-	<body>
-HEADER
-
-	my $MySelf = defined ($ENV{'GATEWAY_INTERFACE'}) ? $ENV{'SCRIPT_NAME'} : $0;
-
-	if ((length ($Type) != 0) and (length ($Inst) == 0) and (ref ($GraphMulti->{$Type}) eq 'CODE') and (scalar (@{$files->{$Type}}) > 1))
-	{
-		print qq(\t\t<div><a href="$MySelf$RelDir">Go up</a></div>\n);
-
-		print "\t\t<ul>\n";
-		for (@{$files->{$Type}})
-		{
-			print qq(\t\t\t<li><a href="$MySelf$RelDir/$Type/$_">$_</a></li>\n);
-		}
-		print <<HTML;
-		</ul>
-
-		<h3>Hourly</h3>
-		<div><img src="$MySelf$RelDir/$Type/hour" /></div>
-		<h3>Daily</h3>
-		<div><img src="$MySelf$RelDir/$Type/day" /></div>
-		<h3>Weekly</h3>
-		<div><img src="$MySelf$RelDir/$Type/week" /></div>
-		<h3>Monthly</h3>
-		<div><img src="$MySelf$RelDir/$Type/month" /></div>
-		<h3>Yearly</h3>
-		<div><img src="$MySelf$RelDir/$Type/year" /></div>
-HTML
-	}
-	elsif (length ($Type) != 0)
-	{
-		my $ext = length ($Inst) ? "$Type/$Inst" : $Type;
-
-		if ((ref ($GraphMulti->{$Type}) eq 'CODE') and (scalar (@{$files->{$Type}}) > 1))
-		{
-			print qq(<div><a href="$MySelf$RelDir/$Type">Go up</a></div>\n);
-		}
-		else
-		{
-			print qq(<div><a href="$MySelf$RelDir">Go up</a></div>\n);
-		}
-
-		print <<HTML;
-		<h3>Hourly</h3>
-		<div><img src="$MySelf$RelDir/$ext/hour" /></div>
-		<h3>Daily</h3>
-		<div><img src="$MySelf$RelDir/$ext/day" /></div>
-		<h3>Weekly</h3>
-		<div><img src="$MySelf$RelDir/$ext/week" /></div>
-		<h3>Monthly</h3>
-		<div><img src="$MySelf$RelDir/$ext/month" /></div>
-		<h3>Yearly</h3>
-		<div><img src="$MySelf$RelDir/$ext/year" /></div>
-HTML
+	  $Args->{'timespan'} = $1;
 	}
 	else
 	{
-		if ($RelDir)
-		{
-			my ($up) = $RelDir =~ m#(.*)/[^/]+$#;
-			print qq(\t\t<div><a href="$MySelf$up">Go up</a></div>\n);
-		}
-
-		if (@$dirs)
-		{
-			print "<ul>\n";
-			for (@$dirs)
-			{
-				print qq(<li>$AbsDir/<a href="$MySelf$RelDir/$_">$_</a></li>\n);
-			}
-			print "</ul>\n";
-		}
-
-		for (sort (keys %$files))
-		{
-			my $type = $_;
-
-			if (ref ($GraphMulti->{$type}) eq 'CODE')
-			{
-				print qq(\t\t<a href="$MySelf$RelDir/$type" />),
-				qq(<img src="$MySelf$RelDir/$type/day" /></a>\n);
-				next;
-			}
-
-			for (@{$files->{$type}})
-			{
-				my $inst = "$_";
-
-				if (length ($inst))
-				{
-					print qq(\t\t<a href="$MySelf$RelDir/$type/$inst" />),
-					qq(<img src="$MySelf$RelDir/$type/$inst/day" /></a>\n);
-				}
-				else
-				{
-					print qq(\t\t<a href="$MySelf$RelDir/$type" />),
-					qq(<img src="$MySelf$RelDir/$type/day" /></a>\n);
-				}
-			}
-		}
+	  $Args->{'timespan'} = 'day';
 	}
+} # validate_args
 
-	print STDOUT <<FOOTER if (defined ($ENV{'GATEWAY_INTERFACE'}));
-	</body>
-</html>
-FOOTER
-}
-
-sub output_xml
-{
-	my $files = get_all_files ();
-
-	print STDOUT <<HEADER if (defined ($ENV{'GATEWAY_INTERFACE'}));
-Content-Type: text/xml
-Cache-Control: no-cache
-
-HEADER
-	print STDOUT pl2xml ($files);
-}
-
-sub read_config
+sub _find_hosts
 {
-	my $file = @_ ? shift : '/etc/collection.conf';
-	my $conf;
-	my $fh;
+  my %hosts = ();
 
-#	if (open ($fh, "< $file"))
+  for (my $i = 0; $i < @DataDirs; $i++)
+  {
+    my @tmp;
+    my $dh;
+
+    opendir ($dh, $DataDirs[$i]) or next;
+    @tmp = grep { ($_ !~ m/^\./) && (-d $DataDirs[$i] . '/' . $_) } (readdir ($dh));
+    closedir ($dh);
+
+    $hosts{$_} = 1 for (@tmp);
+  } # for (@DataDirs)
+
+  return (keys %hosts);
+} # _find_hosts
+
+sub _find_plugins
+{
+  my $host = shift;
+  my %plugins = ();
+
+  for (my $i = 0; $i < @DataDirs; $i++)
+  {
+    my $dir = $DataDirs[$i] . "/$host";
+    my @tmp;
+    my $dh;
+
+    opendir ($dh, $dir) or next;
+    @tmp = grep { ($_ !~ m/^\./) && (-d "$dir/$_") } (readdir ($dh));
+    closedir ($dh);
+
+    for (@tmp)
+    {
+      my ($plugin, $instance) = split (m/-/, $_, 2);
+      $plugins{$plugin} = [] if (!$plugins{$plugin});
+      push (@{$plugins{$plugin}}, $instance) if (defined ($instance));
+    }
+  } # for (@DataDirs)
+
+  return (%plugins);
+} # _find_hosts
+
+sub _find_types
+{
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my %types = ();
+
+  for (my $i = 0; $i < @DataDirs; $i++)
+  {
+    my $dir = $DataDirs[$i] . "/$host/$plugin" . (defined ($plugin_instance) ? "-$plugin_instance" : '');
+    my @tmp;
+    my $dh;
+
+    opendir ($dh, $dir) or next;
+    @tmp = grep { ($_ !~ m/^\./) && ($_ =~ m/\.rrd$/i) && (-f "$dir/$_") } (readdir ($dh));
+    closedir ($dh);
+
+    for (@tmp)
+    {
+      my $name = "$_";
+      $name =~ s/\.rrd$//i;
+      my ($type, $instance) = split (m/-/, $name, 2);
+      $types{$type} = [] if (!$types{$type});
+      push (@{$types{$type}}, $instance) if (defined ($instance));
+    }
+  } # for (@DataDirs)
+
+  return (%types);
+} # _find_types
+
+# sub _find_files_plugin
+# {
+# 	my $host = shift;
+# 	my $plugin = shift;
+# 	my $plugin_instance = shift;
+# 	my $type = shift;
+# 	my $type_instance = shift;
+# 
+# 	my @plugins = ();
+# 	my %files = ();
+# 
+# 	if (!$plugin || ($plugin eq '*'))
 #	{
-#		my $xml;
-#		local $/ = undef;
-#		$xml = <$fh>;
-#
-#		eval
+# 	}
+# 	else
+# 	{
+# 		@plugins = ($plugin);
+# 	}
+# } # _find_files_plugin
+# 
+# sub _find_files_host
+# {
+# 	my $host = shift;
+# 	my $plugin = shift;
+# 	my $plugin_instance = shift;
+# 	my $type = shift;
+# 	my $type_instance = shift;
+# 
+# 	my @hosts = ();
+# 	my %files = ();
+# 
+# 	if (!$host || ($host eq '*'))
+# 	{
+# 		my %hosts;
+# 		for (my $i = 0; $i < @DataDirs; $i++)
 #		{
-#			$conf = xml2pl ($xml);
-#		};
-#		close ($fh);
+# 			my @tmp;
+# 			my $dh;
+# 			
+# 			opendir ($dh, $DataDirs[$i]) or next;
+# 			@tmp = grep { ($_ !~ m/^\./) && (-d $_) } (readdir ($dh));
+# 			closedir ($dh);
+# 
+# 			$hosts{$_} = 1 for (@tmp);
+# 		} # for (@DataDirs)
+# 		@hosts = keys %hosts;
 #	}
+# 	else
+# 	{
+# 		@hosts = ($host);
+# 	}
+# 
+# 	for (my $i = 0; $i < @hosts; $i++)
+# 	{
+# 		my @files = _find_files_plugin ($hosts[$i], $plugin,
+# 			$plugin_instance, $type, $type_instance);
+# 		$files{$_} = 1 for (@files);
+# 	}
+# 
+# 	return (wantarray () ? keys %files : [keys %files]);
+# } # _find_files_host
+# 
+# sub _find_files
+# {
+#   my $host = shift;
+#   my $plugin = shift;
+#   my $plugin_instance = shift;
+#   my $type = shift;
+#   my $type_instance = shift;
+# 
+#   if ($host eq '*')
+#   {
+#     my @hosts = _find_all_hosts ();
+# 
+#   for (my $i = 0; $i < @DataDirs; $i++)
+#   {
+# 
+#   } # for (i)
+# } # _find_files
+
+sub list_hosts
+{
+  my @hosts = _find_hosts ();
+  @hosts = sort (@hosts);
+
+  print "<ul>\n";
+  for (my $i = 0; $i < @hosts; $i++)
+  {
+    my $host_html = encode_entities ($hosts[$i]);
+    my $host_url = uri_escape ($hosts[$i]);
+
+    print qq(  <li><a href="${\script_name ()}?action=show_host;host=$host_url">$host_html</a></li>\n);
+  }
+  print "</ul>\n";
+} # list_hosts
+
+sub action_show_host
+{
+  my $host = shift;
+  my $host_url = uri_escape ($host);
+  my %plugins = _find_plugins ($host);
+
+  print qq(    <div><a href="${\script_name ()}?action=overview">Back to list of hosts</a></div>\n);
+
+  print "<ul>\n";
+  for (sort (keys %plugins))
+  {
+    my $plugin = $_;
+    my $plugin_html = encode_entities ($plugin);
+    my $plugin_url = uri_escape ($plugin);
+
+    for (@{$plugins{$plugin}})
+    {
+      my $instance = $_;
+      my $instance_html = encode_entities ($instance);
+      my $instance_url = uri_escape ($instance);
+
+      print qq#  <li><a href="${\script_name ()}?action=show_plugin;host=$host_url;plugin=$plugin_url;plugin_instance=$instance_url">$plugin_html ($instance_html)</a></li>\n#;
+    }
+
+    if (!@{$plugins{$plugin}})
+    {
+      print qq#  <li><a href="${\script_name ()}?action=show_plugin;host=$host_url;plugin=$plugin_url">$plugin_html</a></li>\n#;
+    }
+  } # for (%plugins)
+  print "</ul>\n";
+} # action_show_host
+
+sub action_show_plugin
+{
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+
+  my $host_url = uri_escape ($host);
+  my $plugin_url = uri_escape ($plugin);
+  my $plugin_instance_url = defined ($plugin_instance) ? uri_escape ($plugin_instance) : undef;
+
+  my %types = _find_types ($host, $plugin, $plugin_instance);
+
+  my $url_prefix = script_name () . "?host=$host_url;plugin=$plugin_url";
+  $url_prefix .= ";plugin_instance=$plugin_instance_url" if (defined ($plugin_instance));
+
+  print qq(    <div><a href="${\script_name ()}?action=show_host;host=$host_url">Back to list of plugins</a></div>\n);
+
+  for (sort (keys %types))
+  {
+    my $type = $_;
+    my $type_html = encode_entities ($type);
+    my $type_url = uri_escape ($type);
+
+    if (!defined ($GraphDefs->{$type}))
+    {
+      print qq#  <div><em>Unknown type &quot;$type_html&quot;</em></div>\n#;
+      next;
+    }
+
+    for (@{$types{$type}})
+    {
+      my $instance = $_;
+      my $instance_html = encode_entities ($instance);
+      my $instance_url = uri_escape ($instance);
+
+      print qq#  <div><a href="$url_prefix;type=$type_url;type_instance=$instance_url;action=show_type"><img src="$url_prefix;type=$type_url;type_instance=$instance_url;action=show_graph" /></a></div>\n#;
+    }
+
+    if (!@{$types{$type}})
+    {
+      print qq#  <div><a href="$url_prefix;type=$type_url;action=show_type"><img src="$url_prefix;type=$type_url;action=show_graph" /></a></div>\n#;
+    }
+  }
+} # action_show_plugin
+
+sub action_show_type
+{
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instance = shift;
+
+  my $host_url = uri_escape ($host);
+  my $plugin_url = uri_escape ($plugin);
+  my $plugin_html = encode_entities ($plugin);
+  my $plugin_instance_url = defined ($plugin_instance) ? uri_escape ($plugin_instance) : undef;
+  my $type_url = uri_escape ($type);
+  my $type_instance_url = defined ($type_instance) ? uri_escape ($type_instance) : undef;
+
+  my $url_prefix = script_name () . "?action=show_plugin;host=$host_url;plugin=$plugin_url";
+  $url_prefix .= ";plugin_instance=$plugin_instance_url" if (defined ($plugin_instance));
+
+  print qq(    <div><a href="$url_prefix">Back to plugin &quot;$plugin_html&quot;</a></div>\n);
+
+  $url_prefix = script_name () . "?action=show_graph;host=$host_url;plugin=$plugin_url";
+  $url_prefix .= ";plugin_instance=$plugin_instance_url" if (defined ($plugin_instance));
+  $url_prefix .= ";type=$type_url";
+  $url_prefix .= ";type_instance=$type_instance_url" if (defined ($type_instance));
+
+  for (qw(hour day week month year))
+  {
+    my $timespan = $_;
+
+    print qq#  <div><img src="$url_prefix;timespan=$timespan" /></div>\n#;
+  }
+} # action_show_type
+
+sub action_show_graph
+{
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instance = shift;
+  my @rrd_args;
+  my $title;
+  
+  my %times = (hour => -3600, day => -86400, week => 7 * -86400, month => 31 * -86400, year => 366 * -86400);
+  my $start_time = $times{$Args->{'timespan'}} || -86400;
+
+  #print STDERR Data::Dumper->Dump ([$Args], ['Args']);
+
+  return if (!defined ($GraphDefs->{$type}));
+  @rrd_args = @{$GraphDefs->{$type}};
+
+  $title = "$host/$plugin" . (defined ($plugin_instance) ? "-$plugin_instance" : '')
+  . "/$type" . (defined ($type_instance) ? "-$type_instance" : '');
+
+  for (my $i = 0; $i < @DataDirs; $i++)
+  {
+    my $file = $DataDirs[$i] . "/$title.rrd";
+    next if (!-f $file);
+
+    s/{file}/$file/ for (@rrd_args);
+
+    RRDs::graph ('-', '-a', 'PNG', '-s', $start_time, '-t', $title, @RRDDefaultArgs, @rrd_args);
+    if (my $err = RRDs::error ())
+    {
+      die ("RRDs::graph: $err");
+    }
+  }
+} # action_show_graph
 
-	if (!$conf)
-	{
-		return ({
-				Colors =>
-				{
-					Back	=> 'FFFFFF',
-					ShadeA	=> 'FFFFFF',
-					ShadeB	=> 'FFFFFF',
-					Font	=> '000000',
-					Canvas	=> 'F5F5F5',
-					Grid	=> 'D0D0D0',
-					MGrid	=> 'A0A0A0',
-					Frame	=> '646464',
-					Arrow	=> 'FF0000',
-
-					FullRed		=> 'FF0000',
-					FullBlue	=> '0000FF',
-					FullGreen	=> '00E000',
-					FullYellow	=> 'F0A000',
-					FullCyan	=> '00A0FF',
-					FullMagenta	=> 'A000FF',
-					Alpha		=> 0.25,
-					HalfRed		=> 'F8B8B8',
-					HalfBlue	=> 'B8B8F8',
-					HalfGreen	=> 'B8F0B8',
-					HalfYellow	=> 'F4F4B8'
-				},
-				Directory => '/var/lib/collectd',
-				HostName  => (defined ($ENV{'SERVER_NAME'}) ? $ENV{'SERVER_NAME'} : 'localhost')
-			});
-	}
-	else
-	{
-		return ($conf);
-	}
-}
-
-sub parse_pathinfo
+sub print_header
 {
-	my @info = @_;
-
-	$AbsDir = $Config->{'Directory'};
-	$RelDir = '';
-
-	while (@info and -d $AbsDir . '/' . $info[0])
-	{
-		my $new = shift (@info);
-		next if ($new =~ m/^\./);
-
-		$AbsDir .= '/' . $new;
-		$RelDir .= '/' . $new;
-	}
-
-	$Type = '';
-	$Inst = '';
-	$TimeSpan = '';
-
-	confess ("parse_pathinfo: too many elements in pathinfo") if (scalar (@info) > 3);
-	return unless (@info);
-
-	$Type = shift (@info);
-	return unless (@info);
-
-	if ($info[-1] =~ m/^(hour|day|week|month|year)$/i)
-	{
-		$TimeSpan = pop (@info);
-	}
-
-	$Inst = shift (@info) if (@info);
+  print <<HEAD;
+Content-Type: application/xhtml+xml; charset=utf-8
+Cache-Control: no-cache
 
-	confess ("unrecognized elements in pathinfo") if (@info);
-}
+<?xml version="1.0" encoding="utf-8"?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
+  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
+
+<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
+  <head>
+    <title>collection.cgi, Version 2</title>
+    <style type="text/css">
+      img
+      {
+	border: none;
+      }
+    </style>
+  </head>
+
+  <body>
+HEAD
+} # print_header
 
-sub get_all_files
+sub print_footer
 {
-	my $dir = @_ ? shift : $Config->{'Directory'};
-	my $hash = {};
-	my $dh;
-
-	if (opendir ($dh, $dir))
-	{
-		while (my $thing = readdir ($dh))
-		{
-			next if ($thing =~ m/^\./);
-
-			my $type;
-			my $inst;
-
-			if ($thing =~ m/^(\w+)-([\w\-\.]+)\.rrd$/)
-			{
-				$type = $1;
-				$inst = $2;
-			}
-			elsif ($thing =~ m/^(\w+)\.rrd$/)
-			{
-				$type = $1;
-				$inst = '';
-			}
-			else
-			{
-				next;
-			}
-
-			# Only load RRD files we can actually display..
-			next unless (defined ($GraphDefs->{$type}));
-
-			$hash->{$type} = [] unless (defined ($hash->{$type}));
-			push (@{$hash->{$type}}, $inst);
-		}
-
-		closedir ($dh);
-	}
-
-	return ($hash);
-}
+  print <<FOOT;
+  </body>
+</html>
+FOOT
+} # print_footer
 
-sub get_all_dirs
+sub main
 {
-	my $dir = @_ ? shift : $Config->{'Directory'};
-	my @ret = ();
-	my $dh;
+	read_config ();
+	validate_args ();
 
-	if (opendir ($dh, $dir))
+	if (defined ($Args->{'host'})
+	  && defined ($Args->{'plugin'})
+	  && defined ($Args->{'type'})
+	  && ($Args->{'action'} eq 'show_graph'))
 	{
-		while (my $thing = readdir ($dh))
-		{
-			next if ($thing =~ m/^\./);
-
-			next if (!-d "$dir/$thing");
-
-			push (@ret, $thing);
-		}
-
-		closedir ($dh);
+	  $| = 1;
+	  print STDOUT header (-Content_Type => 'image/png');
+	  action_show_graph ($Args->{'host'},
+	    $Args->{'plugin'}, $Args->{'plugin_instance'},
+	    $Args->{'type'}, $Args->{'type_instance'});
+	  return (0);
 	}
 
-	return (@ret) if (wantarray ());
-	return (\@ret);
-}
-
-sub color_hex2rgb
-{
-	my $color = shift;
-
-	my ($red, $green, $blue) = map { ord (pack ("H2", $_)) } ($color =~ m/([A-Fa-f0-9]{2})/g);
-	#print STDERR "$color -> rgb($red,$green,$blue)\n";
-
-	return ($red, $green, $blue);
-}
-
-sub color_rgb2hex
-{
-	croak unless (scalar (@_) == 3);
-	
-	my ($red, $green, $blue) = @_;
-
-	my $ret = sprintf ("%02X%02X%02X", $red, $green, $blue);
-	#print STDERR "rgb($red,$green,$blue) -> $ret\n";
-
-	return ($ret);
-}
-
-sub color_calculate_transparent
-{
-	my $alpha = shift;
-	my $canvas = [color_hex2rgb (shift)];
-	my @colors = map { [color_hex2rgb ($_)] } (@_);
+	print_header ();
 
-	if (($alpha < 0.0) or ($alpha > 1.0))
+	if (!$Args->{'host'})
 	{
-		$alpha = 1.0;
+	  list_hosts ();
 	}
-
-	if ($alpha == 0.0)
+	elsif (!$Args->{'plugin'})
 	{
-		return (color_rgb2hex (@$canvas));
+	  action_show_host ($Args->{'host'});
 	}
-	if ($alpha == 1.0)
+	elsif (!$Args->{'type'})
 	{
-		return (color_rgb2hex (@{$colors[-1]}));
+	  action_show_plugin ($Args->{'host'},
+	    $Args->{'plugin'}, $Args->{'plugin_instance'});
 	}
-
-	my $ret = _color_calculate_transparent ($alpha, $canvas, @colors);
-
-	return (color_rgb2hex (@$ret));
-}
-
-sub _color_calculate_transparent
-{
-	my $alpha = shift;
-	my $canvas = shift;
-	my $color = shift;
-	my @colors = @_ ? shift : ();
-	my $ret = [0, 0, 0];
-
-	for (my $i = 0; $i < 3; $i++)
-	{
-		$ret->[$i] = ($alpha * $color->[$i]) + ((1 - $alpha) * $canvas->[$i]);
-	}
-
-	return (_color_calculate_transparent ($alpha, $ret, @colors)) if (@colors);
-	return ($ret);
-}
-
-sub get_n_colors
-{
-	my $num = shift;
-	my @ret = ();
-
-	for (my $i = 0; $i < $num; $i++)
+	else
 	{
-		my $pos = 6 * $i / $num;
-		my $n = int ($pos);
-		my $p = $pos - $n;
-		my $q = 1 - $p;
-
-		my $red   = 0;
-		my $green = 0;
-		my $blue  = 0;
-
-		if ($n == 0)
-		{
-			$red  = 255;
-			$blue = 255 * $p;
-		}
-		elsif ($n == 1)
-		{
-			$red  = 255 * $q;
-			$blue = 255;
-		}
-		elsif ($n == 2)
-		{
-			$green = 255 * $p;
-			$blue  = 255;
-		}
-		elsif ($n == 3)
-		{
-			$green = 255;
-			$blue  = 255 * $q;
-		}
-		elsif ($n == 4)
-		{
-			$red   = 255 * $p;
-			$green = 255;
-		}
-		elsif ($n == 5)
-		{
-			$red   = 255;
-			$green = 255 * $q;
-		}
-		else { die; }
-
-		push (@ret, sprintf ("%02x%02x%02x", $red, $green, $blue));
-	}
-
-	return (@ret);
-}
+	  action_show_type ($Args->{'host'},
+	    $Args->{'plugin'}, $Args->{'plugin_instance'},
+	    $Args->{'type'}, $Args->{'type_instance'});
+	}
+
+	print_footer ();
+
+	return (0);
+}
+
+sub load_graph_definitions
+{
+  my $Canvas = 'FFFFFF';
+
+  my $FullRed    = 'FF0000';
+  my $FullGreen  = '00E000';
+  my $FullBlue   = '0000FF';
+  my $FullYellow = 'F0A000';
+  my $FullCyan   = '00A0FF';
+  my $FullMagenta= 'A000FF';
+
+  my $HalfRed    = 'F7B7B7';
+  my $HalfGreen  = 'B7EFB7';
+  my $HalfBlue   = 'B7B7F7';
+  my $HalfYellow = 'F3DFB7';
+  my $HalfCyan   = 'B7DFF7';
+  my $HalfMagenta= 'DFB7F7';
+
+  my $HalfBlueGreen = '89B3C9';
+
+  $GraphDefs =
+  {
+    apache_bytes => ['DEF:min_raw={file}:count:MIN',
+    'DEF:avg_raw={file}:count:AVERAGE',
+    'DEF:max_raw={file}:count:MAX',
+    'CDEF:min=min_raw,8,*',
+    'CDEF:avg=avg_raw,8,*',
+    'CDEF:max=max_raw,8,*',
+    'CDEF:mytime=avg_raw,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:avg_sample=avg_raw,UN,0,avg_raw,IF,sample_len,*',
+    'CDEF:avg_sum=PREV,UN,0,PREV,IF,avg_sample,+',
+    "AREA:avg#$HalfBlue",
+    "LINE1:avg#$FullBlue:Bit/s",
+    'GPRINT:min:MIN:%5.1lf%s Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:max:MAX:%5.1lf%s Max,',
+    'GPRINT:avg:LAST:%5.1lf%s Last',
+    'GPRINT:avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
+    ],
+    apache_requests => ['DEF:min={file}:count:MIN',
+    'DEF:avg={file}:count:AVERAGE',
+    'DEF:max={file}:count:MAX',
+    'CDEF:moving_average=PREV,UN,avg,PREV,IF,0.8,*,avg,0.2,*,+',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    'LINE1:moving_average#000000',
+    "LINE1:avg#$FullBlue:Requests/s",
+    'GPRINT:min:MIN:%6.2lf Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:max:MAX:%6.2lf Max,',
+    'GPRINT:avg:LAST:%6.2lf Last'
+    ],
+    apache_scoreboard => ['DEF:min={file}:count:MIN',
+    'DEF:avg={file}:count:AVERAGE',
+    'DEF:max={file}:count:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Processes",
+    'GPRINT:min:MIN:%6.2lf Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:max:MAX:%6.2lf Max,',
+    'GPRINT:avg:LAST:%6.2lf Last'
+    ],
+    charge => [
+    'DEF:avg={file}:charge:AVERAGE',
+    'DEF:min={file}:charge:MIN',
+    'DEF:max={file}:charge:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Charge",
+    'GPRINT:min:MIN:%5.1lf%sAh Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%sAh Avg,',
+    'GPRINT:max:MAX:%5.1lf%sAh Max,',
+    'GPRINT:avg:LAST:%5.1lf%sAh Last\l'
+    ],
+    charge_percent => [
+    'DEF:avg={file}:percent:AVERAGE',
+    'DEF:min={file}:percent:MIN',
+    'DEF:max={file}:percent:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Charge",
+    'GPRINT:min:MIN:%5.1lf%s%% Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%s%% Avg,',
+    'GPRINT:max:MAX:%5.1lf%s%% Max,',
+    'GPRINT:avg:LAST:%5.1lf%s%% Last\l'
+    ],
+    cpu => ['-v', 'CPU load',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Percent",
+    'GPRINT:min:MIN:%6.2lf%% Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf%% Avg,',
+    'GPRINT:max:MAX:%6.2lf%% Max,',
+    'GPRINT:avg:LAST:%6.2lf%% Last\l'
+    ],
+    current => [
+    'DEF:avg={file}:current:AVERAGE',
+    'DEF:min={file}:current:MIN',
+    'DEF:max={file}:current:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Current",
+    'GPRINT:min:MIN:%5.1lf%sA Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%sA Avg,',
+    'GPRINT:max:MAX:%5.1lf%sA Max,',
+    'GPRINT:avg:LAST:%5.1lf%sA Last\l'
+    ],
+    df => ['-v', 'Percent',
+    'DEF:free_avg={file}:free:AVERAGE',
+    'DEF:free_min={file}:free:MIN',
+    'DEF:free_max={file}:free:MAX',
+    'DEF:used_avg={file}:used:AVERAGE',
+    'DEF:used_min={file}:used:MIN',
+    'DEF:used_max={file}:used:MAX',
+    'CDEF:total=free_avg,used_avg,+',
+    'CDEF:free_pct=100,free_avg,*,total,/',
+    'CDEF:used_pct=100,used_avg,*,total,/',
+    'CDEF:free_acc=free_pct,used_pct,+',
+    'CDEF:used_acc=used_pct',
+    "AREA:free_acc#$HalfGreen",
+    "AREA:used_acc#$HalfRed",
+    "LINE1:free_acc#$FullGreen:Free",
+    'GPRINT:free_min:MIN:%5.1lf%sB Min,',
+    'GPRINT:free_avg:AVERAGE:%5.1lf%sB Avg,',
+    'GPRINT:free_max:MAX:%5.1lf%sB Max,',
+    'GPRINT:free_avg:LAST:%5.1lf%sB Last\l',
+    "LINE1:used_acc#$FullRed:Used",
+    'GPRINT:used_min:MIN:%5.1lf%sB Min,',
+    'GPRINT:used_avg:AVERAGE:%5.1lf%sB Avg,',
+    'GPRINT:used_max:MAX:%5.1lf%sB Max,',
+    'GPRINT:used_avg:LAST:%5.1lf%sB Last\l'
+    ],
+    disk => [
+    'DEF:rtime_avg={file}:rtime:AVERAGE',
+    'DEF:rtime_min={file}:rtime:MIN',
+    'DEF:rtime_max={file}:rtime:MAX',
+    'DEF:wtime_avg={file}:wtime:AVERAGE',
+    'DEF:wtime_min={file}:wtime:MIN',
+    'DEF:wtime_max={file}:wtime:MAX',
+    'CDEF:rtime_avg_ms=rtime_avg,1000,/',
+    'CDEF:rtime_min_ms=rtime_min,1000,/',
+    'CDEF:rtime_max_ms=rtime_max,1000,/',
+    'CDEF:wtime_avg_ms=wtime_avg,1000,/',
+    'CDEF:wtime_min_ms=wtime_min,1000,/',
+    'CDEF:wtime_max_ms=wtime_max,1000,/',
+    'CDEF:total_avg_ms=rtime_avg_ms,wtime_avg_ms,+',
+    'CDEF:total_min_ms=rtime_min_ms,wtime_min_ms,+',
+    'CDEF:total_max_ms=rtime_max_ms,wtime_max_ms,+',
+    "AREA:total_max_ms#$HalfRed",
+    "AREA:total_min_ms#$Canvas",
+    "LINE1:wtime_avg_ms#$FullGreen:Write",
+    'GPRINT:wtime_min_ms:MIN:%5.1lf%s Min,',
+    'GPRINT:wtime_avg_ms:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:wtime_max_ms:MAX:%5.1lf%s Max,',
+    'GPRINT:wtime_avg_ms:LAST:%5.1lf%s Last\n',
+    "LINE1:rtime_avg_ms#$FullBlue:Read ",
+    'GPRINT:rtime_min_ms:MIN:%5.1lf%s Min,',
+    'GPRINT:rtime_avg_ms:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:rtime_max_ms:MAX:%5.1lf%s Max,',
+    'GPRINT:rtime_avg_ms:LAST:%5.1lf%s Last\n',
+    "LINE1:total_avg_ms#$FullRed:Total",
+    'GPRINT:total_min_ms:MIN:%5.1lf%s Min,',
+    'GPRINT:total_avg_ms:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:total_max_ms:MAX:%5.1lf%s Max,',
+    'GPRINT:total_avg_ms:LAST:%5.1lf%s Last'
+    ],
+    disk_octets => ['-v', 'Bytes/s',
+    'DEF:out_min={file}:write:MIN',
+    'DEF:out_avg={file}:write:AVERAGE',
+    'DEF:out_max={file}:write:MAX',
+    'DEF:inc_min={file}:read:MIN',
+    'DEF:inc_avg={file}:read:AVERAGE',
+    'DEF:inc_max={file}:read:MAX',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    'CDEF:mytime=out_avg,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:out_avg_sample=out_avg,UN,0,out_avg,IF,sample_len,*',
+    'CDEF:out_avg_sum=PREV,UN,0,PREV,IF,out_avg_sample,+',
+    'CDEF:inc_avg_sample=inc_avg,UN,0,inc_avg,IF,sample_len,*',
+    'CDEF:inc_avg_sum=PREV,UN,0,PREV,IF,inc_avg_sample,+',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Written",
+    'GPRINT:out_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:out_max:MAX:%5.1lf%s Max,',
+    'GPRINT:out_avg:LAST:%5.1lf%s Last',
+    'GPRINT:out_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
+    "LINE1:inc_avg#$FullBlue:Read   ",
+    'GPRINT:inc_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:inc_max:MAX:%5.1lf%s Max,',
+    'GPRINT:inc_avg:LAST:%5.1lf%s Last',
+    'GPRINT:inc_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
+    ],
+    disk_merged => ['-v', 'Merged Ops/s',
+    'DEF:out_min={file}:write:MIN',
+    'DEF:out_avg={file}:write:AVERAGE',
+    'DEF:out_max={file}:write:MAX',
+    'DEF:inc_min={file}:read:MIN',
+    'DEF:inc_avg={file}:read:AVERAGE',
+    'DEF:inc_max={file}:read:MAX',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Written",
+    'GPRINT:out_avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:out_max:MAX:%6.2lf Max,',
+    'GPRINT:out_avg:LAST:%6.2lf Last\l',
+    "LINE1:inc_avg#$FullBlue:Read   ",
+    'GPRINT:inc_avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:inc_max:MAX:%6.2lf Max,',
+    'GPRINT:inc_avg:LAST:%6.2lf Last\l'
+    ],
+    disk_ops => ['-v', 'Ops/s',
+    'DEF:out_min={file}:write:MIN',
+    'DEF:out_avg={file}:write:AVERAGE',
+    'DEF:out_max={file}:write:MAX',
+    'DEF:inc_min={file}:read:MIN',
+    'DEF:inc_avg={file}:read:AVERAGE',
+    'DEF:inc_max={file}:read:MAX',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Written",
+    'GPRINT:out_avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:out_max:MAX:%6.2lf Max,',
+    'GPRINT:out_avg:LAST:%6.2lf Last\l',
+    "LINE1:inc_avg#$FullBlue:Read   ",
+    'GPRINT:inc_avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:inc_max:MAX:%6.2lf Max,',
+    'GPRINT:inc_avg:LAST:%6.2lf Last\l'
+    ],
+    disk_time => ['-v', 'Seconds/s',
+    'DEF:out_min_raw={file}:write:MIN',
+    'DEF:out_avg_raw={file}:write:AVERAGE',
+    'DEF:out_max_raw={file}:write:MAX',
+    'DEF:inc_min_raw={file}:read:MIN',
+    'DEF:inc_avg_raw={file}:read:AVERAGE',
+    'DEF:inc_max_raw={file}:read:MAX',
+    'CDEF:out_min=out_min_raw,1000,/',
+    'CDEF:out_avg=out_avg_raw,1000,/',
+    'CDEF:out_max=out_max_raw,1000,/',
+    'CDEF:inc_min=inc_min_raw,1000,/',
+    'CDEF:inc_avg=inc_avg_raw,1000,/',
+    'CDEF:inc_max=inc_max_raw,1000,/',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Written",
+    'GPRINT:out_avg:AVERAGE:%5.1lf%ss Avg,',
+    'GPRINT:out_max:MAX:%5.1lf%ss Max,',
+    'GPRINT:out_avg:LAST:%5.1lf%ss Last\l',
+    "LINE1:inc_avg#$FullBlue:Read   ",
+    'GPRINT:inc_avg:AVERAGE:%5.1lf%ss Avg,',
+    'GPRINT:inc_max:MAX:%5.1lf%ss Max,',
+    'GPRINT:inc_avg:LAST:%5.1lf%ss Last\l'
+    ],
+    dns_traffic => ['DEF:rsp_min_raw={file}:responses:MIN',
+    'DEF:rsp_avg_raw={file}:responses:AVERAGE',
+    'DEF:rsp_max_raw={file}:responses:MAX',
+    'DEF:qry_min_raw={file}:queries:MIN',
+    'DEF:qry_avg_raw={file}:queries:AVERAGE',
+    'DEF:qry_max_raw={file}:queries:MAX',
+    'CDEF:rsp_min=rsp_min_raw,8,*',
+    'CDEF:rsp_avg=rsp_avg_raw,8,*',
+    'CDEF:rsp_max=rsp_max_raw,8,*',
+    'CDEF:qry_min=qry_min_raw,8,*',
+    'CDEF:qry_avg=qry_avg_raw,8,*',
+    'CDEF:qry_max=qry_max_raw,8,*',
+    'CDEF:overlap=rsp_avg,qry_avg,GT,qry_avg,rsp_avg,IF',
+    'CDEF:mytime=rsp_avg_raw,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:rsp_avg_sample=rsp_avg_raw,UN,0,rsp_avg_raw,IF,sample_len,*',
+    'CDEF:rsp_avg_sum=PREV,UN,0,PREV,IF,rsp_avg_sample,+',
+    'CDEF:qry_avg_sample=qry_avg_raw,UN,0,qry_avg_raw,IF,sample_len,*',
+    'CDEF:qry_avg_sum=PREV,UN,0,PREV,IF,qry_avg_sample,+',
+    "AREA:rsp_avg#$HalfGreen",
+    "AREA:qry_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:rsp_avg#$FullGreen:Responses",
+    'GPRINT:rsp_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:rsp_max:MAX:%5.1lf%s Max,',
+    'GPRINT:rsp_avg:LAST:%5.1lf%s Last',
+    'GPRINT:rsp_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
+    "LINE1:qry_avg#$FullBlue:Queries  ",
+    #'GPRINT:qry_min:MIN:%5.1lf %s Min,',
+    'GPRINT:qry_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:qry_max:MAX:%5.1lf%s Max,',
+    'GPRINT:qry_avg:LAST:%5.1lf%s Last',
+    'GPRINT:qry_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
+    ],
+    email => [
+    'DEF:avg={file}:count:AVERAGE',
+    'DEF:min={file}:count:MIN',
+    'DEF:max={file}:count:MAX',
+    "AREA:max#$HalfMagenta",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullMagenta:Count ",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    email_size => [
+    'DEF:avg={file}:size:AVERAGE',
+    'DEF:min={file}:size:MIN',
+    'DEF:max={file}:size:MAX',
+    "AREA:max#$HalfMagenta",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullMagenta:Count ",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    spam_score => ['-v', 'Score',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Score ",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    spam_check => [
+    'DEF:avg={file}:hits:AVERAGE',
+    'DEF:min={file}:hits:MIN',
+    'DEF:max={file}:hits:MAX',
+    "AREA:max#$HalfMagenta",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullMagenta:Count ",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    entropy => ['DEF:avg={file}:entropy:AVERAGE',
+    'DEF:min={file}:entropy:MIN',
+    'DEF:max={file}:entropy:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Bits",
+    'GPRINT:min:MIN:%4.0lfbit Min,',
+    'GPRINT:avg:AVERAGE:%4.0lfbit Avg,',
+    'GPRINT:max:MAX:%4.0lfbit Max,',
+    'GPRINT:avg:LAST:%4.0lfbit Last\l'
+    ],
+    fanspeed => ['-v', 'RPM',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfMagenta",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullMagenta:RPM",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    frequency => ['-v', 'Hertz',
+    'DEF:avg={file}:frequency:AVERAGE',
+    'DEF:min={file}:frequency:MIN',
+    'DEF:max={file}:frequency:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Frequency [Hz]",
+    'GPRINT:min:MIN:%4.1lf Min,',
+    'GPRINT:avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:max:MAX:%4.1lf Max,',
+    'GPRINT:avg:LAST:%4.1lf Last\l'
+    ],
+    frequency_offset => [ # NTPd
+    'DEF:ppm_avg={file}:ppm:AVERAGE',
+    'DEF:ppm_min={file}:ppm:MIN',
+    'DEF:ppm_max={file}:ppm:MAX',
+    "AREA:ppm_max#$HalfBlue",
+    "AREA:ppm_min#$Canvas",
+    "LINE1:ppm_avg#$FullBlue:{inst}",
+    'GPRINT:ppm_min:MIN:%5.2lf Min,',
+    'GPRINT:ppm_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:ppm_max:MAX:%5.2lf Max,',
+    'GPRINT:ppm_avg:LAST:%5.2lf Last'
+    ],
+    hddtemp => [
+    'DEF:temp_avg={file}:value:AVERAGE',
+    'DEF:temp_min={file}:value:MIN',
+    'DEF:temp_max={file}:value:MAX',
+    "AREA:temp_max#$HalfRed",
+    "AREA:temp_min#$Canvas",
+    "LINE1:temp_avg#$FullRed:Temperature",
+    'GPRINT:temp_min:MIN:%4.1lf Min,',
+    'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:temp_max:MAX:%4.1lf Max,',
+    'GPRINT:temp_avg:LAST:%4.1lf Last\l'
+    ],
+    if_packets => ['-v', 'Packets/s',
+    'DEF:tx_min={file}:tx:MIN',
+    'DEF:tx_avg={file}:tx:AVERAGE',
+    'DEF:tx_max={file}:tx:MAX',
+    'DEF:rx_min={file}:rx:MIN',
+    'DEF:rx_avg={file}:rx:AVERAGE',
+    'DEF:rx_max={file}:rx:MAX',
+    'CDEF:overlap=tx_avg,rx_avg,GT,rx_avg,tx_avg,IF',
+    'CDEF:mytime=tx_avg,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:tx_avg_sample=tx_avg,UN,0,tx_avg,IF,sample_len,*',
+    'CDEF:tx_avg_sum=PREV,UN,0,PREV,IF,tx_avg_sample,+',
+    'CDEF:rx_avg_sample=rx_avg,UN,0,rx_avg,IF,sample_len,*',
+    'CDEF:rx_avg_sum=PREV,UN,0,PREV,IF,rx_avg_sample,+',
+    "AREA:tx_avg#$HalfGreen",
+    "AREA:rx_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:tx_avg#$FullGreen:TX",
+    'GPRINT:tx_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:tx_max:MAX:%5.1lf%s Max,',
+    'GPRINT:tx_avg:LAST:%5.1lf%s Last',
+    'GPRINT:tx_avg_sum:LAST:(ca. %4.0lf%s Total)\l',
+    "LINE1:rx_avg#$FullBlue:RX",
+    #'GPRINT:rx_min:MIN:%5.1lf %s Min,',
+    'GPRINT:rx_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:rx_max:MAX:%5.1lf%s Max,',
+    'GPRINT:rx_avg:LAST:%5.1lf%s Last',
+    'GPRINT:rx_avg_sum:LAST:(ca. %4.0lf%s Total)\l'
+    ],
+    irq => ['-v', 'Issues/s',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Issues/s",
+    'GPRINT:min:MIN:%6.2lf Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:max:MAX:%6.2lf Max,',
+    'GPRINT:avg:LAST:%6.2lf Last\l'
+    ],
+    load => ['DEF:s_avg={file}:shortterm:AVERAGE',
+    'DEF:s_min={file}:shortterm:MIN',
+    'DEF:s_max={file}:shortterm:MAX',
+    'DEF:m_avg={file}:midterm:AVERAGE',
+    'DEF:m_min={file}:midterm:MIN',
+    'DEF:m_max={file}:midterm:MAX',
+    'DEF:l_avg={file}:longterm:AVERAGE',
+    'DEF:l_min={file}:longterm:MIN',
+    'DEF:l_max={file}:longterm:MAX',
+    "AREA:s_max#$HalfGreen",
+    "AREA:s_min#$Canvas",
+    "LINE1:s_avg#$FullGreen: 1m average",
+    'GPRINT:s_min:MIN:%4.2lf Min,',
+    'GPRINT:s_avg:AVERAGE:%4.2lf Avg,',
+    'GPRINT:s_max:MAX:%4.2lf Max,',
+    'GPRINT:s_avg:LAST:%4.2lf Last\n',
+    "LINE1:m_avg#$FullBlue: 5m average",
+    'GPRINT:m_min:MIN:%4.2lf Min,',
+    'GPRINT:m_avg:AVERAGE:%4.2lf Avg,',
+    'GPRINT:m_max:MAX:%4.2lf Max,',
+    'GPRINT:m_avg:LAST:%4.2lf Last\n',
+    "LINE1:l_avg#$FullRed:15m average",
+    'GPRINT:l_min:MIN:%4.2lf Min,',
+    'GPRINT:l_avg:AVERAGE:%4.2lf Avg,',
+    'GPRINT:l_max:MAX:%4.2lf Max,',
+    'GPRINT:l_avg:LAST:%4.2lf Last'
+    ],
+    load_percent => [
+    'DEF:avg={file}:percent:AVERAGE',
+    'DEF:min={file}:percent:MIN',
+    'DEF:max={file}:percent:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Load",
+    'GPRINT:min:MIN:%5.1lf%s%% Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%s%% Avg,',
+    'GPRINT:max:MAX:%5.1lf%s%% Max,',
+    'GPRINT:avg:LAST:%5.1lf%s%% Last\l'
+    ],
+    mails => ['DEF:rawgood={file}:good:AVERAGE',
+    'DEF:rawspam={file}:spam:AVERAGE',
+    'CDEF:good=rawgood,UN,0,rawgood,IF',
+    'CDEF:spam=rawspam,UN,0,rawspam,IF',
+    'CDEF:negspam=spam,-1,*',
+    "AREA:good#$HalfGreen",
+    "LINE1:good#$FullGreen:Good mails",
+    'GPRINT:good:AVERAGE:%4.1lf Avg,',
+    'GPRINT:good:MAX:%4.1lf Max,',
+    'GPRINT:good:LAST:%4.1lf Last\n',
+    "AREA:negspam#$HalfRed",
+    "LINE1:negspam#$FullRed:Spam mails",
+    'GPRINT:spam:AVERAGE:%4.1lf Avg,',
+    'GPRINT:spam:MAX:%4.1lf Max,',
+    'GPRINT:spam:LAST:%4.1lf Last',
+    'HRULE:0#000000'
+    ],
+    memory => ['-b', '1024', '-v', 'Bytes',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Memory",
+    'GPRINT:min:MIN:%5.1lf%sbyte Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%sbyte Avg,',
+    'GPRINT:max:MAX:%5.1lf%sbyte Max,',
+    'GPRINT:avg:LAST:%5.1lf%sbyte Last\l'
+    ],
+    old_memory => [
+    'DEF:used_avg={file}:used:AVERAGE',
+    'DEF:free_avg={file}:free:AVERAGE',
+    'DEF:buffers_avg={file}:buffers:AVERAGE',
+    'DEF:cached_avg={file}:cached:AVERAGE',
+    'DEF:used_min={file}:used:MIN',
+    'DEF:free_min={file}:free:MIN',
+    'DEF:buffers_min={file}:buffers:MIN',
+    'DEF:cached_min={file}:cached:MIN',
+    'DEF:used_max={file}:used:MAX',
+    'DEF:free_max={file}:free:MAX',
+    'DEF:buffers_max={file}:buffers:MAX',
+    'DEF:cached_max={file}:cached:MAX',
+    'CDEF:cached_avg_nn=cached_avg,UN,0,cached_avg,IF',
+    'CDEF:buffers_avg_nn=buffers_avg,UN,0,buffers_avg,IF',
+    'CDEF:free_cached_buffers_used=free_avg,cached_avg_nn,+,buffers_avg_nn,+,used_avg,+',
+    'CDEF:cached_buffers_used=cached_avg,buffers_avg_nn,+,used_avg,+',
+    'CDEF:buffers_used=buffers_avg,used_avg,+',
+    "AREA:free_cached_buffers_used#$HalfGreen",
+    "AREA:cached_buffers_used#$HalfBlue",
+    "AREA:buffers_used#$HalfYellow",
+    "AREA:used_avg#$HalfRed",
+    "LINE1:free_cached_buffers_used#$FullGreen:Free        ",
+    'GPRINT:free_min:MIN:%5.1lf%s Min,',
+    'GPRINT:free_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:free_max:MAX:%5.1lf%s Max,',
+    'GPRINT:free_avg:LAST:%5.1lf%s Last\n',
+    "LINE1:cached_buffers_used#$FullBlue:Page cache  ",
+    'GPRINT:cached_min:MIN:%5.1lf%s Min,',
+    'GPRINT:cached_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:cached_max:MAX:%5.1lf%s Max,',
+    'GPRINT:cached_avg:LAST:%5.1lf%s Last\n',
+    "LINE1:buffers_used#$FullYellow:Buffer cache",
+    'GPRINT:buffers_min:MIN:%5.1lf%s Min,',
+    'GPRINT:buffers_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:buffers_max:MAX:%5.1lf%s Max,',
+    'GPRINT:buffers_avg:LAST:%5.1lf%s Last\n',
+    "LINE1:used_avg#$FullRed:Used        ",
+    'GPRINT:used_min:MIN:%5.1lf%s Min,',
+    'GPRINT:used_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:used_max:MAX:%5.1lf%s Max,',
+    'GPRINT:used_avg:LAST:%5.1lf%s Last'
+    ],
+    mysql_commands => ['-v', 'Issues/s',
+    "DEF:val_avg={file}:value:AVERAGE",
+    "DEF:val_min={file}:value:MIN",
+    "DEF:val_max={file}:value:MAX",
+    "AREA:val_max#$HalfBlue",
+    "AREA:val_min#$Canvas",
+    "LINE1:val_avg#$FullBlue:{inst}",
+    'GPRINT:val_min:MIN:%5.2lf Min,',
+    'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:val_max:MAX:%5.2lf Max,',
+    'GPRINT:val_avg:LAST:%5.2lf Last'
+    ],
+    mysql_handler => ['-v', 'Issues/s',
+    "DEF:val_avg={file}:value:AVERAGE",
+    "DEF:val_min={file}:value:MIN",
+    "DEF:val_max={file}:value:MAX",
+    "AREA:val_max#$HalfBlue",
+    "AREA:val_min#$Canvas",
+    "LINE1:val_avg#$FullBlue:{inst}",
+    'GPRINT:val_min:MIN:%5.2lf Min,',
+    'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:val_max:MAX:%5.2lf Max,',
+    'GPRINT:val_avg:LAST:%5.2lf Last'
+    ],
+    mysql_octets => ['-v', 'Bytes/s',
+    'DEF:out_min={file}:tx:MIN',
+    'DEF:out_avg={file}:tx:AVERAGE',
+    'DEF:out_max={file}:tx:MAX',
+    'DEF:inc_min={file}:rx:MIN',
+    'DEF:inc_avg={file}:rx:AVERAGE',
+    'DEF:inc_max={file}:rx:MAX',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    'CDEF:mytime=out_avg,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:out_avg_sample=out_avg,UN,0,out_avg,IF,sample_len,*',
+    'CDEF:out_avg_sum=PREV,UN,0,PREV,IF,out_avg_sample,+',
+    'CDEF:inc_avg_sample=inc_avg,UN,0,inc_avg,IF,sample_len,*',
+    'CDEF:inc_avg_sum=PREV,UN,0,PREV,IF,inc_avg_sample,+',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Written",
+    'GPRINT:out_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:out_max:MAX:%5.1lf%s Max,',
+    'GPRINT:out_avg:LAST:%5.1lf%s Last',
+    'GPRINT:out_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
+    "LINE1:inc_avg#$FullBlue:Read   ",
+    'GPRINT:inc_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:inc_max:MAX:%5.1lf%s Max,',
+    'GPRINT:inc_avg:LAST:%5.1lf%s Last',
+    'GPRINT:inc_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
+    ],
+    mysql_qcache => ['-v', 'Queries/s',
+    "DEF:hits_min={file}:hits:MIN",
+    "DEF:hits_avg={file}:hits:AVERAGE",
+    "DEF:hits_max={file}:hits:MAX",
+    "DEF:inserts_min={file}:inserts:MIN",
+    "DEF:inserts_avg={file}:inserts:AVERAGE",
+    "DEF:inserts_max={file}:inserts:MAX",
+    "DEF:not_cached_min={file}:not_cached:MIN",
+    "DEF:not_cached_avg={file}:not_cached:AVERAGE",
+    "DEF:not_cached_max={file}:not_cached:MAX",
+    "DEF:lowmem_prunes_min={file}:lowmem_prunes:MIN",
+    "DEF:lowmem_prunes_avg={file}:lowmem_prunes:AVERAGE",
+    "DEF:lowmem_prunes_max={file}:lowmem_prunes:MAX",
+    "DEF:queries_min={file}:queries_in_cache:MIN",
+    "DEF:queries_avg={file}:queries_in_cache:AVERAGE",
+    "DEF:queries_max={file}:queries_in_cache:MAX",
+    "CDEF:unknown=queries_avg,UNKN,+",
+    "CDEF:not_cached_agg=hits_avg,inserts_avg,+,not_cached_avg,+",
+    "CDEF:inserts_agg=hits_avg,inserts_avg,+",
+    "CDEF:hits_agg=hits_avg",
+    "AREA:not_cached_agg#$HalfYellow",
+    "AREA:inserts_agg#$HalfBlue",
+    "AREA:hits_agg#$HalfGreen",
+    "LINE1:not_cached_agg#$FullYellow:Not Cached      ",
+    'GPRINT:not_cached_min:MIN:%5.2lf Min,',
+    'GPRINT:not_cached_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:not_cached_max:MAX:%5.2lf Max,',
+    'GPRINT:not_cached_avg:LAST:%5.2lf Last\l',
+    "LINE1:inserts_agg#$FullBlue:Inserts         ",
+    'GPRINT:inserts_min:MIN:%5.2lf Min,',
+    'GPRINT:inserts_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:inserts_max:MAX:%5.2lf Max,',
+    'GPRINT:inserts_avg:LAST:%5.2lf Last\l',
+    "LINE1:hits_agg#$FullGreen:Hits            ",
+    'GPRINT:hits_min:MIN:%5.2lf Min,',
+    'GPRINT:hits_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:hits_max:MAX:%5.2lf Max,',
+    'GPRINT:hits_avg:LAST:%5.2lf Last\l',
+    "LINE1:lowmem_prunes_avg#$FullRed:Lowmem Prunes   ",
+    'GPRINT:lowmem_prunes_min:MIN:%5.2lf Min,',
+    'GPRINT:lowmem_prunes_avg:AVERAGE:%5.2lf Avg,',
+    'GPRINT:lowmem_prunes_max:MAX:%5.2lf Max,',
+    'GPRINT:lowmem_prunes_avg:LAST:%5.2lf Last\l',
+    "LINE1:unknown#$Canvas:Queries in cache",
+    'GPRINT:queries_min:MIN:%5.0lf Min,',
+    'GPRINT:queries_avg:AVERAGE:%5.0lf Avg,',
+    'GPRINT:queries_max:MAX:%5.0lf Max,',
+    'GPRINT:queries_avg:LAST:%5.0lf Last\l'
+    ],
+    mysql_threads => ['-v', 'Threads',
+    "DEF:running_min={file}:running:MIN",
+    "DEF:running_avg={file}:running:AVERAGE",
+    "DEF:running_max={file}:running:MAX",
+    "DEF:connected_min={file}:connected:MIN",
+    "DEF:connected_avg={file}:connected:AVERAGE",
+    "DEF:connected_max={file}:connected:MAX",
+    "DEF:cached_min={file}:cached:MIN",
+    "DEF:cached_avg={file}:cached:AVERAGE",
+    "DEF:cached_max={file}:cached:MAX",
+    "DEF:created_min={file}:created:MIN",
+    "DEF:created_avg={file}:created:AVERAGE",
+    "DEF:created_max={file}:created:MAX",
+    "CDEF:unknown=created_avg,UNKN,+",
+    "CDEF:cached_agg=connected_avg,cached_avg,+",
+    "AREA:cached_agg#$HalfGreen",
+    "AREA:connected_avg#$HalfBlue",
+    "AREA:running_avg#$HalfRed",
+    "LINE1:cached_agg#$FullGreen:Cached   ",
+    'GPRINT:cached_min:MIN:%5.1lf Min,',
+    'GPRINT:cached_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:cached_max:MAX:%5.1lf Max,',
+    'GPRINT:cached_avg:LAST:%5.1lf Last\l',
+    "LINE1:connected_avg#$FullBlue:Connected",
+    'GPRINT:connected_min:MIN:%5.1lf Min,',
+    'GPRINT:connected_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:connected_max:MAX:%5.1lf Max,',
+    'GPRINT:connected_avg:LAST:%5.1lf Last\l',
+    "LINE1:running_avg#$FullRed:Running  ",
+    'GPRINT:running_min:MIN:%5.1lf Min,',
+    'GPRINT:running_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:running_max:MAX:%5.1lf Max,',
+    'GPRINT:running_avg:LAST:%5.1lf Last\l',
+    "LINE1:unknown#$Canvas:Created  ",
+    'GPRINT:created_min:MIN:%5.0lf Min,',
+    'GPRINT:created_avg:AVERAGE:%5.0lf Avg,',
+    'GPRINT:created_max:MAX:%5.0lf Max,',
+    'GPRINT:created_avg:LAST:%5.0lf Last\l'
+    ],
+    nfs_procedure => ['-v', 'Issues/s',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Issues/s",
+    'GPRINT:min:MIN:%6.2lf Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:max:MAX:%6.2lf Max,',
+    'GPRINT:avg:LAST:%6.2lf Last\l'
+    ],
+    nfs3_procedures => [
+    "DEF:null_avg={file}:null:AVERAGE",
+    "DEF:getattr_avg={file}:getattr:AVERAGE",
+    "DEF:setattr_avg={file}:setattr:AVERAGE",
+    "DEF:lookup_avg={file}:lookup:AVERAGE",
+    "DEF:access_avg={file}:access:AVERAGE",
+    "DEF:readlink_avg={file}:readlink:AVERAGE",
+    "DEF:read_avg={file}:read:AVERAGE",
+    "DEF:write_avg={file}:write:AVERAGE",
+    "DEF:create_avg={file}:create:AVERAGE",
+    "DEF:mkdir_avg={file}:mkdir:AVERAGE",
+    "DEF:symlink_avg={file}:symlink:AVERAGE",
+    "DEF:mknod_avg={file}:mknod:AVERAGE",
+    "DEF:remove_avg={file}:remove:AVERAGE",
+    "DEF:rmdir_avg={file}:rmdir:AVERAGE",
+    "DEF:rename_avg={file}:rename:AVERAGE",
+    "DEF:link_avg={file}:link:AVERAGE",
+    "DEF:readdir_avg={file}:readdir:AVERAGE",
+    "DEF:readdirplus_avg={file}:readdirplus:AVERAGE",
+    "DEF:fsstat_avg={file}:fsstat:AVERAGE",
+    "DEF:fsinfo_avg={file}:fsinfo:AVERAGE",
+    "DEF:pathconf_avg={file}:pathconf:AVERAGE",
+    "DEF:commit_avg={file}:commit:AVERAGE",
+    "DEF:null_max={file}:null:MAX",
+    "DEF:getattr_max={file}:getattr:MAX",
+    "DEF:setattr_max={file}:setattr:MAX",
+    "DEF:lookup_max={file}:lookup:MAX",
+    "DEF:access_max={file}:access:MAX",
+    "DEF:readlink_max={file}:readlink:MAX",
+    "DEF:read_max={file}:read:MAX",
+    "DEF:write_max={file}:write:MAX",
+    "DEF:create_max={file}:create:MAX",
+    "DEF:mkdir_max={file}:mkdir:MAX",
+    "DEF:symlink_max={file}:symlink:MAX",
+    "DEF:mknod_max={file}:mknod:MAX",
+    "DEF:remove_max={file}:remove:MAX",
+    "DEF:rmdir_max={file}:rmdir:MAX",
+    "DEF:rename_max={file}:rename:MAX",
+    "DEF:link_max={file}:link:MAX",
+    "DEF:readdir_max={file}:readdir:MAX",
+    "DEF:readdirplus_max={file}:readdirplus:MAX",
+    "DEF:fsstat_max={file}:fsstat:MAX",
+    "DEF:fsinfo_max={file}:fsinfo:MAX",
+    "DEF:pathconf_max={file}:pathconf:MAX",
+    "DEF:commit_max={file}:commit:MAX",
+    "CDEF:other_avg=null_avg,readlink_avg,create_avg,mkdir_avg,symlink_avg,mknod_avg,remove_avg,rmdir_avg,rename_avg,link_avg,readdir_avg,readdirplus_avg,fsstat_avg,fsinfo_avg,pathconf_avg,+,+,+,+,+,+,+,+,+,+,+,+,+,+",
+    "CDEF:other_max=null_max,readlink_max,create_max,mkdir_max,symlink_max,mknod_max,remove_max,rmdir_max,rename_max,link_max,readdir_max,readdirplus_max,fsstat_max,fsinfo_max,pathconf_max,+,+,+,+,+,+,+,+,+,+,+,+,+,+",
+    "CDEF:stack_read=read_avg",
+    "CDEF:stack_getattr=stack_read,getattr_avg,+",
+    "CDEF:stack_access=stack_getattr,access_avg,+",
+    "CDEF:stack_lookup=stack_access,lookup_avg,+",
+    "CDEF:stack_write=stack_lookup,write_avg,+",
+    "CDEF:stack_commit=stack_write,commit_avg,+",
+    "CDEF:stack_setattr=stack_commit,setattr_avg,+",
+    "CDEF:stack_other=stack_setattr,other_avg,+",
+    "AREA:stack_other#$HalfRed",
+    "AREA:stack_setattr#$HalfGreen",
+    "AREA:stack_commit#$HalfYellow",
+    "AREA:stack_write#$HalfGreen",
+    "AREA:stack_lookup#$HalfBlue",
+    "AREA:stack_access#$HalfMagenta",
+    "AREA:stack_getattr#$HalfCyan",
+    "AREA:stack_read#$HalfBlue",
+    "LINE1:stack_other#$FullRed:Other  ",
+    'GPRINT:other_max:MAX:%5.1lf Max,',
+    'GPRINT:other_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:other_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_setattr#$FullGreen:setattr",
+    'GPRINT:setattr_max:MAX:%5.1lf Max,',
+    'GPRINT:setattr_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:setattr_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_commit#$FullYellow:commit ",
+    'GPRINT:commit_max:MAX:%5.1lf Max,',
+    'GPRINT:commit_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:commit_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_write#$FullGreen:write  ",
+    'GPRINT:write_max:MAX:%5.1lf Max,',
+    'GPRINT:write_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:write_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_lookup#$FullBlue:lookup ",
+    'GPRINT:lookup_max:MAX:%5.1lf Max,',
+    'GPRINT:lookup_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:lookup_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_access#$FullMagenta:access ",
+    'GPRINT:access_max:MAX:%5.1lf Max,',
+    'GPRINT:access_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:access_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_getattr#$FullCyan:getattr",
+    'GPRINT:getattr_max:MAX:%5.1lf Max,',
+    'GPRINT:getattr_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:getattr_avg:LAST:%5.1lf Last\l',
+    "LINE1:stack_read#$FullBlue:read   ",
+    'GPRINT:read_max:MAX:%5.1lf Max,',
+    'GPRINT:read_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:read_avg:LAST:%5.1lf Last\l'
+    ],
+    opcode => [
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Queries/s",
+    'GPRINT:min:MIN:%9.3lf Min,',
+    'GPRINT:avg:AVERAGE:%9.3lf Average,',
+    'GPRINT:max:MAX:%9.3lf Max,',
+    'GPRINT:avg:LAST:%9.3lf Last\l'
+    ],
+    partition => [
+    "DEF:rbyte_avg={file}:rbytes:AVERAGE",
+    "DEF:rbyte_min={file}:rbytes:MIN",
+    "DEF:rbyte_max={file}:rbytes:MAX",
+    "DEF:wbyte_avg={file}:wbytes:AVERAGE",
+    "DEF:wbyte_min={file}:wbytes:MIN",
+    "DEF:wbyte_max={file}:wbytes:MAX",
+    'CDEF:overlap=wbyte_avg,rbyte_avg,GT,rbyte_avg,wbyte_avg,IF',
+    "AREA:wbyte_avg#$HalfGreen",
+    "AREA:rbyte_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:wbyte_avg#$FullGreen:Write",
+    'GPRINT:wbyte_min:MIN:%5.1lf%s Min,',
+    'GPRINT:wbyte_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:wbyte_max:MAX:%5.1lf%s Max,',
+    'GPRINT:wbyte_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:rbyte_avg#$FullBlue:Read ",
+    'GPRINT:rbyte_min:MIN:%5.1lf%s Min,',
+    'GPRINT:rbyte_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:rbyte_max:MAX:%5.1lf%s Max,',
+    'GPRINT:rbyte_avg:LAST:%5.1lf%s Last\l'
+    ],
+    percent => ['-v', 'Percent',
+    'DEF:avg={file}:percent:AVERAGE',
+    'DEF:min={file}:percent:MIN',
+    'DEF:max={file}:percent:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Percent",
+    'GPRINT:min:MIN:%5.1lf%% Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%% Avg,',
+    'GPRINT:max:MAX:%5.1lf%% Max,',
+    'GPRINT:avg:LAST:%5.1lf%% Last\l'
+    ],
+    ping => ['DEF:ping_avg={file}:ping:AVERAGE',
+    'DEF:ping_min={file}:ping:MIN',
+    'DEF:ping_max={file}:ping:MAX',
+    "AREA:ping_max#$HalfBlue",
+    "AREA:ping_min#$Canvas",
+    "LINE1:ping_avg#$FullBlue:Ping",
+    'GPRINT:ping_min:MIN:%4.1lf ms Min,',
+    'GPRINT:ping_avg:AVERAGE:%4.1lf ms Avg,',
+    'GPRINT:ping_max:MAX:%4.1lf ms Max,',
+    'GPRINT:ping_avg:LAST:%4.1lf ms Last'],
+    processes => [
+    "DEF:running_avg={file}:running:AVERAGE",
+    "DEF:running_min={file}:running:MIN",
+    "DEF:running_max={file}:running:MAX",
+    "DEF:sleeping_avg={file}:sleeping:AVERAGE",
+    "DEF:sleeping_min={file}:sleeping:MIN",
+    "DEF:sleeping_max={file}:sleeping:MAX",
+    "DEF:zombies_avg={file}:zombies:AVERAGE",
+    "DEF:zombies_min={file}:zombies:MIN",
+    "DEF:zombies_max={file}:zombies:MAX",
+    "DEF:stopped_avg={file}:stopped:AVERAGE",
+    "DEF:stopped_min={file}:stopped:MIN",
+    "DEF:stopped_max={file}:stopped:MAX",
+    "DEF:paging_avg={file}:paging:AVERAGE",
+    "DEF:paging_min={file}:paging:MIN",
+    "DEF:paging_max={file}:paging:MAX",
+    "DEF:blocked_avg={file}:blocked:AVERAGE",
+    "DEF:blocked_min={file}:blocked:MIN",
+    "DEF:blocked_max={file}:blocked:MAX",
+    'CDEF:paging_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,blocked_avg,paging_avg,+,+,+,+,+',
+    'CDEF:blocked_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,blocked_avg,+,+,+,+',
+    'CDEF:zombies_acc=sleeping_avg,running_avg,stopped_avg,zombies_avg,+,+,+',
+    'CDEF:stopped_acc=sleeping_avg,running_avg,stopped_avg,+,+',
+    'CDEF:running_acc=sleeping_avg,running_avg,+',
+    'CDEF:sleeping_acc=sleeping_avg',
+    "AREA:paging_acc#$HalfYellow",
+    "AREA:blocked_acc#$HalfCyan",
+    "AREA:zombies_acc#$HalfRed",
+    "AREA:stopped_acc#$HalfMagenta",
+    "AREA:running_acc#$HalfGreen",
+    "AREA:sleeping_acc#$HalfBlue",
+    "LINE1:paging_acc#$FullYellow:Paging  ",
+    'GPRINT:paging_min:MIN:%5.1lf Min,',
+    'GPRINT:paging_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:paging_max:MAX:%5.1lf Max,',
+    'GPRINT:paging_avg:LAST:%5.1lf Last\l',
+    "LINE1:blocked_acc#$FullCyan:Blocked ",
+    'GPRINT:blocked_min:MIN:%5.1lf Min,',
+    'GPRINT:blocked_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:blocked_max:MAX:%5.1lf Max,',
+    'GPRINT:blocked_avg:LAST:%5.1lf Last\l',
+    "LINE1:zombies_acc#$FullRed:Zombies ",
+    'GPRINT:zombies_min:MIN:%5.1lf Min,',
+    'GPRINT:zombies_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:zombies_max:MAX:%5.1lf Max,',
+    'GPRINT:zombies_avg:LAST:%5.1lf Last\l',
+    "LINE1:stopped_acc#$FullMagenta:Stopped ",
+    'GPRINT:stopped_min:MIN:%5.1lf Min,',
+    'GPRINT:stopped_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:stopped_max:MAX:%5.1lf Max,',
+    'GPRINT:stopped_avg:LAST:%5.1lf Last\l',
+    "LINE1:running_acc#$FullGreen:Running ",
+    'GPRINT:running_min:MIN:%5.1lf Min,',
+    'GPRINT:running_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:running_max:MAX:%5.1lf Max,',
+    'GPRINT:running_avg:LAST:%5.1lf Last\l',
+    "LINE1:sleeping_acc#$FullBlue:Sleeping",
+    'GPRINT:sleeping_min:MIN:%5.1lf Min,',
+    'GPRINT:sleeping_avg:AVERAGE:%5.1lf Average,',
+    'GPRINT:sleeping_max:MAX:%5.1lf Max,',
+    'GPRINT:sleeping_avg:LAST:%5.1lf Last\l'
+    ],
+    ps_rss => [
+    'DEF:avg={file}:byte:AVERAGE',
+    'DEF:min={file}:byte:MIN',
+    'DEF:max={file}:byte:MAX',
+    "AREA:avg#$HalfBlue",
+    "LINE1:avg#$FullBlue:RSS",
+    'GPRINT:min:MIN:%5.1lf%s Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:max:MAX:%5.1lf%s Max,',
+    'GPRINT:avg:LAST:%5.1lf%s Last\l'
+    ],
+    ps_cputime => [
+    'DEF:user_avg_raw={file}:user:AVERAGE',
+    'DEF:user_min_raw={file}:user:MIN',
+    'DEF:user_max_raw={file}:user:MAX',
+    'DEF:syst_avg_raw={file}:syst:AVERAGE',
+    'DEF:syst_min_raw={file}:syst:MIN',
+    'DEF:syst_max_raw={file}:syst:MAX',
+    'CDEF:user_avg=user_avg_raw,1000000,/',
+    'CDEF:user_min=user_min_raw,1000000,/',
+    'CDEF:user_max=user_max_raw,1000000,/',
+    'CDEF:syst_avg=syst_avg_raw,1000000,/',
+    'CDEF:syst_min=syst_min_raw,1000000,/',
+    'CDEF:syst_max=syst_max_raw,1000000,/',
+    'CDEF:user_syst=syst_avg,UN,0,syst_avg,IF,user_avg,+',
+    "AREA:user_syst#$HalfBlue",
+    "AREA:syst_avg#$HalfRed",
+    "LINE1:user_syst#$FullBlue:User  ",
+    'GPRINT:user_min:MIN:%5.1lf%s Min,',
+    'GPRINT:user_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:user_max:MAX:%5.1lf%s Max,',
+    'GPRINT:user_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:syst_avg#$FullRed:System",
+    'GPRINT:syst_min:MIN:%5.1lf%s Min,',
+    'GPRINT:syst_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:syst_max:MAX:%5.1lf%s Max,',
+    'GPRINT:syst_avg:LAST:%5.1lf%s Last\l'
+    ],
+    ps_count => [
+    'DEF:procs_avg={file}:processes:AVERAGE',
+    'DEF:procs_min={file}:processes:MIN',
+    'DEF:procs_max={file}:processes:MAX',
+    'DEF:thrds_avg={file}:threads:AVERAGE',
+    'DEF:thrds_min={file}:threads:MIN',
+    'DEF:thrds_max={file}:threads:MAX',
+    "AREA:thrds_avg#$HalfBlue",
+    "AREA:procs_avg#$HalfRed",
+    "LINE1:thrds_avg#$FullBlue:Threads  ",
+    'GPRINT:thrds_min:MIN:%5.1lf Min,',
+    'GPRINT:thrds_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:thrds_max:MAX:%5.1lf Max,',
+    'GPRINT:thrds_avg:LAST:%5.1lf Last\l',
+    "LINE1:procs_avg#$FullRed:Processes",
+    'GPRINT:procs_min:MIN:%5.1lf Min,',
+    'GPRINT:procs_avg:AVERAGE:%5.1lf Avg,',
+    'GPRINT:procs_max:MAX:%5.1lf Max,',
+    'GPRINT:procs_avg:LAST:%5.1lf Last\l'
+    ],
+    ps_pagefaults => [
+    'DEF:minor_avg={file}:minflt:AVERAGE',
+    'DEF:minor_min={file}:minflt:MIN',
+    'DEF:minor_max={file}:minflt:MAX',
+    'DEF:major_avg={file}:majflt:AVERAGE',
+    'DEF:major_min={file}:majflt:MIN',
+    'DEF:major_max={file}:majflt:MAX',
+    'CDEF:minor_major=major_avg,UN,0,major_avg,IF,minor_avg,+',
+    "AREA:minor_major#$HalfBlue",
+    "AREA:major_avg#$HalfRed",
+    "LINE1:minor_major#$FullBlue:Minor",
+    'GPRINT:minor_min:MIN:%5.1lf%s Min,',
+    'GPRINT:minor_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:minor_max:MAX:%5.1lf%s Max,',
+    'GPRINT:minor_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:major_avg#$FullRed:Major",
+    'GPRINT:major_min:MIN:%5.1lf%s Min,',
+    'GPRINT:major_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:major_max:MAX:%5.1lf%s Max,',
+    'GPRINT:major_avg:LAST:%5.1lf%s Last\l'
+    ],
+    ps_state => ['-v', 'Processes',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Processes",
+    'GPRINT:min:MIN:%6.2lf Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf Avg,',
+    'GPRINT:max:MAX:%6.2lf Max,',
+    'GPRINT:avg:LAST:%6.2lf Last\l'
+    ],
+    qtype => [
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Queries/s",
+    'GPRINT:min:MIN:%9.3lf Min,',
+    'GPRINT:avg:AVERAGE:%9.3lf Average,',
+    'GPRINT:max:MAX:%9.3lf Max,',
+    'GPRINT:avg:LAST:%9.3lf Last\l'
+    ],
+    rcode => [
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Queries/s",
+    'GPRINT:min:MIN:%9.3lf Min,',
+    'GPRINT:avg:AVERAGE:%9.3lf Average,',
+    'GPRINT:max:MAX:%9.3lf Max,',
+    'GPRINT:avg:LAST:%9.3lf Last\l'
+    ],
+    swap => ['-v', 'Bytes', '-b', '1024',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Bytes",
+    'GPRINT:min:MIN:%6.2lf%sByte Min,',
+    'GPRINT:avg:AVERAGE:%6.2lf%sByte Avg,',
+    'GPRINT:max:MAX:%6.2lf%sByte Max,',
+    'GPRINT:avg:LAST:%6.2lf%sByte Last\l'
+    ],
+    ols_swap => [
+    'DEF:used_avg={file}:used:AVERAGE',
+    'DEF:used_min={file}:used:MIN',
+    'DEF:used_max={file}:used:MAX',
+    'DEF:free_avg={file}:free:AVERAGE',
+    'DEF:free_min={file}:free:MIN',
+    'DEF:free_max={file}:free:MAX',
+    'DEF:cach_avg={file}:cached:AVERAGE',
+    'DEF:cach_min={file}:cached:MIN',
+    'DEF:cach_max={file}:cached:MAX',
+    'DEF:resv_avg={file}:resv:AVERAGE',
+    'DEF:resv_min={file}:resv:MIN',
+    'DEF:resv_max={file}:resv:MAX',
+    'CDEF:cach_avg_notnull=cach_avg,UN,0,cach_avg,IF',
+    'CDEF:resv_avg_notnull=resv_avg,UN,0,resv_avg,IF',
+    'CDEF:used_acc=used_avg',
+    'CDEF:resv_acc=used_acc,resv_avg_notnull,+',
+    'CDEF:cach_acc=resv_acc,cach_avg_notnull,+',
+    'CDEF:free_acc=cach_acc,free_avg,+',
+    "AREA:free_acc#$HalfGreen",
+    "AREA:cach_acc#$HalfBlue",
+    "AREA:resv_acc#$HalfYellow",
+    "AREA:used_acc#$HalfRed",
+    "LINE1:free_acc#$FullGreen:Free    ",
+    'GPRINT:free_min:MIN:%5.1lf%s Min,',
+    'GPRINT:free_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:free_max:MAX:%5.1lf%s Max,',
+    'GPRINT:free_avg:LAST:%5.1lf%s Last\n',
+    "LINE1:cach_acc#$FullBlue:Cached  ",
+    'GPRINT:cach_min:MIN:%5.1lf%s Min,',
+    'GPRINT:cach_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:cach_max:MAX:%5.1lf%s Max,',
+    'GPRINT:cach_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:resv_acc#$FullYellow:Reserved",
+    'GPRINT:resv_min:MIN:%5.1lf%s Min,',
+    'GPRINT:resv_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:resv_max:MAX:%5.1lf%s Max,',
+    'GPRINT:resv_avg:LAST:%5.1lf%s Last\n',
+    "LINE1:used_acc#$FullRed:Used    ",
+    'GPRINT:used_min:MIN:%5.1lf%s Min,',
+    'GPRINT:used_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:used_max:MAX:%5.1lf%s Max,',
+    'GPRINT:used_avg:LAST:%5.1lf%s Last\l'
+    ],
+    temperature => ['-v', 'Celsius',
+    'DEF:temp_avg={file}:value:AVERAGE',
+    'DEF:temp_min={file}:value:MIN',
+    'DEF:temp_max={file}:value:MAX',
+    "AREA:temp_max#$HalfRed",
+    "AREA:temp_min#$Canvas",
+    "LINE1:temp_avg#$FullRed:Temperature",
+    'GPRINT:temp_min:MIN:%4.1lf Min,',
+    'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
+    'GPRINT:temp_max:MAX:%4.1lf Max,',
+    'GPRINT:temp_avg:LAST:%4.1lf Last\l'
+    ],
+    timeleft => [
+    'DEF:avg={file}:timeleft:AVERAGE',
+    'DEF:min={file}:timeleft:MIN',
+    'DEF:max={file}:timeleft:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Time left [min]",
+    'GPRINT:min:MIN:%5.1lf%s Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:max:MAX:%5.1lf%s Max,',
+    'GPRINT:avg:LAST:%5.1lf%s Last\l'
+    ],
+    time_offset => [ # NTPd
+    'DEF:s_avg={file}:seconds:AVERAGE',
+    'DEF:s_min={file}:seconds:MIN',
+    'DEF:s_max={file}:seconds:MAX',
+    "AREA:s_max#$HalfBlue",
+    "AREA:s_min#$Canvas",
+    "LINE1:s_avg#$FullBlue:{inst}",
+    'GPRINT:s_min:MIN:%7.3lf%s Min,',
+    'GPRINT:s_avg:AVERAGE:%7.3lf%s Avg,',
+    'GPRINT:s_max:MAX:%7.3lf%s Max,',
+    'GPRINT:s_avg:LAST:%7.3lf%s Last'
+    ],
+    if_octets => ['-v', 'Bits/s',
+    'DEF:out_min_raw={file}:tx:MIN',
+    'DEF:out_avg_raw={file}:tx:AVERAGE',
+    'DEF:out_max_raw={file}:tx:MAX',
+    'DEF:inc_min_raw={file}:rx:MIN',
+    'DEF:inc_avg_raw={file}:rx:AVERAGE',
+    'DEF:inc_max_raw={file}:rx:MAX',
+    'CDEF:out_min=out_min_raw,8,*',
+    'CDEF:out_avg=out_avg_raw,8,*',
+    'CDEF:out_max=out_max_raw,8,*',
+    'CDEF:inc_min=inc_min_raw,8,*',
+    'CDEF:inc_avg=inc_avg_raw,8,*',
+    'CDEF:inc_max=inc_max_raw,8,*',
+    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
+    'CDEF:mytime=out_avg_raw,TIME,TIME,IF',
+    'CDEF:sample_len_raw=mytime,PREV(mytime),-',
+    'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
+    'CDEF:out_avg_sample=out_avg_raw,UN,0,out_avg_raw,IF,sample_len,*',
+    'CDEF:out_avg_sum=PREV,UN,0,PREV,IF,out_avg_sample,+',
+    'CDEF:inc_avg_sample=inc_avg_raw,UN,0,inc_avg_raw,IF,sample_len,*',
+    'CDEF:inc_avg_sum=PREV,UN,0,PREV,IF,inc_avg_sample,+',
+    "AREA:out_avg#$HalfGreen",
+    "AREA:inc_avg#$HalfBlue",
+    "AREA:overlap#$HalfBlueGreen",
+    "LINE1:out_avg#$FullGreen:Outgoing",
+    'GPRINT:out_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:out_max:MAX:%5.1lf%s Max,',
+    'GPRINT:out_avg:LAST:%5.1lf%s Last',
+    'GPRINT:out_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
+    "LINE1:inc_avg#$FullBlue:Incoming",
+    #'GPRINT:inc_min:MIN:%5.1lf %s Min,',
+    'GPRINT:inc_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:inc_max:MAX:%5.1lf%s Max,',
+    'GPRINT:inc_avg:LAST:%5.1lf%s Last',
+    'GPRINT:inc_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
+    ],
+    cpufreq => [
+    'DEF:cpufreq_avg={file}:value:AVERAGE',
+    'DEF:cpufreq_min={file}:value:MIN',
+    'DEF:cpufreq_max={file}:value:MAX',
+    "AREA:cpufreq_max#$HalfBlue",
+    "AREA:cpufreq_min#$Canvas",
+    "LINE1:cpufreq_avg#$FullBlue:Frequency",
+    'GPRINT:cpufreq_min:MIN:%5.1lf%s Min,',
+    'GPRINT:cpufreq_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:cpufreq_max:MAX:%5.1lf%s Max,',
+    'GPRINT:cpufreq_avg:LAST:%5.1lf%s Last\l'
+    ],
+    multimeter => [
+    'DEF:multimeter_avg={file}:value:AVERAGE',
+    'DEF:multimeter_min={file}:value:MIN',
+    'DEF:multimeter_max={file}:value:MAX',
+    "AREA:multimeter_max#$HalfBlue",
+    "AREA:multimeter_min#$Canvas",
+    "LINE1:multimeter_avg#$FullBlue:Multimeter",
+    'GPRINT:multimeter_min:MIN:%4.1lf Min,',
+    'GPRINT:multimeter_avg:AVERAGE:%4.1lf Average,',
+    'GPRINT:multimeter_max:MAX:%4.1lf Max,',
+    'GPRINT:multimeter_avg:LAST:%4.1lf Last\l'
+    ],
+    users => [
+    'DEF:users_avg={file}:users:AVERAGE',
+    'DEF:users_min={file}:users:MIN',
+    'DEF:users_max={file}:users:MAX',
+    "AREA:users_max#$HalfBlue",
+    "AREA:users_min#$Canvas",
+    "LINE1:users_avg#$FullBlue:Users",
+    'GPRINT:users_min:MIN:%4.1lf Min,',
+    'GPRINT:users_avg:AVERAGE:%4.1lf Average,',
+    'GPRINT:users_max:MAX:%4.1lf Max,',
+    'GPRINT:users_avg:LAST:%4.1lf Last\l'
+    ],
+    voltage => ['-v', 'Voltage',
+    'DEF:avg={file}:value:AVERAGE',
+    'DEF:min={file}:value:MIN',
+    'DEF:max={file}:value:MAX',
+    "AREA:max#$HalfBlue",
+    "AREA:min#$Canvas",
+    "LINE1:avg#$FullBlue:Voltage",
+    'GPRINT:min:MIN:%5.1lf%sV Min,',
+    'GPRINT:avg:AVERAGE:%5.1lf%sV Avg,',
+    'GPRINT:max:MAX:%5.1lf%sV Max,',
+    'GPRINT:avg:LAST:%5.1lf%sV Last\l'
+    ],
+    vs_threads => [
+    "DEF:total_avg={file}:total:AVERAGE",
+    "DEF:total_min={file}:total:MIN",
+    "DEF:total_max={file}:total:MAX",
+    "DEF:running_avg={file}:running:AVERAGE",
+    "DEF:running_min={file}:running:MIN",
+    "DEF:running_max={file}:running:MAX",
+    "DEF:uninterruptible_avg={file}:uninterruptible:AVERAGE",
+    "DEF:uninterruptible_min={file}:uninterruptible:MIN",
+    "DEF:uninterruptible_max={file}:uninterruptible:MAX",
+    "DEF:onhold_avg={file}:onhold:AVERAGE",
+    "DEF:onhold_min={file}:onhold:MIN",
+    "DEF:onhold_max={file}:onhold:MAX",
+    "LINE1:total_avg#$FullYellow:Total   ",
+    'GPRINT:total_min:MIN:%5.1lf Min,',
+    'GPRINT:total_avg:AVERAGE:%5.1lf Avg.,',
+    'GPRINT:total_max:MAX:%5.1lf Max,',
+    'GPRINT:total_avg:LAST:%5.1lf Last\l',
+    "LINE1:running_avg#$FullRed:Running ",
+    'GPRINT:running_min:MIN:%5.1lf Min,',
+    'GPRINT:running_avg:AVERAGE:%5.1lf Avg.,',          
+    'GPRINT:running_max:MAX:%5.1lf Max,',
+    'GPRINT:running_avg:LAST:%5.1lf Last\l',
+    "LINE1:uninterruptible_avg#$FullGreen:Unintr  ",
+    'GPRINT:uninterruptible_min:MIN:%5.1lf Min,',
+    'GPRINT:uninterruptible_avg:AVERAGE:%5.1lf Avg.,',
+    'GPRINT:uninterruptible_max:MAX:%5.1lf Max,',
+    'GPRINT:uninterruptible_avg:LAST:%5.1lf Last\l',
+    "LINE1:onhold_avg#$FullBlue:Onhold  ",
+    'GPRINT:onhold_min:MIN:%5.1lf Min,',
+    'GPRINT:onhold_avg:AVERAGE:%5.1lf Avg.,',
+    'GPRINT:onhold_max:MAX:%5.1lf Max,',
+    'GPRINT:onhold_avg:LAST:%5.1lf Last\l'
+    ],
+    vs_memory => [
+    'DEF:vm_avg={file}:vm:AVERAGE',
+    'DEF:vm_min={file}:vm:MIN',
+    'DEF:vm_max={file}:vm:MAX',
+    'DEF:vml_avg={file}:vml:AVERAGE',
+    'DEF:vml_min={file}:vml:MIN',
+    'DEF:vml_max={file}:vml:MAX',
+    'DEF:rss_avg={file}:rss:AVERAGE',
+    'DEF:rss_min={file}:rss:MIN',
+    'DEF:rss_max={file}:rss:MAX',
+    'DEF:anon_avg={file}:anon:AVERAGE',
+    'DEF:anon_min={file}:anon:MIN',
+    'DEF:anon_max={file}:anon:MAX',
+    "LINE1:vm_avg#$FullYellow:VM     ",
+    'GPRINT:vm_min:MIN:%5.1lf%s Min,',
+    'GPRINT:vm_avg:AVERAGE:%5.1lf%s Avg.,',
+    'GPRINT:vm_max:MAX:%5.1lf%s Avg.,',
+    'GPRINT:vm_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:vml_avg#$FullRed:Locked ",
+    'GPRINT:vml_min:MIN:%5.1lf%s Min,',
+    'GPRINT:vml_avg:AVERAGE:%5.1lf%s Avg.,',
+    'GPRINT:vml_max:MAX:%5.1lf%s Avg.,',
+    'GPRINT:vml_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:rss_avg#$FullGreen:RSS    ",
+    'GPRINT:rss_min:MIN:%5.1lf%s Min,',
+    'GPRINT:rss_avg:AVERAGE:%5.1lf%s Avg.,',
+    'GPRINT:rss_max:MAX:%5.1lf%s Avg.,',
+    'GPRINT:rss_avg:LAST:%5.1lf%s Last\l',
+    "LINE1:anon_avg#$FullBlue:Anon.  ",
+    'GPRINT:anon_min:MIN:%5.1lf%s Min,',
+    'GPRINT:anon_avg:AVERAGE:%5.1lf%s Avg.,',
+    'GPRINT:anon_max:MAX:%5.1lf%s Avg.,',
+    'GPRINT:anon_avg:LAST:%5.1lf%s Last\l',
+    ],
+    vs_processes => [
+    'DEF:proc_avg={file}:total:AVERAGE',
+    'DEF:proc_min={file}:total:MIN',
+    'DEF:proc_max={file}:total:MAX',
+    "AREA:proc_max#$HalfBlue",
+    "AREA:proc_min#$Canvas",
+    "LINE1:proc_avg#$FullBlue:Processes",
+    'GPRINT:proc_min:MIN:%4.1lf Min,',
+    'GPRINT:proc_avg:AVERAGE:%4.1lf Avg.,',
+    'GPRINT:proc_max:MAX:%4.1lf Max,',
+    'GPRINT:proc_avg:LAST:%4.1lf Last\l'
+    ],
+  };
+} # load_graph_definitions
+# vim: shiftwidth=2:softtabstop=2:tabstop=8
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: extractDS.px
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: fedora
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib: init.d-rh7
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: iptables
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: migrate-3-4.px
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: PerlLib
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/contrib/README	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib/README	2007-05-30 18:33:14.000000000 +0800
@@ -1,31 +1,49 @@
 The files in this directory may be used to perform common tasks that aren't
 exactly `collectd's job. They may or may not require in-depth knowlege of RRD
 files and/or `collectd's inner workings. Use at your own risk.
 
+PerlLib/
+--------
+  Perl modules to be used in conjunction with collectd. See the perldoc
+documentation of the .pm-files to find out what they're good for.
+
 add_rra.sh
 ----------
   Before version 3.9.0 collectd used to create a different set of RRAs. The
-most detailed of these old RRAs hat a one minute resolution. This script can be
-used to add three more RRAs: minimum, maximum and average with a ten second
+most detailed of these old RRAs hat a one minute resolution. This script can
+be used to add three more RRAs: minimum, maximum and average with a ten second
 resolution and 2200 rows (~6 hours). This will make houly statistics much more
 interesting. Please note that no sanity- checking whatsoever is performed. You
 can seriously fuck up your RRD files if you don't know what you're doing.
 
 collectd2html.pl
 ----------------
   This script by Vincent Stehl will search for RRD files in
 `/var/lib/collectd/' and generate an HTML file and a directory containing
 several PNG files which are graphs of the RRD files found.
 
-collectd.conf
--------------
-  A sample config file. Used by the Debian package.
-
 collection.cgi
 --------------
   Sample CGI script that creates graphs on the fly. The Perl module `RRDs' is
 needed (Debian package `librrds-perl').
 
-init.d-rh7
-----------
-  Sample init script. Used by the RPM specfile.
+extractDS.px
+------------
+  Creates a new RRD-file with only one data-source (DS) of the source-RRD-
+file. That is very handy when you realise that you have bundled up DSes in one
+RRD-file that should have been in multiple RRD-files instead. Is is used by
+`migrate-3-4.px' to split up the cpu-, nfs-, swap-files and possibly others.
+
+fedora/
+-------
+  Init-script and Spec-file that can be used when creating RPM-packages for
+Fedora.
+
+migrate-3-4.px
+--------------
+  Migration-script to ease the switch from version 3 to version 4. Many
+RRD-files are expected in a different place, some have been changed (DSes have
+been renamed) and others have bee split up into multiple files. This script
+prints a bash-script to STDOUT which should do most of the work for you. You
+may still need to do some things by hand, read `README.migration' for more
+details.
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/contrib: sles10.1
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/acinclude.m4 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/acinclude.m4
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/acinclude.m4	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/acinclude.m4	2006-03-12 02:49:04.000000000 +0800
@@ -1,16 +1,16 @@
 # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-
-## Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005, 2006, 2007
+## Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005
 ## Free Software Foundation, Inc.
 ## Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 ##
 ## This file is free software; the Free Software Foundation gives
 ## unlimited permission to copy and/or distribute it, with or without
 ## modifications, as long as this notice is preserved.
 
-# serial 51 Debian 1.5.24-1 AC_PROG_LIBTOOL
+# serial 48 Debian 1.5.22-4 AC_PROG_LIBTOOL
 
 
 # AC_PROVIDE_IFELSE(MACRO-NAME, IF-PROVIDED, IF-NOT-PROVIDED)
 # -----------------------------------------------------------
 # If this macro is not defined by Autoconf, define it here.
 m4_ifdef([AC_PROVIDE_IFELSE],
@@ -167,13 +167,13 @@
 test -z "$OBJDUMP" && OBJDUMP=objdump
 test -z "$RANLIB" && RANLIB=:
 test -z "$STRIP" && STRIP=:
 test -z "$ac_objext" && ac_objext=o
 
 # Determine commands to create old-style static archives.
-old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs'
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
 old_postinstall_cmds='chmod 644 $oldlib'
 old_postuninstall_cmds=
 
 if test -n "$RANLIB"; then
   case $host_os in
   openbsd*)
@@ -254,29 +254,27 @@
 
 # _LT_COMPILER_BOILERPLATE
 # ------------------------
 # Check for compiler boilerplate output or warnings with
 # the simple compiler test code.
 AC_DEFUN([_LT_COMPILER_BOILERPLATE],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 ])# _LT_COMPILER_BOILERPLATE
 
 
 # _LT_LINKER_BOILERPLATE
 # ----------------------
 # Check for linker boilerplate output or warnings with
 # the simple link test code.
 AC_DEFUN([_LT_LINKER_BOILERPLATE],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+[ac_outfile=conftest.$ac_objext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 ])# _LT_LINKER_BOILERPLATE
 
 
@@ -286,26 +284,18 @@
 # for the system default hardcoded library path. In most cases,
 # this is /usr/lib:/lib, but when the MPI compilers are used
 # the location of the communication and MPI libs are included too.
 # If we don't find anything, use the default library path according
 # to the aix ld manual.
 AC_DEFUN([_LT_AC_SYS_LIBPATH_AIX],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_LINK_IFELSE(AC_LANG_PROGRAM,[
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+[AC_LINK_IFELSE(AC_LANG_PROGRAM,[
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi],[])
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi],[])
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 ])# _LT_AC_SYS_LIBPATH_AIX
 
 
 # _LT_AC_SHELL_INIT(ARG)
 # ----------------------
@@ -530,23 +520,19 @@
     esac
    fi
   fi
   rm -rf conftest*
   ;;
 
-x86_64-*kfreebsd*-gnu|x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*| \
-s390*-*linux*|sparc*-*linux*)
+x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if AC_TRY_EVAL(ac_compile); then
     case `/usr/bin/file conftest.o` in
     *32-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_i386_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_i386"
           ;;
         ppc64-*linux*|powerpc64-*linux*)
           LD="${LD-ld} -m elf32ppclinux"
           ;;
@@ -557,15 +543,12 @@
           LD="${LD-ld} -m elf32_sparc"
           ;;
       esac
       ;;
     *64-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_x86_64_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_x86_64"
           ;;
         ppc*-*linux*|powerpc*-*linux*)
           LD="${LD-ld} -m elf64ppc"
           ;;
@@ -631,13 +614,13 @@
 # Check whether the given compiler option works
 AC_DEFUN([AC_LIBTOOL_COMPILER_OPTION],
 [AC_REQUIRE([LT_AC_PROG_SED])
 AC_CACHE_CHECK([$1], [$2],
   [$2=no
   ifelse([$4], , [ac_outfile=conftest.$ac_objext], [ac_outfile=$4])
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$3"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
@@ -672,18 +655,17 @@
 
 # AC_LIBTOOL_LINKER_OPTION(MESSAGE, VARIABLE-NAME, FLAGS,
 #                          [ACTION-SUCCESS], [ACTION-FAILURE])
 # ------------------------------------------------------------
 # Check whether the given compiler option works
 AC_DEFUN([AC_LIBTOOL_LINKER_OPTION],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_CACHE_CHECK([$1], [$2],
+[AC_CACHE_CHECK([$1], [$2],
   [$2=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $3"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&AS_MESSAGE_LOG_FD
@@ -791,33 +773,30 @@
       lt_cv_sys_max_cmd_len=`echo $kargmax | sed 's/.*[[ 	]]//'`
     else
       lt_cv_sys_max_cmd_len=32768
     fi
     ;;
   *)
-    lt_cv_sys_max_cmd_len=`(getconf ARG_MAX) 2> /dev/null`
-    if test -n "$lt_cv_sys_max_cmd_len"; then
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    else
-      SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-      while (test "X"`$SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
+    # If test is not a shell built-in, we'll probably end up computing a
+    # maximum length that is only half of the actual maximum length, but
+    # we can't tell.
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL [$]0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
-	      new_result=`expr "X$teststring" : ".*" 2>&1` &&
-	      lt_cv_sys_max_cmd_len=$new_result &&
-	      test $i != 17 # 1/2 MB should be enough
-      do
-        i=`expr $i + 1`
-        teststring=$teststring$teststring
-      done
-      teststring=
-      # Add a significant safety factor because C++ compilers can tack on massive
-      # amounts of additional arguments before passing them to the linker.
-      # It appears as though 1/2 is a usable value.
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
-    fi
+	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
+	    lt_cv_sys_max_cmd_len=$new_result &&
+	    test $i != 17 # 1/2 MB should be enough
+    do
+      i=`expr $i + 1`
+      teststring=$teststring$teststring
+    done
+    teststring=
+    # Add a significant safety factor because C++ compilers can tack on massive
+    # amounts of additional arguments before passing them to the linker.
+    # It appears as though 1/2 is a usable value.
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
     ;;
   esac
 ])
 if test -n $lt_cv_sys_max_cmd_len ; then
   AC_MSG_RESULT($lt_cv_sys_max_cmd_len)
 else
@@ -1038,22 +1017,21 @@
 
 
 # AC_LIBTOOL_PROG_CC_C_O([TAGNAME])
 # ---------------------------------
 # Check to see if options -c and -o are simultaneously supported by compiler
 AC_DEFUN([AC_LIBTOOL_PROG_CC_C_O],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_REQUIRE([_LT_AC_SYS_COMPILER])dnl
+[AC_REQUIRE([_LT_AC_SYS_COMPILER])dnl
 AC_CACHE_CHECK([if $compiler supports -c -o file.$ac_objext],
   [_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)],
   [_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
@@ -1187,13 +1165,12 @@
 else
 # FIXME - insert some real tests, host_os isn't really good enough
   case $host_os in
    darwin*)
        if test -n "$STRIP" ; then
          striplib="$STRIP -x"
-         old_striplib="$STRIP -S"
          AC_MSG_RESULT([yes])
        else
   AC_MSG_RESULT([no])
 fi
        ;;
    *)
@@ -1205,14 +1182,13 @@
 
 
 # AC_LIBTOOL_SYS_DYNAMIC_LINKER
 # -----------------------------
 # PORTME Fill in your ld.so characteristics
 AC_DEFUN([AC_LIBTOOL_SYS_DYNAMIC_LINKER],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_MSG_CHECKING([dynamic linker characteristics])
+[AC_MSG_CHECKING([dynamic linker characteristics])
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -1220,64 +1196,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-m4_if($1,[],[
 if test "$GCC" = yes; then
-  case $host_os in
-    darwin*) lt_awk_arg="/^libraries:/,/LR/" ;;
-    *) lt_awk_arg="/^libraries:/" ;;
-  esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$lt_search_path_spec" | grep ';' >/dev/null ; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
     # if the path contains ";" then we assume it to be the separator
     # otherwise default to the standard path separator (i.e. ":") - it is
     # assumed that no part of a normal pathname contains ";" but that should
     # okay in the real world where ";" in dirpaths is itself problematic.
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED -e 's/;/ /g'`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
   else
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
   fi
-  # Ok, now we have the path, separated by spaces, we can step through it
-  # and add multilib dir if necessary.
-  lt_tmp_lt_search_path_spec=
-  lt_multi_os_dir=`$CC $CPPFLAGS $CFLAGS $LDFLAGS -print-multi-os-directory 2>/dev/null`
-  for lt_sys_path in $lt_search_path_spec; do
-    if test -d "$lt_sys_path/$lt_multi_os_dir"; then
-      lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path/$lt_multi_os_dir"
-    else
-      test -d "$lt_sys_path" && \
-	lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path"
-    fi
-  done
-  lt_search_path_spec=`echo $lt_tmp_lt_search_path_spec | awk '
-BEGIN {RS=" "; FS="/|\n";} {
-  lt_foo="";
-  lt_count=0;
-  for (lt_i = NF; lt_i > 0; lt_i--) {
-    if ($lt_i != "" && $lt_i != ".") {
-      if ($lt_i == "..") {
-        lt_count++;
-      } else {
-        if (lt_count == 0) {
-          lt_foo="/" $lt_i lt_foo;
-        } else {
-          lt_count--;
-        }
-      }
-    }
-  }
-  if (lt_foo != "") { lt_freq[[lt_foo]]++; }
-  if (lt_freq[[lt_foo]] == 1) { print lt_foo; }
-}'`
-  sys_lib_search_path_spec=`echo $lt_search_path_spec`
 else
   sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi])
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -1428,14 +1366,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-  m4_if([$1], [],[
-  sys_lib_search_path_spec="$sys_lib_search_path_spec /usr/local/lib"]) 
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -1483,13 +1425,13 @@
     ;;
   freebsd3.[[2-9]]* | freebsdelf3.[[2-9]]* | \
   freebsd4.[[0-5]] | freebsdelf4.[[0-5]] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -1546,13 +1488,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[[3-9]]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -1617,13 +1559,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \[$]2)); skip = 1; } { if (!skip) print \[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -1723,16 +1665,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -1832,14 +1770,13 @@
 ])# AC_LIBTOOL_SYS_DYNAMIC_LINKER
 
 
 # _LT_AC_TAGCONFIG
 # ----------------
 AC_DEFUN([_LT_AC_TAGCONFIG],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_ARG_WITH([tags],
+[AC_ARG_WITH([tags],
     [AC_HELP_STRING([--with-tags@<:@=TAGS@:>@],
         [include additional configurations @<:@automatic@:>@])],
     [tagnames="$withval"])
 
 if test -f "$ltmain" && test -n "$tagnames"; then
   if test ! -f "${ofile}"; then
@@ -2094,13 +2031,13 @@
  AC_SUBST([EGREP])
 ])])
 
 
 # AC_PATH_TOOL_PREFIX
 # -------------------
-# find a file program which can recognize shared library
+# find a file program which can recognise shared library
 AC_DEFUN([AC_PATH_TOOL_PREFIX],
 [AC_REQUIRE([AC_PROG_EGREP])dnl
 AC_MSG_CHECKING([for $1])
 AC_CACHE_VAL(lt_cv_path_MAGIC_CMD,
 [case $MAGIC_CMD in
 [[\\/*] |  ?:[\\/]*])
@@ -2157,13 +2094,13 @@
 fi
 ])# AC_PATH_TOOL_PREFIX
 
 
 # AC_PATH_MAGIC
 # -------------
-# find a file program which can recognize a shared library
+# find a file program which can recognise a shared library
 AC_DEFUN([AC_PATH_MAGIC],
 [AC_PATH_TOOL_PREFIX(${ac_tool_prefix}file, /usr/bin$PATH_SEPARATOR$PATH)
 if test -z "$lt_cv_path_MAGIC_CMD"; then
   if test -n "$ac_tool_prefix"; then
     AC_PATH_TOOL_PREFIX(file, /usr/bin$PATH_SEPARATOR$PATH)
   else
@@ -2304,13 +2241,13 @@
 
 # AC_DEPLIBS_CHECK_METHOD
 # -----------------------
 # how to check for library dependencies
 #  -- PORTME fill in with the dynamic library characteristics
 AC_DEFUN([AC_DEPLIBS_CHECK_METHOD],
-[AC_CACHE_CHECK([how to recognize dependent libraries],
+[AC_CACHE_CHECK([how to recognise dependent libraries],
 lt_cv_deplibs_check_method,
 [lt_cv_file_magic_cmd='$MAGIC_CMD'
 lt_cv_file_magic_test_file=
 lt_cv_deplibs_check_method='unknown'
 # Need to set the preceding variable on all platforms that support
 # interlibrary dependencies.
@@ -2343,21 +2280,15 @@
   lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
   lt_cv_file_magic_cmd='func_win32_libid'
   ;;
 
 mingw* | pw32*)
   # Base MSYS/MinGW do not provide the 'file' command needed by
-  # func_win32_libid shell function, so use a weaker test based on 'objdump',
-  # unless we find 'file', for example because we are cross-compiling.
-  if ( file / ) >/dev/null 2>&1; then
-    lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
-    lt_cv_file_magic_cmd='func_win32_libid'
-  else
-    lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
-    lt_cv_file_magic_cmd='$OBJDUMP -f'
-  fi
+  # func_win32_libid shell function, so use a weaker test based on 'objdump'.
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
   ;;
 
 darwin* | rhapsody*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
@@ -2396,13 +2327,13 @@
     lt_cv_deplibs_check_method='file_magic (s[[0-9]][[0-9]][[0-9]]|PA-RISC[[0-9]].[[0-9]]) shared library'
     lt_cv_file_magic_test_file=/usr/lib/libc.sl
     ;;
   esac
   ;;
 
-interix[[3-9]]*)
+interix3*)
   # PIC code is broken on Interix 3.x, that's why |\.a not |_pic\.a here
   lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so|\.a)$'
   ;;
 
 irix5* | irix6* | nonstopux*)
   case $LD in
@@ -2446,16 +2377,12 @@
   ;;
 
 osf3* | osf4* | osf5*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-rdos*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
 solaris*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
 sysv4 | sysv4.3*)
   case $host_vendor in
@@ -2502,13 +2429,13 @@
 [AC_CACHE_CHECK([for BSD-compatible nm], lt_cv_path_NM,
 [if test -n "$NM"; then
   # Let the user override the test.
   lt_cv_path_NM="$NM"
 else
   lt_nm_to_check="${ac_tool_prefix}nm"
-  if test -n "$ac_tool_prefix" && test "$build" = "$host"; then
+  if test -n "$ac_tool_prefix" && test "$build" = "$host"; then 
     lt_nm_to_check="$lt_nm_to_check nm"
   fi
   for lt_tmp_nm in $lt_nm_to_check; do
     lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
     for ac_dir in $PATH /usr/ccs/bin/elf /usr/ccs/bin /usr/ucb /bin; do
       IFS="$lt_save_ifs"
@@ -2718,16 +2645,16 @@
 
 # Object file extension for compiled C test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(){return(0);}'
+lt_simple_link_test_code='int main(){return(0);}\n'
 
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
 _LT_LINKER_BOILERPLATE
@@ -2827,16 +2754,16 @@
 
 # Object file extension for compiled C++ test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(int, char *[[]]) { return(0); }'
+lt_simple_link_test_code='int main(int, char *[[]]) { return(0); }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -2976,13 +2903,13 @@
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
 	if test -f "$collect2name" && \
 	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	then
 	  # We have reworked collect2
-	  :
+	  _LT_AC_TAGVAR(hardcode_direct, $1)=yes
 	else
 	  # We have old collect2
 	  _LT_AC_TAGVAR(hardcode_direct, $1)=unsupported
 	  # It fails to find uninstalled libraries when the uninstalled
 	  # path is not listed in the libpath.  Setting hardcode_minus_L
 	  # to unsupported forces relinking
@@ -3135,16 +3062,16 @@
           fi
             _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
           _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          _LT_AC_TAGVAR(ld_shlibs, $1)=no
           ;;
       esac
@@ -3221,13 +3148,15 @@
   hpux10*|hpux11*)
     if test $with_gnu_ld = no; then
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}+b ${wl}$libdir'
       _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
 
       case $host_cpu in
-      hppa*64*|ia64*) ;;
+      hppa*64*|ia64*)
+	_LT_AC_TAGVAR(hardcode_libdir_flag_spec_ld, $1)='+b $libdir'
+        ;;
       *)
 	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
         ;;
       esac
     fi
     case $host_cpu in
@@ -3289,13 +3218,13 @@
 	  # FIXME: insert proper C++ library support
 	  _LT_AC_TAGVAR(ld_shlibs, $1)=no
 	fi
 	;;
     esac
     ;;
-  interix[[3-9]]*)
+  interix3*)
     _LT_AC_TAGVAR(hardcode_direct, $1)=no
     _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
     _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
     # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
     # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -3409,35 +3338,12 @@
 	# There doesn't appear to be a way to prevent this compiler from
 	# explicitly linking system object files so we need to strip them
 	# from the output so that they don't get included in the library
 	# dependencies.
 	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
 	;;
-      *)
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C++ 5.9
-	  _LT_AC_TAGVAR(no_undefined_flag, $1)=' -zdefs'
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file ${wl}$export_symbols'
-	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-
-	  # Not sure whether something based on
-	  # $CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1
-	  # would be better.
-	  output_verbose_link_cmd='echo'
-
-	  # Archives containing C++ object files must be created using
-	  # "CC -xar", where "CC" is the Sun C++ compiler.  This is
-	  # necessary to make sure instantiated templates are included
-	  # in the archive.
-	  _LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -xar -o $oldlib $oldobjs'
-	  ;;
-	esac
-	;;
     esac
     ;;
   lynxos*)
     # FIXME: insert proper C++ library support
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
@@ -3470,26 +3376,22 @@
     ;;
   openbsd2*)
     # C++ shared libraries are fairly broken
     _LT_AC_TAGVAR(ld_shlibs, $1)=no
     ;;
   openbsd*)
-    if test -f /usr/libexec/ld.so; then
-      _LT_AC_TAGVAR(hardcode_direct, $1)=yes
-      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
-      _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
-	_LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      fi
-      output_verbose_link_cmd='echo'
-    else
-      _LT_AC_TAGVAR(ld_shlibs, $1)=no
+    _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     fi
+    output_verbose_link_cmd='echo'
     ;;
   osf3*)
     case $cc_basename in
       KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
@@ -3645,16 +3547,21 @@
 
 	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
 	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
 	case $host_os in
 	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
 	  *)
-	    # The compiler driver will combine and reorder linker options,
-	    # but understands `-z linker_flag'.
+	    # The C++ compiler is used as linker so we must use $wl
+	    # flag to pass the commands to the underlying system
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract'
+	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=yes
 
 	output_verbose_link_cmd='echo'
 
@@ -3695,18 +3602,12 @@
 	    # what "hidden" libraries, object files and flags are used when
 	    # linking a shared library.
 	    output_verbose_link_cmd="$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
 	  fi
 
 	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-R $wl$libdir'
-	  case $host_os in
-	  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
-	  *)
-	    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	    ;;
-	  esac
 	fi
 	;;
     esac
     ;;
   sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7* | sco3.2v5.0.[[024]]*)
     _LT_AC_TAGVAR(no_undefined_flag, $1)='${wl}-z,text'
@@ -3948,60 +3849,27 @@
 
 $rm -f confest.$objext
 
 # PORTME: override above test on systems where it is broken
 ifelse([$1],[CXX],
 [case $host_os in
-interix[[3-9]]*)
+interix3*)
   # Interix 3.5 installs completely hosed .la files for C++, so rather than
   # hack all around it, let's just trust "g++" to DTRT.
   _LT_AC_TAGVAR(predep_objects,$1)=
   _LT_AC_TAGVAR(postdep_objects,$1)=
   _LT_AC_TAGVAR(postdeps,$1)=
   ;;
 
-linux*)
-  case `$CC -V 2>&1 | sed 5q` in
-  *Sun\ C*)
-    # Sun C++ 5.9
-    #
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-    if test "$solaris_use_stlport4" != yes; then
-      _LT_AC_TAGVAR(postdeps,$1)='-library=Cstd -library=Crun'
-    fi
-    ;;
-  esac
-  ;;
-
 solaris*)
   case $cc_basename in
   CC*)
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-
     # Adding this requires a known-good setup of shared libraries for
     # Sun compiler versions before 5.6, else PIC objects from an old
     # archive will be linked into the output, leading to subtle bugs.
-    if test "$solaris_use_stlport4" != yes; then
-      _LT_AC_TAGVAR(postdeps,$1)='-library=Cstd -library=Crun'
-    fi
+    _LT_AC_TAGVAR(postdeps,$1)='-lCstd -lCrun'
     ;;
   esac
   ;;
 esac
 ])
 
@@ -4044,23 +3912,16 @@
 
 # Object file extension for compiled f77 test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="\
-      subroutine t
-      return
-      end
-"
+lt_simple_compile_test_code="      subroutine t\n      return\n      end\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code="\
-      program t
-      end
-"
+lt_simple_link_test_code="      program t\n      end\n"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -4133,16 +3994,16 @@
 
 # Object file extension for compiled Java test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="class foo {}"
+lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }'
+lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
 
 # save warnings/boilerplate of simple test code
 _LT_COMPILER_BOILERPLATE
@@ -4193,13 +4054,13 @@
 
 # Object file extension for compiled RC test sources.
 objext=o
 _LT_AC_TAGVAR(objext, $1)=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }'
+lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }\n'
 
 # Code to be used in simple link tests
 lt_simple_link_test_code="$lt_simple_compile_test_code"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 _LT_AC_SYS_COMPILER
@@ -4282,13 +4143,12 @@
     _LT_AC_TAGVAR(hardcode_libdir_flag_spec_ld, $1) \
     _LT_AC_TAGVAR(hardcode_libdir_separator, $1) \
     _LT_AC_TAGVAR(hardcode_automatic, $1) \
     _LT_AC_TAGVAR(module_cmds, $1) \
     _LT_AC_TAGVAR(module_expsym_cmds, $1) \
     _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1) \
-    _LT_AC_TAGVAR(fix_srcfile_path, $1) \
     _LT_AC_TAGVAR(exclude_expsyms, $1) \
     _LT_AC_TAGVAR(include_expsyms, $1); do
 
     case $var in
     _LT_AC_TAGVAR(old_archive_cmds, $1) | \
     _LT_AC_TAGVAR(old_archive_from_new_cmds, $1) | \
@@ -4329,13 +4189,13 @@
 [#! $SHELL
 
 # `$echo "$cfgfile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
 # Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
 # NOTE: Changes made to this file will be lost: look at ltmain.sh.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
 # Free Software Foundation, Inc.
 #
 # This file is part of GNU Libtool:
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
@@ -4654,13 +4514,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$_LT_AC_TAGVAR(fix_srcfile_path, $1)"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$_LT_AC_TAGVAR(always_export_symbols, $1)
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_[]_LT_AC_TAGVAR(export_symbols_cmds, $1)
@@ -4737,13 +4597,12 @@
 
 
 # AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE
 # ---------------------------------
 AC_DEFUN([AC_LIBTOOL_SYS_GLOBAL_SYMBOL_PIPE],
 [AC_REQUIRE([AC_CANONICAL_HOST])
-AC_REQUIRE([LT_AC_PROG_SED])
 AC_REQUIRE([AC_PROG_NM])
 AC_REQUIRE([AC_OBJEXT])
 # Check for command to grab the raw symbol name followed by C symbol from nm.
 AC_MSG_CHECKING([command to parse $NM output from $compiler object])
 AC_CACHE_VAL([lt_cv_sys_global_symbol_pipe],
 [
@@ -4964,32 +4823,30 @@
     amigaos*)
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-m68020 -resident32 -malways-restore-a4'
       ;;
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
-    mingw* | cygwin* | os2* | pw32*)
+    mingw* | os2* | pw32*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fno-common'
       ;;
     *djgpp*)
       # DJGPP does not support shared libraries at all
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=
       ;;
-    interix[[3-9]]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
     sysv4*MP*)
       if test -d /usr/nec; then
 	_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=-Kconform_pic
@@ -5119,20 +4976,12 @@
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
 	    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)=
 	    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
-	    *Sun\ C*)
-	      # Sun C++ 5.9
-	      _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	      _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld '
-	      ;;
-	    esac
 	    ;;
 	esac
 	;;
       lynxos*)
 	;;
       m88k*)
@@ -5247,31 +5096,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fno-common'
       ;;
 
-    interix[[3-9]]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -5323,13 +5170,13 @@
          _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'
          _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -5375,41 +5222,21 @@
         ;;
       ccc*)
         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
         # All Alpha code is PIC.
         _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	  _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	  _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
-	  _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
-	  _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'
       # All OSF/1 code is PIC.
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
       ;;
 
-    rdos*)
-      _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'
-      ;;
-
     solaris*)
       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld ';;
@@ -5498,14 +5325,13 @@
 
 
 # AC_LIBTOOL_PROG_LD_SHLIBS([TAGNAME])
 # ------------------------------------
 # See if the linker supports building shared libraries.
 AC_DEFUN([AC_LIBTOOL_PROG_LD_SHLIBS],
-[AC_REQUIRE([LT_AC_PROG_SED])dnl
-AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
+[AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
 ifelse([$1],[CXX],[
   _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix4* | aix5*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
@@ -5516,13 +5342,13 @@
     fi
     ;;
   pw32*)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([[^ ]]*\) [[^ ]]*/\1 DATA/;/^I /d;/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   linux* | k*bsd*-gnu)
     _LT_AC_TAGVAR(link_all_deplibs, $1)=no
   ;;
   *)
     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
@@ -5658,13 +5484,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1) is actually meaningless,
       # as there is no search path for DLLs.
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-L$libdir'
       _LT_AC_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_AC_TAGVAR(always_export_symbols, $1)=no
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]] /s/.* \([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -5676,13 +5502,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
-    interix[[3-9]]*)
+    interix3*)
       _LT_AC_TAGVAR(hardcode_direct, $1)=no
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
       _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -5691,13 +5517,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -5709,28 +5535,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	_LT_AC_TAGVAR(archive_cmds, $1)='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	_LT_AC_TAGVAR(link_all_deplibs, $1)=no
       else
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
@@ -5765,13 +5582,13 @@
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
       fi
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
       case `$LD -v 2>&1` in
-        *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*)
+        *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*) 
 	_LT_AC_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
 
 *** Warning: Releases of the GNU linker prior to 2.16.91.0.3 can not
 *** reliably create shared libraries on SCO systems.  Therefore, libtool
 *** is disabling shared libraries support.  We urge you to upgrade GNU
@@ -5884,13 +5701,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  _LT_AC_TAGVAR(hardcode_direct, $1)=yes
 	  else
   	  # We have old collect2
   	  _LT_AC_TAGVAR(hardcode_direct, $1)=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -5977,13 +5794,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       _LT_AC_TAGVAR(old_archive_From_new_cmds, $1)='true'
       # FIXME: Should let the user specify the lib program.
-      _LT_AC_TAGVAR(old_archive_cmds, $1)='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      _LT_AC_TAGVAR(old_archive_cmds, $1)='lib /OUT:$oldlib$oldobjs$old_deplibs'
       _LT_AC_TAGVAR(fix_srcfile_path, $1)='`cygpath -w "$srcfile"`'
       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -6019,16 +5836,16 @@
       _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          _LT_AC_TAGVAR(ld_shlibs, $1)=no
           ;;
       esac
@@ -6184,34 +6001,30 @@
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
       _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	_LT_AC_TAGVAR(hardcode_direct, $1)=yes
-	_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	  _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[[01]].* | openbsd2.[[0-7]] | openbsd2.[[0-7]].*)
-	     _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
-	     ;;
-	   *)
-	     _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+	_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
       else
-	_LT_AC_TAGVAR(ld_shlibs, $1)=no
+       case $host_os in
+	 openbsd[[01]].* | openbsd2.[[0-7]] | openbsd2.[[0-7]].*)
+	   _LT_AC_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
+	   ;;
+	 *)
+	   _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-L$libdir'
       _LT_AC_TAGVAR(hardcode_minus_L, $1)=yes
@@ -6264,22 +6077,23 @@
       fi
       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       case $host_os in
       solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -6330,13 +6144,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	_LT_AC_TAGVAR(ld_shlibs, $1)=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7* | sco3.2v5.0.[[024]]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[[01]].[[10]]* | unixware7*)
       _LT_AC_TAGVAR(no_undefined_flag, $1)='${wl}-z,text'
       _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -6405,13 +6219,13 @@
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
       AC_MSG_CHECKING([whether -lc should be explicitly linked in])
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if AC_TRY_EVAL(ac_compile) 2>conftest.err; then
         soname=conftest
         lib=conftest
         libobjs=conftest.$ac_objext
         deplibs=
@@ -6508,36 +6322,12 @@
 ])
 
 AC_DEFUN([LT_AC_PROG_RC],
 [AC_CHECK_TOOL(RC, windres, no)
 ])
 
-
-# Cheap backport of AS_EXECUTABLE_P and required macros
-# from Autoconf 2.59; we should not use $as_executable_p directly.
-
-# _AS_TEST_PREPARE
-# ----------------
-m4_ifndef([_AS_TEST_PREPARE],
-[m4_defun([_AS_TEST_PREPARE],
-[if test -x / >/dev/null 2>&1; then
-  as_executable_p='test -x'
-else
-  as_executable_p='test -f'
-fi
-])])# _AS_TEST_PREPARE
-
-# AS_EXECUTABLE_P
-# ---------------
-# Check whether a file is executable.
-m4_ifndef([AS_EXECUTABLE_P],
-[m4_defun([AS_EXECUTABLE_P],
-[AS_REQUIRE([_AS_TEST_PREPARE])dnl
-$as_executable_p $1[]dnl
-])])# AS_EXECUTABLE_P
-
 ############################################################
 # NOTE: This macro has been submitted for inclusion into   #
 #  GNU Autoconf as AC_PROG_SED.  When it is available in   #
 #  a released version of Autoconf we should remove this    #
 #  macro and use it instead.                               #
 ############################################################
@@ -6554,19 +6344,18 @@
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for lt_ac_prog in sed gsed; do
     for ac_exec_ext in '' $ac_executable_extensions; do
-      if AS_EXECUTABLE_P(["$as_dir/$lt_ac_prog$ac_exec_ext"]); then
+      if $as_executable_p "$as_dir/$lt_ac_prog$ac_exec_ext"; then
         lt_ac_sed_list="$lt_ac_sed_list $as_dir/$lt_ac_prog$ac_exec_ext"
       fi
     done
   done
 done
-IFS=$as_save_IFS
 lt_ac_max=0
 lt_ac_count=0
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
   test ! -f $lt_ac_sed && continue
@@ -6593,23 +6382,22 @@
       lt_cv_path_SED=$lt_ac_sed
     fi
   done
 done
 ])
 SED=$lt_cv_path_SED
-AC_SUBST([SED])
 AC_MSG_RESULT([$SED])
 ])
 ## ltdl.m4 - Configure ltdl for the target system. -*-Autoconf-*-
-## Copyright (C) 1999-2006 Free Software Foundation, Inc.
+## Copyright (C) 1999-2000 Free Software Foundation, Inc.
 ##
 ## This file is free software; the Free Software Foundation gives
 ## unlimited permission to copy and/or distribute it, with or without
 ## modifications, as long as this notice is preserved.
 
-# serial 8 AC_LIB_LTDL
+# serial 7 AC_LIB_LTDL
 
 # AC_WITH_LTDL
 # ------------
 # Clients of libltdl can use this macro to allow the installer to
 # choose between a shipped copy of the ltdl sources or a preinstalled
 # version of the library.
@@ -6725,15 +6513,12 @@
     ;;
   darwin*)
     # Assuming the user has installed a libdl from somewhere, this is true
     # If you are looking for one http://www.opendarwin.org/projects/dlcompat
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
-  freebsd* | dragonfly*)
-    libltdl_cv_sys_dlopen_deplibs=yes
-    ;;
   gnu* | linux* | k*bsd*-gnu)
     # GNU and its variants, using gnu ld.so (Glibc)
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
   hpux10*|hpux11*)
     libltdl_cv_sys_dlopen_deplibs=yes
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/config.guess /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/config.guess
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/config.guess	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/config.guess	2006-03-12 02:49:04.000000000 +0800
@@ -1,13 +1,12 @@
 #! /bin/sh
 # Attempt to guess a canonical system name.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation,
-#   Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
 
-timestamp='2007-03-06'
+timestamp='2006-02-23'
 
 # This file is free software; you can redistribute it and/or modify it
 # under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
 #
@@ -158,13 +157,12 @@
 	    /usr/sbin/$sysctl 2>/dev/null || echo unknown)`
 	case "${UNAME_MACHINE_ARCH}" in
 	    armeb) machine=armeb-unknown ;;
 	    arm*) machine=arm-unknown ;;
 	    sh3el) machine=shl-unknown ;;
 	    sh3eb) machine=sh-unknown ;;
-	    sh5el) machine=sh5le-unknown ;;
 	    *) machine=${UNAME_MACHINE_ARCH}-unknown ;;
 	esac
 	# The Operating System including object format, if it has switched
 	# to ELF recently, or will in the future.
 	case "${UNAME_MACHINE_ARCH}" in
 	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
@@ -209,13 +207,13 @@
 	echo ${UNAME_MACHINE}-unknown-ekkobsd${UNAME_RELEASE}
 	exit ;;
     *:SolidBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-solidbsd${UNAME_RELEASE}
 	exit ;;
     macppc:MirBSD:*:*)
-	echo powerpc-unknown-mirbsd${UNAME_RELEASE}
+	echo powerppc-unknown-mirbsd${UNAME_RELEASE}
 	exit ;;
     *:MirBSD:*:*)
 	echo ${UNAME_MACHINE}-unknown-mirbsd${UNAME_RELEASE}
 	exit ;;
     alpha:OSF1:*:*)
 	case $UNAME_RELEASE in
@@ -769,40 +767,38 @@
 	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
 	exit ;;
     *:FreeBSD:*:*)
 	case ${UNAME_MACHINE} in
 	    pc98)
 		echo i386-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
-	    amd64)
-		echo x86_64-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
 	    *)
 		echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'` ;;
 	esac
 	exit ;;
     i*:CYGWIN*:*)
 	echo ${UNAME_MACHINE}-pc-cygwin
 	exit ;;
-    *:MINGW*:*)
+    i*:MINGW*:*)
+	echo ${UNAME_MACHINE}-pc-mingw32
+	exit ;;
+    i*:MSYS_NT-*:*:*)
 	echo ${UNAME_MACHINE}-pc-mingw32
 	exit ;;
     i*:windows32*:*)
     	# uname -m includes "-pc" on this system.
     	echo ${UNAME_MACHINE}-mingw32
 	exit ;;
     i*:PW*:*)
 	echo ${UNAME_MACHINE}-pc-pw32
 	exit ;;
-    *:Interix*:[3456]*)
-    	case ${UNAME_MACHINE} in
-	    x86) 
-		echo i586-pc-interix${UNAME_RELEASE}
-		exit ;;
-	    EM64T | authenticamd)
-		echo x86_64-unknown-interix${UNAME_RELEASE}
-		exit ;;
-	esac ;;
+    x86:Interix*:[345]*)
+	echo i586-pc-interix${UNAME_RELEASE}
+	exit ;;
+    EM64T:Interix*:[345]*)
+	echo x86_64-unknown-interix${UNAME_RELEASE}
+	exit ;;
     [345]86:Windows_95:* | [345]86:Windows_98:* | [345]86:Windows_NT:*)
 	echo i${UNAME_MACHINE}-pc-mks
 	exit ;;
     i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
 	# How do we know it's Interix rather than the generic POSIX subsystem?
 	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
@@ -832,15 +828,12 @@
     i*86:Minix:*:*)
 	echo ${UNAME_MACHINE}-pc-minix
 	exit ;;
     arm*:Linux:*:*)
 	echo ${UNAME_MACHINE}-unknown-linux-gnu
 	exit ;;
-    avr32*:Linux:*:*)
-	echo ${UNAME_MACHINE}-unknown-linux-gnu
-	exit ;;
     cris:Linux:*:*)
 	echo cris-axis-linux-gnu
 	exit ;;
     crisv32:Linux:*:*)
 	echo crisv32-axis-linux-gnu
 	exit ;;
@@ -951,15 +944,12 @@
     vax:Linux:*:*)
 	echo ${UNAME_MACHINE}-dec-linux-gnu
 	exit ;;
     x86_64:Linux:*:*)
 	echo x86_64-unknown-linux-gnu
 	exit ;;
-    xtensa:Linux:*:*)
-    	echo xtensa-unknown-linux-gnu
-	exit ;;
     i*86:Linux:*:*)
 	# The BFD linker knows what the default object file format is, so
 	# first see if it will tell us. cd to the root directory to prevent
 	# problems with other programs or directories called `ld' in the path.
 	# Set LC_ALL=C to ensure ld outputs messages in English.
 	ld_supported_targets=`cd /; LC_ALL=C ld --help 2>&1 \
@@ -996,13 +986,13 @@
 	LIBC=gnulibc1
 	#  endif
 	# else
 	LIBC=gnulibc1
 	# endif
 	#else
-	#if defined(__INTEL_COMPILER) || defined(__PGI) || defined(__SUNPRO_C) || defined(__SUNPRO_CC)
+	#if defined(__INTEL_COMPILER) || defined(__PGI) || defined(__sun)
 	LIBC=gnu
 	#else
 	LIBC=gnuaout
 	#endif
 	#endif
 	#ifdef __dietlibc__
@@ -1212,21 +1202,12 @@
     SX-5:SUPER-UX:*:*)
 	echo sx5-nec-superux${UNAME_RELEASE}
 	exit ;;
     SX-6:SUPER-UX:*:*)
 	echo sx6-nec-superux${UNAME_RELEASE}
 	exit ;;
-    SX-7:SUPER-UX:*:*)
-	echo sx7-nec-superux${UNAME_RELEASE}
-	exit ;;
-    SX-8:SUPER-UX:*:*)
-	echo sx8-nec-superux${UNAME_RELEASE}
-	exit ;;
-    SX-8R:SUPER-UX:*:*)
-	echo sx8r-nec-superux${UNAME_RELEASE}
-	exit ;;
     Power*:Rhapsody:*:*)
 	echo powerpc-apple-rhapsody${UNAME_RELEASE}
 	exit ;;
     *:Rhapsody:*:*)
 	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
 	exit ;;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/config.sub /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/config.sub
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/config.sub	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/config.sub	2006-03-12 02:49:04.000000000 +0800
@@ -1,13 +1,12 @@
 #! /bin/sh
 # Configuration validation subroutine script.
 #   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
-#   2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software Foundation,
-#   Inc.
+#   2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
 
-timestamp='2007-01-18'
+timestamp='2006-02-23'
 
 # This file is (in principle) common to ALL GNU software.
 # The presence of a machine in this file suggests that SOME GNU software
 # can handle that machine.  It does not imply ALL GNU software can.
 #
 # This file is free software; you can redistribute it and/or modify
@@ -238,22 +237,21 @@
 	# Some are omitted here because they have special meanings below.
 	1750a | 580 \
 	| a29k \
 	| alpha | alphaev[4-8] | alphaev56 | alphaev6[78] | alphapca5[67] \
 	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
 	| am33_2.0 \
-	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr | avr32 \
+	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
 	| bfin \
 	| c4x | clipper \
 	| d10v | d30v | dlx | dsp16xx \
-	| fido | fr30 | frv \
+	| fr30 | frv \
 	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
 	| i370 | i860 | i960 | ia64 \
 	| ip2k | iq2000 \
-	| m32c | m32r | m32rle | m68000 | m68k | m88k \
-	| maxq | mb | microblaze | mcore | mep \
+	| m32r | m32rle | m68000 | m68k | m88k | maxq | mb | microblaze | mcore \
 	| mips | mipsbe | mipseb | mipsel | mipsle \
 	| mips16 \
 	| mips64 | mips64el \
 	| mips64vr | mips64vrel \
 	| mips64orion | mips64orionel \
 	| mips64vr4100 | mips64vr4100el \
@@ -273,25 +271,27 @@
 	| nios | nios2 \
 	| ns16k | ns32k \
 	| or32 \
 	| pdp10 | pdp11 | pj | pjl \
 	| powerpc | powerpc64 | powerpc64le | powerpcle | ppcbe \
 	| pyramid \
-	| score \
-	| sh | sh[1234] | sh[24]a | sh[23]e | sh[34]eb | sheb | shbe | shle | sh[1234]le | sh3ele \
+	| sh | sh[1234] | sh[24]a | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
 	| sh64 | sh64le \
-	| sparc | sparc64 | sparc64b | sparc64v | sparc86x | sparclet | sparclite \
-	| sparcv8 | sparcv9 | sparcv9b | sparcv9v \
-	| spu | strongarm \
+	| sparc | sparc64 | sparc64b | sparc86x | sparclet | sparclite \
+	| sparcv8 | sparcv9 | sparcv9b \
+	| strongarm \
 	| tahoe | thumb | tic4x | tic80 | tron \
 	| v850 | v850e \
 	| we32k \
-	| x86 | xc16x | xscale | xscalee[bl] | xstormy16 | xtensa \
+	| x86 | xscale | xscalee[bl] | xstormy16 | xtensa \
 	| z8k)
 		basic_machine=$basic_machine-unknown
 		;;
+	m32c)
+		basic_machine=$basic_machine-unknown
+		;;
 	m6811 | m68hc11 | m6812 | m68hc12)
 		# Motorola 68HC11/12.
 		basic_machine=$basic_machine-unknown
 		os=-none
 		;;
 	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | v70 | w65 | z8k)
@@ -315,24 +315,24 @@
 	580-* \
 	| a29k-* \
 	| alpha-* | alphaev[4-8]-* | alphaev56-* | alphaev6[78]-* \
 	| alpha64-* | alpha64ev[4-8]-* | alpha64ev56-* | alpha64ev6[78]-* \
 	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
 	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
-	| avr-* | avr32-* \
+	| avr-* \
 	| bfin-* | bs2000-* \
 	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
 	| clipper-* | craynv-* | cydra-* \
 	| d10v-* | d30v-* | dlx-* \
 	| elxsi-* \
-	| f30[01]-* | f700-* | fido-* | fr30-* | frv-* | fx80-* \
+	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
 	| h8300-* | h8500-* \
 	| hppa-* | hppa1.[01]-* | hppa2.0-* | hppa2.0[nw]-* | hppa64-* \
 	| i*86-* | i860-* | i960-* | ia64-* \
 	| ip2k-* | iq2000-* \
-	| m32c-* | m32r-* | m32rle-* \
+	| m32r-* | m32rle-* \
 	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
 	| m88110-* | m88k-* | maxq-* | mcore-* \
 	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
 	| mips16-* \
 	| mips64-* | mips64el-* \
 	| mips64vr-* | mips64vrel-* \
@@ -355,27 +355,29 @@
 	| none-* | np1-* | ns16k-* | ns32k-* \
 	| orion-* \
 	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
 	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
 	| pyramid-* \
 	| romp-* | rs6000-* \
-	| sh-* | sh[1234]-* | sh[24]a-* | sh[23]e-* | sh[34]eb-* | sheb-* | shbe-* \
+	| sh-* | sh[1234]-* | sh[24]a-* | sh[23]e-* | sh[34]eb-* | shbe-* \
 	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
-	| sparc-* | sparc64-* | sparc64b-* | sparc64v-* | sparc86x-* | sparclet-* \
+	| sparc-* | sparc64-* | sparc64b-* | sparc86x-* | sparclet-* \
 	| sparclite-* \
-	| sparcv8-* | sparcv9-* | sparcv9b-* | sparcv9v-* | strongarm-* | sv1-* | sx?-* \
+	| sparcv8-* | sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
 	| tahoe-* | thumb-* \
 	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
 	| tron-* \
 	| v850-* | v850e-* | vax-* \
 	| we32k-* \
-	| x86-* | x86_64-* | xc16x-* | xps100-* | xscale-* | xscalee[bl]-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xscalee[bl]-* \
 	| xstormy16-* | xtensa-* \
 	| ymp-* \
 	| z8k-*)
 		;;
+	m32c-*)
+		;;
 	# Recognize the various machine names and aliases which stand
 	# for a CPU type and a company and sometimes even an OS.
 	386bsd)
 		basic_machine=i386-unknown
 		os=-bsd
 		;;
@@ -907,30 +909,23 @@
 	sb1)
 		basic_machine=mipsisa64sb1-unknown
 		;;
 	sb1el)
 		basic_machine=mipsisa64sb1el-unknown
 		;;
-	sde)
-		basic_machine=mipsisa32-sde
-		os=-elf
-		;;
 	sei)
 		basic_machine=mips-sei
 		os=-seiux
 		;;
 	sequent)
 		basic_machine=i386-sequent
 		;;
 	sh)
 		basic_machine=sh-hitachi
 		os=-hms
 		;;
-	sh5el)
-		basic_machine=sh5le-unknown
-		;;
 	sh64)
 		basic_machine=sh64-unknown
 		;;
 	sparclite-wrs | simso-wrs)
 		basic_machine=sparclite-wrs
 		os=-vxworks
@@ -1130,13 +1125,13 @@
 	we32k)
 		basic_machine=we32k-att
 		;;
 	sh[1234] | sh[24]a | sh[34]eb | sh[1234]le | sh[23]ele)
 		basic_machine=sh-unknown
 		;;
-	sparc | sparcv8 | sparcv9 | sparcv9b | sparcv9v)
+	sparc | sparcv8 | sparcv9 | sparcv9b)
 		basic_machine=sparc-sun
 		;;
 	cydra)
 		basic_machine=cydra-cydrome
 		;;
 	orion)
@@ -1219,13 +1214,13 @@
 	      | -interix* | -uwin* | -mks* | -rhapsody* | -darwin* | -opened* \
 	      | -openstep* | -oskit* | -conix* | -pw32* | -nonstopux* \
 	      | -storm-chaos* | -tops10* | -tenex* | -tops20* | -its* \
 	      | -os2* | -vos* | -palmos* | -uclinux* | -nucleus* \
 	      | -morphos* | -superux* | -rtmk* | -rtmk-nova* | -windiss* \
 	      | -powermax* | -dnix* | -nx6 | -nx7 | -sei* | -dragonfly* \
-	      | -skyos* | -haiku* | -rdos* | -toppers* | -drops*)
+	      | -skyos* | -haiku* | -rdos*)
 	# Remember, each alternative MUST END IN *, to match a version number.
 		;;
 	-qnx*)
 		case $basic_machine in
 		    x86-* | i*86-*)
 			;;
@@ -1371,30 +1366,24 @@
 # "-sun"), then you have to tell the case statement up towards the top
 # that MANUFACTURER isn't an operating system.  Otherwise, code above
 # will signal an error saying that MANUFACTURER isn't an operating
 # system, and we'll never get to this point.
 
 case $basic_machine in
-        score-*)
-		os=-elf
-		;;
-        spu-*)
-		os=-elf
-		;;
 	*-acorn)
 		os=-riscix1.2
 		;;
 	arm*-rebel)
 		os=-linux
 		;;
 	arm*-semi)
 		os=-aout
 		;;
-        c4x-* | tic4x-*)
-        	os=-coff
-		;;
+    c4x-* | tic4x-*)
+        os=-coff
+        ;;
 	# This must come before the *-dec entry.
 	pdp10-*)
 		os=-tops20
 		;;
 	pdp11-*)
 		os=-none
@@ -1414,15 +1403,12 @@
 		# default.
 		# os=-sunos4
 		;;
 	m68*-cisco)
 		os=-aout
 		;;
-        mep-*)
-		os=-elf
-		;;
 	mips*-cisco)
 		os=-elf
 		;;
 	mips*-*)
 		os=-elf
 		;;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/configure	2007-09-28 19:33:40.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/configure	2006-03-12 02:49:04.000000000 +0800
@@ -1,105 +1,41 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61 for libltdl 1.2.
+# Generated by GNU Autoconf 2.59 for libltdl 1.2.
 #
 # Report bugs to <bug-libtool@gnu.org>.
 #
-# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-# 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
+# Copyright (C) 2003 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
 ## M4sh Initialization.  ##
 ## --------------------- ##
 
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
+# Be Bourne compatible
 if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
+elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
+  set -o posix
 fi
+DUALCASE=1; export DUALCASE # for MKS sh
 
 # Support unset when possible.
 if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
   as_unset=unset
 else
   as_unset=false
 fi
 
 
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
 # Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
+$as_unset ENV MAIL MAILPATH
 PS1='$ '
 PS2='> '
 PS4='+ '
 
 # NLS nuisances.
 for as_var in \
@@ -107,452 +43,208 @@
   LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
   LC_TELEPHONE LC_TIME
 do
   if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
     eval $as_var=C; export $as_var
   else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
+    $as_unset $as_var
   fi
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+if expr a : '\(a\)' >/dev/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
 fi
 
 
 # Name of the executable.
-as_me=`$as_basename -- "$0" ||
+as_me=`$as_basename "$0" ||
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$0" : 'X\(/\)$' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
+  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\/\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
 
-# CDPATH.
-$as_unset CDPATH
-
-
-if test "x$CONFIG_SHELL" = x; then
-  if (eval ":") 2>/dev/null; then
-  as_have_required=yes
-else
-  as_have_required=no
-fi
-
-  if test $as_have_required = yes && 	 (eval ":
-(as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
 
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
+# PATH needs CR, and LINENO needs CR and PATH.
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
 
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
 fi
 
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
 
-test \$exitcode = 0) || { (exit 1); exit 1; }
+  as_lineno_1=$LINENO
+  as_lineno_2=$LINENO
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  test "x$as_lineno_1" != "x$as_lineno_2" &&
+  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
+  # Find who we are.  Look in the path if we contain no path at all
+  # relative or not.
+  case $0 in
+    *[\\/]* ) as_myself=$0 ;;
+    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+done
 
-(
-  as_lineno_1=\$LINENO
-  as_lineno_2=\$LINENO
-  test \"x\$as_lineno_1\" != \"x\$as_lineno_2\" &&
-  test \"x\`expr \$as_lineno_1 + 1\`\" = \"x\$as_lineno_2\") || { (exit 1); exit 1; }
-") 2> /dev/null; then
-  :
-else
-  as_candidate_shells=
+       ;;
+  esac
+  # We did not find ourselves, most probably we were run as `sh COMMAND'
+  # in which case we are not to be found in the path.
+  if test "x$as_myself" = x; then
+    as_myself=$0
+  fi
+  if test ! -f "$as_myself"; then
+    { echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2
+   { (exit 1); exit 1; }; }
+  fi
+  case $CONFIG_SHELL in
+  '')
     as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
-  case $as_dir in
+  for as_base in sh bash ksh sh5; do
+	 case $as_dir in
 	 /*)
-	   for as_base in sh bash ksh sh5; do
-	     as_candidate_shells="$as_candidate_shells $as_dir/$as_base"
-	   done;;
-       esac
-done
-IFS=$as_save_IFS
-
-
-      for as_shell in $as_candidate_shells $SHELL; do
-	 # Try only shells that exist, to save several forks.
-	 if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
-		{ ("$as_shell") 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-_ASEOF
-}; then
-  CONFIG_SHELL=$as_shell
-	       as_have_required=yes
-	       if { "$as_shell" 2> /dev/null <<\_ASEOF
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-:
-(as_func_return () {
-  (exit $1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = "$1" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test $exitcode = 0) || { (exit 1); exit 1; }
-
-(
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2") || { (exit 1); exit 1; }
-
-_ASEOF
-}; then
-  break
-fi
-
-fi
-
-      done
-
-      if test "x$CONFIG_SHELL" != x; then
-  for as_var in BASH_ENV ENV
-        do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-        done
-        export CONFIG_SHELL
-        exec "$CONFIG_SHELL" "$as_myself" ${1+"$@"}
-fi
-
-
-    if test $as_have_required = no; then
-  echo This script requires a shell more modern than all the
-      echo shells that I found on your system.  Please install a
-      echo modern shell, or manually run the script under such a
-      echo shell if you do have one.
-      { (exit 1); exit 1; }
-fi
-
-
-fi
-
-fi
-
-
-
-(eval "as_func_return () {
-  (exit \$1)
-}
-as_func_success () {
-  as_func_return 0
-}
-as_func_failure () {
-  as_func_return 1
-}
-as_func_ret_success () {
-  return 0
-}
-as_func_ret_failure () {
-  return 1
-}
-
-exitcode=0
-if as_func_success; then
-  :
-else
-  exitcode=1
-  echo as_func_success failed.
-fi
-
-if as_func_failure; then
-  exitcode=1
-  echo as_func_failure succeeded.
-fi
-
-if as_func_ret_success; then
-  :
-else
-  exitcode=1
-  echo as_func_ret_success failed.
-fi
-
-if as_func_ret_failure; then
-  exitcode=1
-  echo as_func_ret_failure succeeded.
-fi
-
-if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
-  :
-else
-  exitcode=1
-  echo positional parameters were not saved.
-fi
-
-test \$exitcode = 0") || {
-  echo No shell found that supports shell functions.
-  echo Please tell autoconf@gnu.org about your system,
-  echo including any error possibly output before this
-  echo message
-}
-
-
-
+	   if ("$as_dir/$as_base" -c '
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
+  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
+	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
+	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
+	     CONFIG_SHELL=$as_dir/$as_base
+	     export CONFIG_SHELL
+	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
+	   fi;;
+	 esac
+       done
+done
+;;
+  esac
 
   # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
   # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
+  # line-number line before each line; the second 'sed' does the real
+  # work.  The second script uses 'N' to pair each line-number line
+  # with the numbered line, and appends trailing '-' during
+  # substitution so that $LINENO is not a special case at line end.
   # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
+  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
+  sed '=' <$as_myself |
     sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
       N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
+      s,$,-,
+      : loop
+      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
       t loop
-      s/-\n.*//
+      s,-$,,
+      s,^['$as_cr_digits']*\n,,
     ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
+  chmod +x $as_me.lineno ||
     { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
    { (exit 1); exit 1; }; }
 
   # Don't try to exec as it changes $[0], causing all sort of problems
   # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
+  # original and so on.  Autoconf is especially sensible to this).
+  . ./$as_me.lineno
   # Exit status is that of the last command.
   exit
 }
 
 
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
+case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
+  *c*,-n*) ECHO_N= ECHO_C='
+' ECHO_T='	' ;;
+  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
+  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+if expr a : '\(a\)' >/dev/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
 rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
 echo >conf$$.file
 if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+  # We could just check for DJGPP; but this test a) works b) is more generic
+  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
+  if test -f conf$$.exe; then
+    # Don't use ln at all; we don't have any links
     as_ln_s='cp -p'
+  else
+    as_ln_s='ln -s'
+  fi
 elif ln conf$$.file conf$$ 2>/dev/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
+rm -f conf$$ conf$$.exe conf$$.file
 
 if mkdir -p . 2>/dev/null; then
   as_mkdir_p=:
 else
   test -d ./-p && rmdir ./-p
   as_mkdir_p=false
 fi
 
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
+as_executable_p="test -f"
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
 
 # Sed expression to map a string onto a valid variable name.
 as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
 
 
+# IFS
+# We need space, tab and new line, in precisely that order.
+as_nl='
+'
+IFS=" 	$as_nl"
+
+# CDPATH.
+$as_unset CDPATH
+
 
 
 # Check that we are running under the correct shell.
 SHELL=${CONFIG_SHELL-/bin/sh}
 
 case X$ECHO in
@@ -702,205 +394,82 @@
 
 
 tagnames=${tagnames+${tagnames},}CXX
 
 tagnames=${tagnames+${tagnames},}F77
 
-exec 7<&0 </dev/null 6>&1
-
 # Name of the host.
 # hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
 # so uname gets run too.
 ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
 
+exec 6>&1
+
 #
 # Initializations.
 #
 ac_default_prefix=/usr/local
-ac_clean_files=
 ac_config_libobj_dir=.
-LIBOBJS=
 cross_compiling=no
 subdirs=
 MFLAGS=
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
+# Maximum number of lines to put in a shell here document.
+# This variable seems obsolete.  It should probably be removed, and
+# only ac_max_sed_lines should be used.
+: ${ac_max_here_lines=38}
+
 # Identity of this package.
 PACKAGE_NAME='libltdl'
 PACKAGE_TARNAME='libltdl'
 PACKAGE_VERSION='1.2'
 PACKAGE_STRING='libltdl 1.2'
 PACKAGE_BUGREPORT='bug-libtool@gnu.org'
 
 ac_unique_file="ltdl.c"
 # Factoring default headers for most tests.
 ac_includes_default="\
 #include <stdio.h>
-#ifdef HAVE_SYS_TYPES_H
+#if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
-#ifdef HAVE_SYS_STAT_H
+#if HAVE_SYS_STAT_H
 # include <sys/stat.h>
 #endif
-#ifdef STDC_HEADERS
+#if STDC_HEADERS
 # include <stdlib.h>
 # include <stddef.h>
 #else
-# ifdef HAVE_STDLIB_H
+# if HAVE_STDLIB_H
 #  include <stdlib.h>
 # endif
 #endif
-#ifdef HAVE_STRING_H
-# if !defined STDC_HEADERS && defined HAVE_MEMORY_H
+#if HAVE_STRING_H
+# if !STDC_HEADERS && HAVE_MEMORY_H
 #  include <memory.h>
 # endif
 # include <string.h>
 #endif
-#ifdef HAVE_STRINGS_H
+#if HAVE_STRINGS_H
 # include <strings.h>
 #endif
-#ifdef HAVE_INTTYPES_H
+#if HAVE_INTTYPES_H
 # include <inttypes.h>
+#else
+# if HAVE_STDINT_H
+#  include <stdint.h>
+# endif
 #endif
-#ifdef HAVE_STDINT_H
-# include <stdint.h>
-#endif
-#ifdef HAVE_UNISTD_H
+#if HAVE_UNISTD_H
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL
-PATH_SEPARATOR
-PACKAGE_NAME
-PACKAGE_TARNAME
-PACKAGE_VERSION
-PACKAGE_STRING
-PACKAGE_BUGREPORT
-exec_prefix
-prefix
-program_transform_name
-bindir
-sbindir
-libexecdir
-datarootdir
-datadir
-sysconfdir
-sharedstatedir
-localstatedir
-includedir
-oldincludedir
-docdir
-infodir
-htmldir
-dvidir
-pdfdir
-psdir
-libdir
-localedir
-mandir
-DEFS
-ECHO_C
-ECHO_N
-ECHO_T
-LIBS
-build_alias
-host_alias
-target_alias
-INSTALL_PROGRAM
-INSTALL_SCRIPT
-INSTALL_DATA
-CYGPATH_W
-PACKAGE
-VERSION
-ACLOCAL
-AUTOCONF
-AUTOMAKE
-AUTOHEADER
-MAKEINFO
-install_sh
-STRIP
-INSTALL_STRIP_PROGRAM
-mkdir_p
-AWK
-SET_MAKE
-am__leading_dot
-AMTAR
-am__tar
-am__untar
-CC
-CFLAGS
-LDFLAGS
-CPPFLAGS
-ac_ct_CC
-EXEEXT
-OBJEXT
-DEPDIR
-am__include
-am__quote
-AMDEP_TRUE
-AMDEP_FALSE
-AMDEPBACKSLASH
-CCDEPMODE
-am__fastdepCC_TRUE
-am__fastdepCC_FALSE
-build
-build_cpu
-build_vendor
-build_os
-host
-host_cpu
-host_vendor
-host_os
-SED
-GREP
-EGREP
-LN_S
-ECHO
-AR
-RANLIB
-DLLTOOL
-AS
-OBJDUMP
-CPP
-CXX
-CXXFLAGS
-ac_ct_CXX
-CXXDEPMODE
-am__fastdepCXX_TRUE
-am__fastdepCXX_FALSE
-CXXCPP
-F77
-FFLAGS
-ac_ct_F77
-LIBTOOL
-LIBTOOL_DEPS
-INSTALL_LTDL_TRUE
-INSTALL_LTDL_FALSE
-CONVENIENCE_LTDL_TRUE
-CONVENIENCE_LTDL_FALSE
-LIBADD_DL
-LIBOBJS
-LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE build build_cpu build_vendor build_os host host_cpu host_vendor host_os EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB DLLTOOL ac_ct_DLLTOOL AS ac_ct_AS OBJDUMP ac_ct_OBJDUMP CPP CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL LIBTOOL_DEPS INSTALL_LTDL_TRUE INSTALL_LTDL_FALSE CONVENIENCE_LTDL_TRUE CONVENIENCE_LTDL_FALSE LIBADD_DL LIBOBJS LTLIBOBJS'
 ac_subst_files=''
-      ac_precious_vars='build_alias
-host_alias
-target_alias
-CC
-CFLAGS
-LDFLAGS
-LIBS
-CPPFLAGS
-CPP
-CXX
-CXXFLAGS
-CCC
-CXXCPP
-F77
-FFLAGS'
-
 
 # Initialize some variables set by options.
 ac_init_help=
 ac_init_version=false
 # The variables have the same names as the options, with
 # dashes changed to underlines.
@@ -921,54 +490,40 @@
 
 # Installation directory options.
 # These are left unexpanded so users can "make install exec_prefix=/foo"
 # and all the variables that are supposed to be based on exec_prefix
 # by default will actually change.
 # Use braces instead of parens because sh, perl, etc. also accept them.
-# (The list follows the same order as the GNU Coding Standards.)
 bindir='${exec_prefix}/bin'
 sbindir='${exec_prefix}/sbin'
 libexecdir='${exec_prefix}/libexec'
-datarootdir='${prefix}/share'
-datadir='${datarootdir}'
+datadir='${prefix}/share'
 sysconfdir='${prefix}/etc'
 sharedstatedir='${prefix}/com'
 localstatedir='${prefix}/var'
+libdir='${exec_prefix}/lib'
 includedir='${prefix}/include'
 oldincludedir='/usr/include'
-docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
-infodir='${datarootdir}/info'
-htmldir='${docdir}'
-dvidir='${docdir}'
-pdfdir='${docdir}'
-psdir='${docdir}'
-libdir='${exec_prefix}/lib'
-localedir='${datarootdir}/locale'
-mandir='${datarootdir}/man'
+infodir='${prefix}/info'
+mandir='${prefix}/man'
 
 ac_prev=
-ac_dashdash=
 for ac_option
 do
   # If the previous option needs an argument, assign it.
   if test -n "$ac_prev"; then
-    eval $ac_prev=\$ac_option
+    eval "$ac_prev=\$ac_option"
     ac_prev=
     continue
   fi
 
-  case $ac_option in
-  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
-  *)	ac_optarg=yes ;;
-  esac
+  ac_optarg=`expr "x$ac_option" : 'x[^=]*=\(.*\)'`
 
   # Accept the important Cygnus configure options, so we can diagnose typos.
 
-  case $ac_dashdash$ac_option in
-  --)
-    ac_dashdash=yes ;;
+  case $ac_option in
 
   -bindir | --bindir | --bindi | --bind | --bin | --bi)
     ac_prev=bindir ;;
   -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
     bindir=$ac_optarg ;;
 
@@ -984,51 +539,39 @@
   | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
     cache_file=$ac_optarg ;;
 
   --config-cache | -C)
     cache_file=config.cache ;;
 
-  -datadir | --datadir | --datadi | --datad)
+  -datadir | --datadir | --datadi | --datad | --data | --dat | --da)
     ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=*)
+  -datadir=* | --datadir=* | --datadi=* | --datad=* | --data=* | --dat=* \
+  | --da=*)
     datadir=$ac_optarg ;;
 
-  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
-  | --dataroo | --dataro | --datar)
-    ac_prev=datarootdir ;;
-  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
-  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
-    datarootdir=$ac_optarg ;;
-
   -disable-* | --disable-*)
     ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=no ;;
-
-  -docdir | --docdir | --docdi | --doc | --do)
-    ac_prev=docdir ;;
-  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
-    docdir=$ac_optarg ;;
-
-  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
-    ac_prev=dvidir ;;
-  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
-    dvidir=$ac_optarg ;;
+    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
+    eval "enable_$ac_feature=no" ;;
 
   -enable-* | --enable-*)
     ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid feature name: $ac_feature" >&2
    { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
-    eval enable_$ac_feature=\$ac_optarg ;;
+    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
+    case $ac_option in
+      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
+      *) ac_optarg=yes ;;
+    esac
+    eval "enable_$ac_feature='$ac_optarg'" ;;
 
   -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
   | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
   | --exec | --exe | --ex)
     ac_prev=exec_prefix ;;
   -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
@@ -1049,18 +592,12 @@
 
   -host | --host | --hos | --ho)
     ac_prev=host_alias ;;
   -host=* | --host=* | --hos=* | --ho=*)
     host_alias=$ac_optarg ;;
 
-  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
-    ac_prev=htmldir ;;
-  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
-  | --ht=*)
-    htmldir=$ac_optarg ;;
-
   -includedir | --includedir | --includedi | --included | --include \
   | --includ | --inclu | --incl | --inc)
     ac_prev=includedir ;;
   -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
   | --includ=* | --inclu=* | --incl=* | --inc=*)
     includedir=$ac_optarg ;;
@@ -1079,22 +616,19 @@
   | --libexe | --libex | --libe)
     ac_prev=libexecdir ;;
   -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
   | --libexe=* | --libex=* | --libe=*)
     libexecdir=$ac_optarg ;;
 
-  -localedir | --localedir | --localedi | --localed | --locale)
-    ac_prev=localedir ;;
-  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
-    localedir=$ac_optarg ;;
-
   -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst | --locals)
+  | --localstate | --localstat | --localsta | --localst \
+  | --locals | --local | --loca | --loc | --lo)
     ac_prev=localstatedir ;;
   -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
+  | --localstate=* | --localstat=* | --localsta=* | --localst=* \
+  | --locals=* | --local=* | --loca=* | --loc=* | --lo=*)
     localstatedir=$ac_optarg ;;
 
   -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
     ac_prev=mandir ;;
   -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
     mandir=$ac_optarg ;;
@@ -1153,22 +687,12 @@
   | --program-transform=* | --program-transfor=* \
   | --program-transfo=* | --program-transf=* \
   | --program-trans=* | --program-tran=* \
   | --progr-tra=* | --program-tr=* | --program-t=*)
     program_transform_name=$ac_optarg ;;
 
-  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
-    ac_prev=pdfdir ;;
-  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
-    pdfdir=$ac_optarg ;;
-
-  -psdir | --psdir | --psdi | --psd | --ps)
-    ac_prev=psdir ;;
-  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
-    psdir=$ac_optarg ;;
-
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
   | -silent | --silent | --silen | --sile | --sil)
     silent=yes ;;
 
   -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
     ac_prev=sbindir ;;
@@ -1215,26 +739,30 @@
   -version | --version | --versio | --versi | --vers | -V)
     ac_init_version=: ;;
 
   -with-* | --with-*)
     ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=\$ac_optarg ;;
+    ac_package=`echo $ac_package| sed 's/-/_/g'`
+    case $ac_option in
+      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
+      *) ac_optarg=yes ;;
+    esac
+    eval "with_$ac_package='$ac_optarg'" ;;
 
   -without-* | --without-*)
     ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
     # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid package name: $ac_package" >&2
    { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
-    eval with_$ac_package=no ;;
+    ac_package=`echo $ac_package | sed 's/-/_/g'`
+    eval "with_$ac_package=no" ;;
 
   --x)
     # Obsolete; use --with-x.
     with_x=yes ;;
 
   -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
@@ -1259,13 +787,14 @@
   *=*)
     ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
     # Reject names that are not valid shell variable names.
     expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
       { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
    { (exit 1); exit 1; }; }
-    eval $ac_envvar=\$ac_optarg
+    ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`
+    eval "$ac_envvar='$ac_optarg'"
     export $ac_envvar ;;
 
   *)
     # FIXME: should be removed in autoconf 3.0.
     echo "$as_me: WARNING: you should use --build, --host, --target" >&2
     expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
@@ -1279,25 +808,33 @@
 if test -n "$ac_prev"; then
   ac_option=--`echo $ac_prev | sed 's/_/-/g'`
   { echo "$as_me: error: missing argument to $ac_option" >&2
    { (exit 1); exit 1; }; }
 fi
 
-# Be sure to have absolute directory names.
-for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
-		datadir sysconfdir sharedstatedir localstatedir includedir \
-		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
-		libdir localedir mandir
+# Be sure to have absolute paths.
+for ac_var in exec_prefix prefix
+do
+  eval ac_val=$`echo $ac_var`
+  case $ac_val in
+    [\\/$]* | ?:[\\/]* | NONE | '' ) ;;
+    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
+   { (exit 1); exit 1; }; };;
+  esac
+done
+
+# Be sure to have absolute paths.
+for ac_var in bindir sbindir libexecdir datadir sysconfdir sharedstatedir \
+	      localstatedir libdir includedir oldincludedir infodir mandir
 do
-  eval ac_val=\$$ac_var
+  eval ac_val=$`echo $ac_var`
   case $ac_val in
-    [\\/$]* | ?:[\\/]* )  continue;;
-    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
+    [\\/$]* | ?:[\\/]* ) ;;
+    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
+   { (exit 1); exit 1; }; };;
   esac
-  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; }
 done
 
 # There might be people who depend on the old broken behavior: `$host'
 # used to hold the argument of --host etc.
 # FIXME: To remove some day.
 build=$build_alias
@@ -1318,82 +855,100 @@
 ac_tool_prefix=
 test -n "$host_alias" && ac_tool_prefix=$host_alias-
 
 test "$silent" = yes && exec 6>/dev/null
 
 
-ac_pwd=`pwd` && test -n "$ac_pwd" &&
-ac_ls_di=`ls -di .` &&
-ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
-  { echo "$as_me: error: Working directory cannot be determined" >&2
-   { (exit 1); exit 1; }; }
-test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
-  { echo "$as_me: error: pwd does not report name of working directory" >&2
-   { (exit 1); exit 1; }; }
-
-
 # Find the source files, if location was not specified.
 if test -z "$srcdir"; then
   ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then the parent directory.
-  ac_confdir=`$as_dirname -- "$0" ||
+  # Try the directory containing this script, then its parent.
+  ac_confdir=`(dirname "$0") 2>/dev/null ||
 $as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$0" : 'X\(//\)[^/]' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$0" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
   srcdir=$ac_confdir
-  if test ! -r "$srcdir/$ac_unique_file"; then
+  if test ! -r $srcdir/$ac_unique_file; then
     srcdir=..
   fi
 else
   ac_srcdir_defaulted=no
 fi
-if test ! -r "$srcdir/$ac_unique_file"; then
-  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
-  { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
+if test ! -r $srcdir/$ac_unique_file; then
+  if test "$ac_srcdir_defaulted" = yes; then
+    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $ac_confdir or .." >&2
+   { (exit 1); exit 1; }; }
+  else
+    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
    { (exit 1); exit 1; }; }
+  fi
 fi
-ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
-ac_abs_confdir=`(
-	cd "$srcdir" && test -r "./$ac_unique_file" || { echo "$as_me: error: $ac_msg" >&2
+(cd $srcdir && test -r ./$ac_unique_file) 2>/dev/null ||
+  { echo "$as_me: error: sources are in $srcdir, but \`cd $srcdir' does not work" >&2
    { (exit 1); exit 1; }; }
-	pwd)`
-# When building in place, set srcdir=.
-if test "$ac_abs_confdir" = "$ac_pwd"; then
-  srcdir=.
-fi
-# Remove unnecessary trailing slashes from srcdir.
-# Double slashes in file names in object file debugging info
-# mess up M-x gdb in Emacs.
-case $srcdir in
-*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
-esac
-for ac_var in $ac_precious_vars; do
-  eval ac_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_env_${ac_var}_value=\$${ac_var}
-  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
-  eval ac_cv_env_${ac_var}_value=\$${ac_var}
-done
+srcdir=`echo "$srcdir" | sed 's%\([^\\/]\)[\\/]*$%\1%'`
+ac_env_build_alias_set=${build_alias+set}
+ac_env_build_alias_value=$build_alias
+ac_cv_env_build_alias_set=${build_alias+set}
+ac_cv_env_build_alias_value=$build_alias
+ac_env_host_alias_set=${host_alias+set}
+ac_env_host_alias_value=$host_alias
+ac_cv_env_host_alias_set=${host_alias+set}
+ac_cv_env_host_alias_value=$host_alias
+ac_env_target_alias_set=${target_alias+set}
+ac_env_target_alias_value=$target_alias
+ac_cv_env_target_alias_set=${target_alias+set}
+ac_cv_env_target_alias_value=$target_alias
+ac_env_CC_set=${CC+set}
+ac_env_CC_value=$CC
+ac_cv_env_CC_set=${CC+set}
+ac_cv_env_CC_value=$CC
+ac_env_CFLAGS_set=${CFLAGS+set}
+ac_env_CFLAGS_value=$CFLAGS
+ac_cv_env_CFLAGS_set=${CFLAGS+set}
+ac_cv_env_CFLAGS_value=$CFLAGS
+ac_env_LDFLAGS_set=${LDFLAGS+set}
+ac_env_LDFLAGS_value=$LDFLAGS
+ac_cv_env_LDFLAGS_set=${LDFLAGS+set}
+ac_cv_env_LDFLAGS_value=$LDFLAGS
+ac_env_CPPFLAGS_set=${CPPFLAGS+set}
+ac_env_CPPFLAGS_value=$CPPFLAGS
+ac_cv_env_CPPFLAGS_set=${CPPFLAGS+set}
+ac_cv_env_CPPFLAGS_value=$CPPFLAGS
+ac_env_CPP_set=${CPP+set}
+ac_env_CPP_value=$CPP
+ac_cv_env_CPP_set=${CPP+set}
+ac_cv_env_CPP_value=$CPP
+ac_env_CXX_set=${CXX+set}
+ac_env_CXX_value=$CXX
+ac_cv_env_CXX_set=${CXX+set}
+ac_cv_env_CXX_value=$CXX
+ac_env_CXXFLAGS_set=${CXXFLAGS+set}
+ac_env_CXXFLAGS_value=$CXXFLAGS
+ac_cv_env_CXXFLAGS_set=${CXXFLAGS+set}
+ac_cv_env_CXXFLAGS_value=$CXXFLAGS
+ac_env_CXXCPP_set=${CXXCPP+set}
+ac_env_CXXCPP_value=$CXXCPP
+ac_cv_env_CXXCPP_set=${CXXCPP+set}
+ac_cv_env_CXXCPP_value=$CXXCPP
+ac_env_F77_set=${F77+set}
+ac_env_F77_value=$F77
+ac_cv_env_F77_set=${F77+set}
+ac_cv_env_F77_value=$F77
+ac_env_FFLAGS_set=${FFLAGS+set}
+ac_env_FFLAGS_value=$FFLAGS
+ac_cv_env_FFLAGS_set=${FFLAGS+set}
+ac_cv_env_FFLAGS_value=$FFLAGS
 
 #
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
@@ -1416,12 +971,15 @@
   -q, --quiet, --silent   do not print \`checking...' messages
       --cache-file=FILE   cache test results in FILE [disabled]
   -C, --config-cache      alias for \`--cache-file=config.cache'
   -n, --no-create         do not create output files
       --srcdir=DIR        find the sources in DIR [configure dir or \`..']
 
+_ACEOF
+
+  cat <<_ACEOF
 Installation directories:
   --prefix=PREFIX         install architecture-independent files in PREFIX
 			  [$ac_default_prefix]
   --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
 			  [PREFIX]
 
@@ -1433,28 +991,21 @@
 For better control, use the options below.
 
 Fine tuning of the installation directories:
   --bindir=DIR           user executables [EPREFIX/bin]
   --sbindir=DIR          system admin executables [EPREFIX/sbin]
   --libexecdir=DIR       program executables [EPREFIX/libexec]
+  --datadir=DIR          read-only architecture-independent data [PREFIX/share]
   --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
   --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
   --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
   --libdir=DIR           object code libraries [EPREFIX/lib]
   --includedir=DIR       C header files [PREFIX/include]
   --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
-  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
-  --infodir=DIR          info documentation [DATAROOTDIR/info]
-  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
-  --mandir=DIR           man documentation [DATAROOTDIR/man]
-  --docdir=DIR           documentation root [DATAROOTDIR/doc/libltdl]
-  --htmldir=DIR          html documentation [DOCDIR]
-  --dvidir=DIR           dvi documentation [DOCDIR]
-  --pdfdir=DIR           pdf documentation [DOCDIR]
-  --psdir=DIR            ps documentation [DOCDIR]
+  --infodir=DIR          info documentation [PREFIX/info]
+  --mandir=DIR           man documentation [PREFIX/man]
 _ACEOF
 
   cat <<\_ACEOF
 
 Program names:
   --program-prefix=PREFIX            prepend PREFIX to installed program names
@@ -1475,127 +1026,163 @@
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
   --disable-dependency-tracking  speeds up one-time build
   --enable-dependency-tracking   do not reject slow dependency extractors
-  --enable-shared[=PKGS]  build shared libraries [default=yes]
-  --enable-static[=PKGS]  build static libraries [default=yes]
+  --enable-shared[=PKGS]
+                          build shared libraries [default=yes]
+  --enable-static[=PKGS]
+                          build static libraries [default=yes]
   --enable-fast-install[=PKGS]
                           optimize for fast installation [default=yes]
   --disable-libtool-lock  avoid locking (might break parallel builds)
   --enable-ltdl-install   install libltdl
 
 Optional Packages:
   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
   --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
   --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
   --with-pic              try to use only PIC/non-PIC objects [default=use
                           both]
-  --with-tags[=TAGS]      include additional configurations [automatic]
+  --with-tags[=TAGS]
+                          include additional configurations [automatic]
 
 Some influential environment variables:
   CC          C compiler command
   CFLAGS      C compiler flags
   LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
               nonstandard directory <lib dir>
-  LIBS        libraries to pass to the linker, e.g. -l<library>
-  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
-              you have headers in a nonstandard directory <include dir>
+  CPPFLAGS    C/C++ preprocessor flags, e.g. -I<include dir> if you have
+              headers in a nonstandard directory <include dir>
   CPP         C preprocessor
   CXX         C++ compiler command
   CXXFLAGS    C++ compiler flags
   CXXCPP      C++ preprocessor
   F77         Fortran 77 compiler command
   FFLAGS      Fortran 77 compiler flags
 
 Use these variables to override the choices made by `configure' or to help
 it to find libraries and programs with nonstandard names/locations.
 
 Report bugs to <bug-libtool@gnu.org>.
 _ACEOF
-ac_status=$?
 fi
 
 if test "$ac_init_help" = "recursive"; then
   # If there are subdirs, report their specific --help.
+  ac_popdir=`pwd`
   for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d "$ac_dir" || continue
+    test -d $ac_dir || continue
     ac_builddir=.
 
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
+if test "$ac_dir" != .; then
   ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
+  # A "../" for each directory in $ac_dir_suffix.
+  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
+else
+  ac_dir_suffix= ac_top_builddir=
+fi
 
 case $srcdir in
-  .)  # We are building in place.
+  .)  # No --srcdir option.  We are building in place.
     ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
+    if test -z "$ac_top_builddir"; then
+       ac_top_srcdir=.
+    else
+       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
+    fi ;;
+  [\\/]* | ?:[\\/]* )  # Absolute path.
     ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+    ac_top_srcdir=$srcdir ;;
+  *) # Relative path.
+    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_builddir$srcdir ;;
+esac
+
+# Do not use `cd foo && pwd` to compute absolute paths, because
+# the directories may not exist.
+case `pwd` in
+.) ac_abs_builddir="$ac_dir";;
+*)
+  case "$ac_dir" in
+  .) ac_abs_builddir=`pwd`;;
+  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
+  *) ac_abs_builddir=`pwd`/"$ac_dir";;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_builddir=${ac_top_builddir}.;;
+*)
+  case ${ac_top_builddir}. in
+  .) ac_abs_top_builddir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
+  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_srcdir=$ac_srcdir;;
+*)
+  case $ac_srcdir in
+  .) ac_abs_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
+  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_srcdir=$ac_top_srcdir;;
+*)
+  case $ac_top_srcdir in
+  .) ac_abs_top_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
+  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
+  esac;;
 esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
 
-    cd "$ac_dir" || { ac_status=$?; continue; }
-    # Check for guested configure.
-    if test -f "$ac_srcdir/configure.gnu"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
-    elif test -f "$ac_srcdir/configure"; then
-      echo &&
-      $SHELL "$ac_srcdir/configure" --help=recursive
+    cd $ac_dir
+    # Check for guested configure; otherwise get Cygnus style configure.
+    if test -f $ac_srcdir/configure.gnu; then
+      echo
+      $SHELL $ac_srcdir/configure.gnu  --help=recursive
+    elif test -f $ac_srcdir/configure; then
+      echo
+      $SHELL $ac_srcdir/configure  --help=recursive
+    elif test -f $ac_srcdir/configure.ac ||
+	   test -f $ac_srcdir/configure.in; then
+      echo
+      $ac_configure --help
     else
       echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi || ac_status=$?
-    cd "$ac_pwd" || { ac_status=$?; break; }
+    fi
+    cd "$ac_popdir"
   done
 fi
 
-test -n "$ac_init_help" && exit $ac_status
+test -n "$ac_init_help" && exit 0
 if $ac_init_version; then
   cat <<\_ACEOF
 libltdl configure 1.2
-generated by GNU Autoconf 2.61
+generated by GNU Autoconf 2.59
 
-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
+Copyright (C) 2003 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
-  exit
+  exit 0
 fi
-cat >config.log <<_ACEOF
+exec 5>config.log
+cat >&5 <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
 It was created by libltdl $as_me 1.2, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
+generated by GNU Autoconf 2.59.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
-exec 5>>config.log
 {
 cat <<_ASUNAME
 ## --------- ##
 ## Platform. ##
 ## --------- ##
 
@@ -1608,13 +1195,13 @@
 /usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
 /bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
 
 /bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
 /usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
 /usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
+hostinfo               = `(hostinfo) 2>/dev/null               || echo unknown`
 /bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
 /usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
 /bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
 
 _ASUNAME
 
@@ -1622,13 +1209,12 @@
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   echo "PATH: $as_dir"
 done
-IFS=$as_save_IFS
 
 } >&5
 
 cat >&5 <<_ACEOF
 
 
@@ -1644,23 +1230,24 @@
 # Strip out --silent because we don't want to record it for future runs.
 # Also quote any args containing shell meta-characters.
 # Make two passes to allow for proper duplicate-argument suppression.
 ac_configure_args=
 ac_configure_args0=
 ac_configure_args1=
+ac_sep=
 ac_must_keep_next=false
 for ac_pass in 1 2
 do
   for ac_arg
   do
     case $ac_arg in
     -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
     -q | -quiet | --quiet | --quie | --qui | --qu | --q \
     | -silent | --silent | --silen | --sile | --sil)
       continue ;;
-    *\'*)
+    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
       ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
     esac
     case $ac_pass in
     1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
     2)
       ac_configure_args1="$ac_configure_args1 '$ac_arg'"
@@ -1676,126 +1263,110 @@
 	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
 	    esac
 	    ;;
 	  -* ) ac_must_keep_next=true ;;
 	esac
       fi
-      ac_configure_args="$ac_configure_args '$ac_arg'"
+      ac_configure_args="$ac_configure_args$ac_sep'$ac_arg'"
+      # Get rid of the leading space.
+      ac_sep=" "
       ;;
     esac
   done
 done
 $as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
 $as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }
 
 # When interrupted or exit'd, cleanup temporary files, and complete
 # config.log.  We remove comments because anyway the quotes in there
 # would cause problems or look ugly.
-# WARNING: Use '\'' to represent an apostrophe within the trap.
-# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
+# WARNING: Be sure not to use single quotes in there, as some shells,
+# such as our DU 5.0 friend, will then `close' the trap.
 trap 'exit_status=$?
   # Save into config.log some information that might help in debugging.
   {
     echo
 
     cat <<\_ASBOX
 ## ---------------- ##
 ## Cache variables. ##
 ## ---------------- ##
 _ASBOX
     echo
     # The following way of writing the cache mishandles newlines in values,
-(
-  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
+{
   (set) 2>&1 |
-    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
+    case `(ac_space='"'"' '"'"'; set | grep ac_space) 2>&1` in
+    *ac_space=\ *)
       sed -n \
-	"s/'\''/'\''\\\\'\'''\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
-      ;; #(
+	"s/'"'"'/'"'"'\\\\'"'"''"'"'/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='"'"'\\2'"'"'/p"
+      ;;
     *)
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      sed -n \
+	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
       ;;
-    esac |
-    sort
-)
+    esac;
+}
     echo
 
     cat <<\_ASBOX
 ## ----------------- ##
 ## Output variables. ##
 ## ----------------- ##
 _ASBOX
     echo
     for ac_var in $ac_subst_vars
     do
-      eval ac_val=\$$ac_var
-      case $ac_val in
-      *\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-      esac
-      echo "$ac_var='\''$ac_val'\''"
+      eval ac_val=$`echo $ac_var`
+      echo "$ac_var='"'"'$ac_val'"'"'"
     done | sort
     echo
 
     if test -n "$ac_subst_files"; then
       cat <<\_ASBOX
-## ------------------- ##
-## File substitutions. ##
-## ------------------- ##
+## ------------- ##
+## Output files. ##
+## ------------- ##
 _ASBOX
       echo
       for ac_var in $ac_subst_files
       do
-	eval ac_val=\$$ac_var
-	case $ac_val in
-	*\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
-	esac
-	echo "$ac_var='\''$ac_val'\''"
+	eval ac_val=$`echo $ac_var`
+	echo "$ac_var='"'"'$ac_val'"'"'"
       done | sort
       echo
     fi
 
     if test -s confdefs.h; then
       cat <<\_ASBOX
 ## ----------- ##
 ## confdefs.h. ##
 ## ----------- ##
 _ASBOX
       echo
-      cat confdefs.h
+      sed "/^$/d" confdefs.h | sort
       echo
     fi
     test "$ac_signal" != 0 &&
       echo "$as_me: caught signal $ac_signal"
     echo "$as_me: exit $exit_status"
   } >&5
-  rm -f core *.core core.conftest.* &&
-    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
+  rm -f core *.core &&
+  rm -rf conftest* confdefs* conf$$* $ac_clean_files &&
     exit $exit_status
-' 0
+     ' 0
 for ac_signal in 1 2 13 15; do
   trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
 done
 ac_signal=0
 
 # confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -f -r conftest* confdefs.h
+rm -rf conftest* confdefs.h
+# AIX cpp loses on an empty file, so make sure it contains at least a newline.
+echo >confdefs.h
 
 # Predefined preprocessor variables.
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE_NAME "$PACKAGE_NAME"
 _ACEOF
@@ -1820,23 +1391,20 @@
 #define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
 _ACEOF
 
 
 # Let the site file select an alternate cache file if it wants to.
 # Prefer explicitly selected file to automatically selected ones.
-if test -n "$CONFIG_SITE"; then
-  set x "$CONFIG_SITE"
-elif test "x$prefix" != xNONE; then
-  set x "$prefix/share/config.site" "$prefix/etc/config.site"
-else
-  set x "$ac_default_prefix/share/config.site" \
-	"$ac_default_prefix/etc/config.site"
+if test -z "$CONFIG_SITE"; then
+  if test "x$prefix" != xNONE; then
+    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
+  else
+    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
+  fi
 fi
-shift
-for ac_site_file
-do
+for ac_site_file in $CONFIG_SITE; do
   if test -r "$ac_site_file"; then
     { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
 echo "$as_me: loading site script $ac_site_file" >&6;}
     sed 's/^/| /' "$ac_site_file" >&5
     . "$ac_site_file"
   fi
@@ -1846,30 +1414,31 @@
   # Some versions of bash will fail to source /dev/null (special
   # files actually), so we avoid doing that.
   if test -f "$cache_file"; then
     { echo "$as_me:$LINENO: loading cache $cache_file" >&5
 echo "$as_me: loading cache $cache_file" >&6;}
     case $cache_file in
-      [\\/]* | ?:[\\/]* ) . "$cache_file";;
-      *)                      . "./$cache_file";;
+      [\\/]* | ?:[\\/]* ) . $cache_file;;
+      *)                      . ./$cache_file;;
     esac
   fi
 else
   { echo "$as_me:$LINENO: creating cache $cache_file" >&5
 echo "$as_me: creating cache $cache_file" >&6;}
   >$cache_file
 fi
 
 # Check that the precious variables saved in the cache have kept the same
 # value.
 ac_cache_corrupted=false
-for ac_var in $ac_precious_vars; do
+for ac_var in `(set) 2>&1 |
+	       sed -n 's/^ac_env_\([a-zA-Z_0-9]*\)_set=.*/\1/p'`; do
   eval ac_old_set=\$ac_cv_env_${ac_var}_set
   eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val=\$ac_cv_env_${ac_var}_value
-  eval ac_new_val=\$ac_env_${ac_var}_value
+  eval ac_old_val="\$ac_cv_env_${ac_var}_value"
+  eval ac_new_val="\$ac_env_${ac_var}_value"
   case $ac_old_set,$ac_new_set in
     set,)
       { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
 echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
       ac_cache_corrupted=: ;;
     ,set)
@@ -1888,13 +1457,14 @@
 	ac_cache_corrupted=:
       fi;;
   esac
   # Pass precious variables to config.status.
   if test "$ac_new_set" = set; then
     case $ac_new_val in
-    *\'*) ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
+    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
+      ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
     *) ac_arg=$ac_var=$ac_new_val ;;
     esac
     case " $ac_configure_args " in
       *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
       *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
     esac
@@ -1905,12 +1475,18 @@
 echo "$as_me: error: changes in the environment can compromise the build" >&2;}
   { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
 echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
    { (exit 1); exit 1; }; }
 fi
 
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
 
 
 
 
 
 
@@ -1929,56 +1505,45 @@
 
 
 
 
 
 
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
 
 
 
 ## ------------------------------- ##
 ## Libltdl specific configuration. ##
 ## ------------------------------- ##
 
 ac_aux_dir=
-for ac_dir in . "$srcdir"/.; do
-  if test -f "$ac_dir/install-sh"; then
+for ac_dir in . $srcdir/.; do
+  if test -f $ac_dir/install-sh; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/install-sh -c"
     break
-  elif test -f "$ac_dir/install.sh"; then
+  elif test -f $ac_dir/install.sh; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/install.sh -c"
     break
-  elif test -f "$ac_dir/shtool"; then
+  elif test -f $ac_dir/shtool; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/shtool install -c"
     break
   fi
 done
 if test -z "$ac_aux_dir"; then
-  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in . \"$srcdir\"/." >&5
-echo "$as_me: error: cannot find install-sh or install.sh in . \"$srcdir\"/." >&2;}
+  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in . $srcdir/." >&5
+echo "$as_me: error: cannot find install-sh or install.sh in . $srcdir/." >&2;}
    { (exit 1); exit 1; }; }
 fi
-
-# These three variables are undocumented and unsupported,
-# and are intended to be withdrawn in a future Autoconf release.
-# They can cause serious problems if a builder's source tree is in a directory
-# whose full name contains unusual characters.
-ac_config_guess="$SHELL $ac_aux_dir/config.guess"  # Please don't use this var.
-ac_config_sub="$SHELL $ac_aux_dir/config.sub"  # Please don't use this var.
-ac_configure="$SHELL $ac_aux_dir/configure"  # Please don't use this var.
-
+ac_config_guess="$SHELL $ac_aux_dir/config.guess"
+ac_config_sub="$SHELL $ac_aux_dir/config.sub"
+ac_configure="$SHELL $ac_aux_dir/configure" # This should be Cygnus configure.
 
 
 if test -z "$enable_ltdl_install$enable_ltdl_convenience"; then
   if test -f ${srcdir}/ltmain.sh; then
     # if libltdl is libtoolized, it is assumed to be stand-alone and
     # installed unless the command line overrides it (tested above)
@@ -2009,14 +1574,14 @@
 # AmigaOS /C/install, which installs bootblocks on floppy discs
 # AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
 # AFS /usr/afsws/bin/install, which mishandles nonexistent args
 # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
 # OS/2's system install, which has a completely different semantic
 # ./install, which can be erroneously created by make from ./install.sh.
-{ echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
-echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
+echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6
 if test -z "$INSTALL"; then
 if test "${ac_cv_path_install+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
@@ -2032,13 +1597,13 @@
   *)
     # OSF1 and SCO ODT 3.0 have their own names for install.
     # Don't use installbsd from OSF since it installs stuff as root
     # by default.
     for ac_prog in ginstall scoinst install; do
       for ac_exec_ext in '' $ac_executable_extensions; do
-	if { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; }; then
+	if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
 	  if test $ac_prog = install &&
 	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
 	    # AIX install.  It has an incompatible calling convention.
 	    :
 	  elif test $ac_prog = install &&
 	    grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
@@ -2051,39 +1616,38 @@
 	fi
       done
     done
     ;;
 esac
 done
-IFS=$as_save_IFS
 
 
 fi
   if test "${ac_cv_path_install+set}" = set; then
     INSTALL=$ac_cv_path_install
   else
-    # As a last resort, use the slow shell script.  Don't cache a
-    # value for INSTALL within a source directory, because that will
+    # As a last resort, use the slow shell script.  We don't cache a
+    # path for INSTALL within a source directory, because that will
     # break other packages using the cache if that directory is
-    # removed, or if the value is a relative name.
+    # removed, or if the path is relative.
     INSTALL=$ac_install_sh
   fi
 fi
-{ echo "$as_me:$LINENO: result: $INSTALL" >&5
-echo "${ECHO_T}$INSTALL" >&6; }
+echo "$as_me:$LINENO: result: $INSTALL" >&5
+echo "${ECHO_T}$INSTALL" >&6
 
 # Use test -z because SunOS4 sh mishandles braces in ${var-val}.
 # It thinks the first close brace ends the variable substitution.
 test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
 
 test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'
 
 test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
 
-{ echo "$as_me:$LINENO: checking whether build environment is sane" >&5
-echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether build environment is sane" >&5
+echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6
 # Just in case
 sleep 1
 echo timestamp > conftest.file
 # Do `set' in a subshell so we don't clobber the current shell's
 # arguments.  Must try -L first in case configure is actually a
 # symlink; some systems play weird games with the mod time of symlinks
@@ -2119,26 +1683,26 @@
    { { echo "$as_me:$LINENO: error: newly created file is older than distributed files!
 Check your system clock" >&5
 echo "$as_me: error: newly created file is older than distributed files!
 Check your system clock" >&2;}
    { (exit 1); exit 1; }; }
 fi
-{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
 test "$program_prefix" != NONE &&
-  program_transform_name="s&^&$program_prefix&;$program_transform_name"
+  program_transform_name="s,^,$program_prefix,;$program_transform_name"
 # Use a double $ so make ignores it.
 test "$program_suffix" != NONE &&
-  program_transform_name="s&\$&$program_suffix&;$program_transform_name"
+  program_transform_name="s,\$,$program_suffix,;$program_transform_name"
 # Double any \ or $.  echo might interpret backslashes.
 # By default was `s,x,x', remove it if useless.
 cat <<\_ACEOF >conftest.sed
 s/[\\$]/&&/g;s/;s,x,x,$//
 _ACEOF
 program_transform_name=`echo $program_transform_name | sed -f conftest.sed`
-rm -f conftest.sed
+rm conftest.sed
 
 # expand $ac_aux_dir to an absolute path
 am_aux_dir=`cd $ac_aux_dir && pwd`
 
 test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
 # Use eval to expand $SHELL
@@ -2184,77 +1748,74 @@
 fi
 
 for ac_prog in gawk mawk nawk awk
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_AWK+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$AWK"; then
   ac_cv_prog_AWK="$AWK" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_AWK="$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 AWK=$ac_cv_prog_AWK
 if test -n "$AWK"; then
-  { echo "$as_me:$LINENO: result: $AWK" >&5
-echo "${ECHO_T}$AWK" >&6; }
+  echo "$as_me:$LINENO: result: $AWK" >&5
+echo "${ECHO_T}$AWK" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
   test -n "$AWK" && break
 done
 
-{ echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
-set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
-if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
+echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6
+set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,:./+-,___p_,'`
+if eval "test \"\${ac_cv_prog_make_${ac_make}_set+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.make <<\_ACEOF
-SHELL = /bin/sh
 all:
-	@echo '@@@%%%=$(MAKE)=@@@%%%'
+	@echo 'ac_maketemp="$(MAKE)"'
 _ACEOF
 # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-case `${MAKE-make} -f conftest.make 2>/dev/null` in
-  *@@@%%%=?*=@@@%%%*)
-    eval ac_cv_prog_make_${ac_make}_set=yes;;
-  *)
-    eval ac_cv_prog_make_${ac_make}_set=no;;
-esac
+eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
+if test -n "$ac_maketemp"; then
+  eval ac_cv_prog_make_${ac_make}_set=yes
+else
+  eval ac_cv_prog_make_${ac_make}_set=no
+fi
 rm -f conftest.make
 fi
-if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
-  { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
+  echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
   SET_MAKE=
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
   SET_MAKE="MAKE=${MAKE-make}"
 fi
 
 rm -rf .tst 2>/dev/null
 mkdir .tst 2>/dev/null
 if test -d .tst; then
@@ -2310,101 +1871,85 @@
 # tool to use in cross-compilation environments, therefore Automake
 # will honor the `STRIP' environment variable to overrule this program.
 if test "$cross_compiling" != no; then
   if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
 set dummy ${ac_tool_prefix}strip; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$STRIP"; then
   ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_STRIP="${ac_tool_prefix}strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 STRIP=$ac_cv_prog_STRIP
 if test -n "$STRIP"; then
-  { echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6; }
+  echo "$as_me:$LINENO: result: $STRIP" >&5
+echo "${ECHO_T}$STRIP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_STRIP"; then
   ac_ct_STRIP=$STRIP
   # Extract the first word of "strip", so it can be a program name with args.
 set dummy strip; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_STRIP"; then
   ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_STRIP="strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_STRIP" && ac_cv_prog_ac_ct_STRIP=":"
 fi
 fi
 ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
 if test -n "$ac_ct_STRIP"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
-echo "${ECHO_T}$ac_ct_STRIP" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
+echo "${ECHO_T}$ac_ct_STRIP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_STRIP" = x; then
-    STRIP=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    STRIP=$ac_ct_STRIP
-  fi
+  STRIP=$ac_ct_STRIP
 else
   STRIP="$ac_cv_prog_STRIP"
 fi
 
 fi
 INSTALL_STRIP_PROGRAM="\${SHELL} \$(install_sh) -c -s"
@@ -2418,13 +1963,13 @@
 am__tar='${AMTAR} chof - "$$tardir"'; am__untar='${AMTAR} xf -'
 
 
 
 
 
-ac_config_headers="$ac_config_headers config.h:config-h.in"
+          ac_config_headers="$ac_config_headers config.h:config-h.in"
 
 
 
 ## ------------------ ##
 ## C compiler checks. ##
 ## ------------------ ##
@@ -2433,151 +1978,174 @@
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
 set dummy ${ac_tool_prefix}gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_CC="${ac_tool_prefix}gcc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
+  echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_CC"; then
   ac_ct_CC=$CC
   # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_CC"; then
   ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_CC="gcc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
+echo "${ECHO_T}$ac_ct_CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
+  CC=$ac_ct_CC
 else
   CC="$ac_cv_prog_CC"
 fi
 
 if test -z "$CC"; then
-          if test -n "$ac_tool_prefix"; then
-    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
+  if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
 set dummy ${ac_tool_prefix}cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_CC="${ac_tool_prefix}cc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
+  echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
+fi
+if test -z "$ac_cv_prog_CC"; then
+  ac_ct_CC=$CC
+  # Extract the first word of "cc", so it can be a program name with args.
+set dummy cc; ac_word=$2
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
+if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
+    ac_cv_prog_ac_ct_CC="cc"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
   fi
+done
+done
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
+echo "${ECHO_T}$ac_ct_CC" >&6
+else
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+fi
+
+  CC=$ac_ct_CC
+else
+  CC="$ac_cv_prog_CC"
+fi
+
 fi
 if test -z "$CC"; then
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
@@ -2585,24 +2153,23 @@
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
        ac_prog_rejected=yes
        continue
      fi
     ac_cv_prog_CC="cc"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 if test $ac_prog_rejected = yes; then
   # We found a bogon in the path, so make sure we never use it.
   set dummy $ac_cv_prog_CC
   shift
   if test $# != 0; then
@@ -2614,165 +2181,132 @@
   fi
 fi
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
+  echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$CC"; then
   if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl.exe
+  for ac_prog in cl
   do
     # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
 set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$CC"; then
   ac_cv_prog_CC="$CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 CC=$ac_cv_prog_CC
 if test -n "$CC"; then
-  { echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6; }
+  echo "$as_me:$LINENO: result: $CC" >&5
+echo "${ECHO_T}$CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
     test -n "$CC" && break
   done
 fi
 if test -z "$CC"; then
   ac_ct_CC=$CC
-  for ac_prog in cl.exe
+  for ac_prog in cl
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_CC"; then
   ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_CC="$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_CC=$ac_cv_prog_ac_ct_CC
 if test -n "$ac_ct_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
+echo "${ECHO_T}$ac_ct_CC" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
   test -n "$ac_ct_CC" && break
 done
 
-  if test "x$ac_ct_CC" = x; then
-    CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CC=$ac_ct_CC
-  fi
+  CC=$ac_ct_CC
 fi
 
 fi
 
 
 test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
 See \`config.log' for more details." >&5
 echo "$as_me: error: no acceptable C compiler found in \$PATH
 See \`config.log' for more details." >&2;}
    { (exit 1); exit 1; }; }
 
 # Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C compiler version" >&5
+echo "$as_me:$LINENO:" \
+     "checking for C compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
+  (eval $ac_compiler --version </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
+  (eval $ac_compiler -v </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
+  (eval $ac_compiler -V </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
 
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -2791,109 +2325,77 @@
 _ACEOF
 ac_clean_files_save=$ac_clean_files
 ac_clean_files="$ac_clean_files a.out a.exe b.out"
 # Try to create an executable without -o first, disregard a.out.
 # It will help us diagnose broken compilers, and finding out an intuition
 # of exeext.
-{ echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
+echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6
 ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-#
-# List of possible output files, starting from the most likely.
-# The algorithm is not robust to junk in `.', hence go to wildcards (a.*)
-# only as a last resort.  b.out is created by i960 compilers.
-ac_files='a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out'
-#
-# The IRIX 6 linker writes into existing files which may not be
-# executable, retaining their permissions.  Remove them first so a
-# subsequent execution test works.
-ac_rmfiles=
-for ac_file in $ac_files
-do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
-    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
-  esac
-done
-rm -f $ac_rmfiles
-
-if { (ac_try="$ac_link_default"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link_default") 2>&5
+if { (eval echo "$as_me:$LINENO: \"$ac_link_default\"") >&5
+  (eval $ac_link_default) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
-# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
-# in a Makefile.  We should not override ac_cv_exeext if it was cached,
-# so that the user can short-circuit this test for compilers unknown to
-# Autoconf.
-for ac_file in $ac_files ''
+  # Find the output, starting from the most likely.  This scheme is
+# not robust to junk in `.', hence go to wildcards (a.*) only as a last
+# resort.
+
+# Be careful to initialize this variable, since it used to be cached.
+# Otherwise an old cache value of `no' led to `EXEEXT = no' in a Makefile.
+ac_cv_exeext=
+# b.out is created by i960 compilers.
+for ac_file in a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out
 do
   test -f "$ac_file" || continue
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj )
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj )
+	;;
+    conftest.$ac_ext )
+	# This is the source file.
 	;;
     [ab].out )
 	# We found the default executable, but exeext='' is most
 	# certainly right.
 	break;;
     *.* )
-        if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
-	then :; else
-	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	fi
-	# We set ac_cv_exeext here because the later test for it is not
-	# safe: cross compilers may not add the suffix if given an `-o'
-	# argument, so we may need to know it at that point already.
-	# Even if this section looks crufty: it has the advantage of
-	# actually working.
+	ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	# FIXME: I believe we export ac_cv_exeext for Libtool,
+	# but it would be cool to find out if it's true.  Does anybody
+	# maintain Libtool? --akim.
+	export ac_cv_exeext
 	break;;
     * )
 	break;;
   esac
 done
-test "$ac_cv_exeext" = no && ac_cv_exeext=
-
 else
-  ac_file=''
-fi
-
-{ echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6; }
-if test -z "$ac_file"; then
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 { { echo "$as_me:$LINENO: error: C compiler cannot create executables
 See \`config.log' for more details." >&5
 echo "$as_me: error: C compiler cannot create executables
 See \`config.log' for more details." >&2;}
    { (exit 77); exit 77; }; }
 fi
 
 ac_exeext=$ac_cv_exeext
+echo "$as_me:$LINENO: result: $ac_file" >&5
+echo "${ECHO_T}$ac_file" >&6
 
-# Check that the compiler produces executables we can run.  If not, either
+# Check the compiler produces executables we can run.  If not, either
 # the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the C compiler works" >&5
+echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6
 # FIXME: These cross compiler hacks should be removed for Autoconf 3.0
 # If not cross compiling, check that we can run a simple program.
 if test "$cross_compiling" != yes; then
   if { ac_try='./$ac_file'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
     cross_compiling=no
   else
     if test "$cross_compiling" = maybe; then
@@ -2906,45 +2408,41 @@
 If you meant to cross compile, use \`--host'.
 See \`config.log' for more details." >&2;}
    { (exit 1); exit 1; }; }
     fi
   fi
 fi
-{ echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
 
 rm -f a.out a.exe conftest$ac_cv_exeext b.out
 ac_clean_files=$ac_clean_files_save
-# Check that the compiler produces executables we can run.  If not, either
+# Check the compiler produces executables we can run.  If not, either
 # the compiler is broken, or we cross compile.
-{ echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6; }
-{ echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6; }
-
-{ echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6; }
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>&5
+echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
+echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6
+echo "$as_me:$LINENO: result: $cross_compiling" >&5
+echo "${ECHO_T}$cross_compiling" >&6
+
+echo "$as_me:$LINENO: checking for suffix of executables" >&5
+echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
   # If both `conftest.exe' and `conftest' are `present' (well, observable)
 # catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
 # work properly (i.e., refer to `conftest.exe'), while it won't with
 # `rm'.
 for ac_file in conftest.exe conftest conftest.*; do
   test -f "$ac_file" || continue
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj ) ;;
     *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	  export ac_cv_exeext
 	  break;;
     * ) break;;
   esac
 done
 else
   { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
@@ -2952,20 +2450,20 @@
 echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
 See \`config.log' for more details." >&2;}
    { (exit 1); exit 1; }; }
 fi
 
 rm -f conftest$ac_cv_exeext
-{ echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
+echo "${ECHO_T}$ac_cv_exeext" >&6
 
 rm -f conftest.$ac_ext
 EXEEXT=$ac_cv_exeext
 ac_exeext=$EXEEXT
-{ echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for suffix of object files" >&5
+echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6
 if test "${ac_cv_objext+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -2979,26 +2477,20 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.o conftest.obj
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>&5
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  for ac_file in conftest.o conftest.obj conftest.*; do
-  test -f "$ac_file" || continue;
+  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/dev/null`; do
   case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf ) ;;
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg ) ;;
     *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
        break;;
   esac
 done
 else
   echo "$as_me: failed program was:" >&5
@@ -3010,18 +2502,18 @@
 See \`config.log' for more details." >&2;}
    { (exit 1); exit 1; }; }
 fi
 
 rm -f conftest.$ac_cv_objext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
+echo "${ECHO_T}$ac_cv_objext" >&6
 OBJEXT=$ac_cv_objext
 ac_objext=$OBJEXT
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
+echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6
 if test "${ac_cv_c_compiler_gnu+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -3038,55 +2530,55 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_compiler_gnu=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_compiler_gnu=no
+ac_compiler_gnu=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 ac_cv_c_compiler_gnu=$ac_compiler_gnu
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
+echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6
 GCC=`test $ac_compiler_gnu = yes && echo yes`
 ac_test_CFLAGS=${CFLAGS+set}
 ac_save_CFLAGS=$CFLAGS
-{ echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6; }
+CFLAGS="-g"
+echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
+echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6
 if test "${ac_cv_prog_cc_g+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_save_c_werror_flag=$ac_c_werror_flag
-   ac_c_werror_flag=yes
-   ac_cv_prog_cc_g=no
-   CFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
+  cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
@@ -3096,124 +2588,43 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	CFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
   ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_c_werror_flag=$ac_save_c_werror_flag
-	 CFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
   ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); }; }; then
   ac_cv_prog_cc_g=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_cv_prog_cc_g=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_c_werror_flag=$ac_save_c_werror_flag
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
+echo "${ECHO_T}$ac_cv_prog_cc_g" >&6
 if test "$ac_test_CFLAGS" = set; then
   CFLAGS=$ac_save_CFLAGS
 elif test $ac_cv_prog_cc_g = yes; then
   if test "$GCC" = yes; then
     CFLAGS="-g -O2"
   else
@@ -3223,18 +2634,18 @@
   if test "$GCC" = yes; then
     CFLAGS="-O2"
   else
     CFLAGS=
   fi
 fi
-{ echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
-echo $ECHO_N "checking for $CC option to accept ISO C89... $ECHO_C" >&6; }
-if test "${ac_cv_prog_cc_c89+set}" = set; then
+echo "$as_me:$LINENO: checking for $CC option to accept ANSI C" >&5
+echo $ECHO_N "checking for $CC option to accept ANSI C... $ECHO_C" >&6
+if test "${ac_cv_prog_cc_stdc+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_cv_prog_cc_c89=no
+  ac_cv_prog_cc_stdc=no
 ac_save_CC=$CC
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
@@ -3262,23 +2673,18 @@
   return s;
 }
 
 /* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
    function prototypes and stuff, but not '\xHH' hex character constants.
    These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std is added to get
+   as 'x'.  The following induces an error, until -std1 is added to get
    proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
    array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std.  */
+   that's true only with -std1.  */
 int osf4_cc_array ['\x00' == 0 ? 1 : -1];
 
-/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
-   inside strings and character constants.  */
-#define FOO(x) 'x'
-int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
-
 int test (int i, double x);
 struct s1 {int (*f) (int a);};
 struct s2 {int (*f) (double a);};
 int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
 int argc;
 char **argv;
@@ -3287,117 +2693,261 @@
 {
 return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
   ;
   return 0;
 }
 _ACEOF
-for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
-	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
+# Don't try gcc -ansi; that turns off useful extensions and
+# breaks some systems' header files.
+# AIX			-qlanglvl=ansi
+# Ultrix and OSF/1	-std1
+# HP-UX 10.20 and later	-Ae
+# HP-UX older versions	-Aa -D_HPUX_SOURCE
+# SVR4			-Xc -D__EXTENSIONS__
+for ac_arg in "" -qlanglvl=ansi -std1 -Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
 do
   CC="$ac_save_CC $ac_arg"
   rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cc_c89=$ac_arg
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_prog_cc_stdc=$ac_arg
+break
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext
-  test "x$ac_cv_prog_cc_c89" != "xno" && break
+rm -f conftest.err conftest.$ac_objext
 done
-rm -f conftest.$ac_ext
+rm -f conftest.$ac_ext conftest.$ac_objext
 CC=$ac_save_CC
 
 fi
-# AC_CACHE_VAL
-case "x$ac_cv_prog_cc_c89" in
-  x)
-    { echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6; } ;;
-  xno)
-    { echo "$as_me:$LINENO: result: unsupported" >&5
-echo "${ECHO_T}unsupported" >&6; } ;;
+
+case "x$ac_cv_prog_cc_stdc" in
+  x|xno)
+    echo "$as_me:$LINENO: result: none needed" >&5
+echo "${ECHO_T}none needed" >&6 ;;
   *)
-    CC="$CC $ac_cv_prog_cc_c89"
-    { echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_c89" >&6; } ;;
+    echo "$as_me:$LINENO: result: $ac_cv_prog_cc_stdc" >&5
+echo "${ECHO_T}$ac_cv_prog_cc_stdc" >&6
+    CC="$CC $ac_cv_prog_cc_stdc" ;;
 esac
 
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-DEPDIR="${am__leading_dot}deps"
-
-ac_config_commands="$ac_config_commands depfiles"
-
-
-am_make=${MAKE-make}
-cat > confinc << 'END'
-am__doit:
-	@echo done
-.PHONY: am__doit
-END
-# If we don't find an include directive, just comment out the code.
-{ echo "$as_me:$LINENO: checking for style of include used by $am_make" >&5
-echo $ECHO_N "checking for style of include used by $am_make... $ECHO_C" >&6; }
-am__include="#"
-am__quote=
-_am_result=none
-# First try GNU make style include.
-echo "include confinc" > confmf
-# We grep out `Entering directory' and `Leaving directory'
-# messages which can occur if `w' ends up in MAKEFLAGS.
-# In particular we don't look at `^make:' because GNU make might
-# be invoked under some other name (usually "gmake"), in which
-# case it prints its new name instead of `make'.
-if test "`$am_make -s -f confmf 2> /dev/null | grep -v 'ing directory'`" = "done"; then
-   am__include=include
-   am__quote=
-   _am_result=GNU
-fi
-# Now try BSD make style include.
-if test "$am__include" = "#"; then
-   echo '.include "confinc"' > confmf
-   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
-      am__include=.include
+# Some people use a C++ compiler to compile C.  Since we use `exit',
+# in C++ we need to declare it.  In case someone uses the same compiler
+# for both compiling C and C++ we need to have the C++ compiler decide
+# the declaration of exit, since it's the most demanding environment.
+cat >conftest.$ac_ext <<_ACEOF
+#ifndef __cplusplus
+  choke me
+#endif
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  for ac_declaration in \
+   '' \
+   'extern "C" void std::exit (int) throw (); using std::exit;' \
+   'extern "C" void std::exit (int); using std::exit;' \
+   'extern "C" void exit (int) throw ();' \
+   'extern "C" void exit (int);' \
+   'void exit (int);'
+do
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_declaration
+#include <stdlib.h>
+int
+main ()
+{
+exit (42);
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  :
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+continue
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_declaration
+int
+main ()
+{
+exit (42);
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  break
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+done
+rm -f conftest*
+if test -n "$ac_declaration"; then
+  echo '#ifdef __cplusplus' >>confdefs.h
+  echo $ac_declaration      >>confdefs.h
+  echo '#endif'             >>confdefs.h
+fi
+
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+DEPDIR="${am__leading_dot}deps"
+
+          ac_config_commands="$ac_config_commands depfiles"
+
+
+am_make=${MAKE-make}
+cat > confinc << 'END'
+am__doit:
+	@echo done
+.PHONY: am__doit
+END
+# If we don't find an include directive, just comment out the code.
+echo "$as_me:$LINENO: checking for style of include used by $am_make" >&5
+echo $ECHO_N "checking for style of include used by $am_make... $ECHO_C" >&6
+am__include="#"
+am__quote=
+_am_result=none
+# First try GNU make style include.
+echo "include confinc" > confmf
+# We grep out `Entering directory' and `Leaving directory'
+# messages which can occur if `w' ends up in MAKEFLAGS.
+# In particular we don't look at `^make:' because GNU make might
+# be invoked under some other name (usually "gmake"), in which
+# case it prints its new name instead of `make'.
+if test "`$am_make -s -f confmf 2> /dev/null | grep -v 'ing directory'`" = "done"; then
+   am__include=include
+   am__quote=
+   _am_result=GNU
+fi
+# Now try BSD make style include.
+if test "$am__include" = "#"; then
+   echo '.include "confinc"' > confmf
+   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
+      am__include=.include
       am__quote="\""
       _am_result=BSD
    fi
 fi
 
 
-{ echo "$as_me:$LINENO: result: $_am_result" >&5
-echo "${ECHO_T}$_am_result" >&6; }
+echo "$as_me:$LINENO: result: $_am_result" >&5
+echo "${ECHO_T}$_am_result" >&6
 rm -f confinc confmf
 
-# Check whether --enable-dependency-tracking was given.
+# Check whether --enable-dependency-tracking or --disable-dependency-tracking was given.
 if test "${enable_dependency_tracking+set}" = set; then
-  enableval=$enable_dependency_tracking;
-fi
+  enableval="$enable_dependency_tracking"
 
+fi;
 if test "x$enable_dependency_tracking" != xno; then
   am_depcomp="$ac_aux_dir/depcomp"
   AMDEPBACKSLASH='\'
 fi
 
 
@@ -3411,14 +2961,14 @@
 
 
 
 
 depcc="$CC"   am_compiler_list=
 
-{ echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
-echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
+echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6
 if test "${am_cv_CC_dependencies_compiler_type+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
   # We make a subdir and do the tests there.  Otherwise we can end up
   # making bogus files that we don't know about and never remove.  For
@@ -3501,14 +3051,14 @@
   rm -rf conftest.dir
 else
   am_cv_CC_dependencies_compiler_type=none
 fi
 
 fi
-{ echo "$as_me:$LINENO: result: $am_cv_CC_dependencies_compiler_type" >&5
-echo "${ECHO_T}$am_cv_CC_dependencies_compiler_type" >&6; }
+echo "$as_me:$LINENO: result: $am_cv_CC_dependencies_compiler_type" >&5
+echo "${ECHO_T}$am_cv_CC_dependencies_compiler_type" >&6
 CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type
 
 
 
 if
   test "x$enable_dependency_tracking" != xno \
@@ -3519,14 +3069,14 @@
   am__fastdepCC_TRUE='#'
   am__fastdepCC_FALSE=
 fi
 
 
 
-{ echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
-echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for an ANSI C-conforming const" >&5
+echo $ECHO_N "checking for an ANSI C-conforming const... $ECHO_C" >&6
 if test "${ac_cv_c_const+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -3538,35 +3088,34 @@
 main ()
 {
 /* FIXME: Include the comments suggested by Paul. */
 #ifndef __cplusplus
   /* Ultrix mips cc rejects this.  */
   typedef int charset[2];
-  const charset cs;
+  const charset x;
   /* SunOS 4.1.1 cc rejects this.  */
-  char const *const *pcpcc;
-  char **ppc;
+  char const *const *ccp;
+  char **p;
   /* NEC SVR4.0.2 mips cc rejects this.  */
   struct point {int x, y;};
   static struct point const zero = {0,0};
   /* AIX XL C 1.02.0.0 rejects this.
      It does not let you subtract one const X* pointer from another in
      an arm of an if-expression whose if-part is not a constant
      expression */
   const char *g = "string";
-  pcpcc = &g + (g ? g-g : 0);
+  ccp = &g + (g ? g-g : 0);
   /* HPUX 7.0 cc rejects these. */
-  ++pcpcc;
-  ppc = (char**) pcpcc;
-  pcpcc = (char const *const *) ppc;
+  ++ccp;
+  p = (char**) ccp;
+  ccp = (char const *const *) p;
   { /* SCO 3.2v4 cc rejects this.  */
     char *t;
     char const *s = 0 ? (char *) 0 : (char const *) 0;
 
     *t++ = 0;
-    if (s) return 0;
   }
   { /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
     int x[] = {25, 17};
     const int *foo = &x[0];
     ++foo;
   }
@@ -3579,60 +3128,61 @@
        "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
     struct s { int j; const int *ap[3]; };
     struct s *b; b->j = 5;
   }
   { /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
     const int foo = 10;
-    if (!foo) return 0;
   }
-  return !cs[0] && !zero.x;
 #endif
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_c_const=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_c_const=no
+ac_cv_c_const=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
-echo "${ECHO_T}$ac_cv_c_const" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_c_const" >&5
+echo "${ECHO_T}$ac_cv_c_const" >&6
 if test $ac_cv_c_const = no; then
 
 cat >>confdefs.h <<\_ACEOF
 #define const
 _ACEOF
 
 fi
 
-{ echo "$as_me:$LINENO: checking for inline" >&5
-echo $ECHO_N "checking for inline... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for inline" >&5
+echo $ECHO_N "checking for inline... $ECHO_C" >&6
 if test "${ac_cv_c_inline+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_cv_c_inline=no
 for ac_kw in inline __inline__ __inline; do
   cat >conftest.$ac_ext <<_ACEOF
@@ -3646,43 +3196,44 @@
 static $ac_kw foo_t static_foo () {return 0; }
 $ac_kw foo_t foo () {return 0; }
 #endif
 
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_c_inline=$ac_kw
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_c_inline=$ac_kw; break
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-  test "$ac_cv_c_inline" != no && break
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 done
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_c_inline" >&5
-echo "${ECHO_T}$ac_cv_c_inline" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_c_inline" >&5
+echo "${ECHO_T}$ac_cv_c_inline" >&6
 
 
 case $ac_cv_c_inline in
   inline | yes) ;;
   *)
     case $ac_cv_c_inline in
@@ -3701,15 +3252,16 @@
 
 ## ----------------------- ##
 ## Libtool initialisation. ##
 ## ----------------------- ##
 
 
-# Check whether --enable-shared was given.
+# Check whether --enable-shared or --disable-shared was given.
 if test "${enable_shared+set}" = set; then
-  enableval=$enable_shared; p=${PACKAGE-default}
+  enableval="$enable_shared"
+  p=${PACKAGE-default}
     case $enableval in
     yes) enable_shared=yes ;;
     no) enable_shared=no ;;
     *)
       enable_shared=no
       # Look at the argument we got.  We use all the common list separators.
@@ -3722,18 +3274,18 @@
       done
       IFS="$lt_save_ifs"
       ;;
     esac
 else
   enable_shared=yes
-fi
-
+fi;
 
-# Check whether --enable-static was given.
+# Check whether --enable-static or --disable-static was given.
 if test "${enable_static+set}" = set; then
-  enableval=$enable_static; p=${PACKAGE-default}
+  enableval="$enable_static"
+  p=${PACKAGE-default}
     case $enableval in
     yes) enable_static=yes ;;
     no) enable_static=no ;;
     *)
      enable_static=no
       # Look at the argument we got.  We use all the common list separators.
@@ -3746,18 +3298,18 @@
       done
       IFS="$lt_save_ifs"
       ;;
     esac
 else
   enable_static=yes
-fi
-
+fi;
 
-# Check whether --enable-fast-install was given.
+# Check whether --enable-fast-install or --disable-fast-install was given.
 if test "${enable_fast_install+set}" = set; then
-  enableval=$enable_fast_install; p=${PACKAGE-default}
+  enableval="$enable_fast_install"
+  p=${PACKAGE-default}
     case $enableval in
     yes) enable_fast_install=yes ;;
     no) enable_fast_install=no ;;
     *)
       enable_fast_install=no
       # Look at the argument we got.  We use all the common list separators.
@@ -3770,119 +3322,88 @@
       done
       IFS="$lt_save_ifs"
       ;;
     esac
 else
   enable_fast_install=yes
-fi
-
+fi;
 
 # Make sure we can run config.sub.
-$SHELL "$ac_aux_dir/config.sub" sun4 >/dev/null 2>&1 ||
-  { { echo "$as_me:$LINENO: error: cannot run $SHELL $ac_aux_dir/config.sub" >&5
-echo "$as_me: error: cannot run $SHELL $ac_aux_dir/config.sub" >&2;}
+$ac_config_sub sun4 >/dev/null 2>&1 ||
+  { { echo "$as_me:$LINENO: error: cannot run $ac_config_sub" >&5
+echo "$as_me: error: cannot run $ac_config_sub" >&2;}
    { (exit 1); exit 1; }; }
 
-{ echo "$as_me:$LINENO: checking build system type" >&5
-echo $ECHO_N "checking build system type... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking build system type" >&5
+echo $ECHO_N "checking build system type... $ECHO_C" >&6
 if test "${ac_cv_build+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_build_alias=$build_alias
-test "x$ac_build_alias" = x &&
-  ac_build_alias=`$SHELL "$ac_aux_dir/config.guess"`
-test "x$ac_build_alias" = x &&
+  ac_cv_build_alias=$build_alias
+test -z "$ac_cv_build_alias" &&
+  ac_cv_build_alias=`$ac_config_guess`
+test -z "$ac_cv_build_alias" &&
   { { echo "$as_me:$LINENO: error: cannot guess build type; you must specify one" >&5
 echo "$as_me: error: cannot guess build type; you must specify one" >&2;}
    { (exit 1); exit 1; }; }
-ac_cv_build=`$SHELL "$ac_aux_dir/config.sub" $ac_build_alias` ||
-  { { echo "$as_me:$LINENO: error: $SHELL $ac_aux_dir/config.sub $ac_build_alias failed" >&5
-echo "$as_me: error: $SHELL $ac_aux_dir/config.sub $ac_build_alias failed" >&2;}
+ac_cv_build=`$ac_config_sub $ac_cv_build_alias` ||
+  { { echo "$as_me:$LINENO: error: $ac_config_sub $ac_cv_build_alias failed" >&5
+echo "$as_me: error: $ac_config_sub $ac_cv_build_alias failed" >&2;}
    { (exit 1); exit 1; }; }
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_build" >&5
-echo "${ECHO_T}$ac_cv_build" >&6; }
-case $ac_cv_build in
-*-*-*) ;;
-*) { { echo "$as_me:$LINENO: error: invalid value of canonical build" >&5
-echo "$as_me: error: invalid value of canonical build" >&2;}
-   { (exit 1); exit 1; }; };;
-esac
+echo "$as_me:$LINENO: result: $ac_cv_build" >&5
+echo "${ECHO_T}$ac_cv_build" >&6
 build=$ac_cv_build
-ac_save_IFS=$IFS; IFS='-'
-set x $ac_cv_build
-shift
-build_cpu=$1
-build_vendor=$2
-shift; shift
-# Remember, the first character of IFS is used to create $*,
-# except with old shells:
-build_os=$*
-IFS=$ac_save_IFS
-case $build_os in *\ *) build_os=`echo "$build_os" | sed 's/ /-/g'`;; esac
+build_cpu=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+build_vendor=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+build_os=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
 
 
-{ echo "$as_me:$LINENO: checking host system type" >&5
-echo $ECHO_N "checking host system type... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking host system type" >&5
+echo $ECHO_N "checking host system type... $ECHO_C" >&6
 if test "${ac_cv_host+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  if test "x$host_alias" = x; then
-  ac_cv_host=$ac_cv_build
-else
-  ac_cv_host=`$SHELL "$ac_aux_dir/config.sub" $host_alias` ||
-    { { echo "$as_me:$LINENO: error: $SHELL $ac_aux_dir/config.sub $host_alias failed" >&5
-echo "$as_me: error: $SHELL $ac_aux_dir/config.sub $host_alias failed" >&2;}
+  ac_cv_host_alias=$host_alias
+test -z "$ac_cv_host_alias" &&
+  ac_cv_host_alias=$ac_cv_build_alias
+ac_cv_host=`$ac_config_sub $ac_cv_host_alias` ||
+  { { echo "$as_me:$LINENO: error: $ac_config_sub $ac_cv_host_alias failed" >&5
+echo "$as_me: error: $ac_config_sub $ac_cv_host_alias failed" >&2;}
    { (exit 1); exit 1; }; }
-fi
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_host" >&5
-echo "${ECHO_T}$ac_cv_host" >&6; }
-case $ac_cv_host in
-*-*-*) ;;
-*) { { echo "$as_me:$LINENO: error: invalid value of canonical host" >&5
-echo "$as_me: error: invalid value of canonical host" >&2;}
-   { (exit 1); exit 1; }; };;
-esac
+echo "$as_me:$LINENO: result: $ac_cv_host" >&5
+echo "${ECHO_T}$ac_cv_host" >&6
 host=$ac_cv_host
-ac_save_IFS=$IFS; IFS='-'
-set x $ac_cv_host
-shift
-host_cpu=$1
-host_vendor=$2
-shift; shift
-# Remember, the first character of IFS is used to create $*,
-# except with old shells:
-host_os=$*
-IFS=$ac_save_IFS
-case $host_os in *\ *) host_os=`echo "$host_os" | sed 's/ /-/g'`;; esac
+host_cpu=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+host_vendor=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+host_os=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
 
 
-{ echo "$as_me:$LINENO: checking for a sed that does not truncate output" >&5
-echo $ECHO_N "checking for a sed that does not truncate output... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for a sed that does not truncate output" >&5
+echo $ECHO_N "checking for a sed that does not truncate output... $ECHO_C" >&6
 if test "${lt_cv_path_SED+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # Loop through the user's path and test for sed and gsed.
 # Then use that list of sed's as ones to test for truncation.
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for lt_ac_prog in sed gsed; do
     for ac_exec_ext in '' $ac_executable_extensions; do
-      if { test -f "$as_dir/$lt_ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$lt_ac_prog$ac_exec_ext"; }; then
+      if $as_executable_p "$as_dir/$lt_ac_prog$ac_exec_ext"; then
         lt_ac_sed_list="$lt_ac_sed_list $as_dir/$lt_ac_prog$ac_exec_ext"
       fi
     done
   done
 done
-IFS=$as_save_IFS
 lt_ac_max=0
 lt_ac_count=0
 # Add /usr/xpg4/bin/sed as it is typically found on Solaris
 # along with /bin/sed that truncates output.
 for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
   test ! -f $lt_ac_sed && continue
@@ -3911,191 +3432,43 @@
   done
 done
 
 fi
 
 SED=$lt_cv_path_SED
+echo "$as_me:$LINENO: result: $SED" >&5
+echo "${ECHO_T}$SED" >&6
 
-{ echo "$as_me:$LINENO: result: $SED" >&5
-echo "${ECHO_T}$SED" >&6; }
-
-{ echo "$as_me:$LINENO: checking for grep that handles long lines and -e" >&5
-echo $ECHO_N "checking for grep that handles long lines and -e... $ECHO_C" >&6; }
-if test "${ac_cv_path_GREP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # Extract the first word of "grep ggrep" to use in msg output
-if test -z "$GREP"; then
-set dummy grep ggrep; ac_prog_name=$2
-if test "${ac_cv_path_GREP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_path_GREP_found=false
-# Loop through the user's path and test for each of PROGNAME-LIST
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_prog in grep ggrep; do
-  for ac_exec_ext in '' $ac_executable_extensions; do
-    ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
-    { test -f "$ac_path_GREP" && $as_test_x "$ac_path_GREP"; } || continue
-    # Check for GNU ac_path_GREP and select it if it is found.
-  # Check for GNU $ac_path_GREP
-case `"$ac_path_GREP" --version 2>&1` in
-*GNU*)
-  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
-*)
-  ac_count=0
-  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
-  while :
-  do
-    cat "conftest.in" "conftest.in" >"conftest.tmp"
-    mv "conftest.tmp" "conftest.in"
-    cp "conftest.in" "conftest.nl"
-    echo 'GREP' >> "conftest.nl"
-    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
-    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
-    ac_count=`expr $ac_count + 1`
-    if test $ac_count -gt ${ac_path_GREP_max-0}; then
-      # Best one so far, save it but keep looking for a better one
-      ac_cv_path_GREP="$ac_path_GREP"
-      ac_path_GREP_max=$ac_count
-    fi
-    # 10*(2^10) chars as input seems more than enough
-    test $ac_count -gt 10 && break
-  done
-  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
-esac
-
-
-    $ac_path_GREP_found && break 3
-  done
-done
-
-done
-IFS=$as_save_IFS
-
-
-fi
-
-GREP="$ac_cv_path_GREP"
-if test -z "$GREP"; then
-  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
-echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-else
-  ac_cv_path_GREP=$GREP
-fi
-
-
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_path_GREP" >&5
-echo "${ECHO_T}$ac_cv_path_GREP" >&6; }
- GREP="$ac_cv_path_GREP"
-
-
-{ echo "$as_me:$LINENO: checking for egrep" >&5
-echo $ECHO_N "checking for egrep... $ECHO_C" >&6; }
-if test "${ac_cv_path_EGREP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
-   then ac_cv_path_EGREP="$GREP -E"
-   else
-     # Extract the first word of "egrep" to use in msg output
-if test -z "$EGREP"; then
-set dummy egrep; ac_prog_name=$2
-if test "${ac_cv_path_EGREP+set}" = set; then
+echo "$as_me:$LINENO: checking for egrep" >&5
+echo $ECHO_N "checking for egrep... $ECHO_C" >&6
+if test "${ac_cv_prog_egrep+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_path_EGREP_found=false
-# Loop through the user's path and test for each of PROGNAME-LIST
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_prog in egrep; do
-  for ac_exec_ext in '' $ac_executable_extensions; do
-    ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
-    { test -f "$ac_path_EGREP" && $as_test_x "$ac_path_EGREP"; } || continue
-    # Check for GNU ac_path_EGREP and select it if it is found.
-  # Check for GNU $ac_path_EGREP
-case `"$ac_path_EGREP" --version 2>&1` in
-*GNU*)
-  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
-*)
-  ac_count=0
-  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
-  while :
-  do
-    cat "conftest.in" "conftest.in" >"conftest.tmp"
-    mv "conftest.tmp" "conftest.in"
-    cp "conftest.in" "conftest.nl"
-    echo 'EGREP' >> "conftest.nl"
-    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
-    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
-    ac_count=`expr $ac_count + 1`
-    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
-      # Best one so far, save it but keep looking for a better one
-      ac_cv_path_EGREP="$ac_path_EGREP"
-      ac_path_EGREP_max=$ac_count
+  if echo a | (grep -E '(a|b)') >/dev/null 2>&1
+    then ac_cv_prog_egrep='grep -E'
+    else ac_cv_prog_egrep='egrep'
     fi
-    # 10*(2^10) chars as input seems more than enough
-    test $ac_count -gt 10 && break
-  done
-  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
-esac
-
-
-    $ac_path_EGREP_found && break 3
-  done
-done
-
-done
-IFS=$as_save_IFS
-
-
-fi
-
-EGREP="$ac_cv_path_EGREP"
-if test -z "$EGREP"; then
-  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
-echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-else
-  ac_cv_path_EGREP=$EGREP
-fi
-
-
-   fi
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_path_EGREP" >&5
-echo "${ECHO_T}$ac_cv_path_EGREP" >&6; }
- EGREP="$ac_cv_path_EGREP"
+echo "$as_me:$LINENO: result: $ac_cv_prog_egrep" >&5
+echo "${ECHO_T}$ac_cv_prog_egrep" >&6
+ EGREP=$ac_cv_prog_egrep
 
 
 
-# Check whether --with-gnu-ld was given.
+# Check whether --with-gnu-ld or --without-gnu-ld was given.
 if test "${with_gnu_ld+set}" = set; then
-  withval=$with_gnu_ld; test "$withval" = no || with_gnu_ld=yes
+  withval="$with_gnu_ld"
+  test "$withval" = no || with_gnu_ld=yes
 else
   with_gnu_ld=no
-fi
-
+fi;
 ac_prog=ld
 if test "$GCC" = yes; then
   # Check if gcc -print-prog-name=ld gives a path.
-  { echo "$as_me:$LINENO: checking for ld used by $CC" >&5
-echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for ld used by $CC" >&5
+echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
     ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
   *)
     ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
@@ -4118,17 +3491,17 @@
   *)
     # If it is relative, then search for the first ld in PATH.
     with_gnu_ld=unknown
     ;;
   esac
 elif test "$with_gnu_ld" = yes; then
-  { echo "$as_me:$LINENO: checking for GNU ld" >&5
-echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for GNU ld" >&5
+echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6
 else
-  { echo "$as_me:$LINENO: checking for non-GNU ld" >&5
-echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for non-GNU ld" >&5
+echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6
 fi
 if test "${lt_cv_path_LD+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -z "$LD"; then
   lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
@@ -4155,23 +3528,23 @@
   lt_cv_path_LD="$LD" # Let the user override the test with a path.
 fi
 fi
 
 LD="$lt_cv_path_LD"
 if test -n "$LD"; then
-  { echo "$as_me:$LINENO: result: $LD" >&5
-echo "${ECHO_T}$LD" >&6; }
+  echo "$as_me:$LINENO: result: $LD" >&5
+echo "${ECHO_T}$LD" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 test -z "$LD" && { { echo "$as_me:$LINENO: error: no acceptable ld found in \$PATH" >&5
 echo "$as_me: error: no acceptable ld found in \$PATH" >&2;}
    { (exit 1); exit 1; }; }
-{ echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
-echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
+echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6
 if test "${lt_cv_prog_gnu_ld+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
 case `$LD -v 2>&1 </dev/null` in
 *GNU* | *'with BFD'*)
@@ -4179,26 +3552,26 @@
   ;;
 *)
   lt_cv_prog_gnu_ld=no
   ;;
 esac
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
-echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
+echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6
 with_gnu_ld=$lt_cv_prog_gnu_ld
 
 
-{ echo "$as_me:$LINENO: checking for $LD option to reload object files" >&5
-echo $ECHO_N "checking for $LD option to reload object files... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $LD option to reload object files" >&5
+echo $ECHO_N "checking for $LD option to reload object files... $ECHO_C" >&6
 if test "${lt_cv_ld_reload_flag+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_ld_reload_flag='-r'
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_ld_reload_flag" >&5
-echo "${ECHO_T}$lt_cv_ld_reload_flag" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_ld_reload_flag" >&5
+echo "${ECHO_T}$lt_cv_ld_reload_flag" >&6
 reload_flag=$lt_cv_ld_reload_flag
 case $reload_flag in
 "" | " "*) ;;
 *) reload_flag=" $reload_flag" ;;
 esac
 reload_cmds='$LD$reload_flag -o $output$reload_objs'
@@ -4209,14 +3582,14 @@
     else
       reload_cmds='$LD$reload_flag -o $output$reload_objs'
     fi
     ;;
 esac
 
-{ echo "$as_me:$LINENO: checking for BSD-compatible nm" >&5
-echo $ECHO_N "checking for BSD-compatible nm... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for BSD-compatible nm" >&5
+echo $ECHO_N "checking for BSD-compatible nm... $ECHO_C" >&6
 if test "${lt_cv_path_NM+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$NM"; then
   # Let the user override the test.
   lt_cv_path_NM="$NM"
@@ -4258,29 +3631,29 @@
     done
     IFS="$lt_save_ifs"
   done
   test -z "$lt_cv_path_NM" && lt_cv_path_NM=nm
 fi
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_path_NM" >&5
-echo "${ECHO_T}$lt_cv_path_NM" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_path_NM" >&5
+echo "${ECHO_T}$lt_cv_path_NM" >&6
 NM="$lt_cv_path_NM"
 
-{ echo "$as_me:$LINENO: checking whether ln -s works" >&5
-echo $ECHO_N "checking whether ln -s works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether ln -s works" >&5
+echo $ECHO_N "checking whether ln -s works... $ECHO_C" >&6
 LN_S=$as_ln_s
 if test "$LN_S" = "ln -s"; then
-  { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+  echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
 else
-  { echo "$as_me:$LINENO: result: no, using $LN_S" >&5
-echo "${ECHO_T}no, using $LN_S" >&6; }
+  echo "$as_me:$LINENO: result: no, using $LN_S" >&5
+echo "${ECHO_T}no, using $LN_S" >&6
 fi
 
-{ echo "$as_me:$LINENO: checking how to recognize dependent libraries" >&5
-echo $ECHO_N "checking how to recognize dependent libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to recognise dependent libraries" >&5
+echo $ECHO_N "checking how to recognise dependent libraries... $ECHO_C" >&6
 if test "${lt_cv_deplibs_check_method+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_file_magic_cmd='$MAGIC_CMD'
 lt_cv_file_magic_test_file=
 lt_cv_deplibs_check_method='unknown'
@@ -4315,21 +3688,15 @@
   lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
   lt_cv_file_magic_cmd='func_win32_libid'
   ;;
 
 mingw* | pw32*)
   # Base MSYS/MinGW do not provide the 'file' command needed by
-  # func_win32_libid shell function, so use a weaker test based on 'objdump',
-  # unless we find 'file', for example because we are cross-compiling.
-  if ( file / ) >/dev/null 2>&1; then
-    lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
-    lt_cv_file_magic_cmd='func_win32_libid'
-  else
-    lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
-    lt_cv_file_magic_cmd='$OBJDUMP -f'
-  fi
+  # func_win32_libid shell function, so use a weaker test based on 'objdump'.
+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
+  lt_cv_file_magic_cmd='$OBJDUMP -f'
   ;;
 
 darwin* | rhapsody*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
@@ -4368,13 +3735,13 @@
     lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library'
     lt_cv_file_magic_test_file=/usr/lib/libc.sl
     ;;
   esac
   ;;
 
-interix[3-9]*)
+interix3*)
   # PIC code is broken on Interix 3.x, that's why |\.a not |_pic\.a here
   lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|\.a)$'
   ;;
 
 irix5* | irix6* | nonstopux*)
   case $LD in
@@ -4418,16 +3785,12 @@
   ;;
 
 osf3* | osf4* | osf5*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
-rdos*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
 solaris*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 
 sysv4 | sysv4.3*)
   case $host_vendor in
@@ -4459,14 +3822,14 @@
 sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX* | sysv4*uw2*)
   lt_cv_deplibs_check_method=pass_all
   ;;
 esac
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_deplibs_check_method" >&5
-echo "${ECHO_T}$lt_cv_deplibs_check_method" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_deplibs_check_method" >&5
+echo "${ECHO_T}$lt_cv_deplibs_check_method" >&6
 file_magic_cmd=$lt_cv_file_magic_cmd
 deplibs_check_method=$lt_cv_deplibs_check_method
 test -z "$deplibs_check_method" && deplibs_check_method=unknown
 
 
 
@@ -4477,17 +3840,17 @@
 # If no C compiler flags were specified, use CFLAGS.
 LTCFLAGS=${LTCFLAGS-"$CFLAGS"}
 
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
-# Check whether --enable-libtool-lock was given.
+# Check whether --enable-libtool-lock or --disable-libtool-lock was given.
 if test "${enable_libtool_lock+set}" = set; then
-  enableval=$enable_libtool_lock;
-fi
+  enableval="$enable_libtool_lock"
 
+fi;
 test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
 
 # Some flags need to be propagated to the compiler or linker for good
 # libtool support.
 case $host in
 ia64-*-hpux*)
@@ -4508,13 +3871,13 @@
     esac
   fi
   rm -rf conftest*
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 4514 "configure"' > conftest.$ac_ext
+  echo '#line 3877 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
    if test "$lt_cv_prog_gnu_ld" = yes; then
@@ -4543,27 +3906,23 @@
     esac
    fi
   fi
   rm -rf conftest*
   ;;
 
-x86_64-*kfreebsd*-gnu|x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*| \
-s390*-*linux*|sparc*-*linux*)
+x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
     case `/usr/bin/file conftest.o` in
     *32-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_i386_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_i386"
           ;;
         ppc64-*linux*|powerpc64-*linux*)
           LD="${LD-ld} -m elf32ppclinux"
           ;;
@@ -4574,15 +3933,12 @@
           LD="${LD-ld} -m elf32_sparc"
           ;;
       esac
       ;;
     *64-bit*)
       case $host in
-        x86_64-*kfreebsd*-gnu)
-          LD="${LD-ld} -m elf_x86_64_fbsd"
-          ;;
         x86_64-*linux*)
           LD="${LD-ld} -m elf_x86_64"
           ;;
         ppc*-*linux*|powerpc*-*linux*)
           LD="${LD-ld} -m elf64ppc"
           ;;
@@ -4600,14 +3956,14 @@
   ;;
 
 *-*-sco3.2v5*)
   # On SCO OpenServer 5, we need -belf to get full-featured binaries.
   SAVE_CFLAGS="$CFLAGS"
   CFLAGS="$CFLAGS -belf"
-  { echo "$as_me:$LINENO: checking whether the C compiler needs -belf" >&5
-echo $ECHO_N "checking whether the C compiler needs -belf... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking whether the C compiler needs -belf" >&5
+echo $ECHO_N "checking whether the C compiler needs -belf... $ECHO_C" >&6
 if test "${lt_cv_cc_needs_belf+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
@@ -4627,48 +3983,50 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   lt_cv_cc_needs_belf=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	lt_cv_cc_needs_belf=no
+lt_cv_cc_needs_belf=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
      ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_cc_needs_belf" >&5
-echo "${ECHO_T}$lt_cv_cc_needs_belf" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_cc_needs_belf" >&5
+echo "${ECHO_T}$lt_cv_cc_needs_belf" >&6
   if test x"$lt_cv_cc_needs_belf" != x"yes"; then
     # this is probably gcc 2.8.0, egcs 1.0 or newer; no need for -belf
     CFLAGS="$SAVE_CFLAGS"
   fi
   ;;
 sparc*-*solaris*)
@@ -4692,293 +4050,245 @@
   ;;
 
 *-*-cygwin* | *-*-mingw* | *-*-pw32*)
   if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}dlltool", so it can be a program name with args.
 set dummy ${ac_tool_prefix}dlltool; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_DLLTOOL+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$DLLTOOL"; then
   ac_cv_prog_DLLTOOL="$DLLTOOL" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_DLLTOOL="${ac_tool_prefix}dlltool"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 DLLTOOL=$ac_cv_prog_DLLTOOL
 if test -n "$DLLTOOL"; then
-  { echo "$as_me:$LINENO: result: $DLLTOOL" >&5
-echo "${ECHO_T}$DLLTOOL" >&6; }
+  echo "$as_me:$LINENO: result: $DLLTOOL" >&5
+echo "${ECHO_T}$DLLTOOL" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_DLLTOOL"; then
   ac_ct_DLLTOOL=$DLLTOOL
   # Extract the first word of "dlltool", so it can be a program name with args.
 set dummy dlltool; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_DLLTOOL+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_DLLTOOL"; then
   ac_cv_prog_ac_ct_DLLTOOL="$ac_ct_DLLTOOL" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_DLLTOOL="dlltool"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_DLLTOOL" && ac_cv_prog_ac_ct_DLLTOOL="false"
 fi
 fi
 ac_ct_DLLTOOL=$ac_cv_prog_ac_ct_DLLTOOL
 if test -n "$ac_ct_DLLTOOL"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_DLLTOOL" >&5
-echo "${ECHO_T}$ac_ct_DLLTOOL" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_DLLTOOL" >&5
+echo "${ECHO_T}$ac_ct_DLLTOOL" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_DLLTOOL" = x; then
-    DLLTOOL="false"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    DLLTOOL=$ac_ct_DLLTOOL
-  fi
+  DLLTOOL=$ac_ct_DLLTOOL
 else
   DLLTOOL="$ac_cv_prog_DLLTOOL"
 fi
 
   if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}as", so it can be a program name with args.
 set dummy ${ac_tool_prefix}as; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_AS+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$AS"; then
   ac_cv_prog_AS="$AS" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_AS="${ac_tool_prefix}as"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 AS=$ac_cv_prog_AS
 if test -n "$AS"; then
-  { echo "$as_me:$LINENO: result: $AS" >&5
-echo "${ECHO_T}$AS" >&6; }
+  echo "$as_me:$LINENO: result: $AS" >&5
+echo "${ECHO_T}$AS" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_AS"; then
   ac_ct_AS=$AS
   # Extract the first word of "as", so it can be a program name with args.
 set dummy as; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_AS+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_AS"; then
   ac_cv_prog_ac_ct_AS="$ac_ct_AS" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_AS="as"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_AS" && ac_cv_prog_ac_ct_AS="false"
 fi
 fi
 ac_ct_AS=$ac_cv_prog_ac_ct_AS
 if test -n "$ac_ct_AS"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_AS" >&5
-echo "${ECHO_T}$ac_ct_AS" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_AS" >&5
+echo "${ECHO_T}$ac_ct_AS" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_AS" = x; then
-    AS="false"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    AS=$ac_ct_AS
-  fi
+  AS=$ac_ct_AS
 else
   AS="$ac_cv_prog_AS"
 fi
 
   if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}objdump", so it can be a program name with args.
 set dummy ${ac_tool_prefix}objdump; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_OBJDUMP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$OBJDUMP"; then
   ac_cv_prog_OBJDUMP="$OBJDUMP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_OBJDUMP="${ac_tool_prefix}objdump"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 OBJDUMP=$ac_cv_prog_OBJDUMP
 if test -n "$OBJDUMP"; then
-  { echo "$as_me:$LINENO: result: $OBJDUMP" >&5
-echo "${ECHO_T}$OBJDUMP" >&6; }
+  echo "$as_me:$LINENO: result: $OBJDUMP" >&5
+echo "${ECHO_T}$OBJDUMP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_OBJDUMP"; then
   ac_ct_OBJDUMP=$OBJDUMP
   # Extract the first word of "objdump", so it can be a program name with args.
 set dummy objdump; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_OBJDUMP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_OBJDUMP"; then
   ac_cv_prog_ac_ct_OBJDUMP="$ac_ct_OBJDUMP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_OBJDUMP="objdump"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_OBJDUMP" && ac_cv_prog_ac_ct_OBJDUMP="false"
 fi
 fi
 ac_ct_OBJDUMP=$ac_cv_prog_ac_ct_OBJDUMP
 if test -n "$ac_ct_OBJDUMP"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_OBJDUMP" >&5
-echo "${ECHO_T}$ac_ct_OBJDUMP" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_OBJDUMP" >&5
+echo "${ECHO_T}$ac_ct_OBJDUMP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_OBJDUMP" = x; then
-    OBJDUMP="false"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    OBJDUMP=$ac_ct_OBJDUMP
-  fi
+  OBJDUMP=$ac_ct_OBJDUMP
 else
   OBJDUMP="$ac_cv_prog_OBJDUMP"
 fi
 
   ;;
 
@@ -4989,14 +4299,14 @@
 
 ac_ext=c
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
-{ echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
-echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
+echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6
 # On Suns, sometimes $CPP names a directory.
 if test -n "$CPP" && test -d "$CPP"; then
   CPP=
 fi
 if test -z "$CPP"; then
   if test "${ac_cv_prog_CPP+set}" = set; then
@@ -5024,28 +4334,30 @@
 # include <limits.h>
 #else
 # include <assert.h>
 #endif
 		     Syntax error
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
@@ -5048,43 +4360,44 @@
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
 continue
 fi
-
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether nonexistent headers
+  # OK, works on sane cases.  Now check whether non-existent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
-  # Broken: success on invalid input.
-continue
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
+  # Broken: success on invalid input.
+continue
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Passes both tests.
 ac_preproc_ok=:
@@ -5105,14 +4417,14 @@
 
 fi
   CPP=$ac_cv_prog_CPP
 else
   ac_cv_prog_CPP=$CPP
 fi
-{ echo "$as_me:$LINENO: result: $CPP" >&5
-echo "${ECHO_T}$CPP" >&6; }
+echo "$as_me:$LINENO: result: $CPP" >&5
+echo "${ECHO_T}$CPP" >&6
 ac_preproc_ok=false
 for ac_c_preproc_warn_flag in '' yes
 do
   # Use a header file that comes with gcc, so configuring glibc
   # with a fresh cross-compiler works.
   # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
@@ -5129,28 +4441,30 @@
 # include <limits.h>
 #else
 # include <assert.h>
 #endif
 		     Syntax error
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
@@ -5153,41 +4467,42 @@
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
 continue
 fi
-
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether nonexistent headers
+  # OK, works on sane cases.  Now check whether non-existent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   # Broken: success on invalid input.
 continue
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
@@ -5215,14 +4529,14 @@
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
-{ echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for ANSI C header files" >&5
+echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
 if test "${ac_cv_header_stdc+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5240,37 +4554,40 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_header_stdc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_header_stdc=no
+ac_cv_header_stdc=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5320,13 +4637,12 @@
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ctype.h>
-#include <stdlib.h>
 #if ((' ' & 0x0FF) == 0x020)
 # define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
 # define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
 #else
 # define ISLOWER(c) \
 		   (('a' <= (c) && (c) <= 'i') \
@@ -5340,53 +4656,42 @@
 main ()
 {
   int i;
   for (i = 0; i < 256; i++)
     if (XOR (islower (i), ISLOWER (i))
 	|| toupper (i) != TOUPPER (i))
-      return 2;
-  return 0;
+      exit(2);
+  exit (0);
 }
 _ACEOF
 rm -f conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>&5
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
   :
 else
   echo "$as_me: program exited with status $ac_status" >&5
 echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
 ( exit $ac_status )
 ac_cv_header_stdc=no
 fi
-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
 fi
-
-
 fi
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
+echo "${ECHO_T}$ac_cv_header_stdc" >&6
 if test $ac_cv_header_stdc = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define STDC_HEADERS 1
 _ACEOF
 
@@ -5403,15 +4708,15 @@
 
 
 for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
 		  inttypes.h stdint.h unistd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -5419,41 +4724,43 @@
 /* end confdefs.h.  */
 $ac_includes_default
 
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_Header=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_Header=no"
+eval "$as_ac_Header=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
 fi
@@ -5462,90 +4769,94 @@
 
 
 
 for ac_header in dlfcn.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
-  { echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_header_compiler=no
+ac_header_compiler=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
@@ -5547,16 +4858,15 @@
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
 fi
-
 rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
     { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
 echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
@@ -5574,192 +4884,157 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
 echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    ( cat <<\_ASBOX
+    (
+      cat <<\_ASBOX
 ## ---------------------------------- ##
 ## Report this to bug-libtool@gnu.org ##
 ## ---------------------------------- ##
 _ASBOX
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
 fi
 
 done
 
-ac_ext=cpp
+ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -z "$CXX"; then
-  if test -n "$CCC"; then
-    CXX=$CCC
-  else
-    if test -n "$ac_tool_prefix"; then
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
+if test -n "$ac_tool_prefix"; then
+  for ac_prog in $CCC g++ c++ gpp aCC CC cxx cc++ cl FCC KCC RCC xlC_r xlC
   do
     # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
 set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$CXX"; then
   ac_cv_prog_CXX="$CXX" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 CXX=$ac_cv_prog_CXX
 if test -n "$CXX"; then
-  { echo "$as_me:$LINENO: result: $CXX" >&5
-echo "${ECHO_T}$CXX" >&6; }
+  echo "$as_me:$LINENO: result: $CXX" >&5
+echo "${ECHO_T}$CXX" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
     test -n "$CXX" && break
   done
 fi
 if test -z "$CXX"; then
   ac_ct_CXX=$CXX
-  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
+  for ac_prog in $CCC g++ c++ gpp aCC CC cxx cc++ cl FCC KCC RCC xlC_r xlC
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_CXX"; then
   ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_CXX="$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
 if test -n "$ac_ct_CXX"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-echo "${ECHO_T}$ac_ct_CXX" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
+echo "${ECHO_T}$ac_ct_CXX" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
   test -n "$ac_ct_CXX" && break
 done
+test -n "$ac_ct_CXX" || ac_ct_CXX="g++"
 
-  if test "x$ac_ct_CXX" = x; then
-    CXX="g++"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    CXX=$ac_ct_CXX
-  fi
+  CXX=$ac_ct_CXX
 fi
 
-  fi
-fi
+
 # Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for C++ compiler version" >&5
+echo "$as_me:$LINENO:" \
+     "checking for C++ compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
+  (eval $ac_compiler --version </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
+  (eval $ac_compiler -v </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
+  (eval $ac_compiler -V </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
 
-{ echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C++ compiler... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
+echo $ECHO_N "checking whether we are using the GNU C++ compiler... $ECHO_C" >&6
 if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5776,55 +5051,55 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_compiler_gnu=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_compiler_gnu=no
+ac_compiler_gnu=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_cxx_compiler_gnu" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
+echo "${ECHO_T}$ac_cv_cxx_compiler_gnu" >&6
 GXX=`test $ac_compiler_gnu = yes && echo yes`
 ac_test_CXXFLAGS=${CXXFLAGS+set}
 ac_save_CXXFLAGS=$CXXFLAGS
-{ echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-echo $ECHO_N "checking whether $CXX accepts -g... $ECHO_C" >&6; }
+CXXFLAGS="-g"
+echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
+echo $ECHO_N "checking whether $CXX accepts -g... $ECHO_C" >&6
 if test "${ac_cv_prog_cxx_g+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
-  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
-   ac_cxx_werror_flag=yes
-   ac_cv_prog_cxx_g=no
-   CXXFLAGS="-g"
-   cat >conftest.$ac_ext <<_ACEOF
+  cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
@@ -5834,149 +5109,172 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_prog_cxx_g=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	CXXFLAGS=""
-      cat >conftest.$ac_ext <<_ACEOF
+ac_cv_prog_cxx_g=no
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
+echo "${ECHO_T}$ac_cv_prog_cxx_g" >&6
+if test "$ac_test_CXXFLAGS" = set; then
+  CXXFLAGS=$ac_save_CXXFLAGS
+elif test $ac_cv_prog_cxx_g = yes; then
+  if test "$GXX" = yes; then
+    CXXFLAGS="-g -O2"
+  else
+    CXXFLAGS="-g"
+  fi
+else
+  if test "$GXX" = yes; then
+    CXXFLAGS="-O2"
+  else
+    CXXFLAGS=
+  fi
+fi
+for ac_declaration in \
+   '' \
+   'extern "C" void std::exit (int) throw (); using std::exit;' \
+   'extern "C" void std::exit (int); using std::exit;' \
+   'extern "C" void exit (int) throw ();' \
+   'extern "C" void exit (int);' \
+   'void exit (int);'
+do
+  cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-
+$ac_declaration
+#include <stdlib.h>
 int
 main ()
 {
-
+exit (42);
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-	 CXXFLAGS="-g"
-	 cat >conftest.$ac_ext <<_ACEOF
+continue
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+  cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-
+$ac_declaration
 int
 main ()
 {
-
+exit (42);
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
-  ac_cv_prog_cxx_g=yes
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  break
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+done
+rm -f conftest*
+if test -n "$ac_declaration"; then
+  echo '#ifdef __cplusplus' >>confdefs.h
+  echo $ac_declaration      >>confdefs.h
+  echo '#endif'             >>confdefs.h
 fi
 
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cxx_g" >&6; }
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-ac_ext=cpp
+ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
 depcc="$CXX"  am_compiler_list=
 
-{ echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
-echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
+echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6
 if test "${am_cv_CXX_dependencies_compiler_type+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
   # We make a subdir and do the tests there.  Otherwise we can end up
   # making bogus files that we don't know about and never remove.  For
@@ -6059,14 +5357,14 @@
   rm -rf conftest.dir
 else
   am_cv_CXX_dependencies_compiler_type=none
 fi
 
 fi
-{ echo "$as_me:$LINENO: result: $am_cv_CXX_dependencies_compiler_type" >&5
-echo "${ECHO_T}$am_cv_CXX_dependencies_compiler_type" >&6; }
+echo "$as_me:$LINENO: result: $am_cv_CXX_dependencies_compiler_type" >&5
+echo "${ECHO_T}$am_cv_CXX_dependencies_compiler_type" >&6
 CXXDEPMODE=depmode=$am_cv_CXX_dependencies_compiler_type
 
 
 
 if
   test "x$enable_dependency_tracking" != xno \
@@ -6081,19 +5379,19 @@
 
 
 
 if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
     ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
     (test "X$CXX" != "Xg++"))) ; then
-  ac_ext=cpp
+  ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-{ echo "$as_me:$LINENO: checking how to run the C++ preprocessor" >&5
-echo $ECHO_N "checking how to run the C++ preprocessor... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to run the C++ preprocessor" >&5
+echo $ECHO_N "checking how to run the C++ preprocessor... $ECHO_C" >&6
 if test -z "$CXXCPP"; then
   if test "${ac_cv_prog_CXXCPP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
       # Double quotes because CXXCPP needs to be expanded
     for CXXCPP in "$CXX -E" "/lib/cpp"
@@ -6117,28 +5415,30 @@
 # include <limits.h>
 #else
 # include <assert.h>
 #endif
 		     Syntax error
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_cxx_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
@@ -6141,41 +5441,42 @@
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
 continue
 fi
-
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether nonexistent headers
+  # OK, works on sane cases.  Now check whether non-existent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_cxx_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   # Broken: success on invalid input.
 continue
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
@@ -6198,14 +5498,14 @@
 
 fi
   CXXCPP=$ac_cv_prog_CXXCPP
 else
   ac_cv_prog_CXXCPP=$CXXCPP
 fi
-{ echo "$as_me:$LINENO: result: $CXXCPP" >&5
-echo "${ECHO_T}$CXXCPP" >&6; }
+echo "$as_me:$LINENO: result: $CXXCPP" >&5
+echo "${ECHO_T}$CXXCPP" >&6
 ac_preproc_ok=false
 for ac_cxx_preproc_warn_flag in '' yes
 do
   # Use a header file that comes with gcc, so configuring glibc
   # with a fresh cross-compiler works.
   # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
@@ -6222,28 +5522,30 @@
 # include <limits.h>
 #else
 # include <assert.h>
 #endif
 		     Syntax error
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_cxx_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   :
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
@@ -6246,41 +5548,42 @@
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   # Broken: fails on valid input.
 continue
 fi
-
 rm -f conftest.err conftest.$ac_ext
 
-  # OK, works on sane cases.  Now check whether nonexistent headers
+  # OK, works on sane cases.  Now check whether non-existent headers
   # can be detected and how.
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <ac_nonexistent.h>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_cxx_preproc_warn_flag$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_cxx_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   # Broken: success on invalid input.
 continue
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
@@ -6301,13 +5603,13 @@
 See \`config.log' for more details." >&5
 echo "$as_me: error: C++ preprocessor \"$CXXCPP\" fails sanity check
 See \`config.log' for more details." >&2;}
    { (exit 1); exit 1; }; }
 fi
 
-ac_ext=cpp
+ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
 fi
@@ -6315,244 +5617,218 @@
 
 ac_ext=f
 ac_compile='$F77 -c $FFLAGS conftest.$ac_ext >&5'
 ac_link='$F77 -o conftest$ac_exeext $FFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_f77_compiler_gnu
 if test -n "$ac_tool_prefix"; then
-  for ac_prog in g77 xlf f77 frt pgf77 cf77 fort77 fl32 af77 xlf90 f90 pgf90 pghpf epcf90 gfortran g95 xlf95 f95 fort ifort ifc efc pgf95 lf95 ftn
+  for ac_prog in g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95 fort xlf95 ifc efc pgf95 lf95 gfortran
   do
     # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
 set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$F77"; then
   ac_cv_prog_F77="$F77" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_F77="$ac_tool_prefix$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 F77=$ac_cv_prog_F77
 if test -n "$F77"; then
-  { echo "$as_me:$LINENO: result: $F77" >&5
-echo "${ECHO_T}$F77" >&6; }
+  echo "$as_me:$LINENO: result: $F77" >&5
+echo "${ECHO_T}$F77" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
     test -n "$F77" && break
   done
 fi
 if test -z "$F77"; then
   ac_ct_F77=$F77
-  for ac_prog in g77 xlf f77 frt pgf77 cf77 fort77 fl32 af77 xlf90 f90 pgf90 pghpf epcf90 gfortran g95 xlf95 f95 fort ifort ifc efc pgf95 lf95 ftn
+  for ac_prog in g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95 fort xlf95 ifc efc pgf95 lf95 gfortran
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_F77"; then
   ac_cv_prog_ac_ct_F77="$ac_ct_F77" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_F77="$ac_prog"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 ac_ct_F77=$ac_cv_prog_ac_ct_F77
 if test -n "$ac_ct_F77"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_F77" >&5
-echo "${ECHO_T}$ac_ct_F77" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_F77" >&5
+echo "${ECHO_T}$ac_ct_F77" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
   test -n "$ac_ct_F77" && break
 done
 
-  if test "x$ac_ct_F77" = x; then
-    F77=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    F77=$ac_ct_F77
-  fi
+  F77=$ac_ct_F77
 fi
 
 
 # Provide some information about the compiler.
-echo "$as_me:$LINENO: checking for Fortran 77 compiler version" >&5
+echo "$as_me:5710:" \
+     "checking for Fortran 77 compiler version" >&5
 ac_compiler=`set X $ac_compile; echo $2`
-{ (ac_try="$ac_compiler --version >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler --version >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
+  (eval $ac_compiler --version </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -v >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -v >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
+  (eval $ac_compiler -v </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
-{ (ac_try="$ac_compiler -V >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compiler -V >&5") 2>&5
+{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
+  (eval $ac_compiler -V </dev/null >&5) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }
 rm -f a.out
 
 # If we don't use `.F' as extension, the preprocessor is not run on the
 # input file.  (Note that this only needs to work for GNU compilers.)
 ac_save_ext=$ac_ext
 ac_ext=F
-{ echo "$as_me:$LINENO: checking whether we are using the GNU Fortran 77 compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU Fortran 77 compiler... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether we are using the GNU Fortran 77 compiler" >&5
+echo $ECHO_N "checking whether we are using the GNU Fortran 77 compiler... $ECHO_C" >&6
 if test "${ac_cv_f77_compiler_gnu+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
       program main
 #ifndef __GNUC__
        choke me
 #endif
 
       end
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_f77_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_compiler_gnu=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_compiler_gnu=no
+ac_compiler_gnu=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 ac_cv_f77_compiler_gnu=$ac_compiler_gnu
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_f77_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_f77_compiler_gnu" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_f77_compiler_gnu" >&5
+echo "${ECHO_T}$ac_cv_f77_compiler_gnu" >&6
 ac_ext=$ac_save_ext
 ac_test_FFLAGS=${FFLAGS+set}
 ac_save_FFLAGS=$FFLAGS
 FFLAGS=
-{ echo "$as_me:$LINENO: checking whether $F77 accepts -g" >&5
-echo $ECHO_N "checking whether $F77 accepts -g... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether $F77 accepts -g" >&5
+echo $ECHO_N "checking whether $F77 accepts -g... $ECHO_C" >&6
 if test "${ac_cv_prog_f77_g+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   FFLAGS=-g
 cat >conftest.$ac_ext <<_ACEOF
       program main
 
       end
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_f77_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_prog_f77_g=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_prog_f77_g=no
+ac_cv_prog_f77_g=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_prog_f77_g" >&5
-echo "${ECHO_T}$ac_cv_prog_f77_g" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_prog_f77_g" >&5
+echo "${ECHO_T}$ac_cv_prog_f77_g" >&6
 if test "$ac_test_FFLAGS" = set; then
   FFLAGS=$ac_save_FFLAGS
 elif test $ac_cv_prog_f77_g = yes; then
   if test "x$ac_cv_f77_compiler_gnu" = xyes; then
     FFLAGS="-g -O2"
   else
@@ -6575,14 +5851,14 @@
 
 
 
 # Autoconf 2.13's AC_OBJEXT and AC_EXEEXT macros only works for C compilers!
 
 # find the maximum length of command line arguments
-{ echo "$as_me:$LINENO: checking the maximum length of command line arguments" >&5
-echo $ECHO_N "checking the maximum length of command line arguments... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking the maximum length of command line arguments" >&5
+echo $ECHO_N "checking the maximum length of command line arguments... $ECHO_C" >&6
 if test "${lt_cv_sys_max_cmd_len+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
     i=0
   teststring="ABCD"
 
@@ -6660,53 +5936,49 @@
       lt_cv_sys_max_cmd_len=`echo $kargmax | sed 's/.*[ 	]//'`
     else
       lt_cv_sys_max_cmd_len=32768
     fi
     ;;
   *)
-    lt_cv_sys_max_cmd_len=`(getconf ARG_MAX) 2> /dev/null`
-    if test -n "$lt_cv_sys_max_cmd_len"; then
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \* 3`
-    else
-      SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
-      while (test "X"`$SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
+    # If test is not a shell built-in, we'll probably end up computing a
+    # maximum length that is only half of the actual maximum length, but
+    # we can't tell.
+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}
+    while (test "X"`$SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
 	       = "XX$teststring") >/dev/null 2>&1 &&
-	      new_result=`expr "X$teststring" : ".*" 2>&1` &&
-	      lt_cv_sys_max_cmd_len=$new_result &&
-	      test $i != 17 # 1/2 MB should be enough
-      do
-        i=`expr $i + 1`
-        teststring=$teststring$teststring
-      done
-      teststring=
-      # Add a significant safety factor because C++ compilers can tack on massive
-      # amounts of additional arguments before passing them to the linker.
-      # It appears as though 1/2 is a usable value.
-      lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
-    fi
+	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
+	    lt_cv_sys_max_cmd_len=$new_result &&
+	    test $i != 17 # 1/2 MB should be enough
+    do
+      i=`expr $i + 1`
+      teststring=$teststring$teststring
+    done
+    teststring=
+    # Add a significant safety factor because C++ compilers can tack on massive
+    # amounts of additional arguments before passing them to the linker.
+    # It appears as though 1/2 is a usable value.
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
     ;;
   esac
 
 fi
 
 if test -n $lt_cv_sys_max_cmd_len ; then
-  { echo "$as_me:$LINENO: result: $lt_cv_sys_max_cmd_len" >&5
-echo "${ECHO_T}$lt_cv_sys_max_cmd_len" >&6; }
+  echo "$as_me:$LINENO: result: $lt_cv_sys_max_cmd_len" >&5
+echo "${ECHO_T}$lt_cv_sys_max_cmd_len" >&6
 else
-  { echo "$as_me:$LINENO: result: none" >&5
-echo "${ECHO_T}none" >&6; }
+  echo "$as_me:$LINENO: result: none" >&5
+echo "${ECHO_T}none" >&6
 fi
 
 
 
 
-
 # Check for command to grab the raw symbol name followed by C symbol from nm.
-{ echo "$as_me:$LINENO: checking command to parse $NM output from $compiler object" >&5
-echo $ECHO_N "checking command to parse $NM output from $compiler object... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking command to parse $NM output from $compiler object" >&5
+echo $ECHO_N "checking command to parse $NM output from $compiler object... $ECHO_C" >&6
 if test "${lt_cv_sys_global_symbol_pipe+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
 
 # These are sane defaults that work on at least a few old systems.
 # [They come from Ultrix.  What could be older than Ultrix?!! ;)]
@@ -6904,21 +6176,21 @@
 fi
 
 if test -z "$lt_cv_sys_global_symbol_pipe"; then
   lt_cv_sys_global_symbol_to_cdecl=
 fi
 if test -z "$lt_cv_sys_global_symbol_pipe$lt_cv_sys_global_symbol_to_cdecl"; then
-  { echo "$as_me:$LINENO: result: failed" >&5
-echo "${ECHO_T}failed" >&6; }
+  echo "$as_me:$LINENO: result: failed" >&5
+echo "${ECHO_T}failed" >&6
 else
-  { echo "$as_me:$LINENO: result: ok" >&5
-echo "${ECHO_T}ok" >&6; }
+  echo "$as_me:$LINENO: result: ok" >&5
+echo "${ECHO_T}ok" >&6
 fi
 
-{ echo "$as_me:$LINENO: checking for objdir" >&5
-echo $ECHO_N "checking for objdir... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for objdir" >&5
+echo $ECHO_N "checking for objdir... $ECHO_C" >&6
 if test "${lt_cv_objdir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   rm -f .libs 2>/dev/null
 mkdir .libs 2>/dev/null
 if test -d .libs; then
@@ -6926,14 +6198,14 @@
 else
   # MS-DOS does not allow filenames that begin with a dot.
   lt_cv_objdir=_libs
 fi
 rmdir .libs 2>/dev/null
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_objdir" >&5
-echo "${ECHO_T}$lt_cv_objdir" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_objdir" >&5
+echo "${ECHO_T}$lt_cv_objdir" >&6
 objdir=$lt_cv_objdir
 
 
 
 
 
@@ -6978,293 +6250,245 @@
 ofile="$default_ofile"
 with_gnu_ld="$lt_cv_prog_gnu_ld"
 
 if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
 set dummy ${ac_tool_prefix}ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_AR+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$AR"; then
   ac_cv_prog_AR="$AR" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_AR="${ac_tool_prefix}ar"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 AR=$ac_cv_prog_AR
 if test -n "$AR"; then
-  { echo "$as_me:$LINENO: result: $AR" >&5
-echo "${ECHO_T}$AR" >&6; }
+  echo "$as_me:$LINENO: result: $AR" >&5
+echo "${ECHO_T}$AR" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_AR"; then
   ac_ct_AR=$AR
   # Extract the first word of "ar", so it can be a program name with args.
 set dummy ar; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_AR+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_AR"; then
   ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_AR="ar"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_AR" && ac_cv_prog_ac_ct_AR="false"
 fi
 fi
 ac_ct_AR=$ac_cv_prog_ac_ct_AR
 if test -n "$ac_ct_AR"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_AR" >&5
-echo "${ECHO_T}$ac_ct_AR" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_AR" >&5
+echo "${ECHO_T}$ac_ct_AR" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_AR" = x; then
-    AR="false"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    AR=$ac_ct_AR
-  fi
+  AR=$ac_ct_AR
 else
   AR="$ac_cv_prog_AR"
 fi
 
 if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
 set dummy ${ac_tool_prefix}ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_RANLIB+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$RANLIB"; then
   ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 RANLIB=$ac_cv_prog_RANLIB
 if test -n "$RANLIB"; then
-  { echo "$as_me:$LINENO: result: $RANLIB" >&5
-echo "${ECHO_T}$RANLIB" >&6; }
+  echo "$as_me:$LINENO: result: $RANLIB" >&5
+echo "${ECHO_T}$RANLIB" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_RANLIB"; then
   ac_ct_RANLIB=$RANLIB
   # Extract the first word of "ranlib", so it can be a program name with args.
 set dummy ranlib; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_RANLIB+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_RANLIB"; then
   ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_RANLIB="ranlib"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_RANLIB" && ac_cv_prog_ac_ct_RANLIB=":"
 fi
 fi
 ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
 if test -n "$ac_ct_RANLIB"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
-echo "${ECHO_T}$ac_ct_RANLIB" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
+echo "${ECHO_T}$ac_ct_RANLIB" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_RANLIB" = x; then
-    RANLIB=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    RANLIB=$ac_ct_RANLIB
-  fi
+  RANLIB=$ac_ct_RANLIB
 else
   RANLIB="$ac_cv_prog_RANLIB"
 fi
 
 if test -n "$ac_tool_prefix"; then
   # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
 set dummy ${ac_tool_prefix}strip; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$STRIP"; then
   ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_STRIP="${ac_tool_prefix}strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
 fi
 fi
 STRIP=$ac_cv_prog_STRIP
 if test -n "$STRIP"; then
-  { echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6; }
+  echo "$as_me:$LINENO: result: $STRIP" >&5
+echo "${ECHO_T}$STRIP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-
 fi
 if test -z "$ac_cv_prog_STRIP"; then
   ac_ct_STRIP=$STRIP
   # Extract the first word of "strip", so it can be a program name with args.
 set dummy strip; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
 if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$ac_ct_STRIP"; then
   ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
 else
 as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
 for as_dir in $PATH
 do
   IFS=$as_save_IFS
   test -z "$as_dir" && as_dir=.
   for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
     ac_cv_prog_ac_ct_STRIP="strip"
     echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
     break 2
   fi
 done
 done
-IFS=$as_save_IFS
 
+  test -z "$ac_cv_prog_ac_ct_STRIP" && ac_cv_prog_ac_ct_STRIP=":"
 fi
 fi
 ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
 if test -n "$ac_ct_STRIP"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
-echo "${ECHO_T}$ac_ct_STRIP" >&6; }
+  echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
+echo "${ECHO_T}$ac_ct_STRIP" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
-  if test "x$ac_ct_STRIP" = x; then
-    STRIP=":"
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    STRIP=$ac_ct_STRIP
-  fi
+  STRIP=$ac_ct_STRIP
 else
   STRIP="$ac_cv_prog_STRIP"
 fi
 
 
 old_CC="$CC"
@@ -7286,13 +6510,13 @@
 test -z "$OBJDUMP" && OBJDUMP=objdump
 test -z "$RANLIB" && RANLIB=:
 test -z "$STRIP" && STRIP=:
 test -z "$ac_objext" && ac_objext=o
 
 # Determine commands to create old-style static archives.
-old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs'
+old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
 old_postinstall_cmds='chmod 644 $oldlib'
 old_postuninstall_cmds=
 
 if test -n "$RANLIB"; then
   case $host_os in
   openbsd*)
@@ -7317,14 +6541,14 @@
 
 
 # Only perform the check for file, if the check method requires it
 case $deplibs_check_method in
 file_magic*)
   if test "$file_magic_cmd" = '$MAGIC_CMD'; then
-    { echo "$as_me:$LINENO: checking for ${ac_tool_prefix}file" >&5
-echo $ECHO_N "checking for ${ac_tool_prefix}file... $ECHO_C" >&6; }
+    echo "$as_me:$LINENO: checking for ${ac_tool_prefix}file" >&5
+echo $ECHO_N "checking for ${ac_tool_prefix}file... $ECHO_C" >&6
 if test "${lt_cv_path_MAGIC_CMD+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   case $MAGIC_CMD in
 [\\/*] |  ?:[\\/]*)
   lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
@@ -7370,23 +6594,23 @@
   ;;
 esac
 fi
 
 MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
 if test -n "$MAGIC_CMD"; then
-  { echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
-echo "${ECHO_T}$MAGIC_CMD" >&6; }
+  echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
+echo "${ECHO_T}$MAGIC_CMD" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
 if test -z "$lt_cv_path_MAGIC_CMD"; then
   if test -n "$ac_tool_prefix"; then
-    { echo "$as_me:$LINENO: checking for file" >&5
-echo $ECHO_N "checking for file... $ECHO_C" >&6; }
+    echo "$as_me:$LINENO: checking for file" >&5
+echo $ECHO_N "checking for file... $ECHO_C" >&6
 if test "${lt_cv_path_MAGIC_CMD+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   case $MAGIC_CMD in
 [\\/*] |  ?:[\\/]*)
   lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
@@ -7432,17 +6656,17 @@
   ;;
 esac
 fi
 
 MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
 if test -n "$MAGIC_CMD"; then
-  { echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
-echo "${ECHO_T}$MAGIC_CMD" >&6; }
+  echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
+echo "${ECHO_T}$MAGIC_CMD" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 
   else
     MAGIC_CMD=:
   fi
 fi
@@ -7451,27 +6675,27 @@
   ;;
 esac
 
 enable_dlopen=no
 enable_win32_dll=yes
 
-# Check whether --enable-libtool-lock was given.
+# Check whether --enable-libtool-lock or --disable-libtool-lock was given.
 if test "${enable_libtool_lock+set}" = set; then
-  enableval=$enable_libtool_lock;
-fi
+  enableval="$enable_libtool_lock"
 
+fi;
 test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
 
 
-# Check whether --with-pic was given.
+# Check whether --with-pic or --without-pic was given.
 if test "${with_pic+set}" = set; then
-  withval=$with_pic; pic_mode="$withval"
+  withval="$with_pic"
+  pic_mode="$withval"
 else
   pic_mode=default
-fi
-
+fi;
 test -z "$pic_mode" && pic_mode=default
 
 # Use C for the default configuration in the libtool script
 tagname=
 lt_save_CC="$CC"
 ac_ext=c
@@ -7486,16 +6710,16 @@
 
 # Object file extension for compiled C test sources.
 objext=o
 objext=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(){return(0);}'
+lt_simple_link_test_code='int main(){return(0);}\n'
 
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
 # If no C compiler flags were specified, use CFLAGS.
@@ -7504,19 +6728,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 ## CAVEAT EMPTOR:
@@ -7527,49 +6751,49 @@
 lt_prog_compiler_no_builtin_flag=
 
 if test "$GCC" = yes; then
   lt_prog_compiler_no_builtin_flag=' -fno-builtin'
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
-echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
+echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_rtti_exceptions=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="-fno-rtti -fno-exceptions"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7551: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:6775: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7555: \$? = $ac_status" >&5
+   echo "$as_me:6779: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6
 
 if test x"$lt_cv_prog_compiler_rtti_exceptions" = xyes; then
     lt_prog_compiler_no_builtin_flag="$lt_prog_compiler_no_builtin_flag -fno-rtti -fno-exceptions"
 else
     :
 fi
@@ -7577,14 +6801,14 @@
 fi
 
 lt_prog_compiler_wl=
 lt_prog_compiler_pic=
 lt_prog_compiler_static=
 
-{ echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
+echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
 
   if test "$GCC" = yes; then
     lt_prog_compiler_wl='-Wl,'
     lt_prog_compiler_static='-static'
 
     case $host_os in
@@ -7600,31 +6824,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -7676,13 +6898,13 @@
          lt_prog_compiler_pic='-qnocommon'
          lt_prog_compiler_wl='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -7728,41 +6950,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic='-KPIC'
-	  lt_prog_compiler_static='-Bstatic'
-	  lt_prog_compiler_wl='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic='-KPIC'
-	  lt_prog_compiler_static='-Bstatic'
-	  lt_prog_compiler_wl=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic='-KPIC'
       lt_prog_compiler_static='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl='-Qoption ld ';;
@@ -7809,57 +7011,57 @@
     *)
       lt_prog_compiler_can_build_shared=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic" >&6
 
 #
 # Check to make sure the PIC flag actually works.
 #
 if test -n "$lt_prog_compiler_pic"; then
 
-{ echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic works" >&5
+echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic works... $ECHO_C" >&6
 if test "${lt_prog_compiler_pic_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic -DPIC"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7841: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7043: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7845: \$? = $ac_status" >&5
+   echo "$as_me:7047: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_works" >&6
 
 if test x"$lt_prog_compiler_pic_works" = xyes; then
     case $lt_prog_compiler_pic in
      "" | " "*) ;;
      *) lt_prog_compiler_pic=" $lt_prog_compiler_pic" ;;
      esac
@@ -7880,21 +7082,21 @@
 esac
 
 #
 # Check to make sure the static flag actually works.
 #
 wl=$lt_prog_compiler_wl eval lt_tmp_static_flag=\"$lt_prog_compiler_static\"
-{ echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
-echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
+echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6
 if test "${lt_prog_compiler_static_works+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -7908,48 +7110,48 @@
      fi
    fi
    $rm conftest*
    LDFLAGS="$save_LDFLAGS"
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works" >&5
-echo "${ECHO_T}$lt_prog_compiler_static_works" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works" >&5
+echo "${ECHO_T}$lt_prog_compiler_static_works" >&6
 
 if test x"$lt_prog_compiler_static_works" = xyes; then
     :
 else
     lt_prog_compiler_static=
 fi
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
+echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_c_o+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_c_o=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7945: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7147: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:7949: \$? = $ac_status" >&5
+   echo "$as_me:7151: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -7965,40 +7167,40 @@
    $rm out/* && rmdir out
    cd ..
    rmdir conftest
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_c_o" >&6
 
 
 hard_links="nottested"
 if test "$lt_cv_prog_compiler_c_o" = no && test "$need_locks" != no; then
   # do not overwrite the value of need_locks provided by the user
-  { echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
+echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
   hard_links=yes
   $rm conftest*
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
   touch conftest.a
   ln conftest.a conftest.b 2>&5 || hard_links=no
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  { echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6; }
+  echo "$as_me:$LINENO: result: $hard_links" >&5
+echo "${ECHO_T}$hard_links" >&6
   if test "$hard_links" = no; then
     { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
 echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
     need_locks=warn
   fi
 else
   need_locks=no
 fi
 
-{ echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
+echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
 
   runpath_var=
   allow_undefined_flag=
   enable_shared_with_static_runtimes=no
   archive_cmds=
   archive_expsym_cmds=
@@ -8135,13 +7337,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, ) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec='-L$libdir'
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -8153,13 +7355,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct=no
       hardcode_shlibpath_var=no
       hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
       export_dynamic_flag_spec='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -8168,13 +7370,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -8186,28 +7388,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs=no
       else
 	ld_shlibs=no
       fi
       ;;
@@ -8361,13 +7554,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -8417,50 +7610,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
 	archive_expsym_cmds="\$CC"' -o $output_objdir/$soname $libobjs $deplibs '"\${wl}$no_entry_flag"' $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$exp_sym_flag:\$export_symbols $shared_flag"
        else
@@ -8483,50 +7670,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
 
-fi
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
+# Check for a 64-bit object if we didn't find anything.
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+fi
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
 	 hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
 	  # Warning - without using the other run time loading flags,
 	  # -berok will link without error, but may produce a broken library.
@@ -8566,13 +7747,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -8608,16 +7789,16 @@
       archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs=no
           ;;
       esac
@@ -8773,34 +7954,30 @@
       hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator=:
       hardcode_shlibpath_var=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct=yes
-	hardcode_shlibpath_var=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct=yes
+      hardcode_shlibpath_var=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec='${wl}-E'
       else
-	ld_shlibs=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec='-L$libdir'
       hardcode_minus_L=yes
@@ -8853,22 +8030,23 @@
       fi
       hardcode_libdir_flag_spec='-R$libdir'
       hardcode_shlibpath_var=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -8919,13 +8097,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag='${wl}-z,text'
       archive_cmds_need_lc=no
       hardcode_shlibpath_var=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -8972,14 +8150,14 @@
     *)
       ld_shlibs=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $ld_shlibs" >&5
-echo "${ECHO_T}$ld_shlibs" >&6; }
+echo "$as_me:$LINENO: result: $ld_shlibs" >&5
+echo "${ECHO_T}$ld_shlibs" >&6
 test "$ld_shlibs" = no && can_build_shared=no
 
 #
 # Do we need to explicitly link libc?
 #
 case "x$archive_cmds_need_lc" in
@@ -8993,16 +8171,16 @@
       # FIXME: we may have to deal with multi-command sequences.
       ;;
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
-      { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
+      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
+echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -9031,22 +8209,22 @@
         fi
         allow_undefined_flag=$lt_save_allow_undefined_flag
       else
         cat conftest.err 1>&5
       fi
       $rm conftest*
-      { echo "$as_me:$LINENO: result: $archive_cmds_need_lc" >&5
-echo "${ECHO_T}$archive_cmds_need_lc" >&6; }
+      echo "$as_me:$LINENO: result: $archive_cmds_need_lc" >&5
+echo "${ECHO_T}$archive_cmds_need_lc" >&6
       ;;
     esac
   fi
   ;;
 esac
 
-{ echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
+echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -9054,61 +8232,23 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
 if test "$GCC" = yes; then
-  case $host_os in
-    darwin*) lt_awk_arg="/^libraries:/,/LR/" ;;
-    *) lt_awk_arg="/^libraries:/" ;;
-  esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$lt_search_path_spec" | grep ';' >/dev/null ; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
     # if the path contains ";" then we assume it to be the separator
     # otherwise default to the standard path separator (i.e. ":") - it is
     # assumed that no part of a normal pathname contains ";" but that should
     # okay in the real world where ";" in dirpaths is itself problematic.
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED -e 's/;/ /g'`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
   else
-    lt_search_path_spec=`echo "$lt_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
   fi
-  # Ok, now we have the path, separated by spaces, we can step through it
-  # and add multilib dir if necessary.
-  lt_tmp_lt_search_path_spec=
-  lt_multi_os_dir=`$CC $CPPFLAGS $CFLAGS $LDFLAGS -print-multi-os-directory 2>/dev/null`
-  for lt_sys_path in $lt_search_path_spec; do
-    if test -d "$lt_sys_path/$lt_multi_os_dir"; then
-      lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path/$lt_multi_os_dir"
-    else
-      test -d "$lt_sys_path" && \
-	lt_tmp_lt_search_path_spec="$lt_tmp_lt_search_path_spec $lt_sys_path"
-    fi
-  done
-  lt_search_path_spec=`echo $lt_tmp_lt_search_path_spec | awk '
-BEGIN {RS=" "; FS="/|\n";} {
-  lt_foo="";
-  lt_count=0;
-  for (lt_i = NF; lt_i > 0; lt_i--) {
-    if ($lt_i != "" && $lt_i != ".") {
-      if ($lt_i == "..") {
-        lt_count++;
-      } else {
-        if (lt_count == 0) {
-          lt_foo="/" $lt_i lt_foo;
-        } else {
-          lt_count--;
-        }
-      }
-    }
-  }
-  if (lt_foo != "") { lt_freq[lt_foo]++; }
-  if (lt_freq[lt_foo] == 1) { print lt_foo; }
-}'`
-  sys_lib_search_path_spec=`echo $lt_search_path_spec`
 else
   sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
 fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
@@ -9262,14 +8402,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
-  sys_lib_search_path_spec="$sys_lib_search_path_spec /usr/local/lib"
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -9317,13 +8461,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -9380,13 +8524,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -9451,13 +8595,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -9557,16 +8701,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -9653,23 +8793,23 @@
   ;;
 
 *)
   dynamic_linker=no
   ;;
 esac
-{ echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6; }
+echo "$as_me:$LINENO: result: $dynamic_linker" >&5
+echo "${ECHO_T}$dynamic_linker" >&6
 test "$dynamic_linker" = no && can_build_shared=no
 
 variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
 if test "$GCC" = yes; then
   variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
 fi
 
-{ echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
+echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action=
 if test -n "$hardcode_libdir_flag_spec" || \
    test -n "$runpath_var" || \
    test "X$hardcode_automatic" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
@@ -9687,50 +8827,49 @@
   fi
 else
   # We cannot hardcode anything, or else we can only hardcode existing
   # directories.
   hardcode_action=unsupported
 fi
-{ echo "$as_me:$LINENO: result: $hardcode_action" >&5
-echo "${ECHO_T}$hardcode_action" >&6; }
+echo "$as_me:$LINENO: result: $hardcode_action" >&5
+echo "${ECHO_T}$hardcode_action" >&6
 
 if test "$hardcode_action" = relink; then
   # Fast installation is not supported
   enable_fast_install=no
 elif test "$shlibpath_overrides_runpath" = yes ||
      test "$enable_shared" = no; then
   # Fast installation is not necessary
   enable_fast_install=needless
 fi
 
 striplib=
 old_striplib=
-{ echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
-echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
+echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6
 if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
   test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
   test -z "$striplib" && striplib="$STRIP --strip-unneeded"
-  { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+  echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
 else
 # FIXME - insert some real tests, host_os isn't really good enough
   case $host_os in
    darwin*)
        if test -n "$STRIP" ; then
          striplib="$STRIP -x"
-         old_striplib="$STRIP -S"
-         { echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6; }
+         echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
        else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
        ;;
    *)
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
     ;;
   esac
 fi
 
 if test "x$enable_dlopen" != xyes; then
   enable_dlopen=unknown
@@ -9756,73 +8895,75 @@
     lt_cv_dlopen="dlopen"
     lt_cv_dlopen_libs=
    ;;
 
   darwin*)
   # if libdl is installed we need to link against it
-    { echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6; }
+    echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
+echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
 if test "${ac_cv_lib_dl_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldl  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 int
 main ()
 {
-return dlopen ();
+dlopen ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dl_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dl_dlopen=no
+ac_cv_lib_dl_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
+echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
 if test $ac_cv_lib_dl_dlopen = yes; then
   lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
 else
 
     lt_cv_dlopen="dyld"
     lt_cv_dlopen_libs=
@@ -9830,14 +8971,14 @@
 
 fi
 
    ;;
 
   *)
-    { echo "$as_me:$LINENO: checking for shl_load" >&5
-echo $ECHO_N "checking for shl_load... $ECHO_C" >&6; }
+    echo "$as_me:$LINENO: checking for shl_load" >&5
+echo $ECHO_N "checking for shl_load... $ECHO_C" >&6
 if test "${ac_cv_func_shl_load+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -9858,134 +8999,144 @@
 #else
 # include <assert.h>
 #endif
 
 #undef shl_load
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char shl_load ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_shl_load || defined __stub___shl_load
+#if defined (__stub_shl_load) || defined (__stub___shl_load)
 choke me
+#else
+char (*f) () = shl_load;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return shl_load ();
+return f != shl_load;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_func_shl_load=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_func_shl_load=no
+ac_cv_func_shl_load=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
-echo "${ECHO_T}$ac_cv_func_shl_load" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
+echo "${ECHO_T}$ac_cv_func_shl_load" >&6
 if test $ac_cv_func_shl_load = yes; then
   lt_cv_dlopen="shl_load"
 else
-  { echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
-echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
+echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6
 if test "${ac_cv_lib_dld_shl_load+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char shl_load ();
 int
 main ()
 {
-return shl_load ();
+shl_load ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dld_shl_load=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dld_shl_load=no
+ac_cv_lib_dld_shl_load=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
+echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6
 if test $ac_cv_lib_dld_shl_load = yes; then
   lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"
 else
-  { echo "$as_me:$LINENO: checking for dlopen" >&5
-echo $ECHO_N "checking for dlopen... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dlopen" >&5
+echo $ECHO_N "checking for dlopen... $ECHO_C" >&6
 if test "${ac_cv_func_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -10006,257 +9157,271 @@
 #else
 # include <assert.h>
 #endif
 
 #undef dlopen
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_dlopen || defined __stub___dlopen
+#if defined (__stub_dlopen) || defined (__stub___dlopen)
 choke me
+#else
+char (*f) () = dlopen;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return dlopen ();
+return f != dlopen;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_func_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_func_dlopen=no
+ac_cv_func_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_func_dlopen" >&5
-echo "${ECHO_T}$ac_cv_func_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_func_dlopen" >&5
+echo "${ECHO_T}$ac_cv_func_dlopen" >&6
 if test $ac_cv_func_dlopen = yes; then
   lt_cv_dlopen="dlopen"
 else
-  { echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
+echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
 if test "${ac_cv_lib_dl_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldl  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 int
 main ()
 {
-return dlopen ();
+dlopen ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dl_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dl_dlopen=no
+ac_cv_lib_dl_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
+echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
 if test $ac_cv_lib_dl_dlopen = yes; then
   lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
 else
-  { echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
-echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
+echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6
 if test "${ac_cv_lib_svld_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-lsvld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 int
 main ()
 {
-return dlopen ();
+dlopen ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_svld_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_svld_dlopen=no
+ac_cv_lib_svld_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
+echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6
 if test $ac_cv_lib_svld_dlopen = yes; then
   lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"
 else
-  { echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
-echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
+echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6
 if test "${ac_cv_lib_dld_dld_link+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dld_link ();
 int
 main ()
 {
-return dld_link ();
+dld_link ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dld_dld_link=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dld_dld_link=no
+ac_cv_lib_dld_dld_link=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
+echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6
 if test $ac_cv_lib_dld_dld_link = yes; then
   lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"
 fi
 
 
 fi
@@ -10290,24 +9455,24 @@
     save_LDFLAGS="$LDFLAGS"
     wl=$lt_prog_compiler_wl eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
 
     save_LIBS="$LIBS"
     LIBS="$lt_cv_dlopen_libs $LIBS"
 
-    { echo "$as_me:$LINENO: checking whether a program can dlopen itself" >&5
-echo $ECHO_N "checking whether a program can dlopen itself... $ECHO_C" >&6; }
+    echo "$as_me:$LINENO: checking whether a program can dlopen itself" >&5
+echo $ECHO_N "checking whether a program can dlopen itself... $ECHO_C" >&6
 if test "${lt_cv_dlopen_self+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   	  if test "$cross_compiling" = yes; then :
   lt_cv_dlopen_self=cross
 else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 10307 "configure"
+#line 9472 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
 #include <dlfcn.h>
 #endif
 
@@ -10385,29 +9550,29 @@
   fi
 fi
 rm -fr conftest*
 
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_dlopen_self" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_dlopen_self" >&5
+echo "${ECHO_T}$lt_cv_dlopen_self" >&6
 
     if test "x$lt_cv_dlopen_self" = xyes; then
       wl=$lt_prog_compiler_wl eval LDFLAGS=\"\$LDFLAGS $lt_prog_compiler_static\"
-      { echo "$as_me:$LINENO: checking whether a statically linked program can dlopen itself" >&5
-echo $ECHO_N "checking whether a statically linked program can dlopen itself... $ECHO_C" >&6; }
+      echo "$as_me:$LINENO: checking whether a statically linked program can dlopen itself" >&5
+echo $ECHO_N "checking whether a statically linked program can dlopen itself... $ECHO_C" >&6
 if test "${lt_cv_dlopen_self_static+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   	  if test "$cross_compiling" = yes; then :
   lt_cv_dlopen_self_static=cross
 else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 10407 "configure"
+#line 9572 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
 #include <dlfcn.h>
 #endif
 
@@ -10485,14 +9650,14 @@
   fi
 fi
 rm -fr conftest*
 
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_dlopen_self_static" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self_static" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_dlopen_self_static" >&5
+echo "${ECHO_T}$lt_cv_dlopen_self_static" >&6
     fi
 
     CPPFLAGS="$save_CPPFLAGS"
     LDFLAGS="$save_LDFLAGS"
     LIBS="$save_LIBS"
     ;;
@@ -10508,19 +9673,19 @@
   *) enable_dlopen_self_static=unknown ;;
   esac
 fi
 
 
 # Report which library types will actually be built
-{ echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
-echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6; }
-{ echo "$as_me:$LINENO: result: $can_build_shared" >&5
-echo "${ECHO_T}$can_build_shared" >&6; }
+echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
+echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6
+echo "$as_me:$LINENO: result: $can_build_shared" >&5
+echo "${ECHO_T}$can_build_shared" >&6
 
-{ echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
-echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
+echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6
 test "$can_build_shared" = "no" && enable_shared=no
 
 # On AIX, shared libraries and static libraries use the same namespace, and
 # are all built from PIC.
 case $host_os in
 aix3*)
@@ -10534,21 +9699,21 @@
 aix4* | aix5*)
   if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
     test "$enable_shared" = yes && enable_static=no
   fi
     ;;
 esac
-{ echo "$as_me:$LINENO: result: $enable_shared" >&5
-echo "${ECHO_T}$enable_shared" >&6; }
+echo "$as_me:$LINENO: result: $enable_shared" >&5
+echo "${ECHO_T}$enable_shared" >&6
 
-{ echo "$as_me:$LINENO: checking whether to build static libraries" >&5
-echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether to build static libraries" >&5
+echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6
 # Make sure either enable_shared or enable_static is yes.
 test "$enable_shared" = yes || enable_static=yes
-{ echo "$as_me:$LINENO: result: $enable_static" >&5
-echo "${ECHO_T}$enable_static" >&6; }
+echo "$as_me:$LINENO: result: $enable_static" >&5
+echo "${ECHO_T}$enable_static" >&6
 
 # The else clause should only fire when bootstrapping the
 # libtool distribution, otherwise you forgot to ship ltmain.sh
 # with your package, and you will get complaints that there are
 # no rules to generate ltmain.sh.
 if test -f "$ltmain"; then
@@ -10599,13 +9764,12 @@
     hardcode_libdir_flag_spec_ld \
     hardcode_libdir_separator \
     hardcode_automatic \
     module_cmds \
     module_expsym_cmds \
     lt_cv_prog_compiler_c_o \
-    fix_srcfile_path \
     exclude_expsyms \
     include_expsyms; do
 
     case $var in
     old_archive_cmds | \
     old_archive_from_new_cmds | \
@@ -10644,13 +9808,13 @@
 #! $SHELL
 
 # `$echo "$cfgfile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
 # Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
 # NOTE: Changes made to this file will be lost: look at ltmain.sh.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
 # Free Software Foundation, Inc.
 #
 # This file is part of GNU Libtool:
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
@@ -10968,13 +10132,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds
@@ -11035,17 +10199,17 @@
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 CC="$lt_save_CC"
 
 
-# Check whether --with-tags was given.
+# Check whether --with-tags or --without-tags was given.
 if test "${with_tags+set}" = set; then
-  withval=$with_tags; tagnames="$withval"
-fi
-
+  withval="$with_tags"
+  tagnames="$withval"
+fi;
 
 if test -f "$ltmain" && test -n "$tagnames"; then
   if test ! -f "${ofile}"; then
     { echo "$as_me:$LINENO: WARNING: output file \`$ofile' does not exist" >&5
 echo "$as_me: WARNING: output file \`$ofile' does not exist" >&2;}
   fi
@@ -11093,13 +10257,13 @@
 
       case $tagname in
       CXX)
 	if test -n "$CXX" && ( test "X$CXX" != "Xno" &&
 	    ( (test "X$CXX" = "Xg++" && `g++ -v >/dev/null 2>&1` ) ||
 	    (test "X$CXX" != "Xg++"))) ; then
-	  ac_ext=cpp
+	  ac_ext=cc
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
 
 
@@ -11137,16 +10301,16 @@
 
 # Object file extension for compiled C++ test sources.
 objext=o
 objext_CXX=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;"
+lt_simple_compile_test_code="int some_variable = 0;\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='int main(int, char *[]) { return(0); }'
+lt_simple_link_test_code='int main(int, char *[]) { return(0); }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -11156,19 +10320,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -11212,24 +10376,24 @@
 fi
 
 if test "$GXX" = yes; then
   # Set up default GNU C++ configuration
 
 
-# Check whether --with-gnu-ld was given.
+# Check whether --with-gnu-ld or --without-gnu-ld was given.
 if test "${with_gnu_ld+set}" = set; then
-  withval=$with_gnu_ld; test "$withval" = no || with_gnu_ld=yes
+  withval="$with_gnu_ld"
+  test "$withval" = no || with_gnu_ld=yes
 else
   with_gnu_ld=no
-fi
-
+fi;
 ac_prog=ld
 if test "$GCC" = yes; then
   # Check if gcc -print-prog-name=ld gives a path.
-  { echo "$as_me:$LINENO: checking for ld used by $CC" >&5
-echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for ld used by $CC" >&5
+echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
     ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
   *)
     ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
@@ -11252,17 +10416,17 @@
   *)
     # If it is relative, then search for the first ld in PATH.
     with_gnu_ld=unknown
     ;;
   esac
 elif test "$with_gnu_ld" = yes; then
-  { echo "$as_me:$LINENO: checking for GNU ld" >&5
-echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for GNU ld" >&5
+echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6
 else
-  { echo "$as_me:$LINENO: checking for non-GNU ld" >&5
-echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for non-GNU ld" >&5
+echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6
 fi
 if test "${lt_cv_path_LD+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -z "$LD"; then
   lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
@@ -11289,23 +10453,23 @@
   lt_cv_path_LD="$LD" # Let the user override the test with a path.
 fi
 fi
 
 LD="$lt_cv_path_LD"
 if test -n "$LD"; then
-  { echo "$as_me:$LINENO: result: $LD" >&5
-echo "${ECHO_T}$LD" >&6; }
+  echo "$as_me:$LINENO: result: $LD" >&5
+echo "${ECHO_T}$LD" >&6
 else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
+  echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
 fi
 test -z "$LD" && { { echo "$as_me:$LINENO: error: no acceptable ld found in \$PATH" >&5
 echo "$as_me: error: no acceptable ld found in \$PATH" >&2;}
    { (exit 1); exit 1; }; }
-{ echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
-echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
+echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6
 if test "${lt_cv_prog_gnu_ld+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
 case `$LD -v 2>&1 </dev/null` in
 *GNU* | *'with BFD'*)
@@ -11313,14 +10477,14 @@
   ;;
 *)
   lt_cv_prog_gnu_ld=no
   ;;
 esac
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
-echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
+echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6
 with_gnu_ld=$lt_cv_prog_gnu_ld
 
 
 
   # Check if GNU C++ uses GNU ld as the underlying linker, since the
   # archiving commands below assume that GNU ld is being used.
@@ -11364,14 +10528,14 @@
   GXX=no
   with_gnu_ld=no
   wlarc=
 fi
 
 # PORTME: fill in a description of your system's C++ link characteristics
-{ echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
+echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
 ld_shlibs_CXX=yes
 case $host_os in
   aix3*)
     # FIXME: insert proper C++ library support
     ld_shlibs_CXX=no
     ;;
@@ -11421,13 +10585,13 @@
       # below for broken collect2 doesn't work under 4.3+
 	collect2name=`${CC} -print-prog-name=collect2`
 	if test -f "$collect2name" && \
 	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	then
 	  # We have reworked collect2
-	  :
+	  hardcode_direct_CXX=yes
 	else
 	  # We have old collect2
 	  hardcode_direct_CXX=unsupported
 	  # It fails to find uninstalled libraries when the uninstalled
 	  # path is not listed in the libpath.  Setting hardcode_minus_L
 	  # to unsupported forces relinking
@@ -11477,50 +10641,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
       hardcode_libdir_flag_spec_CXX='${wl}-blibpath:$libdir:'"$aix_libpath"
 
       archive_expsym_cmds_CXX="\$CC"' -o $output_objdir/$soname $libobjs $deplibs '"\${wl}$no_entry_flag"' $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$exp_sym_flag:\$export_symbols $shared_flag"
@@ -11544,50 +10702,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_cxx_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
 	hardcode_libdir_flag_spec_CXX='${wl}-blibpath:$libdir:'"$aix_libpath"
 	# Warning - without using the other run time loading flags,
 	# -berok will link without error, but may produce a broken library.
@@ -11692,16 +10844,16 @@
           fi
             module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+          archive_cmds_CXX='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
           module_cmds_CXX='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-          archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+          archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_CXX=no
           ;;
       esac
@@ -11778,13 +10930,15 @@
   hpux10*|hpux11*)
     if test $with_gnu_ld = no; then
       hardcode_libdir_flag_spec_CXX='${wl}+b ${wl}$libdir'
       hardcode_libdir_separator_CXX=:
 
       case $host_cpu in
-      hppa*64*|ia64*) ;;
+      hppa*64*|ia64*)
+	hardcode_libdir_flag_spec_ld_CXX='+b $libdir'
+        ;;
       *)
 	export_dynamic_flag_spec_CXX='${wl}-E'
         ;;
       esac
     fi
     case $host_cpu in
@@ -11846,13 +11000,13 @@
 	  # FIXME: insert proper C++ library support
 	  ld_shlibs_CXX=no
 	fi
 	;;
     esac
     ;;
-  interix[3-9]*)
+  interix3*)
     hardcode_direct_CXX=no
     hardcode_shlibpath_var_CXX=no
     hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
     export_dynamic_flag_spec_CXX='${wl}-E'
     # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
     # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -11966,35 +11120,12 @@
 	# There doesn't appear to be a way to prevent this compiler from
 	# explicitly linking system object files so we need to strip them
 	# from the output so that they don't get included in the library
 	# dependencies.
 	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
 	;;
-      *)
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C++ 5.9
-	  no_undefined_flag_CXX=' -zdefs'
-	  archive_cmds_CXX='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	  archive_expsym_cmds_CXX='$CC -G${allow_undefined_flag} -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file ${wl}$export_symbols'
-	  hardcode_libdir_flag_spec_CXX='-R$libdir'
-	  whole_archive_flag_spec_CXX='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-
-	  # Not sure whether something based on
-	  # $CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1
-	  # would be better.
-	  output_verbose_link_cmd='echo'
-
-	  # Archives containing C++ object files must be created using
-	  # "CC -xar", where "CC" is the Sun C++ compiler.  This is
-	  # necessary to make sure instantiated templates are included
-	  # in the archive.
-	  old_archive_cmds_CXX='$CC -xar -o $oldlib $oldobjs'
-	  ;;
-	esac
-	;;
     esac
     ;;
   lynxos*)
     # FIXME: insert proper C++ library support
     ld_shlibs_CXX=no
     ;;
@@ -12027,26 +11158,22 @@
     ;;
   openbsd2*)
     # C++ shared libraries are fairly broken
     ld_shlibs_CXX=no
     ;;
   openbsd*)
-    if test -f /usr/libexec/ld.so; then
-      hardcode_direct_CXX=yes
-      hardcode_shlibpath_var_CXX=no
-      archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-      hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
-	export_dynamic_flag_spec_CXX='${wl}-E'
-	whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      fi
-      output_verbose_link_cmd='echo'
-    else
-      ld_shlibs_CXX=no
+    hardcode_direct_CXX=yes
+    hardcode_shlibpath_var_CXX=no
+    archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
+      export_dynamic_flag_spec_CXX='${wl}-E'
+      whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     fi
+    output_verbose_link_cmd='echo'
     ;;
   osf3*)
     case $cc_basename in
       KCC*)
 	# Kuck and Associates, Inc. (KAI) C++ Compiler
 
@@ -12202,16 +11329,21 @@
 
 	hardcode_libdir_flag_spec_CXX='-R$libdir'
 	hardcode_shlibpath_var_CXX=no
 	case $host_os in
 	  solaris2.[0-5] | solaris2.[0-5].*) ;;
 	  *)
-	    # The compiler driver will combine and reorder linker options,
-	    # but understands `-z linker_flag'.
+	    # The C++ compiler is used as linker so we must use $wl
+	    # flag to pass the commands to the underlying system
+	    # linker. We must also pass each convience library through
+	    # to the system linker between allextract/defaultextract.
+	    # The C++ compiler will combine linker options so we
+	    # cannot just pass the convience library names through
+	    # without $wl.
 	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    whole_archive_flag_spec_CXX='-z allextract$convenience -z defaultextract'
+	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract'
 	    ;;
 	esac
 	link_all_deplibs_CXX=yes
 
 	output_verbose_link_cmd='echo'
 
@@ -12252,18 +11384,12 @@
 	    # what "hidden" libraries, object files and flags are used when
 	    # linking a shared library.
 	    output_verbose_link_cmd="$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
 	  fi
 
 	  hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
-	  case $host_os in
-	  solaris2.[0-5] | solaris2.[0-5].*) ;;
-	  *)
-	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	    ;;
-	  esac
 	fi
 	;;
     esac
     ;;
   sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
     no_undefined_flag_CXX='${wl}-z,text'
@@ -12338,14 +11464,14 @@
     ;;
   *)
     # FIXME: insert proper C++ library support
     ld_shlibs_CXX=no
     ;;
 esac
-{ echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
-echo "${ECHO_T}$ld_shlibs_CXX" >&6; }
+echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
+echo "${ECHO_T}$ld_shlibs_CXX" >&6
 test "$ld_shlibs_CXX" = no && can_build_shared=no
 
 GCC_CXX="$GXX"
 LD_CXX="$LD"
 
 ## CAVEAT EMPTOR:
@@ -12453,60 +11579,27 @@
 fi
 
 $rm -f confest.$objext
 
 # PORTME: override above test on systems where it is broken
 case $host_os in
-interix[3-9]*)
+interix3*)
   # Interix 3.5 installs completely hosed .la files for C++, so rather than
   # hack all around it, let's just trust "g++" to DTRT.
   predep_objects_CXX=
   postdep_objects_CXX=
   postdeps_CXX=
   ;;
 
-linux*)
-  case `$CC -V 2>&1 | sed 5q` in
-  *Sun\ C*)
-    # Sun C++ 5.9
-    #
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-    if test "$solaris_use_stlport4" != yes; then
-      postdeps_CXX='-library=Cstd -library=Crun'
-    fi
-    ;;
-  esac
-  ;;
-
 solaris*)
   case $cc_basename in
   CC*)
-    # The more standards-conforming stlport4 library is
-    # incompatible with the Cstd library. Avoid specifying
-    # it if it's in CXXFLAGS. Ignore libCrun as
-    # -library=stlport4 depends on it.
-    case " $CXX $CXXFLAGS " in
-    *" -library=stlport4 "*)
-      solaris_use_stlport4=yes
-      ;;
-    esac
-
     # Adding this requires a known-good setup of shared libraries for
     # Sun compiler versions before 5.6, else PIC objects from an old
     # archive will be linked into the output, leading to subtle bugs.
-    if test "$solaris_use_stlport4" != yes; then
-      postdeps_CXX='-library=Cstd -library=Crun'
-    fi
+    postdeps_CXX='-lCstd -lCrun'
     ;;
   esac
   ;;
 esac
 
 
@@ -12515,14 +11608,14 @@
 esac
 
 lt_prog_compiler_wl_CXX=
 lt_prog_compiler_pic_CXX=
 lt_prog_compiler_static_CXX=
 
-{ echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
+echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
 
   # C++ specific cases for pic, static, wl, etc.
   if test "$GXX" = yes; then
     lt_prog_compiler_wl_CXX='-Wl,'
     lt_prog_compiler_static_CXX='-static'
 
@@ -12537,32 +11630,30 @@
     amigaos*)
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_CXX='-m68020 -resident32 -malways-restore-a4'
       ;;
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
-    mingw* | cygwin* | os2* | pw32*)
+    mingw* | os2* | pw32*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_CXX='-DDLL_EXPORT'
       ;;
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_CXX='-fno-common'
       ;;
     *djgpp*)
       # DJGPP does not support shared libraries at all
       lt_prog_compiler_pic_CXX=
       ;;
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
     sysv4*MP*)
       if test -d /usr/nec; then
 	lt_prog_compiler_pic_CXX=-Kconform_pic
@@ -12692,20 +11783,12 @@
 	    # Make sure the PIC flag is empty.  It appears that all Alpha
 	    # Linux and Compaq Tru64 Unix objects are PIC.
 	    lt_prog_compiler_pic_CXX=
 	    lt_prog_compiler_static_CXX='-non_shared'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
-	    *Sun\ C*)
-	      # Sun C++ 5.9
-	      lt_prog_compiler_pic_CXX='-KPIC'
-	      lt_prog_compiler_static_CXX='-Bstatic'
-	      lt_prog_compiler_wl_CXX='-Qoption ld '
-	      ;;
-	    esac
 	    ;;
 	esac
 	;;
       lynxos*)
 	;;
       m88k*)
@@ -12799,57 +11882,57 @@
       *)
 	lt_prog_compiler_can_build_shared_CXX=no
 	;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_CXX" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_CXX" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_CXX" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_CXX" >&6
 
 #
 # Check to make sure the PIC flag actually works.
 #
 if test -n "$lt_prog_compiler_pic_CXX"; then
 
-{ echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works" >&5
+echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works... $ECHO_C" >&6
 if test "${lt_prog_compiler_pic_works_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_CXX=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_CXX -DPIC"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:12831: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:11914: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:12835: \$? = $ac_status" >&5
+   echo "$as_me:11918: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_CXX=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_CXX" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_CXX" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_CXX" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_works_CXX" >&6
 
 if test x"$lt_prog_compiler_pic_works_CXX" = xyes; then
     case $lt_prog_compiler_pic_CXX in
      "" | " "*) ;;
      *) lt_prog_compiler_pic_CXX=" $lt_prog_compiler_pic_CXX" ;;
      esac
@@ -12870,21 +11953,21 @@
 esac
 
 #
 # Check to make sure the static flag actually works.
 #
 wl=$lt_prog_compiler_wl_CXX eval lt_tmp_static_flag=\"$lt_prog_compiler_static_CXX\"
-{ echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
-echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
+echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6
 if test "${lt_prog_compiler_static_works_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_CXX=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -12898,48 +11981,48 @@
      fi
    fi
    $rm conftest*
    LDFLAGS="$save_LDFLAGS"
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_CXX" >&5
-echo "${ECHO_T}$lt_prog_compiler_static_works_CXX" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_CXX" >&5
+echo "${ECHO_T}$lt_prog_compiler_static_works_CXX" >&6
 
 if test x"$lt_prog_compiler_static_works_CXX" = xyes; then
     :
 else
     lt_prog_compiler_static_CXX=
 fi
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
+echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_c_o_CXX+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_c_o_CXX=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:12935: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:12018: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:12939: \$? = $ac_status" >&5
+   echo "$as_me:12022: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -12955,40 +12038,40 @@
    $rm out/* && rmdir out
    cd ..
    rmdir conftest
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_CXX" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_CXX" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_CXX" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_c_o_CXX" >&6
 
 
 hard_links="nottested"
 if test "$lt_cv_prog_compiler_c_o_CXX" = no && test "$need_locks" != no; then
   # do not overwrite the value of need_locks provided by the user
-  { echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
+echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
   hard_links=yes
   $rm conftest*
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
   touch conftest.a
   ln conftest.a conftest.b 2>&5 || hard_links=no
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  { echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6; }
+  echo "$as_me:$LINENO: result: $hard_links" >&5
+echo "${ECHO_T}$hard_links" >&6
   if test "$hard_links" = no; then
     { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
 echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
     need_locks=warn
   fi
 else
   need_locks=no
 fi
 
-{ echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
+echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
 
   export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix4* | aix5*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
@@ -12999,24 +12082,24 @@
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/;/^.* __nm__/s/^.* __nm__\([^ ]*\) [^ ]*/\1 DATA/;/^I /d;/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   linux* | k*bsd*-gnu)
     link_all_deplibs_CXX=no
   ;;
   *)
     export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
 
-{ echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
-echo "${ECHO_T}$ld_shlibs_CXX" >&6; }
+echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
+echo "${ECHO_T}$ld_shlibs_CXX" >&6
 test "$ld_shlibs_CXX" = no && can_build_shared=no
 
 #
 # Do we need to explicitly link libc?
 #
 case "x$archive_cmds_need_lc_CXX" in
@@ -13030,16 +12113,16 @@
       # FIXME: we may have to deal with multi-command sequences.
       ;;
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
-      { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
+      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
+echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -13068,22 +12151,22 @@
         fi
         allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
       else
         cat conftest.err 1>&5
       fi
       $rm conftest*
-      { echo "$as_me:$LINENO: result: $archive_cmds_need_lc_CXX" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_CXX" >&6; }
+      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_CXX" >&5
+echo "${ECHO_T}$archive_cmds_need_lc_CXX" >&6
       ;;
     esac
   fi
   ;;
 esac
 
-{ echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
+echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -13091,13 +12174,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -13248,13 +12344,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -13302,13 +12403,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -13365,13 +12466,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -13436,13 +12537,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -13542,16 +12643,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -13638,23 +12735,23 @@
   ;;
 
 *)
   dynamic_linker=no
   ;;
 esac
-{ echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6; }
+echo "$as_me:$LINENO: result: $dynamic_linker" >&5
+echo "${ECHO_T}$dynamic_linker" >&6
 test "$dynamic_linker" = no && can_build_shared=no
 
 variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
 if test "$GCC" = yes; then
   variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
 fi
 
-{ echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
+echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_CXX=
 if test -n "$hardcode_libdir_flag_spec_CXX" || \
    test -n "$runpath_var_CXX" || \
    test "X$hardcode_automatic_CXX" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
@@ -13672,14 +12769,14 @@
   fi
 else
   # We cannot hardcode anything, or else we can only hardcode existing
   # directories.
   hardcode_action_CXX=unsupported
 fi
-{ echo "$as_me:$LINENO: result: $hardcode_action_CXX" >&5
-echo "${ECHO_T}$hardcode_action_CXX" >&6; }
+echo "$as_me:$LINENO: result: $hardcode_action_CXX" >&5
+echo "${ECHO_T}$hardcode_action_CXX" >&6
 
 if test "$hardcode_action_CXX" = relink; then
   # Fast installation is not supported
   enable_fast_install=no
 elif test "$shlibpath_overrides_runpath" = yes ||
      test "$enable_shared" = no; then
@@ -13740,13 +12837,12 @@
     hardcode_libdir_flag_spec_ld_CXX \
     hardcode_libdir_separator_CXX \
     hardcode_automatic_CXX \
     module_cmds_CXX \
     module_expsym_cmds_CXX \
     lt_cv_prog_compiler_c_o_CXX \
-    fix_srcfile_path_CXX \
     exclude_expsyms_CXX \
     include_expsyms_CXX; do
 
     case $var in
     old_archive_cmds_CXX | \
     old_archive_from_new_cmds_CXX | \
@@ -14061,13 +13157,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_CXX"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_CXX
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_CXX
@@ -14152,23 +13248,16 @@
 
 # Object file extension for compiled f77 test sources.
 objext=o
 objext_F77=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="\
-      subroutine t
-      return
-      end
-"
+lt_simple_compile_test_code="      subroutine t\n      return\n      end\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code="\
-      program t
-      end
-"
+lt_simple_link_test_code="      program t\n      end\n"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -14178,19 +13267,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -14206,19 +13295,19 @@
     *) break;;
   esac
 done
 cc_basename=`$echo "X$cc_temp" | $Xsed -e 's%.*/%%' -e "s%^$host_alias-%%"`
 
 
-{ echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
-echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6; }
-{ echo "$as_me:$LINENO: result: $can_build_shared" >&5
-echo "${ECHO_T}$can_build_shared" >&6; }
+echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
+echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6
+echo "$as_me:$LINENO: result: $can_build_shared" >&5
+echo "${ECHO_T}$can_build_shared" >&6
 
-{ echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
-echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
+echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6
 test "$can_build_shared" = "no" && enable_shared=no
 
 # On AIX, shared libraries and static libraries use the same namespace, and
 # are all built from PIC.
 case $host_os in
 aix3*)
@@ -14231,31 +13320,31 @@
 aix4* | aix5*)
   if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
     test "$enable_shared" = yes && enable_static=no
   fi
   ;;
 esac
-{ echo "$as_me:$LINENO: result: $enable_shared" >&5
-echo "${ECHO_T}$enable_shared" >&6; }
+echo "$as_me:$LINENO: result: $enable_shared" >&5
+echo "${ECHO_T}$enable_shared" >&6
 
-{ echo "$as_me:$LINENO: checking whether to build static libraries" >&5
-echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether to build static libraries" >&5
+echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6
 # Make sure either enable_shared or enable_static is yes.
 test "$enable_shared" = yes || enable_static=yes
-{ echo "$as_me:$LINENO: result: $enable_static" >&5
-echo "${ECHO_T}$enable_static" >&6; }
+echo "$as_me:$LINENO: result: $enable_static" >&5
+echo "${ECHO_T}$enable_static" >&6
 
 GCC_F77="$G77"
 LD_F77="$LD"
 
 lt_prog_compiler_wl_F77=
 lt_prog_compiler_pic_F77=
 lt_prog_compiler_static_F77=
 
-{ echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
+echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
 
   if test "$GCC" = yes; then
     lt_prog_compiler_wl_F77='-Wl,'
     lt_prog_compiler_static_F77='-static'
 
     case $host_os in
@@ -14271,31 +13360,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_F77='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_F77='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_F77='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -14347,13 +13434,13 @@
          lt_prog_compiler_pic_F77='-qnocommon'
          lt_prog_compiler_wl_F77='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic_F77='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -14399,41 +13486,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl_F77='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static_F77='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic_F77='-KPIC'
-	  lt_prog_compiler_static_F77='-Bstatic'
-	  lt_prog_compiler_wl_F77='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic_F77='-KPIC'
-	  lt_prog_compiler_static_F77='-Bstatic'
-	  lt_prog_compiler_wl_F77=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl_F77='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static_F77='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static_F77='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic_F77='-KPIC'
       lt_prog_compiler_static_F77='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl_F77='-Qoption ld ';;
@@ -14480,57 +13547,57 @@
     *)
       lt_prog_compiler_can_build_shared_F77=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_F77" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_F77" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_F77" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_F77" >&6
 
 #
 # Check to make sure the PIC flag actually works.
 #
 if test -n "$lt_prog_compiler_pic_F77"; then
 
-{ echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works" >&5
+echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works... $ECHO_C" >&6
 if test "${lt_prog_compiler_pic_works_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_F77=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_F77"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14512: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13579: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:14516: \$? = $ac_status" >&5
+   echo "$as_me:13583: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_F77=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_F77" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_F77" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_F77" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_works_F77" >&6
 
 if test x"$lt_prog_compiler_pic_works_F77" = xyes; then
     case $lt_prog_compiler_pic_F77 in
      "" | " "*) ;;
      *) lt_prog_compiler_pic_F77=" $lt_prog_compiler_pic_F77" ;;
      esac
@@ -14551,21 +13618,21 @@
 esac
 
 #
 # Check to make sure the static flag actually works.
 #
 wl=$lt_prog_compiler_wl_F77 eval lt_tmp_static_flag=\"$lt_prog_compiler_static_F77\"
-{ echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
-echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
+echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6
 if test "${lt_prog_compiler_static_works_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_F77=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -14579,48 +13646,48 @@
      fi
    fi
    $rm conftest*
    LDFLAGS="$save_LDFLAGS"
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_F77" >&5
-echo "${ECHO_T}$lt_prog_compiler_static_works_F77" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_F77" >&5
+echo "${ECHO_T}$lt_prog_compiler_static_works_F77" >&6
 
 if test x"$lt_prog_compiler_static_works_F77" = xyes; then
     :
 else
     lt_prog_compiler_static_F77=
 fi
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
+echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_c_o_F77+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_c_o_F77=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14616: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:13683: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:14620: \$? = $ac_status" >&5
+   echo "$as_me:13687: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -14636,40 +13703,40 @@
    $rm out/* && rmdir out
    cd ..
    rmdir conftest
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_F77" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_F77" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_F77" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_c_o_F77" >&6
 
 
 hard_links="nottested"
 if test "$lt_cv_prog_compiler_c_o_F77" = no && test "$need_locks" != no; then
   # do not overwrite the value of need_locks provided by the user
-  { echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
+echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
   hard_links=yes
   $rm conftest*
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
   touch conftest.a
   ln conftest.a conftest.b 2>&5 || hard_links=no
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  { echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6; }
+  echo "$as_me:$LINENO: result: $hard_links" >&5
+echo "${ECHO_T}$hard_links" >&6
   if test "$hard_links" = no; then
     { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
 echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
     need_locks=warn
   fi
 else
   need_locks=no
 fi
 
-{ echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
+echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
 
   runpath_var=
   allow_undefined_flag_F77=
   enable_shared_with_static_runtimes_F77=no
   archive_cmds_F77=
   archive_expsym_cmds_F77=
@@ -14806,13 +13873,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, F77) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec_F77='-L$libdir'
       allow_undefined_flag_F77=unsupported
       always_export_symbols_F77=no
       enable_shared_with_static_runtimes_F77=yes
-      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds_F77='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -14824,13 +13891,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs_F77=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct_F77=no
       hardcode_shlibpath_var_F77=no
       hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
       export_dynamic_flag_spec_F77='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -14839,13 +13906,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds_F77='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds_F77='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec_F77='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -14857,28 +13924,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec_F77='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds_F77='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_F77='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds_F77='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs_F77=no
       else
 	ld_shlibs_F77=no
       fi
       ;;
@@ -15032,13 +14090,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct_F77=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct_F77=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -15078,50 +14136,44 @@
        cat >conftest.$ac_ext <<_ACEOF
       program main
 
       end
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_f77_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
        hardcode_libdir_flag_spec_F77='${wl}-blibpath:$libdir:'"$aix_libpath"
 	archive_expsym_cmds_F77="\$CC"' -o $output_objdir/$soname $libobjs $deplibs '"\${wl}$no_entry_flag"' $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$exp_sym_flag:\$export_symbols $shared_flag"
        else
@@ -15134,50 +14186,44 @@
 	 cat >conftest.$ac_ext <<_ACEOF
       program main
 
       end
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_f77_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
 	 hardcode_libdir_flag_spec_F77='${wl}-blibpath:$libdir:'"$aix_libpath"
 	  # Warning - without using the other run time loading flags,
 	  # -berok will link without error, but may produce a broken library.
@@ -15217,13 +14263,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds_F77='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds_F77='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_F77='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds_F77='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path_F77='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_F77=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -15259,16 +14305,16 @@
       archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds_F77='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds_F77='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_F77=no
           ;;
       esac
@@ -15424,34 +14470,30 @@
       hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator_F77=:
       hardcode_shlibpath_var_F77=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct_F77=yes
-	hardcode_shlibpath_var_F77=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec_F77='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec_F77='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct_F77=yes
+      hardcode_shlibpath_var_F77=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec_F77='${wl}-E'
       else
-	ld_shlibs_F77=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec_F77='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec_F77='-L$libdir'
       hardcode_minus_L_F77=yes
@@ -15504,22 +14546,23 @@
       fi
       hardcode_libdir_flag_spec_F77='-R$libdir'
       hardcode_shlibpath_var_F77=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_F77='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_F77=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -15570,13 +14613,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs_F77=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag_F77='${wl}-z,text'
       archive_cmds_need_lc_F77=no
       hardcode_shlibpath_var_F77=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -15623,14 +14666,14 @@
     *)
       ld_shlibs_F77=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $ld_shlibs_F77" >&5
-echo "${ECHO_T}$ld_shlibs_F77" >&6; }
+echo "$as_me:$LINENO: result: $ld_shlibs_F77" >&5
+echo "${ECHO_T}$ld_shlibs_F77" >&6
 test "$ld_shlibs_F77" = no && can_build_shared=no
 
 #
 # Do we need to explicitly link libc?
 #
 case "x$archive_cmds_need_lc_F77" in
@@ -15644,16 +14687,16 @@
       # FIXME: we may have to deal with multi-command sequences.
       ;;
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
-      { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
+      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
+echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -15682,22 +14725,22 @@
         fi
         allow_undefined_flag_F77=$lt_save_allow_undefined_flag
       else
         cat conftest.err 1>&5
       fi
       $rm conftest*
-      { echo "$as_me:$LINENO: result: $archive_cmds_need_lc_F77" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_F77" >&6; }
+      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_F77" >&5
+echo "${ECHO_T}$archive_cmds_need_lc_F77" >&6
       ;;
     esac
   fi
   ;;
 esac
 
-{ echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
+echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -15705,13 +14748,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -15862,13 +14918,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -15916,13 +14977,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -15979,13 +15040,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -16050,13 +15111,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -16156,16 +15217,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -16252,23 +15309,23 @@
   ;;
 
 *)
   dynamic_linker=no
   ;;
 esac
-{ echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6; }
+echo "$as_me:$LINENO: result: $dynamic_linker" >&5
+echo "${ECHO_T}$dynamic_linker" >&6
 test "$dynamic_linker" = no && can_build_shared=no
 
 variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
 if test "$GCC" = yes; then
   variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
 fi
 
-{ echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
+echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_F77=
 if test -n "$hardcode_libdir_flag_spec_F77" || \
    test -n "$runpath_var_F77" || \
    test "X$hardcode_automatic_F77" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
@@ -16286,14 +15343,14 @@
   fi
 else
   # We cannot hardcode anything, or else we can only hardcode existing
   # directories.
   hardcode_action_F77=unsupported
 fi
-{ echo "$as_me:$LINENO: result: $hardcode_action_F77" >&5
-echo "${ECHO_T}$hardcode_action_F77" >&6; }
+echo "$as_me:$LINENO: result: $hardcode_action_F77" >&5
+echo "${ECHO_T}$hardcode_action_F77" >&6
 
 if test "$hardcode_action_F77" = relink; then
   # Fast installation is not supported
   enable_fast_install=no
 elif test "$shlibpath_overrides_runpath" = yes ||
      test "$enable_shared" = no; then
@@ -16354,13 +15411,12 @@
     hardcode_libdir_flag_spec_ld_F77 \
     hardcode_libdir_separator_F77 \
     hardcode_automatic_F77 \
     module_cmds_F77 \
     module_expsym_cmds_F77 \
     lt_cv_prog_compiler_c_o_F77 \
-    fix_srcfile_path_F77 \
     exclude_expsyms_F77 \
     include_expsyms_F77; do
 
     case $var in
     old_archive_cmds_F77 | \
     old_archive_from_new_cmds_F77 | \
@@ -16675,13 +15731,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_F77"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_F77
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_F77
@@ -16733,16 +15790,16 @@
 
 # Object file extension for compiled Java test sources.
 objext=o
 objext_GCJ=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code="class foo {}"
+lt_simple_compile_test_code="class foo {}\n"
 
 # Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }'
+lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\n'
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
 # If no C compiler was specified, use CC.
 LTCC=${LTCC-"$CC"}
 
@@ -16752,19 +15809,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -16796,49 +15853,49 @@
 lt_prog_compiler_no_builtin_flag_GCJ=
 
 if test "$GCC" = yes; then
   lt_prog_compiler_no_builtin_flag_GCJ=' -fno-builtin'
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
-echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
+echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_rtti_exceptions=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="-fno-rtti -fno-exceptions"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16820: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:15877: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16824: \$? = $ac_status" >&5
+   echo "$as_me:15881: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6
 
 if test x"$lt_cv_prog_compiler_rtti_exceptions" = xyes; then
     lt_prog_compiler_no_builtin_flag_GCJ="$lt_prog_compiler_no_builtin_flag_GCJ -fno-rtti -fno-exceptions"
 else
     :
 fi
@@ -16846,14 +15903,14 @@
 fi
 
 lt_prog_compiler_wl_GCJ=
 lt_prog_compiler_pic_GCJ=
 lt_prog_compiler_static_GCJ=
 
-{ echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
+echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
 
   if test "$GCC" = yes; then
     lt_prog_compiler_wl_GCJ='-Wl,'
     lt_prog_compiler_static_GCJ='-static'
 
     case $host_os in
@@ -16869,31 +15926,29 @@
       # FIXME: we need at least 68020 code to build shared libraries, but
       # adding the `-m68020' flag to GCC prevents building anything better,
       # like `-m68040'.
       lt_prog_compiler_pic_GCJ='-m68020 -resident32 -malways-restore-a4'
       ;;
 
-    beos* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
+    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
       # PIC is the default for these OSes.
       ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
-      # Although the cygwin gcc ignores -fPIC, still need this for old-style
-      # (--disable-auto-import) libraries
       lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
       ;;
 
     darwin* | rhapsody*)
       # PIC is the default on this platform
       # Common symbols not allowed in MH_DYLIB files
       lt_prog_compiler_pic_GCJ='-fno-common'
       ;;
 
-    interix[3-9]*)
+    interix3*)
       # Interix 3.x gcc -fpic/-fPIC options generate broken code.
       # Instead, we relocate shared libraries at runtime.
       ;;
 
     msdosdjgpp*)
       # Just because we use GCC doesn't mean we suddenly get shared libraries
@@ -16945,13 +16000,13 @@
          lt_prog_compiler_pic_GCJ='-qnocommon'
          lt_prog_compiler_wl_GCJ='-Wl,'
          ;;
        esac
        ;;
 
-    mingw* | cygwin* | pw32* | os2*)
+    mingw* | pw32* | os2*)
       # This hack is so that the source file can tell whether it is being
       # built for inclusion in a dll (and should export symbols for example).
       lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
       ;;
 
     hpux9* | hpux10* | hpux11*)
@@ -16997,41 +16052,21 @@
         ;;
       ccc*)
         lt_prog_compiler_wl_GCJ='-Wl,'
         # All Alpha code is PIC.
         lt_prog_compiler_static_GCJ='-non_shared'
         ;;
-      *)
-        case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)
-	  # Sun C 5.9
-	  lt_prog_compiler_pic_GCJ='-KPIC'
-	  lt_prog_compiler_static_GCJ='-Bstatic'
-	  lt_prog_compiler_wl_GCJ='-Wl,'
-	  ;;
-	*Sun\ F*)
-	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
-	  lt_prog_compiler_pic_GCJ='-KPIC'
-	  lt_prog_compiler_static_GCJ='-Bstatic'
-	  lt_prog_compiler_wl_GCJ=''
-	  ;;
-	esac
-	;;
       esac
       ;;
 
     osf3* | osf4* | osf5*)
       lt_prog_compiler_wl_GCJ='-Wl,'
       # All OSF/1 code is PIC.
       lt_prog_compiler_static_GCJ='-non_shared'
       ;;
 
-    rdos*)
-      lt_prog_compiler_static_GCJ='-non_shared'
-      ;;
-
     solaris*)
       lt_prog_compiler_pic_GCJ='-KPIC'
       lt_prog_compiler_static_GCJ='-Bstatic'
       case $cc_basename in
       f77* | f90* | f95*)
 	lt_prog_compiler_wl_GCJ='-Qoption ld ';;
@@ -17078,57 +16113,57 @@
     *)
       lt_prog_compiler_can_build_shared_GCJ=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_GCJ" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_GCJ" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_GCJ" >&6
 
 #
 # Check to make sure the PIC flag actually works.
 #
 if test -n "$lt_prog_compiler_pic_GCJ"; then
 
-{ echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works" >&5
+echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works... $ECHO_C" >&6
 if test "${lt_prog_compiler_pic_works_GCJ+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_pic_works_GCJ=no
   ac_outfile=conftest.$ac_objext
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
    lt_compiler_flag="$lt_prog_compiler_pic_GCJ"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:17110: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16145: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:17114: \$? = $ac_status" >&5
+   echo "$as_me:16149: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' >conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_prog_compiler_pic_works_GCJ=yes
      fi
    fi
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_GCJ" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_GCJ" >&5
+echo "${ECHO_T}$lt_prog_compiler_pic_works_GCJ" >&6
 
 if test x"$lt_prog_compiler_pic_works_GCJ" = xyes; then
     case $lt_prog_compiler_pic_GCJ in
      "" | " "*) ;;
      *) lt_prog_compiler_pic_GCJ=" $lt_prog_compiler_pic_GCJ" ;;
      esac
@@ -17149,21 +16184,21 @@
 esac
 
 #
 # Check to make sure the static flag actually works.
 #
 wl=$lt_prog_compiler_wl_GCJ eval lt_tmp_static_flag=\"$lt_prog_compiler_static_GCJ\"
-{ echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
-echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler static flag $lt_tmp_static_flag works" >&5
+echo $ECHO_N "checking if $compiler static flag $lt_tmp_static_flag works... $ECHO_C" >&6
 if test "${lt_prog_compiler_static_works_GCJ+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_prog_compiler_static_works_GCJ=no
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
-   echo "$lt_simple_link_test_code" > conftest.$ac_ext
+   printf "$lt_simple_link_test_code" > conftest.$ac_ext
    if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
        cat conftest.err 1>&5
@@ -17177,48 +16212,48 @@
      fi
    fi
    $rm conftest*
    LDFLAGS="$save_LDFLAGS"
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_GCJ" >&5
-echo "${ECHO_T}$lt_prog_compiler_static_works_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works_GCJ" >&5
+echo "${ECHO_T}$lt_prog_compiler_static_works_GCJ" >&6
 
 if test x"$lt_prog_compiler_static_works_GCJ" = xyes; then
     :
 else
     lt_prog_compiler_static_GCJ=
 fi
 
 
-{ echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
+echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
 if test "${lt_cv_prog_compiler_c_o_GCJ+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   lt_cv_prog_compiler_c_o_GCJ=no
    $rm -r conftest 2>/dev/null
    mkdir conftest
    cd conftest
    mkdir out
-   echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
    lt_compiler_flag="-o out/conftest2.$ac_objext"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
    # Note that $ac_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    lt_compile=`echo "$ac_compile" | $SED \
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:17214: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16249: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:17218: \$? = $ac_status" >&5
+   echo "$as_me:16253: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $echo "X$_lt_compiler_boilerplate" | $Xsed -e '/^$/d' > out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
@@ -17234,40 +16269,40 @@
    $rm out/* && rmdir out
    cd ..
    rmdir conftest
    $rm conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_GCJ" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_GCJ" >&5
+echo "${ECHO_T}$lt_cv_prog_compiler_c_o_GCJ" >&6
 
 
 hard_links="nottested"
 if test "$lt_cv_prog_compiler_c_o_GCJ" = no && test "$need_locks" != no; then
   # do not overwrite the value of need_locks provided by the user
-  { echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
+echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
   hard_links=yes
   $rm conftest*
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
   touch conftest.a
   ln conftest.a conftest.b 2>&5 || hard_links=no
   ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  { echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6; }
+  echo "$as_me:$LINENO: result: $hard_links" >&5
+echo "${ECHO_T}$hard_links" >&6
   if test "$hard_links" = no; then
     { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
 echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
     need_locks=warn
   fi
 else
   need_locks=no
 fi
 
-{ echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
+echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
 
   runpath_var=
   allow_undefined_flag_GCJ=
   enable_shared_with_static_runtimes_GCJ=no
   archive_cmds_GCJ=
   archive_expsym_cmds_GCJ=
@@ -17404,13 +16439,13 @@
       # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, GCJ) is actually meaningless,
       # as there is no search path for DLLs.
       hardcode_libdir_flag_spec_GCJ='-L$libdir'
       allow_undefined_flag_GCJ=unsupported
       always_export_symbols_GCJ=no
       enable_shared_with_static_runtimes_GCJ=yes
-      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
 
       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
         archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
 	archive_expsym_cmds_GCJ='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
@@ -17422,13 +16457,13 @@
 	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
       else
 	ld_shlibs_GCJ=no
       fi
       ;;
 
-    interix[3-9]*)
+    interix3*)
       hardcode_direct_GCJ=no
       hardcode_shlibpath_var_GCJ=no
       hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
       export_dynamic_flag_spec_GCJ='${wl}-E'
       # Hack: On Interix 3.x, we cannot compile PIC because of a broken gcc.
       # Instead, shared libraries are loaded at an image base (0x10000000 by
@@ -17437,13 +16472,13 @@
       # 256 KiB-aligned image base between 0x50000000 and 0x6FFC0000 at link
       # time.  Moving up from 0x10000000 also allows more sbrk(2) space.
       archive_cmds_GCJ='$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       archive_expsym_cmds_GCJ='sed "s,^,_," $export_symbols >$output_objdir/$soname.expsym~$CC -shared $pic_flag $libobjs $deplibs $compiler_flags ${wl}-h,$soname ${wl}--retain-symbols-file,$output_objdir/$soname.expsym ${wl}--image-base,`expr ${RANDOM-$$} % 4096 / 2 \* 262144 + 1342177280` -o $lib'
       ;;
 
-    gnu* | linux* | k*bsd*-gnu)
+    linux* | k*bsd*-gnu)
       if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
 	tmp_addflag=
 	case $cc_basename,$host_cpu in
 	pgcc*)				# Portland Group C compiler
 	  whole_archive_flag_spec_GCJ='${wl}--whole-archive`for conv in $convenience\"\"; do test  -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
 	  tmp_addflag=' $pic_flag'
@@ -17455,28 +16490,19 @@
 	  tmp_addflag=' -i_dynamic' ;;
 	efc*,ia64* | ifort*,ia64*)	# Intel Fortran compiler on ia64
 	  tmp_addflag=' -i_dynamic -nofor_main' ;;
 	ifc* | ifort*)			# Intel Fortran compiler
 	  tmp_addflag=' -nofor_main' ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
-	*Sun\ C*)			# Sun C 5.9
-	  whole_archive_flag_spec_GCJ='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}--no-whole-archive'
-	  tmp_sharedflag='-G' ;;
-	*Sun\ F*)			# Sun Fortran 8.3
-	  tmp_sharedflag='-G' ;;
-	*)
-	  tmp_sharedflag='-shared' ;;
-	esac
-	archive_cmds_GCJ='$CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
+	archive_cmds_GCJ='$CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 
 	if test $supports_anon_versioning = yes; then
 	  archive_expsym_cmds_GCJ='$echo "{ global:" > $output_objdir/$libname.ver~
   cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
   $echo "local: *; };" >> $output_objdir/$libname.ver~
-	  $CC '"$tmp_sharedflag""$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
+	  $CC -shared'"$tmp_addflag"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
 	fi
 	link_all_deplibs_GCJ=no
       else
 	ld_shlibs_GCJ=no
       fi
       ;;
@@ -17630,13 +16656,13 @@
 	# below for broken collect2 doesn't work under 4.3+
 	  collect2name=`${CC} -print-prog-name=collect2`
 	  if test -f "$collect2name" && \
   	   strings "$collect2name" | grep resolve_lib_name >/dev/null
 	  then
   	  # We have reworked collect2
-  	  :
+  	  hardcode_direct_GCJ=yes
 	  else
   	  # We have old collect2
   	  hardcode_direct_GCJ=unsupported
   	  # It fails to find uninstalled libraries when the uninstalled
   	  # path is not listed in the libpath.  Setting hardcode_minus_L
   	  # to unsupported forces relinking
@@ -17686,50 +16712,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
        hardcode_libdir_flag_spec_GCJ='${wl}-blibpath:$libdir:'"$aix_libpath"
 	archive_expsym_cmds_GCJ="\$CC"' -o $output_objdir/$soname $libobjs $deplibs '"\${wl}$no_entry_flag"' $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$exp_sym_flag:\$export_symbols $shared_flag"
        else
@@ -17752,50 +16772,44 @@
 
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-
-lt_aix_libpath_sed='
-    /Import File Strings/,/^$/ {
-	/^0/ {
-	    s/^0  *\(.*\)$/\1/
-	    p
-	}
-    }'
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+
+aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`
 # Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then
-  aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e "$lt_aix_libpath_sed"`
-fi
+if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
+}'`; fi
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 
 	 hardcode_libdir_flag_spec_GCJ='${wl}-blibpath:$libdir:'"$aix_libpath"
 	  # Warning - without using the other run time loading flags,
 	  # -berok will link without error, but may produce a broken library.
@@ -17835,13 +16849,13 @@
       shrext_cmds=".dll"
       # FIXME: Setting linknames here is a bad hack.
       archive_cmds_GCJ='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
       # The linker will automatically build a .lib file if we build a DLL.
       old_archive_From_new_cmds_GCJ='true'
       # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_GCJ='lib -OUT:$oldlib$oldobjs$old_deplibs'
+      old_archive_cmds_GCJ='lib /OUT:$oldlib$oldobjs$old_deplibs'
       fix_srcfile_path_GCJ='`cygpath -w "$srcfile"`'
       enable_shared_with_static_runtimes_GCJ=yes
       ;;
 
     darwin* | rhapsody*)
       case $host_os in
@@ -17877,16 +16891,16 @@
       archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
       module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
     else
       case $cc_basename in
         xlc*)
          output_verbose_link_cmd='echo'
-         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $xlcverstring'
+         archive_cmds_GCJ='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'
          module_cmds_GCJ='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
           # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin lds
-         archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $xlcverstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
+         archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
           ;;
        *)
          ld_shlibs_GCJ=no
           ;;
       esac
@@ -18042,34 +17056,30 @@
       hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
       hardcode_libdir_separator_GCJ=:
       hardcode_shlibpath_var_GCJ=no
       ;;
 
     openbsd*)
-      if test -f /usr/libexec/ld.so; then
-	hardcode_direct_GCJ=yes
-	hardcode_shlibpath_var_GCJ=no
-	if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	  archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	  archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
-	  hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	  export_dynamic_flag_spec_GCJ='${wl}-E'
-	else
-	  case $host_os in
-	   openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	     archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	     hardcode_libdir_flag_spec_GCJ='-R$libdir'
-	     ;;
-	   *)
-	     archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	     hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	     ;;
-	  esac
-        fi
+      hardcode_direct_GCJ=yes
+      hardcode_shlibpath_var_GCJ=no
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
+	hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
+	export_dynamic_flag_spec_GCJ='${wl}-E'
       else
-	ld_shlibs_GCJ=no
+       case $host_os in
+	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+	   archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
+	   hardcode_libdir_flag_spec_GCJ='-R$libdir'
+	   ;;
+	 *)
+	   archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	   hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
+	   ;;
+       esac
       fi
       ;;
 
     os2*)
       hardcode_libdir_flag_spec_GCJ='-L$libdir'
       hardcode_minus_L_GCJ=yes
@@ -18122,22 +17132,23 @@
       fi
       hardcode_libdir_flag_spec_GCJ='-R$libdir'
       hardcode_shlibpath_var_GCJ=no
       case $host_os in
       solaris2.[0-5] | solaris2.[0-5].*) ;;
       *)
-	# The compiler driver will combine and reorder linker options,
-	# but understands `-z linker_flag'.  GCC discards it without `$wl',
-	# but is careful enough not to reorder.
+ 	# The compiler driver will combine linker options so we
+ 	# cannot just pass the convience library names through
+ 	# without $wl, iff we do not link with $LD.
+ 	# Luckily, gcc supports the same syntax we need for Sun Studio.
  	# Supported since Solaris 2.6 (maybe 2.5.1?)
-	if test "$GCC" = yes; then
-	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	else
-	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract'
-	fi
-	;;
+ 	case $wlarc in
+ 	'')
+ 	  whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
+ 	*)
+ 	  whole_archive_flag_spec_GCJ='${wl}-z ${wl}allextract`for conv in $convenience\"\"; do test -n \"$conv\" && new_convenience=\"$new_convenience,$conv\"; done; $echo \"$new_convenience\"` ${wl}-z ${wl}defaultextract' ;;
+ 	esac ;;
       esac
       link_all_deplibs_GCJ=yes
       ;;
 
     sunos4*)
       if test "x$host_vendor" = xsequent; then
@@ -18188,13 +17199,13 @@
 	runpath_var=LD_RUN_PATH
 	hardcode_runpath_var=yes
 	ld_shlibs_GCJ=yes
       fi
       ;;
 
-    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)
+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7*)
       no_undefined_flag_GCJ='${wl}-z,text'
       archive_cmds_need_lc_GCJ=no
       hardcode_shlibpath_var_GCJ=no
       runpath_var='LD_RUN_PATH'
 
       if test "$GCC" = yes; then
@@ -18241,14 +17252,14 @@
     *)
       ld_shlibs_GCJ=no
       ;;
     esac
   fi
 
-{ echo "$as_me:$LINENO: result: $ld_shlibs_GCJ" >&5
-echo "${ECHO_T}$ld_shlibs_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $ld_shlibs_GCJ" >&5
+echo "${ECHO_T}$ld_shlibs_GCJ" >&6
 test "$ld_shlibs_GCJ" = no && can_build_shared=no
 
 #
 # Do we need to explicitly link libc?
 #
 case "x$archive_cmds_need_lc_GCJ" in
@@ -18262,16 +17273,16 @@
       # FIXME: we may have to deal with multi-command sequences.
       ;;
     '$CC '*)
       # Test whether the compiler implicitly links with -lc since on some
       # systems, -lgcc has to come before -lc. If gcc already passes -lc
       # to ld, don't add -lc before -lgcc.
-      { echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6; }
+      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
+echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
       $rm conftest*
-      echo "$lt_simple_compile_test_code" > conftest.$ac_ext
+      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
 
       if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); } 2>conftest.err; then
@@ -18300,22 +17311,22 @@
         fi
         allow_undefined_flag_GCJ=$lt_save_allow_undefined_flag
       else
         cat conftest.err 1>&5
       fi
       $rm conftest*
-      { echo "$as_me:$LINENO: result: $archive_cmds_need_lc_GCJ" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_GCJ" >&6; }
+      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_GCJ" >&5
+echo "${ECHO_T}$archive_cmds_need_lc_GCJ" >&6
       ;;
     esac
   fi
   ;;
 esac
 
-{ echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
+echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
 library_names_spec=
 libname_spec='lib$name'
 soname_spec=
 shrext_cmds=".so"
 postinstall_cmds=
 postuninstall_cmds=
@@ -18323,13 +17334,26 @@
 finish_eval=
 shlibpath_var=
 shlibpath_overrides_runpath=unknown
 version_type=none
 dynamic_linker="$host_os ld.so"
 sys_lib_dlsearch_path_spec="/lib /usr/lib"
-
+if test "$GCC" = yes; then
+  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
+  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
+    # if the path contains ";" then we assume it to be the separator
+    # otherwise default to the standard path separator (i.e. ":") - it is
+    # assumed that no part of a normal pathname contains ";" but that should
+    # okay in the real world where ";" in dirpaths is itself problematic.
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
+  else
+    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
+  fi
+else
+  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
+fi
 need_lib_prefix=unknown
 hardcode_into_libs=no
 
 # when you set need_version to no, make sure it does not cause -set_version
 # flags to be left without arguments
 need_version=unknown
@@ -18480,13 +17504,18 @@
   need_version=no
   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
   soname_spec='${libname}${release}${major}$shared_ext'
   shlibpath_overrides_runpath=yes
   shlibpath_var=DYLD_LIBRARY_PATH
   shrext_cmds='`test .$module = .yes && echo .so || echo .dylib`'
-
+  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
+  if test "$GCC" = yes; then
+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
+  else
+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
+  fi
   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
   ;;
 
 dgux*)
   version_type=linux
   need_lib_prefix=no
@@ -18534,13 +17563,13 @@
     ;;
   freebsd3.[2-9]* | freebsdelf3.[2-9]* | \
   freebsd4.[0-5] | freebsdelf4.[0-5] | freebsd4.1.1 | freebsdelf4.1.1)
     shlibpath_overrides_runpath=no
     hardcode_into_libs=yes
     ;;
-  *) # from 4.6 on, and DragonFly
+  freebsd*) # from 4.6 on
     shlibpath_overrides_runpath=yes
     hardcode_into_libs=yes
     ;;
   esac
   ;;
 
@@ -18597,13 +17626,13 @@
     ;;
   esac
   # HP-UX runs *really* slowly unless shared libraries are mode 555.
   postinstall_cmds='chmod 555 $lib'
   ;;
 
-interix[3-9]*)
+interix3*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
   dynamic_linker='Interix 3.x ld.so.1 (PE, like ELF)'
@@ -18668,13 +17697,13 @@
   # Some rework will be needed to allow for fast_install
   # before this can be enabled.
   hardcode_into_libs=yes
 
   # Append ld.so.conf contents to the search path
   if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s 2>/dev/null", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;/^[ 	]*hwcap[ 	]/d;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
+    lt_ld_extra=`awk '/^include / { system(sprintf("cd /etc; cat %s", \$2)); skip = 1; } { if (!skip) print \$0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,	]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\n' ' '`
     sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
   fi
 
   # We used to test for /lib/ld.so.1 and disable shared libraries on
   # powerpc, because MkLinux only supported shared libraries with the
   # GNU dynamic linker.  Since this was broken with cross compilers,
@@ -18774,16 +17803,12 @@
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   shlibpath_var=LD_LIBRARY_PATH
   sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
   sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
   ;;
 
-rdos*)
-  dynamic_linker=no
-  ;;
-
 solaris*)
   version_type=linux
   need_lib_prefix=no
   need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
   soname_spec='${libname}${release}${shared_ext}$major'
@@ -18870,23 +17895,23 @@
   ;;
 
 *)
   dynamic_linker=no
   ;;
 esac
-{ echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6; }
+echo "$as_me:$LINENO: result: $dynamic_linker" >&5
+echo "${ECHO_T}$dynamic_linker" >&6
 test "$dynamic_linker" = no && can_build_shared=no
 
 variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
 if test "$GCC" = yes; then
   variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
 fi
 
-{ echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
+echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
 hardcode_action_GCJ=
 if test -n "$hardcode_libdir_flag_spec_GCJ" || \
    test -n "$runpath_var_GCJ" || \
    test "X$hardcode_automatic_GCJ" = "Xyes" ; then
 
   # We can hardcode non-existant directories.
@@ -18904,14 +17929,14 @@
   fi
 else
   # We cannot hardcode anything, or else we can only hardcode existing
   # directories.
   hardcode_action_GCJ=unsupported
 fi
-{ echo "$as_me:$LINENO: result: $hardcode_action_GCJ" >&5
-echo "${ECHO_T}$hardcode_action_GCJ" >&6; }
+echo "$as_me:$LINENO: result: $hardcode_action_GCJ" >&5
+echo "${ECHO_T}$hardcode_action_GCJ" >&6
 
 if test "$hardcode_action_GCJ" = relink; then
   # Fast installation is not supported
   enable_fast_install=no
 elif test "$shlibpath_overrides_runpath" = yes ||
      test "$enable_shared" = no; then
@@ -18972,13 +17997,12 @@
     hardcode_libdir_flag_spec_ld_GCJ \
     hardcode_libdir_separator_GCJ \
     hardcode_automatic_GCJ \
     module_cmds_GCJ \
     module_expsym_cmds_GCJ \
     lt_cv_prog_compiler_c_o_GCJ \
-    fix_srcfile_path_GCJ \
     exclude_expsyms_GCJ \
     include_expsyms_GCJ; do
 
     case $var in
     old_archive_cmds_GCJ | \
     old_archive_from_new_cmds_GCJ | \
@@ -19293,13 +18317,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_GCJ"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_GCJ
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_GCJ
@@ -19350,13 +18375,13 @@
 
 # Object file extension for compiled RC test sources.
 objext=o
 objext_RC=$objext
 
 # Code to be used in simple compile tests
-lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }'
+lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }\n'
 
 # Code to be used in simple link tests
 lt_simple_link_test_code="$lt_simple_compile_test_code"
 
 # ltmain only uses $CC for tagged configurations so make sure $CC is set.
 
@@ -19369,19 +18394,19 @@
 # Allow CC to be a program name with arguments.
 compiler=$CC
 
 
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_compile_test_code" >conftest.$ac_ext
+printf "$lt_simple_compile_test_code" >conftest.$ac_ext
 eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $rm conftest*
 
 ac_outfile=conftest.$ac_objext
-echo "$lt_simple_link_test_code" >conftest.$ac_ext
+printf "$lt_simple_link_test_code" >conftest.$ac_ext
 eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $rm conftest*
 
 
 # Allow CC to be a program name with arguments.
@@ -19453,13 +18478,12 @@
     hardcode_libdir_flag_spec_ld_RC \
     hardcode_libdir_separator_RC \
     hardcode_automatic_RC \
     module_cmds_RC \
     module_expsym_cmds_RC \
     lt_cv_prog_compiler_c_o_RC \
-    fix_srcfile_path_RC \
     exclude_expsyms_RC \
     include_expsyms_RC; do
 
     case $var in
     old_archive_cmds_RC | \
     old_archive_from_new_cmds_RC | \
@@ -19774,13 +18798,13 @@
 sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
 
 # Run-time system search path for libraries
 sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
 
 # Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path=$lt_fix_srcfile_path
+fix_srcfile_path="$fix_srcfile_path_RC"
 
 # Set to yes if exported symbols are required.
 always_export_symbols=$always_export_symbols_RC
 
 # The commands to list exported symbols.
 export_symbols_cmds=$lt_export_symbols_cmds_RC
@@ -19883,15 +18907,15 @@
 
 
 
 ac_header_dirent=no
 for ac_hdr in dirent.h sys/ndir.h sys/dir.h ndir.h; do
   as_ac_Header=`echo "ac_cv_header_dirent_$ac_hdr" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_hdr that defines DIR" >&5
-echo $ECHO_N "checking for $ac_hdr that defines DIR... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_hdr that defines DIR" >&5
+echo $ECHO_N "checking for $ac_hdr that defines DIR... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -19907,226 +18931,310 @@
 return 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_Header=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_Header=no"
+eval "$as_ac_Header=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_hdr" | $as_tr_cpp` 1
 _ACEOF
 
 ac_header_dirent=$ac_hdr; break
 fi
 
 done
 # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
 if test $ac_header_dirent = dirent.h; then
-  { echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for library containing opendir" >&5
+echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
 if test "${ac_cv_search_opendir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_func_search_save_LIBS=$LIBS
+ac_cv_search_opendir=no
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char opendir ();
 int
 main ()
 {
-return opendir ();
+opendir ();
   ;
   return 0;
 }
 _ACEOF
-for ac_lib in '' dir; do
-  if test -z "$ac_lib"; then
-    ac_res="none required"
-  else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-  fi
-  rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_search_opendir=$ac_res
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_search_opendir="none required"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
+rm -f conftest.err conftest.$ac_objext \
+      conftest$ac_exeext conftest.$ac_ext
+if test "$ac_cv_search_opendir" = no; then
+  for ac_lib in dir; do
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext
-  if test "${ac_cv_search_opendir+set}" = set; then
-  break
-fi
-done
-if test "${ac_cv_search_opendir+set}" = set; then
-  :
+/* Override any gcc2 internal prototype to avoid an error.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
+char opendir ();
+int
+main ()
+{
+opendir ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_search_opendir="-l$ac_lib"
+break
 else
-  ac_cv_search_opendir=no
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+fi
+rm -f conftest.err conftest.$ac_objext \
+      conftest$ac_exeext conftest.$ac_ext
+  done
 fi
-rm conftest.$ac_ext
 LIBS=$ac_func_search_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6; }
-ac_res=$ac_cv_search_opendir
-if test "$ac_res" != no; then
-  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
+echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
+echo "${ECHO_T}$ac_cv_search_opendir" >&6
+if test "$ac_cv_search_opendir" != no; then
+  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
 
 fi
 
 else
-  { echo "$as_me:$LINENO: checking for library containing opendir" >&5
-echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for library containing opendir" >&5
+echo $ECHO_N "checking for library containing opendir... $ECHO_C" >&6
 if test "${ac_cv_search_opendir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_func_search_save_LIBS=$LIBS
+ac_cv_search_opendir=no
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char opendir ();
 int
 main ()
 {
-return opendir ();
+opendir ();
   ;
   return 0;
 }
 _ACEOF
-for ac_lib in '' x; do
-  if test -z "$ac_lib"; then
-    ac_res="none required"
-  else
-    ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
-  fi
-  rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
-  ac_cv_search_opendir=$ac_res
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_search_opendir="none required"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-
 fi
+rm -f conftest.err conftest.$ac_objext \
+      conftest$ac_exeext conftest.$ac_ext
+if test "$ac_cv_search_opendir" = no; then
+  for ac_lib in x; do
+    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext
-  if test "${ac_cv_search_opendir+set}" = set; then
-  break
-fi
-done
-if test "${ac_cv_search_opendir+set}" = set; then
-  :
+/* Override any gcc2 internal prototype to avoid an error.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
+char opendir ();
+int
+main ()
+{
+opendir ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_search_opendir="-l$ac_lib"
+break
 else
-  ac_cv_search_opendir=no
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+fi
+rm -f conftest.err conftest.$ac_objext \
+      conftest$ac_exeext conftest.$ac_ext
+  done
 fi
-rm conftest.$ac_ext
 LIBS=$ac_func_search_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
-echo "${ECHO_T}$ac_cv_search_opendir" >&6; }
-ac_res=$ac_cv_search_opendir
-if test "$ac_res" != no; then
-  test "$ac_res" = "none required" || LIBS="$ac_res $LIBS"
+echo "$as_me:$LINENO: result: $ac_cv_search_opendir" >&5
+echo "${ECHO_T}$ac_cv_search_opendir" >&6
+if test "$ac_cv_search_opendir" != no; then
+  test "$ac_cv_search_opendir" = "none required" || LIBS="$ac_cv_search_opendir $LIBS"
 
 fi
 
 fi
 
-# Check whether --enable-ltdl-install was given.
+# Check whether --enable-ltdl-install or --disable-ltdl-install was given.
 if test "${enable_ltdl_install+set}" = set; then
-  enableval=$enable_ltdl_install;
-fi
+  enableval="$enable_ltdl_install"
 
+fi;
 
 
 
 if test x"${enable_ltdl_install-no}" != xno; then
   INSTALL_LTDL_TRUE=
   INSTALL_LTDL_FALSE='#'
@@ -20144,60 +19252,60 @@
   CONVENIENCE_LTDL_TRUE='#'
   CONVENIENCE_LTDL_FALSE=
 fi
 
 
 
-{ echo "$as_me:$LINENO: checking which extension is used for loadable modules" >&5
-echo $ECHO_N "checking which extension is used for loadable modules... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking which extension is used for loadable modules" >&5
+echo $ECHO_N "checking which extension is used for loadable modules... $ECHO_C" >&6
 if test "${libltdl_cv_shlibext+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
 
 module=yes
 eval libltdl_cv_shlibext=$shrext_cmds
 
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_shlibext" >&5
-echo "${ECHO_T}$libltdl_cv_shlibext" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_shlibext" >&5
+echo "${ECHO_T}$libltdl_cv_shlibext" >&6
 if test -n "$libltdl_cv_shlibext"; then
 
 cat >>confdefs.h <<_ACEOF
 #define LTDL_SHLIB_EXT "$libltdl_cv_shlibext"
 _ACEOF
 
 fi
 
 
-{ echo "$as_me:$LINENO: checking which variable specifies run-time library path" >&5
-echo $ECHO_N "checking which variable specifies run-time library path... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking which variable specifies run-time library path" >&5
+echo $ECHO_N "checking which variable specifies run-time library path... $ECHO_C" >&6
 if test "${libltdl_cv_shlibpath_var+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   libltdl_cv_shlibpath_var="$shlibpath_var"
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_shlibpath_var" >&5
-echo "${ECHO_T}$libltdl_cv_shlibpath_var" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_shlibpath_var" >&5
+echo "${ECHO_T}$libltdl_cv_shlibpath_var" >&6
 if test -n "$libltdl_cv_shlibpath_var"; then
 
 cat >>confdefs.h <<_ACEOF
 #define LTDL_SHLIBPATH_VAR "$libltdl_cv_shlibpath_var"
 _ACEOF
 
 fi
 
 
-{ echo "$as_me:$LINENO: checking for the default library search path" >&5
-echo $ECHO_N "checking for the default library search path... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for the default library search path" >&5
+echo $ECHO_N "checking for the default library search path... $ECHO_C" >&6
 if test "${libltdl_cv_sys_search_path+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   libltdl_cv_sys_search_path="$sys_lib_dlsearch_path_spec"
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_sys_search_path" >&5
-echo "${ECHO_T}$libltdl_cv_sys_search_path" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_sys_search_path" >&5
+echo "${ECHO_T}$libltdl_cv_sys_search_path" >&6
 if test -n "$libltdl_cv_sys_search_path"; then
   sys_search_path=
   for dir in $libltdl_cv_sys_search_path; do
     if test -z "$sys_search_path"; then
       sys_search_path="$dir"
     else
@@ -20208,14 +19316,14 @@
 cat >>confdefs.h <<_ACEOF
 #define LTDL_SYSSEARCHPATH "$sys_search_path"
 _ACEOF
 
 fi
 
-{ echo "$as_me:$LINENO: checking for objdir" >&5
-echo $ECHO_N "checking for objdir... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for objdir" >&5
+echo $ECHO_N "checking for objdir... $ECHO_C" >&6
 if test "${libltdl_cv_objdir+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   libltdl_cv_objdir="$objdir"
   if test -n "$objdir"; then
     :
@@ -20229,35 +19337,35 @@
       libltdl_cv_objdir=_libs
     fi
   rmdir .libs 2>/dev/null
   fi
 
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_objdir" >&5
-echo "${ECHO_T}$libltdl_cv_objdir" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_objdir" >&5
+echo "${ECHO_T}$libltdl_cv_objdir" >&6
 
 cat >>confdefs.h <<_ACEOF
 #define LTDL_OBJDIR "$libltdl_cv_objdir/"
 _ACEOF
 
 
 
-{ echo "$as_me:$LINENO: checking whether libtool supports -dlopen/-dlpreopen" >&5
-echo $ECHO_N "checking whether libtool supports -dlopen/-dlpreopen... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether libtool supports -dlopen/-dlpreopen" >&5
+echo $ECHO_N "checking whether libtool supports -dlopen/-dlpreopen... $ECHO_C" >&6
 if test "${libltdl_cv_preloaded_symbols+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   if test -n "$lt_cv_sys_global_symbol_pipe"; then
     libltdl_cv_preloaded_symbols=yes
   else
     libltdl_cv_preloaded_symbols=no
   fi
 
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_preloaded_symbols" >&5
-echo "${ECHO_T}$libltdl_cv_preloaded_symbols" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_preloaded_symbols" >&5
+echo "${ECHO_T}$libltdl_cv_preloaded_symbols" >&6
 if test x"$libltdl_cv_preloaded_symbols" = xyes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_PRELOADED_SYMBOLS 1
 _ACEOF
 
@@ -20269,14 +19377,14 @@
 ac_cpp='$CPP $CPPFLAGS'
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
-{ echo "$as_me:$LINENO: checking for shl_load" >&5
-echo $ECHO_N "checking for shl_load... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for shl_load" >&5
+echo $ECHO_N "checking for shl_load... $ECHO_C" >&6
 if test "${ac_cv_func_shl_load+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -20297,202 +19405,214 @@
 #else
 # include <assert.h>
 #endif
 
 #undef shl_load
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char shl_load ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_shl_load || defined __stub___shl_load
+#if defined (__stub_shl_load) || defined (__stub___shl_load)
 choke me
+#else
+char (*f) () = shl_load;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return shl_load ();
+return f != shl_load;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_func_shl_load=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_func_shl_load=no
+ac_cv_func_shl_load=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
-echo "${ECHO_T}$ac_cv_func_shl_load" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
+echo "${ECHO_T}$ac_cv_func_shl_load" >&6
 if test $ac_cv_func_shl_load = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_SHL_LOAD 1
 _ACEOF
 
 else
-  { echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
-echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
+echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6
 if test "${ac_cv_lib_dld_shl_load+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char shl_load ();
 int
 main ()
 {
-return shl_load ();
+shl_load ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dld_shl_load=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dld_shl_load=no
+ac_cv_lib_dld_shl_load=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
+echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6
 if test $ac_cv_lib_dld_shl_load = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_SHL_LOAD 1
 _ACEOF
 
 	LIBADD_DL="$LIBADD_DL -ldld"
 else
-  { echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
+echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
 if test "${ac_cv_lib_dl_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldl  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 int
 main ()
 {
-return dlopen ();
+dlopen ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dl_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dl_dlopen=no
+ac_cv_lib_dl_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
+echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
 if test $ac_cv_lib_dl_dlopen = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_LIBDL 1
 _ACEOF
 
@@ -20514,178 +19634,185 @@
 dlopen(0, 0);
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_LIBDL 1
 _ACEOF
  libltdl_cv_func_dlopen="yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	{ echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
-echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
+echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6
 if test "${ac_cv_lib_svld_dlopen+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-lsvld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dlopen ();
 int
 main ()
 {
-return dlopen ();
+dlopen ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_svld_dlopen=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_svld_dlopen=no
+ac_cv_lib_svld_dlopen=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
+echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6
 if test $ac_cv_lib_svld_dlopen = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_LIBDL 1
 _ACEOF
 
 	            LIBADD_DL="-lsvld" libltdl_cv_func_dlopen="yes"
 else
-  { echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
-echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
+echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6
 if test "${ac_cv_lib_dld_dld_link+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
 LIBS="-ldld  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char dld_link ();
 int
 main ()
 {
-return dld_link ();
+dld_link ();
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_lib_dld_dld_link=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_lib_dld_dld_link=no
+ac_cv_lib_dld_dld_link=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
+echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6
 if test $ac_cv_lib_dld_dld_link = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_DLD 1
 _ACEOF
 
 	 	LIBADD_DL="$LIBADD_DL -ldld"
 else
-  { echo "$as_me:$LINENO: checking for _dyld_func_lookup" >&5
-echo $ECHO_N "checking for _dyld_func_lookup... $ECHO_C" >&6; }
+  echo "$as_me:$LINENO: checking for _dyld_func_lookup" >&5
+echo $ECHO_N "checking for _dyld_func_lookup... $ECHO_C" >&6
 if test "${ac_cv_func__dyld_func_lookup+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -20706,65 +19833,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef _dyld_func_lookup
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char _dyld_func_lookup ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub__dyld_func_lookup || defined __stub____dyld_func_lookup
+#if defined (__stub__dyld_func_lookup) || defined (__stub____dyld_func_lookup)
 choke me
+#else
+char (*f) () = _dyld_func_lookup;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return _dyld_func_lookup ();
+return f != _dyld_func_lookup;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_func__dyld_func_lookup=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_func__dyld_func_lookup=no
+ac_cv_func__dyld_func_lookup=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_func__dyld_func_lookup" >&5
-echo "${ECHO_T}$ac_cv_func__dyld_func_lookup" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_func__dyld_func_lookup" >&5
+echo "${ECHO_T}$ac_cv_func__dyld_func_lookup" >&6
 if test $ac_cv_func__dyld_func_lookup = yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_DYLD 1
 _ACEOF
 
@@ -20775,14 +19910,13 @@
 
 
 fi
 
 
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 
 fi
 
 
 fi
@@ -20796,15 +19930,15 @@
   lt_save_LIBS="$LIBS"
   LIBS="$LIBS $LIBADD_DL"
 
 for ac_func in dlerror
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -20824,66 +19958,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
 
 fi
@@ -20896,14 +20037,14 @@
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
 
 
 
-{ echo "$as_me:$LINENO: checking for _ prefix in compiled symbols" >&5
-echo $ECHO_N "checking for _ prefix in compiled symbols... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for _ prefix in compiled symbols" >&5
+echo $ECHO_N "checking for _ prefix in compiled symbols... $ECHO_C" >&6
 if test "${ac_cv_sys_symbol_underscore+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_cv_sys_symbol_underscore=no
   cat > conftest.$ac_ext <<EOF
 void nm_test_func(){}
@@ -20938,34 +20079,34 @@
     echo "configure: failed program was:" >&5
     cat conftest.c >&5
   fi
   rm -rf conftest*
 
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_sys_symbol_underscore" >&5
-echo "${ECHO_T}$ac_cv_sys_symbol_underscore" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_sys_symbol_underscore" >&5
+echo "${ECHO_T}$ac_cv_sys_symbol_underscore" >&6
 
 
 if test x"$ac_cv_sys_symbol_underscore" = xyes; then
   if test x"$libltdl_cv_func_dlopen" = xyes ||
      test x"$libltdl_cv_lib_dl_dlopen" = xyes ; then
-	{ echo "$as_me:$LINENO: checking whether we have to add an underscore for dlsym" >&5
-echo $ECHO_N "checking whether we have to add an underscore for dlsym... $ECHO_C" >&6; }
+	echo "$as_me:$LINENO: checking whether we have to add an underscore for dlsym" >&5
+echo $ECHO_N "checking whether we have to add an underscore for dlsym... $ECHO_C" >&6
 if test "${libltdl_cv_need_uscore+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   libltdl_cv_need_uscore=unknown
           save_LIBS="$LIBS"
           LIBS="$LIBS $LIBADD_DL"
 	  if test "$cross_compiling" = yes; then :
   libltdl_cv_need_uscore=cross
 else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 20965 "configure"
+#line 20106 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
 #include <dlfcn.h>
 #endif
 
@@ -21044,28 +20185,28 @@
 fi
 rm -fr conftest*
 
 	  LIBS="$save_LIBS"
 
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_need_uscore" >&5
-echo "${ECHO_T}$libltdl_cv_need_uscore" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_need_uscore" >&5
+echo "${ECHO_T}$libltdl_cv_need_uscore" >&6
   fi
 fi
 
 if test x"$libltdl_cv_need_uscore" = xyes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define NEED_USCORE 1
 _ACEOF
 
 fi
 
 
-{ echo "$as_me:$LINENO: checking whether deplibs are loaded by dlopen" >&5
-echo $ECHO_N "checking whether deplibs are loaded by dlopen... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking whether deplibs are loaded by dlopen" >&5
+echo $ECHO_N "checking whether deplibs are loaded by dlopen... $ECHO_C" >&6
 if test "${libltdl_cv_sys_dlopen_deplibs+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   # PORTME does your system automatically load deplibs for dlopen?
   # or its logical equivalent (e.g. shl_load for HP-UX < 11)
   # For now, we just catch OSes we know something about -- in the
@@ -21082,15 +20223,12 @@
     ;;
   darwin*)
     # Assuming the user has installed a libdl from somewhere, this is true
     # If you are looking for one http://www.opendarwin.org/projects/dlcompat
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
-  freebsd* | dragonfly*)
-    libltdl_cv_sys_dlopen_deplibs=yes
-    ;;
   gnu* | linux* | k*bsd*-gnu)
     # GNU and its variants, using gnu ld.so (Glibc)
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
   hpux10*|hpux11*)
     libltdl_cv_sys_dlopen_deplibs=yes
@@ -21142,104 +20280,108 @@
   sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX* | sysv4*uw2*)
     libltdl_cv_sys_dlopen_deplibs=yes
     ;;
   esac
 
 fi
-{ echo "$as_me:$LINENO: result: $libltdl_cv_sys_dlopen_deplibs" >&5
-echo "${ECHO_T}$libltdl_cv_sys_dlopen_deplibs" >&6; }
+echo "$as_me:$LINENO: result: $libltdl_cv_sys_dlopen_deplibs" >&5
+echo "${ECHO_T}$libltdl_cv_sys_dlopen_deplibs" >&6
 if test "$libltdl_cv_sys_dlopen_deplibs" != yes; then
 
 cat >>confdefs.h <<\_ACEOF
 #define LTDL_DLOPEN_DEPLIBS 1
 _ACEOF
 
 fi
 
 
 for ac_header in argz.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
-  { echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_header_compiler=no
+ac_header_compiler=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
@@ -21241,16 +20383,15 @@
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
 fi
-
 rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
     { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
 echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
@@ -21268,44 +20409,45 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
 echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    ( cat <<\_ASBOX
+    (
+      cat <<\_ASBOX
 ## ---------------------------------- ##
 ## Report this to bug-libtool@gnu.org ##
 ## ---------------------------------- ##
 _ASBOX
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
 fi
 
 done
 
 
-{ echo "$as_me:$LINENO: checking for error_t" >&5
-echo $ECHO_N "checking for error_t... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking for error_t" >&5
+echo $ECHO_N "checking for error_t... $ECHO_C" >&6
 if test "${ac_cv_type_error_t+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -21313,53 +20455,55 @@
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #if HAVE_ARGZ_H
 #  include <argz.h>
 #endif
 
-typedef error_t ac__type_new_;
 int
 main ()
 {
-if ((ac__type_new_ *) 0)
+if ((error_t *) 0)
   return 0;
-if (sizeof (ac__type_new_))
+if (sizeof (error_t))
   return 0;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_cv_type_error_t=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_cv_type_error_t=no
+ac_cv_type_error_t=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_type_error_t" >&5
-echo "${ECHO_T}$ac_cv_type_error_t" >&6; }
+echo "$as_me:$LINENO: result: $ac_cv_type_error_t" >&5
+echo "${ECHO_T}$ac_cv_type_error_t" >&6
 if test $ac_cv_type_error_t = yes; then
 
 cat >>confdefs.h <<_ACEOF
 #define HAVE_ERROR_T 1
 _ACEOF
 
@@ -21378,15 +20522,15 @@
 
 
 
 for ac_func in argz_append argz_create_sep argz_insert argz_next argz_stringify
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -21406,66 +20550,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
 
 fi
@@ -21499,90 +20650,94 @@
 
 
 for ac_header in assert.h ctype.h errno.h malloc.h memory.h stdlib.h \
 		  stdio.h unistd.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
-  { echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_header_compiler=no
+ac_header_compiler=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
@@ -21584,16 +20739,15 @@
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
 fi
-
 rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
     { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
 echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
@@ -21611,30 +20765,31 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
 echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    ( cat <<\_ASBOX
+    (
+      cat <<\_ASBOX
 ## ---------------------------------- ##
 ## Report this to bug-libtool@gnu.org ##
 ## ---------------------------------- ##
 _ASBOX
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -21647,90 +20802,94 @@
 
 
 
 for ac_header in dl.h sys/dl.h dld.h mach-o/dyld.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
-  { echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_header_compiler=no
+ac_header_compiler=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
@@ -21732,16 +20891,15 @@
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
 fi
-
 rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
     { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
 echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
@@ -21759,30 +20917,31 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
 echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    ( cat <<\_ASBOX
+    (
+      cat <<\_ASBOX
 ## ---------------------------------- ##
 ## Report this to bug-libtool@gnu.org ##
 ## ---------------------------------- ##
 _ASBOX
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -21793,90 +20952,94 @@
 
 
 
 for ac_header in string.h strings.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
-  { echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest.$ac_objext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   ac_header_compiler=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	ac_header_compiler=no
+ac_header_compiler=no
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <$ac_header>
 _ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null && {
-	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       }; then
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
   ac_header_preproc=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
@@ -21878,16 +21041,15 @@
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
   ac_header_preproc=no
 fi
-
 rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
 
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
     { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
 echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
@@ -21905,30 +21067,31 @@
     { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
 echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
 echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
     { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
 echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    ( cat <<\_ASBOX
+    (
+      cat <<\_ASBOX
 ## ---------------------------------- ##
 ## Report this to bug-libtool@gnu.org ##
 ## ---------------------------------- ##
 _ASBOX
-     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   eval "$as_ac_Header=\$ac_header_preproc"
 fi
-ac_res=`eval echo '${'$as_ac_Header'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
 
 fi
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -21940,15 +21103,15 @@
 
 
 
 for ac_func in strchr index
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -21968,66 +21131,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
  break
 fi
@@ -22035,15 +21205,15 @@
 
 
 
 for ac_func in strrchr rindex
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -22063,66 +21233,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
  break
 fi
@@ -22130,15 +21307,15 @@
 
 
 
 for ac_func in memcpy bcopy
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -22158,66 +21335,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
  break
 fi
@@ -22225,15 +21409,15 @@
 
 
 
 for ac_func in memmove strcmp
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -22253,66 +21437,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
 
 fi
@@ -22321,15 +21512,15 @@
 
 
 
 for ac_func in closedir opendir readdir
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
-{ echo "$as_me:$LINENO: checking for $ac_func" >&5
-echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
-if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6
+if eval "test \"\${$as_ac_var+set}\" = set"; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
@@ -22349,66 +21540,73 @@
 #else
 # include <assert.h>
 #endif
 
 #undef $ac_func
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
+/* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
 extern "C"
+{
 #endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
 char $ac_func ();
 /* The GNU C library defines this for functions which it implements
     to always fail with ENOSYS.  Some functions are actually named
     something starting with __ and the normal name is an alias.  */
-#if defined __stub_$ac_func || defined __stub___$ac_func
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
 choke me
+#else
+char (*f) () = $ac_func;
+#endif
+#ifdef __cplusplus
+}
 #endif
 
 int
 main ()
 {
-return $ac_func ();
+return f != $ac_func;
   ;
   return 0;
 }
 _ACEOF
 rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
   ac_status=$?
   grep -v '^ *+' conftest.er1 >conftest.err
   rm -f conftest.er1
   cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && {
-	 test -z "$ac_c_werror_flag" ||
-	 test ! -s conftest.err
-       } && test -s conftest$ac_exeext &&
-       $as_test_x conftest$ac_exeext; then
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
   eval "$as_ac_var=yes"
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	eval "$as_ac_var=no"
+eval "$as_ac_var=no"
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 fi
-ac_res=`eval echo '${'$as_ac_var'}'`
-	       { echo "$as_me:$LINENO: result: $ac_res" >&5
-echo "${ECHO_T}$ac_res" >&6; }
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_var'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_var'}'`" >&6
 if test `eval echo '${'$as_ac_var'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
 
 fi
@@ -22417,13 +21615,13 @@
 
 
 
 ## -------- ##
 ## Outputs. ##
 ## -------- ##
-ac_config_files="$ac_config_files Makefile"
+          ac_config_files="$ac_config_files Makefile"
 
 cat >confcache <<\_ACEOF
 # This file is a shell script that caches the results of configure
 # tests run on this system so they can be shared between configure
 # scripts and configure runs, see configure's option --config-cache.
 # It is not useful on other systems.  If it contains results you don't
@@ -22437,84 +21635,79 @@
 # following values.
 
 _ACEOF
 
 # The following way of writing the cache mishandles newlines in values,
 # but we know of no workaround that is simple, portable, and efficient.
-# So, we kill variables containing newlines.
+# So, don't put newlines in cache variables' values.
 # Ultrix sh set writes to stderr and can't be redirected directly,
 # and sets the high bit in the cache file unless we assign to the vars.
-(
-  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
-    eval ac_val=\$$ac_var
-    case $ac_val in #(
-    *${as_nl}*)
-      case $ac_var in #(
-      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
-echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
-      esac
-      case $ac_var in #(
-      _ | IFS | as_nl) ;; #(
-      *) $as_unset $ac_var ;;
-      esac ;;
-    esac
-  done
-
+{
   (set) 2>&1 |
-    case $as_nl`(ac_space=' '; set) 2>&1` in #(
-    *${as_nl}ac_space=\ *)
+    case `(ac_space=' '; set | grep ac_space) 2>&1` in
+    *ac_space=\ *)
       # `set' does not quote correctly, so add quotes (double-quote
       # substitution turns \\\\ into \\, and sed turns \\ into \).
       sed -n \
 	"s/'/'\\\\''/g;
 	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;; #(
+      ;;
     *)
       # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      sed -n \
+	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
       ;;
-    esac |
-    sort
-) |
+    esac;
+} |
   sed '
-     /^ac_cv_env_/b end
      t clear
-     :clear
+     : clear
      s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
      t end
-     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     :end' >>confcache
-if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
-  if test -w "$cache_file"; then
-    test "x$cache_file" != "x/dev/null" &&
-      { echo "$as_me:$LINENO: updating cache $cache_file" >&5
-echo "$as_me: updating cache $cache_file" >&6;}
+     /^ac_cv_env/!s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
+     : end' >>confcache
+if diff $cache_file confcache >/dev/null 2>&1; then :; else
+  if test -w $cache_file; then
+    test "x$cache_file" != "x/dev/null" && echo "updating cache $cache_file"
     cat confcache >$cache_file
   else
-    { echo "$as_me:$LINENO: not updating unwritable cache $cache_file" >&5
-echo "$as_me: not updating unwritable cache $cache_file" >&6;}
+    echo "not updating unwritable cache $cache_file"
   fi
 fi
 rm -f confcache
 
 test "x$prefix" = xNONE && prefix=$ac_default_prefix
 # Let make expand exec_prefix.
 test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
 
+# VPATH may cause trouble with some makes, so we remove $(srcdir),
+# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
+# trailing colons and then remove the whole line if VPATH becomes empty
+# (actually we leave an empty line to preserve line numbers).
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
+s/:*\$(srcdir):*/:/;
+s/:*\${srcdir}:*/:/;
+s/:*@srcdir@:*/:/;
+s/^\([^=]*=[	 ]*\):*/\1/;
+s/:*$//;
+s/^[^=]*=[	 ]*$//;
+}'
+fi
+
 DEFS=-DHAVE_CONFIG_H
 
 ac_libobjs=
 ac_ltlibobjs=
 for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
   # 1. Remove the extension, and $U if already installed.
-  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
-  ac_i=`echo "$ac_i" | sed "$ac_script"`
-  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
-  #    will be set to the directory where LIBOBJS objects are built.
-  ac_libobjs="$ac_libobjs \${LIBOBJDIR}$ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs \${LIBOBJDIR}$ac_i"'$U.lo'
+  ac_i=`echo "$ac_i" |
+	 sed 's/\$U\././;s/\.o$//;s/\.obj$//'`
+  # 2. Add them.
+  ac_libobjs="$ac_libobjs $ac_i\$U.$ac_objext"
+  ac_ltlibobjs="$ac_ltlibobjs $ac_i"'$U.lo'
 done
 LIBOBJS=$ac_libobjs
 
 LTLIBOBJS=$ac_ltlibobjs
 
 
@@ -22574,97 +21767,34 @@
 
 cat >>$CONFIG_STATUS <<\_ACEOF
 ## --------------------- ##
 ## M4sh Initialization.  ##
 ## --------------------- ##
 
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
+# Be Bourne compatible
 if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
   emulate sh
   NULLCMD=:
   # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
   # is contrary to our usage.  Disable this feature.
   alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
+elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
+  set -o posix
 fi
+DUALCASE=1; export DUALCASE # for MKS sh
 
 # Support unset when possible.
 if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
   as_unset=unset
 else
   as_unset=false
 fi
 
 
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-as_nl='
-'
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
 # Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
+$as_unset ENV MAIL MAILPATH
 PS1='$ '
 PS2='> '
 PS4='+ '
 
 # NLS nuisances.
 for as_var in \
@@ -22672,213 +21802,257 @@
   LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
   LC_TELEPHONE LC_TIME
 do
   if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
     eval $as_var=C; export $as_var
   else
-    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
+    $as_unset $as_var
   fi
 done
 
 # Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+if expr a : '\(a\)' >/dev/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
   as_basename=basename
 else
   as_basename=false
 fi
 
 
 # Name of the executable.
-as_me=`$as_basename -- "$0" ||
+as_me=`$as_basename "$0" ||
 $as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
 	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$0" : 'X\(/\)$' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
+  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\/\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
 
-# CDPATH.
-$as_unset CDPATH
-
+
+# PATH needs CR, and LINENO needs CR and PATH.
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  echo "#! /bin/sh" >conf$$.sh
+  echo  "exit 0"   >>conf$$.sh
+  chmod +x conf$$.sh
+  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
+    PATH_SEPARATOR=';'
+  else
+    PATH_SEPARATOR=:
+  fi
+  rm -f conf$$.sh
+fi
 
 
   as_lineno_1=$LINENO
   as_lineno_2=$LINENO
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
   test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
+  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
+  # Find who we are.  Look in the path if we contain no path at all
+  # relative or not.
+  case $0 in
+    *[\\/]* ) as_myself=$0 ;;
+    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+done
+
+       ;;
+  esac
+  # We did not find ourselves, most probably we were run as `sh COMMAND'
+  # in which case we are not to be found in the path.
+  if test "x$as_myself" = x; then
+    as_myself=$0
+  fi
+  if test ! -f "$as_myself"; then
+    { { echo "$as_me:$LINENO: error: cannot find myself; rerun with an absolute path" >&5
+echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2;}
+   { (exit 1); exit 1; }; }
+  fi
+  case $CONFIG_SHELL in
+  '')
+    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for as_base in sh bash ksh sh5; do
+	 case $as_dir in
+	 /*)
+	   if ("$as_dir/$as_base" -c '
+  as_lineno_1=$LINENO
+  as_lineno_2=$LINENO
+  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
+  test "x$as_lineno_1" != "x$as_lineno_2" &&
+  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
+	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
+	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
+	     CONFIG_SHELL=$as_dir/$as_base
+	     export CONFIG_SHELL
+	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
+	   fi;;
+	 esac
+       done
+done
+;;
+  esac
 
   # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
   # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
+  # line-number line before each line; the second 'sed' does the real
+  # work.  The second script uses 'N' to pair each line-number line
+  # with the numbered line, and appends trailing '-' during
+  # substitution so that $LINENO is not a special case at line end.
   # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
+  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
+  sed '=' <$as_myself |
     sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
       N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
+      s,$,-,
+      : loop
+      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
       t loop
-      s/-\n.*//
+      s,-$,,
+      s,^['$as_cr_digits']*\n,,
     ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
+  chmod +x $as_me.lineno ||
+    { { echo "$as_me:$LINENO: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&5
+echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2;}
    { (exit 1); exit 1; }; }
 
   # Don't try to exec as it changes $[0], causing all sort of problems
   # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
+  # original and so on.  Autoconf is especially sensible to this).
+  . ./$as_me.lineno
   # Exit status is that of the last command.
   exit
 }
 
 
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
+case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
+  *c*,-n*) ECHO_N= ECHO_C='
+' ECHO_T='	' ;;
+  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
+  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
 esac
 
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+if expr a : '\(a\)' >/dev/null 2>&1; then
   as_expr=expr
 else
   as_expr=false
 fi
 
 rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir
-fi
 echo >conf$$.file
 if ln -s conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s='ln -s'
-  # ... but there are two gotchas:
-  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-  # In both cases, we have to default to `cp -p'.
-  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+  # We could just check for DJGPP; but this test a) works b) is more generic
+  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
+  if test -f conf$$.exe; then
+    # Don't use ln at all; we don't have any links
     as_ln_s='cp -p'
+  else
+    as_ln_s='ln -s'
+  fi
 elif ln conf$$.file conf$$ 2>/dev/null; then
   as_ln_s=ln
 else
   as_ln_s='cp -p'
 fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
+rm -f conf$$ conf$$.exe conf$$.file
 
 if mkdir -p . 2>/dev/null; then
   as_mkdir_p=:
 else
   test -d ./-p && rmdir ./-p
   as_mkdir_p=false
 fi
 
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-        test -d "$1/.";
-      else
-	case $1 in
-        -*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
+as_executable_p="test -f"
 
 # Sed expression to map a string onto a valid CPP name.
 as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
 
 # Sed expression to map a string onto a valid variable name.
 as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
 
 
+# IFS
+# We need space, tab and new line, in precisely that order.
+as_nl='
+'
+IFS=" 	$as_nl"
+
+# CDPATH.
+$as_unset CDPATH
+
 exec 6>&1
 
-# Save the log message, to keep $[0] and so on meaningful, and to
+# Open the log real soon, to keep \$[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.
-ac_log="
+# values after options handling.  Logging --version etc. is OK.
+exec 5>>config.log
+{
+  echo
+  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
+## Running $as_me. ##
+_ASBOX
+} >&5
+cat >&5 <<_CSEOF
+
 This file was extended by libltdl $as_me 1.2, which was
-generated by GNU Autoconf 2.61.  Invocation command line was
+generated by GNU Autoconf 2.59.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
   $ $0 $@
 
-on `(hostname || uname -n) 2>/dev/null | sed 1q`
-"
-
+_CSEOF
+echo "on `(hostname || uname -n) 2>/dev/null | sed 1q`" >&5
+echo >&5
 _ACEOF
 
-cat >>$CONFIG_STATUS <<_ACEOF
 # Files that config.status was made for.
-config_files="$ac_config_files"
-config_headers="$ac_config_headers"
-config_commands="$ac_config_commands"
+if test -n "$ac_config_files"; then
+  echo "config_files=\"$ac_config_files\"" >>$CONFIG_STATUS
+fi
 
-_ACEOF
+if test -n "$ac_config_headers"; then
+  echo "config_headers=\"$ac_config_headers\"" >>$CONFIG_STATUS
+fi
+
+if test -n "$ac_config_links"; then
+  echo "config_links=\"$ac_config_links\"" >>$CONFIG_STATUS
+fi
+
+if test -n "$ac_config_commands"; then
+  echo "config_commands=\"$ac_config_commands\"" >>$CONFIG_STATUS
+fi
 
 cat >>$CONFIG_STATUS <<\_ACEOF
+
 ac_cs_usage="\
 \`$as_me' instantiates files from templates according to the
 current configuration.
 
 Usage: $0 [OPTIONS] [FILE]...
 
@@ -22880,13 +22054,13 @@
 \`$as_me' instantiates files from templates according to the
 current configuration.
 
 Usage: $0 [OPTIONS] [FILE]...
 
   -h, --help       print this help, then exit
-  -V, --version    print version number and configuration settings, then exit
+  -V, --version    print version number, then exit
   -q, --quiet      do not print progress messages
   -d, --debug      don't remove temporary files
       --recheck    update $as_me by reconfiguring in the same conditions
   --file=FILE[:TEMPLATE]
 		   instantiate the configuration file FILE
   --header=FILE[:TEMPLATE]
@@ -22899,82 +22073,89 @@
 $config_headers
 
 Configuration commands:
 $config_commands
 
 Report bugs to <bug-autoconf@gnu.org>."
-
 _ACEOF
+
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
 libltdl config.status 1.2
-configured by $0, generated by GNU Autoconf 2.61,
-  with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
+configured by $0, generated by GNU Autoconf 2.59,
+  with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
 
-Copyright (C) 2006 Free Software Foundation, Inc.
+Copyright (C) 2003 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
-
-ac_pwd='$ac_pwd'
-srcdir='$srcdir'
-INSTALL='$INSTALL'
+srcdir=$srcdir
+INSTALL="$INSTALL"
 _ACEOF
 
 cat >>$CONFIG_STATUS <<\_ACEOF
 # If no file are specified by the user, then we need to provide default
 # value.  By we need to know if files were specified by the user.
 ac_need_defaults=:
 while test $# != 0
 do
   case $1 in
   --*=*)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
+    ac_option=`expr "x$1" : 'x\([^=]*\)='`
+    ac_optarg=`expr "x$1" : 'x[^=]*=\(.*\)'`
     ac_shift=:
     ;;
-  *)
+  -*)
     ac_option=$1
     ac_optarg=$2
     ac_shift=shift
     ;;
+  *) # This is not an option, so the user has probably given explicit
+     # arguments.
+     ac_option=$1
+     ac_need_defaults=false;;
   esac
 
   case $ac_option in
   # Handling of the options.
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
     ac_cs_recheck=: ;;
-  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
-    echo "$ac_cs_version"; exit ;;
-  --debug | --debu | --deb | --de | --d | -d )
+  --version | --vers* | -V )
+    echo "$ac_cs_version"; exit 0 ;;
+  --he | --h)
+    # Conflict between --help and --header
+    { { echo "$as_me:$LINENO: error: ambiguous option: $1
+Try \`$0 --help' for more information." >&5
+echo "$as_me: error: ambiguous option: $1
+Try \`$0 --help' for more information." >&2;}
+   { (exit 1); exit 1; }; };;
+  --help | --hel | -h )
+    echo "$ac_cs_usage"; exit 0 ;;
+  --debug | --d* | -d )
     debug=: ;;
   --file | --fil | --fi | --f )
     $ac_shift
     CONFIG_FILES="$CONFIG_FILES $ac_optarg"
     ac_need_defaults=false;;
   --header | --heade | --head | --hea )
     $ac_shift
     CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
     ac_need_defaults=false;;
-  --he | --h)
-    # Conflict between --help and --header
-    { echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit ;;
   -q | -quiet | --quiet | --quie | --qui | --qu | --q \
   | -silent | --silent | --silen | --sile | --sil | --si | --s)
     ac_cs_silent=: ;;
 
   # This is an error.
-  -*) { echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2
+  -*) { { echo "$as_me:$LINENO: error: unrecognized option: $1
+Try \`$0 --help' for more information." >&5
+echo "$as_me: error: unrecognized option: $1
+Try \`$0 --help' for more information." >&2;}
    { (exit 1); exit 1; }; } ;;
 
-  *) ac_config_targets="$ac_config_targets $1"
-     ac_need_defaults=false ;;
+  *) ac_config_targets="$ac_config_targets $1" ;;
 
   esac
   shift
 done
 
 ac_configure_extra_args=
@@ -22984,48 +22165,37 @@
   ac_configure_extra_args="$ac_configure_extra_args --silent"
 fi
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 if \$ac_cs_recheck; then
-  echo "running CONFIG_SHELL=$SHELL $SHELL $0 "$ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  CONFIG_SHELL=$SHELL
-  export CONFIG_SHELL
-  exec $SHELL "$0"$ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
+  echo "running $SHELL $0 " $ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
+  exec $SHELL $0 $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
 fi
 
 _ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-  echo "$ac_log"
-} >&5
 
-_ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 #
-# INIT-COMMANDS
+# INIT-COMMANDS section.
 #
+
 AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"
 
 _ACEOF
 
-cat >>$CONFIG_STATUS <<\_ACEOF
 
-# Handling of arguments.
+
+cat >>$CONFIG_STATUS <<\_ACEOF
 for ac_config_target in $ac_config_targets
 do
-  case $ac_config_target in
-    "config.h") CONFIG_HEADERS="$CONFIG_HEADERS config.h:config-h.in" ;;
-    "depfiles") CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
-    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-
+  case "$ac_config_target" in
+  # Handling of arguments.
+  "Makefile" ) CONFIG_FILES="$CONFIG_FILES Makefile" ;;
+  "depfiles" ) CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
+  "config.h" ) CONFIG_HEADERS="$CONFIG_HEADERS config.h:config-h.in" ;;
   *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
 echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
    { (exit 1); exit 1; }; };;
   esac
 done
 
@@ -23038,678 +22207,778 @@
   test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
   test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
   test "${CONFIG_COMMANDS+set}" = set || CONFIG_COMMANDS=$config_commands
 fi
 
 # Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason against having it here, and in addition,
+# simply because there is no reason to put it here, and in addition,
 # creating and moving files from /tmp can sometimes cause problems.
-# Hook for its removal unless debugging.
-# Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
+# Create a temporary directory, and hook for its removal unless debugging.
 $debug ||
 {
-  tmp=
-  trap 'exit_status=$?
-  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
-' 0
+  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
   trap '{ (exit 1); exit 1; }' 1 2 13 15
 }
+
 # Create a (secure) tmp directory for tmp files.
 
 {
-  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
+  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/dev/null` &&
   test -n "$tmp" && test -d "$tmp"
 }  ||
 {
-  tmp=./conf$$-$RANDOM
-  (umask 077 && mkdir "$tmp")
+  tmp=./confstat$$-$RANDOM
+  (umask 077 && mkdir $tmp)
 } ||
 {
    echo "$me: cannot create a temporary directory in ." >&2
    { (exit 1); exit 1; }
 }
 
-#
-# Set up the sed scripts for CONFIG_FILES section.
-#
-
-# No need to generate the scripts if there are no CONFIG_FILES.
-# This happens for instance when ./config.status config.h
-if test -n "$CONFIG_FILES"; then
-
-_ACEOF
-
-
-
-ac_delim='%!_!# '
-for ac_last_try in false false false false false :; do
-  cat >conf$$subs.sed <<_ACEOF
-SHELL!$SHELL$ac_delim
-PATH_SEPARATOR!$PATH_SEPARATOR$ac_delim
-PACKAGE_NAME!$PACKAGE_NAME$ac_delim
-PACKAGE_TARNAME!$PACKAGE_TARNAME$ac_delim
-PACKAGE_VERSION!$PACKAGE_VERSION$ac_delim
-PACKAGE_STRING!$PACKAGE_STRING$ac_delim
-PACKAGE_BUGREPORT!$PACKAGE_BUGREPORT$ac_delim
-exec_prefix!$exec_prefix$ac_delim
-prefix!$prefix$ac_delim
-program_transform_name!$program_transform_name$ac_delim
-bindir!$bindir$ac_delim
-sbindir!$sbindir$ac_delim
-libexecdir!$libexecdir$ac_delim
-datarootdir!$datarootdir$ac_delim
-datadir!$datadir$ac_delim
-sysconfdir!$sysconfdir$ac_delim
-sharedstatedir!$sharedstatedir$ac_delim
-localstatedir!$localstatedir$ac_delim
-includedir!$includedir$ac_delim
-oldincludedir!$oldincludedir$ac_delim
-docdir!$docdir$ac_delim
-infodir!$infodir$ac_delim
-htmldir!$htmldir$ac_delim
-dvidir!$dvidir$ac_delim
-pdfdir!$pdfdir$ac_delim
-psdir!$psdir$ac_delim
-libdir!$libdir$ac_delim
-localedir!$localedir$ac_delim
-mandir!$mandir$ac_delim
-DEFS!$DEFS$ac_delim
-ECHO_C!$ECHO_C$ac_delim
-ECHO_N!$ECHO_N$ac_delim
-ECHO_T!$ECHO_T$ac_delim
-LIBS!$LIBS$ac_delim
-build_alias!$build_alias$ac_delim
-host_alias!$host_alias$ac_delim
-target_alias!$target_alias$ac_delim
-INSTALL_PROGRAM!$INSTALL_PROGRAM$ac_delim
-INSTALL_SCRIPT!$INSTALL_SCRIPT$ac_delim
-INSTALL_DATA!$INSTALL_DATA$ac_delim
-CYGPATH_W!$CYGPATH_W$ac_delim
-PACKAGE!$PACKAGE$ac_delim
-VERSION!$VERSION$ac_delim
-ACLOCAL!$ACLOCAL$ac_delim
-AUTOCONF!$AUTOCONF$ac_delim
-AUTOMAKE!$AUTOMAKE$ac_delim
-AUTOHEADER!$AUTOHEADER$ac_delim
-MAKEINFO!$MAKEINFO$ac_delim
-install_sh!$install_sh$ac_delim
-STRIP!$STRIP$ac_delim
-INSTALL_STRIP_PROGRAM!$INSTALL_STRIP_PROGRAM$ac_delim
-mkdir_p!$mkdir_p$ac_delim
-AWK!$AWK$ac_delim
-SET_MAKE!$SET_MAKE$ac_delim
-am__leading_dot!$am__leading_dot$ac_delim
-AMTAR!$AMTAR$ac_delim
-am__tar!$am__tar$ac_delim
-am__untar!$am__untar$ac_delim
-CC!$CC$ac_delim
-CFLAGS!$CFLAGS$ac_delim
-LDFLAGS!$LDFLAGS$ac_delim
-CPPFLAGS!$CPPFLAGS$ac_delim
-ac_ct_CC!$ac_ct_CC$ac_delim
-EXEEXT!$EXEEXT$ac_delim
-OBJEXT!$OBJEXT$ac_delim
-DEPDIR!$DEPDIR$ac_delim
-am__include!$am__include$ac_delim
-am__quote!$am__quote$ac_delim
-AMDEP_TRUE!$AMDEP_TRUE$ac_delim
-AMDEP_FALSE!$AMDEP_FALSE$ac_delim
-AMDEPBACKSLASH!$AMDEPBACKSLASH$ac_delim
-CCDEPMODE!$CCDEPMODE$ac_delim
-am__fastdepCC_TRUE!$am__fastdepCC_TRUE$ac_delim
-am__fastdepCC_FALSE!$am__fastdepCC_FALSE$ac_delim
-build!$build$ac_delim
-build_cpu!$build_cpu$ac_delim
-build_vendor!$build_vendor$ac_delim
-build_os!$build_os$ac_delim
-host!$host$ac_delim
-host_cpu!$host_cpu$ac_delim
-host_vendor!$host_vendor$ac_delim
-host_os!$host_os$ac_delim
-SED!$SED$ac_delim
-GREP!$GREP$ac_delim
-EGREP!$EGREP$ac_delim
-LN_S!$LN_S$ac_delim
-ECHO!$ECHO$ac_delim
-AR!$AR$ac_delim
-RANLIB!$RANLIB$ac_delim
-DLLTOOL!$DLLTOOL$ac_delim
-AS!$AS$ac_delim
-OBJDUMP!$OBJDUMP$ac_delim
-CPP!$CPP$ac_delim
-CXX!$CXX$ac_delim
-CXXFLAGS!$CXXFLAGS$ac_delim
-ac_ct_CXX!$ac_ct_CXX$ac_delim
-CXXDEPMODE!$CXXDEPMODE$ac_delim
 _ACEOF
 
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 97; then
-    break
-  elif $ac_last_try; then
-    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
-echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
-   { (exit 1); exit 1; }; }
-  else
-    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
-  fi
-done
-
-ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
-if test -n "$ac_eof"; then
-  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
-  ac_eof=`expr $ac_eof + 1`
-fi
-
 cat >>$CONFIG_STATUS <<_ACEOF
-cat >"\$tmp/subs-1.sed" <<\CEOF$ac_eof
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-_ACEOF
-sed '
-s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
-s/^/s,@/; s/!/@,|#_!!_#|/
-:n
-t n
-s/'"$ac_delim"'$/,g/; t
-s/$/\\/; p
-N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
-' >>$CONFIG_STATUS <conf$$subs.sed
-rm -f conf$$subs.sed
-cat >>$CONFIG_STATUS <<_ACEOF
-CEOF$ac_eof
-_ACEOF
 
+#
+# CONFIG_FILES section.
+#
 
-ac_delim='%!_!# '
-for ac_last_try in false false false false false :; do
-  cat >conf$$subs.sed <<_ACEOF
-am__fastdepCXX_TRUE!$am__fastdepCXX_TRUE$ac_delim
-am__fastdepCXX_FALSE!$am__fastdepCXX_FALSE$ac_delim
-CXXCPP!$CXXCPP$ac_delim
-F77!$F77$ac_delim
-FFLAGS!$FFLAGS$ac_delim
-ac_ct_F77!$ac_ct_F77$ac_delim
-LIBTOOL!$LIBTOOL$ac_delim
-LIBTOOL_DEPS!$LIBTOOL_DEPS$ac_delim
-INSTALL_LTDL_TRUE!$INSTALL_LTDL_TRUE$ac_delim
-INSTALL_LTDL_FALSE!$INSTALL_LTDL_FALSE$ac_delim
-CONVENIENCE_LTDL_TRUE!$CONVENIENCE_LTDL_TRUE$ac_delim
-CONVENIENCE_LTDL_FALSE!$CONVENIENCE_LTDL_FALSE$ac_delim
-LIBADD_DL!$LIBADD_DL$ac_delim
-LIBOBJS!$LIBOBJS$ac_delim
-LTLIBOBJS!$LTLIBOBJS$ac_delim
-_ACEOF
-
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 15; then
-    break
-  elif $ac_last_try; then
-    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
-echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
-   { (exit 1); exit 1; }; }
-  else
-    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
+# No need to generate the scripts if there are no CONFIG_FILES.
+# This happens for instance when ./config.status config.h
+if test -n "\$CONFIG_FILES"; then
+  # Protect against being on the right side of a sed subst in config.status.
+  sed 's/,@/@@/; s/@,/@@/; s/,;t t\$/@;t t/; /@;t t\$/s/[\\\\&,]/\\\\&/g;
+   s/@@/,@/; s/@@/@,/; s/@;t t\$/,;t t/' >\$tmp/subs.sed <<\\CEOF
+s,@SHELL@,$SHELL,;t t
+s,@PATH_SEPARATOR@,$PATH_SEPARATOR,;t t
+s,@PACKAGE_NAME@,$PACKAGE_NAME,;t t
+s,@PACKAGE_TARNAME@,$PACKAGE_TARNAME,;t t
+s,@PACKAGE_VERSION@,$PACKAGE_VERSION,;t t
+s,@PACKAGE_STRING@,$PACKAGE_STRING,;t t
+s,@PACKAGE_BUGREPORT@,$PACKAGE_BUGREPORT,;t t
+s,@exec_prefix@,$exec_prefix,;t t
+s,@prefix@,$prefix,;t t
+s,@program_transform_name@,$program_transform_name,;t t
+s,@bindir@,$bindir,;t t
+s,@sbindir@,$sbindir,;t t
+s,@libexecdir@,$libexecdir,;t t
+s,@datadir@,$datadir,;t t
+s,@sysconfdir@,$sysconfdir,;t t
+s,@sharedstatedir@,$sharedstatedir,;t t
+s,@localstatedir@,$localstatedir,;t t
+s,@libdir@,$libdir,;t t
+s,@includedir@,$includedir,;t t
+s,@oldincludedir@,$oldincludedir,;t t
+s,@infodir@,$infodir,;t t
+s,@mandir@,$mandir,;t t
+s,@build_alias@,$build_alias,;t t
+s,@host_alias@,$host_alias,;t t
+s,@target_alias@,$target_alias,;t t
+s,@DEFS@,$DEFS,;t t
+s,@ECHO_C@,$ECHO_C,;t t
+s,@ECHO_N@,$ECHO_N,;t t
+s,@ECHO_T@,$ECHO_T,;t t
+s,@LIBS@,$LIBS,;t t
+s,@INSTALL_PROGRAM@,$INSTALL_PROGRAM,;t t
+s,@INSTALL_SCRIPT@,$INSTALL_SCRIPT,;t t
+s,@INSTALL_DATA@,$INSTALL_DATA,;t t
+s,@CYGPATH_W@,$CYGPATH_W,;t t
+s,@PACKAGE@,$PACKAGE,;t t
+s,@VERSION@,$VERSION,;t t
+s,@ACLOCAL@,$ACLOCAL,;t t
+s,@AUTOCONF@,$AUTOCONF,;t t
+s,@AUTOMAKE@,$AUTOMAKE,;t t
+s,@AUTOHEADER@,$AUTOHEADER,;t t
+s,@MAKEINFO@,$MAKEINFO,;t t
+s,@install_sh@,$install_sh,;t t
+s,@STRIP@,$STRIP,;t t
+s,@ac_ct_STRIP@,$ac_ct_STRIP,;t t
+s,@INSTALL_STRIP_PROGRAM@,$INSTALL_STRIP_PROGRAM,;t t
+s,@mkdir_p@,$mkdir_p,;t t
+s,@AWK@,$AWK,;t t
+s,@SET_MAKE@,$SET_MAKE,;t t
+s,@am__leading_dot@,$am__leading_dot,;t t
+s,@AMTAR@,$AMTAR,;t t
+s,@am__tar@,$am__tar,;t t
+s,@am__untar@,$am__untar,;t t
+s,@CC@,$CC,;t t
+s,@CFLAGS@,$CFLAGS,;t t
+s,@LDFLAGS@,$LDFLAGS,;t t
+s,@CPPFLAGS@,$CPPFLAGS,;t t
+s,@ac_ct_CC@,$ac_ct_CC,;t t
+s,@EXEEXT@,$EXEEXT,;t t
+s,@OBJEXT@,$OBJEXT,;t t
+s,@DEPDIR@,$DEPDIR,;t t
+s,@am__include@,$am__include,;t t
+s,@am__quote@,$am__quote,;t t
+s,@AMDEP_TRUE@,$AMDEP_TRUE,;t t
+s,@AMDEP_FALSE@,$AMDEP_FALSE,;t t
+s,@AMDEPBACKSLASH@,$AMDEPBACKSLASH,;t t
+s,@CCDEPMODE@,$CCDEPMODE,;t t
+s,@am__fastdepCC_TRUE@,$am__fastdepCC_TRUE,;t t
+s,@am__fastdepCC_FALSE@,$am__fastdepCC_FALSE,;t t
+s,@build@,$build,;t t
+s,@build_cpu@,$build_cpu,;t t
+s,@build_vendor@,$build_vendor,;t t
+s,@build_os@,$build_os,;t t
+s,@host@,$host,;t t
+s,@host_cpu@,$host_cpu,;t t
+s,@host_vendor@,$host_vendor,;t t
+s,@host_os@,$host_os,;t t
+s,@EGREP@,$EGREP,;t t
+s,@LN_S@,$LN_S,;t t
+s,@ECHO@,$ECHO,;t t
+s,@AR@,$AR,;t t
+s,@ac_ct_AR@,$ac_ct_AR,;t t
+s,@RANLIB@,$RANLIB,;t t
+s,@ac_ct_RANLIB@,$ac_ct_RANLIB,;t t
+s,@DLLTOOL@,$DLLTOOL,;t t
+s,@ac_ct_DLLTOOL@,$ac_ct_DLLTOOL,;t t
+s,@AS@,$AS,;t t
+s,@ac_ct_AS@,$ac_ct_AS,;t t
+s,@OBJDUMP@,$OBJDUMP,;t t
+s,@ac_ct_OBJDUMP@,$ac_ct_OBJDUMP,;t t
+s,@CPP@,$CPP,;t t
+s,@CXX@,$CXX,;t t
+s,@CXXFLAGS@,$CXXFLAGS,;t t
+s,@ac_ct_CXX@,$ac_ct_CXX,;t t
+s,@CXXDEPMODE@,$CXXDEPMODE,;t t
+s,@am__fastdepCXX_TRUE@,$am__fastdepCXX_TRUE,;t t
+s,@am__fastdepCXX_FALSE@,$am__fastdepCXX_FALSE,;t t
+s,@CXXCPP@,$CXXCPP,;t t
+s,@F77@,$F77,;t t
+s,@FFLAGS@,$FFLAGS,;t t
+s,@ac_ct_F77@,$ac_ct_F77,;t t
+s,@LIBTOOL@,$LIBTOOL,;t t
+s,@LIBTOOL_DEPS@,$LIBTOOL_DEPS,;t t
+s,@INSTALL_LTDL_TRUE@,$INSTALL_LTDL_TRUE,;t t
+s,@INSTALL_LTDL_FALSE@,$INSTALL_LTDL_FALSE,;t t
+s,@CONVENIENCE_LTDL_TRUE@,$CONVENIENCE_LTDL_TRUE,;t t
+s,@CONVENIENCE_LTDL_FALSE@,$CONVENIENCE_LTDL_FALSE,;t t
+s,@LIBADD_DL@,$LIBADD_DL,;t t
+s,@LIBOBJS@,$LIBOBJS,;t t
+s,@LTLIBOBJS@,$LTLIBOBJS,;t t
+CEOF
+
+_ACEOF
+
+  cat >>$CONFIG_STATUS <<\_ACEOF
+  # Split the substitutions into bite-sized pieces for seds with
+  # small command number limits, like on Digital OSF/1 and HP-UX.
+  ac_max_sed_lines=48
+  ac_sed_frag=1 # Number of current file.
+  ac_beg=1 # First line for current file.
+  ac_end=$ac_max_sed_lines # Line after last line for current file.
+  ac_more_lines=:
+  ac_sed_cmds=
+  while $ac_more_lines; do
+    if test $ac_beg -gt 1; then
+      sed "1,${ac_beg}d; ${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
+    else
+      sed "${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
+    fi
+    if test ! -s $tmp/subs.frag; then
+      ac_more_lines=false
+    else
+      # The purpose of the label and of the branching condition is to
+      # speed up the sed processing (if there are no `@' at all, there
+      # is no need to browse any of the substitutions).
+      # These are the two extra sed commands mentioned above.
+      (echo ':t
+  /@[a-zA-Z_][a-zA-Z_0-9]*@/!b' && cat $tmp/subs.frag) >$tmp/subs-$ac_sed_frag.sed
+      if test -z "$ac_sed_cmds"; then
+	ac_sed_cmds="sed -f $tmp/subs-$ac_sed_frag.sed"
+      else
+	ac_sed_cmds="$ac_sed_cmds | sed -f $tmp/subs-$ac_sed_frag.sed"
+      fi
+      ac_sed_frag=`expr $ac_sed_frag + 1`
+      ac_beg=$ac_end
+      ac_end=`expr $ac_end + $ac_max_sed_lines`
+    fi
+  done
+  if test -z "$ac_sed_cmds"; then
+    ac_sed_cmds=cat
   fi
-done
-
-ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
-if test -n "$ac_eof"; then
-  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
-  ac_eof=`expr $ac_eof + 1`
-fi
+fi # test -n "$CONFIG_FILES"
 
-cat >>$CONFIG_STATUS <<_ACEOF
-cat >"\$tmp/subs-2.sed" <<\CEOF$ac_eof
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b end
 _ACEOF
-sed '
-s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
-s/^/s,@/; s/!/@,|#_!!_#|/
-:n
-t n
-s/'"$ac_delim"'$/,g/; t
-s/$/\\/; p
-N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
-' >>$CONFIG_STATUS <conf$$subs.sed
-rm -f conf$$subs.sed
-cat >>$CONFIG_STATUS <<_ACEOF
-:end
-s/|#_!!_#|//g
-CEOF$ac_eof
-_ACEOF
-
-
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/
-s/:*\${srcdir}:*/:/
-s/:*@srcdir@:*/:/
-s/^\([^=]*=[	 ]*\):*/\1/
-s/:*$//
-s/^[^=]*=[	 ]*$//
-}'
-fi
-
 cat >>$CONFIG_STATUS <<\_ACEOF
-fi # test -n "$CONFIG_FILES"
-
-
-for ac_tag in  :F $CONFIG_FILES  :H $CONFIG_HEADERS    :C $CONFIG_COMMANDS
-do
-  case $ac_tag in
-  :[FHLC]) ac_mode=$ac_tag; continue;;
-  esac
-  case $ac_mode$ac_tag in
-  :[FHL]*:*);;
-  :L* | :C*:*) { { echo "$as_me:$LINENO: error: Invalid tag $ac_tag." >&5
-echo "$as_me: error: Invalid tag $ac_tag." >&2;}
-   { (exit 1); exit 1; }; };;
-  :[FH]-) ac_tag=-:-;;
-  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
-  esac
-  ac_save_IFS=$IFS
-  IFS=:
-  set x $ac_tag
-  IFS=$ac_save_IFS
-  shift
-  ac_file=$1
-  shift
-
-  case $ac_mode in
-  :L) ac_source=$1;;
-  :[FH])
-    ac_file_inputs=
-    for ac_f
-    do
-      case $ac_f in
-      -) ac_f="$tmp/stdin";;
-      *) # Look for the file first in the build tree, then in the source tree
-	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
-	 test -f "$ac_f" ||
-	   case $ac_f in
-	   [\\/$]*) false;;
-	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
-	   esac ||
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
-echo "$as_me: error: cannot find input file: $ac_f" >&2;}
-   { (exit 1); exit 1; }; };;
-      esac
-      ac_file_inputs="$ac_file_inputs $ac_f"
-    done
-
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
-    # use $as_me), people would be surprised to read:
-    #    /* config.h.  Generated by config.status.  */
-    configure_input="Generated from "`IFS=:
-	  echo $* | sed 's|^[^:]*/||;s|:[^:]*/|, |g'`" by configure."
-    if test x"$ac_file" != x-; then
-      configure_input="$ac_file.  $configure_input"
-      { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    fi
-
-    case $ac_tag in
-    *:-:* | *:-) cat >"$tmp/stdin";;
-    esac
-    ;;
+for ac_file in : $CONFIG_FILES; do test "x$ac_file" = x: && continue
+  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
+  case $ac_file in
+  - | *:- | *:-:* ) # input from stdin
+	cat >$tmp/stdin
+	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
+	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
+  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
+	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
+  * )   ac_file_in=$ac_file.in ;;
   esac
 
-  ac_dir=`$as_dirname -- "$ac_file" ||
+  # Compute @srcdir@, @top_srcdir@, and @INSTALL@ for subdirectories.
+  ac_dir=`(dirname "$ac_file") 2>/dev/null ||
 $as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$ac_file" : 'X\(//\)[^/]' \| \
 	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$ac_file" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
-  { as_dir="$ac_dir"
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
+  { if $as_mkdir_p; then
+    mkdir -p "$ac_dir"
+  else
+    as_dir="$ac_dir"
     as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
+    while test ! -d "$as_dir"; do
+      as_dirs="$as_dir $as_dirs"
+      as_dir=`(dirname "$as_dir") 2>/dev/null ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$as_dir" : 'X\(//\)[^/]' \| \
 	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$as_dir" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
-      test -d "$as_dir" && break
     done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
-echo "$as_me: error: cannot create directory $as_dir" >&2;}
+    test ! -n "$as_dirs" || mkdir $as_dirs
+  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
+echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
    { (exit 1); exit 1; }; }; }
+
   ac_builddir=.
 
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
+if test "$ac_dir" != .; then
   ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
+  # A "../" for each directory in $ac_dir_suffix.
+  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
+else
+  ac_dir_suffix= ac_top_builddir=
+fi
 
 case $srcdir in
-  .)  # We are building in place.
+  .)  # No --srcdir option.  We are building in place.
     ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
+    if test -z "$ac_top_builddir"; then
+       ac_top_srcdir=.
+    else
+       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
+    fi ;;
+  [\\/]* | ?:[\\/]* )  # Absolute path.
     ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+    ac_top_srcdir=$srcdir ;;
+  *) # Relative path.
+    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_builddir$srcdir ;;
 esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
 
+# Do not use `cd foo && pwd` to compute absolute paths, because
+# the directories may not exist.
+case `pwd` in
+.) ac_abs_builddir="$ac_dir";;
+*)
+  case "$ac_dir" in
+  .) ac_abs_builddir=`pwd`;;
+  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
+  *) ac_abs_builddir=`pwd`/"$ac_dir";;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_builddir=${ac_top_builddir}.;;
+*)
+  case ${ac_top_builddir}. in
+  .) ac_abs_top_builddir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
+  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_srcdir=$ac_srcdir;;
+*)
+  case $ac_srcdir in
+  .) ac_abs_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
+  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_srcdir=$ac_top_srcdir;;
+*)
+  case $ac_top_srcdir in
+  .) ac_abs_top_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
+  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
+  esac;;
+esac
 
-  case $ac_mode in
-  :F)
-  #
-  # CONFIG_FILE
-  #
 
   case $INSTALL in
   [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
-  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
+  *) ac_INSTALL=$ac_top_builddir$INSTALL ;;
   esac
-_ACEOF
 
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If the template does not know about datarootdir, expand it.
-# FIXME: This hack should be removed a few years after 2.60.
-ac_datarootdir_hack=; ac_datarootdir_seen=
-
-case `sed -n '/datarootdir/ {
-  p
-  q
-}
-/@datadir@/p
-/@docdir@/p
-/@infodir@/p
-/@localedir@/p
-/@mandir@/p
-' $ac_file_inputs` in
-*datarootdir*) ac_datarootdir_seen=yes;;
-*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
-  { echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
-echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-  ac_datarootdir_hack='
-  s&@datadir@&$datadir&g
-  s&@docdir@&$docdir&g
-  s&@infodir@&$infodir&g
-  s&@localedir@&$localedir&g
-  s&@mandir@&$mandir&g
-    s&\\\${datarootdir}&$datarootdir&g' ;;
-esac
-_ACEOF
+  # Let's still pretend it is `configure' which instantiates (i.e., don't
+  # use $as_me), people would be surprised to read:
+  #    /* config.h.  Generated by config.status.  */
+  if test x"$ac_file" = x-; then
+    configure_input=
+  else
+    configure_input="$ac_file.  "
+  fi
+  configure_input=$configure_input"Generated from `echo $ac_file_in |
+				     sed 's,.*/,,'` by configure."
+
+  # First look for the input files in the build tree, otherwise in the
+  # src tree.
+  ac_file_inputs=`IFS=:
+    for f in $ac_file_in; do
+      case $f in
+      -) echo $tmp/stdin ;;
+      [\\/$]*)
+	 # Absolute (can't be DOS-style, as IFS=:)
+	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
+echo "$as_me: error: cannot find input file: $f" >&2;}
+   { (exit 1); exit 1; }; }
+	 echo "$f";;
+      *) # Relative
+	 if test -f "$f"; then
+	   # Build tree
+	   echo "$f"
+	 elif test -f "$srcdir/$f"; then
+	   # Source tree
+	   echo "$srcdir/$f"
+	 else
+	   # /dev/null tree
+	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
+echo "$as_me: error: cannot find input file: $f" >&2;}
+   { (exit 1); exit 1; }; }
+	 fi;;
+      esac
+    done` || { (exit 1); exit 1; }
 
-# Neutralize VPATH when `$srcdir' = `.'.
-# Shell code in configure.ac might set extrasub.
-# FIXME: do we really want to maintain this feature?
+  if test x"$ac_file" != x-; then
+    { echo "$as_me:$LINENO: creating $ac_file" >&5
+echo "$as_me: creating $ac_file" >&6;}
+    rm -f "$ac_file"
+  fi
+_ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
   sed "$ac_vpsub
 $extrasub
 _ACEOF
 cat >>$CONFIG_STATUS <<\_ACEOF
 :t
 /@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s&@configure_input@&$configure_input&;t t
-s&@top_builddir@&$ac_top_builddir_sub&;t t
-s&@srcdir@&$ac_srcdir&;t t
-s&@abs_srcdir@&$ac_abs_srcdir&;t t
-s&@top_srcdir@&$ac_top_srcdir&;t t
-s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
-s&@builddir@&$ac_builddir&;t t
-s&@abs_builddir@&$ac_abs_builddir&;t t
-s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
-s&@INSTALL@&$ac_INSTALL&;t t
-$ac_datarootdir_hack
-" $ac_file_inputs | sed -f "$tmp/subs-1.sed" | sed -f "$tmp/subs-2.sed" >$tmp/out
-
-test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
-  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
-  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
-  { echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&5
-echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&2;}
+s,@configure_input@,$configure_input,;t t
+s,@srcdir@,$ac_srcdir,;t t
+s,@abs_srcdir@,$ac_abs_srcdir,;t t
+s,@top_srcdir@,$ac_top_srcdir,;t t
+s,@abs_top_srcdir@,$ac_abs_top_srcdir,;t t
+s,@builddir@,$ac_builddir,;t t
+s,@abs_builddir@,$ac_abs_builddir,;t t
+s,@top_builddir@,$ac_top_builddir,;t t
+s,@abs_top_builddir@,$ac_abs_top_builddir,;t t
+s,@INSTALL@,$ac_INSTALL,;t t
+" $ac_file_inputs | (eval "$ac_sed_cmds") >$tmp/out
+  rm -f $tmp/stdin
+  if test x"$ac_file" != x-; then
+    mv $tmp/out $ac_file
+  else
+    cat $tmp/out
+    rm -f $tmp/out
+  fi
 
-  rm -f "$tmp/stdin"
-  case $ac_file in
-  -) cat "$tmp/out"; rm -f "$tmp/out";;
-  *) rm -f "$ac_file"; mv "$tmp/out" $ac_file;;
-  esac
- ;;
-  :H)
-  #
-  # CONFIG_HEADER
-  #
+done
 _ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF
+
+#
+# CONFIG_HEADER section.
+#
 
-# Transform confdefs.h into a sed script `conftest.defines', that
-# substitutes the proper values into config.h.in to produce config.h.
-rm -f conftest.defines conftest.tail
-# First, append a space to every undef/define line, to ease matching.
-echo 's/$/ /' >conftest.defines
-# Then, protect against being on the right side of a sed subst, or in
-# an unquoted here document, in config.status.  If some macros were
-# called several times there might be several #defines for the same
-# symbol, which is useless.  But do not sort them, since the last
-# AC_DEFINE must be honored.
-ac_word_re=[_$as_cr_Letters][_$as_cr_alnum]*
-# These sed commands are passed to sed as "A NAME B PARAMS C VALUE D", where
-# NAME is the cpp macro being defined, VALUE is the value it is being given.
-# PARAMS is the parameter list in the macro definition--in most cases, it's
-# just an empty string.
-ac_dA='s,^\\([	 #]*\\)[^	 ]*\\([	 ]*'
-ac_dB='\\)[	 (].*,\\1define\\2'
+# These sed commands are passed to sed as "A NAME B NAME C VALUE D", where
+# NAME is the cpp macro being defined and VALUE is the value it is being given.
+#
+# ac_d sets the value in "#define NAME VALUE" lines.
+ac_dA='s,^\([	 ]*\)#\([	 ]*define[	 ][	 ]*\)'
+ac_dB='[	 ].*$,\1#\2'
 ac_dC=' '
-ac_dD=' ,'
+ac_dD=',;t'
+# ac_u turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
+ac_uA='s,^\([	 ]*\)#\([	 ]*\)undef\([	 ][	 ]*\)'
+ac_uB='$,\1#\2define\3'
+ac_uC=' '
+ac_uD=',;t'
+
+for ac_file in : $CONFIG_HEADERS; do test "x$ac_file" = x: && continue
+  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
+  case $ac_file in
+  - | *:- | *:-:* ) # input from stdin
+	cat >$tmp/stdin
+	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
+	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
+  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
+	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
+  * )   ac_file_in=$ac_file.in ;;
+  esac
+
+  test x"$ac_file" != x- && { echo "$as_me:$LINENO: creating $ac_file" >&5
+echo "$as_me: creating $ac_file" >&6;}
 
-uniq confdefs.h |
-  sed -n '
-	t rset
-	:rset
-	s/^[	 ]*#[	 ]*define[	 ][	 ]*//
-	t ok
-	d
-	:ok
-	s/[\\&,]/\\&/g
-	s/^\('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/ '"$ac_dA"'\1'"$ac_dB"'\2'"${ac_dC}"'\3'"$ac_dD"'/p
-	s/^\('"$ac_word_re"'\)[	 ]*\(.*\)/'"$ac_dA"'\1'"$ac_dB$ac_dC"'\2'"$ac_dD"'/p
-  ' >>conftest.defines
+  # First look for the input files in the build tree, otherwise in the
+  # src tree.
+  ac_file_inputs=`IFS=:
+    for f in $ac_file_in; do
+      case $f in
+      -) echo $tmp/stdin ;;
+      [\\/$]*)
+	 # Absolute (can't be DOS-style, as IFS=:)
+	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
+echo "$as_me: error: cannot find input file: $f" >&2;}
+   { (exit 1); exit 1; }; }
+	 # Do quote $f, to prevent DOS paths from being IFS'd.
+	 echo "$f";;
+      *) # Relative
+	 if test -f "$f"; then
+	   # Build tree
+	   echo "$f"
+	 elif test -f "$srcdir/$f"; then
+	   # Source tree
+	   echo "$srcdir/$f"
+	 else
+	   # /dev/null tree
+	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
+echo "$as_me: error: cannot find input file: $f" >&2;}
+   { (exit 1); exit 1; }; }
+	 fi;;
+      esac
+    done` || { (exit 1); exit 1; }
+  # Remove the trailing spaces.
+  sed 's/[	 ]*$//' $ac_file_inputs >$tmp/in
 
-# Remove the space that was appended to ease matching.
-# Then replace #undef with comments.  This is necessary, for
+_ACEOF
+
+# Transform confdefs.h into two sed scripts, `conftest.defines' and
+# `conftest.undefs', that substitutes the proper values into
+# config.h.in to produce config.h.  The first handles `#define'
+# templates, and the second `#undef' templates.
+# And first: Protect against being on the right side of a sed subst in
+# config.status.  Protect against being in an unquoted here document
+# in config.status.
+rm -f conftest.defines conftest.undefs
+# Using a here document instead of a string reduces the quoting nightmare.
+# Putting comments in sed scripts is not portable.
+#
+# `end' is used to avoid that the second main sed command (meant for
+# 0-ary CPP macros) applies to n-ary macro definitions.
+# See the Autoconf documentation for `clear'.
+cat >confdef2sed.sed <<\_ACEOF
+s/[\\&,]/\\&/g
+s,[\\$`],\\&,g
+t clear
+: clear
+s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*\)\(([^)]*)\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1\2${ac_dC}\3${ac_dD},gp
+t end
+s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD},gp
+: end
+_ACEOF
+# If some macros were called several times there might be several times
+# the same #defines, which is useless.  Nevertheless, we may not want to
+# sort them, since we want the *last* AC-DEFINE to be honored.
+uniq confdefs.h | sed -n -f confdef2sed.sed >conftest.defines
+sed 's/ac_d/ac_u/g' conftest.defines >conftest.undefs
+rm -f confdef2sed.sed
+
+# This sed command replaces #undef with comments.  This is necessary, for
 # example, in the case of _POSIX_SOURCE, which is predefined and required
 # on some systems where configure will not decide to define it.
-# (The regexp can be short, since the line contains either #define or #undef.)
-echo 's/ $//
-s,^[	 #]*u.*,/* & */,' >>conftest.defines
-
-# Break up conftest.defines:
-ac_max_sed_lines=50
-
-# First sed command is:	 sed -f defines.sed $ac_file_inputs >"$tmp/out1"
-# Second one is:	 sed -f defines.sed "$tmp/out1" >"$tmp/out2"
-# Third one will be:	 sed -f defines.sed "$tmp/out2" >"$tmp/out1"
-# et cetera.
-ac_in='$ac_file_inputs'
-ac_out='"$tmp/out1"'
-ac_nxt='"$tmp/out2"'
+cat >>conftest.undefs <<\_ACEOF
+s,^[	 ]*#[	 ]*undef[	 ][	 ]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,
+_ACEOF
 
-while :
+# Break up conftest.defines because some shells have a limit on the size
+# of here documents, and old seds have small limits too (100 cmds).
+echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS
+echo '  if grep "^[	 ]*#[	 ]*define" $tmp/in >/dev/null; then' >>$CONFIG_STATUS
+echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS
+echo '  :' >>$CONFIG_STATUS
+rm -f conftest.tail
+while grep . conftest.defines >/dev/null
 do
-  # Write a here document:
-    cat >>$CONFIG_STATUS <<_ACEOF
-    # First, check the format of the line:
-    cat >"\$tmp/defines.sed" <<\\CEOF
-/^[	 ]*#[	 ]*undef[	 ][	 ]*$ac_word_re[	 ]*\$/b def
-/^[	 ]*#[	 ]*define[	 ][	 ]*$ac_word_re[(	 ]/b def
-b
-:def
-_ACEOF
-  sed ${ac_max_sed_lines}q conftest.defines >>$CONFIG_STATUS
+  # Write a limited-size here document to $tmp/defines.sed.
+  echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS
+  # Speed up: don't consider the non `#define' lines.
+  echo '/^[	 ]*#[	 ]*define/!b' >>$CONFIG_STATUS
+  # Work around the forget-to-reset-the-flag bug.
+  echo 't clr' >>$CONFIG_STATUS
+  echo ': clr' >>$CONFIG_STATUS
+  sed ${ac_max_here_lines}q conftest.defines >>$CONFIG_STATUS
   echo 'CEOF
-    sed -f "$tmp/defines.sed"' "$ac_in >$ac_out" >>$CONFIG_STATUS
-  ac_in=$ac_out; ac_out=$ac_nxt; ac_nxt=$ac_in
-  sed 1,${ac_max_sed_lines}d conftest.defines >conftest.tail
-  grep . conftest.tail >/dev/null || break
+  sed -f $tmp/defines.sed $tmp/in >$tmp/out
+  rm -f $tmp/in
+  mv $tmp/out $tmp/in
+' >>$CONFIG_STATUS
+  sed 1,${ac_max_here_lines}d conftest.defines >conftest.tail
   rm -f conftest.defines
   mv conftest.tail conftest.defines
 done
-rm -f conftest.defines conftest.tail
+rm -f conftest.defines
+echo '  fi # grep' >>$CONFIG_STATUS
+echo >>$CONFIG_STATUS
+
+# Break up conftest.undefs because some shells have a limit on the size
+# of here documents, and old seds have small limits too (100 cmds).
+echo '  # Handle all the #undef templates' >>$CONFIG_STATUS
+rm -f conftest.tail
+while grep . conftest.undefs >/dev/null
+do
+  # Write a limited-size here document to $tmp/undefs.sed.
+  echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS
+  # Speed up: don't consider the non `#undef'
+  echo '/^[	 ]*#[	 ]*undef/!b' >>$CONFIG_STATUS
+  # Work around the forget-to-reset-the-flag bug.
+  echo 't clr' >>$CONFIG_STATUS
+  echo ': clr' >>$CONFIG_STATUS
+  sed ${ac_max_here_lines}q conftest.undefs >>$CONFIG_STATUS
+  echo 'CEOF
+  sed -f $tmp/undefs.sed $tmp/in >$tmp/out
+  rm -f $tmp/in
+  mv $tmp/out $tmp/in
+' >>$CONFIG_STATUS
+  sed 1,${ac_max_here_lines}d conftest.undefs >conftest.tail
+  rm -f conftest.undefs
+  mv conftest.tail conftest.undefs
+done
+rm -f conftest.undefs
 
-echo "ac_result=$ac_in" >>$CONFIG_STATUS
 cat >>$CONFIG_STATUS <<\_ACEOF
+  # Let's still pretend it is `configure' which instantiates (i.e., don't
+  # use $as_me), people would be surprised to read:
+  #    /* config.h.  Generated by config.status.  */
+  if test x"$ac_file" = x-; then
+    echo "/* Generated by configure.  */" >$tmp/config.h
+  else
+    echo "/* $ac_file.  Generated by configure.  */" >$tmp/config.h
+  fi
+  cat $tmp/in >>$tmp/config.h
+  rm -f $tmp/in
   if test x"$ac_file" != x-; then
-    echo "/* $configure_input  */" >"$tmp/config.h"
-    cat "$ac_result" >>"$tmp/config.h"
-    if diff $ac_file "$tmp/config.h" >/dev/null 2>&1; then
+    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then
       { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
 echo "$as_me: $ac_file is unchanged" >&6;}
     else
+      ac_dir=`(dirname "$ac_file") 2>/dev/null ||
+$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$ac_file" : 'X\(//\)[^/]' \| \
+	 X"$ac_file" : 'X\(//\)$' \| \
+	 X"$ac_file" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
+echo X"$ac_file" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
+  	  s/.*/./; q'`
+      { if $as_mkdir_p; then
+    mkdir -p "$ac_dir"
+  else
+    as_dir="$ac_dir"
+    as_dirs=
+    while test ! -d "$as_dir"; do
+      as_dirs="$as_dir $as_dirs"
+      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
+echo X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
+  	  s/.*/./; q'`
+    done
+    test ! -n "$as_dirs" || mkdir $as_dirs
+  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
+echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
+   { (exit 1); exit 1; }; }; }
+
       rm -f $ac_file
-      mv "$tmp/config.h" $ac_file
+      mv $tmp/config.h $ac_file
     fi
   else
-    echo "/* $configure_input  */"
-    cat "$ac_result"
+    cat $tmp/config.h
+    rm -f $tmp/config.h
   fi
-  rm -f "$tmp/out12"
 # Compute $ac_file's index in $config_headers.
 _am_stamp_count=1
 for _am_header in $config_headers :; do
   case $_am_header in
     $ac_file | $ac_file:* )
       break ;;
     * )
       _am_stamp_count=`expr $_am_stamp_count + 1` ;;
   esac
 done
-echo "timestamp for $ac_file" >`$as_dirname -- $ac_file ||
+echo "timestamp for $ac_file" >`(dirname $ac_file) 2>/dev/null ||
 $as_expr X$ac_file : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X$ac_file : 'X\(//\)[^/]' \| \
 	 X$ac_file : 'X\(//\)$' \| \
-	 X$ac_file : 'X\(/\)' \| . 2>/dev/null ||
+	 X$ac_file : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X$ac_file |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`/stamp-h$_am_stamp_count
- ;;
+done
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF
 
-  :C)  { echo "$as_me:$LINENO: executing $ac_file commands" >&5
-echo "$as_me: executing $ac_file commands" >&6;}
- ;;
-  esac
+#
+# CONFIG_COMMANDS section.
+#
+for ac_file in : $CONFIG_COMMANDS; do test "x$ac_file" = x: && continue
+  ac_dest=`echo "$ac_file" | sed 's,:.*,,'`
+  ac_source=`echo "$ac_file" | sed 's,[^:]*:,,'`
+  ac_dir=`(dirname "$ac_dest") 2>/dev/null ||
+$as_expr X"$ac_dest" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$ac_dest" : 'X\(//\)[^/]' \| \
+	 X"$ac_dest" : 'X\(//\)$' \| \
+	 X"$ac_dest" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
+echo X"$ac_dest" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
+  	  s/.*/./; q'`
+  { if $as_mkdir_p; then
+    mkdir -p "$ac_dir"
+  else
+    as_dir="$ac_dir"
+    as_dirs=
+    while test ! -d "$as_dir"; do
+      as_dirs="$as_dir $as_dirs"
+      as_dir=`(dirname "$as_dir") 2>/dev/null ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
+echo X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
+  	  s/.*/./; q'`
+    done
+    test ! -n "$as_dirs" || mkdir $as_dirs
+  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
+echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
+   { (exit 1); exit 1; }; }; }
 
+  ac_builddir=.
 
-  case $ac_file$ac_mode in
-    "depfiles":C) test x"$AMDEP_TRUE" != x"" || for mf in $CONFIG_FILES; do
+if test "$ac_dir" != .; then
+  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
+  # A "../" for each directory in $ac_dir_suffix.
+  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
+else
+  ac_dir_suffix= ac_top_builddir=
+fi
+
+case $srcdir in
+  .)  # No --srcdir option.  We are building in place.
+    ac_srcdir=.
+    if test -z "$ac_top_builddir"; then
+       ac_top_srcdir=.
+    else
+       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
+    fi ;;
+  [\\/]* | ?:[\\/]* )  # Absolute path.
+    ac_srcdir=$srcdir$ac_dir_suffix;
+    ac_top_srcdir=$srcdir ;;
+  *) # Relative path.
+    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_builddir$srcdir ;;
+esac
+
+# Do not use `cd foo && pwd` to compute absolute paths, because
+# the directories may not exist.
+case `pwd` in
+.) ac_abs_builddir="$ac_dir";;
+*)
+  case "$ac_dir" in
+  .) ac_abs_builddir=`pwd`;;
+  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
+  *) ac_abs_builddir=`pwd`/"$ac_dir";;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_builddir=${ac_top_builddir}.;;
+*)
+  case ${ac_top_builddir}. in
+  .) ac_abs_top_builddir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
+  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_srcdir=$ac_srcdir;;
+*)
+  case $ac_srcdir in
+  .) ac_abs_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
+  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
+  esac;;
+esac
+case $ac_abs_builddir in
+.) ac_abs_top_srcdir=$ac_top_srcdir;;
+*)
+  case $ac_top_srcdir in
+  .) ac_abs_top_srcdir=$ac_abs_builddir;;
+  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
+  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
+  esac;;
+esac
+
+
+  { echo "$as_me:$LINENO: executing $ac_dest commands" >&5
+echo "$as_me: executing $ac_dest commands" >&6;}
+  case $ac_dest in
+    depfiles ) test x"$AMDEP_TRUE" != x"" || for mf in $CONFIG_FILES; do
   # Strip MF so we end up with the name of the file.
   mf=`echo "$mf" | sed -e 's/:.*$//'`
   # Check whether this is an Automake generated Makefile or not.
   # We used to match only the files named `Makefile.in', but
   # some people rename them; so instead we look at the file content.
   # Grep'ing the first line is not enough: some people post-process
   # each Makefile.in and add a new line on top of each file to say so.
   # So let's grep whole file.
   if grep '^#.*generated by automake' $mf > /dev/null 2>&1; then
-    dirpart=`$as_dirname -- "$mf" ||
+    dirpart=`(dirname "$mf") 2>/dev/null ||
 $as_expr X"$mf" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$mf" : 'X\(//\)[^/]' \| \
 	 X"$mf" : 'X\(//\)$' \| \
-	 X"$mf" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$mf" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$mf" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
   else
     continue
   fi
   # Extract the definition of DEPDIR, am__include, and am__quote
   # from the Makefile without running `make'.
@@ -23726,85 +22995,59 @@
   # expansion.
   for file in `sed -n "
     s/^$am__include $am__quote\(.*(DEPDIR).*\)$am__quote"'$/\1/p' <"$mf" | \
        sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
     # Make sure the directory exists.
     test -f "$dirpart/$file" && continue
-    fdir=`$as_dirname -- "$file" ||
+    fdir=`(dirname "$file") 2>/dev/null ||
 $as_expr X"$file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$file" : 'X\(//\)[^/]' \| \
 	 X"$file" : 'X\(//\)$' \| \
-	 X"$file" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$file" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
-    { as_dir=$dirpart/$fdir
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
+    { if $as_mkdir_p; then
+    mkdir -p $dirpart/$fdir
+  else
+    as_dir=$dirpart/$fdir
     as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
+    while test ! -d "$as_dir"; do
+      as_dirs="$as_dir $as_dirs"
+      as_dir=`(dirname "$as_dir") 2>/dev/null ||
 $as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$as_dir" : 'X\(//\)[^/]' \| \
 	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+	 X"$as_dir" : 'X\(/\)' \| \
+	 .     : '\(.\)' 2>/dev/null ||
 echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+  	  /^X\(\/\/\)$/{ s//\1/; q; }
+  	  /^X\(\/\).*/{ s//\1/; q; }
 	  s/.*/./; q'`
-      test -d "$as_dir" && break
     done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
-echo "$as_me: error: cannot create directory $as_dir" >&2;}
+    test ! -n "$as_dirs" || mkdir $as_dirs
+  fi || { { echo "$as_me:$LINENO: error: cannot create directory $dirpart/$fdir" >&5
+echo "$as_me: error: cannot create directory $dirpart/$fdir" >&2;}
    { (exit 1); exit 1; }; }; }
+
     # echo "creating $dirpart/$file"
     echo '# dummy' > "$dirpart/$file"
   done
 done
  ;;
-
   esac
-done # for ac_tag
+done
+_ACEOF
 
+cat >>$CONFIG_STATUS <<\_ACEOF
 
 { (exit 0); exit 0; }
 _ACEOF
 chmod +x $CONFIG_STATUS
 ac_clean_files=$ac_clean_files_save
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/install-sh /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/install-sh
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/install-sh	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/install-sh	2006-03-12 02:49:04.000000000 +0800
@@ -1,10 +1,10 @@
 #!/bin/sh
 # install - install a program, script, or datafile
 
-scriptversion=2006-12-25.00
+scriptversion=2005-11-07.23
 
 # This originates from X11R5 (mit/util/scripts/install.sh), which was
 # later released in X11R6 (xc/config/util/install.sh) with the
 # following copyright and license.
 #
 # Copyright (C) 1994 X Consortium
@@ -36,204 +36,158 @@
 #
 # Calling this script install-sh is preferred over install.sh, to prevent
 # `make' implicit rules from creating a file called install from it
 # when there is no Makefile.
 #
 # This script is compatible with the BSD install script, but was written
-# from scratch.
-
-nl='
-'
-IFS=" ""	$nl"
+# from scratch.  It can only install one file at a time, a restriction
+# shared with many OS's install programs.
 
 # set DOITPROG to echo to test this script
 
 # Don't use :- since 4.3BSD and earlier shells don't like it.
-doit=${DOITPROG-}
-if test -z "$doit"; then
-  doit_exec=exec
-else
-  doit_exec=$doit
-fi
+doit="${DOITPROG-}"
 
-# Put in absolute file names if you don't have them in your path;
-# or use environment vars.
+# put in absolute paths if you don't have them in your path; or use env. vars.
 
-chgrpprog=${CHGRPPROG-chgrp}
-chmodprog=${CHMODPROG-chmod}
-chownprog=${CHOWNPROG-chown}
-cmpprog=${CMPPROG-cmp}
-cpprog=${CPPROG-cp}
-mkdirprog=${MKDIRPROG-mkdir}
-mvprog=${MVPROG-mv}
-rmprog=${RMPROG-rm}
-stripprog=${STRIPPROG-strip}
-
-posix_glob='?'
-initialize_posix_glob='
-  test "$posix_glob" != "?" || {
-    if (set -f) 2>/dev/null; then
-      posix_glob=
-    else
-      posix_glob=:
-    fi
-  }
-'
+mvprog="${MVPROG-mv}"
+cpprog="${CPPROG-cp}"
+chmodprog="${CHMODPROG-chmod}"
+chownprog="${CHOWNPROG-chown}"
+chgrpprog="${CHGRPPROG-chgrp}"
+stripprog="${STRIPPROG-strip}"
+rmprog="${RMPROG-rm}"
+mkdirprog="${MKDIRPROG-mkdir}"
 
+posix_glob=
 posix_mkdir=
 
+# Symbolic mode for testing mkdir with directories.
+# It is the same as 755, but also tests that "u+" works.
+test_mode=u=rwx,g=rx,o=rx,u+wx
+
 # Desired mode of installed file.
 mode=0755
 
-chgrpcmd=
+# Desired mode of newly created intermediate directories.
+# It is empty if not known yet.
+intermediate_mode=
+
 chmodcmd=$chmodprog
 chowncmd=
-mvcmd=$mvprog
-rmcmd="$rmprog -f"
+chgrpcmd=
 stripcmd=
-
+rmcmd="$rmprog -f"
+mvcmd="$mvprog"
 src=
 dst=
 dir_arg=
-dst_arg=
-
-copy_on_change=false
+dstarg=
 no_target_directory=
 
-usage="\
-Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
+usage="Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
    or: $0 [OPTION]... SRCFILES... DIRECTORY
    or: $0 [OPTION]... -t DIRECTORY SRCFILES...
    or: $0 [OPTION]... -d DIRECTORIES...
 
 In the 1st form, copy SRCFILE to DSTFILE.
 In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.
 In the 4th, create DIRECTORIES.
 
 Options:
-     --help     display this help and exit.
-     --version  display version info and exit.
-
-  -c            (ignored)
-  -C            install only if different (preserve the last data modification time)
-  -d            create directories instead of installing files.
-  -g GROUP      $chgrpprog installed files to GROUP.
-  -m MODE       $chmodprog installed files to MODE.
-  -o USER       $chownprog installed files to USER.
-  -s            $stripprog installed files.
-  -t DIRECTORY  install into DIRECTORY.
-  -T            report an error if DSTFILE is a directory.
+-c         (ignored)
+-d         create directories instead of installing files.
+-g GROUP   $chgrpprog installed files to GROUP.
+-m MODE    $chmodprog installed files to MODE.
+-o USER    $chownprog installed files to USER.
+-s         $stripprog installed files.
+-t DIRECTORY  install into DIRECTORY.
+-T         report an error if DSTFILE is a directory.
+--help     display this help and exit.
+--version  display version info and exit.
 
 Environment variables override the default commands:
-  CHGRPPROG CHMODPROG CHOWNPROG CMPPROG CPPROG MKDIRPROG MVPROG
-  RMPROG STRIPPROG
+  CHGRPPROG CHMODPROG CHOWNPROG CPPROG MKDIRPROG MVPROG RMPROG STRIPPROG
 "
 
-while test $# -ne 0; do
+while test -n "$1"; do
   case $1 in
-    -c) ;;
+    -c) shift
+        continue;;
 
-    -C) copy_on_change=true;;
-
-    -d) dir_arg=true;;
+    -d) dir_arg=true
+        shift
+        continue;;
 
     -g) chgrpcmd="$chgrpprog $2"
-	shift;;
+        shift
+        shift
+        continue;;
 
     --help) echo "$usage"; exit $?;;
 
     -m) mode=$2
-	case $mode in
-	  *' '* | *'	'* | *'
-'*	  | *'*'* | *'?'* | *'['*)
-	    echo "$0: invalid mode: $mode" >&2
-	    exit 1;;
-	esac
-	shift;;
+        shift
+        shift
+        continue;;
 
     -o) chowncmd="$chownprog $2"
-	shift;;
-
-    -s) stripcmd=$stripprog;;
-
-    -t) dst_arg=$2
-	shift;;
-
-    -T) no_target_directory=true;;
+        shift
+        shift
+        continue;;
+
+    -s) stripcmd=$stripprog
+        shift
+        continue;;
+
+    -t) dstarg=$2
+	shift
+	shift
+	continue;;
+
+    -T) no_target_directory=true
+	shift
+	continue;;
 
     --version) echo "$0 $scriptversion"; exit $?;;
 
-    --)	shift
+    *)  # When -d is used, all remaining arguments are directories to create.
+	# When -t is used, the destination is already specified.
+	test -n "$dir_arg$dstarg" && break
+        # Otherwise, the last argument is the destination.  Remove it from $@.
+	for arg
+	do
+          if test -n "$dstarg"; then
+	    # $@ is not empty: it contains at least $arg.
+	    set fnord "$@" "$dstarg"
+	    shift # fnord
+	  fi
+	  shift # arg
+	  dstarg=$arg
+	done
 	break;;
-
-    -*)	echo "$0: invalid option: $1" >&2
-	exit 1;;
-
-    *)  break;;
   esac
-  shift
 done
 
-if test $# -ne 0 && test -z "$dir_arg$dst_arg"; then
-  # When -d is used, all remaining arguments are directories to create.
-  # When -t is used, the destination is already specified.
-  # Otherwise, the last argument is the destination.  Remove it from $@.
-  for arg
-  do
-    if test -n "$dst_arg"; then
-      # $@ is not empty: it contains at least $arg.
-      set fnord "$@" "$dst_arg"
-      shift # fnord
-    fi
-    shift # arg
-    dst_arg=$arg
-  done
-fi
-
-if test $# -eq 0; then
+if test -z "$1"; then
   if test -z "$dir_arg"; then
     echo "$0: no input file specified." >&2
     exit 1
   fi
   # It's OK to call `install-sh -d' without argument.
   # This can happen when creating conditional directories.
   exit 0
 fi
 
-if test -z "$dir_arg"; then
-  trap '(exit $?); exit' 1 2 13 15
-
-  # Set umask so as not to create temps with too-generous modes.
-  # However, 'strip' requires both read and write access to temps.
-  case $mode in
-    # Optimize common cases.
-    *644) cp_umask=133;;
-    *755) cp_umask=22;;
-
-    *[0-7])
-      if test -z "$stripcmd"; then
-	u_plus_rw=
-      else
-	u_plus_rw='% 200'
-      fi
-      cp_umask=`expr '(' 777 - $mode % 1000 ')' $u_plus_rw`;;
-    *)
-      if test -z "$stripcmd"; then
-	u_plus_rw=
-      else
-	u_plus_rw=,u+rw
-      fi
-      cp_umask=$mode$u_plus_rw;;
-  esac
-fi
+test -n "$dir_arg" || trap '(exit $?); exit' 1 2 13 15
 
 for src
 do
   # Protect names starting with `-'.
   case $src in
-    -*) src=./$src;;
+    -*) src=./$src ;;
   esac
 
   if test -n "$dir_arg"; then
     dst=$src
     dstdir=$dst
     test -d "$dstdir"
@@ -245,270 +199,198 @@
     # if $src (and thus $dsttmp) contains '*'.
     if test ! -f "$src" && test ! -d "$src"; then
       echo "$0: $src does not exist." >&2
       exit 1
     fi
 
-    if test -z "$dst_arg"; then
+    if test -z "$dstarg"; then
       echo "$0: no destination specified." >&2
       exit 1
     fi
 
-    dst=$dst_arg
+    dst=$dstarg
     # Protect names starting with `-'.
     case $dst in
-      -*) dst=./$dst;;
+      -*) dst=./$dst ;;
     esac
 
     # If destination is a directory, append the input filename; won't work
     # if double slashes aren't ignored.
     if test -d "$dst"; then
       if test -n "$no_target_directory"; then
-	echo "$0: $dst_arg: Is a directory" >&2
+	echo "$0: $dstarg: Is a directory" >&2
 	exit 1
       fi
       dstdir=$dst
       dst=$dstdir/`basename "$src"`
       dstdir_status=0
     else
       # Prefer dirname, but fall back on a substitute if dirname fails.
       dstdir=`
 	(dirname "$dst") 2>/dev/null ||
 	expr X"$dst" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	     X"$dst" : 'X\(//\)[^/]' \| \
 	     X"$dst" : 'X\(//\)$' \| \
-	     X"$dst" : 'X\(/\)' \| . 2>/dev/null ||
+	     X"$dst" : 'X\(/\)' \| \
+	     .       : '\(.\)' 2>/dev/null ||
 	echo X"$dst" |
-	    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-		   s//\1/
-		   q
-		 }
-		 /^X\(\/\/\)[^/].*/{
-		   s//\1/
-		   q
-		 }
-		 /^X\(\/\/\)$/{
-		   s//\1/
-		   q
-		 }
-		 /^X\(\/\).*/{
-		   s//\1/
-		   q
-		 }
-		 s/.*/./; q'
+	    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
+		  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
+		  /^X\(\/\/\)$/{ s//\1/; q; }
+		  /^X\(\/\).*/{ s//\1/; q; }
+		  s/.*/./; q'
       `
 
       test -d "$dstdir"
       dstdir_status=$?
     fi
   fi
 
   obsolete_mkdir_used=false
 
   if test $dstdir_status != 0; then
     case $posix_mkdir in
       '')
-	# Create intermediate dirs using mode 755 as modified by the umask.
-	# This is like FreeBSD 'install' as of 1997-10-28.
-	umask=`umask`
-	case $stripcmd.$umask in
-	  # Optimize common cases.
-	  *[2367][2367]) mkdir_umask=$umask;;
-	  .*0[02][02] | .[02][02] | .[02]) mkdir_umask=22;;
-
-	  *[0-7])
-	    mkdir_umask=`expr $umask + 22 \
-	      - $umask % 100 % 40 + $umask % 20 \
-	      - $umask % 10 % 4 + $umask % 2
-	    `;;
-	  *) mkdir_umask=$umask,go-w;;
-	esac
+	posix_mkdir=false
+	if $mkdirprog -m $test_mode -p -- / >/dev/null 2>&1; then
+	  posix_mkdir=true
+	else
+	  # Remove any dirs left behind by ancient mkdir implementations.
+	  rmdir ./-m "$test_mode" ./-p ./-- 2>/dev/null
+	fi ;;
+    esac
+
+    if
+      $posix_mkdir && {
 
 	# With -d, create the new directory with the user-specified mode.
-	# Otherwise, rely on $mkdir_umask.
+	# Otherwise, create it using the same intermediate mode that
+	# mkdir -p would use when creating intermediate directories.
+	# POSIX says that this mode is "$(umask -S),u+wx", so use that
+	# if umask -S works.
+
 	if test -n "$dir_arg"; then
-	  mkdir_mode=-m$mode
+	  mkdir_mode=$mode
 	else
-	  mkdir_mode=
+	  case $intermediate_mode in
+	    '')
+	      if umask_S=`(umask -S) 2>/dev/null`; then
+		intermediate_mode=$umask_S,u+wx
+	      else
+		intermediate_mode=$test_mode
+	      fi ;;
+	  esac
+	  mkdir_mode=$intermediate_mode
 	fi
 
-	posix_mkdir=false
-	case $umask in
-	  *[123567][0-7][0-7])
-	    # POSIX mkdir -p sets u+wx bits regardless of umask, which
-	    # is incompatible with FreeBSD 'install' when (umask & 300) != 0.
-	    ;;
-	  *)
-	    tmpdir=${TMPDIR-/tmp}/ins$RANDOM-$$
-	    trap 'ret=$?; rmdir "$tmpdir/d" "$tmpdir" 2>/dev/null; exit $ret' 0
-
-	    if (umask $mkdir_umask &&
-		exec $mkdirprog $mkdir_mode -p -- "$tmpdir/d") >/dev/null 2>&1
-	    then
-	      if test -z "$dir_arg" || {
-		   # Check for POSIX incompatibilities with -m.
-		   # HP-UX 11.23 and IRIX 6.5 mkdir -m -p sets group- or
-		   # other-writeable bit of parent directory when it shouldn't.
-		   # FreeBSD 6.1 mkdir -m -p sets mode of existing directory.
-		   ls_ld_tmpdir=`ls -ld "$tmpdir"`
-		   case $ls_ld_tmpdir in
-		     d????-?r-*) different_mode=700;;
-		     d????-?--*) different_mode=755;;
-		     *) false;;
-		   esac &&
-		   $mkdirprog -m$different_mode -p -- "$tmpdir" && {
-		     ls_ld_tmpdir_1=`ls -ld "$tmpdir"`
-		     test "$ls_ld_tmpdir" = "$ls_ld_tmpdir_1"
-		   }
-		 }
-	      then posix_mkdir=:
-	      fi
-	      rmdir "$tmpdir/d" "$tmpdir"
-	    else
-	      # Remove any dirs left behind by ancient mkdir implementations.
-	      rmdir ./$mkdir_mode ./-p ./-- 2>/dev/null
-	    fi
-	    trap '' 0;;
-	esac;;
-    esac
-
-    if
-      $posix_mkdir && (
-	umask $mkdir_umask &&
-	$doit_exec $mkdirprog $mkdir_mode -p -- "$dstdir"
-      )
+	$mkdirprog -m "$mkdir_mode" -p -- "$dstdir"
+      }
     then :
     else
 
-      # The umask is ridiculous, or mkdir does not conform to POSIX,
-      # or it failed possibly due to a race condition.  Create the
-      # directory the slow way, step by step, checking for races as we go.
+      # mkdir does not conform to POSIX, or it failed possibly due to
+      # a race condition.  Create the directory the slow way, step by
+      # step, checking for races as we go.
 
       case $dstdir in
-	/*) prefix='/';;
-	-*) prefix='./';;
-	*)  prefix='';;
+	/*) pathcomp=/ ;;
+	-*) pathcomp=./ ;;
+	*)  pathcomp= ;;
       esac
 
-      eval "$initialize_posix_glob"
+      case $posix_glob in
+        '')
+	  if (set -f) 2>/dev/null; then
+	    posix_glob=true
+	  else
+	    posix_glob=false
+	  fi ;;
+      esac
 
       oIFS=$IFS
       IFS=/
-      $posix_glob set -f
+      $posix_glob && set -f
       set fnord $dstdir
       shift
-      $posix_glob set +f
+      $posix_glob && set +f
       IFS=$oIFS
 
-      prefixes=
-
       for d
       do
-	test -z "$d" && continue
+	test "x$d" = x && continue
 
-	prefix=$prefix$d
-	if test -d "$prefix"; then
-	  prefixes=
-	else
-	  if $posix_mkdir; then
-	    (umask=$mkdir_umask &&
-	     $doit_exec $mkdirprog $mkdir_mode -p -- "$dstdir") && break
-	    # Don't fail if two instances are running concurrently.
-	    test -d "$prefix" || exit 1
-	  else
-	    case $prefix in
-	      *\'*) qprefix=`echo "$prefix" | sed "s/'/'\\\\\\\\''/g"`;;
-	      *) qprefix=$prefix;;
-	    esac
-	    prefixes="$prefixes '$qprefix'"
-	  fi
+	pathcomp=$pathcomp$d
+	if test ! -d "$pathcomp"; then
+	  $mkdirprog "$pathcomp"
+	  # Don't fail if two instances are running concurrently.
+	  test -d "$pathcomp" || exit 1
 	fi
-	prefix=$prefix/
+	pathcomp=$pathcomp/
       done
-
-      if test -n "$prefixes"; then
-	# Don't fail if two instances are running concurrently.
-	(umask $mkdir_umask &&
-	 eval "\$doit_exec \$mkdirprog $prefixes") ||
-	  test -d "$dstdir" || exit 1
-	obsolete_mkdir_used=true
-      fi
+      obsolete_mkdir_used=true
     fi
   fi
 
   if test -n "$dir_arg"; then
     { test -z "$chowncmd" || $doit $chowncmd "$dst"; } &&
     { test -z "$chgrpcmd" || $doit $chgrpcmd "$dst"; } &&
     { test "$obsolete_mkdir_used$chowncmd$chgrpcmd" = false ||
-      test -z "$chmodcmd" || $doit $chmodcmd $mode "$dst"; } || exit 1
+      test -z "$chmodcmd" || $doit $chmodcmd "$mode" "$dst"; } || exit 1
   else
 
     # Make a couple of temp file names in the proper directory.
     dsttmp=$dstdir/_inst.$$_
     rmtmp=$dstdir/_rm.$$_
 
     # Trap to clean up those temp files at exit.
     trap 'ret=$?; rm -f "$dsttmp" "$rmtmp" && exit $ret' 0
 
     # Copy the file name to the temp name.
-    (umask $cp_umask && $doit_exec $cpprog "$src" "$dsttmp") &&
+    $doit $cpprog "$src" "$dsttmp" &&
 
     # and set any options; do chmod last to preserve setuid bits.
     #
     # If any of these fail, we abort the whole thing.  If we want to
     # ignore errors from any of these, just make sure not to ignore
     # errors from the above "$doit $cpprog $src $dsttmp" command.
     #
-    { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } &&
-    { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } &&
-    { test -z "$stripcmd" || $doit $stripcmd "$dsttmp"; } &&
-    { test -z "$chmodcmd" || $doit $chmodcmd $mode "$dsttmp"; } &&
-
-    # If -C, don't bother to copy if it wouldn't change the file.
-    if $copy_on_change &&
-       old=`LC_ALL=C ls -dlL "$dst"	2>/dev/null` &&
-       new=`LC_ALL=C ls -dlL "$dsttmp"	2>/dev/null` &&
-
-       eval "$initialize_posix_glob" &&
-       $posix_glob set -f &&
-       set X $old && old=:$2:$4:$5:$6 &&
-       set X $new && new=:$2:$4:$5:$6 &&
-       $posix_glob set +f &&
-
-       test "$old" = "$new" &&
-       $cmpprog "$dst" "$dsttmp" >/dev/null 2>&1
-    then
-      rm -f "$dsttmp"
-    else
-      # Rename the file to the real destination.
-      $doit $mvcmd -f "$dsttmp" "$dst" 2>/dev/null ||
-
-      # The rename failed, perhaps because mv can't rename something else
-      # to itself, or perhaps because mv is so ancient that it does not
-      # support -f.
-      {
-	# Now remove or move aside any old file at destination location.
-	# We try this two ways since rm can't unlink itself on some
-	# systems and the destination file might be busy for other
-	# reasons.  In this case, the final cleanup might fail but the new
-	# file should still install successfully.
-	{
-	  test ! -f "$dst" ||
-	  $doit $rmcmd -f "$dst" 2>/dev/null ||
-	  { $doit $mvcmd -f "$dst" "$rmtmp" 2>/dev/null &&
-	    { $doit $rmcmd -f "$rmtmp" 2>/dev/null; :; }
-	  } ||
-	  { echo "$0: cannot unlink or rename $dst" >&2
-	    (exit 1); exit 1
-	  }
-	} &&
-
-	# Now rename the file to the real destination.
-	$doit $mvcmd "$dsttmp" "$dst"
-      }
-    fi || exit 1
+    { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } \
+      && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } \
+      && { test -z "$stripcmd" || $doit $stripcmd "$dsttmp"; } \
+      && { test -z "$chmodcmd" || $doit $chmodcmd "$mode" "$dsttmp"; } &&
+
+    # Now rename the file to the real destination.
+    { $doit $mvcmd -f "$dsttmp" "$dst" 2>/dev/null \
+      || {
+	   # The rename failed, perhaps because mv can't rename something else
+	   # to itself, or perhaps because mv is so ancient that it does not
+	   # support -f.
+
+	   # Now remove or move aside any old file at destination location.
+	   # We try this two ways since rm can't unlink itself on some
+	   # systems and the destination file might be busy for other
+	   # reasons.  In this case, the final cleanup might fail but the new
+	   # file should still install successfully.
+	   {
+	     if test -f "$dst"; then
+	       $doit $rmcmd -f "$dst" 2>/dev/null \
+	       || { $doit $mvcmd -f "$dst" "$rmtmp" 2>/dev/null \
+		     && { $doit $rmcmd -f "$rmtmp" 2>/dev/null; :; }; }\
+	       || {
+		 echo "$0: cannot unlink or rename $dst" >&2
+		 (exit 1); exit 1
+	       }
+	     else
+	       :
+	     fi
+	   } &&
+
+	   # Now rename the file to the real destination.
+	   $doit $mvcmd "$dsttmp" "$dst"
+	 }
+    } || exit 1
 
     trap '' 0
   fi
 done
 
 # Local variables:
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltdl.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltdl.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltdl.c	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltdl.c	2006-03-12 02:49:03.000000000 +0800
@@ -1,8 +1,8 @@
 /* ltdl.c -- system independent dlopen wrapper
-   Copyright (C) 1998, 1999, 2000, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.
+   Copyright (C) 1998, 1999, 2000, 2004, 2005  Free Software Foundation, Inc.
    Originally by Thomas Tanner <tanner@ffii.org>
    This file is part of GNU Libtool.
 
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
@@ -134,28 +134,22 @@
 
 
 
 
 /* --- WINDOWS SUPPORT --- */
 
-/* DLL building support on win32 hosts;  mostly to workaround their
-   ridiculous implementation of data symbol exporting. */
-#ifndef LT_GLOBAL_DATA
-#  if defined(__WINDOWS__) || defined(__CYGWIN__)
-#    ifdef DLL_EXPORT           /* defined by libtool (if required) */
-#      define LT_GLOBAL_DATA __declspec(dllexport)
-#    endif
-#  endif
-#  ifndef LT_GLOBAL_DATA        /* static linking or !__WINDOWS__ */
-#    define LT_GLOBAL_DATA
-#  endif
+
+#ifdef DLL_EXPORT
+#  define LT_GLOBAL_DATA	__declspec(dllexport)
+#else
+#  define LT_GLOBAL_DATA
 #endif
 
 /* fopen() mode flags for reading a text file */
 #undef	LT_READTEXT_MODE
-#if defined(__WINDOWS__) || defined(__CYGWIN__)
+#ifdef __WINDOWS__
 #  define LT_READTEXT_MODE "rt"
 #else
 #  define LT_READTEXT_MODE "r"
 #endif
 
 #ifdef LT_USE_WINDOWS_DIRENT_EMULATION
@@ -897,13 +891,13 @@
 						} LT_STMT_END
 #define LT_DLMUTEX_SETERROR(errormsg)		LT_STMT_START {	\
 	if (lt_dlmutex_seterror_func)				\
 		(*lt_dlmutex_seterror_func) (errormsg);		\
 	else 	lt_dllast_error = (errormsg);	} LT_STMT_END
 #define LT_DLMUTEX_GETERROR(errormsg)		LT_STMT_START {	\
-	if (lt_dlmutex_geterror_func)				\
+	if (lt_dlmutex_seterror_func)				\
 		(errormsg) = (*lt_dlmutex_geterror_func) ();	\
 	else	(errormsg) = lt_dllast_error;	} LT_STMT_END
 
 /* The mutex functions stored here are global, and are necessarily the
    same for all threads that wish to share access to libltdl.  */
 static	lt_dlmutex_lock	    *lt_dlmutex_lock_func     = 0;
@@ -921,24 +915,23 @@
 lt_dlmutex_register (lock, unlock, seterror, geterror)
      lt_dlmutex_lock *lock;
      lt_dlmutex_unlock *unlock;
      lt_dlmutex_seterror *seterror;
      lt_dlmutex_geterror *geterror;
 {
-  lt_dlmutex_unlock *old_unlock = lt_dlmutex_unlock_func;
+  lt_dlmutex_unlock *old_unlock = unlock;
   int		     errors	= 0;
 
   /* Lock using the old lock() callback, if any.  */
   LT_DLMUTEX_LOCK ();
 
   if ((lock && unlock && seterror && geterror)
       || !(lock || unlock || seterror || geterror))
     {
       lt_dlmutex_lock_func     = lock;
       lt_dlmutex_unlock_func   = unlock;
-      lt_dlmutex_seterror_func = seterror;
       lt_dlmutex_geterror_func = geterror;
     }
   else
     {
       LT_DLMUTEX_SETERROR (LT_DLSTRERROR (INVALID_MUTEX_ARGS));
       ++errors;
@@ -2334,24 +2327,12 @@
 	      if (!LT_DLIS_RESIDENT (tmp) && tmp->info.ref_count <= level)
 		{
 		  if (lt_dlclose (tmp))
 		    {
 		      ++errors;
 		    }
-		  /* Make sure that the handle pointed to by 'cur' still exists.
-		     lt_dlclose recursively closes dependent libraries which removes
-		     them from the linked list.  One of these might be the one
-		     pointed to by 'cur'.  */
-		  if (cur)
-		    {
-		      for (tmp = handles; tmp; tmp = tmp->next)
-			if (tmp == cur)
-			  break;
-		      if (! tmp)
-			cur = handles;
-		    }
 		}
 	    }
 	  /* done if only resident modules are left */
 	  if (!saw_nonresident)
 	    break;
 	}
@@ -2949,13 +2930,13 @@
   if (depcount)
     {
       int	j = 0;
 
       handle->deplibs = (lt_dlhandle*) LT_EMALLOC (lt_dlhandle *, depcount);
       if (!handle->deplibs)
-	goto cleanup_names;
+	goto cleanup;
 
       for (i = 0; i < depcount; ++i)
 	{
 	  handle->deplibs[j] = lt_dlopenext(names[depcount-1-i]);
 	  if (handle->deplibs[j])
 	    {
@@ -3000,13 +2981,12 @@
 	{
 	  if (!LT_DLIS_RESIDENT (handle->deplibs[i]))
 	    {
 	      errors += lt_dlclose (handle->deplibs[i]);
 	    }
 	}
-      LT_DLFREE (handle->deplibs);
     }
 
   return errors;
 }
 
 static int
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltdl.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltdl.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltdl.h	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltdl.h	2006-03-12 02:49:03.000000000 +0800
@@ -1,8 +1,8 @@
 /* ltdl.h -- generic dlopen functions
-   Copyright (C) 1998-2001, 2003, 2004, 2007 Free Software Foundation, Inc.
+   Copyright (C) 1998-2000 Free Software Foundation, Inc.
    Originally by Thomas Tanner <tanner@ffii.org>
    This file is part of GNU Libtool.
 
 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation; either
@@ -76,13 +76,13 @@
 #    define LT_STMT_END        while (0)
 #  endif
 #endif
 
 /* LT_CONC creates a new concatenated symbol for the compiler
    in a portable way.  */
-#if defined(__STDC__) || defined(__cplusplus) || defined(_MSC_VER) || defined(_AIX)
+#if defined(__STDC__) || defined(__cplusplus) || defined(_MSC_VER)
 #  define LT_CONC(s,t)	s##t
 #else
 #  define LT_CONC(s,t)	s/**/t
 #endif
 
 /* LT_STRLEN can be used safely on NULL pointers.  */
@@ -124,18 +124,17 @@
 #  define LT_PATHSEP_CHAR	':'
 #endif
 
 /* DLL building support on win32 hosts;  mostly to workaround their
    ridiculous implementation of data symbol exporting. */
 #ifndef LT_SCOPE
-#  if defined(__WINDOWS__) || defined(__CYGWIN__)
+#  ifdef __WINDOWS__
 #    ifdef DLL_EXPORT		/* defined by libtool (if required) */
 #      define LT_SCOPE	__declspec(dllexport)
 #    endif
 #    ifdef LIBLTDL_DLL_IMPORT	/* define if linking with this dll */
-       /* note: cygwin/mingw compilers can rely instead on auto-import */
 #      define LT_SCOPE	extern __declspec(dllimport)
 #    endif
 #  endif
 #  ifndef LT_SCOPE		/* static linking or !__WINDOWS__ */
 #    define LT_SCOPE	extern
 #  endif
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltmain.sh /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltmain.sh
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/ltmain.sh	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/ltmain.sh	2006-03-12 02:49:04.000000000 +0800
@@ -1,11 +1,11 @@
 # ltmain.sh - Provide generalized library-building support services.
 # NOTE: Changing this file will not affect anything until you rerun configure.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005, 2006,
-# 2007  Free Software Foundation, Inc.
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005
+# Free Software Foundation, Inc.
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
@@ -40,28 +40,20 @@
 # Global variables:
 EXIT_SUCCESS=0
 EXIT_FAILURE=1
 
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION="1.5.24 Debian 1.5.24-1"
-TIMESTAMP=" (1.1220.2.456 2007/06/24 02:25:32)"
+VERSION="1.5.22 Debian 1.5.22-4"
+TIMESTAMP=" (1.1220.2.365 2005/12/18 22:14:06)"
 
-# Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
+# See if we are running on zsh, and set the options which allow our
+# commands through without removal of \ escapes.
+if test -n "${ZSH_VERSION+set}" ; then
   setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in *posix*) set -o posix;; esac
 fi
-BIN_SH=xpg4; export BIN_SH # for Tru64
-DUALCASE=1; export DUALCASE # for MKS sh
 
 # Check that we have a working $echo.
 if test "X$1" = X--no-reexec; then
   # Discard the --no-reexec flag, and continue.
   shift
 elif test "X$1" = X--fallback-echo; then
@@ -110,20 +102,18 @@
 
 # NLS nuisances.
 # Only set LANG and LC_ALL to C if already set.
 # These must not be set unconditionally because not all systems understand
 # e.g. LANG=C (notably SCO).
 # We save the old values to restore during execute mode.
-for lt_var in LANG LC_ALL LC_CTYPE LC_COLLATE LC_MESSAGES
-do
-  eval "if test \"\${$lt_var+set}\" = set; then
-	  save_$lt_var=\$$lt_var
-	  $lt_var=C
-	  export $lt_var
-	fi"
-done
+if test "${LC_ALL+set}" = set; then
+  save_LC_ALL="$LC_ALL"; LC_ALL=C; export LC_ALL
+fi
+if test "${LANG+set}" = set; then
+  save_LANG="$LANG"; LANG=C; export LANG
+fi
 
 # Make sure IFS has a sensible default
 lt_nl='
 '
 IFS=" 	$lt_nl"
 
@@ -143,14 +133,12 @@
 show_help=
 execute_dlfiles=
 duplicate_deps=no
 preserve_args=
 lo2o="s/\\.lo\$/.${objext}/"
 o2lo="s/\\.${objext}\$/.lo/"
-extracted_archives=
-extracted_serial=0
 
 #####################################
 # Shell function definitions:
 # This seems to be the best place for them
 
 # func_mktempdir [string]
@@ -205,19 +193,13 @@
     win32_libid_type="x86 archive import"
     ;;
   *ar\ archive*) # could be an import, or static
     if eval $OBJDUMP -f $1 | $SED -e '10q' 2>/dev/null | \
       $EGREP -e 'file format pe-i386(.*architecture: i386)?' >/dev/null ; then
       win32_nmres=`eval $NM -f posix -A $1 | \
-	$SED -n -e '1,100{
-		/ I /{
-			s,.*,import,
-			p
-			q
-			}
-		}'`
+	$SED -n -e '1,100{/ I /{s,.*,import,;p;q;};}'`
       case $win32_nmres in
       import*)  win32_libid_type="x86 archive import";;
       *)        win32_libid_type="x86 archive static";;
       esac
     fi
     ;;
@@ -342,23 +324,13 @@
       # Extract the objects.
       case $my_xlib in
 	[\\/]* | [A-Za-z]:[\\/]*) my_xabs="$my_xlib" ;;
 	*) my_xabs=`pwd`"/$my_xlib" ;;
       esac
       my_xlib=`$echo "X$my_xlib" | $Xsed -e 's%^.*/%%'`
-      my_xlib_u=$my_xlib
-      while :; do
-        case " $extracted_archives " in
-	*" $my_xlib_u "*)
-	  extracted_serial=`expr $extracted_serial + 1`
-	  my_xlib_u=lt$extracted_serial-$my_xlib ;;
-	*) break ;;
-	esac
-      done
-      extracted_archives="$extracted_archives $my_xlib_u"
-      my_xdir="$my_gentop/$my_xlib_u"
+      my_xdir="$my_gentop/$my_xlib"
 
       $show "${rm}r $my_xdir"
       $run ${rm}r "$my_xdir"
       $show "$mkdir $my_xdir"
       $run $mkdir "$my_xdir"
       exit_status=$?
@@ -479,18 +451,17 @@
   case $arg in
   --help)
     show_help=yes
     ;;
 
   --version)
-    echo "\
-$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP
-
-Copyright (C) 2007  Free Software Foundation, Inc.
-This is free software; see the source for copying conditions.  There is NO
-warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+    $echo "$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP"
+    $echo
+    $echo "Copyright (C) 2005  Free Software Foundation, Inc."
+    $echo "This is free software; see the source for copying conditions.  There is NO"
+    $echo "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
     exit $?
     ;;
 
   --config)
     ${SED} -e '1,/^# ### BEGIN LIBTOOL CONFIG/d' -e '/^# ### END LIBTOOL CONFIG/,$d' $progpath
     # Now print the configurations for the tags.
@@ -781,16 +752,15 @@
     *.c++) xform=c++ ;;
     *.cc) xform=cc ;;
     *.ii) xform=ii ;;
     *.class) xform=class ;;
     *.cpp) xform=cpp ;;
     *.cxx) xform=cxx ;;
-    *.[fF][09]?) xform=[fF][09]. ;;
+    *.f90) xform=f90 ;;
     *.for) xform=for ;;
     *.java) xform=java ;;
-    *.obj) xform=obj ;;
     esac
 
     libobj=`$echo "X$libobj" | $Xsed -e "s/\.$xform$/.lo/"`
 
     case $libobj in
     *.lo) obj=`$echo "X$libobj" | $Xsed -e "$lo2o"` ;;
@@ -1165,36 +1135,27 @@
     func_infer_tag $base_compile
 
     # We need to know -static, to get the right output filenames.
     for arg
     do
       case $arg in
-      -all-static | -static | -static-libtool-libs)
-	case $arg in
-	-all-static)
+      -all-static | -static)
+	if test "X$arg" = "X-all-static"; then
 	  if test "$build_libtool_libs" = yes && test -z "$link_static_flag"; then
 	    $echo "$modename: warning: complete static linking is impossible in this configuration" 1>&2
 	  fi
 	  if test -n "$link_static_flag"; then
 	    dlopen_self=$dlopen_self_static
 	  fi
 	  prefer_static_libs=yes
-	  ;;
-	-static)
+	else
 	  if test -z "$pic_flag" && test -n "$link_static_flag"; then
 	    dlopen_self=$dlopen_self_static
 	  fi
 	  prefer_static_libs=built
-	  ;;
-	-static-libtool-libs)
-	  if test -z "$pic_flag" && test -n "$link_static_flag"; then
-	    dlopen_self=$dlopen_self_static
-	  fi
-	  prefer_static_libs=yes
-	  ;;
-	esac
+	fi
 	build_libtool_libs=no
 	build_old_libs=yes
 	break
 	;;
       esac
     done
@@ -1636,13 +1597,13 @@
 	compiler_flags="$compiler_flags $arg"
 	finalize_command="$finalize_command $arg"
 	prev=xcompiler
 	continue
 	;;
 
-     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
+     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
 	compiler_flags="$compiler_flags $arg"
 	compile_command="$compile_command $arg"
 	finalize_command="$finalize_command $arg"
 	continue
 	;;
 
@@ -1656,17 +1617,16 @@
       # -xarch=*, -xtarget=* enable 64-bit mode on the Sun compiler
       # +DA*, +DD* enable 64-bit mode on the HP compiler
       # -q* pass through compiler args for the IBM compiler
       # -m* pass through architecture-specific compiler args for GCC
       # -m*, -t[45]*, -txscale* pass through architecture-specific
       # compiler args for GCC
-      # -p, -pg, --coverage, -fprofile-* pass through profiling flag for GCC
-      # -F/path gives path to uninstalled frameworks, gcc on darwin
+      # -pg pass through profiling flag for GCC
       # @file GCC response files
-      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*| \
-      -t[45]*|-txscale*|-p|-pg|--coverage|-fprofile-*|-F*|@*)
+      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*|-pg| \
+      -t[45]*|-txscale*|@*)
 
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
 	case $arg in
 	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
@@ -1688,15 +1648,15 @@
 	fast_install=no
 	continue
 	;;
 
       -no-install)
 	case $host in
-	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-darwin*)
+	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
 	  # The PATH hackery in wrapper scripts is required on Windows
-	  # and Darwin in order for the loader to find any dlls it needs.
+	  # in order for the loader to find any dlls it needs.
 	  $echo "$modename: warning: \`-no-install' is ignored for $host" 1>&2
 	  $echo "$modename: warning: assuming \`-no-fast-install' instead" 1>&2
 	  fast_install=no
 	  ;;
 	*) no_install=yes ;;
 	esac
@@ -1749,13 +1709,13 @@
 	*" $dir "*) ;;
 	*) xrpath="$xrpath $dir" ;;
 	esac
 	continue
 	;;
 
-      -static | -static-libtool-libs)
+      -static)
 	# The effects of -static are defined in a previous loop.
 	# We used to do the same as -all-static on platforms that
 	# didn't have a PIC flag, but the assumption that the effects
 	# would be equivalent was wrong.  It would break on at least
 	# Digital Unix and AIX.
 	continue
@@ -2134,13 +2094,13 @@
 	deplibs=
       fi
       for deplib in $libs; do
 	lib=
 	found=no
 	case $deplib in
-	-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
+	-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
 	  if test "$linkmode,$pass" = "prog,link"; then
 	    compile_deplibs="$deplib $compile_deplibs"
 	    finalize_deplibs="$deplib $finalize_deplibs"
 	  else
 	    compiler_flags="$compiler_flags $deplib"
 	  fi
@@ -2530,15 +2490,13 @@
 	  done # for deplib
 	  continue
 	fi # $linkmode = prog...
 
 	if test "$linkmode,$pass" = "prog,link"; then
 	  if test -n "$library_names" &&
-	     { { test "$prefer_static_libs" = no ||
-		 test "$prefer_static_libs,$installed" = "built,yes"; } ||
-	       test -z "$old_library"; }; then
+	     { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
 	    # We need to hardcode the library path
 	    if test -n "$shlibpath_var" && test -z "$avoidtemprpath" ; then
 	      # Make sure the rpath contains only unique directories.
 	      case "$temp_rpath " in
 	      *" $dir "*) ;;
 	      *" $absdir "*) ;;
@@ -3228,27 +3186,26 @@
 	  # use the current revision as the major version
 	  # and those that subtract age and use age as
 	  # a minor version.  But, then there is irix
 	  # which has an extra 1 added just for fun
 	  #
 	  case $version_type in
-	  darwin|linux|osf|windows|none)
+	  darwin|linux|osf|windows)
 	    current=`expr $number_major + $number_minor`
 	    age="$number_minor"
 	    revision="$number_revision"
 	    ;;
 	  freebsd-aout|freebsd-elf|sunos)
 	    current="$number_major"
 	    revision="$number_minor"
 	    age="0"
 	    ;;
 	  irix|nonstopux)
-	    current=`expr $number_major + $number_minor`
+	    current=`expr $number_major + $number_minor - 1`
 	    age="$number_minor"
 	    revision="$number_minor"
-	    lt_irix_increment=no
 	    ;;
 	  *)
 	    $echo "$modename: unknown library version type \`$version_type'" 1>&2
 	    $echo "Fatal configuration error.  See the $PACKAGE docs for more information." 1>&2
 	    exit $EXIT_FAILURE
 	    ;;
@@ -3306,14 +3263,13 @@
 	  # Like Linux, but with the current version available in
 	  # verstring for coding it into the library header
 	  major=.`expr $current - $age`
 	  versuffix="$major.$age.$revision"
 	  # Darwin ld doesn't like 0 for these options...
 	  minor_current=`expr $current + 1`
-	  xlcverstring="${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision"
-	  verstring="-compatibility_version $minor_current -current_version $minor_current.$revision"
+	  verstring="${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision"
 	  ;;
 
 	freebsd-aout)
 	  major=".$current"
 	  versuffix=".$current.$revision";
 	  ;;
@@ -3321,17 +3277,14 @@
 	freebsd-elf)
 	  major=".$current"
 	  versuffix=".$current";
 	  ;;
 
 	irix | nonstopux)
-	  if test "X$lt_irix_increment" = "Xno"; then
-	    major=`expr $current - $age`
-	  else
-	    major=`expr $current - $age + 1`
-	  fi
+	  major=`expr $current - $age + 1`
+
 	  case $version_type in
 	    nonstopux) verstring_prefix=nonstopux ;;
 	    *)         verstring_prefix=sgi ;;
 	  esac
 	  verstring="$verstring_prefix$major.$revision"
 
@@ -3462,17 +3415,17 @@
 
 	# Transform .lo files to .o files.
 	oldobjs="$objs "`$echo "X$libobjs" | $SP2NL | $Xsed -e '/\.'${libext}'$/d' -e "$lo2o" | $NL2SP`
       fi
 
       # Eliminate all temporary directories.
-      #for path in $notinst_path; do
-      #	lib_search_path=`$echo "$lib_search_path " | ${SED} -e "s% $path % %g"`
-      #	deplibs=`$echo "$deplibs " | ${SED} -e "s% -L$path % %g"`
-      #	dependency_libs=`$echo "$dependency_libs " | ${SED} -e "s% -L$path % %g"`
-      #done
+      for path in $notinst_path; do
+	lib_search_path=`$echo "$lib_search_path " | ${SED} -e "s% $path % %g"`
+	deplibs=`$echo "$deplibs " | ${SED} -e "s% -L$path % %g"`
+	dependency_libs=`$echo "$dependency_libs " | ${SED} -e "s% -L$path % %g"`
+      done
 
       if test -n "$xrpath"; then
 	# If the user specified any rpath flags, then add them.
 	temp_xrpath=
 	for libdir in $xrpath; do
 	  temp_xrpath="$temp_xrpath -R$libdir"
@@ -3567,18 +3520,19 @@
 	  # whether they linked in statically or dynamically with ldd.
 	  $rm conftest.c
 	  cat > conftest.c <<EOF
 	  int main() { return 0; }
 EOF
 	  $rm conftest
-	  if $LTCC $LTCFLAGS -o conftest conftest.c $deplibs; then
+	  $LTCC $LTCFLAGS -o conftest conftest.c $deplibs
+	  if test "$?" -eq 0 ; then
 	    ldd_output=`ldd conftest`
 	    for i in $deplibs; do
 	      name=`expr $i : '-l\(.*\)'`
 	      # If $name is empty we are operating on a -L argument.
-              if test "$name" != "" && test "$name" != "0"; then
+              if test "$name" != "" && test "$name" -ne "0"; then
 		if test "X$allow_libtool_libs_with_static_runtimes" = "Xyes" ; then
 		  case " $predeps $postdeps " in
 		  *" $i "*)
 		    newdeplibs="$newdeplibs $i"
 		    i=""
 		    ;;
@@ -3611,13 +3565,15 @@
 	    # the situation: Compile a separate program for each library.
 	    for i in $deplibs; do
 	      name=`expr $i : '-l\(.*\)'`
 	      # If $name is empty we are operating on a -L argument.
               if test "$name" != "" && test "$name" != "0"; then
 		$rm conftest
-		if $LTCC $LTCFLAGS -o conftest conftest.c $i; then
+		$LTCC $LTCFLAGS -o conftest conftest.c $i
+		# Did it work?
+		if test "$?" -eq 0 ; then
 		  ldd_output=`ldd conftest`
 		  if test "X$allow_libtool_libs_with_static_runtimes" = "Xyes" ; then
 		    case " $predeps $postdeps " in
 		    *" $i "*)
 		      newdeplibs="$newdeplibs $i"
 		      i=""
@@ -3643,13 +3599,13 @@
 		    fi
 		  fi
 		else
 		  droppeddeps=yes
 		  $echo
 		  $echo "*** Warning!  Library $i is needed by this library but I was not able to"
-		  $echo "*** make it link in!  You will probably need to install it or some"
+		  $echo "***  make it link in!  You will probably need to install it or some"
 		  $echo "*** library that it depends on before this library will be fully"
 		  $echo "*** functional.  Installing it before continuing would be even better."
 		fi
 	      else
 		newdeplibs="$newdeplibs $i"
 	      fi
@@ -3929,16 +3885,13 @@
 	  done
 	  # Substitute the hardcoded libdirs into the rpath.
 	  if test -n "$hardcode_libdir_separator" &&
 	     test -n "$hardcode_libdirs"; then
 	    libdir="$hardcode_libdirs"
 	    if test -n "$hardcode_libdir_flag_spec_ld"; then
-	      case $archive_cmds in
-	      *\$LD*) eval dep_rpath=\"$hardcode_libdir_flag_spec_ld\" ;;
-	      *)      eval dep_rpath=\"$hardcode_libdir_flag_spec\" ;;
-	      esac
+	      eval dep_rpath=\"$hardcode_libdir_flag_spec_ld\"
 	    else
 	      eval dep_rpath=\"$hardcode_libdir_flag_spec\"
 	    fi
 	  fi
 	  if test -n "$runpath_var" && test -n "$perm_rpath"; then
 	    # We should set the runpath_var.
@@ -4291,20 +4244,18 @@
       # single-version convenience libraries.  Whenever we create
       # different ones for PIC/non-PIC, this we'll have to duplicate
       # the extraction.
       reload_conv_objs=
       gentop=
       # reload_cmds runs $LD directly, so let us get rid of
-      # -Wl from whole_archive_flag_spec and hope we can get by with
-      # turning comma into space..
+      # -Wl from whole_archive_flag_spec
       wl=
 
       if test -n "$convenience"; then
 	if test -n "$whole_archive_flag_spec"; then
-	  eval tmp_whole_archive_flags=\"$whole_archive_flag_spec\"
-	  reload_conv_objs=$reload_objs\ `$echo "X$tmp_whole_archive_flags" | $Xsed -e 's|,| |g'`
+	  eval reload_conv_objs=\"\$reload_objs $whole_archive_flag_spec\"
 	else
 	  gentop="$output_objdir/${obj}x"
 	  generated="$generated $gentop"
 
 	  func_extract_archives $gentop $convenience
 	  reload_conv_objs="$reload_objs $func_extract_archives_result"
@@ -4746,22 +4697,22 @@
 	  $run $rm "$output_objdir/$dlsyms" "$nlist" "${nlist}S" "${nlist}T"
 
 	  # Transform the symbol file into the correct name.
           case $host in
           *cygwin* | *mingw* )
             if test -f "$output_objdir/${outputname}.def" ; then
-              compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%" | $NL2SP`
-              finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%" | $NL2SP`
+              compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%"`
+              finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%"`
             else
-              compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
-              finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
+              compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
+              finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
              fi
             ;;
           * )
-            compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
-            finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
+            compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
+            finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
             ;;
           esac
 	  ;;
 	*)
 	  $echo "$modename: unknown suffix for \`$dlsyms'" 1>&2
 	  exit $EXIT_FAILURE
@@ -4770,19 +4721,19 @@
       else
 	# We keep going just in case the user didn't refer to
 	# lt_preloaded_symbols.  The linker will fail if global_symbol_pipe
 	# really was required.
 
 	# Nullify the symbol file.
-	compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s% @SYMFILE@%%" | $NL2SP`
-	finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s% @SYMFILE@%%" | $NL2SP`
+	compile_command=`$echo "X$compile_command" | $Xsed -e "s% @SYMFILE@%%"`
+	finalize_command=`$echo "X$finalize_command" | $Xsed -e "s% @SYMFILE@%%"`
       fi
 
       if test "$need_relink" = no || test "$build_libtool_libs" != yes; then
 	# Replace the output file specification.
-	compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e 's%@OUTPUT@%'"$output"'%g' | $NL2SP`
+	compile_command=`$echo "X$compile_command" | $Xsed -e 's%@OUTPUT@%'"$output"'%g'`
 	link_command="$compile_command$compile_rpath"
 
 	# We have no uninstalled library dependencies, so finalize right now.
 	$show "$link_command"
 	$run eval "$link_command"
 	exit_status=$?
@@ -4863,13 +4814,13 @@
 	$echo "$modename: warning: this platform does not like uninstalled shared libraries" 1>&2
 	$echo "$modename: \`$output' will be relinked during installation" 1>&2
       else
 	if test "$fast_install" != no; then
 	  link_command="$finalize_var$compile_command$finalize_rpath"
 	  if test "$fast_install" = yes; then
-	    relink_command=`$echo "X$compile_var$compile_command$compile_rpath" | $SP2NL | $Xsed -e 's%@OUTPUT@%\$progdir/\$file%g' | $NL2SP`
+	    relink_command=`$echo "X$compile_var$compile_command$compile_rpath" | $Xsed -e 's%@OUTPUT@%\$progdir/\$file%g'`
 	  else
 	    # fast_install is set to needless
 	    relink_command=
 	  fi
 	else
 	  link_command="$compile_var$compile_command$compile_rpath"
@@ -4900,13 +4851,13 @@
 	  else
 	    var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
 	    relink_command="$var=\"$var_value\"; export $var; $relink_command"
 	  fi
 	done
 	relink_command="(cd `pwd`; $relink_command)"
-	relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e "$sed_quote_subst" | $NL2SP`
+	relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
       fi
 
       # Quote $echo for shipping.
       if test "X$echo" = "X$SHELL $progpath --fallback-echo"; then
 	case $progpath in
 	[\\/]* | [A-Za-z]:[\\/]*) qecho="$SHELL $progpath --fallback-echo";;
@@ -5307,26 +5258,12 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
 Xsed='${SED} -e 1s/^X//'
 sed_quote_subst='$sed_quote_subst'
 
-# Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
-if test -n \"\${ZSH_VERSION+set}\" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on \${1+\"\$@\"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '\${1+\"\$@\"}'='\"\$@\"'
-  setopt NO_GLOB_SUBST
-else
-  case \`(set -o) 2>/dev/null\` in *posix*) set -o posix;; esac
-fi
-BIN_SH=xpg4; export BIN_SH # for Tru64
-DUALCASE=1; export DUALCASE # for MKS sh
-
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
 (unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 relink_command=\"$relink_command\"
 
@@ -5463,13 +5400,13 @@
 	  $echo >> $output "\
       exec \"\$progdir/\$program\" \${1+\"\$@\"}
 "
 	  ;;
 	esac
 	$echo >> $output "\
-      \$echo \"\$0: cannot exec \$program \$*\"
+      \$echo \"\$0: cannot exec \$program \${1+\"\$@\"}\"
       exit $EXIT_FAILURE
     fi
   else
     # The program doesn't exist.
     \$echo \"\$0: error: \\\`\$progdir/\$program' does not exist\" 1>&2
     \$echo \"This script is just a wrapper for \$program.\" 1>&2
@@ -5649,13 +5586,13 @@
 	  var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
 	  relink_command="$var=\"$var_value\"; export $var; $relink_command"
 	fi
       done
       # Quote the link command for shipping.
       relink_command="(cd `pwd`; $SHELL $progpath $preserve_args --mode=relink $libtool_args @inst_prefix_dir@)"
-      relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e "$sed_quote_subst" | $NL2SP`
+      relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
       if test "$hardcode_automatic" = yes ; then
 	relink_command=
       fi
 
 
       # Only create the output if not a dry run.
@@ -5994,15 +5931,15 @@
 	    $echo "$modename: error: cannot install \`$file' to a directory not ending in $libdir" 1>&2
 	    exit $EXIT_FAILURE
 	  fi
 
 	  if test -n "$inst_prefix_dir"; then
 	    # Stick the inst_prefix_dir data into the link command.
-	    relink_command=`$echo "$relink_command" | $SP2NL | $SED "s%@inst_prefix_dir@%-inst-prefix-dir $inst_prefix_dir%" | $NL2SP`
+	    relink_command=`$echo "$relink_command" | $SED "s%@inst_prefix_dir@%-inst-prefix-dir $inst_prefix_dir%"`
 	  else
-	    relink_command=`$echo "$relink_command" | $SP2NL | $SED "s%@inst_prefix_dir@%%" | $NL2SP`
+	    relink_command=`$echo "$relink_command" | $SED "s%@inst_prefix_dir@%%"`
 	  fi
 
 	  $echo "$modename: warning: relinking \`$file'" 1>&2
 	  $show "$relink_command"
 	  if $run eval "$relink_command"; then :
 	  else
@@ -6205,13 +6142,13 @@
 	  if test "$fast_install" = no && test -n "$relink_command"; then
 	    if test "$finalize" = yes && test -z "$run"; then
 	      tmpdir=`func_mktempdir`
 	      file=`$echo "X$file$stripped_ext" | $Xsed -e 's%^.*/%%'`
 	      outputname="$tmpdir/$file"
 	      # Replace the output file specification.
-	      relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e 's%@OUTPUT@%'"$outputname"'%g' | $NL2SP`
+	      relink_command=`$echo "X$relink_command" | $Xsed -e 's%@OUTPUT@%'"$outputname"'%g'`
 
 	      $show "$relink_command"
 	      if $run eval "$relink_command"; then :
 	      else
 		$echo "$modename: error: relink \`$file' with the above command before installing it" 1>&2
 		${rm}r "$tmpdir"
@@ -6416,16 +6353,14 @@
 	dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`
 	test "X$dir" = "X$file" && dir=.
 
 	if test -f "$dir/$objdir/$dlname"; then
 	  dir="$dir/$objdir"
 	else
-	  if test ! -f "$dir/$dlname"; then
-	    $echo "$modename: cannot find \`$dlname' in \`$dir' or \`$dir/$objdir'" 1>&2
-	    exit $EXIT_FAILURE
-	  fi
+	  $echo "$modename: cannot find \`$dlname' in \`$dir' or \`$dir/$objdir'" 1>&2
+	  exit $EXIT_FAILURE
 	fi
 	;;
 
       *.lo)
 	# Just add the directory containing the .lo file.
 	dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`
@@ -6483,18 +6418,18 @@
       if test -n "$shlibpath_var"; then
 	# Export the shlibpath_var.
 	eval "export $shlibpath_var"
       fi
 
       # Restore saved environment variables
-      for lt_var in LANG LC_ALL LC_CTYPE LC_COLLATE LC_MESSAGES
-      do
-	eval "if test \"\${save_$lt_var+set}\" = set; then
-		$lt_var=\$save_$lt_var; export $lt_var
-	      fi"
-      done
+      if test "${save_LC_ALL+set}" = set; then
+	LC_ALL="$save_LC_ALL"; export LC_ALL
+      fi
+      if test "${save_LANG+set}" = set; then
+	LANG="$save_LANG"; export LANG
+      fi
 
       # Now prepare to actually exec the command.
       exec_cmd="\$cmd$args"
     else
       # Display what would be done.
       if test -n "$shlibpath_var"; then
@@ -6861,15 +6796,13 @@
   -objectlist FILE  Use a list of object files found in FILE to specify objects
   -precious-files-regex REGEX
                     don't remove output files matching REGEX
   -release RELEASE  specify package release information
   -rpath LIBDIR     the created library will eventually be installed in LIBDIR
   -R[ ]LIBDIR       add LIBDIR to the runtime path of programs and libraries
-  -static           do not do any dynamic linking of uninstalled libtool libraries
-  -static-libtool-libs
-                    do not do any dynamic linking of libtool libraries
+  -static           do not do any dynamic linking of libtool libraries
   -version-info CURRENT[:REVISION[:AGE]]
                     specify library version info [each variable defaults to 0]
 
 All other options (arguments beginning with \`-') are ignored.
 
 Every other argument is treated as a filename.  Files ending in \`.la' are
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/Makefile.am	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/Makefile.am	2006-03-12 02:49:03.000000000 +0800
@@ -15,13 +15,13 @@
 
 ## Make sure these will be cleaned even when they're not built by
 ## default.
 CLEANFILES = libltdl.la libltdlc.la
 
 libltdl_la_SOURCES = ltdl.c
-libltdl_la_LDFLAGS = -no-undefined -version-info 4:5:1
+libltdl_la_LDFLAGS = -no-undefined -version-info 4:4:1
 libltdl_la_LIBADD = $(LIBADD_DL)
 
 libltdlc_la_SOURCES = ltdl.c
 libltdlc_la_LIBADD = $(LIBADD_DL)
 
 ## Because we do not have automatic dependency tracking:
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/Makefile.in	2007-09-28 19:33:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/Makefile.in	2006-03-12 02:49:04.000000000 +0800
@@ -131,13 +131,12 @@
 ECHO_N = @ECHO_N@
 ECHO_T = @ECHO_T@
 EGREP = @EGREP@
 EXEEXT = @EXEEXT@
 F77 = @F77@
 FFLAGS = @FFLAGS@
-GREP = @GREP@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_LTDL_FALSE = @INSTALL_LTDL_FALSE@
 INSTALL_LTDL_TRUE = @INSTALL_LTDL_TRUE@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
@@ -157,20 +156,25 @@
 PACKAGE_NAME = @PACKAGE_NAME@
 PACKAGE_STRING = @PACKAGE_STRING@
 PACKAGE_TARNAME = @PACKAGE_TARNAME@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 RANLIB = @RANLIB@
-SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
+ac_ct_AR = @ac_ct_AR@
+ac_ct_AS = @ac_ct_AS@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
+ac_ct_DLLTOOL = @ac_ct_DLLTOOL@
 ac_ct_F77 = @ac_ct_F77@
+ac_ct_OBJDUMP = @ac_ct_OBJDUMP@
+ac_ct_RANLIB = @ac_ct_RANLIB@
+ac_ct_STRIP = @ac_ct_STRIP@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
 am__fastdepCXX_TRUE = @am__fastdepCXX_TRUE@
 am__include = @am__include@
 am__leading_dot = @am__leading_dot@
@@ -181,48 +185,41 @@
 build = @build@
 build_alias = @build_alias@
 build_cpu = @build_cpu@
 build_os = @build_os@
 build_vendor = @build_vendor@
 datadir = @datadir@
-datarootdir = @datarootdir@
-docdir = @docdir@
-dvidir = @dvidir@
 exec_prefix = @exec_prefix@
 host = @host@
 host_alias = @host_alias@
 host_cpu = @host_cpu@
 host_os = @host_os@
 host_vendor = @host_vendor@
-htmldir = @htmldir@
 includedir = @includedir@
 infodir = @infodir@
 install_sh = @install_sh@
 libdir = @libdir@
 libexecdir = @libexecdir@
-localedir = @localedir@
 localstatedir = @localstatedir@
 mandir = @mandir@
 mkdir_p = @mkdir_p@
 oldincludedir = @oldincludedir@
-pdfdir = @pdfdir@
 prefix = @prefix@
 program_transform_name = @program_transform_name@
-psdir = @psdir@
 sbindir = @sbindir@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
 AUTOMAKE_OPTIONS = no-dependencies foreign
 @INSTALL_LTDL_TRUE@include_HEADERS = ltdl.h
 @INSTALL_LTDL_TRUE@lib_LTLIBRARIES = libltdl.la
 @INSTALL_LTDL_FALSE@noinst_HEADERS = ltdl.h
 @CONVENIENCE_LTDL_TRUE@noinst_LTLIBRARIES = libltdlc.la
 CLEANFILES = libltdl.la libltdlc.la
 libltdl_la_SOURCES = ltdl.c
-libltdl_la_LDFLAGS = -no-undefined -version-info 4:5:1
+libltdl_la_LDFLAGS = -no-undefined -version-info 4:4:1
 libltdl_la_LIBADD = $(LIBADD_DL)
 libltdlc_la_SOURCES = ltdl.c
 libltdlc_la_LIBADD = $(LIBADD_DL)
 all: config.h
 	$(MAKE) $(AM_MAKEFLAGS) all-am
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/missing /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/missing
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/libltdl/missing	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/libltdl/missing	2006-03-12 02:49:04.000000000 +0800
@@ -1,12 +1,12 @@
 #! /bin/sh
 # Common stub for a few missing GNU programs while installing.
 
-scriptversion=2005-06-08.21
+scriptversion=2004-09-07.08
 
-# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004, 2005
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004
 #   Free Software Foundation, Inc.
 # Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2, or (at your option)
@@ -16,14 +16,14 @@
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 # GNU General Public License for more details.
 
 # You should have received a copy of the GNU General Public License
 # along with this program; if not, write to the Free Software
-# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
-# 02110-1301, USA.
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
 
 # As a special exception to the GNU General Public License, if you
 # distribute this file as part of a program that contains a
 # configuration script generated by Autoconf, you may include it under
 # the same distribution terms that you use for the rest of that program.
 
@@ -84,18 +84,18 @@
   lex          create \`lex.yy.c', if possible, from existing .c
   makeinfo     touch the output file
   tar          try tar, gnutar, gtar, then tar without non-portable flags
   yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
 
 Send bug reports to <bug-automake@gnu.org>."
-    exit $?
+    exit 0
     ;;
 
   -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
     echo "missing $scriptversion (GNU Automake)"
-    exit $?
+    exit 0
     ;;
 
   -*)
     echo 1>&2 "$0: Unknown \`$1' option"
     echo 1>&2 "Try \`$0 --help' for more information"
     exit 1
@@ -285,24 +285,17 @@
 WARNING: \`$1' is $msg.  You should only need it if
          you modified a \`.texi' or \`.texinfo' file, or any other file
          indirectly affecting the aspect of the manual.  The spurious
          call might also be the consequence of using a buggy \`make' (AIX,
          DU, IRIX).  You might want to install the \`Texinfo' package or
          the \`GNU make' package.  Grab either from any GNU archive site."
-    # The file to touch is that specified with -o ...
     file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
     if test -z "$file"; then
-      # ... or it is the one specified with @setfilename ...
-      infile=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
-      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $infile`
-      # ... or it is derived from the source name (dir/f.texi becomes f.info)
-      test -z "$file" && file=`echo "$infile" | sed 's,.*/,,;s,.[^.]*$,,'`.info
-    fi
-    # If the file does not exist, the user really needs makeinfo;
-    # let's fail without touching anything.
-    test -f $file || exit 1
+      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
+    fi
     touch $file
     ;;
 
   tar)
     shift
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/ltmain.sh /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/ltmain.sh
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/ltmain.sh	2007-07-12 05:11:42.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/ltmain.sh	2006-03-12 02:49:04.000000000 +0800
@@ -1,11 +1,11 @@
 # ltmain.sh - Provide generalized library-building support services.
 # NOTE: Changing this file will not affect anything until you rerun configure.
 #
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005, 2006,
-# 2007  Free Software Foundation, Inc.
+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005
+# Free Software Foundation, Inc.
 # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996
 #
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
@@ -40,28 +40,20 @@
 # Global variables:
 EXIT_SUCCESS=0
 EXIT_FAILURE=1
 
 PROGRAM=ltmain.sh
 PACKAGE=libtool
-VERSION="1.5.24 Debian 1.5.24-1"
-TIMESTAMP=" (1.1220.2.456 2007/06/24 02:25:32)"
+VERSION="1.5.22 Debian 1.5.22-4"
+TIMESTAMP=" (1.1220.2.365 2005/12/18 22:14:06)"
 
-# Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
+# See if we are running on zsh, and set the options which allow our
+# commands through without removal of \ escapes.
+if test -n "${ZSH_VERSION+set}" ; then
   setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in *posix*) set -o posix;; esac
 fi
-BIN_SH=xpg4; export BIN_SH # for Tru64
-DUALCASE=1; export DUALCASE # for MKS sh
 
 # Check that we have a working $echo.
 if test "X$1" = X--no-reexec; then
   # Discard the --no-reexec flag, and continue.
   shift
 elif test "X$1" = X--fallback-echo; then
@@ -110,20 +102,18 @@
 
 # NLS nuisances.
 # Only set LANG and LC_ALL to C if already set.
 # These must not be set unconditionally because not all systems understand
 # e.g. LANG=C (notably SCO).
 # We save the old values to restore during execute mode.
-for lt_var in LANG LC_ALL LC_CTYPE LC_COLLATE LC_MESSAGES
-do
-  eval "if test \"\${$lt_var+set}\" = set; then
-	  save_$lt_var=\$$lt_var
-	  $lt_var=C
-	  export $lt_var
-	fi"
-done
+if test "${LC_ALL+set}" = set; then
+  save_LC_ALL="$LC_ALL"; LC_ALL=C; export LC_ALL
+fi
+if test "${LANG+set}" = set; then
+  save_LANG="$LANG"; LANG=C; export LANG
+fi
 
 # Make sure IFS has a sensible default
 lt_nl='
 '
 IFS=" 	$lt_nl"
 
@@ -143,14 +133,12 @@
 show_help=
 execute_dlfiles=
 duplicate_deps=no
 preserve_args=
 lo2o="s/\\.lo\$/.${objext}/"
 o2lo="s/\\.${objext}\$/.lo/"
-extracted_archives=
-extracted_serial=0
 
 #####################################
 # Shell function definitions:
 # This seems to be the best place for them
 
 # func_mktempdir [string]
@@ -205,19 +193,13 @@
     win32_libid_type="x86 archive import"
     ;;
   *ar\ archive*) # could be an import, or static
     if eval $OBJDUMP -f $1 | $SED -e '10q' 2>/dev/null | \
       $EGREP -e 'file format pe-i386(.*architecture: i386)?' >/dev/null ; then
       win32_nmres=`eval $NM -f posix -A $1 | \
-	$SED -n -e '1,100{
-		/ I /{
-			s,.*,import,
-			p
-			q
-			}
-		}'`
+	$SED -n -e '1,100{/ I /{s,.*,import,;p;q;};}'`
       case $win32_nmres in
       import*)  win32_libid_type="x86 archive import";;
       *)        win32_libid_type="x86 archive static";;
       esac
     fi
     ;;
@@ -342,23 +324,13 @@
       # Extract the objects.
       case $my_xlib in
 	[\\/]* | [A-Za-z]:[\\/]*) my_xabs="$my_xlib" ;;
 	*) my_xabs=`pwd`"/$my_xlib" ;;
       esac
       my_xlib=`$echo "X$my_xlib" | $Xsed -e 's%^.*/%%'`
-      my_xlib_u=$my_xlib
-      while :; do
-        case " $extracted_archives " in
-	*" $my_xlib_u "*)
-	  extracted_serial=`expr $extracted_serial + 1`
-	  my_xlib_u=lt$extracted_serial-$my_xlib ;;
-	*) break ;;
-	esac
-      done
-      extracted_archives="$extracted_archives $my_xlib_u"
-      my_xdir="$my_gentop/$my_xlib_u"
+      my_xdir="$my_gentop/$my_xlib"
 
       $show "${rm}r $my_xdir"
       $run ${rm}r "$my_xdir"
       $show "$mkdir $my_xdir"
       $run $mkdir "$my_xdir"
       exit_status=$?
@@ -479,18 +451,17 @@
   case $arg in
   --help)
     show_help=yes
     ;;
 
   --version)
-    echo "\
-$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP
-
-Copyright (C) 2007  Free Software Foundation, Inc.
-This is free software; see the source for copying conditions.  There is NO
-warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+    $echo "$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP"
+    $echo
+    $echo "Copyright (C) 2005  Free Software Foundation, Inc."
+    $echo "This is free software; see the source for copying conditions.  There is NO"
+    $echo "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
     exit $?
     ;;
 
   --config)
     ${SED} -e '1,/^# ### BEGIN LIBTOOL CONFIG/d' -e '/^# ### END LIBTOOL CONFIG/,$d' $progpath
     # Now print the configurations for the tags.
@@ -781,16 +752,15 @@
     *.c++) xform=c++ ;;
     *.cc) xform=cc ;;
     *.ii) xform=ii ;;
     *.class) xform=class ;;
     *.cpp) xform=cpp ;;
     *.cxx) xform=cxx ;;
-    *.[fF][09]?) xform=[fF][09]. ;;
+    *.f90) xform=f90 ;;
     *.for) xform=for ;;
     *.java) xform=java ;;
-    *.obj) xform=obj ;;
     esac
 
     libobj=`$echo "X$libobj" | $Xsed -e "s/\.$xform$/.lo/"`
 
     case $libobj in
     *.lo) obj=`$echo "X$libobj" | $Xsed -e "$lo2o"` ;;
@@ -1165,36 +1135,27 @@
     func_infer_tag $base_compile
 
     # We need to know -static, to get the right output filenames.
     for arg
     do
       case $arg in
-      -all-static | -static | -static-libtool-libs)
-	case $arg in
-	-all-static)
+      -all-static | -static)
+	if test "X$arg" = "X-all-static"; then
 	  if test "$build_libtool_libs" = yes && test -z "$link_static_flag"; then
 	    $echo "$modename: warning: complete static linking is impossible in this configuration" 1>&2
 	  fi
 	  if test -n "$link_static_flag"; then
 	    dlopen_self=$dlopen_self_static
 	  fi
 	  prefer_static_libs=yes
-	  ;;
-	-static)
+	else
 	  if test -z "$pic_flag" && test -n "$link_static_flag"; then
 	    dlopen_self=$dlopen_self_static
 	  fi
 	  prefer_static_libs=built
-	  ;;
-	-static-libtool-libs)
-	  if test -z "$pic_flag" && test -n "$link_static_flag"; then
-	    dlopen_self=$dlopen_self_static
-	  fi
-	  prefer_static_libs=yes
-	  ;;
-	esac
+	fi
 	build_libtool_libs=no
 	build_old_libs=yes
 	break
 	;;
       esac
     done
@@ -1636,13 +1597,13 @@
 	compiler_flags="$compiler_flags $arg"
 	finalize_command="$finalize_command $arg"
 	prev=xcompiler
 	continue
 	;;
 
-     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
+     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
 	compiler_flags="$compiler_flags $arg"
 	compile_command="$compile_command $arg"
 	finalize_command="$finalize_command $arg"
 	continue
 	;;
 
@@ -1656,17 +1617,16 @@
       # -xarch=*, -xtarget=* enable 64-bit mode on the Sun compiler
       # +DA*, +DD* enable 64-bit mode on the HP compiler
       # -q* pass through compiler args for the IBM compiler
       # -m* pass through architecture-specific compiler args for GCC
       # -m*, -t[45]*, -txscale* pass through architecture-specific
       # compiler args for GCC
-      # -p, -pg, --coverage, -fprofile-* pass through profiling flag for GCC
-      # -F/path gives path to uninstalled frameworks, gcc on darwin
+      # -pg pass through profiling flag for GCC
       # @file GCC response files
-      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*| \
-      -t[45]*|-txscale*|-p|-pg|--coverage|-fprofile-*|-F*|@*)
+      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*|-pg| \
+      -t[45]*|-txscale*|@*)
 
 	# Unknown arguments in both finalize_command and compile_command need
 	# to be aesthetically quoted because they are evaled later.
 	arg=`$echo "X$arg" | $Xsed -e "$sed_quote_subst"`
 	case $arg in
 	*[\[\~\#\^\&\*\(\)\{\}\|\;\<\>\?\'\ \	]*|*]*|"")
@@ -1688,15 +1648,15 @@
 	fast_install=no
 	continue
 	;;
 
       -no-install)
 	case $host in
-	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-darwin*)
+	*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)
 	  # The PATH hackery in wrapper scripts is required on Windows
-	  # and Darwin in order for the loader to find any dlls it needs.
+	  # in order for the loader to find any dlls it needs.
 	  $echo "$modename: warning: \`-no-install' is ignored for $host" 1>&2
 	  $echo "$modename: warning: assuming \`-no-fast-install' instead" 1>&2
 	  fast_install=no
 	  ;;
 	*) no_install=yes ;;
 	esac
@@ -1749,13 +1709,13 @@
 	*" $dir "*) ;;
 	*) xrpath="$xrpath $dir" ;;
 	esac
 	continue
 	;;
 
-      -static | -static-libtool-libs)
+      -static)
 	# The effects of -static are defined in a previous loop.
 	# We used to do the same as -all-static on platforms that
 	# didn't have a PIC flag, but the assumption that the effects
 	# would be equivalent was wrong.  It would break on at least
 	# Digital Unix and AIX.
 	continue
@@ -2134,13 +2094,13 @@
 	deplibs=
       fi
       for deplib in $libs; do
 	lib=
 	found=no
 	case $deplib in
-	-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe|-threads)
+	-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)
 	  if test "$linkmode,$pass" = "prog,link"; then
 	    compile_deplibs="$deplib $compile_deplibs"
 	    finalize_deplibs="$deplib $finalize_deplibs"
 	  else
 	    compiler_flags="$compiler_flags $deplib"
 	  fi
@@ -2530,15 +2490,13 @@
 	  done # for deplib
 	  continue
 	fi # $linkmode = prog...
 
 	if test "$linkmode,$pass" = "prog,link"; then
 	  if test -n "$library_names" &&
-	     { { test "$prefer_static_libs" = no ||
-		 test "$prefer_static_libs,$installed" = "built,yes"; } ||
-	       test -z "$old_library"; }; then
+	     { test "$prefer_static_libs" = no || test -z "$old_library"; }; then
 	    # We need to hardcode the library path
 	    if test -n "$shlibpath_var" && test -z "$avoidtemprpath" ; then
 	      # Make sure the rpath contains only unique directories.
 	      case "$temp_rpath " in
 	      *" $dir "*) ;;
 	      *" $absdir "*) ;;
@@ -3228,27 +3186,26 @@
 	  # use the current revision as the major version
 	  # and those that subtract age and use age as
 	  # a minor version.  But, then there is irix
 	  # which has an extra 1 added just for fun
 	  #
 	  case $version_type in
-	  darwin|linux|osf|windows|none)
+	  darwin|linux|osf|windows)
 	    current=`expr $number_major + $number_minor`
 	    age="$number_minor"
 	    revision="$number_revision"
 	    ;;
 	  freebsd-aout|freebsd-elf|sunos)
 	    current="$number_major"
 	    revision="$number_minor"
 	    age="0"
 	    ;;
 	  irix|nonstopux)
-	    current=`expr $number_major + $number_minor`
+	    current=`expr $number_major + $number_minor - 1`
 	    age="$number_minor"
 	    revision="$number_minor"
-	    lt_irix_increment=no
 	    ;;
 	  *)
 	    $echo "$modename: unknown library version type \`$version_type'" 1>&2
 	    $echo "Fatal configuration error.  See the $PACKAGE docs for more information." 1>&2
 	    exit $EXIT_FAILURE
 	    ;;
@@ -3306,14 +3263,13 @@
 	  # Like Linux, but with the current version available in
 	  # verstring for coding it into the library header
 	  major=.`expr $current - $age`
 	  versuffix="$major.$age.$revision"
 	  # Darwin ld doesn't like 0 for these options...
 	  minor_current=`expr $current + 1`
-	  xlcverstring="${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision"
-	  verstring="-compatibility_version $minor_current -current_version $minor_current.$revision"
+	  verstring="${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision"
 	  ;;
 
 	freebsd-aout)
 	  major=".$current"
 	  versuffix=".$current.$revision";
 	  ;;
@@ -3321,17 +3277,14 @@
 	freebsd-elf)
 	  major=".$current"
 	  versuffix=".$current";
 	  ;;
 
 	irix | nonstopux)
-	  if test "X$lt_irix_increment" = "Xno"; then
-	    major=`expr $current - $age`
-	  else
-	    major=`expr $current - $age + 1`
-	  fi
+	  major=`expr $current - $age + 1`
+
 	  case $version_type in
 	    nonstopux) verstring_prefix=nonstopux ;;
 	    *)         verstring_prefix=sgi ;;
 	  esac
 	  verstring="$verstring_prefix$major.$revision"
 
@@ -3462,17 +3415,17 @@
 
 	# Transform .lo files to .o files.
 	oldobjs="$objs "`$echo "X$libobjs" | $SP2NL | $Xsed -e '/\.'${libext}'$/d' -e "$lo2o" | $NL2SP`
       fi
 
       # Eliminate all temporary directories.
-      #for path in $notinst_path; do
-      #	lib_search_path=`$echo "$lib_search_path " | ${SED} -e "s% $path % %g"`
-      #	deplibs=`$echo "$deplibs " | ${SED} -e "s% -L$path % %g"`
-      #	dependency_libs=`$echo "$dependency_libs " | ${SED} -e "s% -L$path % %g"`
-      #done
+      for path in $notinst_path; do
+	lib_search_path=`$echo "$lib_search_path " | ${SED} -e "s% $path % %g"`
+	deplibs=`$echo "$deplibs " | ${SED} -e "s% -L$path % %g"`
+	dependency_libs=`$echo "$dependency_libs " | ${SED} -e "s% -L$path % %g"`
+      done
 
       if test -n "$xrpath"; then
 	# If the user specified any rpath flags, then add them.
 	temp_xrpath=
 	for libdir in $xrpath; do
 	  temp_xrpath="$temp_xrpath -R$libdir"
@@ -3567,18 +3520,19 @@
 	  # whether they linked in statically or dynamically with ldd.
 	  $rm conftest.c
 	  cat > conftest.c <<EOF
 	  int main() { return 0; }
 EOF
 	  $rm conftest
-	  if $LTCC $LTCFLAGS -o conftest conftest.c $deplibs; then
+	  $LTCC $LTCFLAGS -o conftest conftest.c $deplibs
+	  if test "$?" -eq 0 ; then
 	    ldd_output=`ldd conftest`
 	    for i in $deplibs; do
 	      name=`expr $i : '-l\(.*\)'`
 	      # If $name is empty we are operating on a -L argument.
-              if test "$name" != "" && test "$name" != "0"; then
+              if test "$name" != "" && test "$name" -ne "0"; then
 		if test "X$allow_libtool_libs_with_static_runtimes" = "Xyes" ; then
 		  case " $predeps $postdeps " in
 		  *" $i "*)
 		    newdeplibs="$newdeplibs $i"
 		    i=""
 		    ;;
@@ -3611,13 +3565,15 @@
 	    # the situation: Compile a separate program for each library.
 	    for i in $deplibs; do
 	      name=`expr $i : '-l\(.*\)'`
 	      # If $name is empty we are operating on a -L argument.
               if test "$name" != "" && test "$name" != "0"; then
 		$rm conftest
-		if $LTCC $LTCFLAGS -o conftest conftest.c $i; then
+		$LTCC $LTCFLAGS -o conftest conftest.c $i
+		# Did it work?
+		if test "$?" -eq 0 ; then
 		  ldd_output=`ldd conftest`
 		  if test "X$allow_libtool_libs_with_static_runtimes" = "Xyes" ; then
 		    case " $predeps $postdeps " in
 		    *" $i "*)
 		      newdeplibs="$newdeplibs $i"
 		      i=""
@@ -3643,13 +3599,13 @@
 		    fi
 		  fi
 		else
 		  droppeddeps=yes
 		  $echo
 		  $echo "*** Warning!  Library $i is needed by this library but I was not able to"
-		  $echo "*** make it link in!  You will probably need to install it or some"
+		  $echo "***  make it link in!  You will probably need to install it or some"
 		  $echo "*** library that it depends on before this library will be fully"
 		  $echo "*** functional.  Installing it before continuing would be even better."
 		fi
 	      else
 		newdeplibs="$newdeplibs $i"
 	      fi
@@ -3929,16 +3885,13 @@
 	  done
 	  # Substitute the hardcoded libdirs into the rpath.
 	  if test -n "$hardcode_libdir_separator" &&
 	     test -n "$hardcode_libdirs"; then
 	    libdir="$hardcode_libdirs"
 	    if test -n "$hardcode_libdir_flag_spec_ld"; then
-	      case $archive_cmds in
-	      *\$LD*) eval dep_rpath=\"$hardcode_libdir_flag_spec_ld\" ;;
-	      *)      eval dep_rpath=\"$hardcode_libdir_flag_spec\" ;;
-	      esac
+	      eval dep_rpath=\"$hardcode_libdir_flag_spec_ld\"
 	    else
 	      eval dep_rpath=\"$hardcode_libdir_flag_spec\"
 	    fi
 	  fi
 	  if test -n "$runpath_var" && test -n "$perm_rpath"; then
 	    # We should set the runpath_var.
@@ -4291,20 +4244,18 @@
       # single-version convenience libraries.  Whenever we create
       # different ones for PIC/non-PIC, this we'll have to duplicate
       # the extraction.
       reload_conv_objs=
       gentop=
       # reload_cmds runs $LD directly, so let us get rid of
-      # -Wl from whole_archive_flag_spec and hope we can get by with
-      # turning comma into space..
+      # -Wl from whole_archive_flag_spec
       wl=
 
       if test -n "$convenience"; then
 	if test -n "$whole_archive_flag_spec"; then
-	  eval tmp_whole_archive_flags=\"$whole_archive_flag_spec\"
-	  reload_conv_objs=$reload_objs\ `$echo "X$tmp_whole_archive_flags" | $Xsed -e 's|,| |g'`
+	  eval reload_conv_objs=\"\$reload_objs $whole_archive_flag_spec\"
 	else
 	  gentop="$output_objdir/${obj}x"
 	  generated="$generated $gentop"
 
 	  func_extract_archives $gentop $convenience
 	  reload_conv_objs="$reload_objs $func_extract_archives_result"
@@ -4746,22 +4697,22 @@
 	  $run $rm "$output_objdir/$dlsyms" "$nlist" "${nlist}S" "${nlist}T"
 
 	  # Transform the symbol file into the correct name.
           case $host in
           *cygwin* | *mingw* )
             if test -f "$output_objdir/${outputname}.def" ; then
-              compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%" | $NL2SP`
-              finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%" | $NL2SP`
+              compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%"`
+              finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}.def $output_objdir/${outputname}S.${objext}%"`
             else
-              compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
-              finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
+              compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
+              finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
              fi
             ;;
           * )
-            compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
-            finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%" | $NL2SP`
+            compile_command=`$echo "X$compile_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
+            finalize_command=`$echo "X$finalize_command" | $Xsed -e "s%@SYMFILE@%$output_objdir/${outputname}S.${objext}%"`
             ;;
           esac
 	  ;;
 	*)
 	  $echo "$modename: unknown suffix for \`$dlsyms'" 1>&2
 	  exit $EXIT_FAILURE
@@ -4770,19 +4721,19 @@
       else
 	# We keep going just in case the user didn't refer to
 	# lt_preloaded_symbols.  The linker will fail if global_symbol_pipe
 	# really was required.
 
 	# Nullify the symbol file.
-	compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e "s% @SYMFILE@%%" | $NL2SP`
-	finalize_command=`$echo "X$finalize_command" | $SP2NL | $Xsed -e "s% @SYMFILE@%%" | $NL2SP`
+	compile_command=`$echo "X$compile_command" | $Xsed -e "s% @SYMFILE@%%"`
+	finalize_command=`$echo "X$finalize_command" | $Xsed -e "s% @SYMFILE@%%"`
       fi
 
       if test "$need_relink" = no || test "$build_libtool_libs" != yes; then
 	# Replace the output file specification.
-	compile_command=`$echo "X$compile_command" | $SP2NL | $Xsed -e 's%@OUTPUT@%'"$output"'%g' | $NL2SP`
+	compile_command=`$echo "X$compile_command" | $Xsed -e 's%@OUTPUT@%'"$output"'%g'`
 	link_command="$compile_command$compile_rpath"
 
 	# We have no uninstalled library dependencies, so finalize right now.
 	$show "$link_command"
 	$run eval "$link_command"
 	exit_status=$?
@@ -4863,13 +4814,13 @@
 	$echo "$modename: warning: this platform does not like uninstalled shared libraries" 1>&2
 	$echo "$modename: \`$output' will be relinked during installation" 1>&2
       else
 	if test "$fast_install" != no; then
 	  link_command="$finalize_var$compile_command$finalize_rpath"
 	  if test "$fast_install" = yes; then
-	    relink_command=`$echo "X$compile_var$compile_command$compile_rpath" | $SP2NL | $Xsed -e 's%@OUTPUT@%\$progdir/\$file%g' | $NL2SP`
+	    relink_command=`$echo "X$compile_var$compile_command$compile_rpath" | $Xsed -e 's%@OUTPUT@%\$progdir/\$file%g'`
 	  else
 	    # fast_install is set to needless
 	    relink_command=
 	  fi
 	else
 	  link_command="$compile_var$compile_command$compile_rpath"
@@ -4900,13 +4851,13 @@
 	  else
 	    var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
 	    relink_command="$var=\"$var_value\"; export $var; $relink_command"
 	  fi
 	done
 	relink_command="(cd `pwd`; $relink_command)"
-	relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e "$sed_quote_subst" | $NL2SP`
+	relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
       fi
 
       # Quote $echo for shipping.
       if test "X$echo" = "X$SHELL $progpath --fallback-echo"; then
 	case $progpath in
 	[\\/]* | [A-Za-z]:[\\/]*) qecho="$SHELL $progpath --fallback-echo";;
@@ -5307,26 +5258,12 @@
 
 # Sed substitution that helps us do robust quoting.  It backslashifies
 # metacharacters that are still active within double-quoted strings.
 Xsed='${SED} -e 1s/^X//'
 sed_quote_subst='$sed_quote_subst'
 
-# Be Bourne compatible (taken from Autoconf:_AS_BOURNE_COMPATIBLE).
-if test -n \"\${ZSH_VERSION+set}\" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on \${1+\"\$@\"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '\${1+\"\$@\"}'='\"\$@\"'
-  setopt NO_GLOB_SUBST
-else
-  case \`(set -o) 2>/dev/null\` in *posix*) set -o posix;; esac
-fi
-BIN_SH=xpg4; export BIN_SH # for Tru64
-DUALCASE=1; export DUALCASE # for MKS sh
-
 # The HP-UX ksh and POSIX shell print the target directory to stdout
 # if CDPATH is set.
 (unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 relink_command=\"$relink_command\"
 
@@ -5463,13 +5400,13 @@
 	  $echo >> $output "\
       exec \"\$progdir/\$program\" \${1+\"\$@\"}
 "
 	  ;;
 	esac
 	$echo >> $output "\
-      \$echo \"\$0: cannot exec \$program \$*\"
+      \$echo \"\$0: cannot exec \$program \${1+\"\$@\"}\"
       exit $EXIT_FAILURE
     fi
   else
     # The program doesn't exist.
     \$echo \"\$0: error: \\\`\$progdir/\$program' does not exist\" 1>&2
     \$echo \"This script is just a wrapper for \$program.\" 1>&2
@@ -5649,13 +5586,13 @@
 	  var_value=`$echo "X$var_value" | $Xsed -e "$sed_quote_subst"`
 	  relink_command="$var=\"$var_value\"; export $var; $relink_command"
 	fi
       done
       # Quote the link command for shipping.
       relink_command="(cd `pwd`; $SHELL $progpath $preserve_args --mode=relink $libtool_args @inst_prefix_dir@)"
-      relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e "$sed_quote_subst" | $NL2SP`
+      relink_command=`$echo "X$relink_command" | $Xsed -e "$sed_quote_subst"`
       if test "$hardcode_automatic" = yes ; then
 	relink_command=
       fi
 
 
       # Only create the output if not a dry run.
@@ -5994,15 +5931,15 @@
 	    $echo "$modename: error: cannot install \`$file' to a directory not ending in $libdir" 1>&2
 	    exit $EXIT_FAILURE
 	  fi
 
 	  if test -n "$inst_prefix_dir"; then
 	    # Stick the inst_prefix_dir data into the link command.
-	    relink_command=`$echo "$relink_command" | $SP2NL | $SED "s%@inst_prefix_dir@%-inst-prefix-dir $inst_prefix_dir%" | $NL2SP`
+	    relink_command=`$echo "$relink_command" | $SED "s%@inst_prefix_dir@%-inst-prefix-dir $inst_prefix_dir%"`
 	  else
-	    relink_command=`$echo "$relink_command" | $SP2NL | $SED "s%@inst_prefix_dir@%%" | $NL2SP`
+	    relink_command=`$echo "$relink_command" | $SED "s%@inst_prefix_dir@%%"`
 	  fi
 
 	  $echo "$modename: warning: relinking \`$file'" 1>&2
 	  $show "$relink_command"
 	  if $run eval "$relink_command"; then :
 	  else
@@ -6205,13 +6142,13 @@
 	  if test "$fast_install" = no && test -n "$relink_command"; then
 	    if test "$finalize" = yes && test -z "$run"; then
 	      tmpdir=`func_mktempdir`
 	      file=`$echo "X$file$stripped_ext" | $Xsed -e 's%^.*/%%'`
 	      outputname="$tmpdir/$file"
 	      # Replace the output file specification.
-	      relink_command=`$echo "X$relink_command" | $SP2NL | $Xsed -e 's%@OUTPUT@%'"$outputname"'%g' | $NL2SP`
+	      relink_command=`$echo "X$relink_command" | $Xsed -e 's%@OUTPUT@%'"$outputname"'%g'`
 
 	      $show "$relink_command"
 	      if $run eval "$relink_command"; then :
 	      else
 		$echo "$modename: error: relink \`$file' with the above command before installing it" 1>&2
 		${rm}r "$tmpdir"
@@ -6416,16 +6353,14 @@
 	dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`
 	test "X$dir" = "X$file" && dir=.
 
 	if test -f "$dir/$objdir/$dlname"; then
 	  dir="$dir/$objdir"
 	else
-	  if test ! -f "$dir/$dlname"; then
-	    $echo "$modename: cannot find \`$dlname' in \`$dir' or \`$dir/$objdir'" 1>&2
-	    exit $EXIT_FAILURE
-	  fi
+	  $echo "$modename: cannot find \`$dlname' in \`$dir' or \`$dir/$objdir'" 1>&2
+	  exit $EXIT_FAILURE
 	fi
 	;;
 
       *.lo)
 	# Just add the directory containing the .lo file.
 	dir=`$echo "X$file" | $Xsed -e 's%/[^/]*$%%'`
@@ -6483,18 +6418,18 @@
       if test -n "$shlibpath_var"; then
 	# Export the shlibpath_var.
 	eval "export $shlibpath_var"
       fi
 
       # Restore saved environment variables
-      for lt_var in LANG LC_ALL LC_CTYPE LC_COLLATE LC_MESSAGES
-      do
-	eval "if test \"\${save_$lt_var+set}\" = set; then
-		$lt_var=\$save_$lt_var; export $lt_var
-	      fi"
-      done
+      if test "${save_LC_ALL+set}" = set; then
+	LC_ALL="$save_LC_ALL"; export LC_ALL
+      fi
+      if test "${save_LANG+set}" = set; then
+	LANG="$save_LANG"; export LANG
+      fi
 
       # Now prepare to actually exec the command.
       exec_cmd="\$cmd$args"
     else
       # Display what would be done.
       if test -n "$shlibpath_var"; then
@@ -6861,15 +6796,13 @@
   -objectlist FILE  Use a list of object files found in FILE to specify objects
   -precious-files-regex REGEX
                     don't remove output files matching REGEX
   -release RELEASE  specify package release information
   -rpath LIBDIR     the created library will eventually be installed in LIBDIR
   -R[ ]LIBDIR       add LIBDIR to the runtime path of programs and libraries
-  -static           do not do any dynamic linking of uninstalled libtool libraries
-  -static-libtool-libs
-                    do not do any dynamic linking of libtool libraries
+  -static           do not do any dynamic linking of libtool libraries
   -version-info CURRENT[:REVISION[:AGE]]
                     specify library version info [each variable defaults to 0]
 
 All other options (arguments beginning with \`-') are ignored.
 
 Every other argument is treated as a filename.  Files ending in \`.la' are
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/Makefile.am	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/Makefile.am	2007-05-30 18:33:14.000000000 +0800
@@ -1,11 +1,11 @@
 SUBDIRS = libltdl src
 
 INCLUDES = $(LTDLINCL)
 
-EXTRA_DIST = collectd.spec contrib
+EXTRA_DIST = contrib
 
 dist-hook:
 	find $(distdir) -type d -name '.svn' | xargs rm -rf
 
 install-exec-hook:
 	$(mkinstalldirs) $(DESTDIR)$(localstatedir)/run
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/Makefile.in	2007-09-28 19:01:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/Makefile.in	2007-06-04 01:13:28.000000000 +0800
@@ -95,52 +95,72 @@
 BUILD_MODULE_BATTERY_FALSE = @BUILD_MODULE_BATTERY_FALSE@
 BUILD_MODULE_BATTERY_TRUE = @BUILD_MODULE_BATTERY_TRUE@
 BUILD_MODULE_CPUFREQ_FALSE = @BUILD_MODULE_CPUFREQ_FALSE@
 BUILD_MODULE_CPUFREQ_TRUE = @BUILD_MODULE_CPUFREQ_TRUE@
 BUILD_MODULE_CPU_FALSE = @BUILD_MODULE_CPU_FALSE@
 BUILD_MODULE_CPU_TRUE = @BUILD_MODULE_CPU_TRUE@
+BUILD_MODULE_CSV_FALSE = @BUILD_MODULE_CSV_FALSE@
+BUILD_MODULE_CSV_TRUE = @BUILD_MODULE_CSV_TRUE@
 BUILD_MODULE_DF_FALSE = @BUILD_MODULE_DF_FALSE@
 BUILD_MODULE_DF_TRUE = @BUILD_MODULE_DF_TRUE@
 BUILD_MODULE_DISK_FALSE = @BUILD_MODULE_DISK_FALSE@
 BUILD_MODULE_DISK_TRUE = @BUILD_MODULE_DISK_TRUE@
 BUILD_MODULE_DNS_FALSE = @BUILD_MODULE_DNS_FALSE@
 BUILD_MODULE_DNS_TRUE = @BUILD_MODULE_DNS_TRUE@
 BUILD_MODULE_EMAIL_FALSE = @BUILD_MODULE_EMAIL_FALSE@
 BUILD_MODULE_EMAIL_TRUE = @BUILD_MODULE_EMAIL_TRUE@
+BUILD_MODULE_ENTROPY_FALSE = @BUILD_MODULE_ENTROPY_FALSE@
+BUILD_MODULE_ENTROPY_TRUE = @BUILD_MODULE_ENTROPY_TRUE@
+BUILD_MODULE_EXEC_FALSE = @BUILD_MODULE_EXEC_FALSE@
+BUILD_MODULE_EXEC_TRUE = @BUILD_MODULE_EXEC_TRUE@
 BUILD_MODULE_HDDTEMP_FALSE = @BUILD_MODULE_HDDTEMP_FALSE@
 BUILD_MODULE_HDDTEMP_TRUE = @BUILD_MODULE_HDDTEMP_TRUE@
+BUILD_MODULE_INTERFACE_FALSE = @BUILD_MODULE_INTERFACE_FALSE@
+BUILD_MODULE_INTERFACE_TRUE = @BUILD_MODULE_INTERFACE_TRUE@
+BUILD_MODULE_IPTABLES_FALSE = @BUILD_MODULE_IPTABLES_FALSE@
+BUILD_MODULE_IPTABLES_TRUE = @BUILD_MODULE_IPTABLES_TRUE@
+BUILD_MODULE_IRQ_FALSE = @BUILD_MODULE_IRQ_FALSE@
+BUILD_MODULE_IRQ_TRUE = @BUILD_MODULE_IRQ_TRUE@
 BUILD_MODULE_LOAD_FALSE = @BUILD_MODULE_LOAD_FALSE@
 BUILD_MODULE_LOAD_TRUE = @BUILD_MODULE_LOAD_TRUE@
+BUILD_MODULE_LOGFILE_FALSE = @BUILD_MODULE_LOGFILE_FALSE@
+BUILD_MODULE_LOGFILE_TRUE = @BUILD_MODULE_LOGFILE_TRUE@
 BUILD_MODULE_MBMON_FALSE = @BUILD_MODULE_MBMON_FALSE@
 BUILD_MODULE_MBMON_TRUE = @BUILD_MODULE_MBMON_TRUE@
 BUILD_MODULE_MEMORY_FALSE = @BUILD_MODULE_MEMORY_FALSE@
 BUILD_MODULE_MEMORY_TRUE = @BUILD_MODULE_MEMORY_TRUE@
 BUILD_MODULE_MULTIMETER_FALSE = @BUILD_MODULE_MULTIMETER_FALSE@
 BUILD_MODULE_MULTIMETER_TRUE = @BUILD_MODULE_MULTIMETER_TRUE@
 BUILD_MODULE_MYSQL_FALSE = @BUILD_MODULE_MYSQL_FALSE@
 BUILD_MODULE_MYSQL_TRUE = @BUILD_MODULE_MYSQL_TRUE@
+BUILD_MODULE_NETWORK_FALSE = @BUILD_MODULE_NETWORK_FALSE@
+BUILD_MODULE_NETWORK_TRUE = @BUILD_MODULE_NETWORK_TRUE@
 BUILD_MODULE_NFS_FALSE = @BUILD_MODULE_NFS_FALSE@
 BUILD_MODULE_NFS_TRUE = @BUILD_MODULE_NFS_TRUE@
 BUILD_MODULE_NTPD_FALSE = @BUILD_MODULE_NTPD_FALSE@
 BUILD_MODULE_NTPD_TRUE = @BUILD_MODULE_NTPD_TRUE@
+BUILD_MODULE_NUT_FALSE = @BUILD_MODULE_NUT_FALSE@
+BUILD_MODULE_NUT_TRUE = @BUILD_MODULE_NUT_TRUE@
+BUILD_MODULE_PERL_FALSE = @BUILD_MODULE_PERL_FALSE@
+BUILD_MODULE_PERL_TRUE = @BUILD_MODULE_PERL_TRUE@
 BUILD_MODULE_PING_FALSE = @BUILD_MODULE_PING_FALSE@
 BUILD_MODULE_PING_TRUE = @BUILD_MODULE_PING_TRUE@
 BUILD_MODULE_PROCESSES_FALSE = @BUILD_MODULE_PROCESSES_FALSE@
 BUILD_MODULE_PROCESSES_TRUE = @BUILD_MODULE_PROCESSES_TRUE@
-BUILD_MODULE_QUOTA_FALSE = @BUILD_MODULE_QUOTA_FALSE@
-BUILD_MODULE_QUOTA_TRUE = @BUILD_MODULE_QUOTA_TRUE@
 BUILD_MODULE_SENSORS_FALSE = @BUILD_MODULE_SENSORS_FALSE@
 BUILD_MODULE_SENSORS_TRUE = @BUILD_MODULE_SENSORS_TRUE@
 BUILD_MODULE_SERIAL_FALSE = @BUILD_MODULE_SERIAL_FALSE@
 BUILD_MODULE_SERIAL_TRUE = @BUILD_MODULE_SERIAL_TRUE@
 BUILD_MODULE_SWAP_FALSE = @BUILD_MODULE_SWAP_FALSE@
 BUILD_MODULE_SWAP_TRUE = @BUILD_MODULE_SWAP_TRUE@
+BUILD_MODULE_SYSLOG_FALSE = @BUILD_MODULE_SYSLOG_FALSE@
+BUILD_MODULE_SYSLOG_TRUE = @BUILD_MODULE_SYSLOG_TRUE@
 BUILD_MODULE_TAPE_FALSE = @BUILD_MODULE_TAPE_FALSE@
 BUILD_MODULE_TAPE_TRUE = @BUILD_MODULE_TAPE_TRUE@
-BUILD_MODULE_TRAFFIC_FALSE = @BUILD_MODULE_TRAFFIC_FALSE@
-BUILD_MODULE_TRAFFIC_TRUE = @BUILD_MODULE_TRAFFIC_TRUE@
+BUILD_MODULE_UNIXSOCK_FALSE = @BUILD_MODULE_UNIXSOCK_FALSE@
+BUILD_MODULE_UNIXSOCK_TRUE = @BUILD_MODULE_UNIXSOCK_TRUE@
 BUILD_MODULE_USERS_FALSE = @BUILD_MODULE_USERS_FALSE@
 BUILD_MODULE_USERS_TRUE = @BUILD_MODULE_USERS_TRUE@
 BUILD_MODULE_VSERVER_FALSE = @BUILD_MODULE_VSERVER_FALSE@
 BUILD_MODULE_VSERVER_TRUE = @BUILD_MODULE_VSERVER_TRUE@
 BUILD_MODULE_WIRELESS_FALSE = @BUILD_MODULE_WIRELESS_FALSE@
 BUILD_MODULE_WIRELESS_TRUE = @BUILD_MODULE_WIRELESS_TRUE@
@@ -150,34 +170,42 @@
 BUILD_WITH_LIBDEVINFO_FALSE = @BUILD_WITH_LIBDEVINFO_FALSE@
 BUILD_WITH_LIBDEVINFO_TRUE = @BUILD_WITH_LIBDEVINFO_TRUE@
 BUILD_WITH_LIBDEVSTAT_FALSE = @BUILD_WITH_LIBDEVSTAT_FALSE@
 BUILD_WITH_LIBDEVSTAT_TRUE = @BUILD_WITH_LIBDEVSTAT_TRUE@
 BUILD_WITH_LIBIOKIT_FALSE = @BUILD_WITH_LIBIOKIT_FALSE@
 BUILD_WITH_LIBIOKIT_TRUE = @BUILD_WITH_LIBIOKIT_TRUE@
+BUILD_WITH_LIBIPTC_FALSE = @BUILD_WITH_LIBIPTC_FALSE@
+BUILD_WITH_LIBIPTC_TRUE = @BUILD_WITH_LIBIPTC_TRUE@
 BUILD_WITH_LIBKSTAT_FALSE = @BUILD_WITH_LIBKSTAT_FALSE@
 BUILD_WITH_LIBKSTAT_TRUE = @BUILD_WITH_LIBKSTAT_TRUE@
 BUILD_WITH_LIBKVM_FALSE = @BUILD_WITH_LIBKVM_FALSE@
 BUILD_WITH_LIBKVM_TRUE = @BUILD_WITH_LIBKVM_TRUE@
 BUILD_WITH_LIBMYSQL_FALSE = @BUILD_WITH_LIBMYSQL_FALSE@
 BUILD_WITH_LIBMYSQL_TRUE = @BUILD_WITH_LIBMYSQL_TRUE@
 BUILD_WITH_LIBOPING_FALSE = @BUILD_WITH_LIBOPING_FALSE@
 BUILD_WITH_LIBOPING_TRUE = @BUILD_WITH_LIBOPING_TRUE@
 BUILD_WITH_LIBPCAP_FALSE = @BUILD_WITH_LIBPCAP_FALSE@
 BUILD_WITH_LIBPCAP_TRUE = @BUILD_WITH_LIBPCAP_TRUE@
+BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
+BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
 BUILD_WITH_LIBSTATGRAB_FALSE = @BUILD_WITH_LIBSTATGRAB_FALSE@
 BUILD_WITH_LIBSTATGRAB_TRUE = @BUILD_WITH_LIBSTATGRAB_TRUE@
+BUILD_WITH_LIBUPSCLIENT_FALSE = @BUILD_WITH_LIBUPSCLIENT_FALSE@
+BUILD_WITH_LIBUPSCLIENT_TRUE = @BUILD_WITH_LIBUPSCLIENT_TRUE@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
+BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
+BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
 BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
 BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
@@ -204,12 +232,15 @@
 GREP = @GREP@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
 LDFLAGS = @LDFLAGS@
+LEX = @LEX@
+LEXLIB = @LEXLIB@
+LEX_OUTPUT_ROOT = @LEX_OUTPUT_ROOT@
 LIBLTDL = @LIBLTDL@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
 LIBTOOL = @LIBTOOL@
 LN_S = @LN_S@
 LTDLINCL = @LTDLINCL@
@@ -220,18 +251,21 @@
 PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
 PACKAGE_NAME = @PACKAGE_NAME@
 PACKAGE_STRING = @PACKAGE_STRING@
 PACKAGE_TARNAME = @PACKAGE_TARNAME@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
+PERL_CFLAGS = @PERL_CFLAGS@
+PERL_LDFLAGS = @PERL_LDFLAGS@
 RANLIB = @RANLIB@
-SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
+YACC = @YACC@
+YFLAGS = @YFLAGS@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -276,13 +310,13 @@
 sharedstatedir = @sharedstatedir@
 subdirs = @subdirs@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
 SUBDIRS = libltdl src
 INCLUDES = $(LTDLINCL)
-EXTRA_DIST = collectd.spec contrib
+EXTRA_DIST = contrib
 all: all-recursive
 
 .SUFFIXES:
 am--refresh:
 	@:
 $(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/README	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/README	2007-06-04 01:06:08.000000000 +0800
@@ -11,168 +11,274 @@
 
 Features
 --------
 
   * collectd is able to collect the following data:
 
-    - Apache server utilization
-      (Number of bytes transfered, number of requests handled and detailed
-      scoreboard statistics)
+    - apache
+      Apache server utilization: Number of bytes transfered, number of
+      requests handled and detailed scoreboard statistics
 
-    - APC UPS Daemon
-      (UPS charge, load, input/output/battery voltage, etc)
+    - apcups
+      APC UPS Daemon: UPS charge, load, input/output/battery voltage, etc.
 
-    - Apple Sensors
-      (Temperature, fanspeed and voltage sensors of apple computers)
+    - apple_sensors
+      Sensors in Macs running Mac OS X / Darwin: Temperature, fanspeed and
+      voltage sensors.
 
-    - Battery
-      (Charge, current and charge of ACPI and PMU based batteries)
+    - battery
+      Batterycharge, -current and volatage of ACPI and PMU based laptop
+      batteries.
 
-    - CPU utilization
-      (Time spent in system, user, nice and idle)
+    - cpu
+      CPU utilization: Time spent in the system, user, nice, idle, and related
+      states.
 
-    - CPU frequency
-      (For laptops with speed step or a similar technology)
+    - cpufreq
+      CPU frequency (For laptops with speed step or a similar technology)
 
-    - Mountpoint usage
-      (Basically the values `df(1)' delivers)
+    - df
+      Mountpoint usage (Basically the values `df(1)' delivers)
 
-    - Disk utilization
-      (Sectors read/written, number of read/write actions, time spent doing IO)
+    - disk
+      Disk utilization: Sectors read/written, number of read/write actions,
+      average time an IO-operation took to complete.
 
-    - DNS traffic
-      (query types, response codes, opcodes and traffic)
+    - dns
+      DNS traffic: Query types, response codes, opcodes and traffic/octets
+      transfered.
 
-    - Email statistics
-      (count, traffic, spam scores and checks)
+    - email
+      Email statistics: Count, traffic, spam scores and checks.
+      See collectd-email(5).
 
-    - Harddisk temperatures
-      (Uhm, yeah, temperature of harddisks that is ;)
+    - entropy
+      Amount of entropy available to the system.
 
-    - System load
-      (Load average over the last 1, 5 and 15 minutes)
+    - exec
+      Values gathered by a custom program or script.
+      See collectd-exec(5).
 
-    - mbmon - motherboard monitoring
-      (temperature, fanspeed and voltage information)
+    - hddtemp
+      Harddisk temperatures using hddtempd.
 
-    - Memory utilization
-      (Memory occupied by running processes, page cache, buffer cache and free)
+    - interface
+      Interface traffic: Number of octets, packets and errors for each
+      interface.
 
-    - Multimeter
-      (Information provided by serial multimeters, such as the Metex M-4650CR)
+    - iptables
+      Iptables' counters: Number of bytes that were matched by a certain
+      iptables rule.
 
-    - MySQL server statistics
-      (Commands issued, handlers triggered, thread usage, query cache
-      utilization and traffic sent/received)
+    - irq
+      IRQ counters: Frequency in which certain interrupts occur.
 
-    - NFS Procedures
-      (Which NFS command were called how often. Only NFSv2 and NFSv3 right now)
+    - load
+      System load average over the last 1, 5 and 15 minutes.
 
-    - NTP Daemon
-      (Local clock drift, offset to peers, etc)
+    - mbmon
+      Motherboard sensors: temperature, fanspeed and voltage information,
+      using mbmon(1).
 
-    - Ping latency
-      (Time to reach the default gateway or another given host)
+    - memory
+      Memory utilization: Memory occupied by running processes, page cache,
+      buffer cache and free.
 
-    - Process counts
-      (Number of running, sleeping, zombie, ... processes)
+    - multimeter
+      Information provided by serial multimeters, such as the `Metex
+      M-4650CR'.
 
-    - Sensors
-      (lm_sensors voltages, temperatures and fan rotation speeds)
+    - mysql
+      MySQL server statistics: Commands issued, handlers triggered, thread
+      usage, query cache utilization and traffic/octets sent and received.
 
-    - Serial
-      (RX and TX of serial interfaces)
+    - network
+      Receive values that were collected by other hosts. Large setups will
+      want to collect the data on one dedicated machine, and this is the
+      plugin of choice for that.
 
-    - Swap
-      (Pages swapped out onto harddisk or whatever is called `swap' by the OS..)
+    - nfs
+      NFS Procedures: Which NFS command were called how often. Only NFSv2 and
+      NFSv3 right now.
 
-    - Tape
-      (Read and write bytes and operations on tape devices)
+    - ntp
+      NTP daemon statistics: Local clock drift, offset to peers, etc.
 
-    - Traffic
-      (In/Outbound traffic on the interfaces)
+    - nut
+      Network UPS tools: UPS current, voltage, power, charge, utilisation,
+      temperature, etc. See upsd(8).
 
-    - Users
-      (Currently logged in users)
+    - perl
+      The perl plugin implements a Perl-interpreter into collectd. You can
+      write your own plugins in Perl and return arbitary values using this
+      API. See collectd-perl(5).
 
-    - VServer
-      (System ressources used by vservers)
+      This plugin is still considered to be experimental and subject to change
+      between minor releases.
 
-    - Wireless
-      (Link quality of wireless cards)
+    - ping
+      Network latency: Time to reach the default gateway or another given
+      host.
 
-  * Performance: Running as a daemon collectd doesn't spend much time in
-    startup. Since collectd links against libping, librrd and libsensors it
-    doesn't need to start any other processes.
+    - processes
+      Process counts: Number of running, sleeping, zombie, ... processes.
 
-  * Hardly any maintenance neccessary and setup is trivial.
+    - sensors
+      System sensors, accessed using lm_sensors: Voltages, temperatures and
+      fan rotation speeds.
 
-  * Extremely easy and failsafe network operation possible.
+    - serial
+      RX and TX of serial interfaces. Linux only; needs root privileges.
+
+    - swap
+      Pages swapped out onto harddisk or whatever is called `swap' by the OS..
+
+    - tape
+      Bytes and operations read and written on tape devices. Solaris only.
+
+    - users
+      Users currently logged in.
+
+    - vserver
+      System ressources used by Linux VServers.
+      See <http://linux-vserver.org/>.
+
+    - wireless
+      Link quality of wireless cards. Linux only.
+
+  * Output can be written or send to various destinations by the following
+    plugins:
+
+    - csv
+      Write to comma seperated values (CSV) files. This needs lots of
+      diskspace but is extremely portable and can be analysed with almost
+      every program that can analyse anything. Even Microsoft's Excel..
+
+    - network
+      Send the data to a remote host to save the data somehow. This is useful
+      for large setups where the data should be saved by a dedicated machine.
+
+    - perl
+      Of course the values are propagated to plugins written in Perl, too, so
+      you can easily do weird stuff with the plugins we didn't dare think of
+      ;) See collectd-perl(5).
+
+    - rrdtool
+      Output to round-robin-database (RRD) files using librrd. See rrdtool(1).
+      This is likely the most popular destination for such values. Since
+      updates to RRD-files are somewhat expensive this plugin can cache
+      updates to the files and write a bunch of updates at once, which lessens
+      system load a lot.
+
+    - unixsock
+      One can query the values from the unixsock plugin whenever they're
+      needed. Please read collectd-unixsock(5) for a description on how that's
+      done.
+
+  * Logging is, as everything in collectd, provided by plugins. The following
+    plugins keep up informed about what's going on:
+
+    - logfile
+      Writes logmessages to a file or STDOUT/STDERR.
+
+    - syslog
+      Logs to the standard UNIX logging mechanismn, syslog.
+
+  * Performance: Since collectd is running as a daemon it doesn't spend much
+    time starting up again and again. With the exception of the exec plugin no
+    processes are forked. Caching in output plugins, such as the rrdtool and
+    network plugins, makes sure your resources are used efficiently. Also,
+    since collectd is programmed multithreaded it benefits from hyperthreading
+    and multicore processors and makes sure that the daemon isn't idle if only
+    one plugins waits for an IO-operation to complete.
+    
+  * Once set up, hardly any maintenence is neccessary. Setup is kept as easy
+    as possible and the default values should be okay for most users.
 
 
 Operation
 ---------
 
   * collectd's configuration file can be found at `sysconfdir'/collectd.conf.
     Run `collectd -h' for a list of builtin defaults. See `collectd.conf(5)'
     for a list of options and a syntax description.
 
-  * When running collectd writes system statistics in RRD-files. Per default
-    they reside in `/var/lib/collectd'.
+  * When the `csv' or `rrdtool' plugins are loaded they'll write the values to
+    files. The usual place for these files is beneath `/var/lib/collectd'.
 
-  * When using the `ping' plugin collectd needs to run as user root, since only
-    root can craft ICMP packages needed to ping other hosts. collectd should
-    NOT be installed setuid root since it can be used to overwrite valuable
-    files..
+  * When using some of the plugins, collectd needs to run as user root, since only
+    root can do certain things, such as craft ICMP packages needed to ping
+    other hosts. collectd should NOT be installed setuid root since it can be
+    used to overwrite valuable files!
 
   * Sample scripts to generate graphs reside in `contrib/' in the source
     package or somewhere near `/usr/share/doc/collectd' in most distributions.
     Please be aware that those script are meant as a starting point for your
     own experiments.. Some of them require the `RRDs' Perl module.
-    (`librrds-perl' on Debian)
+    (`librrds-perl' on Debian) If you have written a more sophisticated
+    solution please share it with us.
 
   * The RRAs of the automatically created RRD files depend on the `step'
-    and `heartbeat' settings given on compile time. For a list of the
-    default RRAs take a look in the collectd(1) manpage.
+    and `heartbeat' settings given. If change these settings you may need to
+    re-create the files, losing all data. Please be aware of that when changing
+    the values and read the rrdtool(1) manpage thoroughly.
 
 
 Prerequisites
 -------------
 
   To compile collectd from source you will need:
 
   * Usual suspects: C compiler, linker, preprocessor, make, ...
 
-  * rrdtool (optional; headers and library; rrdtool 1.0 and 1.2 both work fine)
+  * A POSIX-threads (pthread) implementation.
+    Since gathering some statistics is slow (network connections, slow devices,
+    etc) the collectd is parellelized. The POSIX threads interface is being
+    used and should be found in various implementations for hopefully all
+    platforms.
+
+  * libcurl (optional)
+    If you want to use the `apache' plugin
+
+  * libiptc (optional)
+    For querying iptables counters.
+
+  * libmysqlclient (optional)
+
+  * liboping (optional, if not found a version shipped with this distribution
+    can be used)
+    Used by the `ping' plugin to send and receive ICMP packets.
+
+  * libpcap (optional)
+    Used to capture packets by the `dns' plugin.
+
+  * librrd (optional; headers and library; rrdtool 1.0 and 1.2 both work fine)
     If built without `librrd' the resulting binary will be `client only', i.e.
     will send it's values via multicast and not create any RRD files itself.
     Alternatively you can chose to write CSV-files (Comma Seperated Values)
     instead.
 
-  * libmysqlclient (optional)
-
-  * lm-sensors (optional)
+  * libsensors (optional)
+    To read from `lm_sensors'.
 
   * libstatgrab may be used to collect statistics on systems other than Linux
     and/or Solaris. Note that CPU- and disk-statistics, while being provided
     by this library, are not supported in collectd right now..
     <http://www.i-scream.org/libstatgrab/> 
 
-  * libcurl (optional)
-    If you want to use the `apache' plugin
+  * libupsclient/nut (optional)
+    For the `nut' plugin which queries nut's `upsd'.
 
   * librt, libsocket, libkstat, libdevinfo
     Various standard Solaris libraries which provide system functions.
 
-  * libpthread (optional)
-    For parallelization, especially for plugins that communicate with the
-    outside, e. g. with a socket.
-
   * CoreFoundation.framework and IOKit.framework
-    For copiling on darwin in general and the `apple_sensors' plugin in
+    For compiling on Darwin in general and the `apple_sensors' plugin in
     particular.
 
 Author
 ------
 
-  Florian octo Forster <octo at verplant.org>
+  Florian octo Forster <octo at verplant.org>,
+  Sebastian tokkee Harl <sh at tokkee.org>,
+  and many contributors (see `AUTHORS').
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apache.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apache.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apache.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apache.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,94 +1,65 @@
 /**
  * collectd - src/apache.c
  * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2007  Florent EppO Monbillard
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
  * You should have received a copy of the GNU General Public License along
  * with this program; if not, write to the Free Software Foundation, Inc.,
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
+ *   Florent EppO Monbillard <eppo at darox.net>
+ *   - connections/lighttpd extension
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
 
-#define MODULE_NAME "apache"
-
 #if HAVE_LIBCURL && HAVE_CURL_CURL_H
 #  define APACHE_HAVE_READ 1
 #  include <curl/curl.h>
 #else
 #  define APACHE_HAVE_READ 0
 #endif
 
+#if APACHE_HAVE_READ
 static char *url    = NULL;
 static char *user   = NULL;
 static char *pass   = NULL;
 static char *cacert = NULL;
 
-#if HAVE_LIBCURL
 static CURL *curl = NULL;
 
 #define ABUFFER_SIZE 16384
 static char apache_buffer[ABUFFER_SIZE];
 static int  apache_buffer_len = 0;
 static char apache_curl_error[CURL_ERROR_SIZE];
-#endif /* HAVE_LIBCURL */
-
-/* Limit to 2^27 bytes/s. That's what a gigabit-ethernet link can handle, in
- * theory. */
-static char *bytes_file = "apache/apache_bytes.rrd";
-static char *bytes_ds_def[] =
-{
-	"DS:count:COUNTER:"COLLECTD_HEARTBEAT":0:134217728",
-	NULL
-};
-static int bytes_ds_num = 1;
 
-/* Limit to 2^20 requests/s */
-static char *requests_file = "apache/apache_requests.rrd";
-static char *requests_ds_def[] =
-{
-	"DS:count:COUNTER:"COLLECTD_HEARTBEAT":0:1048576",
-	NULL
-};
-static int requests_ds_num = 1;
-
-static char *scoreboard_file = "apache/apache_scoreboard-%s.rrd";
-static char *scoreboard_ds_def[] =
-{
-	"DS:count:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int scoreboard_ds_num = 1;
-
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"URL",
 	"User",
 	"Password",
 	"CACert",
 	NULL
 };
 static int config_keys_num = 4;
 
-#if HAVE_LIBCURL
 static size_t apache_curl_callback (void *buf, size_t size, size_t nmemb, void *stream)
 {
 	size_t len = size * nmemb;
 
 	if ((apache_buffer_len + len) >= ABUFFER_SIZE)
 	{
@@ -101,15 +72,14 @@
 	memcpy (apache_buffer + apache_buffer_len, (char *) buf, len);
 	apache_buffer_len += len;
 	apache_buffer[apache_buffer_len] = '\0';
 
 	return (len);
 }
-#endif /* HAVE_LIBCURL */
 
-static int config_set (char **var, char *value)
+static int config_set (char **var, const char *value)
 {
 	if (*var != NULL)
 	{
 		free (*var);
 		*var = NULL;
 	}
@@ -117,13 +87,13 @@
 	if ((*var = strdup (value)) == NULL)
 		return (1);
 	else
 		return (0);
 }
 
-static int config (char *key, char *value)
+static int config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "url") == 0)
 		return (config_set (&url, value));
 	else if (strcasecmp (key, "user") == 0)
 		return (config_set (&user, value));
 	else if (strcasecmp (key, "password") == 0)
@@ -131,38 +101,37 @@
 	else if (strcasecmp (key, "cacert") == 0)
 		return (config_set (&cacert, value));
 	else
 		return (-1);
 }
 
-static void init (void)
+static int init (void)
 {
-#if HAVE_LIBCURL
 	static char credentials[1024];
 
 	if (curl != NULL)
 	{
 		curl_easy_cleanup (curl);
 	}
 
 	if ((curl = curl_easy_init ()) == NULL)
 	{
-		syslog (LOG_ERR, "apache: `curl_easy_init' failed.");
-		return;
+		ERROR ("apache: `curl_easy_init' failed.");
+		return (-1);
 	}
 
 	curl_easy_setopt (curl, CURLOPT_WRITEFUNCTION, apache_curl_callback);
 	curl_easy_setopt (curl, CURLOPT_USERAGENT, PACKAGE_NAME"/"PACKAGE_VERSION);
 	curl_easy_setopt (curl, CURLOPT_ERRORBUFFER, apache_curl_error);
 
 	if (user != NULL)
 	{
 		if (snprintf (credentials, 1024, "%s:%s", user, pass == NULL ? "" : pass) >= 1024)
 		{
-			syslog (LOG_ERR, "apache: Credentials would have been truncated.");
-			return;
+			ERROR ("apache: Credentials would have been truncated.");
+			return (-1);
 		}
 
 		curl_easy_setopt (curl, CURLOPT_USERPWD, credentials);
 	}
 
 	if (url != NULL)
@@ -171,55 +140,62 @@
 	}
 
 	if (cacert != NULL)
 	{
 		curl_easy_setopt (curl, CURLOPT_CAINFO, cacert);
 	}
-#endif /* HAVE_LIBCURL */
-}
 
-static void bytes_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, bytes_file, val, bytes_ds_def, bytes_ds_num);
-}
+	return (0);
+} /* int init */
 
-static void requests_write (char *host, char *inst, char *val)
+static void submit_counter (const char *type, const char *type_instance,
+		unsigned long long value)
 {
-	rrd_update_file (host, requests_file, val, requests_ds_def, requests_ds_num);
-}
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void scoreboard_write (char *host, char *inst, char *val)
-{
-	char buf[1024];
+	DEBUG ("type = %s; type_instance = %s; value = %llu;",
+			type, type_instance, value);
 
-	if (snprintf (buf, 1024, scoreboard_file, inst) >= 1024)
-		return;
+	values[0].counter = value;
 
-	rrd_update_file (host, buf, val, scoreboard_ds_def, scoreboard_ds_num);
-}
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "apache");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-#if APACHE_HAVE_READ
-static void submit (char *type, char *inst, long long value)
+	plugin_dispatch_values (type, &vl);
+} /* void submit_counter */
+
+static void submit_gauge (const char *type, const char *type_instance,
+		double value)
 {
-	char buf[1024];
-	int  status;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	status = snprintf (buf, 1024, "%u:%lli", (unsigned int) curtime, value);
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "apache: bytes_submit: snprintf failed");
-		return;
-	}
-	else if (status >= 1024)
-	{
-		syslog (LOG_WARNING, "apache: bytes_submit: snprintf was truncated");
-		return;
-	}
+	DEBUG ("type = %s; type_instance = %s; value = %lf;",
+			type, type_instance, value);
 
-	plugin_submit (type, inst, buf);
-}
+	values[0].gauge = value;
+
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "apache");
+	strcpy (vl.plugin_instance, "");
+
+	if (type_instance != NULL)
+		strncpy (vl.type_instance, type_instance,
+				sizeof (vl.type_instance));
+
+	plugin_dispatch_values (type, &vl);
+} /* void submit_counter */
 
 static void submit_scoreboard (char *buf)
 {
 	/*
 	 * Scoreboard Key:
 	 * "_" Waiting for Connection, "S" Starting up, "R" Reading Request,
@@ -253,50 +229,53 @@
 		else if (buf[i] == 'C') closing++;
 		else if (buf[i] == 'L') logging++;
 		else if (buf[i] == 'G') finishing++;
 		else if (buf[i] == 'I') idle_cleanup++;
 	}
 
-	submit ("apache_scoreboard", "open"     , open);
-	submit ("apache_scoreboard", "waiting"  , waiting);
-	submit ("apache_scoreboard", "starting" , starting);
-	submit ("apache_scoreboard", "reading"  , reading);
-	submit ("apache_scoreboard", "sending"  , sending);
-	submit ("apache_scoreboard", "keepalive", keepalive);
-	submit ("apache_scoreboard", "dnslookup", dnslookup);
-	submit ("apache_scoreboard", "closing"  , closing);
-	submit ("apache_scoreboard", "logging"  , logging);
-	submit ("apache_scoreboard", "finishing", finishing);
-	submit ("apache_scoreboard", "idle_cleanup", idle_cleanup);
+	submit_gauge ("apache_scoreboard", "open"     , open);
+	submit_gauge ("apache_scoreboard", "waiting"  , waiting);
+	submit_gauge ("apache_scoreboard", "starting" , starting);
+	submit_gauge ("apache_scoreboard", "reading"  , reading);
+	submit_gauge ("apache_scoreboard", "sending"  , sending);
+	submit_gauge ("apache_scoreboard", "keepalive", keepalive);
+	submit_gauge ("apache_scoreboard", "dnslookup", dnslookup);
+	submit_gauge ("apache_scoreboard", "closing"  , closing);
+	submit_gauge ("apache_scoreboard", "logging"  , logging);
+	submit_gauge ("apache_scoreboard", "finishing", finishing);
+	submit_gauge ("apache_scoreboard", "idle_cleanup", idle_cleanup);
 }
 
-static void apache_read (void)
+static int apache_read (void)
 {
 	int i;
 
 	char *ptr;
+	char *saveptr;
 	char *lines[16];
 	int   lines_num = 0;
 
 	char *fields[4];
 	int   fields_num;
 
 	if (curl == NULL)
-		return;
+		return (-1);
 	if (url == NULL)
-		return;
+		return (-1);
 
 	apache_buffer_len = 0;
 	if (curl_easy_perform (curl) != 0)
 	{
-		syslog (LOG_WARNING, "apache: curl_easy_perform failed: %s", apache_curl_error);
-		return;
+		ERROR ("apache: curl_easy_perform failed: %s",
+				apache_curl_error);
+		return (-1);
 	}
 
 	ptr = apache_buffer;
-	while ((lines[lines_num] = strtok (ptr, "\n\r")) != NULL)
+	saveptr = NULL;
+	while ((lines[lines_num] = strtok_r (ptr, "\n\r", &saveptr)) != NULL)
 	{
 		ptr = NULL;
 		lines_num++;
 
 		if (lines_num >= 16)
 			break;
@@ -307,34 +286,37 @@
 		fields_num = strsplit (lines[i], fields, 4);
 
 		if (fields_num == 3)
 		{
 			if ((strcmp (fields[0], "Total") == 0)
 					&& (strcmp (fields[1], "Accesses:") == 0))
-				submit ("apache_requests", NULL, atoll (fields[2]));
+				submit_counter ("apache_requests", "",
+						atoll (fields[2]));
 			else if ((strcmp (fields[0], "Total") == 0)
 					&& (strcmp (fields[1], "kBytes:") == 0))
-				submit ("apache_bytes", NULL, 1024LL * atoll (fields[2]));
+				submit_counter ("apache_bytes", "",
+						1024LL * atoll (fields[2]));
 		}
 		else if (fields_num == 2)
 		{
 			if (strcmp (fields[0], "Scoreboard:") == 0)
 				submit_scoreboard (fields[1]);
+			else if (strcmp (fields[0], "BusyServers:") == 0)
+				submit_gauge ("apache_connections", NULL, atol (fields[1]));
 		}
 	}
 
 	apache_buffer_len = 0;
-}
-#else
-#  define apache_read NULL
+
+	return (0);
+} /* int apache_read */
 #endif /* APACHE_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, init, apache_read, NULL);
-	plugin_register ("apache_requests",   NULL, NULL, requests_write);
-	plugin_register ("apache_bytes",      NULL, NULL, bytes_write);
-	plugin_register ("apache_scoreboard", NULL, NULL, scoreboard_write);
-	cf_register (MODULE_NAME, config, config_keys, config_keys_num);
-}
-
-#undef MODULE_NAME
+#if APACHE_HAVE_READ
+	plugin_register_config ("apache", config,
+			config_keys, config_keys_num);
+	plugin_register_init ("apache", init);
+	plugin_register_read ("apache", apache_read);
+#endif
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apcups.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apcups.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apcups.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apcups.c	2007-05-30 18:33:14.000000000 +0800
@@ -30,13 +30,12 @@
 #include <stdlib.h>
 
 #include "collectd.h"
 #include "common.h"      /* rrd_update_file */
 #include "plugin.h"      /* plugin_register, plugin_submit */
 #include "configfile.h"  /* cf_register */
-#include "utils_debug.h"
 
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
 #if HAVE_SYS_SOCKET_H
 # include <sys/socket.h>
@@ -46,114 +45,68 @@
 #endif
 
 #if HAVE_NETINET_IN_H
 # include <netinet/in.h>
 #endif
 
-#ifndef APCMAIN
-# define APCMAIN 0
-#endif
-
 #define NISPORT 3551
 #define MAXSTRING               256
 #define MODULE_NAME "apcups"
 
 #define APCUPS_DEFAULT_HOST "localhost"
 
-/* Default values for contacting daemon */
-static char *global_host = NULL;
-static int   global_port = NISPORT;
-
-/* 
- * The following are only if not compiled to test the module with its own main.
-*/
-#if !APCMAIN
-static char *bvolt_file_template = "apcups/voltage-%s.rrd";
-static char *bvolt_ds_def[] = 
-{
-	"DS:voltage:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-};
-static int bvolt_ds_num = 1;
-
-static char *load_file_template = "apcups/load_percent.rrd";
-static char *load_ds_def[] = 
-{
-	"DS:percent:GAUGE:"COLLECTD_HEARTBEAT":0:110",
-};
-static int load_ds_num = 1;
-
-static char *charge_file_template = "apcups/charge_percent.rrd";
-static char *charge_ds_def[] = 
-{
-	"DS:percent:GAUGE:"COLLECTD_HEARTBEAT":0:110",
-};
-static int charge_ds_num = 1;
-
-static char *time_file_template = "apcups/timeleft.rrd";
-static char *time_ds_def[] = 
-{
-	"DS:timeleft:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-};
-static int time_ds_num = 1;
-
-static char *temp_file_template = "apcups/temperature.rrd";
-static char *temp_ds_def[] = 
-{
-	/* -273.15 is absolute zero */
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":-274:U",
-};
-static int temp_ds_num = 1;
-
-static char *freq_file_template = "apcups/frequency-%s.rrd";
-static char *freq_ds_def[] = 
-{
-	"DS:frequency:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-};
-static int freq_ds_num = 1;
-
-static char *config_keys[] =
-{
-	"Host",
-	"Port",
-	NULL
-};
-static int config_keys_num = 2;
-
-#endif /* if APCMAIN */
-
+/*
+ * Private data types
+ */
 struct apc_detail_s
 {
 	double linev;
 	double loadpct;
 	double bcharge;
 	double timeleft;
 	double outputv;
 	double itemp;
 	double battv;
 	double linefreq;
 };
 
-#define BIG_BUF 4096
+/*
+ * Private variables
+ */
+/* Default values for contacting daemon */
+static char *conf_host = NULL;
+static int   conf_port = NISPORT;
+
+static int global_sockfd = -1;
+
+static const char *config_keys[] =
+{
+	"Host",
+	"Port",
+	NULL
+};
+static int config_keys_num = 2;
 
-#if APCMAIN
 /* Close the network connection */
-static void net_close (int *fd)
+static int apcups_shutdown (void)
 {
 	uint16_t packet_size = 0;
 
-	assert (*fd >= 0);
+	if (global_sockfd < 0)
+		return (0);
 
-	DBG ("Gracefully shutting down socket %i.", *fd);
+	DEBUG ("Gracefully shutting down socket %i.", global_sockfd);
 
 	/* send EOF sentinel */
-	swrite (*fd, (void *) &packet_size, sizeof (packet_size));
+	swrite (global_sockfd, (void *) &packet_size, sizeof (packet_size));
 
-	close (*fd);
-	*fd = -1;
-}
-#endif /* APCMAIN */
+	close (global_sockfd);
+	global_sockfd = -1;
+
+	return (0);
+} /* int apcups_shutdown */
 
 /*     
  * Open a TCP connection to the UPS network server
  * Returns -1 on error
  * Returns socket file descriptor otherwise
  */
@@ -177,13 +130,17 @@
 	ai_hints.ai_family   = AF_INET; /* XXX: Change this to `AF_UNSPEC' if apcupsd can handle IPv6 */
 	ai_hints.ai_socktype = SOCK_STREAM;
 
 	status = getaddrinfo (host, port_str, &ai_hints, &ai_return);
 	if (status != 0)
 	{
-		DBG ("getaddrinfo failed: %s", status == EAI_SYSTEM ? strerror (errno) : gai_strerror (status));
+		char errbuf[1024];
+		DEBUG ("getaddrinfo failed: %s",
+				(status == EAI_SYSTEM)
+				? sstrerror (errno, errbuf, sizeof (errbuf))
+				: gai_strerror (status));
 		return (-1);
 	}
 
 	/* Create socket */
 	sd = -1;
 	for (ai_list = ai_return; ai_list != NULL; ai_list = ai_list->ai_next)
@@ -193,29 +150,31 @@
 			break;
 	}
 	/* `ai_list' still holds the current description of the socket.. */
 
 	if (sd < 0)
 	{
-		DBG ("Unable to open a socket");
+		DEBUG ("Unable to open a socket");
 		freeaddrinfo (ai_return);
 		return (-1);
 	}
 
 	status = connect (sd, ai_list->ai_addr, ai_list->ai_addrlen);
 
 	freeaddrinfo (ai_return);
 
 	if (status != 0) /* `connect(2)' failed */
 	{
-		DBG ("connect failed: %s", strerror (errno));
+		char errbuf[1024];
+		DEBUG ("connect failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		close (sd);
 		return (-1);
 	}
 
-	DBG ("Done opening a socket %i", sd);
+	DEBUG ("Done opening a socket %i", sd);
 
 	return (sd);
 } /* int net_open (char *host, char *service, int port) */
 
 /* 
  * Receive a message from the other end. Each message consists of
@@ -237,13 +196,13 @@
 		return (-1);
 	}
 
 	packet_size = ntohs (packet_size);
 	if (packet_size > buflen)
 	{
-		DBG ("record length too large");
+		DEBUG ("record length too large");
 		return (-2);
 	}
 
 	if (packet_size == 0)
 		return (0);
 
@@ -294,58 +253,59 @@
 static int apc_query_server (char *host, int port,
 		struct apc_detail_s *apcups_detail)
 {
 	int     n;
 	char    recvline[1024];
 	char   *tokptr;
+	char   *toksaveptr;
 	char   *key;
 	double  value;
 
-	static int sockfd   = -1;
 	static complain_t compl;
 
 #if APCMAIN
 # define PRINT_VALUE(name, val) printf("  Found property: name = %s; value = %f;\n", name, val)
 #else
 # define PRINT_VALUE(name, val) /**/
 #endif
 
-	if (sockfd < 0)
+	if (global_sockfd < 0)
 	{
-		if ((sockfd = net_open (host, NULL, port)) < 0)
+		if ((global_sockfd = net_open (host, NULL, port)) < 0)
 		{
 			plugin_complain (LOG_ERR, &compl, "apcups plugin: "
 					"Connecting to the apcupsd failed.");
 			return (-1);
 		}
 		else
 		{
 			plugin_relief (LOG_NOTICE, &compl, "apcups plugin: "
 					"Connection re-established to the apcupsd.");
 		}
 	}
 
-	if (net_send (&sockfd, "status", 6) < 0)
+	if (net_send (&global_sockfd, "status", 6) < 0)
 	{
-		syslog (LOG_ERR, "apcups plugin: Writing to the socket failed.");
+		ERROR ("apcups plugin: Writing to the socket failed.");
 		return (-1);
 	}
 
-	while ((n = net_recv (&sockfd, recvline, sizeof (recvline) - 1)) > 0)
+	while ((n = net_recv (&global_sockfd, recvline, sizeof (recvline) - 1)) > 0)
 	{
 		assert (n < sizeof (recvline));
 		recvline[n] = '\0';
 #if APCMAIN
 		printf ("net_recv = `%s';\n", recvline);
 #endif /* if APCMAIN */
 
-		tokptr = strtok (recvline, " :\t");
+		toksaveptr = NULL;
+		tokptr = strtok_r (recvline, " :\t", &toksaveptr);
 		while (tokptr != NULL)
 		{
 			key = tokptr;
-			if ((tokptr = strtok (NULL, " :\t")) == NULL)
+			if ((tokptr = strtok_r (NULL, " :\t", &toksaveptr)) == NULL)
 				continue;
 			value = atof (tokptr);
 
 			PRINT_VALUE (key, value);
 
 			if (strcmp ("LINEV", key) == 0)
@@ -362,164 +322,85 @@
 				apcups_detail->outputv = value;
 			else if (strcmp ("LINEFREQ", key) == 0)
 				apcups_detail->linefreq = value;
 			else if (strcmp ("TIMELEFT", key) == 0)
 				apcups_detail->timeleft = value;
 
-			tokptr = strtok (NULL, ":");
+			tokptr = strtok_r (NULL, ":", &toksaveptr);
 		} /* while (tokptr != NULL) */
 	}
 	
 	if (n < 0)
 	{
-		syslog (LOG_WARNING, "apcups plugin: Error reading from socket");
+		WARNING ("apcups plugin: Error reading from socket");
 		return (-1);
 	}
-#if APCMAIN
-	else
-	{
-		/* close the opened socket */
-		net_close (&sockfd);
-	}
-#endif /* APCMAIN */
 
 	return (0);
 }
 
-#if APCMAIN
-/*
- * This is used for testing apcups in a standalone mode.
- * Usefull for debugging.
- */
-int main (int argc, char **argv)
-{
-	/* we are not really going to use this */
-	struct apc_detail_s apcups_detail;
-
-	openlog ("apcups", LOG_PID | LOG_NDELAY | LOG_LOCAL1, LOG_USER);
-
-	if (global_host == NULL || strcmp (global_host, "0.0.0.0") == 0)
-		global_host = "localhost";
-
-	if(apc_query_server (global_host, global_port, &apcups_detail) < 0)
-	{
-		printf("apcups: Failed...\n");
-		return(-1);
-	}
-
-	return 0;
-}
-#else
-static int apcups_config (char *key, char *value)
+static int apcups_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "host") == 0)
 	{
-		if (global_host != NULL)
+		if (conf_host != NULL)
 		{
-			free (global_host);
-			global_host = NULL;
+			free (conf_host);
+			conf_host = NULL;
 		}
-		if ((global_host = strdup (value)) == NULL)
+		if ((conf_host = strdup (value)) == NULL)
 			return (1);
 	}
 	else if (strcasecmp (key, "Port") == 0)
 	{
 		int port_tmp = atoi (value);
 		if (port_tmp < 1 || port_tmp > 65535)
 		{
-			syslog (LOG_WARNING, "apcups plugin: Invalid port: %i", port_tmp);
+			WARNING ("apcups plugin: Invalid port: %i", port_tmp);
 			return (1);
 		}
-		global_port = port_tmp;
+		conf_port = port_tmp;
 	}
 	else
 	{
 		return (-1);
 	}
 	return (0);
 }
 
-static void apcups_init (void)
-{
-	return;
-}
-
-static void apc_write_voltage (char *host, char *inst, char *val)
-{
-	char file[512];
-	int  status;
-
-	status = snprintf (file, 512, bvolt_file_template, inst);
-	if ((status < 1) || (status >= 512))
-		return;
-
-	rrd_update_file (host, file, val, bvolt_ds_def, bvolt_ds_num);
-}
-
-static void apc_write_charge (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, charge_file_template, val, charge_ds_def, charge_ds_num);
-}
-
-static void apc_write_percent (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, load_file_template, val, load_ds_def, load_ds_num);
-}
-
-static void apc_write_timeleft (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, time_file_template, val, time_ds_def, time_ds_num);
-}
-
-static void apc_write_temperature (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, temp_file_template, val, temp_ds_def, temp_ds_num);
-}
-
-static void apc_write_frequency (char *host, char *inst, char *val)
+static void apc_submit_generic (char *type, char *type_inst, double value)
 {
-	char file[512];
-	int  status;
-
-	status = snprintf (file, 512, freq_file_template, inst);
-	if ((status < 1) || (status >= 512))
-		return;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	rrd_update_file (host, file, val, freq_ds_def, freq_ds_num);
-}
-
-static void apc_submit_generic (char *type, char *inst,
-		double value)
-{
-	char buf[512];
-	int  status;
+	values[0].gauge = value;
 
-	status = snprintf (buf, 512, "%u:%f",
-			(unsigned int) curtime, value);
-	if ((status < 1) || (status >= 512))
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "apcups");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, type_inst, sizeof (vl.type_instance));
 
-	DBG ("plugin_submit (%s, %s, %s);", type, inst, buf);
-	plugin_submit (type, inst, buf);
+	plugin_dispatch_values (type, &vl);
 }
 
 static void apc_submit (struct apc_detail_s *apcups_detail)
 {
 	apc_submit_generic ("apcups_voltage",    "input",   apcups_detail->linev);
 	apc_submit_generic ("apcups_voltage",    "output",  apcups_detail->outputv);
 	apc_submit_generic ("apcups_voltage",    "battery", apcups_detail->battv);
-	apc_submit_generic ("apcups_charge",     "-",       apcups_detail->bcharge);
-	/* `apcups_charge_pct' actually is the wrong name, but we keep it that
-	 * way for backwards compatibility. */
-	apc_submit_generic ("apcups_charge_pct", "-",       apcups_detail->loadpct);
-	apc_submit_generic ("apcups_timeleft",   "-",       apcups_detail->timeleft);
-	apc_submit_generic ("apcups_temp",       "-",       apcups_detail->itemp);
+	apc_submit_generic ("apcups_charge",     "",        apcups_detail->bcharge);
+	apc_submit_generic ("apcups_charge_pct", "",        apcups_detail->loadpct);
+	apc_submit_generic ("apcups_timeleft",   "",        apcups_detail->timeleft);
+	apc_submit_generic ("apcups_temp",       "",        apcups_detail->itemp);
 	apc_submit_generic ("apcups_frequency",  "input",   apcups_detail->linefreq);
 }
 
-static void apcups_read (void)
+static int apcups_read (void)
 {
 	struct apc_detail_s apcups_detail;
 	int status;
 
 	apcups_detail.linev    =   -1.0;
 	apcups_detail.outputv  =   -1.0;
@@ -527,44 +408,37 @@
 	apcups_detail.loadpct  =   -1.0;
 	apcups_detail.bcharge  =   -1.0;
 	apcups_detail.timeleft =   -1.0;
 	apcups_detail.itemp    = -300.0;
 	apcups_detail.linefreq =   -1.0;
   
-	status = apc_query_server (global_host == NULL
+	status = apc_query_server (conf_host == NULL
 			? APCUPS_DEFAULT_HOST
-			: global_host,
-			global_port, &apcups_detail);
+			: conf_host,
+			conf_port, &apcups_detail);
  
 	/*
 	 * if we did not connect then do not bother submitting
 	 * zeros. We want rrd files to have NAN.
 	 */
 	if (status != 0)
 	{
-		DBG ("apc_query_server (%s, %i) = %i",
-				global_host == NULL
+		DEBUG ("apc_query_server (%s, %i) = %i",
+				conf_host == NULL
 				? APCUPS_DEFAULT_HOST
-				: global_host,
-				global_port, status);
-		return;
+				: conf_host,
+				conf_port, status);
+		return (-1);
 	}
 
 	apc_submit (&apcups_detail);
+
+	return (0);
 } /* apcups_read */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, apcups_init, apcups_read, NULL);
-	plugin_register ("apcups_voltage",    NULL, NULL, apc_write_voltage);
-	plugin_register ("apcups_charge",     NULL, NULL, apc_write_charge);
-	/* `apcups_charge_pct' actually is the wrong name, but we keep it that
-	 * way for backwards compatibility. */
-	plugin_register ("apcups_charge_pct", NULL, NULL, apc_write_percent);
-	plugin_register ("apcups_timeleft",   NULL, NULL, apc_write_timeleft);
-	plugin_register ("apcups_temp",       NULL, NULL, apc_write_temperature);
-	plugin_register ("apcups_frequency",  NULL, NULL, apc_write_frequency);
-	cf_register (MODULE_NAME, apcups_config, config_keys, config_keys_num);
-}
-
-#endif /* if APCMAIN */
-#undef MODULE_NAME
+	plugin_register_config ("apcups", apcups_config, config_keys,
+			config_keys_num);
+	plugin_register_read ("apcups", apcups_read);
+	plugin_register_shutdown ("apcups", apcups_shutdown);
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apple_sensors.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apple_sensors.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/apple_sensors.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/apple_sensors.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/apple_sensors.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006,2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,15 +19,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "apple_sensors"
 
 #if HAVE_CTYPE_H
 #  include <ctype.h>
 #endif
 
 #if HAVE_MACH_MACH_TYPES_H
@@ -60,82 +56,59 @@
 #endif
 
 #if HAVE_IOKIT_IOKITLIB_H
 static mach_port_t io_master_port = MACH_PORT_NULL;
 #endif
 
-static char *temperature_file = "apple_sensors/temperature-%s.rrd";
-static char *fanspeed_file    = "apple_sensors/fanspeed-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num = 1;
-
-static void as_init (void)
-{
 #if IOKIT_HAVE_READ
+static int as_init (void)
+{
 	kern_return_t status;
 	
 	if (io_master_port != MACH_PORT_NULL)
 	{
 		mach_port_deallocate (mach_task_self (),
 				io_master_port);
 		io_master_port = MACH_PORT_NULL;
 	}
 
 	status = IOMasterPort (MACH_PORT_NULL, &io_master_port);
 	if (status != kIOReturnSuccess)
 	{
-		syslog (LOG_ERR, "IOMasterPort failed: %s",
+		ERROR ("IOMasterPort failed: %s",
 				mach_error_string (status));
 		io_master_port = MACH_PORT_NULL;
-		return;
+		return (-1);
 	}
-#endif /* IOKIT_HAVE_READ */
-
-	return;
-}
-
-static void as_write (char *host, char *inst, char *val, const char *template)
-{
-	char filename[256];
-	int  status;
-
-	status = snprintf (filename, 256, template, inst);
-	if ((status < 1) || (status >= 256))
-		return;
 
-	rrd_update_file (host, filename, val, ds_def, ds_num);
+	return (0);
 }
 
-static void temperature_write (char *host, char *inst, char *val)
+static void as_submit (const char *type, const char *type_instance,
+		double val)
 {
-	as_write (host, inst, val, temperature_file);
-}
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void fanspeed_write (char *host, char *inst, char *val)
-{
-	as_write (host, inst, val, fanspeed_file);
-}
+	DEBUG ("type = %s; type_instance = %s; val = %f;",
+			type, type_instance, val);
 
-#if IOKIT_HAVE_READ
-static void as_submit (char *type, char *inst, double value)
-{
-	char buf[128];
+	values[0].gauge = val;
 
-	if (snprintf (buf, 1024, "%u:%f", (unsigned int) curtime,
-				value) >= 128)
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "apple_sensors");
+	strcpy (vl.plugin_instance, "");
+	strcpy (vl.type_instance, type_instance);
 
-	plugin_submit (type, inst, buf);
+	plugin_dispatch_values (type, &vl);
 }
 
-static void as_read (void)
+static int as_read (void)
 {
 	kern_return_t   status;
 	io_iterator_t   iterator;
 	io_object_t     io_obj;
 	CFMutableDictionaryRef prop_dict;
 	CFTypeRef       property;
@@ -144,34 +117,34 @@
 	char   inst[128];
 	int    value_int;
 	double value_double;
 	int    i;
 
 	if (!io_master_port || (io_master_port == MACH_PORT_NULL))
-		return;
+		return (-1);
 
 	status = IOServiceGetMatchingServices (io_master_port,
 		       	IOServiceNameMatching("IOHWSensor"),
 		       	&iterator);
 	if (status != kIOReturnSuccess)
        	{
-		syslog (LOG_ERR, "IOServiceGetMatchingServices failed: %s",
+		ERROR ("IOServiceGetMatchingServices failed: %s",
 				mach_error_string (status));
-		return;
+		return (-1);
 	}
 
 	while ((io_obj = IOIteratorNext (iterator)))
 	{
 		prop_dict = NULL;
 		status = IORegistryEntryCreateCFProperties (io_obj,
 				&prop_dict,
 				kCFAllocatorDefault,
 				kNilOptions);
 		if (status != kIOReturnSuccess)
 		{
-			DBG ("IORegistryEntryCreateCFProperties failed: %s",
+			DEBUG ("IORegistryEntryCreateCFProperties failed: %s",
 					mach_error_string (status));
 			continue;
 		}
 
 		/* Copy the sensor type. */
 		property = NULL;
@@ -225,55 +198,54 @@
 			continue;
 
 		/* Found e.g. in the 1.5GHz PowerBooks */
 		if (strcmp (type, "temperature") == 0)
 		{
 			value_double = ((double) value_int) / 65536.0;
-			strncpy (type, "apple_temperature", 128);
+			strcpy (type, "temperature");
 		}
 		else if (strcmp (type, "temp") == 0)
 		{
 			value_double = ((double) value_int) / 10.0;
-			strncpy (type, "apple_temperature", 128);
+			strcpy (type, "temperature");
 		}
 		else if (strcmp (type, "fanspeed") == 0)
 		{
 			value_double = ((double) value_int) / 65536.0;
-			strncpy (type, "apple_fanspeed", 128);
+			strcpy (type, "fanspeed");
 		}
 		else if (strcmp (type, "voltage") == 0)
 		{
 			/* Leave this to the battery plugin. */
 			continue;
 		}
 		else if (strcmp (type, "adc") == 0)
 		{
 			value_double = ((double) value_int) / 10.0;
-			strncpy (type, "apple_temperature", 128);
+			strcpy (type, "fanspeed");
 		}
 		else
 		{
-			DBG ("apple_sensors: Read unknown sensor type: %s",
+			DEBUG ("apple_sensors: Read unknown sensor type: %s",
 					type);
 			value_double = (double) value_int;
 		}
 
 		as_submit (type, inst, value_double);
 
 		CFRelease (prop_dict);
 		IOObjectRelease (io_obj);
 	} /* while (iterator) */
 
 	IOObjectRelease (iterator);
-}
-#else
-# define as_read NULL
+
+	return (0);
+} /* int as_read */
 #endif /* IOKIT_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, as_init, as_read, NULL);
-	plugin_register ("apple_temperature", NULL, NULL, temperature_write);
-	plugin_register ("apple_fanspeed",    NULL, NULL, fanspeed_write);
-}
-
-#undef MODULE_NAME
+#if IOKIT_HAVE_READ
+	plugin_register_init ("apple_sensors", as_init);
+	plugin_register_read ("apple_sensors", as_read);
+#endif /* IOKIT_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/battery.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/battery.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/battery.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/battery.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/battery.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006,2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,16 +19,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "battery"
-#define BUFSIZE 512
 
 #if HAVE_MACH_MACH_TYPES_H
 #  include <mach/mach_types.h>
 #endif
 #if HAVE_MACH_MACH_INIT_H
 #  include <mach/mach_init.h>
@@ -58,152 +53,63 @@
 #else
 # define BATTERY_HAVE_READ 0
 #endif
 
 #define INVALID_VALUE 47841.29
 
-static char *battery_current_file = "battery-%s/current.rrd";
-static char *battery_voltage_file = "battery-%s/voltage.rrd";
-static char *battery_charge_file  = "battery-%s/charge.rrd";
-
-static char *ds_def_current[] =
-{
-	"DS:current:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num_current = 1;
-
-static char *ds_def_voltage[] =
-{
-	"DS:voltage:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num_voltage = 1;
-
-static char *ds_def_charge[] =
-{
-	"DS:charge:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int ds_num_charge = 1;
-
+#if BATTERY_HAVE_READ
 #if HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H
 	/* No global variables */
 /* #endif HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H */
 
 #elif KERNEL_LINUX
 static int   battery_pmu_num = 0;
 static char *battery_pmu_file = "/proc/pmu/battery_%i";
 #endif /* KERNEL_LINUX */
 
-static void battery_init (void)
+static int battery_init (void)
 {
 #if HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H
 	/* No init neccessary */
 /* #endif HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H */
 
 #elif KERNEL_LINUX
 	int len;
-	char filename[BUFSIZE];
+	char filename[128];
 
 	for (battery_pmu_num = 0; ; battery_pmu_num++)
 	{
-		len = snprintf (filename, BUFSIZE, battery_pmu_file, battery_pmu_num);
+		len = snprintf (filename, sizeof (filename), battery_pmu_file, battery_pmu_num);
 
-		if ((len >= BUFSIZE) || (len < 0))
+		if ((len >= sizeof (filename)) || (len < 0))
 			break;
 
 		if (access (filename, R_OK))
 			break;
 	}
 #endif /* KERNEL_LINUX */
 
-	return;
+	return (0);
 }
 
-static void battery_current_write (char *host, char *inst, char *val)
+static void battery_submit (const char *plugin_instance, const char *type, double value)
 {
-	char filename[BUFSIZE];
-	int len;
-
-	len = snprintf (filename, BUFSIZE, battery_current_file, inst);
-	if ((len >= BUFSIZE) || (len < 0))
-		return;
-
-	rrd_update_file (host, filename, val,
-			ds_def_current, ds_num_current);
-}
-
-static void battery_voltage_write (char *host, char *inst, char *val)
-{
-	char filename[BUFSIZE];
-	int len;
-
-	len = snprintf (filename, BUFSIZE, battery_voltage_file, inst);
-	if ((len >= BUFSIZE) || (len < 0))
-		return;
-
-	rrd_update_file (host, filename, val,
-			ds_def_voltage, ds_num_voltage);
-}
-
-static void battery_charge_write (char *host, char *inst, char *val)
-{
-	char filename[BUFSIZE];
-	int len;
-
-	len = snprintf (filename, BUFSIZE, battery_charge_file, inst);
-	if ((len >= BUFSIZE) || (len < 0))
-		return;
-
-	rrd_update_file (host, filename, val,
-			ds_def_charge, ds_num_charge);
-}
-
-#if BATTERY_HAVE_READ
-static void battery_submit (char *inst, double current, double voltage, double charge)
-{
-	int len;
-	char buffer[BUFSIZE];
-
-	if (current != INVALID_VALUE)
-	{
-		len = snprintf (buffer, BUFSIZE, "N:%.3f", current);
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-		if ((len > 0) && (len < BUFSIZE))
-			plugin_submit ("battery_current", inst, buffer);
-	}
-	else
-	{
-		plugin_submit ("battery_current", inst, "N:U");
-	}
+	values[0].gauge = value;
 
-	if (voltage != INVALID_VALUE)
-	{
-		len = snprintf (buffer, BUFSIZE, "N:%.3f", voltage);
-
-		if ((len > 0) && (len < BUFSIZE))
-			plugin_submit ("battery_voltage", inst, buffer);
-	}
-	else
-	{
-		plugin_submit ("battery_voltage", inst, "N:U");
-	}
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "battery");
+	strcpy (vl.plugin_instance, plugin_instance);
 
-	if (charge != INVALID_VALUE)
-	{
-		len = snprintf (buffer, BUFSIZE, "N:%.3f", charge);
-
-		if ((len > 0) && (len < BUFSIZE))
-			plugin_submit ("battery_charge", inst, buffer);
-	}
-	else
-	{
-		plugin_submit ("battery_charge", inst, "N:U");
-	}
-}
+	plugin_dispatch_values (type, &vl);
+} /* void battery_submit */
 
 #if HAVE_IOKIT_PS_IOPOWERSOURCES_H || HAVE_IOKIT_IOKITLIB_H
 double dict_get_double (CFDictionaryRef dict, char *key_string)
 {
 	double      val_double;
 	long long   val_int;
@@ -211,19 +117,19 @@
 	CFStringRef key_obj;
 
 	key_obj = CFStringCreateWithCString (kCFAllocatorDefault, key_string,
 		       	kCFStringEncodingASCII);
 	if (key_obj == NULL)
 	{
-		DBG ("CFStringCreateWithCString (%s) failed.\n", key_string);
+		DEBUG ("CFStringCreateWithCString (%s) failed.\n", key_string);
 		return (INVALID_VALUE);
 	}
 
 	if ((val_obj = CFDictionaryGetValue (dict, key_obj)) == NULL)
 	{
-		DBG ("CFDictionaryGetValue (%s) failed.", key_string);
+		DEBUG ("CFDictionaryGetValue (%s) failed.", key_string);
 		CFRelease (key_obj);
 		return (INVALID_VALUE);
 	}
 	CFRelease (key_obj);
 
 	if (CFGetTypeID (val_obj) == CFNumberGetTypeID ())
@@ -241,13 +147,13 @@
 					&val_int);
 			val_double = val_int;
 		}
 	}
 	else
 	{
-		DBG ("CFGetTypeID (val_obj) = %i", (int) CFGetTypeID (val_obj));
+		DEBUG ("CFGetTypeID (val_obj) = %i", (int) CFGetTypeID (val_obj));
 		return (INVALID_VALUE);
 	}
 
 	return (val_double);
 }
 #endif /* HAVE_IOKIT_PS_IOPOWERSOURCES_H || HAVE_IOKIT_IOKITLIB_H */
@@ -267,28 +173,28 @@
 	int i;
 
 	ps_raw       = IOPSCopyPowerSourcesInfo ();
 	ps_array     = IOPSCopyPowerSourcesList (ps_raw);
 	ps_array_len = CFArrayGetCount (ps_array);
 
-	DBG ("ps_array_len == %i", ps_array_len);
+	DEBUG ("ps_array_len == %i", ps_array_len);
 
 	for (i = 0; i < ps_array_len; i++)
 	{
 		ps_obj  = CFArrayGetValueAtIndex (ps_array, i);
 		ps_dict = IOPSGetPowerSourceDescription (ps_raw, ps_obj);
 
 		if (ps_dict == NULL)
 		{
-			DBG ("IOPSGetPowerSourceDescription failed.");
+			DEBUG ("IOPSGetPowerSourceDescription failed.");
 			continue;
 		}
 
 		if (CFGetTypeID (ps_dict) != CFDictionaryGetTypeID ())
 		{
-			DBG ("IOPSGetPowerSourceDescription did not return a CFDictionaryRef");
+			DEBUG ("IOPSGetPowerSourceDescription did not return a CFDictionaryRef");
 			continue;
 		}
 
 		/* FIXME: Check if this is really an internal battery */
 
 		if (*ret_charge == INVALID_VALUE)
@@ -343,25 +249,25 @@
 
 	status = IOServiceGetMatchingServices (kIOMasterPortDefault,
 			IOServiceNameMatching ("battery"),
 			&iterator);
 	if (status != kIOReturnSuccess)
 	{
-		DBG ("IOServiceGetMatchingServices failed.");
+		DEBUG ("IOServiceGetMatchingServices failed.");
 		return;
 	}
 
 	while ((io_obj = IOIteratorNext (iterator)))
 	{
 		status = IORegistryEntryCreateCFProperties (io_obj,
 				(CFMutableDictionaryRef *) &bat_root_dict,
 				kCFAllocatorDefault,
 				kNilOptions);
 		if (status != kIOReturnSuccess)
 		{
-			DBG ("IORegistryEntryCreateCFProperties failed.");
+			DEBUG ("IORegistryEntryCreateCFProperties failed.");
 			continue;
 		}
 
 		bat_info_arry = (CFArrayRef) CFDictionaryGetValue (bat_root_dict,
 				CFSTR ("IOBatteryInfo"));
 		if (bat_info_arry == NULL)
@@ -406,13 +312,13 @@
 	}
 
 	IOObjectRelease (iterator);
 }
 #endif /* HAVE_IOKIT_IOKITLIB_H */
 
-static void battery_read (void)
+static int battery_read (void)
 {
 #if HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H
 	double charge  = INVALID_VALUE; /* Current charge in Ah */
 	double current = INVALID_VALUE; /* Current in A */
 	double voltage = INVALID_VALUE; /* Voltage in V */
 
@@ -426,49 +332,51 @@
 	get_via_generic_iokit (&charge_abs, &current, &voltage);
 #endif
 
 	if ((charge_rel != INVALID_VALUE) && (charge_abs != INVALID_VALUE))
 		charge = charge_abs * charge_rel / 100.0;
 
-	if ((charge != INVALID_VALUE)
-		       	|| (current != INVALID_VALUE)
-		       	|| (voltage != INVALID_VALUE))
-		battery_submit ("0", current, voltage, charge);
+	if (charge != INVALID_VALUE)
+		battery_submit ("0", "charge", charge);
+	if (current != INVALID_VALUE)
+		battery_submit ("0", "current", current);
+	if (voltage != INVALID_VALUE)
+		battery_submit ("0", "voltage", voltage);
 /* #endif HAVE_IOKIT_IOKITLIB_H || HAVE_IOKIT_PS_IOPOWERSOURCES_H */
 
 #elif KERNEL_LINUX
 	FILE *fh;
-	char buffer[BUFSIZE];
-	char filename[BUFSIZE];
+	char buffer[1024];
+	char filename[256];
 	
 	char *fields[8];
 	int numfields;
 
 	int i;
 	int len;
 
 	for (i = 0; i < battery_pmu_num; i++)
 	{
-		char    batnum_str[BUFSIZE];
+		char    batnum_str[256];
 		double  current = INVALID_VALUE;
 		double  voltage = INVALID_VALUE;
 		double  charge  = INVALID_VALUE;
 		double *valptr = NULL;
 
-		len = snprintf (filename, BUFSIZE, battery_pmu_file, i);
-		if ((len >= BUFSIZE) || (len < 0))
+		len = snprintf (filename, sizeof (filename), battery_pmu_file, i);
+		if ((len >= sizeof (filename)) || (len < 0))
 			continue;
 
-		len = snprintf (batnum_str, BUFSIZE, "%i", i);
-		if ((len >= BUFSIZE) || (len < 0))
+		len = snprintf (batnum_str, sizeof (batnum_str), "%i", i);
+		if ((len >= sizeof (batnum_str)) || (len < 0))
 			continue;
 
 		if ((fh = fopen (filename, "r")) == NULL)
 			continue;
 
-		while (fgets (buffer, BUFSIZE, fh) != NULL)
+		while (fgets (buffer, sizeof (buffer), fh) != NULL)
 		{
 			numfields = strsplit (buffer, fields, 8);
 
 			if (numfields < 3)
 				continue;
 
@@ -492,19 +400,21 @@
 
 				if ((fields[2] == endptr) || (errno != 0))
 					*valptr = INVALID_VALUE;
 			}
 		}
 
-		if ((current != INVALID_VALUE)
-				|| (voltage != INVALID_VALUE)
-				|| (charge  != INVALID_VALUE))
-			battery_submit (batnum_str, current, voltage, charge);
-
 		fclose (fh);
 		fh = NULL;
+
+		if (charge != INVALID_VALUE)
+			battery_submit ("0", "charge", charge);
+		if (current != INVALID_VALUE)
+			battery_submit ("0", "current", current);
+		if (voltage != INVALID_VALUE)
+			battery_submit ("0", "voltage", voltage);
 	}
 
 	if (access ("/proc/acpi/battery", R_OK | X_OK) == 0)
 	{
 		double  current = INVALID_VALUE;
 		double  voltage = INVALID_VALUE;
@@ -514,41 +424,48 @@
 
 		struct dirent *ent;
 		DIR *dh;
 
 		if ((dh = opendir ("/proc/acpi/battery")) == NULL)
 		{
-			syslog (LOG_ERR, "Cannot open `/proc/acpi/battery': %s", strerror (errno));
-			return;
+			char errbuf[1024];
+			ERROR ("Cannot open `/proc/acpi/battery': %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
+			return (-1);
 		}
 
 		while ((ent = readdir (dh)) != NULL)
 		{
 			if (ent->d_name[0] == '.')
 				continue;
 
-			len = snprintf (filename, BUFSIZE, "/proc/acpi/battery/%s/state", ent->d_name);
-			if ((len >= BUFSIZE) || (len < 0))
+			len = snprintf (filename, sizeof (filename),
+					"/proc/acpi/battery/%s/state",
+					ent->d_name);
+			if ((len >= sizeof (filename)) || (len < 0))
 				continue;
 
 			if ((fh = fopen (filename, "r")) == NULL)
 			{
-				syslog (LOG_ERR, "Cannot open `%s': %s", filename, strerror (errno));
+				char errbuf[1024];
+				ERROR ("Cannot open `%s': %s", filename,
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				continue;
 			}
 
 			/*
 			 * [11:00] <@tokkee> $ cat /proc/acpi/battery/BAT1/state
 			 * [11:00] <@tokkee> present:                 yes
 			 * [11:00] <@tokkee> capacity state:          ok
 			 * [11:00] <@tokkee> charging state:          charging
 			 * [11:00] <@tokkee> present rate:            1724 mA
 			 * [11:00] <@tokkee> remaining capacity:      4136 mAh
 			 * [11:00] <@tokkee> present voltage:         12428 mV
 			 */
-			while (fgets (buffer, BUFSIZE, fh) != NULL)
+			while (fgets (buffer, sizeof (buffer), fh) != NULL)
 			{
 				numfields = strsplit (buffer, fields, 8);
 
 				if (numfields < 3)
 					continue;
 
@@ -582,37 +499,36 @@
 
 					*valptr = strtod (fields[2], &endptr) / 1000.0;
 
 					if ((fields[2] == endptr) || (errno != 0))
 						*valptr = INVALID_VALUE;
 				}
-			}
+			} /* while (fgets (buffer, sizeof (buffer), fh) != NULL) */
+
+			fclose (fh);
 
 			if ((current != INVALID_VALUE) && (charging == 0))
 					current *= -1;
 
-			if ((current != INVALID_VALUE)
-					|| (voltage != INVALID_VALUE)
-					|| (charge  != INVALID_VALUE))
-				battery_submit (ent->d_name, current, voltage, charge);
-
-			fclose (fh);
+			if (charge != INVALID_VALUE)
+				battery_submit ("0", "charge", charge);
+			if (current != INVALID_VALUE)
+				battery_submit ("0", "current", current);
+			if (voltage != INVALID_VALUE)
+				battery_submit ("0", "voltage", voltage);
 		}
 
 		closedir (dh);
 	}
 #endif /* KERNEL_LINUX */
+
+	return (0);
 }
-#else
-# define battery_read NULL
 #endif /* BATTERY_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, battery_init, battery_read, NULL);
-	plugin_register ("battery_current", NULL, NULL, battery_current_write);
-	plugin_register ("battery_voltage", NULL, NULL, battery_voltage_write);
-	plugin_register ("battery_charge",  NULL, NULL, battery_charge_write);
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+#if BATTERY_HAVE_READ
+	plugin_register_init ("battery", battery_init);
+	plugin_register_read ("battery", battery_read);
+#endif /* BATTERY_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.1	2007-09-28 19:05:32.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.1	2007-05-30 19:39:12.000000000 +0800
@@ -1,7 +1,7 @@
-.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
+.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.14
 .\"
 .\" Standard preamble:
 .\" ========================================================================
 .de Sh \" Subsection heading
 .br
 .if t .Sp
@@ -22,17 +22,17 @@
 .de Ve \" End verbatim text
 .ft R
 .fi
 ..
 .\" Set up some character translations and predefined strings.  \*(-- will
 .\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
-.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
-.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
-.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
-.\" nothing in troff, for use with C<>.
-.tr \(*W-
+.\" double quote, and \*(R" will give a right double quote.  | will give a
+.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
+.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
+.\" expand to `' in nroff, nothing in troff, for use with C<>.
+.tr \(*W-|\(bv\*(Tr
 .ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
 .ie n \{\
 .    ds -- \(*W-
 .    ds PI pi
 .    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
 .    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
@@ -126,78 +126,37 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD 1"
-.TH COLLECTD 1 "2007-09-28" "3.11.7" "collectd"
+.TH COLLECTD 1 "2007-05-30" "4.0.0-rc10" "collectd"
 .SH "NAME"
 collectd \- System statistics collection daemon
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd \fI[options]\fR
 .SH "DESCRIPTION"
 .IX Header "DESCRIPTION"
-collectd is a daemon that collects various system statistics periodically and
-stores them into RRD\-files. Which data is collected depends on compile-time
-settings. The following features may be available:
-.IP "\(bu" 4
-Apache server stats (\fIapache\fR)
-.IP "\(bu" 4
-Apple hardware sensors (\fIapple_sensors\fR, Darwin only)
-.IP "\(bu" 4
-Battery status (\fIbattery\fR)
-.IP "\(bu" 4
-\&\s-1CPU\s0 utilization (\fIcpu\fR)
-.IP "\(bu" 4
-Mountpoint usage (\fIdf\fR)
-.IP "\(bu" 4
-Disk and partition usage/throughput (\fIdisk\fR)
-.IP "\(bu" 4
-\&\s-1DNS\s0 traffic (\fIdns\fR)
-.IP "\(bu" 4
-Email usage (\fIemail\fR)
-.IP "\(bu" 4
-Harddisk temperatures (\fIhddtemp\fR)
-.IP "\(bu" 4
-System load averages (\fIload\fR)
-.IP "\(bu" 4
-Motherboard monitor (\fImbmon\fR)
-.IP "\(bu" 4
-Memory usage (\fImemory\fR)
-.IP "\(bu" 4
-MySQL statistics (\fImysql\fR)
-.IP "\(bu" 4
-\&\s-1NFS\s0 utilization (\fInfs\fR, Linux only)
-.IP "\(bu" 4
-Network latency (\fIping\fR)
-.IP "\(bu" 4
-Number of processes (\fIprocesses\fR, Linux only)
-.IP "\(bu" 4
-lm_sensors information (\fIsensors\fR, Linux only)
-.IP "\(bu" 4
-Serial port traffic (\fIserial\fR, Linux only)
-.IP "\(bu" 4
-Swap usage (\fIswap\fR)
-.IP "\(bu" 4
-Tape drive usage (\fItape\fR, Solaris only)
-.IP "\(bu" 4
-Network traffic (\fItraffic\fR)
-.IP "\(bu" 4
-Number of users logged into the system (\fIusers\fR)
-.IP "\(bu" 4
-System ressources used by VServers (\fIvserver\fR)
-.IP "\(bu" 4
-Wireless network stats (\fIwireless\fR)
+collectd is a daemon that receives system statistics and makes them available
+in a number of ways. The main daemon itself doesn't have any real functionality
+apart from loading, querying and submitting to plugins. For a description of
+available plugins please see \*(L"\s-1PLUGINS\s0\*(R" below.
 .SH "OPTIONS"
 .IX Header "OPTIONS"
+Most of collectd's configuration is done using using a configfile. See
+\&\fIcollectd.conf\fR\|(5) for an in-depth description of all options.
 .IP "\fB\-C\fR \fI<config-file>\fR" 4
 .IX Item "-C <config-file>"
 Specify an alternative config file. This is the place to go when you wish to
 change \fBcollectd\fR's behavior. The path may be relative to the current working
 directory.
+.IP "\fB\-t\fR" 4
+.IX Item "-t"
+Test the configuration only. The program immediately exits after parsing the
+config file. A return code not equal to zero indicates an error.
 .IP "\fB\-P\fR \fI<pid-file>\fR" 4
 .IX Item "-P <pid-file>"
 Specify an alternative pid file. This overwrites any settings in the config 
 file. This is thought for init-scripts that require the PID-file in a certain
 directory to work correctly. For everyday-usage use the \fBPIDFile\fR
 config\-option.
@@ -206,492 +165,52 @@
 Don't fork to the background. \fIcollectd\fR will also \fBnot\fR close standard file
 descriptors, detach from the session nor write a pid file. This is mainly
 thought for 'supervisioning' init replacements such as \fIrunit\fR.
 .IP "\fB\-h\fR" 4
 .IX Item "-h"
 Output usage information and exit.
-.SH "MODES"
-.IX Header "MODES"
-collectd can operate in four different operating modes. The modes are described
-below.
-.PP
-The simplest mode is the so called \fBlocal mode\fR. Data is collected locally and
-written in \s-1RRD\s0 files that reside in \fIDataDir\fR. This is the default mode when
-collectd is linked against \f(CW\*(C`librrd\*(C'\fR.
-.PP
-The modes \fBclient mode\fR and \fBserver mode\fR are used to send data over a
-network and receive it again.
-.PP
-In \fBclient mode\fR the daemon collects the data locally and sends its results
-to one or more network addresses. No \s-1RRD\s0 files are written locally in this
-case. If collectd is not linked against \f(CW\*(C`librrd\*(C'\fR this is the default mode.
-.PP
-If started in \fBserver mode\fR the daemon will listen on one or more interfaces
-and write the data it receives to \s-1RRD\s0 files. No data is collected locally.
-.PP
-In the last mode, \fBlog mode\fR, data is collected locally and written in
-text files that reside in \fIDataDir\fR.
-.PP
-Please refer to \fIcollectd.conf\fR\|(5) for the configuration options and default
-values.
-.SH "SPECIAL PLUGINS"
-.IX Header "SPECIAL PLUGINS"
-.Sh "apache"
-.IX Subsection "apache"
-This module connects to an Apache webserver and expects the output produced by
-\&\fBmod_status.c\fR. If requires \fBlibcurl\fR to set up the \s-1HTTP\s0 connection and issue
-the request(s). The following is a sample config for the Apache webserver. The
-use of \f(CW\*(C`ExtendedStatus on\*(C'\fR is mandatory.
-.PP
-.Vb 6
-\&  ExtendedStatus on
-\&  <IfModule mod_status.c>
-\&    <Location /mod_status>
-\&      SetHandler server\-status
-\&    </Location>
-\&  </IfModule>
-.Ve
-.PP
-This plugin requires further configuration. Please read \fIcollectd.conf\fR\|(5).
-.Sh "cpufreq"
-.IX Subsection "cpufreq"
-This module reads \fI/sys/devices/system/cpu/cpu0/cpufreq/scaling_cur_freq\fR (for
-the first \s-1CPU\s0 installed) to get the current \s-1CPU\s0 frequency. If this file does
-not exist make sure \fBcpufreqd\fR (<http://cpufreqd.sourceforge.net/>) or a
-similar tool is installed and an \*(L"cpu governor\*(R" (that's kernel module) is
-loaded.
-.Sh "email"
-.IX Subsection "email"
-This plugin collects data indirectly by providing a \s-1UNIX\s0 socket that external
-programs can connect to. A simple line based protocol is used to communicate
-with the plugin:
-.PP
-E\-Mail type (e.g. \*(L"ham\*(R", \*(L"spam\*(R", \*(L"virus\*(R", ...) and size (bytes):
-.PP
-.Vb 1
-\&  e:<type>:<size>
-.Ve
-.PP
-If \f(CW\*(C`size\*(C'\fR is less than or equal to zero, \f(CW\*(C`size\*(C'\fR is ignored.
-.PP
-Spam score:
-.PP
-.Vb 1
-\&  s:<value>
-.Ve
-.PP
-Successful spam checks (e.g. \*(L"\s-1BAYES_99\s0\*(R", \*(L"\s-1SUBJECT_DRUG_GAP_C\s0\*(R", ...):
-.PP
-.Vb 1
-\&  c:<type1>[,<type2>,...]
-.Ve
-.PP
-Each line is limited to 256 characters (including the newline character). 
-Longer lines will be ignored.
-.Sh "mysql"
-.IX Subsection "mysql"
-Requires \fBmysqlclient\fR to be installed. It connects to the database when
-started and keeps the connection up as long as possible. When the connection is
-interrupted for whatever reason it will try to re\-connect. The syslog will
-contain loud complaints in case anything goes wrong.
-.PP
-This plugin issues \f(CW\*(C`SHOW STATUS\*(C'\fR and evaluates \f(CW\*(C`Bytes_{received,sent}\*(C'\fR,
-\&\f(CW\*(C`Com_*\*(C'\fR and \f(CW\*(C`Handler_*\*(C'\fR which correspond to \fItraffic\-mysql.rrd\fR,
-\&\fImysql_commands\-*.rrd\fR and \fImysql_handler\-*.rrd\fR. Also, the values of
-\&\f(CW\*(C`Qcache_*\*(C'\fR are put in \fImysql_qcache.rrd\fR and values of \f(CW\*(C`Threads_*\*(C'\fR are put
-in \fImysql_threads.rrd\fR. Please refer to the \fBMySQL reference manual\fR,
-\&\fI5.2.4. Server Status Variables\fR for an explanation of these values.
-.Sh "sensors"
-.IX Subsection "sensors"
-The \fBsensors\fR module uses lm_sensors to retrieve sensor\-values. This means
-that all the needed modules have to be loaded and lm_sensors has to be
-configured (most likely by editing \fI/etc/sensors.conf\fR. Read
-\&\fIsensors.conf\fR\|(5) for details.
-.PP
-The \fBlm_sensors\fR homepage can be found at
-<http://secure.netroedge.com/~lm78/>.
-.Sh "mbmon"
-.IX Subsection "mbmon"
-The \fBmbmon\fR module uses mbmon to retrieve temperature, voltage, etc.
-.PP
-collectd connects to \fBlocalhost\fR (127.0.0.1), port \fB411/tcp\fR.
-The \fBHost\fR and \fBPort\fR options can be used to change these
-default values. See \fIcollectd.conf\fR\|(5) for details. \f(CW\*(C`mbmon\*(C'\fR has to be
-running to work correctly. If \f(CW\*(C`mbmon\*(C'\fR is not running timeouts may appear
-which may interfere with other statistics..
-.PP
-\&\f(CW\*(C`mbmon\*(C'\fR must be run with the \-r option (\*(L"print \s-1TAG\s0 and Value format\*(R");
-Debian's /etc/init.d/mbmon script already does this, other people
-will need to ensure that this is the case.
-.Sh "hddtemp"
-.IX Subsection "hddtemp"
-To get values from \fBhddtemp\fR collectd connects to \fBlocalhost\fR (127.0.0.1),
-port \fB7634/tcp\fR. The \fBHost\fR and \fBPort\fR options can be used to change these
-default values. See \fIcollectd.conf\fR\|(5) for details. \f(CW\*(C`hddtemp\*(C'\fR has to be
-running to work correctly. If \f(CW\*(C`hddtemp\*(C'\fR is not running timeouts may appear
-which may interfere with other statistics..
-.PP
-The \fBhddtemp\fR homepage can be found at
-<http://www.guzu.net/linux/hddtemp.php>.
-.Sh "vserver"
-.IX Subsection "vserver"
-\&\fBVServer\fR support is only available for Linux. It cannot yet be found in a 
-vanilla kernel, though. To make use of this plugin you need a kernel that has 
-\&\fBVServer\fR support built in, i.e. you need to apply the patches and compile 
-your own kernel, which will then provide the /proc/virtual filesystem that is
-required by this plugin.
-.PP
-The \fBVServer\fR homepage can be found at <http://linux\-vserver.org/>.
-.SH "RRD FILES"
-.IX Header "RRD FILES"
-The \s-1RRD\s0 files are created automatically. The size of the RRAs depend on the
-compile time settings of \fIstep\fR and \fIwidth\fR. With the default values (\fIstep\fR
-= \fB10\fR, \fIwidth\fR = \fB1200\fR) the following RRAs are created:
-.PP
-.Vb 12
-\&  RRA:AVERAGE:0.1:1:8640
-\&  RRA:AVERAGE:0.1:50:1210
-\&  RRA:AVERAGE:0.1:223:1202
-\&  RRA:AVERAGE:0.1:2635:1201
-\&  RRA:MIN:0.1:1:8640
-\&  RRA:MIN:0.1:50:1210
-\&  RRA:MIN:0.1:223:1202
-\&  RRA:MIN:0.1:2635:1201
-\&  RRA:MAX:0.1:1:8640
-\&  RRA:MAX:0.1:50:1210
-\&  RRA:MAX:0.1:223:1202
-\&  RRA:MAX:0.1:2635:1201
-.Ve
-.PP
-By default collectd uses a 10 second \fIstep\fR. Thus the RRAs contain the
-following timespans. If you've changed the \fIstep\fR at compile time you will
-have calculate resolution and timespan yourself.
-.PP
-.Vb 6
-\&  PDP per CDP |  Resolution  | Data points | Timespan
-\&  \-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-
-\&            1 | 10.0 seconds !        8640 ! 1 day
-\&           50 |  8.3 minutes |        1210 | 1 week
-\&          223 | 37.2 minutes |        1202 | 1 month
-\&         2635 |  7.3 hours   |        1201 | 1 year
-.Ve
-.PP
-The \s-1DS\s0'es depend on the module creating the \s-1RRD\s0 files:
-.IP "Apache traffic (\fIapache/apache_bytes.rrd\fR)" 4
-.IX Item "Apache traffic (apache/apache_bytes.rrd)"
-.Vb 1
-\&  DS:count:COUNTER:HEARTBEAT:0:134217728
-.Ve
-.IP "Apache requests (\fIapache/apache_requests.rrd\fR)" 4
-.IX Item "Apache requests (apache/apache_requests.rrd)"
-.Vb 1
-\&  DS:count:COUNTER:HEARTBEAT:0:1048576
-.Ve
-.IP "Apache scoreboard (\fIapache/apache_scoreboard\-\fI<name>\fI.rrd\fR)" 4
-.IX Item "Apache scoreboard (apache/apache_scoreboard-<name>.rrd)"
-.Vb 1
-\&  DS:count:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Apple temperature sensor (\fIapple_sensors/temperature\-\fI<name>\fI.rrd\fR)" 4
-.IX Item "Apple temperature sensor (apple_sensors/temperature-<name>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "Apple fanspeed sensor (\fIapple_sensors/fanspeed\-\fI<name>\fI.rrd\fR)" 4
-.IX Item "Apple fanspeed sensor (apple_sensors/fanspeed-<name>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "Battery charge (\fIbattery\-\fI<name>\fI/charge.rrd\fR)" 4
-.IX Item "Battery charge (battery-<name>/charge.rrd)"
-.Vb 1
-\&  DS:charge:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Battery current (\fIbattery\-\fI<name>\fI/current.rrd\fR)" 4
-.IX Item "Battery current (battery-<name>/current.rrd)"
-.Vb 1
-\&  DS:current:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "Battery voltage (\fIbattery\-\fI<name>\fI/voltage.rrd\fR)" 4
-.IX Item "Battery voltage (battery-<name>/voltage.rrd)"
-.Vb 1
-\&  DS:voltage:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "\s-1CPU\s0 (\fIcpu\-\fI<num>\fI.rrd\fR)" 4
-.IX Item "CPU (cpu-<num>.rrd)"
-.Vb 5
-\&  DS:user:COUNTER:HEARTBEAT:0:100
-\&  DS:nice:COUNTER:HEARTBEAT:0:100
-\&  DS:syst:COUNTER:HEARTBEAT:0:100
-\&  DS:idle:COUNTER:HEARTBEAT:0:100
-\&  DS:wait:COUNTER:HEARTBEAT:0:100
-.Ve
-.IP "\s-1CPU\s0 frequency (\fIcpufreq\-\fI<num>\fI.rrd\fR)" 4
-.IX Item "CPU frequency (cpufreq-<num>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Mountpoints (\fIdf\-\fI<path>\fI.rrd\fR)" 4
-.IX Item "Mountpoints (df-<path>.rrd)"
-.Vb 2
-\&  DS:used:GAUGE:HEARTBEAT:0:U
-\&  DS:free:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Diskstats (\fIdisk\-\fI<major>\fI\-\fI<minor>\fI.rrd\fR)" 4
-.IX Item "Diskstats (disk-<major>-<minor>.rrd)"
-.Vb 8
-\&  DS:rcount:COUNTER:HEARTBEAT:0:U
-\&  DS:rmerged:COUNTER:HEARTBEAT:0:U
-\&  DS:rbytes:COUNTER:HEARTBEAT:0:U
-\&  DS:rtime:COUNTER:HEARTBEAT:0:U
-\&  DS:wcount:COUNTER:HEARTBEAT:0:U
-\&  DS:wmerged:COUNTER:HEARTBEAT:0:U
-\&  DS:wbytes:COUNTER:HEARTBEAT:0:U
-\&  DS:wtime:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Diskstats (\fIpartition\-\fI<major>\fI\-\fI<minor>\fI.rrd\fR)" 4
-.IX Item "Diskstats (partition-<major>-<minor>.rrd)"
-.Vb 4
-\&  DS:rcount:COUNTER:HEARTBEAT:0:U
-\&  DS:rbytes:COUNTER:HEARTBEAT:0:U
-\&  DS:wcount:COUNTER:HEARTBEAT:0:U
-\&  DS:wbytes:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "E\-Mail count (\fIemail/email\-\fI<type>\fI.rrd\fR)" 4
-.IX Item "E-Mail count (email/email-<type>.rrd)"
-.Vb 1
-\&  DS:count:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "E\-Mail size (\fIemail/email_size\-\fI<type>\fI.rrd\fR)" 4
-.IX Item "E-Mail size (email/email_size-<type>.rrd)"
-.Vb 1
-\&  DS:size:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "\s-1HDD\s0 Temperature (\fIhddtemp\-\fI<major>\fI\-\fI<minor>\fI.rrd\fR)" 4
-.IX Item "HDD Temperature (hddtemp-<major>-<minor>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "System load (\fIload.rrd\fR)" 4
-.IX Item "System load (load.rrd)"
-.Vb 3
-\&  DS:shortterm:GAUGE:HEARTBEAT:0:100
-\&  DS:midterm:GAUGE:HEARTBEAT:0:100
-\&  DS:longterm:GAUGE:HEARTBEAT:0:100
-.Ve
-.IP "Memory usage (\fImemory.rrd\fR)" 4
-.IX Item "Memory usage (memory.rrd)"
-.Vb 4
-\&  DS:used:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:free:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:buffers:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:cached:GAUGE:HEARTBEAT:0:9223372036854775807
-.Ve
-.IP "MySQL commands and handlers (\fImysql_commands\-\fI<command>\fI.rrd\fR and \fImysql_handler\-\fI<handler>\fI.rrd\fR)" 4
-.IX Item "MySQL commands and handlers (mysql_commands-<command>.rrd and mysql_handler-<handler>.rrd)"
-.Vb 1
-\&  DS:value:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "MySQL query cache (\fImysql_qcache.rrd\fR)" 4
-.IX Item "MySQL query cache (mysql_qcache.rrd)"
-.Vb 5
-\&  DS:hits:COUNTER:HEARTBEAT:0:U
-\&  DS:inserts:COUNTER:HEARTBEAT:0:U
-\&  DS:not_cached:COUNTER:HEARTBEAT:0:U
-\&  DS:lowmem_prunes:COUNTER:HEARTBEAT:0:U
-\&  DS:queries_in_cache:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "MySQL threads (\fImysql_threads.rrd\fR)" 4
-.IX Item "MySQL threads (mysql_threads.rrd)"
-.Vb 4
-\&  DS:running:GAUGE:HEARTBEAT:0:U
-\&  DS:connected:GAUGE:HEARTBEAT:0:U
-\&  DS:cached:GAUGE:HEARTBEAT:0:U
-\&  DS:created:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "NFSv2 Procedures (\fInfs2_procedures\-\fI(client|server)\fI.rrd\fR)" 4
-.IX Item "NFSv2 Procedures (nfs2_procedures-(client|server).rrd)"
-.Vb 18
-\&  DS:null:COUNTER:HEARTBEAT:0:U
-\&  DS:getattr:COUNTER:HEARTBEAT:0:U
-\&  DS:setattr:COUNTER:HEARTBEAT:0:U
-\&  DS:root:COUNTER:HEARTBEAT:0:U
-\&  DS:lookup:COUNTER:HEARTBEAT:0:U
-\&  DS:readlink:COUNTER:HEARTBEAT:0:U
-\&  DS:read:COUNTER:HEARTBEAT:0:U
-\&  DS:wrcache:COUNTER:HEARTBEAT:0:U
-\&  DS:write:COUNTER:HEARTBEAT:0:U
-\&  DS:create:COUNTER:HEARTBEAT:0:U
-\&  DS:remove:COUNTER:HEARTBEAT:0:U
-\&  DS:rename:COUNTER:HEARTBEAT:0:U
-\&  DS:link:COUNTER:HEARTBEAT:0:U
-\&  DS:symlink:COUNTER:HEARTBEAT:0:U
-\&  DS:mkdir:COUNTER:HEARTBEAT:0:U
-\&  DS:rmdir:COUNTER:HEARTBEAT:0:U
-\&  DS:readdir:COUNTER:HEARTBEAT:0:U
-\&  DS:fsstat:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "NFSv3 Procedures (\fInfs3_procedures\-\fI(client|server)\fI.rrd\fR)" 4
-.IX Item "NFSv3 Procedures (nfs3_procedures-(client|server).rrd)"
-.Vb 22
-\&  DS:null:COUNTER:HEARTBEAT:0:U
-\&  DS:getattr:COUNTER:HEARTBEAT:0:U
-\&  DS:setattr:COUNTER:HEARTBEAT:0:U
-\&  DS:lookup:COUNTER:HEARTBEAT:0:U
-\&  DS:access:COUNTER:HEARTBEAT:0:U
-\&  DS:readlink:COUNTER:HEARTBEAT:0:U
-\&  DS:read:COUNTER:HEARTBEAT:0:U
-\&  DS:write:COUNTER:HEARTBEAT:0:U
-\&  DS:create:COUNTER:HEARTBEAT:0:U
-\&  DS:mkdir:COUNTER:HEARTBEAT:0:U
-\&  DS:symlink:COUNTER:HEARTBEAT:0:U
-\&  DS:mknod:COUNTER:HEARTBEAT:0:U
-\&  DS:remove:COUNTER:HEARTBEAT:0:U
-\&  DS:rmdir:COUNTER:HEARTBEAT:0:U
-\&  DS:rename:COUNTER:HEARTBEAT:0:U
-\&  DS:link:COUNTER:HEARTBEAT:0:U
-\&  DS:readdir:COUNTER:HEARTBEAT:0:U
-\&  DS:readdirplus:COUNTER:HEARTBEAT:0:U
-\&  DS:fsstat:COUNTER:HEARTBEAT:0:U
-\&  DS:fsinfo:COUNTER:HEARTBEAT:0:U
-\&  DS:pathconf:COUNTER:HEARTBEAT:0:U
-\&  DS:commit:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Network latency / Ping (\fIping\-\fI<hostname>\fI.rrd\fR)" 4
-.IX Item "Network latency / Ping (ping-<hostname>.rrd)"
-.Vb 1
-\&  DS:ping:GAUGE:HEARTBEAT:0:65535
-.Ve
-.IP "Processes (\fIprocesses.rrd\fR)" 4
-.IX Item "Processes (processes.rrd)"
-.Vb 6
-\&  DS:running:GAUGE:HEARTBEAT:0:65535
-\&  DS:sleeping:GAUGE:HEARTBEAT:0:65535
-\&  DS:zombies:GAUGE:HEARTBEAT:0:65535
-\&  DS:stopped:GAUGE:HEARTBEAT:0:65535
-\&  DS:paging:GAUGE:HEARTBEAT:0:65535
-\&  DS:blocked:GAUGE:HEARTBEAT:0:65535
-.Ve
-.IP "lm_sensors fanspeed sensor (\fIsensors\-\fI<inst>\fI.rrd\fR or \fIlm_sensors\-\fI<chip>\fI/fanspeed\-\fI<inst>\fI.rrd\fR)" 4
-.IX Item "lm_sensors fanspeed sensor (sensors-<inst>.rrd or lm_sensors-<chip>/fanspeed-<inst>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "lm_sensors temperature sensor (\fIsensors\-\fI<inst>\fI.rrd\fR or \fIlm_sensors\-\fI<chip>\fI/temperature\-\fI<inst>\fI.rrd\fR)" 4
-.IX Item "lm_sensors temperature sensor (sensors-<inst>.rrd or lm_sensors-<chip>/temperature-<inst>.rrd)"
-.Vb 1
-\&  DS:value:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "lm_sensors voltage sensor (\fIsensors\-\fI<inst>\fI.rrd\fR or \fIlm_sensors\-\fI<chip>\fI/voltage\-\fI<inst>\fI.rrd\fR)" 4
-.IX Item "lm_sensors voltage sensor (sensors-<inst>.rrd or lm_sensors-<chip>/voltage-<inst>.rrd)"
-.Vb 1
-\&  DS:voltage:GAUGE:HEARTBEAT:U:U
-.Ve
-.IP "Serial port traffic (\fIserial\-\fI<num>\fI.rrd\fR)" 4
-.IX Item "Serial port traffic (serial-<num>.rrd)"
-.Vb 2
-\&  DS:incoming:COUNTER:HEARTBEAT:0:U
-\&  DS:outgoing:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Spam score (\fIemail/spam_score.rrd\fR)" 4
-.IX Item "Spam score (email/spam_score.rrd)"
-.Vb 1
-\&  DS:score:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Spam checks (\fIemail/spam_check\-\fI<type>\fI.rrd\fR)" 4
-.IX Item "Spam checks (email/spam_check-<type>.rrd)"
-.Vb 1
-\&  DS:hits:GAUGE:HEARTBEAT:0:U
-.Ve
-.IP "Swap usage (\fIswap.rrd\fR)" 4
-.IX Item "Swap usage (swap.rrd)"
-.Vb 4
-\&  DS:used:GAUGE:HEARTBEAT:0:1099511627776
-\&  DS:free:GAUGE:HEARTBEAT:0:1099511627776
-\&  DS:cached:GAUGE:HEARTBEAT:0:1099511627776
-\&  DS:resv:GAUGE:HEARTBEAT:0:1099511627776
-.Ve
-.IP "Tape drive usage (\fItape\-\fI<name>\fI.rrd\fR)" 4
-.IX Item "Tape drive usage (tape-<name>.rrd)"
-.Vb 8
-\&  DS:rcount:COUNTER:HEARTBEAT:0:
-\&  DS:rmerged:COUNTER:HEARTBEAT:0:U
-\&  DS:rbytes:COUNTER:HEARTBEAT:0:U
-\&  DS:rtime:COUNTER:HEARTBEAT:0:U
-\&  DS:wcount:COUNTER:HEARTBEAT:0:U
-\&  DS:wmerged:COUNTER:HEARTBEAT:0:U
-\&  DS:wbytes:COUNTER:HEARTBEAT:0:U
-\&  DS:wtime:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Network traffic (\fItraffic\-\fI<interface>\fI.rrd\fR)" 4
-.IX Item "Network traffic (traffic-<interface>.rrd)"
-.Vb 2
-\&  DS:incoming:COUNTER:HEARTBEAT:0:U
-\&  DS:outgoing:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Interface packets (\fIif_packets\-\fI<interface>\fI.rrd\fR)" 4
-.IX Item "Interface packets (if_packets-<interface>.rrd)"
-.Vb 2
-\&  DS:rx:COUNTER:HEARTBEAT:0:U
-\&  DS:tx:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Interface errors (\fIif_errors\-\fI<interface>\fI.rrd\fR)" 4
-.IX Item "Interface errors (if_errors-<interface>.rrd)"
-.Vb 2
-\&  DS:rx:COUNTER:HEARTBEAT:0:U
-\&  DS:tx:COUNTER:HEARTBEAT:0:U
-.Ve
-.IP "Users (\fIusers.rrd\fR)" 4
-.IX Item "Users (users.rrd)"
-.Vb 1
-\&  DS:users:GAUGE:HEARTBEAT:0:65535
-.Ve
-.IP "VServer load (\fIvserver\-\fI<xid>\fI/load.rrd\fR)" 4
-.IX Item "VServer load (vserver-<xid>/load.rrd)"
-.Vb 3
-\&  DS:shortterm:GAUGE:HEARTBEAT:0:100
-\&  DS:midterm:GAUGE:HEARTBEAT:0:100
-\&  DS:longterm:GAUGE:HEARTBEAT:0:100
-.Ve
-.IP "VServer threads (\fIvserver\-\fI<xid>\fI/threads.rrd\fR)" 4
-.IX Item "VServer threads (vserver-<xid>/threads.rrd)"
-.Vb 4
-\&  DS:total:GAUGE:HEARTBEAT:0:65535
-\&  DS:running:GAUGE:HEARTBEAT:0:65535
-\&  DS:uninterruptible:GAUGE:HEARTBEAT:0:65535
-\&  DS:onhold:GAUGE:HEARTBEAT:0:65535
-.Ve
-.IP "VServer network traffic (\fIvserver\-\fI<xid>\fI/traffic\-\fI<name>\fI.rrd\fR)" 4
-.IX Item "VServer network traffic (vserver-<xid>/traffic-<name>.rrd)"
-.Vb 3
-\&  DS:incoming:COUNTER:HEARTBEAT:0:9223372036854775807
-\&  DS:outgoing:COUNTER:HEARTBEAT:0:9223372036854775807
-\&  DS:failed:COUNTER:HEARTBEAT:0:9223372036854775807
-.Ve
-.IP "VServer processes (\fIvserver\-\fI<xid>\fI/vs_processes.rrd\fR)" 4
-.IX Item "VServer processes (vserver-<xid>/vs_processes.rrd)"
-.Vb 1
-\&  DS:total:GAUGE:HEARTBEAT:0:65535
-.Ve
-.IP "VServer memory usage (\fIvserver\-\fI<xid>\fI/vs_memory.rrd\fR)" 4
-.IX Item "VServer memory usage (vserver-<xid>/vs_memory.rrd)"
-.Vb 4
-\&  DS:vm:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:vml:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:rss:GAUGE:HEARTBEAT:0:9223372036854775807
-\&  DS:anon:GAUGE:HEARTBEAT:0:9223372036854775807
-.Ve
-.IP "Wireless link quality (\fIwireless\-\fI<interface>\fI.rrd\fR)" 4
-.IX Item "Wireless link quality (wireless-<interface>.rrd)"
-.Vb 3
-\&  DS:quality:GAUGE:HEARTBEAT:0:U
-\&  DS:power:GAUGE:HEARTBEAT:U:0
-\&  DS:noise:GAUGE:HEARTBEAT:U:0
-.Ve
+.SH "PLUGINS"
+.IX Header "PLUGINS"
+As noted above, the real power of collectd lies within it's plugins. A
+(hopefully complete) list of plugins and short descriptions can be found in the
+\&\fI\s-1README\s0\fR file that is distributed with the sourcecode. If you're using a
+package it's a good bet to search somewhere near \fI/usr/share/doc/collectd\fR.
+.PP
+There are two big groups of plugins, \fBinput\fR and \fBoutput\fR plugins:
+.IP "\(bu" 4
+Input plugins are queried periodically. They somehow aquire the current value
+of whatever they where designed to work with and submit these values back to
+the daemon, i. e. they \*(L"dispatch\*(R" the values. As an example, the \f(CW\*(C`cpu plugin\*(C'\fR
+reads the current cpu-counters of time spent in the various modes (user,
+system, nice, ...) and dispatches these counters to the daemon.
+.IP "\(bu" 4
+Output plugins get the dispatched values from the daemon and does something
+with them. Common applications are writing to RRD\-files, CSV-files or sending
+the data over a network link to a remote box.
+.PP
+Of course not all plugins fit neatly into one of the two above categories. The
+\&\f(CW\*(C`network plugin\*(C'\fR, for example, is able to send (i.\ e. \*(L"write\*(R") \fBand\fR
+receive (i.\ e. \*(L"dispatch\*(R") values. Also, it opens a socket upon
+initialization and dispatches the values when it receives them and isn't
+triggered at the same time the input plugins are being read. You can think if
+the network receive part as working asynchronous if it helps.
+.PP
+In addition to the above, there are \*(L"logging plugins\*(R". Right now those are the
+\&\f(CW\*(C`logfile plugin\*(C'\fR and the \f(CW\*(C`syslog plugin\*(C'\fR. With these plugins collectd can
+provide information about issues and significant situations to the user.
+Several loglevels let you suppress uninteresting messages.
+.PP
+Please note that some plugins, that provide other means of communicating with
+the daemon, have manpages of their own to describe their functionality in more
+detail. In particular those are \fIcollectd\-email\fR\|(5), \fIcollectd\-exec\fR\|(5),
+\&\fIcollectd\-perl\fR\|(5), and \fIcollectd\-unixsock\fR\|(5)
 .SH "SEE ALSO"
 .IX Header "SEE ALSO"
-\&\fIcollectd.conf\fR\|(5), \fIrrdtool\fR\|(1), \fIsensors\fR\|(1), \fIhddtemp\fR\|(8),
-\&\fImbmon\fR\|(1),
-kstat(3KSTAT)
+\&\fIcollectd.conf\fR\|(5),
+\&\fIcollectd\-email\fR\|(5),
+\&\fIcollectd\-exec\fR\|(5),
+\&\fIcollectd\-perl\fR\|(5),
+\&\fIcollectd\-unixsock\fR\|(5),
+<http://collectd.org/>
 .SH "AUTHOR"
 .IX Header "AUTHOR"
 Florian Forster <octo@verplant.org>
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/collectd.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,68 +19,124 @@
  *   Florian octo Forster <octo at verplant.org>
  *   Alvaro Barcellos <alvaro.barcellos at gmail.com>
  **/
 
 #include "collectd.h"
 #include "common.h"
-#include "utils_debug.h"
 
-#include "network.h"
 #include "plugin.h"
 #include "configfile.h"
+#include "types_list.h"
 
-static int loop = 0;
-
+/*
+ * Global variables
+ */
+char hostname_g[DATA_MAX_NAME_LEN];
+int  interval_g;
 #if HAVE_LIBKSTAT
 kstat_ctl_t *kc;
 #endif /* HAVE_LIBKSTAT */
 
-/*
- * exported variables
- */
-time_t curtime;
-int    operating_mode;
+static int loop = 0;
 
 static void sigIntHandler (int signal)
 {
 	loop++;
 }
 
 static void sigTermHandler (int signal)
 {
 	loop++;
 }
 
-static int change_basedir (char *dir)
+static int init_global_variables (void)
+{
+	const char *str;
+
+	str = global_option_get ("Hostname");
+	if (str != NULL)
+	{
+		strncpy (hostname_g, str, sizeof (hostname_g));
+	}
+	else
+	{
+		if (gethostname (hostname_g, sizeof (hostname_g)) != 0)
+		{
+			fprintf (stderr, "`gethostname' failed and no "
+					"hostname was configured.\n");
+			return (-1);
+		}
+	}
+	DEBUG ("hostname_g = %s;", hostname_g);
+
+	str = global_option_get ("Interval");
+	if (str == NULL)
+		str = "10";
+	interval_g = atoi (str);
+	if (interval_g <= 0)
+	{
+		fprintf (stderr, "Cannot set the interval to a correct value.\n"
+				"Please check your settings.\n");
+		return (-1);
+	}
+	DEBUG ("interval_g = %i;", interval_g);
+
+	return (0);
+} /* int init_global_variables */
+
+static int change_basedir (const char *orig_dir)
 {
-	int dirlen = strlen (dir);
+	char *dir = strdup (orig_dir);
+	int dirlen;
+	int status;
+
+	if (dir == NULL)
+	{
+		char errbuf[1024];
+		ERROR ("strdup failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
+	}
 	
+	dirlen = strlen (dir);
 	while ((dirlen > 0) && (dir[dirlen - 1] == '/'))
 		dir[--dirlen] = '\0';
 
 	if (dirlen <= 0)
 		return (-1);
 
-	if (chdir (dir) == -1)
+	status = chdir (dir);
+	free (dir);
+
+	if (status != 0)
 	{
 		if (errno == ENOENT)
 		{
-			if (mkdir (dir, 0755) == -1)
+			if (mkdir (orig_dir, 0755) == -1)
 			{
-				syslog (LOG_ERR, "mkdir (%s): %s", dir, strerror (errno));
+				char errbuf[1024];
+				ERROR ("mkdir (%s): %s", orig_dir,
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
-			else if (chdir (dir) == -1)
+			else if (chdir (orig_dir) == -1)
 			{
-				syslog (LOG_ERR, "chdir (%s): %s", dir, strerror (errno));
+				char errbuf[1024];
+				ERROR ("chdir (%s): %s", orig_dir,
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 		}
 		else
 		{
-			syslog (LOG_ERR, "chdir: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("chdir (%s): %s", orig_dir,
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (-1);
 		}
 	}
 
 	return (0);
 } /* static int change_basedir (char *dir) */
@@ -89,25 +144,25 @@
 #if HAVE_LIBKSTAT
 static void update_kstat (void)
 {
 	if (kc == NULL)
 	{
 		if ((kc = kstat_open ()) == NULL)
-			syslog (LOG_ERR, "Unable to open kstat control structure");
+			ERROR ("Unable to open kstat control structure");
 	}
 	else
 	{
 		kid_t kid;
 		kid = kstat_chain_update (kc);
 		if (kid > 0)
 		{
-			syslog (LOG_INFO, "kstat chain has been updated");
+			INFO ("kstat chain has been updated");
 			plugin_init_all ();
 		}
 		else if (kid < 0)
-			syslog (LOG_ERR, "kstat chain update failed");
+			ERROR ("kstat chain update failed");
 		/* else: everything works as expected */
 	}
 
 	return;
 } /* static void update_kstat (void) */
 #endif /* HAVE_LIBKSTAT */
@@ -129,197 +184,159 @@
 			"    -f              Don't fork to the background.\n"
 #endif
 			"\nBuiltin defaults:\n"
 			"  Config-File       "CONFIGFILE"\n"
 			"  PID-File          "PIDFILE"\n"
 			"  Data-Directory    "PKGLOCALSTATEDIR"\n"
-#if COLLECT_DEBUG
-			"  Log-File          "LOGFILE"\n"
-#endif
-			"  Step              "COLLECTD_STEP" seconds\n"
-			"  Heartbeat         "COLLECTD_HEARTBEAT" seconds\n"
 			"\n"PACKAGE" "VERSION", http://collectd.org/\n"
 			"by Florian octo Forster <octo@verplant.org>\n"
 			"for contributions see `AUTHORS'\n");
 	exit (0);
 } /* static void exit_usage (char *name) */
 
-static int start_client (void)
+static int do_init (void)
 {
-	int step;
-
-	struct timeval tv_now;
-	struct timeval tv_next;
-	struct timespec ts_wait;
-
-	step = atoi (COLLECTD_STEP);
-	if (step <= 0)
-		step = 10;
-
 #if HAVE_LIBKSTAT
 	kc = NULL;
 	update_kstat ();
 #endif
 
 #if HAVE_LIBSTATGRAB
 	if (sg_init ())
 	{
-		syslog (LOG_ERR, "sg_init: %s", sg_str_error (sg_get_error ()));
+		ERROR ("sg_init: %s", sg_str_error (sg_get_error ()));
 		return (-1);
 	}
 
 	if (sg_drop_privileges ())
 	{
-		syslog (LOG_ERR, "sg_drop_privileges: %s", sg_str_error (sg_get_error ()));
+		ERROR ("sg_drop_privileges: %s", sg_str_error (sg_get_error ()));
 		return (-1);
 	}
 #endif
 
+	read_types_list ();
 	plugin_init_all ();
 
+	return (0);
+} /* int do_init () */
+
+
+static int do_loop (void)
+{
+	struct timeval tv_now;
+	struct timeval tv_next;
+	struct timespec ts_wait;
+
 	while (loop == 0)
 	{
 		if (gettimeofday (&tv_next, NULL) < 0)
 		{
-			syslog (LOG_ERR, "gettimeofday failed: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("gettimeofday failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (-1);
 		}
-		tv_next.tv_sec += step;
+		tv_next.tv_sec += interval_g;
 
 #if HAVE_LIBKSTAT
 		update_kstat ();
 #endif
-		/* `curtime' is used by many (all?) plugins as the
-		 * data-sample-time passed to RRDTool */
-		curtime = time (NULL);
 
 		/* Issue all plugins */
 		plugin_read_all (&loop);
 
 		if (gettimeofday (&tv_now, NULL) < 0)
 		{
-			syslog (LOG_ERR, "gettimeofday failed: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("gettimeofday failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (-1);
 		}
 
 		if (timeval_sub_timespec (&tv_next, &tv_now, &ts_wait) != 0)
 		{
-			syslog (LOG_WARNING, "Not sleeping because `timeval_sub_timespec' returned non-zero!");
+			WARNING ("Not sleeping because "
+					"`timeval_sub_timespec' returned "
+					"non-zero!");
 			continue;
 		}
 
 		while ((loop == 0) && (nanosleep (&ts_wait, &ts_wait) == -1))
 		{
 			if (errno != EINTR)
 			{
-				syslog (LOG_ERR, "nanosleep failed: %s", strerror (errno));
-				break;
+				char errbuf[1024];
+				ERROR ("nanosleep failed: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
+				return (-1);
 			}
 		}
-	}
+	} /* while (loop == 0) */
 
+	DEBUG ("return (0);");
 	return (0);
-} /* static int start_client (void) */
+} /* int do_loop */
 
-#if HAVE_LIBRRD
-static int start_server (void)
+static int do_shutdown (void)
 {
-	char *host;
-	char *type;
-	char *instance;
-	char *values;
-
-	int  error_counter = 0;
-	int  status;
-
-	while ((loop == 0) && (error_counter < 3))
-	{
-		status = network_receive (&host, &type, &instance, &values);
-
-		if (status != 0)
-		{
-			if (status < 0)
-				error_counter++;
-			continue;
-		}
-		error_counter = 0;
-
-		plugin_write (host, type, instance, values);
-
-		if (host     != NULL) free (host);     host     = NULL;
-		if (type     != NULL) free (type);     type     = NULL;
-		if (instance != NULL) free (instance); instance = NULL;
-		if (values   != NULL) free (values);   values   = NULL;
-	}
-	
+	plugin_shutdown_all ();
 	return (0);
-} /* static int start_server (void) */
-#endif /* HAVE_LIBRRD */
+} /* int do_shutdown */
 
 #if COLLECT_DAEMON
-static int pidfile_create (const char *file)
+static int pidfile_create (void)
 {
 	FILE *fh;
-
-	if (file == NULL)
-		file = PIDFILE;
+	const char *file = global_option_get ("PIDFile");
 
 	if ((fh = fopen (file, "w")) == NULL)
 	{
-		syslog (LOG_ERR, "fopen (%s): %s", file, strerror (errno));
+		char errbuf[1024];
+		ERROR ("fopen (%s): %s", file,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (1);
 	}
 
 	fprintf (fh, "%i\n", (int) getpid ());
 	fclose(fh);
 
 	return (0);
 } /* static int pidfile_create (const char *file) */
-#endif /* COLLECT_DAEMON */
 
-#if COLLECT_DAEMON
-static int pidfile_remove (const char *file)
+static int pidfile_remove (void)
 {
-	if (file == NULL) {
-		file = PIDFILE;
-	}
+	const char *file = global_option_get ("PIDFile");
+
+	DEBUG ("unlink (%s)", (file != NULL) ? file : "<null>");
 	return (unlink (file));
 } /* static int pidfile_remove (const char *file) */
 #endif /* COLLECT_DAEMON */
 
 int main (int argc, char **argv)
 {
 	struct sigaction sigIntAction;
 	struct sigaction sigTermAction;
-	char *datadir    = PKGLOCALSTATEDIR;
 	char *configfile = CONFIGFILE;
+	int test_config  = 0;
+	const char *basedir;
 #if COLLECT_DAEMON
 	struct sigaction sigChldAction;
-	char *pidfile    = NULL;
 	pid_t pid;
 	int daemonize    = 1;
 #endif
-#if COLLECT_DEBUG
-	char *logfile    = LOGFILE;
-#endif
-
-#if HAVE_LIBRRD
-	operating_mode = MODE_LOCAL;
-#else
-	operating_mode = MODE_CLIENT;
-#endif
-
-	/* open syslog */
-	openlog (PACKAGE, LOG_CONS | LOG_PID, LOG_DAEMON);
 
 	/* read options */
 	while (1)
 	{
 		int c;
 
-		c = getopt (argc, argv, "hC:"
+		c = getopt (argc, argv, "htC:"
 #if COLLECT_DAEMON
 				"fP:"
 #endif
 		);
 
 		if (c == -1)
@@ -327,31 +344,29 @@
 
 		switch (c)
 		{
 			case 'C':
 				configfile = optarg;
 				break;
+			case 't':
+				test_config = 1;
+				break;
 #if COLLECT_DAEMON
 			case 'P':
-				pidfile = optarg;
+				global_option_set ("PIDFile", optarg);
 				break;
 			case 'f':
 				daemonize = 0;
 				break;
 #endif /* COLLECT_DAEMON */
 			case 'h':
 			default:
 				exit_usage (argv[0]);
 		} /* switch (c) */
 	} /* while (1) */
 
-#if COLLECT_DEBUG
-	if ((logfile = cf_get_option ("LogFile", LOGFILE)) != NULL)
-		DBG_STARTFILE (logfile, "Debug file opened.");
-#endif
-
 	/*
 	 * Read options from the config file, the environment and the command
 	 * line (in that order, with later options overwriting previous ones in
 	 * general).
 	 * Also, this will automatically load modules.
 	 */
@@ -363,43 +378,52 @@
 	}
 
 	/*
 	 * Change directory. We do this _after_ reading the config and loading
 	 * modules to relative paths work as expected.
 	 */
-	if ((datadir = cf_get_option ("DataDir", PKGLOCALSTATEDIR)) == NULL)
+	if ((basedir = global_option_get ("BaseDir")) == NULL)
 	{
-		fprintf (stderr, "Don't have a datadir to use. This should not happen. Ever.");
+		fprintf (stderr, "Don't have a basedir to use. This should not happen. Ever.");
 		return (1);
 	}
-	if (change_basedir (datadir))
+	else if (change_basedir (basedir))
 	{
-		fprintf (stderr, "Error: Unable to change to directory `%s'.\n", datadir);
+		fprintf (stderr, "Error: Unable to change to directory `%s'.\n", basedir);
 		return (1);
 	}
 
+	/*
+	 * Set global variables or, if that failes, exit. We cannot run with
+	 * them being uninitialized. If nothing is configured, then defaults
+	 * are being used. So this means that the user has actually done
+	 * something wrong.
+	 */
+	if (init_global_variables () != 0)
+		return (1);
+
+	if (test_config)
+		return (0);
+
 #if COLLECT_DAEMON
 	/*
 	 * fork off child
 	 */
+	memset (&sigChldAction, '\0', sizeof (sigChldAction));
 	sigChldAction.sa_handler = SIG_IGN;
 	sigaction (SIGCHLD, &sigChldAction, NULL);
 
-	if ((pidfile == NULL)
-			&& ((pidfile = cf_get_option ("PIDFile", PIDFILE)) == NULL))
-	{
-		fprintf (stderr, "Cannot obtain pidfile. This shoud not happen. Ever.");
-		return (1);
-	}
-
 	if (daemonize)
 	{
 		if ((pid = fork ()) == -1)
 		{
 			/* error */
-			fprintf (stderr, "fork: %s", strerror (errno));
+			char errbuf[1024];
+			fprintf (stderr, "fork: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (1);
 		}
 		else if (pid != 0)
 		{
 			/* parent */
 			/* printf ("Running (PID %i)\n", pid); */
@@ -407,69 +431,61 @@
 		}
 
 		/* Detach from session */
 		setsid ();
 
 		/* Write pidfile */
-		if (pidfile_create (pidfile))
+		if (pidfile_create ())
 			exit (2);
 
 		/* close standard descriptors */
 		close (2);
 		close (1);
 		close (0);
 
 		if (open ("/dev/null", O_RDWR) != 0)
 		{
-			syslog (LOG_ERR, "Error: Could not connect `STDIN' to `/dev/null'");
+			ERROR ("Error: Could not connect `STDIN' to `/dev/null'");
 			return (1);
 		}
 		if (dup (0) != 1)
 		{
-			syslog (LOG_ERR, "Error: Could not connect `STDOUT' to `/dev/null'");
+			ERROR ("Error: Could not connect `STDOUT' to `/dev/null'");
 			return (1);
 		}
 		if (dup (0) != 2)
 		{
-			syslog (LOG_ERR, "Error: Could not connect `STDERR' to `/dev/null'");
+			ERROR ("Error: Could not connect `STDERR' to `/dev/null'");
 			return (1);
 		}
 	} /* if (daemonize) */
 #endif /* COLLECT_DAEMON */
 
 	/*
 	 * install signal handlers
 	 */
+	memset (&sigIntAction, '\0', sizeof (sigIntAction));
 	sigIntAction.sa_handler = sigIntHandler;
 	sigaction (SIGINT, &sigIntAction, NULL);
 
+	memset (&sigTermAction, '\0', sizeof (sigTermAction));
 	sigTermAction.sa_handler = sigTermHandler;
 	sigaction (SIGTERM, &sigTermAction, NULL);
 
 	/*
 	 * run the actual loops
 	 */
-#if HAVE_LIBRRD
-	if (operating_mode == MODE_SERVER)
-		start_server ();
-	else /* if (operating_mode == MODE_CLIENT || operating_mode == MODE_LOCAL || operating_mode == MODE_LOG) */
-#endif
-		start_client ();
-
-	plugin_shutdown_all ();
-
-#if COLLECT_DEBUG
-	if (logfile != NULL)
-		DBG_STOPFILE("debug file closed.");
-#endif
+	do_init ();
+	do_loop ();
 
 	/* close syslog */
-	syslog (LOG_INFO, "Exiting normally");
-	closelog ();
+	INFO ("Exiting normally");
+
+	do_shutdown ();
 
 #if COLLECT_DAEMON
 	if (daemonize)
-		pidfile_remove (pidfile);
+		pidfile_remove ();
 #endif /* COLLECT_DAEMON */
 
 	return (0);
-} /* int main (int argc, char **argv) */
+} /* int main */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.conf.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.conf.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.conf.5	2007-09-28 19:05:32.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.conf.5	2007-05-30 19:39:13.000000000 +0800
@@ -1,7 +1,7 @@
-.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.32
+.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.14
 .\"
 .\" Standard preamble:
 .\" ========================================================================
 .de Sh \" Subsection heading
 .br
 .if t .Sp
@@ -22,17 +22,17 @@
 .de Ve \" End verbatim text
 .ft R
 .fi
 ..
 .\" Set up some character translations and predefined strings.  \*(-- will
 .\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
-.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
-.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
-.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
-.\" nothing in troff, for use with C<>.
-.tr \(*W-
+.\" double quote, and \*(R" will give a right double quote.  | will give a
+.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
+.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
+.\" expand to `' in nroff, nothing in troff, for use with C<>.
+.tr \(*W-|\(bv\*(Tr
 .ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
 .ie n \{\
 .    ds -- \(*W-
 .    ds PI pi
 .    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
 .    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
@@ -126,115 +126,94 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD.CONF 5"
-.TH COLLECTD.CONF 5 "2007-09-28" "3.11.7" "collectd"
+.TH COLLECTD.CONF 5 "2007-05-30" "4.0.0-rc10" "collectd"
 .SH "NAME"
 collectd.conf \- Configuration for the system statistics collection daemon \fBcollectd\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
-.Vb 5
-\&  Mode    Client
-\&  DataDir /path/to/data/
-\&  PIDFile /path/to/pidfile/collectd.pid
-\&  LogFile /path/to/logfile/collectd.log
-\&  Server  123.123.123.123 12345
+.Vb 3
+\&  BaseDir "/path/to/data/"
+\&  PIDFile "/path/to/pidfile/collectd.pid"
+\&  Server  "123.123.123.123" 12345
 .Ve
 .PP
 .Vb 3
 \&  LoadPlugin cpu
 \&  LoadPlugin load
 \&  LoadPlugin ping
 .Ve
 .PP
 .Vb 4
 \&  <Plugin ping>
-\&    Host example.org
-\&    Host provider.net
+\&    Host "example.org"
+\&    Host "provider.net"
 \&  </Plugin>
 .Ve
 .SH "DESCRIPTION"
 .IX Header "DESCRIPTION"
 This config file controls how the system statistics collection daemon
-\&\fBcollectd\fR behaves. The most significant options are \fBMode\fR, which controlls
-if the daemon will act as client, server or will be independent in local mode,
-and \fBLoadPlugin\fR which controls which plugins to load.
+\&\fBcollectd\fR behaves. The most significant option is \fBLoadPlugin\fR, which
+controls which plugins to load. These plugins ultimately define collectd's
+behavior.
 .PP
 The syntax of this config file is similar to the config file of the famos
 \&\fBApache Webserver\fR. Each line containes either a key-value-pair or a
 section-start or \-end. Empty lines and everything after the hash-symbol `#' is
-ignored.
-.PP
-Please note that \fBthere is a bug\fR in the library used by collectd to read the
-configfile, that will lead to all lines with trailing whitespaces to be
-ignored. This problem has been solved in collectd\ 4.0 and later.
+ignored. Values are either string, enclosed in double\-quotes,
+(floating\-point\-)numbers or a boolean extression, i.\ e. either \fBtrue\fR or
+\&\fBfalse\fR. String containing of only alphanumeric characters and underscores do
+not need to be quoted.
 .SH "GLOBAL OPTIONS"
 .IX Header "GLOBAL OPTIONS"
-.IP "\fBMode\fR (\fBLocal\fR|\fBClient\fR|\fBServer\fR|\fBLog\fR)" 4
-.IX Item "Mode (Local|Client|Server|Log)"
-Sets the operating mode. See the section \fB\s-1MODES\s0\fR in \fIcollectd\fR\|(1) for a
-description. This option determines which other options are allowed. Defaults
-to \fBLocal\fR.
+.IP "\fBBaseDir\fR \fIDirectory\fR" 4
+.IX Item "BaseDir Directory"
+Sets the base directory. This is the directory beneath all RRD-files are
+created. Possibly more subdirectories are created. This is also the working
+directory for the daemon.
 .IP "\fBLoadPlugin\fR \fIPlugin\fR" 4
 .IX Item "LoadPlugin Plugin"
 Loads the plugin \fIPlugin\fR. There must be at least one such line or \fBcollectd\fR
-will be mostly useless. The names of the plugins are listed in \fIcollectd\fR\|(1).
+will be mostly useless.
 .IP "\fBPIDFile\fR \fIFile\fR" 4
 .IX Item "PIDFile File"
 Sets where to write the \s-1PID\s0 file to. This file is overwritten when it exists
 and deleted when the program ist stopped. Some init-scripts might override this
-setting using the \fB\-P\fR commandline option. Available in \fBall modes\fR.
-.IP "\fBDataDir\fR \fIDirectory\fR" 4
-.IX Item "DataDir Directory"
-Sets the data directory. This is the directory beneath all RRD-files are
-created. Possibly more subdirectories are created. This is also the working
-directory for the daemon. Available in \fBall modes\fR, though the \fBClient\fR mode
-won't write to this directory.
-.IP "\fBLogFile\fR \fIFile\fR" 4
-.IX Item "LogFile File"
-Sets the file to write debugging output to. This is only used if compiled with
-debugging enabled. It's ignored otherwise. Available in \fBall modes\fR.
-.IP "\fBListen\fR \fIHost\fR [\fIPort\fR]" 4
-.IX Item "Listen Host [Port]"
-.PD 0
-.IP "\fBServer\fR \fIHost\fR [\fIPort\fR]" 4
-.IX Item "Server Host [Port]"
-.PD
-In \fBclient mode\fR the \fBServer\fR statement sets the server to send datagrams to.
-The statement may occur multiple times to send each datagram to multiple
-destinations.
-.Sp
-In \fBserver mode\fR the \fBListen\fR statement sets the interfaces to bind to. When
-multiple statements are found the daemon will bind to multiple interfaces.
-.Sp
-The argument \fIHost\fR may be a hostname, an IPv4 address or an IPv6 address. If
-the argument is a multicast address the daemon will join that multicast group.
-.Sp
-If no \fBListen\fR statement is found the server tries join both, the IPv6
-multicast group and the IPv4 multicast group. If no \fBServer\fR statement is
-found the client will try to send data to the IPv6 multicast group first. If
-that failes the client will try the IPv4 multicast group.
-.Sp
-The default IPv6 multicast group is \f(CW\*(C`ff18::efc0:4a42\*(C'\fR. The default IPv4
-multicast group is \f(CW239.192.74.66\fR.
-.Sp
-The optional \fIPort\fR argument sets the port to use. It can either be given
-using a numeric port number or a service name. If the argument is omited the
-default port \fB25826\fR is assumed.
-.IP "\fBTimeToLive\fR \fI1\-255\fR" 4
-.IX Item "TimeToLive 1-255"
-Set the time-to-live of sent packets. This applies to all, unicast and
-multicast, and IPv4 and IPv6 packets. The default is to not change this value.
-That means that multicast packets will be sent with a \s-1TTL\s0 of \f(CW1\fR (one) on most
-operating systems.
+setting using the \fB\-P\fR commandline option.
+.IP "\fBPluginDir\fR \fIDirectory\fR" 4
+.IX Item "PluginDir Directory"
+Path to the plugins (shared objects) of collectd.
+.IP "\fBTypesDB\fR \fIFile\fR" 4
+.IX Item "TypesDB File"
+Set the file that contains the data-set descriptions.
+.IP "\fBInterval\fR \fISeconds\fR" 4
+.IX Item "Interval Seconds"
+Configures the interval in which to query the read plugins. Obviously smaller
+values lead to a higher system load produces by collectd, while higher values
+lead to more coarse statistics.
+.IP "\fBReadThreads\fR \fINum\fR" 4
+.IX Item "ReadThreads Num"
+Number of threads to start for reading plugins. The default value if \fB5\fR, but
+you may want to increase this if you have more than five plugins that take a
+long time to read. Mostly those are plugin that do network\-IO. Setting this to
+a value higher than the number of plugins you've loaded is totally useless.
 .SH "PLUGIN OPTIONS"
 .IX Header "PLUGIN OPTIONS"
 Some Plugins may register own options. These options must be inclosed in a
-\&\f(CW\*(C`Plugin\*(C'\fR\-Section. Which options exist depends on the plugin used:
+\&\f(CW\*(C`Plugin\*(C'\fR\-Section. Which options exist depends on the plugin used. Some plugins
+require external configuration, too. The \f(CW\*(C`apache plugin\*(C'\fR, for example,
+required \f(CW\*(C`mod_status\*(C'\fR to be configured in the webserver you're going to
+collect data from. These plugins are listed below as well, even if they don't
+require any configuration within collectd's configfile.
+.PP
+A list of all plugins and a short summary for each plugin can be found in the
+\&\fI\s-1README\s0\fR file shipped with the sourcecode and hopefully binary packets as
+well.
 .ie n .Sh "Plugin ""apache"""
 .el .Sh "Plugin \f(CWapache\fP"
 .IX Subsection "Plugin apache"
 To configure the \f(CW\*(C`apache\*(C'\fR\-plugin you first need to configure the Apache
 webserver correctly. The Apache-plugin \f(CW\*(C`mod_status\*(C'\fR needs to be loaded and
 working and the \f(CW\*(C`ExtendedStatus\*(C'\fR directive needs to be \fBenabled\fR. You can use
@@ -246,12 +225,16 @@
 \&    <Location /mod_status>
 \&      SetHandler server\-status
 \&    </Location>
 \&  </IfModule>
 .Ve
 .PP
+Since it's \f(CW\*(C`mod_status\*(C'\fR module is very similar to Apache's, \fBlighttpd\fR is
+also supported. It introduces a new field, called \f(CW\*(C`BusyServers\*(C'\fR, to count the
+number of currently connected clients. This field is also supported.
+.PP
 The following options are accepted by the \f(CW\*(C`apache\*(C'\fR\-plugin:
 .IP "\fB\s-1URL\s0\fR \fIhttp://host/mod_status?auto\fR" 4
 .IX Item "URL http://host/mod_status?auto"
 Sets the \s-1URL\s0 of the \f(CW\*(C`mod_status\*(C'\fR output. This needs to be the output generated
 by \f(CW\*(C`ExtendedStatus on\*(C'\fR and it needs to be the machine readable output
 generated by appending the \f(CW\*(C`?auto\*(C'\fR argument.
@@ -274,12 +257,27 @@
 Hostname of the host running \fBapcupsd\fR. Defaults to \fBlocalhost\fR. Please note
 that IPv6 support has been disabled unless someone can confirm or decline that
 \&\fBapcupsd\fR can handle it.
 .IP "\fBPort\fR \fIPort\fR" 4
 .IX Item "Port Port"
 TCP-Port to connect to. Defaults to \fB3551\fR.
+.ie n .Sh "Plugin ""cpufreq"""
+.el .Sh "Plugin \f(CWcpufreq\fP"
+.IX Subsection "Plugin cpufreq"
+This plugin doesn't have any options. It reads
+\&\fI/sys/devices/system/cpu/cpu0/cpufreq/scaling_cur_freq\fR (for the first \s-1CPU\s0
+installed) to get the current \s-1CPU\s0 frequency. If this file does not exist make
+sure \fBcpufreqd\fR (<http://cpufreqd.sourceforge.net/>) or a similar tool is
+installed and an \*(L"cpu governor\*(R" (that's a kernel module) is loaded.
+.ie n .Sh "Plugin ""csv"""
+.el .Sh "Plugin \f(CWcsv\fP"
+.IX Subsection "Plugin csv"
+.IP "\fBDataDir\fR \fIDirectory\fR" 4
+.IX Item "DataDir Directory"
+Set the directory to store RRD-files under. Per default RRD-files are generated
+beneath the daemon's working directory, i.\ e. the \fBBaseDir\fR.
 .ie n .Sh "Plugin ""df"""
 .el .Sh "Plugin \f(CWdf\fP"
 .IX Subsection "Plugin df"
 .IP "\fBDevice\fR \fIDevice\fR" 4
 .IX Item "Device Device"
 Select partitions based on the devicename.
@@ -322,42 +320,134 @@
 .IP "\fBMaxConns\fR \fINumber\fR" 4
 .IX Item "MaxConns Number"
 Sets the maximum number of connections that can be handled in parallel. Since
 this many threads will be started immediately setting this to a very high
 value will waste valuable resources. Defaults to \fB5\fR and will be forced to be
 at most \fB16384\fR to prevent typos and dumb mistakes.
+.ie n .Sh "Plugin ""exec"""
+.el .Sh "Plugin \f(CWexec\fP"
+.IX Subsection "Plugin exec"
+Please make sure to read \fIcollectd\-exec\fR\|(5) before using this plugin. It
+contains valueable information on when the executable is executed and the
+output that is expected from it.
+.IP "\fBExec\fR \fIUser\fR \fIExecutable\fR" 4
+.IX Item "Exec User Executable"
+Execute the executable \fIExecutable\fR as user \fIUser\fR.
 .ie n .Sh "Plugin ""hddtemp"""
 .el .Sh "Plugin \f(CWhddtemp\fP"
 .IX Subsection "Plugin hddtemp"
+To get values from \fBhddtemp\fR collectd connects to \fBlocalhost\fR (127.0.0.1),
+port \fB7634/tcp\fR. The \fBHost\fR and \fBPort\fR options can be used to change these
+default values, see below. \f(CW\*(C`hddtemp\*(C'\fR has to be running to work correctly. If
+\&\f(CW\*(C`hddtemp\*(C'\fR is not running timeouts may appear which may interfere with other
+statistics..
+.PP
+The \fBhddtemp\fR homepage can be found at
+<http://www.guzu.net/linux/hddtemp.php>.
 .IP "\fBHost\fR \fIHostname\fR" 4
 .IX Item "Host Hostname"
 Hostname to connect to. Defaults to \fB127.0.0.1\fR.
 .IP "\fBPort\fR \fIPort\fR" 4
 .IX Item "Port Port"
 TCP-Port to connect to. Defaults to \fB7634\fR.
+.ie n .Sh "Plugin ""interface"""
+.el .Sh "Plugin \f(CWinterface\fP"
+.IX Subsection "Plugin interface"
+.IP "\fBInterface\fR \fIInterface\fR" 4
+.IX Item "Interface Interface"
+Select this interface. By default these interfaces will then be collected. For
+a more detailed description see \fBIgnoreSelected\fR below.
+.IP "\fBIgnoreSelected\fR \fItrue\fR|\fIfalse\fR" 4
+.IX Item "IgnoreSelected true|false"
+If no configuration if given, the \fBtraffic\fR\-plugin will collect data from
+all interfaces. This may not be practical, especially for loopback\- and
+similar interfaces. Thus, you can use the \fBInterface\fR\-option to pick the
+interfaces you're interested in. Sometimes, however, it's easier/prefered
+to collect all interfaces \fIexcept\fR a few ones. This option enables you to
+do that: By setting \fBIgnoreSelected\fR to \fItrue\fR the effect of
+\&\fBInterface\fR is inversed: All selected interfaces are ignored and all
+other interfaces are collected.
+.ie n .Sh "Plugin ""iptables"""
+.el .Sh "Plugin \f(CWiptables\fP"
+.IX Subsection "Plugin iptables"
+.IP "\fBChain\fR \fITable\fR \fIChain\fR [\fIComment|Number\fR [\fIName\fR]]" 4
+.IX Item "Chain Table Chain [Comment|Number [Name]]"
+Select the rules to count. If only \fITable\fR and \fIChain\fR are given, this plugin
+will collect the counters of all rules which have a comment\-match. The comment
+is then used as type\-instance.
+.Sp
+If \fIComment\fR or \fINumber\fR is given, only the rule with the matching comment or
+the \fIn\fRth rule will be collected. Again, the comment (or the number) will be
+used as the type\-instance.
+.Sp
+If \fIName\fR is supplied, it will be used as the type-instance instead of the
+comment or the number.
+.ie n .Sh "Plugin ""irq"""
+.el .Sh "Plugin \f(CWirq\fP"
+.IX Subsection "Plugin irq"
+.IP "\fBIrq\fR \fIIrq\fR" 4
+.IX Item "Irq Irq"
+Select this irq. By default these irqs will then be collected. For a more
+detailed description see \fBIgnoreSelected\fR below.
+.IP "\fBIgnoreSelected\fR \fItrue\fR|\fIfalse\fR" 4
+.IX Item "IgnoreSelected true|false"
+If no configuration if given, the \fBirq\fR\-plugin will collect data from all
+irqs. This may not be practical, especially if no interrupts happen. Thus, you
+can use the \fBIrq\fR\-option to pick the interupt you're interested in.
+Sometimes, however, it's easier/prefered to collect all interupts \fIexcept\fR a
+few ones. This option enables you to do that: By setting \fBIgnoreSelected\fR to
+\&\fItrue\fR the effect of \fBIrq\fR is inversed: All selected interupts are ignored
+and all other interupts are collected.
+.ie n .Sh "Plugin ""logfile"""
+.el .Sh "Plugin \f(CWlogfile\fP"
+.IX Subsection "Plugin logfile"
+.IP "\fBLogLevel\fR \fBdebug|info|notice|warning|err\fR" 4
+.IX Item "LogLevel debug|info|notice|warning|err"
+Sets the log\-level. If, for example, set to \fBnotice\fR, then all events with
+severity \fBnotice\fR, \fBwarning\fR, or \fBerr\fR will be written to the logfile.
+.IP "\fBFile\fR \fIFile\fR" 4
+.IX Item "File File"
+Sets the file to write log messages to. The special strings \fBstdout\fR and
+\&\fBstderr\fR can be used to write to the standard output and standard error
+channels, respectively. This, of course, only makes much sense when collectd is
+running in foreground\- or non\-daemon\-mode.
 .ie n .Sh "Plugin ""mbmon"""
 .el .Sh "Plugin \f(CWmbmon\fP"
 .IX Subsection "Plugin mbmon"
+The \f(CW\*(C`mbmon plugin\*(C'\fR uses mbmon to retrieve temperature, voltage, etc.
+.PP
+Be default collectd connects to \fBlocalhost\fR (127.0.0.1), port \fB411/tcp\fR.  The
+\&\fBHost\fR and \fBPort\fR options can be used to change these values, see below.
+\&\f(CW\*(C`mbmon\*(C'\fR has to be running to work correctly. If \f(CW\*(C`mbmon\*(C'\fR is not running
+timeouts may appear which may interfere with other statistics..
+.PP
+\&\f(CW\*(C`mbmon\*(C'\fR must be run with the \-r option (\*(L"print \s-1TAG\s0 and Value format\*(R");
+Debian's \fI/etc/init.d/mbmon\fR script already does this, other people
+will need to ensure that this is the case.
 .IP "\fBHost\fR \fIHostname\fR" 4
 .IX Item "Host Hostname"
 Hostname to connect to. Defaults to \fB127.0.0.1\fR.
 .IP "\fBPort\fR \fIPort\fR" 4
 .IX Item "Port Port"
 TCP-Port to connect to. Defaults to \fB411\fR.
-.ie n .Sh "Plugin ""ntpd"""
-.el .Sh "Plugin \f(CWntpd\fP"
-.IX Subsection "Plugin ntpd"
-.IP "\fBHost\fR \fIHostname\fR" 4
-.IX Item "Host Hostname"
-Hostname of the host running \fBntpd\fR. Defaults to \fBlocalhost\fR.
-.IP "\fBPort\fR \fIPort\fR" 4
-.IX Item "Port Port"
-UDP-Port to connect to. Defaults to \fB123\fR.
 .ie n .Sh "Plugin ""mysql"""
 .el .Sh "Plugin \f(CWmysql\fP"
 .IX Subsection "Plugin mysql"
+The \f(CW\*(C`mysql plugin\*(C'\fR requires \fBmysqlclient\fR to be installed. It connects to the
+database when started and keeps the connection up as long as possible. When the
+connection is interrupted for whatever reason it will try to re\-connect. The
+plugin logs loud complaints in case anything goes wrong.
+.PP
+This plugin issues \f(CW\*(C`SHOW STATUS\*(C'\fR and evaluates \f(CW\*(C`Bytes_{received,sent}\*(C'\fR,
+\&\f(CW\*(C`Com_*\*(C'\fR and \f(CW\*(C`Handler_*\*(C'\fR which correspond to \fImysql_octets.rrd\fR,
+\&\fImysql_commands\-*.rrd\fR and \fImysql_handler\-*.rrd\fR. Also, the values of
+\&\f(CW\*(C`Qcache_*\*(C'\fR are put in \fImysql_qcache.rrd\fR and values of \f(CW\*(C`Threads_*\*(C'\fR are put
+in \fImysql_threads.rrd\fR. Please refer to the \fBMySQL reference manual\fR,
+\&\fI5.2.4. Server Status Variables\fR for an explanation of these values.
+.PP
+Use the following options to configure the plugin:
 .IP "\fBHost\fR \fIHostname\fR" 4
 .IX Item "Host Hostname"
 Hostname of the database server. Defaults to \fBlocalhost\fR.
 .IP "\fBUser\fR \fIUsername\fR" 4
 .IX Item "User Username"
 Username to use when connecting to the database.
@@ -365,94 +455,243 @@
 .IX Item "Password Password"
 Password needed to log into the database.
 .IP "\fBDatabase\fR \fIDatabase\fR" 4
 .IX Item "Database Database"
 Select this database. Defaults to \fIno database\fR which is a perfecly reasonable
 option for what this plugin does.
+.ie n .Sh "Plugin ""network"""
+.el .Sh "Plugin \f(CWnetwork\fP"
+.IX Subsection "Plugin network"
+.IP "\fBListen\fR \fIHost\fR [\fIPort\fR]" 4
+.IX Item "Listen Host [Port]"
+.PD 0
+.IP "\fBServer\fR \fIHost\fR [\fIPort\fR]" 4
+.IX Item "Server Host [Port]"
+.PD
+The \fBServer\fR statement sets the server to send datagrams \fBto\fR.  The statement
+may occur multiple times to send each datagram to multiple destinations.
+.Sp
+The \fBListen\fR statement sets the interfaces to bind to. When multiple
+statements are found the daemon will bind to multiple interfaces.
+.Sp
+The argument \fIHost\fR may be a hostname, an IPv4 address or an IPv6 address. If
+the argument is a multicast address the daemon will join that multicast group.
+.Sp
+If no \fBListen\fR statement is found the server tries join both, the default IPv6
+multicast group and the default IPv4 multicast group. If no \fBServer\fR statement
+is found the client will try to send data to the IPv6 multicast group first. If
+that failes the client will try the IPv4 multicast group.
+.Sp
+The default IPv6 multicast group is \f(CW\*(C`ff18::efc0:4a42\*(C'\fR. The default IPv4
+multicast group is \f(CW239.192.74.66\fR.
+.Sp
+The optional \fIPort\fR argument sets the port to use. It can either be given
+using a numeric port number or a service name. If the argument is omited the
+default port \fB25826\fR is assumed.
+.IP "\fBTimeToLive\fR \fI1\-255\fR" 4
+.IX Item "TimeToLive 1-255"
+Set the time-to-live of sent packets. This applies to all, unicast and
+multicast, and IPv4 and IPv6 packets. The default is to not change this value.
+That means that multicast packets will be sent with a \s-1TTL\s0 of \f(CW1\fR (one) on most
+operating systems.
+.IP "\fBForward\fR \fItrue|false\fR" 4
+.IX Item "Forward true|false"
+If set to \fItrue\fR, write packets that were received via the network plugin to
+the sending sockets. This should only be activated when the \fBListen\fR\- and
+\&\fBServer\fR\-statements differ. Otherwise packets may be send multiple times to
+the same multicast group. While this results in more network traffic than
+neccessary it's not a huge problem since the plugin has a duplicate detection,
+so the values will not loop.
+.IP "\fBCacheFlush\fR \fISeconds\fR" 4
+.IX Item "CacheFlush Seconds"
+For each host/plugin/type combination the \f(CW\*(C`network plugin\*(C'\fR caches the time of
+the last value being sent or received. Every \fISeconds\fR seconds the plugin
+searches and removes all entries that are older than \fISeconds\fR seconds, thus
+freeing the unused memory again. Since this process is somewhat expensive and
+normally doesn't do much, this value should not be too small. The default is
+1800 seconds, but setting this to 86400 seconds (one day) will not do much harm
+either.
+.ie n .Sh "Plugin ""ntpd"""
+.el .Sh "Plugin \f(CWntpd\fP"
+.IX Subsection "Plugin ntpd"
+.IP "\fBHost\fR \fIHostname\fR" 4
+.IX Item "Host Hostname"
+Hostname of the host running \fBntpd\fR. Defaults to \fBlocalhost\fR.
+.IP "\fBPort\fR \fIPort\fR" 4
+.IX Item "Port Port"
+UDP-Port to connect to. Defaults to \fB123\fR.
+.ie n .Sh "Plugin ""nut"""
+.el .Sh "Plugin \f(CWnut\fP"
+.IX Subsection "Plugin nut"
+.IP "\fB\s-1UPS\s0\fR \fIupsname\fR\fB@\fR\fIhostname\fR[\fB:\fR\fIport\fR]" 4
+.IX Item "UPS upsname@hostname[:port]"
+Add a \s-1UPS\s0 to collect data from. The format is identical to the one accepted by
+\&\fIupsc\fR\|(8).
+.ie n .Sh "Plugin ""perl"""
+.el .Sh "Plugin \f(CWperl\fP"
+.IX Subsection "Plugin perl"
+.IP "\fBLoadPlugin\fR \fIPlugin\fR" 4
+.IX Item "LoadPlugin Plugin"
+Loads the Perl plugin \fIPlugin\fR. This does basically the same as \fBuse\fR would
+do in a Perl program.
+.IP "\fBBaseName\fR \fIName\fR" 4
+.IX Item "BaseName Name"
+Prepends \fIName\fR\fB::\fR to all plugin names loaded after this option. This is
+provided for convenience to keep plugin names short.
+.IP "\fBIncludeDir\fR \fIDir\fR" 4
+.IX Item "IncludeDir Dir"
+Adds \fIDir\fR to the \fB@INC\fR array. This is the same as using the \fB\-IDir\fR
+command line option or \fBuse lib Dir\fR in the source code.
 .ie n .Sh "Plugin ""ping"""
 .el .Sh "Plugin \f(CWping\fP"
 .IX Subsection "Plugin ping"
 .IP "\fBHost\fR \fIIP-address\fR" 4
 .IX Item "Host IP-address"
 Host to ping periodically. This option may be repeated several times to ping
 multiple hosts.
 .IP "\fB\s-1TTL\s0\fR \fI0\-255\fR" 4
 .IX Item "TTL 0-255"
 Sets the Time-To-Live of generated \s-1ICMP\s0 packets.
+.ie n .Sh "Plugin ""processes"""
+.el .Sh "Plugin \f(CWprocesses\fP"
+.IX Subsection "Plugin processes"
+.IP "\fBProcess\fR \fIName\fR" 4
+.IX Item "Process Name"
+Select more detailed statistics of processes matching this name. The statistics
+collected for these selected processes are size of the resident segment size
+(\s-1RSS\s0), user\- and system-time used, number of processes and number of threads,
+and minor and major pagefaults.
+.ie n .Sh "Plugin ""rrdtool"""
+.el .Sh "Plugin \f(CWrrdtool\fP"
+.IX Subsection "Plugin rrdtool"
+You can use the settings \fBStepSize\fR, \fBHeartBeat\fR, \fBRRARows\fR, and \fB\s-1XFF\s0\fR to
+finetune your RRD\-files. Please read \fIrrdcreate\fR\|(1) if you encounter problems
+using these settings. If you don't want to dive into the depths of RRDTool, you
+can savely ignore these settings.
+.IP "\fBDataDir\fR \fIDirectory\fR" 4
+.IX Item "DataDir Directory"
+Set the directory to store CSV-files under. Per default CSV-files are generated
+beneath the daemon's working directory, i.\ e. the \fBBaseDir\fR.
+.IP "\fBStepSize\fR \fISeconds\fR" 4
+.IX Item "StepSize Seconds"
+Sets the stepsize of newly created RRD\-files. Ideally (and per default) this
+setting is identical to the global \fBInterval\fR\-option and should not be
+smaller. If unsure, don't set this option.
+.IP "\fBHeartBeat\fR \fISeconds\fR" 4
+.IX Item "HeartBeat Seconds"
+Sets the heartbeat of newly created RRD\-files. Ideally this setting is bigger
+than the \fBInterval\fR\-setting, by default it's twice the \fBInterval\fR\-setting. If
+unsure, don't set this option.
+.IP "\fBRRARows\fR \fINumRows\fR" 4
+.IX Item "RRARows NumRows"
+The \f(CW\*(C`rrdtool plugin\*(C'\fR calculates the number of PDPs per \s-1CDP\s0 based on the
+\&\fBStepSize\fR, this setting and a timespan. This plugin creates RRD-files with
+three times five RRAs, i. e. five RRAs with the CFs \fB\s-1MIN\s0\fR, \fB\s-1AVERAGE\s0\fR, and
+\&\fB\s-1MAX\s0\fR. The five RRAs are optimized for graphs covering one hour, one day, one
+week, one month, and one year.
+.Sp
+So for each timespan, it calculates how many PDPs need to be consolidated into
+one \s-1CDP\s0 by calculating:
+  number of PDPs = timespan / (stepsize * rrarows)
+.Sp
+Bottom line is, set this no smaller than the width of you graphs in pixels. The
+default is 1200.
+.IP "\fBRRATimespan\fR \fISeconds\fR" 4
+.IX Item "RRATimespan Seconds"
+Adds an RRA\-timespan, given in seconds. Use this option mulitple times to have
+more then one \s-1RRA\s0. If this option is never used, the built-in default of (3600,
+86400, 604800, 2678400, 31622400) is used.
+.Sp
+For more information on how RRA-sizes are calculated see \fBRRARows\fR above.
+.IP "\fB\s-1XFF\s0\fR \fIFactor\fR" 4
+.IX Item "XFF Factor"
+Set the \*(L"XFiles Factor\*(R". The default is 0.1. If unsure, don't set this option.
+.IP "\fBCacheFlush\fR \fISeconds\fR" 4
+.IX Item "CacheFlush Seconds"
+When the \f(CW\*(C`rrdtool plugin\*(C'\fR uses a cache (by setting \fBCacheTimeout\fR, see below)
+it writes all values for a certain RRD-file if the oldest value is older than
+(or equal to) the number of seconds specified. If some RRD-file is not updated
+anymore for some reason (the computer was shut down, the network is broken,
+etc.) some values may still be in the cache. If \fBCacheFlush\fR is set, then the
+entire cache is searched for entries older than \fBCacheTimeout\fR seconds and
+written to disk every \fISeconds\fR seconds. Since this is kind of expensive and
+does nothing under normal circumstances, this value should not be too small.
+900 seconds might be a good value, though setting this to 7200 seconds doesn't
+normally do much harm either.
+.IP "\fBCacheTimeout\fR \fISeconds\fR" 4
+.IX Item "CacheTimeout Seconds"
+If this option is set to a value greater than zero, the \f(CW\*(C`rrdtool plugin\*(C'\fR will
+save values in a cache, as described above. Writing multiple values at once
+reduces IO-operations and thus lessens the load produced by updating the files.
+The tradeoff is that the graphs kind of \*(L"drag behind\*(R" and that more memory is
+used.
 .ie n .Sh "Plugin ""sensors"""
 .el .Sh "Plugin \f(CWsensors\fP"
 .IX Subsection "Plugin sensors"
-.IP "\fBExtendedSensorNaming\fR \fItrue\fR|\fIfalse\fR" 4
-.IX Item "ExtendedSensorNaming true|false"
-If set to \fItrue\fR this option switches on the extended sensors and RRD-files
-naming. This option exists to preserve backwards compatibility. It is
-recommended that you set this option to \fItrue\fR. The default is \fIfalse\fR to
-maintain compatibility only.
-.Sp
-Sensors get names like \fIchip\-bus\-address/type\-feature\fR (e.g.
-\&\fIit8712\-isa\-0290/voltage\-in1\fR) and \s-1RRD\s0 files are therefore stored in a
-standalone directory inside the \fBDataDir\fR directory and get names like
-\&\fIlm_sensors\-chip\-bus\-address/type\-feature.rrd\fR (e.g.
-\&\fIlm_sensors\-it8712\-isa\-0290/voltage\-in1.rrd\fR).
-.Sp
-The \fBExtendedSensorNaming\fR option breaks the compatibility with previous
-sensors and \s-1RRD\s0 files naming and the place where RRDs are stored. If you turn
-it on, the plugin will create new \s-1RRD\s0 files in a standalone directory inside
-the \fBDataDir\fR directory and without previous history. You can rename ``old''
-RRD-files to preserve already collected statistics, because the file layout
-hasn't changed. If you have two chips of the same type, you need to use
-\&\fBExtendedSensorNaming\fR in order to collect information from both chips.
-.Sp
-If not set or set to \fIfalse\fR, the extended naming is not active. Sensors get
-names like \fIchip-feature\fR (e.g. \fIit8712\-in1\fR) and \s-1RRD\s0 files are stored in the
-main \fBDataDir\fR directory and get names like \fIsensors\-chip\-feature.rrd\fR (e.g.
-\&\fIsensors\-it8712\-in1.rrd\fR).  You simply continue using the plugin the old way
-and additionally also getting data for newly added sensors in this mode.
-.IP "\fBSensor\fR \fIchip-feature\fR or \fBSensor\fR \fIchip\-bus\-address/type\-feature\fR" 4
-.IX Item "Sensor chip-feature or Sensor chip-bus-address/type-feature"
-Both option modes select the name of the sensor which you want to collect.
-The naming scheme is dependent on the state of the \fBExtendedSensorNaming\fR
-option (see previous option). Both option modes can also deselect the
-sensor according to the \fBIgnoreSelected\fR option (see below).
-.Sp
-For example the option "\fBSensor\fR \fIit8712\-in1\fR" will cause the collectd
-to gather data for the voltage sensor \fIin1\fR of the \fIit8712\fR chip in case
-of the \fBExtendedSensorNaming\fR option is set to \fIfalse\fR.
-.Sp
-And likewise the option "\fBSensor\fR \fIit8712\-isa\-0290/voltage\-in1\fR" will
-cause the collectd to gather data for the voltage sensor \fIin1\fR of the \fIit8712\fR
-on the isa bus at the address 0290 in case of the \fBExtendedSensorNaming\fR
-option set to \fItrue\fR.
-.IP "\fBIgnoreSelected\fR \fItrue\fR|\fIfalse\fR" 4
-.IX Item "IgnoreSelected true|false"
-If no configuration if given, the \fBsensors\fR\-plugin will collect data from
-all sensors. This may not be practical, especially for uninteresting sensors.
-Thus, you can use the \fBSensor\fR\-option to pick the sensors you're
-interested in. Sometimes, however, it's easier/prefered to collect all
-sensors \fIexcept\fR a few ones. This option enables you to
-do that: By setting \fBIgnoreSelected\fR to \fItrue\fR the effect of
-\&\fBSensor\fR is inversed: All selected sensors are ignored and all
-other sensors are collected.
-.Sp
-back
-.ie n .Sh "Plugin ""traffic"""
-.el .Sh "Plugin \f(CWtraffic\fP"
-.IX Subsection "Plugin traffic"
-.IP "\fBInterface\fR \fIInterface\fR" 4
-.IX Item "Interface Interface"
-Select this interface. By default these interfaces will then be collected. For a more detailed description see \fBIgnoreSelected\fR below.
+The \f(CW\*(C`sensors plugin\*(C'\fR uses \fBlm_sensors\fR to retrieve sensor\-values. This means
+that all the needed modules have to be loaded and lm_sensors has to be
+configured (most likely by editing \fI/etc/sensors.conf\fR. Read
+\&\fIsensors.conf\fR\|(5) for details.
+.PP
+The \fBlm_sensors\fR homepage can be found at
+<http://secure.netroedge.com/~lm78/>.
+.IP "\fBSensor\fR \fIchip\-bus\-address/type\-feature\fR" 4
+.IX Item "Sensor chip-bus-address/type-feature"
+Selects the name of the sensor which you want to collect or ignore, depending
+on the \fBIgnoreSelected\fR below. For example, the option "\fBSensor\fR
+\&\fIit8712\-isa\-0290/voltage\-in1\fR" will cause collectd to gather data for the
+voltage sensor \fIin1\fR of the \fIit8712\fR on the isa bus at the address 0290.
 .IP "\fBIgnoreSelected\fR \fItrue\fR|\fIfalse\fR" 4
 .IX Item "IgnoreSelected true|false"
-If no configuration if given, the \fBtraffic\fR\-plugin will collect data from
-all interfaces. This may not be practical, especially for loopback\- and
-similar interfaces. Thus, you can use the \fBInterface\fR\-option to pick the
-interfaces you're interested in. Sometimes, however, it's easier/prefered
-to collect all interfaces \fIexcept\fR a few ones. This option enables you to
-do that: By setting \fBIgnoreSelected\fR to \fItrue\fR the effect of
-\&\fBInterface\fR is inversed: All selected interfaces are ignored and all
-other interfaces are collected.
+If no configuration if given, the \fBsensors\fR\-plugin will collect data from all
+sensors. This may not be practical, especially for uninteresting sensors.
+Thus, you can use the \fBSensor\fR\-option to pick the sensors you're interested
+in. Sometimes, however, it's easier/prefered to collect all sensors \fIexcept\fR a
+few ones. This option enables you to do that: By setting \fBIgnoreSelected\fR to
+\&\fItrue\fR the effect of \fBSensor\fR is inversed: All selected sensors are ignored
+and all other sensors are collected.
+.ie n .Sh "Plugin ""syslog"""
+.el .Sh "Plugin \f(CWsyslog\fP"
+.IX Subsection "Plugin syslog"
+.IP "\fBLogLevel\fR \fBdebug|info|notice|warning|err\fR" 4
+.IX Item "LogLevel debug|info|notice|warning|err"
+Sets the log\-level. If, for example, set to \fBnotice\fR, then all events with
+severity \fBnotice\fR, \fBwarning\fR, or \fBerr\fR will be submitted to the
+syslog\-daemon.
+.ie n .Sh "Plugin ""unixsock"""
+.el .Sh "Plugin \f(CWunixsock\fP"
+.IX Subsection "Plugin unixsock"
+.IP "\fBSocketFile\fR \fIPath\fR" 4
+.IX Item "SocketFile Path"
+Sets the socket-file which is to be created.
+.IP "\fBSocketGroup\fR \fIGroup\fR" 4
+.IX Item "SocketGroup Group"
+If running as root change the group of the UNIX-socket after it has been 
+created. Defaults to \fBcollectd\fR.
+.IP "\fBSocketPerms\fR \fIPermissions\fR" 4
+.IX Item "SocketPerms Permissions"
+Change the file permissions of the UNIX-socket after it has been created. The
+permissions must be given as a numeric, octal value as you would pass to
+\&\fIchmod\fR\|(1). Defaults to \fB0770\fR.
+.ie n .Sh "Plugin ""vserver"""
+.el .Sh "Plugin \f(CWvserver\fP"
+.IX Subsection "Plugin vserver"
+This plugin doesn't have any options. \fBVServer\fR support is only available for
+Linux. It cannot yet be found in a vanilla kernel, though. To make use of this
+plugin you need a kernel that has \fBVServer\fR support built in, i.\ e. you
+need to apply the patches and compile your own kernel, which will then provide
+the \fI/proc/virtual\fR filesystem that is required by this plugin.
+.PP
+The \fBVServer\fR homepage can be found at <http://linux\-vserver.org/>.
 .SH "SEE ALSO"
 .IX Header "SEE ALSO"
-\&\fIcollectd\fR\|(1)
+\&\fIcollectd\fR\|(1),
+\&\fIcollectd\-exec\fR\|(5),
+\&\fIcollectd\-unixsock\fR\|(5),
+\&\fIhddtemp\fR\|(8),
+kstat(3KSTAT),
+\&\fImbmon\fR\|(1),
+\&\fIrrdtool\fR\|(1),
+\&\fIsensors\fR\|(1)
 .SH "AUTHOR"
 .IX Header "AUTHOR"
 Florian Forster <octo@verplant.org>
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.conf.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.conf.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.conf.in	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.conf.in	2007-05-30 18:33:14.000000000 +0800
@@ -1,118 +1,191 @@
 #
 # Config file for collectd(1).
 # Please read collectd.conf(5) for a list of options.
 # http://collectd.org/
 #
 
-# Select one of the following modes:
-@BUILD_WITH_RRDTOOL_TRUE@Mode Local
-#Mode Server
-@BUILD_WITH_RRDTOOL_FALSE@Mode Client
-#Mode Log
-
-# Set the IP-address(es) and UDP-port(s) to send packets to. `Listen' can be
-# used as a synonym for `Server' to make the config file more readable when in
-# server mode. The port option is optional.
-#Server ff18::efc0:4a42 25826
-#Server 239.192.74.66 25826
-
-#DataDir   /opt/collectd/var/lib/collectd
-#PIDFile   /opt/collectd/var/run/collectd.pid
-#PluginDir /opt/collectd/lib/collectd
+#Hostname    "localhost"
+#BaseDir     "@prefix@/var/lib/@PACKAGE_NAME@"
+#PIDFile     "@prefix@/var/run/@PACKAGE_NAME@.pid"
+#PluginDir   "@prefix@/lib/@PACKAGE_NAME@"
+#TypesDB     "@prefix@/lib/@PACKAGE_NAME@/types.db"
+#Interval     10
+#ReadThreads  5
 
 @BUILD_MODULE_APACHE_TRUE@LoadPlugin apache
 @BUILD_MODULE_APCUPS_TRUE@LoadPlugin apcups
 @BUILD_MODULE_APPLE_SENSORS_TRUE@LoadPlugin apple_sensors
 @BUILD_MODULE_BATTERY_TRUE@LoadPlugin battery
 @BUILD_MODULE_CPU_TRUE@LoadPlugin cpu
 @BUILD_MODULE_CPUFREQ_TRUE@LoadPlugin cpufreq
+@BUILD_MODULE_CSV_TRUE@LoadPlugin csv
 @BUILD_MODULE_DF_TRUE@LoadPlugin df
 @BUILD_MODULE_DISK_TRUE@LoadPlugin disk
 @BUILD_MODULE_DNS_TRUE@LoadPlugin dns
+@BUILD_MODULE_EMAIL_TRUE@LoadPlugin email
+@BUILD_MODULE_ENTROPY_TRUE@LoadPlugin entropy
+@BUILD_MODULE_EXEC_TRUE@LoadPlugin exec
 @BUILD_MODULE_HDDTEMP_TRUE@LoadPlugin hddtemp
+@BUILD_MODULE_INTERFACE_TRUE@LoadPlugin interface
+@BUILD_MODULE_IPTABLES_TRUE@LoadPlugin iptables
+@BUILD_MODULE_IRQ_TRUE@LoadPlugin irq
 @BUILD_MODULE_LOAD_TRUE@LoadPlugin load
+@BUILD_MODULE_LOGFILE_TRUE@LoadPlugin logfile
 @BUILD_MODULE_MBMON_TRUE@LoadPlugin mbmon
 @BUILD_MODULE_MEMORY_TRUE@LoadPlugin memory
 @BUILD_MODULE_MULTIMETER_TRUE@LoadPlugin multimeter
 @BUILD_MODULE_MYSQL_TRUE@LoadPlugin mysql
+@BUILD_MODULE_NETWORK_TRUE@LoadPlugin network
 @BUILD_MODULE_NFS_TRUE@LoadPlugin nfs
 @BUILD_MODULE_NTPD_TRUE@LoadPlugin ntpd
+@BUILD_MODULE_NUT_TRUE@LoadPlugin nut
+@BUILD_MODULE_PERL_TRUE@LoadPlugin perl
 @BUILD_MODULE_PING_TRUE@LoadPlugin ping
 @BUILD_MODULE_PROCESSES_TRUE@LoadPlugin processes
+@BUILD_WITH_RRDTOOL_TRUE@LoadPlugin rrdtool
 @BUILD_MODULE_SENSORS_TRUE@LoadPlugin sensors
 @BUILD_MODULE_SERIAL_TRUE@LoadPlugin serial
 @BUILD_MODULE_SWAP_TRUE@LoadPlugin swap
+@BUILD_MODULE_SYSLOG_TRUE@LoadPlugin syslog
 @BUILD_MODULE_TAPE_TRUE@LoadPlugin tape
-@BUILD_MODULE_TRAFFIC_TRUE@LoadPlugin traffic
+@BUILD_MODULE_UNIXSOCK_TRUE@LoadPlugin unixsock
 @BUILD_MODULE_USERS_TRUE@LoadPlugin users
 @BUILD_MODULE_VSERVER_TRUE@LoadPlugin vserver
 @BUILD_MODULE_WIRELESS_TRUE@LoadPlugin wireless
 
 #<Plugin apache>
-#	URL http://localhost/status?auto
-#	User www-user
-#	Password secret
-#	CACert /etc/ssl/ca.crt
+#	URL "http://localhost/status?auto"
+#	User "www-user"
+#	Password "secret"
+#	CACert "/etc/ssl/ca.crt"
 #</Plugin>
 
 #<Plugin apcups>
-#	Host localhost
-#	Port 3551
+#	Host "localhost"
+#	Port "3551"
+#</Plugin>
+
+#<Plugin csv>
+#	DataDir "@prefix@/var/lib/@PACKAGE_NAME@/csv"
+#</Plugin>
+
+#<Plugin df>
+#	Device "/dev/hda1"
+#	Device "192.168.0.2:/mnt/nfs"
+#	MountPoint "/home"
+#	FSType "ext3"
+#	IgnoreSelected false
 #</Plugin>
 
 #<Plugin dns>
-#	Interface eth0
-#	IgnoreSource 192.168.0.1
+#	Interface "eth0"
+#	IgnoreSource "192.168.0.1"
+#</Plugin>
+
+#<Plugin email>
+#	SocketGroup "collectd"
+#	SocketPerms "0770"
+#	MaxConns 5
+#</Plugin>
+
+#<Plugin exec>
+#	Exec user "/path/to/exec"
 #</Plugin>
 
 #<Plugin hddtemp>
-#	Host 127.0.0.1
+#	Host "127.0.0.1"
 #	Port 7634
 #</Plugin>
 
+#<Plugin interface>
+#	Interface "eth0"
+#	IgnoreSelected false
+#</Plugin>
+
+#<Plugin iptables>
+#	Chain table chain
+#</Plugin>
+
+#<Plugin irq>
+#	Irq 7
+#	Irq 8
+#	Irq 9
+#	IgnoreSelected true
+#</Plugin>
+
+#<Plugin logfile>
+#	LogLevel info
+#	File STDOUT
+#</Plugin>
+
 #<Plugin mbmon>
-#	Host 127.0.0.1
+#	Host "127.0.0.1"
 #	Port 411
 #</Plugin>
 
+#<Plugin mysql>
+#	Host "database.serv.er"
+#	User "db_user"
+#	Password "secret"
+#	Database "db_name"
+#</Plugin>
+
+#<Plugin network>
+#	Server "ff18::efc0:4a42" "25826"
+#	Server "239.192.74.66" "25826"
+#	Listen "ff18::efc0:4a42" "25826"
+#	Listen "239.192.74.66" "25826"
+#	TimeToLive "128"
+#	Forward false
+#	CacheFlush 1800
+#</Plugin>
+
 #<Plugin ntpd>
-#	Host localhost
+#	Host "localhost"
 #	Port 123
 #</Plugin>
 
-#<Plugin mysql>
-#	Host database.serv.er
-#	User db_user
-#	Password secret
-#	Database db_name
+#<Plugin nut>
+#	UPS "upsname@hostname:port"
+#</Plugin>
+
+#<Plugin perl>
+#	IncludeDir "/my/include/path"
+#	BaseName "Collectd::Plugin"
+#	LoadPlugin foo
 #</Plugin>
 
 #<Plugin ping>
-#	Host host.foo.bar
+#	Host "host.foo.bar"
 #</Plugin>
 
 #<Plugin processes>
-#	Process name
+#	Process "name"
+#</Plugin>
+
+#<Plugin rrdtool>
+#	DataDir "@prefix@/var/lib/@PACKAGE_NAME@/rrd"
+#	StepSize      10
+#	HeartBeat     20
+#	RRARows     1200
+#	XFF            0.1
+#	CacheTimeout 120
+#	CacheFlush   900
 #</Plugin>
 
-## There are two different naming schemes for the sensors plugin, to preserver
-## backwards compatibility. The `extended naming' is prefered, but not the
-## default for this reason. See `collectd.conf(5)' for more information.
 #<Plugin sensors>
-#	ExtendedSensorNaming false
-#	Sensor it8712-temp1
-#	Sensor it8712-fan3
-#	Sensor it8712-in8
-## -- OR --
-#	ExtendedSensorNaming true
-#	Sensor it8712-isa-0290/temperature-temp1
-#	Sensor it8712-isa-0290/fanspeed-fan3
-#	Sensor it8712-isa-0290/voltage-in8
-#
+#	Sensor "it8712-isa-0290/temperature-temp1"
+#	Sensor "it8712-isa-0290/fanspeed-fan3"
+#	Sensor "it8712-isa-0290/voltage-in8"
 #	IgnoreSelected false
 #</Plugin>
 
-#<Plugin traffic>
-#	Interface eth0
-#	IgnoreSelected false
+#<Plugin syslog>
+#	LogLevel info
+#</Plugin>
+
+#<Plugin unixsock>
+#	SocketFile "@prefix@/var/run/@PACKAGE_NAME@-unixsock"
+#	SocketGroup "collectd"
+#	SocketPerms "0660"
 #</Plugin>
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-email.5
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-exec.5
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/collectd.h	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/collectd.h	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/collectd.h
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -75,15 +74,12 @@
 #if HAVE_FCNTL_H
 # include <fcntl.h>
 #endif
 #if HAVE_ERRNO_H
 # include <errno.h>
 #endif
-#if HAVE_SYSLOG_H
-# include <syslog.h>
-#endif
 #if HAVE_LIMITS_H
 # include <limits.h>
 #endif
 #if TIME_WITH_SYS_TIME
 # include <sys/time.h>
 # include <time.h>
@@ -98,12 +94,37 @@
 #if HAVE_ASSERT_H
 # include <assert.h>
 #else
 # define assert(...) /* nop */
 #endif
 
+#if NAN_STATIC_DEFAULT
+# include <math.h>
+/* #endif NAN_STATIC_DEFAULT*/
+#elif NAN_STATIC_ISOC
+# ifndef __USE_ISOC99
+#  define DISABLE_ISOC99 1
+#  define __USE_ISOC99 1
+# endif /* !defined(__USE_ISOC99) */
+# include <math.h>
+# if DISABLE_ISOC99
+#  undef DISABLE_ISOC99
+#  undef __USE_ISOC99
+# endif /* DISABLE_ISOC99 */
+/* #endif NAN_STATIC_ISOC */
+#elif NAN_ZERO_ZERO
+# include <math.h>
+# ifdef NAN
+#  undef NAN
+# endif
+# define NAN (0.0 / 0.0)
+# ifndef isnan
+#  define isnan(f) ((f) != (f))
+# endif /* !defined(isnan) */
+#endif /* NAN_ZERO_ZERO */
+
 #if HAVE_DIRENT_H
 # include <dirent.h>
 # define NAMLEN(dirent) strlen((dirent)->d_name)
 #else
 # define dirent direct
 # define NAMLEN(dirent) (dirent)->d_namlen
@@ -125,18 +146,12 @@
 # include <ctype.h>
 #endif
 #if HAVE_SYS_PARAM_H
 # include <sys/param.h>
 #endif
 
-#if !HAVE_SYSLOG
-# define syslog(...) /**/
-# define openlog(...) /**/
-# define closelog(...) /**/
-#endif
-
 #if HAVE_KSTAT_H
 # include <kstat.h>
 #endif
 
 #if HAVE_RRD_H
 # include <rrd.h>
@@ -172,16 +187,12 @@
 #endif
 
 #ifndef PIDFILE
 #define PIDFILE PREFIX "/var/run/" PACKAGE_NAME ".pid"
 #endif
 
-#ifndef LOGFILE
-#define LOGFILE PREFIX"/var/log/"PACKAGE_NAME"/"PACKAGE_NAME".log"
-#endif
-
 #ifndef PLUGINDIR
 #define PLUGINDIR PREFIX "/lib/" PACKAGE_NAME
 #endif
 
 #define MODE_SERVER 0x01
 #define MODE_CLIENT 0x02
@@ -189,31 +200,12 @@
 #define MODE_LOG    0x08
 
 #ifndef COLLECTD_GRP_NAME
 # define COLLECTD_GRP_NAME "collectd"
 #endif
 
-#ifndef COLLECTD_STEP
-#  define COLLECTD_STEP "10"
-#endif
-
-#ifndef COLLECTD_HEARTBEAT
-#  define COLLECTD_HEARTBEAT "25"
-#endif
-
-#ifndef COLLECTD_ROWS
-#  define COLLECTD_ROWS "1200"
-#endif
-
-#ifndef COLLECTD_XFF
-#  define COLLECTD_XFF 0.1
-#endif
-
-extern time_t curtime;
-
-#ifdef HAVE_LIBRRD
-extern int operating_mode;
-#endif
+#define STATIC_ARRAY_LEN(array) (sizeof (array) / sizeof ((array)[0]))
 
-/* int main (int argc, char **argv); */
+extern char hostname_g[];
+extern int  interval_g;
 
 #endif /* COLLECTD_H */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-nagios.1
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-nagios.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-perl.5
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: collectd-unixsock.5
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/common.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/common.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/common.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/common.c	2007-06-04 01:06:01.000000000 +0800
@@ -1,89 +1,48 @@
 /**
  * collectd - src/common.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
- * This program is free software; you can redistribute it and/
- * or modify it under the terms of the GNU General Public Li-
- * cence as published by the Free Software Foundation; either
- * version 2 of the Licence, or any later version.
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
- * This program is distributed in the hope that it will be use-
- * ful, but WITHOUT ANY WARRANTY; without even the implied war-
- * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- * See the GNU General Public Licence for more details.
+ * This program is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * General Public License for more details.
  *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  *   Niki W. Waibel <niki.waibel@gmx.net>
 **/
 
 #if HAVE_CONFIG_H
 # include "config.h"
 #endif
 
 #include "common.h"
-#include "utils_debug.h"
+#include "plugin.h"
 
 #ifdef HAVE_MATH_H
 #  include <math.h>
 #endif
 
-extern int operating_mode;
+/* for ntohl and htonl */
+#if HAVE_ARPA_INET_H
+# include <arpa/inet.h>
+#endif
 
 #ifdef HAVE_LIBKSTAT
 extern kstat_ctl_t *kc;
 #endif
 
-#ifdef HAVE_LIBRRD
-#if 0
-static char *rra_def[] =
-{
-		"RRA:AVERAGE:0.0:1:1500",
-		"RRA:AVERAGE:0.2:6:1500",
-		"RRA:AVERAGE:0.1:180:1680",
-		"RRA:AVERAGE:0.1:2160:1520",
-		"RRA:MIN:0.0:1:1500",
-		"RRA:MIN:0.2:6:1500",
-		"RRA:MIN:0.1:180:1680",
-		"RRA:MIN:0.1:2160:1520",
-		"RRA:MAX:0.0:1:1500",
-		"RRA:MAX:0.2:6:1500",
-		"RRA:MAX:0.1:180:1680",
-		"RRA:MAX:0.1:2160:1520",
-		NULL
-};
-static int rra_num = 12;
-#endif
-
-static int rra_timespans[] =
-{
-	3600,
-	86400,
-	604800,
-	2678400,
-	31622400,
-	0
-};
-static int rra_timespans_num = 5;
-
-static char *rra_types[] =
-{
-	"AVERAGE",
-	"MIN",
-	"MAX",
-	NULL
-};
-static int rra_types_num = 3;
-#endif /* HAVE_LIBRRD */
-
 void sstrncpy (char *d, const char *s, int len)
 {
 	strncpy (d, s, len);
 	d[len - 1] = '\0';
 }
 
@@ -93,26 +52,35 @@
 
 	if (s == NULL)
 		return (NULL);
 
 	if((r = strdup (s)) == NULL)
 	{
-		DBG ("Not enough memory.");
+		DEBUG ("Not enough memory.");
 		exit(3);
 	}
 
 	return (r);
 }
 
+/* Don't use the return value of `strerror_r', because the GNU-people got
+ * inventive there.. -octo */
+char *sstrerror (int errnum, char *buf, size_t buflen)
+{
+	buf[0] = '\0';
+	strerror_r (errnum, buf, buflen);
+	return (buf);
+} /* char *sstrerror */
+
 void *smalloc (size_t size)
 {
 	void *r;
 
 	if ((r = malloc (size)) == NULL)
 	{
-		DBG("Not enough memory.");
+		DEBUG("Not enough memory.");
 		exit(3);
 	}
 
 	return r;
 }
 
@@ -147,13 +115,13 @@
 
 		if (status < 0)
 			return (status);
 
 		if (status == 0)
 		{
-			DBG ("Received EOF from fd %i. "
+			DEBUG ("Received EOF from fd %i. "
 					"Closing fd and returning error.",
 					fd);
 			close (fd);
 			return (-1);
 		}
 
@@ -194,16 +162,18 @@
 }
 
 int strsplit (char *string, char **fields, size_t size)
 {
 	size_t i;
 	char *ptr;
+	char *saveptr;
 
 	i = 0;
 	ptr = string;
-	while ((fields[i] = strtok (ptr, " \t")) != NULL)
+	saveptr = NULL;
+	while ((fields[i] = strtok_r (ptr, " \t", &saveptr)) != NULL)
 	{
 		ptr = NULL;
 		i++;
 
 		if (i >= size)
 			break;
@@ -268,13 +238,13 @@
 			ret++;
 		}
 		str++;
 	}
 
 	return (ret);
-}
+} /* int strsubstitute */
 
 int escape_slashes (char *buf, int buf_len)
 {
 	int i;
 
 	if (strcmp (buf, "/") == 0)
@@ -283,26 +253,30 @@
 			return (-1);
 
 		strncpy (buf, "root", buf_len);
 		return (0);
 	}
 
+	if (buf_len <= 1)
+		return (0);
+
 	/* Move one to the left */
-	memmove (buf, buf + 1, buf_len - 1);
+	if (buf[0] == '/')
+		memmove (buf, buf + 1, buf_len - 1);
 
 	for (i = 0; i < buf_len - 1; i++)
 	{
 		if (buf[i] == '\0')
 			break;
 		else if (buf[i] == '/')
 			buf[i] = '_';
 	}
 	buf[i] = '\0';
 
 	return (0);
-}
+} /* int escape_slashes */
 
 int timeval_sub_timespec (struct timeval *tv0, struct timeval *tv1, struct timespec *ret)
 {
 	if ((tv0 == NULL) || (tv1 == NULL) || (ret == NULL))
 		return (-2);
 
@@ -321,23 +295,25 @@
 		ret->tv_sec  -= 1;
 	}
 
 	return (0);
 }
 
-static int check_create_dir (const char *file_orig)
+int check_create_dir (const char *file_orig)
 {
 	struct stat statbuf;
 
 	char  file_copy[512];
 	char  dir[512];
 	int   dir_len = 512;
 	char *fields[16];
 	int   fields_num;
 	char *ptr;
+	char *saveptr;
 	int   last_is_file = 1;
+	int   path_is_absolute = 0;
 	int   len;
 	int   i;
 
 	/*
 	 * Sanity checks first
 	 */
@@ -352,26 +328,29 @@
 	/*
 	 * If `file_orig' ends in a slash the last component is a directory,
 	 * otherwise it's a file. Act accordingly..
 	 */
 	if (file_orig[len - 1] == '/')
 		last_is_file = 0;
+	if (file_orig[0] == '/')
+		path_is_absolute = 1;
 
 	/*
-	 * Create a copy for `strtok' to destroy
+	 * Create a copy for `strtok_r' to destroy
 	 */
 	strncpy (file_copy, file_orig, 512);
 	file_copy[511] = '\0';
 
 	/*
 	 * Break into components. This will eat up several slashes in a row and
 	 * remove leading and trailing slashes..
 	 */
 	ptr = file_copy;
+	saveptr = NULL;
 	fields_num = 0;
-	while ((fields[fields_num] = strtok (ptr, "/")) != NULL)
+	while ((fields[fields_num] = strtok_r (ptr, "/", &saveptr)) != NULL)
 	{
 		ptr = NULL;
 		fields_num++;
 
 		if (fields_num >= 16)
 			break;
@@ -386,383 +365,59 @@
 		 * Do not create directories that start with a dot. This
 		 * prevents `../../' attacks and other likely malicious
 		 * behavior.
 		 */
 		if (fields[i][0] == '.')
 		{
-			syslog (LOG_ERR, "Cowardly refusing to create a directory that begins with a `.' (dot): `%s'", file_orig);
+			ERROR ("Cowardly refusing to create a directory that begins with a `.' (dot): `%s'", file_orig);
 			return (-2);
 		}
 
 		/*
 		 * Join the components together again
 		 */
-		if (strjoin (dir, dir_len, fields, i + 1, "/") < 0)
+		dir[0] = '/';
+		if (strjoin (dir + path_is_absolute, dir_len - path_is_absolute,
+					fields, i + 1, "/") < 0)
 		{
-			syslog (LOG_ERR, "strjoin failed: `%s', component #%i", file_orig, i);
+			ERROR ("strjoin failed: `%s', component #%i", file_orig, i);
 			return (-1);
 		}
 
 		if (stat (dir, &statbuf) == -1)
 		{
 			if (errno == ENOENT)
 			{
 				if (mkdir (dir, 0755) == -1)
 				{
-					syslog (LOG_ERR, "mkdir (%s): %s", dir, strerror (errno));
+					char errbuf[1024];
+					ERROR ("mkdir (%s): %s", dir,
+							sstrerror (errno,
+								errbuf, sizeof (errbuf)));
 					return (-1);
 				}
 			}
 			else
 			{
-				syslog (LOG_ERR, "stat (%s): %s", dir, strerror (errno));
+				char errbuf[1024];
+				ERROR ("stat (%s): %s", dir,
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 		}
 		else if (!S_ISDIR (statbuf.st_mode))
 		{
-			syslog (LOG_ERR, "stat (%s): Not a directory!", dir);
+			ERROR ("stat (%s): Not a directory!", dir);
 			return (-1);
 		}
 	}
 
 	return (0);
 }
 
-/* * * * *
- * Magic *
- * * * * */
-#if HAVE_LIBRRD
-static int rra_get (char ***ret)
-{
-	static char **rra_def = NULL;
-	static int rra_num = 0;
-
-	int rra_max = rra_timespans_num * rra_types_num;
-
-	int step;
-	int rows;
-	int span;
-
-	int cdp_num;
-	int cdp_len;
-	int i, j;
-
-	char buffer[64];
-
-	if ((rra_num != 0) && (rra_def != NULL))
-	{
-		*ret = rra_def;
-		return (rra_num);
-	}
-
-	if ((rra_def = (char **) malloc ((rra_max + 1) * sizeof (char *))) == NULL)
-		return (-1);
-	memset (rra_def, '\0', (rra_max + 1) * sizeof (char *));
-
-	step = atoi (COLLECTD_STEP);
-	rows = atoi (COLLECTD_ROWS);
-
-	if ((step <= 0) || (rows <= 0))
-	{
-		*ret = NULL;
-		return (-1);
-	}
-
-	cdp_len = 0;
-	for (i = 0; i < rra_timespans_num; i++)
-	{
-		span = rra_timespans[i];
-
-		if ((span / step) < rows)
-			continue;
-
-		if (cdp_len == 0)
-			cdp_len = 1;
-		else
-			cdp_len = (int) floor (((double) span) / ((double) (rows * step)));
-
-		cdp_num = (int) ceil (((double) span) / ((double) (cdp_len * step)));
-
-		for (j = 0; j < rra_types_num; j++)
-		{
-			if (rra_num >= rra_max)
-				break;
-
-			if (snprintf (buffer, sizeof(buffer), "RRA:%s:%3.1f:%u:%u",
-						rra_types[j], COLLECTD_XFF,
-						cdp_len, cdp_num) >= sizeof (buffer))
-			{
-				syslog (LOG_ERR, "rra_get: Buffer would have been truncated.");
-				continue;
-			}
-
-			rra_def[rra_num++] = sstrdup (buffer);
-		}
-	}
-
-#if COLLECT_DEBUG
-	DBG ("rra_num = %i", rra_num);
-	for (i = 0; i < rra_num; i++)
-		DBG ("  %s", rra_def[i]);
-#endif
-
-	*ret = rra_def;
-	return (rra_num);
-}
-#endif /* HAVE_LIBRRD */
-
-static int log_create_file (char *filename, char **ds_def, int ds_num)
-{
-	FILE *log;
-	int i;
-
-	if (check_create_dir (filename))
-		return (-1);
-
-	log = fopen (filename, "w");
-	if (log == NULL)
-	{
-		syslog (LOG_WARNING, "Failed to create %s: %s", filename,
-				strerror(errno));
-		return (-1);
-	}
-
-	fprintf (log, "epoch");
-	for (i = 0; i < ds_num; i++)
-	{
-		char *name;
-		char *tmp;
-
-		name = strchr (ds_def[i], ':');
-		if (name == NULL)
-		{
-			syslog (LOG_WARNING, "Invalid DS definition '%s' for %s",
-					ds_def[i], filename);
-			fclose(log);
-			remove(filename);
-			return (-1);
-		}
-
-		name += 1;
-		tmp = strchr (name, ':');
-		if (tmp == NULL)
-		{
-			syslog (LOG_WARNING, "Invalid DS definition '%s' for %s",
-					ds_def[i], filename);
-			fclose(log);
-			remove(filename);
-			return (-1);
-		}
-
-		/* The `%.*s' is needed because there is no null-byte behind
-		 * the name. */
-		fprintf(log, ",%.*s", (int) (tmp - name), name);
-	}
-	fprintf(log, "\n");
-	fclose(log);
-
-	return 0;
-}
-
-static int log_update_file (char *host, char *file, char *values,
-		char **ds_def, int ds_num)
-{
-	char *tmp;
-	FILE *fp;
-	struct stat statbuf;
-	char full_file[1024];
-
-	/* Cook the values a bit: Substitute colons with commas */
-	strsubstitute (values, ':', ',');
-
-	/* host == NULL => local mode */
-	if (host != NULL)
-	{
-		if (snprintf (full_file, 1024, "%s/%s", host, file) >= 1024)
-			return (-1);
-	}
-	else
-	{
-		if (snprintf (full_file, 1024, "%s", file) >= 1024)
-			return (-1);
-	}
-
-	strncpy (full_file, file, 1024);
-
-	tmp = full_file + strlen (full_file) - 4;
-	assert ((tmp != NULL) && (tmp > full_file));
-
-	/* Change the filename for logfiles. */
-	if (strncmp (tmp, ".rrd", 4) == 0)
-	{
-		time_t now;
-		struct tm *tm;
-
-		/* TODO: Find a way to minimize the calls to `localtime', since
-		 * they are pretty expensive.. */
-		now = time (NULL);
-		tm = localtime (&now);
-
-		strftime (tmp, 1024 - (tmp - full_file), "-%Y-%m-%d", tm);
-
-		/* `localtime(3)' returns a pointer to static data,
-		 * therefore the pointer may not be free'd. */
-	}
-	else
-		DBG ("The filename ends with `%s' which is unexpected.", tmp);
-
-	if (stat (full_file, &statbuf) == -1)
-	{
-		if (errno == ENOENT)
-		{
-			if (log_create_file (full_file, ds_def, ds_num))
-				return (-1);
-		}
-		else
-		{
-			syslog (LOG_ERR, "stat %s: %s", full_file, strerror (errno));
-			return (-1);
-		}
-	}
-	else if (!S_ISREG (statbuf.st_mode))
-	{
-		syslog (LOG_ERR, "stat %s: Not a regular file!", full_file);
-		return (-1);
-	}
-
-
-	fp = fopen (full_file, "a");
-	if (fp == NULL)
-	{
-		syslog (LOG_WARNING, "Failed to append to %s: %s", full_file,
-				strerror(errno));
-		return (-1);
-	}
-	fprintf(fp, "%s\n", values);
-	fclose(fp);
-
-	return (0);
-} /* int log_update_file */
-
-#if HAVE_LIBRRD
-static int rrd_create_file (char *filename, char **ds_def, int ds_num)
-{
-	char **argv;
-	int argc;
-	char **rra_def;
-	int rra_num;
-	int i, j;
-	int status = 0;
-
-	if (check_create_dir (filename))
-		return (-1);
-
-	if ((rra_num = rra_get (&rra_def)) < 1)
-	{
-		syslog (LOG_ERR, "rra_create failed: Could not calculate RRAs");
-		return (-1);
-	}
-
-	argc = ds_num + rra_num + 4;
-
-	if ((argv = (char **) malloc (sizeof (char *) * (argc + 1))) == NULL)
-	{
-		syslog (LOG_ERR, "rrd_create failed: %s", strerror (errno));
-		return (-1);
-	}
-
-	argv[0] = "create";
-	argv[1] = filename;
-	argv[2] = "-s";
-	argv[3] = COLLECTD_STEP;
-
-	j = 4;
-	for (i = 0; i < ds_num; i++)
-		argv[j++] = ds_def[i];
-	for (i = 0; i < rra_num; i++)
-		argv[j++] = rra_def[i];
-	argv[j] = NULL;
-
-	optind = 0; /* bug in librrd? */
-	rrd_clear_error ();
-	if (rrd_create (argc, argv) == -1)
-	{
-		syslog (LOG_ERR, "rrd_create failed: %s: %s", filename, rrd_get_error ());
-		status = -1;
-	}
-
-	free (argv);
-
-	return (status);
-}
-#endif /* HAVE_LIBRRD */
-
-int rrd_update_file (char *host, char *file, char *values,
-		char **ds_def, int ds_num)
-{
-#if HAVE_LIBRRD
-	struct stat statbuf;
-	char full_file[1024];
-	char *argv[4] = { "update", full_file, values, NULL };
-#endif /* HAVE_LIBRRD */
-
-	/* I'd rather have a function `common_update_file' to make this
-	 * decission, but for that we'd need to touch all plugins.. */
-	if (operating_mode == MODE_LOG)
-		return (log_update_file (host, file, values,
-					ds_def, ds_num));
-
-#if HAVE_LIBRRD
-	/* host == NULL => local mode */
-	if (host != NULL)
-	{
-		if (snprintf (full_file, 1024, "%s/%s", host, file) >= 1024)
-			return (-1);
-	}
-	else
-	{
-		if (snprintf (full_file, 1024, "%s", file) >= 1024)
-			return (-1);
-	}
-
-	if (stat (full_file, &statbuf) == -1)
-	{
-		if (errno == ENOENT)
-		{
-			if (rrd_create_file (full_file, ds_def, ds_num))
-				return (-1);
-		}
-		else
-		{
-			syslog (LOG_ERR, "stat %s: %s", full_file, strerror (errno));
-			return (-1);
-		}
-	}
-	else if (!S_ISREG (statbuf.st_mode))
-	{
-		syslog (LOG_ERR, "stat %s: Not a regular file!", full_file);
-		return (-1);
-	}
-
-	optind = 0; /* bug in librrd? */
-	rrd_clear_error ();
-	if (rrd_update (3, argv) == -1)
-	{
-		syslog (LOG_WARNING, "rrd_update failed: %s: %s", full_file, rrd_get_error ());
-		return (-1);
-	}
-	return (0);
-/* #endif HAVE_LIBRRD */
-
-#else
-	syslog (LOG_ERR, "`rrd_update_file' was called, but collectd isn't linked against librrd!");
-	return (-1);
-#endif
-}
-
 #ifdef HAVE_LIBKSTAT
 int get_kstat (kstat_t **ksp_ptr, char *module, int instance, char *name)
 {
 	char ident[128];
 	
 	if (kc == NULL)
@@ -772,38 +427,38 @@
 	ident[127] = '\0';
 
 	if (*ksp_ptr == NULL)
 	{
 		if ((*ksp_ptr = kstat_lookup (kc, module, instance, name)) == NULL)
 		{
-			syslog (LOG_ERR, "Cound not find kstat %s", ident);
+			ERROR ("Cound not find kstat %s", ident);
 			return (-1);
 		}
 
 		if ((*ksp_ptr)->ks_type != KSTAT_TYPE_NAMED)
 		{
-			syslog (LOG_WARNING, "kstat %s has wrong type", ident);
+			WARNING ("kstat %s has wrong type", ident);
 			*ksp_ptr = NULL;
 			return (-1);
 		}
 	}
 
 #ifdef assert
 	assert (*ksp_ptr != NULL);
 	assert ((*ksp_ptr)->ks_type == KSTAT_TYPE_NAMED);
 #endif
 
 	if (kstat_read (kc, *ksp_ptr, NULL) == -1)
 	{
-		syslog (LOG_WARNING, "kstat %s could not be read", ident);
+		WARNING ("kstat %s could not be read", ident);
 		return (-1);
 	}
 
 	if ((*ksp_ptr)->ks_type != KSTAT_TYPE_NAMED)
 	{
-		syslog (LOG_WARNING, "kstat %s has wrong type", ident);
+		WARNING ("kstat %s has wrong type", ident);
 		return (-1);
 	}
 
 	return (0);
 }
 
@@ -837,11 +492,154 @@
 		retval = (long long) kn->value.ui32;
 	else if (kn->data_type == KSTAT_DATA_INT64)
 		retval = (long long) kn->value.i64; /* According to ANSI C99 `long long' must hold at least 64 bits */
 	else if (kn->data_type == KSTAT_DATA_UINT64)
 		retval = (long long) kn->value.ui64; /* XXX: Might overflow! */
 	else
-		syslog (LOG_WARNING, "get_kstat_value: Not a numeric value: %s", name);
+		WARNING ("get_kstat_value: Not a numeric value: %s", name);
 		 
 	return (retval);
 }
 #endif /* HAVE_LIBKSTAT */
+
+unsigned long long ntohll (unsigned long long n)
+{
+#if __BYTE_ORDER == __BIG_ENDIAN
+	return (n);
+#else
+	return (((unsigned long long) ntohl (n)) << 32) + ntohl (n >> 32);
+#endif
+} /* unsigned long long ntohll */
+
+unsigned long long htonll (unsigned long long n)
+{
+#if __BYTE_ORDER == __BIG_ENDIAN
+	return (n);
+#else
+	return (((unsigned long long) htonl (n)) << 32) + htonl (n >> 32);
+#endif
+} /* unsigned long long htonll */
+
+int format_name (char *ret, int ret_len,
+		const char *hostname,
+		const char *plugin, const char *plugin_instance,
+		const char *type, const char *type_instance)
+{
+	int  status;
+
+	assert (plugin != NULL);
+	assert (type != NULL);
+
+	if ((plugin_instance == NULL) || (strlen (plugin_instance) == 0))
+	{
+		if ((type_instance == NULL) || (strlen (type_instance) == 0))
+			status = snprintf (ret, ret_len, "%s/%s/%s",
+					hostname, plugin, type);
+		else
+			status = snprintf (ret, ret_len, "%s/%s/%s-%s",
+					hostname, plugin, type,
+					type_instance);
+	}
+	else
+	{
+		if ((type_instance == NULL) || (strlen (type_instance) == 0))
+			status = snprintf (ret, ret_len, "%s/%s-%s/%s",
+					hostname, plugin, plugin_instance,
+					type);
+		else
+			status = snprintf (ret, ret_len, "%s/%s-%s/%s-%s",
+					hostname, plugin, plugin_instance,
+					type, type_instance);
+	}
+
+	if ((status < 1) || (status >= ret_len))
+		return (-1);
+	return (0);
+} /* int format_name */
+
+int parse_identifier (char *str, char **ret_host,
+		char **ret_plugin, char **ret_plugin_instance,
+		char **ret_type, char **ret_type_instance)
+{
+	char *hostname = NULL;
+	char *plugin = NULL;
+	char *plugin_instance = NULL;
+	char *type = NULL;
+	char *type_instance = NULL;
+
+	hostname = str;
+	if (hostname == NULL)
+		return (-1);
+
+	plugin = strchr (hostname, '/');
+	if (plugin == NULL)
+		return (-1);
+	*plugin = '\0'; plugin++;
+
+	type = strchr (plugin, '/');
+	if (type == NULL)
+		return (-1);
+	*type = '\0'; type++;
+
+	plugin_instance = strchr (plugin, '-');
+	if (plugin_instance != NULL)
+	{
+		*plugin_instance = '\0';
+		plugin_instance++;
+	}
+
+	type_instance = strchr (type, '-');
+	if (type_instance != NULL)
+	{
+		*type_instance = '\0';
+		type_instance++;
+	}
+
+	*ret_host = hostname;
+	*ret_plugin = plugin;
+	*ret_plugin_instance = plugin_instance;
+	*ret_type = type;
+	*ret_type_instance = type_instance;
+	return (0);
+} /* int parse_identifier */
+
+int parse_values (char *buffer, value_list_t *vl, const data_set_t *ds)
+{
+	int i;
+	char *dummy;
+	char *ptr;
+	char *saveptr;
+
+	i = -1;
+	dummy = buffer;
+	saveptr = NULL;
+	while ((ptr = strtok_r (dummy, ":", &saveptr)) != NULL)
+	{
+		dummy = NULL;
+
+		if (i >= vl->values_len)
+			break;
+
+		if (i == -1)
+		{
+			if (strcmp ("N", ptr) == 0)
+				vl->time = time (NULL);
+			else
+				vl->time = (time_t) atoi (ptr);
+		}
+		else
+		{
+			if (strcmp ("U", ptr) == 0)
+				vl->values[i].gauge = NAN;
+			else if (ds->ds[i].type == DS_TYPE_COUNTER)
+				vl->values[i].counter = atoll (ptr);
+			else if (ds->ds[i].type == DS_TYPE_GAUGE)
+				vl->values[i].gauge = atof (ptr);
+		}
+
+		i++;
+	} /* while (strtok_r) */
+
+	if ((ptr != NULL) || (i != vl->values_len))
+		return (-1);
+	return (0);
+} /* int parse_values */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/common.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/common.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/common.h	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/common.h	2007-06-04 01:06:01.000000000 +0800
@@ -1,44 +1,46 @@
 /**
  * collectd - src/common.h
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
- * This program is free software; you can redistribute it and/
- * or modify it under the terms of the GNU General Public Li-
- * cence as published by the Free Software Foundation; either
- * version 2 of the Licence, or any later version.
- *
- * This program is distributed in the hope that it will be use-
- * ful, but WITHOUT ANY WARRANTY; without even the implied war-
- * ranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- * See the GNU General Public Licence for more details.
- *
- * You should have received a copy of the GNU General Public
- * Licence along with this program; if not, write to the Free
- * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
- * USA.
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the
+ * Free Software Foundation; only version 2 of the License is applicable.
+ *
+ * This program is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  *   Niki W. Waibel <niki.waibel@gmx.net>
 **/
 
 #ifndef COMMON_H
 #define COMMON_H
 
 #include "collectd.h"
+#include "plugin.h"
 
 #define sfree(ptr) \
 	if((ptr) != NULL) { \
 		free(ptr); \
 	} \
 	(ptr) = NULL
 
+#define STATIC_ARRAY_SIZE(a) (sizeof (a) / sizeof (*(a)))
+
 void sstrncpy(char *d, const char *s, int len);
 char *sstrdup(const char *s);
 void *smalloc(size_t size);
+char *sstrerror (int errnum, char *buf, size_t buflen);
 
 /*
  * NAME
  *   sread
  *
  * DESCRIPTION
@@ -139,18 +141,35 @@
  *
  * RETURN VALUE
  *   Returns zero upon success and a value smaller than zero upon failure.
  */
 int escape_slashes (char *buf, int buf_len);
 
+int strsubstitute (char *str, char c_from, char c_to);
+
 /* FIXME: `timeval_sub_timespec' needs a description */
 int timeval_sub_timespec (struct timeval *tv0, struct timeval *tv1, struct timespec *ret);
 
-int rrd_update_file (char *host, char *file, char *values,
-		char **ds_def, int ds_num);
+int check_create_dir (const char *file_orig);
 
 #ifdef HAVE_LIBKSTAT
 int get_kstat (kstat_t **ksp_ptr, char *module, int instance, char *name);
 long long get_kstat_value (kstat_t *ksp, char *name);
 #endif
 
+unsigned long long ntohll (unsigned long long n);
+unsigned long long htonll (unsigned long long n);
+
+int format_name (char *ret, int ret_len,
+		const char *hostname,
+		const char *plugin, const char *plugin_instance,
+		const char *type, const char *type_instance);
+#define FORMAT_VL(ret, ret_len, vl, ds) \
+	format_name (ret, ret_len, (vl)->host, (vl)->plugin, (vl)->plugin_instance, \
+			(ds)->type, (vl)->type_instance)
+
+int parse_identifier (char *str, char **ret_host,
+		char **ret_plugin, char **ret_plugin_instance,
+		char **ret_type, char **ret_type_instance);
+int parse_values (char *buffer, value_list_t *vl, const data_set_t *ds);
+
 #endif /* COMMON_H */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/configfile.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/configfile.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/configfile.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/configfile.c	2007-06-04 01:06:01.000000000 +0800
@@ -19,80 +19,79 @@
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 
-#include "libconfig/libconfig.h"
+#include "liboconfig/oconfig.h"
 
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "network.h"
-#include "utils_debug.h"
-
-#define SHORTOPT_NONE 0
-
-#define ERR_NOT_NESTED "Sections cannot be nested.\n"
-#define ERR_SECTION_ONLY "`%s' can only be used as section.\n"
-#define ERR_NEEDS_ARG "Section `%s' needs an argument.\n"
-#define ERR_NEEDS_SECTION "`%s' can only be used within a section.\n"
 
 #define ESCAPE_NULL(str) ((str) == NULL ? "(null)" : (str))
 
-#define DEBUG_CALLBACK(shortvar, var, arguments, value) \
-	DBG("shortvar = %s, var = %s, arguments = %s, value = %s, ...", \
-			ESCAPE_NULL(shortvar), \
-			ESCAPE_NULL(var), \
-			ESCAPE_NULL(arguments), \
-			ESCAPE_NULL(value))
-
-extern int operating_mode;
-
+/*
+ * Private types
+ */
 typedef struct cf_callback
 {
-	char  *type;
-	int  (*callback) (char *, char *);
-	char **keys;
+	const char  *type;
+	int  (*callback) (const char *, const char *);
+	const char **keys;
 	int    keys_num;
 	struct cf_callback *next;
 } cf_callback_t;
 
-static cf_callback_t *first_callback = NULL;
+typedef struct cf_value_map_s
+{
+	char *key;
+	int (*func) (const oconfig_item_t *);
+} cf_value_map_t;
 
-typedef struct cf_mode_item
+typedef struct cf_global_option_s
 {
 	char *key;
 	char *value;
-	int   mode;
-} cf_mode_item_t;
+	char *def;
+} cf_global_option_t;
+
+/*
+ * Prototypes of callback functions
+ */
+static int dispatch_value_plugindir (const oconfig_item_t *ci);
+static int dispatch_value_loadplugin (const oconfig_item_t *ci);
 
-/* TODO
- * - LogFile
+/*
+ * Private variables
  */
-static cf_mode_item_t cf_mode_list[] =
+static cf_callback_t *first_callback = NULL;
+
+static cf_value_map_t cf_value_map[] =
 {
-	{"TimeToLive",  NULL, MODE_CLIENT                           },
-	{"PIDFile",     NULL, MODE_CLIENT | MODE_SERVER | MODE_LOCAL | MODE_LOG },
-	{"DataDir",     NULL, MODE_CLIENT | MODE_SERVER | MODE_LOCAL | MODE_LOG },
-	{"LogFile",     NULL, MODE_CLIENT | MODE_SERVER | MODE_LOCAL | MODE_LOG }
+	{"PluginDir",  dispatch_value_plugindir},
+	{"LoadPlugin", dispatch_value_loadplugin}
 };
-static int cf_mode_num = 4;
-
-static int nesting_depth = 0;
-static char *current_module = NULL;
+static int cf_value_map_num = STATIC_ARRAY_LEN (cf_value_map);
 
-/* `cf_register' needs this prototype */
-static int cf_callback_plugin_dispatch (const char *, const char *,
-		const char *, const char *, lc_flags_t, void *);
+static cf_global_option_t cf_global_options[] =
+{
+	{"BaseDir",   NULL, PKGLOCALSTATEDIR},
+	{"PIDFile",   NULL, PIDFILE},
+	{"Hostname",  NULL, NULL},
+	{"Interval",  NULL, "10"},
+	{"ReadThreads", NULL, "5"},
+	{"TypesDB",   NULL, PLUGINDIR"/types.db"} /* FIXME: Configure path */
+};
+static int cf_global_options_num = STATIC_ARRAY_LEN (cf_global_options);
 
 /*
  * Functions to handle register/unregister, search, and other plugin related
  * stuff
  */
-static cf_callback_t *cf_search (char *type)
+static cf_callback_t *cf_search (const char *type)
 {
 	cf_callback_t *cf_cb;
 
 	if (type == NULL)
 		return (NULL);
 
@@ -100,28 +99,29 @@
 		if (strcasecmp (cf_cb->type, type) == 0)
 			break;
 
 	return (cf_cb);
 }
 
-static int cf_dispatch (char *type, const char *orig_key, const char *orig_value)
+static int cf_dispatch (const char *type, const char *orig_key,
+		const char *orig_value)
 {
 	cf_callback_t *cf_cb;
 	char *key;
 	char *value;
 	int ret;
 	int i;
 
-	DBG ("type = %s, key = %s, value = %s",
+	DEBUG ("type = %s, key = %s, value = %s",
 			ESCAPE_NULL(type),
 			ESCAPE_NULL(orig_key),
 			ESCAPE_NULL(orig_value));
 
 	if ((cf_cb = cf_search (type)) == NULL)
 	{
-		syslog (LOG_WARNING, "Plugin `%s' did not register a callback.", type);
+		WARNING ("Plugin `%s' did not register a callback.", type);
 		return (-1);
 	}
 
 	if ((key = strdup (orig_key)) == NULL)
 		return (1);
 	if ((value = strdup (orig_value)) == NULL)
@@ -139,426 +139,255 @@
 			ret = (*cf_cb->callback) (key, value);
 			break;
 		}
 	}
 
 	if (i >= cf_cb->keys_num)
-		syslog (LOG_WARNING, "Plugin `%s' did not register for value `%s'.", type, key);
+		WARNING ("Plugin `%s' did not register for value `%s'.", type, key);
 
 	free (key);
 	free (value);
 
-	DBG ("return (%i)", ret);
+	DEBUG ("return (%i)", ret);
 
 	return (ret);
-}
+} /* int cf_dispatch */
 
-void cf_unregister (char *type)
+static int dispatch_global_option (const oconfig_item_t *ci)
 {
-	cf_callback_t *this, *prev;
-
-	for (prev = NULL, this = first_callback;
-			this != NULL;
-			prev = this, this = this->next)
-		if (strcasecmp (this->type, type) == 0)
-		{
-			if (prev == NULL)
-				first_callback = this->next;
-			else
-				prev->next = this->next;
+	if (ci->values_num != 1)
+		return (-1);
+	if (ci->values[0].type == OCONFIG_TYPE_STRING)
+		return (global_option_set (ci->key, ci->values[0].value.string));
+	else if (ci->values[0].type == OCONFIG_TYPE_NUMBER)
+	{
+		char tmp[128];
+		snprintf (tmp, sizeof (tmp), "%lf", ci->values[0].value.number);
+		tmp[127] = '\0';
+		return (global_option_set (ci->key, tmp));
+	}
 
-			free (this);
-			break;
-		}
-}
+	return (-1);
+} /* int dispatch_global_option */
 
-void cf_register (char *type,
-		int (*callback) (char *, char *),
-		char **keys, int keys_num)
+static int dispatch_value_plugindir (const oconfig_item_t *ci)
 {
-	cf_callback_t *cf_cb;
-	char buf[64];
-	int i;
-
-	/* Remove this module from the list, if it already exists */
-	cf_unregister (type);
-
-	/* This pointer will be free'd in `cf_unregister' */
-	if ((cf_cb = (cf_callback_t *) malloc (sizeof (cf_callback_t))) == NULL)
-		return;
-
-	cf_cb->type     = type;
-	cf_cb->callback = callback;
-	cf_cb->keys     = keys;
-	cf_cb->keys_num = keys_num;
-
-	cf_cb->next = first_callback;
-	first_callback = cf_cb;
+	assert (strcasecmp (ci->key, "PluginDir") == 0);
+	
+	if (ci->values_num != 1)
+		return (-1);
+	if (ci->values[0].type != OCONFIG_TYPE_STRING)
+		return (-1);
 
-	for (i = 0; i < keys_num; i++)
-	{
-		if (snprintf (buf, 64, "Plugin.%s", keys[i]) < 64)
-		{
-			/* This may be called multiple times for the same
-			 * `key', but apparently `lc_register_*' can handle
-			 * it.. */
-			lc_register_callback (buf, SHORTOPT_NONE,
-					LC_VAR_STRING, cf_callback_plugin_dispatch,
-					NULL);
-		}
-		else
-		{
-			DBG ("Key was truncated: `%s'", ESCAPE_NULL(keys[i]));
-		}
-	}
+	plugin_set_dir (ci->values[0].value.string);
+	return (0);
 }
 
-/*
- * Other query functions
- */
-char *cf_get_option (const char *key, char *def)
+static int dispatch_value_loadplugin (const oconfig_item_t *ci)
 {
-	int i;
-
-	for (i = 0; i < cf_mode_num; i++)
-	{
-		if ((cf_mode_list[i].mode & operating_mode) == 0)
-			continue;
+	assert (strcasecmp (ci->key, "LoadPlugin") == 0);
 
-		if (strcasecmp (cf_mode_list[i].key, key) != 0)
-			continue;
+	if (ci->values_num != 1)
+		return (-1);
+	if (ci->values[0].type != OCONFIG_TYPE_STRING)
+		return (-1);
 
-		if (cf_mode_list[i].value != NULL)
-			return (cf_mode_list[i].value);
-		return (def);
-	}
+	return (plugin_load (ci->values[0].value.string));
+} /* int dispatch_value_loadplugin */
 
-	return (NULL);
-}
+static int dispatch_value_plugin (const char *plugin, oconfig_item_t *ci)
+{
+	char  buffer[4096];
+	char *buffer_ptr;
+	int   buffer_free;
+	int i;
 
-/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
- * Functions for the actual parsing                                    *
- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
+	buffer_ptr = buffer;
+	buffer_free = sizeof (buffer);
 
-/*
- * `cf_callback_mode'
- *   Chose the `operating_mode'
- *
- * Mode `value'
- */
-static int cf_callback_mode (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
-{
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
-
-	if (strcasecmp (value, "Client") == 0)
-		operating_mode = MODE_CLIENT;
-#if HAVE_LIBRRD
-	else if (strcasecmp (value, "Server") == 0)
-		operating_mode = MODE_SERVER;
-	else if (strcasecmp (value, "Local") == 0)
-		operating_mode = MODE_LOCAL;
-#else /* !HAVE_LIBRRD */
-	else if (strcasecmp (value, "Server") == 0)
-	{
-		fprintf (stderr, "Invalid mode `Server': "
-				"You need to link against librrd for this "
-				"mode to be available.\n");
-		syslog (LOG_ERR, "Invalid mode `Server': "
-				"You need to link against librrd for this "
-				"mode to be available.");
-		return (LC_CBRET_ERROR);
-	}
-	else if (strcasecmp (value, "Local") == 0)
-	{
-		fprintf (stderr, "Invalid mode `Local': "
-				"You need to link against librrd for this "
-				"mode to be available.\n");
-		syslog (LOG_ERR, "Invalid mode `Local': "
-				"You need to link against librrd for this "
-				"mode to be available.");
-		return (LC_CBRET_ERROR);
-	}
-#endif
-	else if (strcasecmp (value, "Log") == 0)
-		operating_mode = MODE_LOG;
-	else
+	for (i = 0; i < ci->values_num; i++)
 	{
-		syslog (LOG_ERR, "Invalid value for config option `Mode': `%s'", value);
-		return (LC_CBRET_ERROR);
-	}
-
-	return (LC_CBRET_OKAY);
-}
-
-/*
- * `cf_callback_mode_plugindir'
- *   Change the plugin directory
- *
- * <Mode xxx>
- *   PluginDir `value'
- * </Mode>
- */
-static int cf_callback_mode_plugindir (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
-{
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
+		int status = -1;
 
-	plugin_set_dir (value);
+		if (ci->values[i].type == OCONFIG_TYPE_STRING)
+			status = snprintf (buffer_ptr, buffer_free, " %s",
+					ci->values[i].value.string);
+		else if (ci->values[i].type == OCONFIG_TYPE_NUMBER)
+			status = snprintf (buffer_ptr, buffer_free, " %lf",
+					ci->values[i].value.number);
+		else if (ci->values[i].type == OCONFIG_TYPE_BOOLEAN)
+			status = snprintf (buffer_ptr, buffer_free, " %s",
+					ci->values[i].value.boolean
+					? "true" : "false");
+
+		if ((status < 0) || (status >= buffer_free))
+			return (-1);
+		buffer_free -= status;
+		buffer_ptr  += status;
+	}
+	/* skip the initial space */
+	buffer_ptr = buffer + 1;
 
-	return (LC_CBRET_OKAY);
-}
+	return (cf_dispatch (plugin, ci->key, buffer_ptr));
+} /* int plugin_conf_dispatch */
 
-static int cf_callback_mode_option (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
+static int dispatch_value (const oconfig_item_t *ci)
 {
-	cf_mode_item_t *item;
+	int ret = -2;
+	int i;
 
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
+	for (i = 0; i < cf_value_map_num; i++)
+		if (strcasecmp (cf_value_map[i].key, ci->key) == 0)
+		{
+			ret = cf_value_map[i].func (ci);
+			break;
+		}
 
-	if (extra == NULL)
-	{
-		fprintf (stderr, "No extra..?\n");
-		return (LC_CBRET_ERROR);
-	}
+	for (i = 0; i < cf_global_options_num; i++)
+		if (strcasecmp (cf_global_options[i].key, ci->key) == 0)
+		{
+			ret = dispatch_global_option (ci);
+			break;
+		}
 
-	item = (cf_mode_item_t *) extra;
+	return (ret);
+} /* int dispatch_value */
 
-	if (strcasecmp (item->key, shortvar))
-	{
-		fprintf (stderr, "Wrong extra..\n");
-		return (LC_CBRET_ERROR);
-	}
+static int dispatch_block_plugin (oconfig_item_t *ci)
+{
+	int i;
+	char *name;
 
-	if ((operating_mode & item->mode) == 0)
-	{
-		fprintf (stderr, "Option `%s' is not valid in this mode!\n", shortvar);
-		return (LC_CBRET_ERROR);
-	}
+	if (strcasecmp (ci->key, "Plugin") != 0)
+		return (-1);
+	if (ci->values_num != 1)
+		return (-1);
+	if (ci->values[0].type != OCONFIG_TYPE_STRING)
+		return (-1);
 
-	if (item->value != NULL)
-	{
-		free (item->value);
-		item->value = NULL;
-	}
+	name = ci->values[0].value.string;
 
-	if ((item->value = strdup (value)) == NULL)
+	for (i = 0; i < ci->children_num; i++)
 	{
-		perror ("strdup");
-		return (LC_CBRET_ERROR);
+		if (ci->children[i].children == NULL)
+			dispatch_value_plugin (name, ci->children + i);
+		else
+			{DEBUG ("No nested config blocks allow for plugins. Yet.");}
 	}
 
-	return (LC_CBRET_OKAY);
+	return (0);
 }
 
-/*
- * `cf_callback_mode_loadmodule':
- *   Load a plugin.
- *
- * <Mode xxx>
- *   LoadPlugin `value'
- * </Mode>
- */
-static int cf_callback_mode_loadmodule (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
-{
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
-
-	if (plugin_load (value))
-		syslog (LOG_ERR, "plugin_load (%s): failed to load plugin", value);
-
-	/* Return `okay' even if there was an error, because it's not a syntax
-	 * problem.. */
-	return (LC_CBRET_OKAY);
-}
 
-static int cf_callback_socket (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
+static int dispatch_block (oconfig_item_t *ci)
 {
-	char *buffer;
-
-	char *fields[3];
-	int   numfields;
+	if (strcasecmp (ci->key, "Plugin") == 0)
+		return (dispatch_block_plugin (ci));
 
-	char *node;
-	char *service = NET_DEFAULT_PORT;
+	return (0);
+}
 
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
+/* 
+ * Public functions
+ */
+int global_option_set (const char *option, const char *value)
+{
+	int i;
 
-	buffer = strdup (value);
-	if (buffer == NULL)
-		return (LC_CBRET_ERROR);
+	DEBUG ("option = %s; value = %s;", option, value);
 
-	numfields = strsplit (buffer, fields, 3);
+	for (i = 0; i < cf_global_options_num; i++)
+		if (strcasecmp (cf_global_options[i].key, option) == 0)
+			break;
 
-	if ((numfields != 1) && (numfields != 2))
-	{
-		syslog (LOG_ERR, "Invalid number of arguments to `%s'",
-				shortvar);
-		free (buffer);
-		return (LC_CBRET_ERROR);
-	}
+	if (i >= cf_global_options_num)
+		return (-1);
 
-	node = fields[0];
-	if (numfields == 2)
-		service = fields[1];
-
-	/* Still return `LC_CBRET_OKAY' because this is not an syntax error */
-	if (network_create_socket (node, service) < 1)
-		syslog (LOG_ERR, "network_create_socket (%s, %s) failed",
-				node, service);
+	sfree (cf_global_options[i].value);
 
-	free (buffer);
+	if (value != NULL)
+		cf_global_options[i].value = strdup (value);
+	else
+		cf_global_options[i].value = NULL;
 
-	return (LC_CBRET_OKAY);
+	return (0);
 }
 
-/*
- * `cf_callback_plugin'
- *   Start/end section `plugin'
- *
- * <Plugin `arguments'>
- *   ...
- * </Plugin>
- */
-static int cf_callback_plugin (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
+const char *global_option_get (const char *option)
 {
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
-
-	if (flags == LC_FLAGS_SECTIONSTART)
-	{
-		if (nesting_depth != 0)
-		{
-			fprintf (stderr, ERR_NOT_NESTED);
-			return (LC_CBRET_ERROR);
-		}
+	int i;
 
-		if (arguments == NULL)
-		{
-			fprintf (stderr, ERR_NEEDS_ARG, shortvar);
-			return (LC_CBRET_ERROR);
-		}
+	for (i = 0; i < cf_global_options_num; i++)
+		if (strcasecmp (cf_global_options[i].key, option) == 0)
+			break;
 
-		if ((current_module = strdup (arguments)) == NULL)
-		{
-			perror ("strdup");
-			return (LC_CBRET_ERROR);
-		}
+	if (i >= cf_global_options_num)
+		return (NULL);
+	
+	return ((cf_global_options[i].value != NULL)
+			? cf_global_options[i].value
+			: cf_global_options[i].def);
+} /* char *global_option_get */
 
-		nesting_depth++;
+void cf_unregister (const char *type)
+{
+	cf_callback_t *this, *prev;
 
-		if (cf_search (current_module) != NULL)
-			return (LC_CBRET_OKAY);
-		else
-			return (LC_CBRET_IGNORESECTION);
-	}
-	else if (flags == LC_FLAGS_SECTIONEND)
-	{
-		if (current_module != NULL)
+	for (prev = NULL, this = first_callback;
+			this != NULL;
+			prev = this, this = this->next)
+		if (strcasecmp (this->type, type) == 0)
 		{
-			free (current_module);
-			current_module = NULL;
-		}
-
-		nesting_depth--;
+			if (prev == NULL)
+				first_callback = this->next;
+			else
+				prev->next = this->next;
 
-		return (LC_CBRET_OKAY);
-	}
-	else
-	{
-		fprintf (stderr, ERR_SECTION_ONLY, shortvar);
-		return (LC_CBRET_ERROR);
-	}
-}
+			free (this);
+			break;
+		}
+} /* void cf_unregister */
 
-/*
- * `cf_callback_plugin_dispatch'
- *   Send options within `plugin' sections to the plugin that requests it.
- *
- * <Plugin `current_module'>
- *   `var' `value'
- * </Plugin>
- */
-static int cf_callback_plugin_dispatch (const char *shortvar, const char *var,
-		const char *arguments, const char *value, lc_flags_t flags,
-		void *extra)
+void cf_register (const char *type,
+		int (*callback) (const char *, const char *),
+		const char **keys, int keys_num)
 {
-	DEBUG_CALLBACK (shortvar, var, arguments, value);
-
-	if ((nesting_depth == 0) || (current_module == NULL))
-	{
-		fprintf (stderr, ERR_NEEDS_SECTION, shortvar);
-		return (LC_CBRET_ERROR);
-	}
-
-	/* Send the data to the plugin */
-	if (cf_dispatch (current_module, shortvar, value) < 0)
-		return (LC_CBRET_ERROR);
-
-	return (LC_CBRET_OKAY);
-}
+	cf_callback_t *cf_cb;
 
-static void cf_init (void)
-{
-	static int run_once = 0;
-	int i;
+	/* Remove this module from the list, if it already exists */
+	cf_unregister (type);
 
-	if (run_once != 0)
+	/* This pointer will be free'd in `cf_unregister' */
+	if ((cf_cb = (cf_callback_t *) malloc (sizeof (cf_callback_t))) == NULL)
 		return;
-	run_once = 1;
-
-	lc_register_callback ("Mode", SHORTOPT_NONE, LC_VAR_STRING,
-			cf_callback_mode, NULL);
-	lc_register_callback ("Plugin", SHORTOPT_NONE, LC_VAR_SECTION,
-			cf_callback_plugin, NULL);
-
-	lc_register_callback ("PluginDir", SHORTOPT_NONE,
-			LC_VAR_STRING, cf_callback_mode_plugindir, NULL);
-	lc_register_callback ("LoadPlugin", SHORTOPT_NONE,
-			LC_VAR_STRING, cf_callback_mode_loadmodule, NULL);
-
-	lc_register_callback ("Listen", SHORTOPT_NONE,
-			LC_VAR_STRING, cf_callback_socket, NULL);
-	lc_register_callback ("Server", SHORTOPT_NONE,
-			LC_VAR_STRING, cf_callback_socket, NULL);
 
-	for (i = 0; i < cf_mode_num; i++)
-	{
-		cf_mode_item_t *item;
-
-		item = &cf_mode_list[i];
+	cf_cb->type     = type;
+	cf_cb->callback = callback;
+	cf_cb->keys     = keys;
+	cf_cb->keys_num = keys_num;
 
-		lc_register_callback (item->key, SHORTOPT_NONE, LC_VAR_STRING,
-				cf_callback_mode_option, (void *) item);
-	}
-}
+	cf_cb->next = first_callback;
+	first_callback = cf_cb;
+} /* void cf_register */
 
 int cf_read (char *filename)
 {
-	cf_init ();
-
-	if (filename == NULL)
-		filename = CONFIGFILE;
-
-	DBG ("Starting to parse file `%s'", filename);
+	oconfig_item_t *conf;
+	int i;
 
-	/* int lc_process_file(const char *appname, const char *pathname, lc_conf_type_t type); */
-	if (lc_process_file ("collectd", filename, LC_CONF_APACHE))
+	conf = oconfig_parse_file (filename);
+	if (conf == NULL)
 	{
-		syslog (LOG_ERR, "lc_process_file (%s): %s", filename, lc_geterrstr ());
+		ERROR ("Unable to read config file %s.", filename);
 		return (-1);
 	}
 
-	DBG ("Done parsing file `%s'", filename);
-
-	/* free memory and stuff */
-	lc_cleanup ();
+	for (i = 0; i < conf->children_num; i++)
+	{
+		if (conf->children[i].children == NULL)
+			dispatch_value (conf->children + i);
+		else
+			dispatch_block (conf->children + i);
+	}
 
 	return (0);
-}
+} /* int cf_read */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/configfile.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/configfile.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/configfile.h	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/configfile.h	2007-06-04 01:06:02.000000000 +0800
@@ -28,13 +28,13 @@
  *  Remove a registered plugin from the internal data structures.
  * 
  * PARAMETERS
  *  `type'      Name of the plugin (must be the same as passed to
  *              `plugin_register'
  */
-void cf_unregister (char *type);
+void cf_unregister (const char *type);
 
 /*
  * DESCRIPTION
  *  `cf_register' is called by plugins that wish to receive config keys. The
  *  plugin will then receive all keys it registered for if they're found in a
  *  `<Plugin $type>' section.
@@ -54,30 +54,15 @@
  *
  * NOTES
  *  `cf_unregister' will be called for `type' to make sure only one record
  *  exists for each `type' at any time. This means that `cf_register' may be
  *  called multiple times, but only the last call will have an effect.
  */
-void cf_register (char *type,
-		int (*callback) (char *, char *),
-		char **keys, int keys_num);
-
-/*
- * DESCRIPTION
- *  `cf_get_option' returns various general options.
- *
- * PARAMETERS
- *  `key'       Name of the option to query.
- *  `def'       Pointer to return as default value.
- *
- * RETURN VALUE
- *  The pointer returned is part of an internal structure and may not be
- *  changed. If the option is not found for whatever reason (wrong key, option
- *  not allowed for currently selected mode, ...) `NULL' is returned.
- */
-char *cf_get_option (const char *key, char *def);
+void cf_register (const char *type,
+		int (*callback) (const char *, const char *),
+		const char **keys, int keys_num);
 
 /*
  * DESCRIPTION
  *  `cf_read' reads the config file `filename' and dispatches the read
  *  information to functions/variables. Most important: Is calls `plugin_load'
  *  to load specific plugins, depending on the current mode of operation.
@@ -90,7 +75,10 @@
  * RETURN VALUE
  *  Returns zero upon success and non-zero otherwise. A error-message will have
  *  been printed in this case.
  */
 int cf_read (char *filename);
 
+int global_option_set (const char *option, const char *value);
+const char *global_option_get (const char *option);
+
 #endif /* defined(CONFIGFILE_H) */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/config.h.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/config.h.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/config.h.in	2007-09-28 19:04:43.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/config.h.in	2007-06-04 01:50:12.000000000 +0800
@@ -1,14 +1,8 @@
 /* src/config.h.in.  Generated from configure.in by autoheader.  */
 
-/* Interval in which plugins are queried. */
-#undef COLLECTD_HEARTBEAT
-
-/* Interval in which plugins are queried. */
-#undef COLLECTD_STEP
-
 /* wether or not to enable module Apache httpd statistics */
 #undef COLLECT_APACHE
 
 /* wether or not to enable module Statistics of UPSes by APC */
 #undef COLLECT_APCUPS
 
@@ -21,12 +15,15 @@
 /* wether or not to enable module cpu usage statistics */
 #undef COLLECT_CPU
 
 /* wether or not to enable module system cpu frequency statistics */
 #undef COLLECT_CPUFREQ
 
+/* wether or not to enable module csv output plugin */
+#undef COLLECT_CSV
+
 /* wether or not to enable feature daemon mode */
 #undef COLLECT_DAEMON
 
 /* wether or not to enable feature debugging */
 #undef COLLECT_DEBUG
 
@@ -39,18 +36,33 @@
 /* wether or not to enable module dns statistics */
 #undef COLLECT_DNS
 
 /* wether or not to enable module email statistics */
 #undef COLLECT_EMAIL
 
+/* wether or not to enable module entropy statistics */
+#undef COLLECT_ENTROPY
+
+/* wether or not to enable module exec of external programs */
+#undef COLLECT_EXEC
+
 /* wether or not to enable feature getifaddrs under Linux */
 #undef COLLECT_GETIFADDRS
 
 /* wether or not to enable module hdd temperature statistics */
 #undef COLLECT_HDDTEMP
 
+/* wether or not to enable module interface statistics */
+#undef COLLECT_INTERFACE
+
+/* wether or not to enable module IPtables statistics */
+#undef COLLECT_IPTABLES
+
+/* wether or not to enable module irq statistics */
+#undef COLLECT_IRQ
+
 /* Wether or not to use the IOKit library */
 #undef COLLECT_LIBIOKIT
 
 /* Wether or not to use mysql library */
 #undef COLLECT_LIBMYSQL
 
@@ -63,56 +75,68 @@
 /* Wether or not to use sensors library */
 #undef COLLECT_LM_SENSORS
 
 /* wether or not to enable module system load statistics */
 #undef COLLECT_LOAD
 
+/* wether or not to enable module logfile log facility */
+#undef COLLECT_LOGFILE
+
 /* wether or not to enable module motherboard monitor statistics */
 #undef COLLECT_MBMON
 
 /* wether or not to enable module memory statistics */
 #undef COLLECT_MEMORY
 
 /* wether or not to enable module multimeter statistics */
 #undef COLLECT_MULTIMETER
 
 /* wether or not to enable module mysql statistics */
 #undef COLLECT_MYSQL
 
+/* wether or not to enable module network functionality */
+#undef COLLECT_NETWORK
+
 /* wether or not to enable module nfs statistics */
 #undef COLLECT_NFS
 
-/* wether or not to enable module nfs statistics */
+/* wether or not to enable module ntpd statistics */
 #undef COLLECT_NTPD
 
+/* wether or not to enable module network UPS tools statistics */
+#undef COLLECT_NUT
+
+/* wether or not to enable module embedded perl interpreter */
+#undef COLLECT_PERL
+
 /* wether or not to enable module ping statistics */
 #undef COLLECT_PING
 
 /* wether or not to enable module processes statistics */
 #undef COLLECT_PROCESSES
 
-/* wether or not to enable module quota statistics (experimental) */
-#undef COLLECT_QUOTA
-
 /* Wether or not to use rrdtool library */
 #undef COLLECT_RRDTOOL
 
 /* wether or not to enable module lm_sensors statistics */
 #undef COLLECT_SENSORS
 
 /* wether or not to enable module serial statistics */
 #undef COLLECT_SERIAL
 
 /* wether or not to enable module swap statistics */
 #undef COLLECT_SWAP
 
+/* wether or not to enable module syslog log facility */
+#undef COLLECT_SYSLOG
+
 /* wether or not to enable module tape statistics */
 #undef COLLECT_TAPE
 
-/* wether or not to enable module system traffic statistics */
-#undef COLLECT_TRAFFIC
+/* wether or not to enable module UNIX socket plugin */
+#undef COLLECT_UNIXSOCK
 
 /* wether or not to enable module user count statistics */
 #undef COLLECT_USERS
 
 /* wether or not to enable module vserver statistics */
 #undef COLLECT_VSERVER
@@ -231,18 +255,39 @@
    file. */
 #undef HAVE_IOKIT_STORAGE_IOBLOCKSTORAGEDRIVER_H
 
 /* Define to 1 if you have the <kstat.h> header file. */
 #undef HAVE_KSTAT_H
 
+/* Define to 1 if `nwrites' is member of `kstat_io_t'. */
+#undef HAVE_KSTAT_IO_T_NWRITES
+
+/* Define to 1 if `nwritten' is member of `kstat_io_t'. */
+#undef HAVE_KSTAT_IO_T_NWRITTEN
+
+/* Define to 1 if `writes' is member of `kstat_io_t'. */
+#undef HAVE_KSTAT_IO_T_WRITES
+
+/* Define to 1 if `wtime' is member of `kstat_io_t'. */
+#undef HAVE_KSTAT_IO_T_WTIME
+
 /* Define to 1 if you have the <kvm.h> header file. */
 #undef HAVE_KVM_H
 
 /* Define to 1 if you have the 'curl' library (-lcurl). */
 #undef HAVE_LIBCURL
 
+/* Define to 1 if you have the <libgen.h> header file. */
+#undef HAVE_LIBGEN_H
+
+/* Define to 1 if you have the iptc library (-liptc). */
+#undef HAVE_LIBIPTC
+
+/* Define to 1 if you have the <libiptc/libiptc.h> header file. */
+#undef HAVE_LIBIPTC_LIBIPTC_H
+
 /* Define to 1 if you have the 'kstat' library (-lkstat) */
 #undef HAVE_LIBKSTAT
 
 /* Define to 1 if you have the 'kvm' library (-lkvm) */
 #undef HAVE_LIBKVM
 
@@ -252,24 +297,30 @@
 /* Define to 1 if you have the mysqlclient library (-lmysqlclient). */
 #undef HAVE_LIBMYSQLCLIENT
 
 /* Define to 1 if you have the pcap library (-lpcap). */
 #undef HAVE_LIBPCAP
 
+/* Define if libperl is present and usable. */
+#undef HAVE_LIBPERL
+
 /* Wether or not to use pthread (POSIX threads) library */
 #undef HAVE_LIBPTHREAD
 
 /* Define to 1 if you have the 'resolv' library (-lresolv). */
 #undef HAVE_LIBRESOLV
 
 /* Define to 1 if you have the rrd library (-lrrd). */
 #undef HAVE_LIBRRD
 
 /* Define to 1 if you have the sensors library (-lsensors). */
 #undef HAVE_LIBSENSORS
 
+/* Define to 1 if you have the upsclient library (-lupsclient). */
+#undef HAVE_LIBUPSCLIENT
+
 /* Define to 1 if you have the <limits.h> header file. */
 #undef HAVE_LIMITS_H
 
 /* Define to 1 if you have the <linux/config.h> header file. */
 #undef HAVE_LINUX_CONFIG_H
 
@@ -387,12 +438,15 @@
 /* Define to 1 if you have the <netinet/ip_icmp.h> header file. */
 #undef HAVE_NETINET_IP_ICMP_H
 
 /* Define to 1 if you have the <netinet/ip_var.h> header file. */
 #undef HAVE_NETINET_IP_VAR_H
 
+/* Define to 1 if you have the <netinet/tcp.h> header file. */
+#undef HAVE_NETINET_TCP_H
+
 /* Define to 1 if you have the <netinet/udp.h> header file. */
 #undef HAVE_NETINET_UDP_H
 
 /* Define to 1 if you have the <net/if_arp.h> header file. */
 #undef HAVE_NET_IF_ARP_H
 
@@ -411,12 +465,15 @@
 /* Define to 1 if you have the <paths.h> header file. */
 #undef HAVE_PATHS_H
 
 /* Define to 1 if you have the <pcap.h> header file. */
 #undef HAVE_PCAP_H
 
+/* Define to 1 if you have the <poll.h> header file. */
+#undef HAVE_POLL_H
+
 /* Define to 1 if you have the <pthread.h> header file. */
 #undef HAVE_PTHREAD_H
 
 /* Define to 1 if you have the <pwd.h> header file. */
 #undef HAVE_PWD_H
 
@@ -571,12 +628,15 @@
 /* Define to 1 if you have the <sys/fstyp.h> header file. */
 #undef HAVE_SYS_FSTYP_H
 
 /* Define to 1 if you have the <sys/fs_types.h> header file. */
 #undef HAVE_SYS_FS_TYPES_H
 
+/* Define to 1 if you have the <sys/ioctl.h> header file. */
+#undef HAVE_SYS_IOCTL_H
+
 /* Define to 1 if you have the <sys/loadavg.h> header file. */
 #undef HAVE_SYS_LOADAVG_H
 
 /* Define to 1 if you have the <sys/mntent.h> header file. */
 #undef HAVE_SYS_MNTENT_H
 
@@ -590,15 +650,12 @@
    */
 #undef HAVE_SYS_NDIR_H
 
 /* Define to 1 if you have the <sys/param.h> header file. */
 #undef HAVE_SYS_PARAM_H
 
-/* Define to 1 if you have the <sys/poll.h> header file. */
-#undef HAVE_SYS_POLL_H
-
 /* Define to 1 if you have the <sys/quota.h> header file. */
 #undef HAVE_SYS_QUOTA_H
 
 /* Define to 1 if you have the <sys/resource.h> header file. */
 #undef HAVE_SYS_RESOURCE_H
 
@@ -638,21 +695,27 @@
 /* Define to 1 if you have the <sys/vfs.h> header file. */
 #undef HAVE_SYS_VFS_H
 
 /* Define to 1 if you have <sys/wait.h> that is POSIX.1 compatible. */
 #undef HAVE_SYS_WAIT_H
 
+/* Define to 1 if you have the <termios.h> header file. */
+#undef HAVE_TERMIOS_H
+
 /* Define to 1 if you have the `thread_info' function. */
 #undef HAVE_THREAD_INFO
 
 /* Define if the function getmntent exists and takes two arguments. */
 #undef HAVE_TWO_GETMNTENT
 
 /* Define to 1 if you have the <unistd.h> header file. */
 #undef HAVE_UNISTD_H
 
+/* Define to 1 if you have the <upsclient.h> header file. */
+#undef HAVE_UPSCLIENT_H
+
 /* Define to 1 if you have the <utmpx.h> header file. */
 #undef HAVE_UTMPX_H
 
 /* Define to 1 if you have the <utmp.h> header file. */
 #undef HAVE_UTMP_H
 
@@ -662,12 +725,22 @@
 /* True if program is to be compiled for a Linux kernel */
 #undef KERNEL_LINUX
 
 /* True if program is to be compiled for a Solaris kernel */
 #undef KERNEL_SOLARIS
 
+/* Define if NAN is defined by default and can initialize static variables. */
+#undef NAN_STATIC_DEFAULT
+
+/* Define if NAN is defined by __USE_ISOC99 and can initialize static
+   variables. */
+#undef NAN_STATIC_ISOC
+
+/* Define if NAN can be defined as (0.0 / 0.0) */
+#undef NAN_ZERO_ZERO
+
 /* Name of package */
 #undef PACKAGE
 
 /* Define to the address where bug reports for this package should be sent. */
 #undef PACKAGE_BUGREPORT
 
@@ -689,12 +762,16 @@
 /* Define to 1 if you can safely include both <sys/time.h> and <time.h>. */
 #undef TIME_WITH_SYS_TIME
 
 /* Version number of package */
 #undef VERSION
 
+/* Define to 1 if `lex' declares `yytext' as a `char *' by default, not a
+   `char[]'. */
+#undef YYTEXT_POINTER
+
 /* Number of bits in a file offset, on hosts where this is settable. */
 #undef _FILE_OFFSET_BITS
 
 /* Define for large files, on AIX-style hosts. */
 #undef _LARGE_FILES
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/cpu.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/cpu.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/cpu.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/cpu.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/cpu.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,15 +19,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "cpu"
 
 #ifdef HAVE_MACH_KERN_RETURN_H
 # include <mach/kern_return.h>
 #endif
 #ifdef HAVE_MACH_MACH_INIT_H
 # include <mach/mach_init.h>
@@ -75,12 +71,13 @@
 #if defined(PROCESSOR_CPU_LOAD_INFO) || defined(KERNEL_LINUX) || defined(HAVE_LIBKSTAT) || defined(HAVE_SYSCTLBYNAME)
 # define CPU_HAVE_READ 1
 #else
 # define CPU_HAVE_READ 0
 #endif
 
+#if CPU_HAVE_READ
 #ifdef PROCESSOR_CPU_LOAD_INFO
 static mach_port_t port_host;
 static processor_port_array_t cpu_list;
 static mach_msg_type_number_t cpu_list_len;
 
 #if PROCESSOR_TEMPERATURE
@@ -103,57 +100,40 @@
 /* #endif HAVE_LIBKSTAT */
 
 #elif defined(HAVE_SYSCTLBYNAME)
 static int numcpu;
 #endif /* HAVE_SYSCTLBYNAME */
 
-static char *cpu_filename = "cpu-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:user:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:nice:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:syst:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:idle:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wait:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int ds_num = 5;
-
-static void cpu_init (void)
+static int init (void)
 {
 #if PROCESSOR_CPU_LOAD_INFO || PROCESSOR_TEMPERATURE
 	kern_return_t status;
-	int collectd_step;
 
 	port_host = mach_host_self ();
 
 	/* FIXME: Free `cpu_list' if it's not NULL */
 	if ((status = host_processors (port_host, &cpu_list, &cpu_list_len)) != KERN_SUCCESS)
 	{
-		syslog (LOG_ERR, "cpu-plugin: host_processors returned %i\n", (int) status);
+		ERROR ("cpu plugin: host_processors returned %i", (int) status);
 		cpu_list_len = 0;
-		return;
+		return (-1);
 	}
 
-	DBG ("host_processors returned %i %s", (int) cpu_list_len, cpu_list_len == 1 ? "processor" : "processors");
-	syslog (LOG_INFO, "cpu-plugin: Found %i processor%s.", (int) cpu_list_len, cpu_list_len == 1 ? "" : "s");
+	DEBUG ("host_processors returned %i %s", (int) cpu_list_len, cpu_list_len == 1 ? "processor" : "processors");
+	INFO ("cpu plugin: Found %i processor%s.", (int) cpu_list_len, cpu_list_len == 1 ? "" : "s");
 
-	collectd_step = atoi (COLLECTD_STEP);
-	if ((collectd_step > 0) && (collectd_step <= 86400))
-		cpu_temp_retry_max = 86400 / collectd_step;
-		
+	cpu_temp_retry_max = 86400 / interval_g;
 /* #endif PROCESSOR_CPU_LOAD_INFO */
 
 #elif defined(HAVE_LIBKSTAT)
 	kstat_t *ksp_chain;
 
 	numcpu = 0;
 
 	if (kc == NULL)
-		return;
+		return (-1);
 
 	/* Solaris doesn't count linear.. *sigh* */
 	for (numcpu = 0, ksp_chain = kc->kc_chain;
 			(numcpu < MAX_NUMCPU) && (ksp_chain != NULL);
 			ksp_chain = ksp_chain->ks_next)
 		if (strncmp (ksp_chain->ks_module, "cpu_stat", 8) == 0)
@@ -164,56 +144,46 @@
 	size_t numcpu_size;
 
 	numcpu_size = sizeof (numcpu);
 
 	if (sysctlbyname ("hw.ncpu", &numcpu, &numcpu_size, NULL, 0) < 0)
 	{
-		syslog (LOG_WARNING, "cpu: sysctlbyname: %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		WARNING ("cpu plugin: sysctlbyname: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	if (numcpu != 1)
-		syslog (LOG_NOTICE, "cpu: Only one processor supported when using `sysctlbyname' (found %i)", numcpu);
+		NOTICE ("cpu: Only one processor supported when using `sysctlbyname' (found %i)", numcpu);
 #endif
 
-	return;
-}
+	return (0);
+} /* int init */
 
-static void cpu_write (char *host, char *inst, char *val)
+static void submit (int cpu_num, const char *type_instance, counter_t value)
 {
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, cpu_filename, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
-
-#if CPU_HAVE_READ
-#define BUFSIZE 512
-static void cpu_submit (int cpu_num, unsigned long long user,
-		unsigned long long nice, unsigned long long syst,
-		unsigned long long idle, unsigned long long wait)
-{
-	char buf[BUFSIZE];
-	char cpu[16];
+	values[0].counter = value;
 
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%llu", (unsigned int) curtime,
-				user, nice, syst, idle, wait) >= BUFSIZE)
-		return;
-	snprintf (cpu, 16, "%i", cpu_num);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "cpu");
+	snprintf (vl.plugin_instance, sizeof (vl.type_instance),
+			"%i", cpu_num);
+	vl.plugin_instance[DATA_MAX_NAME_LEN - 1] = '\0';
+	strcpy (vl.type_instance, type_instance);
 
-	plugin_submit (MODULE_NAME, cpu, buf);
+	plugin_dispatch_values ("cpu", &vl);
 }
-#undef BUFSIZE
 
-static void cpu_read (void)
+static int cpu_read (void)
 {
 #if PROCESSOR_CPU_LOAD_INFO || PROCESSOR_TEMPERATURE
 	int cpu;
 
 	kern_return_t status;
 	
@@ -235,27 +205,26 @@
 		cpu_info_len = PROCESSOR_BASIC_INFO_COUNT;
 
 		if ((status = processor_info (cpu_list[cpu],
 						PROCESSOR_CPU_LOAD_INFO, &cpu_host,
 						(processor_info_t) &cpu_info, &cpu_info_len)) != KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "cpu-plugin: processor_info failed with status %i\n", (int) status);
+			ERROR ("cpu plugin: processor_info failed with status %i", (int) status);
 			continue;
 		}
 
 		if (cpu_info_len < CPU_STATE_MAX)
 		{
-			syslog (LOG_ERR, "cpu-plugin: processor_info returned only %i elements..\n", cpu_info_len);
+			ERROR ("cpu plugin: processor_info returned only %i elements..", cpu_info_len);
 			continue;
 		}
 
-		cpu_submit (cpu, cpu_info.cpu_ticks[CPU_STATE_USER],
-				cpu_info.cpu_ticks[CPU_STATE_NICE],
-				cpu_info.cpu_ticks[CPU_STATE_SYSTEM],
-				cpu_info.cpu_ticks[CPU_STATE_IDLE],
-				0ULL);
+		submit (cpu, "user", (counter_t) cpu_info.cpu_ticks[CPU_STATE_USER]);
+		submit (cpu, "nice", (counter_t) cpu_info.cpu_ticks[CPU_STATE_USER]);
+		submit (cpu, "system", (counter_t) cpu_info.cpu_ticks[CPU_STATE_USER]);
+		submit (cpu, "idle", (counter_t) cpu_info.cpu_ticks[CPU_STATE_USER]);
 #endif /* PROCESSOR_CPU_LOAD_INFO */
 #if PROCESSOR_TEMPERATURE
 		/*
 		 * Not all Apple computers do have this ability. To minimize
 		 * the messages sent to the syslog we do an exponential
 		 * stepback if `processor_info' fails. We still try ~once a day
@@ -272,63 +241,63 @@
 		status = processor_info (cpu_list[cpu],
 				PROCESSOR_TEMPERATURE,
 				&cpu_host,
 				cpu_temp, &cpu_temp_len);
 		if (status != KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "cpu-plugin: processor_info failed: %s",
+			ERROR ("cpu plugin: processor_info failed: %s",
 					mach_error_string (status));
 
 			cpu_temp_retry_counter = cpu_temp_retry_step;
 			cpu_temp_retry_step *= 2;
 			if (cpu_temp_retry_step > cpu_temp_retry_max)
 				cpu_temp_retry_step = cpu_temp_retry_max;
 
 			continue;
 		}
 
 		if (cpu_temp_len != 1)
 		{
-			DBG ("processor_info (PROCESSOR_TEMPERATURE) returned %i elements..?",
+			DEBUG ("processor_info (PROCESSOR_TEMPERATURE) returned %i elements..?",
 				       	(int) cpu_temp_len);
 			continue;
 		}
 
 		cpu_temp_retry_counter = 0;
 		cpu_temp_retry_step    = 1;
 
-		DBG ("cpu_temp = %i", (int) cpu_temp);
+		DEBUG ("cpu_temp = %i", (int) cpu_temp);
 #endif /* PROCESSOR_TEMPERATURE */
 	}
 /* #endif PROCESSOR_CPU_LOAD_INFO */
 
 #elif defined(KERNEL_LINUX)
-# define BUFSIZE 1024
 	int cpu;
-	unsigned long long user, nice, syst, idle;
-	unsigned long long wait, intr, sitr; /* sitr == soft interrupt */
+	counter_t user, nice, syst, idle;
+	counter_t wait, intr, sitr; /* sitr == soft interrupt */
 	FILE *fh;
-	char buf[BUFSIZE];
+	char buf[1024];
 
 	char *fields[9];
 	int numfields;
 
 	static complain_t complain_obj;
 
 	if ((fh = fopen ("/proc/stat", "r")) == NULL)
 	{
+		char errbuf[1024];
 		plugin_complain (LOG_ERR, &complain_obj, "cpu plugin: "
 				"fopen (/proc/stat) failed: %s",
-				strerror (errno));
-		return;
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	plugin_relief (LOG_NOTICE, &complain_obj, "cpu plugin: "
 			"fopen (/proc/stat) succeeded.");
 
-	while (fgets (buf, BUFSIZE, fh) != NULL)
+	while (fgets (buf, 1024, fh) != NULL)
 	{
 		if (strncmp (buf, "cpu", 3))
 			continue;
 		if ((buf[3] < '0') || (buf[3] > '9'))
 			continue;
 
@@ -339,54 +308,57 @@
 		cpu = atoi (fields[0] + 3);
 		user = atoll (fields[1]);
 		nice = atoll (fields[2]);
 		syst = atoll (fields[3]);
 		idle = atoll (fields[4]);
 
+		submit (cpu, "user", user);
+		submit (cpu, "nice", nice);
+		submit (cpu, "system", syst);
+		submit (cpu, "idle", idle);
+
 		if (numfields >= 8)
 		{
 			wait = atoll (fields[5]);
 			intr = atoll (fields[6]);
 			sitr = atoll (fields[7]);
 
-			/* I doubt anyone cares about the time spent in
-			 * interrupt handlers.. */
-			syst += intr + sitr;
-		}
-		else
-		{
-			wait = 0LL;
-		}
+			submit (cpu, "wait", wait);
+			submit (cpu, "interrupt", intr);
+			submit (cpu, "softirq", sitr);
 
-		cpu_submit (cpu, user, nice, syst, idle, wait);
+			if (numfields >= 9)
+				submit (cpu, "steal", atoll (fields[8]));
+		}
 	}
 
 	fclose (fh);
-#undef BUFSIZE
 /* #endif defined(KERNEL_LINUX) */
 
 #elif defined(HAVE_LIBKSTAT)
 	int cpu;
-	unsigned long long user, syst, idle, wait;
+	counter_t user, syst, idle, wait;
 	static cpu_stat_t cs;
 
 	if (kc == NULL)
 		return;
 
 	for (cpu = 0; cpu < numcpu; cpu++)
 	{
 		if (kstat_read (kc, ksp[cpu], &cs) == -1)
 			continue; /* error message? */
 
-		idle = (unsigned long long) cs.cpu_sysinfo.cpu[CPU_IDLE];
-		user = (unsigned long long) cs.cpu_sysinfo.cpu[CPU_USER];
-		syst = (unsigned long long) cs.cpu_sysinfo.cpu[CPU_KERNEL];
-		wait = (unsigned long long) cs.cpu_sysinfo.cpu[CPU_WAIT];
-
-		cpu_submit (ksp[cpu]->ks_instance,
-				user, 0LL, syst, idle, wait);
+		idle = (counter_t) cs.cpu_sysinfo.cpu[CPU_IDLE];
+		user = (counter_t) cs.cpu_sysinfo.cpu[CPU_USER];
+		syst = (counter_t) cs.cpu_sysinfo.cpu[CPU_KERNEL];
+		wait = (counter_t) cs.cpu_sysinfo.cpu[CPU_WAIT];
+
+		submit (ksp[cpu]->ks_instance, "user", user);
+		submit (ksp[cpu]->ks_instance, "system", syst);
+		submit (ksp[cpu]->ks_instance, "idle", idle);
+		submit (ksp[cpu]->ks_instance, "wait", wait);
 	}
 /* #endif defined(HAVE_LIBKSTAT) */
 
 #elif defined(HAVE_SYSCTLBYNAME)
 	long cpuinfo[CPUSTATES];
 	size_t cpuinfo_size;
@@ -394,33 +366,35 @@
 	static complain_t complain_obj;
 
 	cpuinfo_size = sizeof (cpuinfo);
 
 	if (sysctlbyname("kern.cp_time", &cpuinfo, &cpuinfo_size, NULL, 0) < 0)
 	{
+		char errbuf[1024];
 		plugin_complain (LOG_ERR, &complain_obj, "cpu plugin: "
 				"sysctlbyname failed: %s.",
-				strerror (errno));
-		return;
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	plugin_relief (LOG_NOTICE, &complain_obj, "cpu plugin: "
 			"sysctlbyname succeeded.");
 
 	cpuinfo[CP_SYS] += cpuinfo[CP_INTR];
 
-	/* FIXME: Instance is always `0' */
-	cpu_submit (0, cpuinfo[CP_USER], cpuinfo[CP_NICE], cpuinfo[CP_SYS], cpuinfo[CP_IDLE], 0LL);
+	submit (0, "user", cpuinfo[CP_USER]);
+	submit (0, "nice", cpuinfo[CP_NICE]);
+	submit (0, "system", cpuinfo[CP_SYS]);
+	submit (0, "idle", cpuinfo[CP_IDLE]);
 #endif
 
-	return;
+	return (0);
 }
-#else
-# define cpu_read NULL
 #endif /* CPU_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, cpu_init, cpu_read, cpu_write);
-}
-
-#undef MODULE_NAME
+#if CPU_HAVE_READ
+	plugin_register_init ("cpu", init);
+	plugin_register_read ("cpu", cpu_read);
+#endif /* CPU_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/cpufreq.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/cpufreq.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/cpufreq.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/cpufreq.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,9 +1,9 @@
 /**
  * collectd - src/cpufreq.c
- * Copyright (C) 2005,2006  Peter Holik
+ * Copyright (C) 2005-2007  Peter Holik
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
  * Free Software Foundation; either version 2 of the License, or (at your
  * option) any later version.
  *
@@ -29,124 +29,126 @@
 #if defined(KERNEL_LINUX)
 # define CPUFREQ_HAVE_READ 1
 #else
 # define CPUFREQ_HAVE_READ 0
 #endif
 
-static char *cpufreq_file = "cpufreq-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int ds_num = 1;
-
+#if CPUFREQ_HAVE_READ
 #ifdef KERNEL_LINUX
 static int num_cpu = 0;
 #endif
 
-#define BUFSIZE 256
-
-static void cpufreq_init (void)
+static int cpufreq_init (void)
 {
 #ifdef KERNEL_LINUX
         int status;
-	char filename[BUFSIZE];
+	char filename[256];
 
 	num_cpu = 0;
 
 	while (1)
 	{
-		status = snprintf (filename, BUFSIZE, "/sys/devices/system/cpu/cpu%d/cpufreq/scaling_cur_freq", num_cpu);
-    		if (status < 1 || status >= BUFSIZE)
+		status = snprintf (filename, sizeof (filename),
+				"/sys/devices/system/cpu/cpu%d/cpufreq/"
+				"scaling_cur_freq", num_cpu);
+    		if (status < 1 || status >= sizeof (filename))
 			break;
 
-		if (access(filename, R_OK))
+		if (access (filename, R_OK))
 			break;
 
 		num_cpu++;
 	}
 
-	syslog (LOG_INFO, MODULE_NAME" found %d cpu(s)", num_cpu);
+	INFO ("cpufreq plugin: Found %d CPU%s", num_cpu,
+			(num_cpu == 1) ? "" : "s");
+
+	if (num_cpu == 0)
+		plugin_unregister_read ("cpufreq");
 #endif /* defined(KERNEL_LINUX) */
 
-	return;
-}
+	return (0);
+} /* int cpufreq_init */
 
-static void cpufreq_write (char *host, char *inst, char *val)
+static void cpufreq_submit (int cpu_num, double value)
 {
-        int status;
-        char file[BUFSIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-        status = snprintf (file, BUFSIZE, cpufreq_file, inst);
-        if (status < 1 || status >= BUFSIZE)
-                return;
+	values[0].gauge = value;
 
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "cpufreq");
+	snprintf (vl.type_instance, sizeof (vl.type_instance),
+			"%i", cpu_num);
 
-#if CPUFREQ_HAVE_READ
-static void cpufreq_submit (int cpu_num, unsigned long long val)
-{
-	char buf[BUFSIZE];
-	char cpu[16];
-
-	if (snprintf (buf, BUFSIZE, "%u:%llu", (unsigned int) curtime, val) >= BUFSIZE)
-		return;
-        snprintf (cpu, 16, "%i", cpu_num);
-
-	plugin_submit (MODULE_NAME, cpu, buf);
+	plugin_dispatch_values ("cpufreq", &vl);
 }
 
-static void cpufreq_read (void)
+static int cpufreq_read (void)
 {
 #ifdef KERNEL_LINUX
         int status;
 	unsigned long long val;
 	int i = 0;
 	FILE *fp;
-	char filename[BUFSIZE];
+	char filename[256];
 	char buffer[16];
 
 	for (i = 0; i < num_cpu; i++)
 	{
-		status = snprintf (filename, BUFSIZE, "/sys/devices/system/cpu/cpu%d/cpufreq/scaling_cur_freq", i);
-    		if (status < 1 || status >= BUFSIZE)
-			return;
+		status = snprintf (filename, sizeof (filename),
+				"/sys/devices/system/cpu/cpu%d/cpufreq/"
+				"scaling_cur_freq", i);
+    		if (status < 1 || status >= sizeof (filename))
+			return (-1);
 
 		if ((fp = fopen (filename, "r")) == NULL)
 		{
-			syslog (LOG_WARNING, "cpufreq: fopen: %s", strerror (errno));
-			return;
+			char errbuf[1024];
+			WARNING ("cpufreq: fopen (%s): %s", filename,
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
+			return (-1);
 		}
 
 		if (fgets (buffer, 16, fp) == NULL)
 		{
-			syslog (LOG_WARNING, "cpufreq: fgets: %s", strerror (errno));
+			char errbuf[1024];
+			WARNING ("cpufreq: fgets: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			fclose (fp);
-			return;
+			return (-1);
 		}
 
 		if (fclose (fp))
-			syslog (LOG_WARNING, "cpufreq: fclose: %s", strerror (errno));
+		{
+			char errbuf[1024];
+			WARNING ("cpufreq: fclose: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
+		}
+
 
 		/* You're seeing correctly: The file is reporting kHz values.. */
 		val = atoll (buffer) * 1000;
 
 		cpufreq_submit (i, val);
 	}
 #endif /* defined(KERNEL_LINUX) */
 
-	return;
-}
-#else
-#define cpufreq_read NULL
-#endif
+	return (0);
+} /* int cpufreq_read */
+#endif /* CPUFREQ_HAVE_READ */
 #undef BUFSIZE
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, cpufreq_init, cpufreq_read, cpufreq_write);
+#if CPUFREQ_HAVE_READ
+	plugin_register_init ("cpufreq", cpufreq_init);
+	plugin_register_read ("cpufreq", cpufreq_read);
+#endif /* CPUFREQ_HAVE_READ */
 }
-
-#undef MODULE_NAME
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: csv.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/df.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/df.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/df.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/df.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/df.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -24,14 +23,12 @@
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
 #include "utils_mount.h"
 #include "utils_ignorelist.h"
 
-#define MODULE_NAME "df"
-
 #if HAVE_STATFS || HAVE_STATVFS
 # define DF_HAVE_READ 1
 #else
 # define DF_HAVE_READ 0
 #endif
 
@@ -46,23 +43,14 @@
 #  include <sys/statfs.h>
 # endif
 # define STATANYFS statfs
 # define BLOCKSIZE(s) (s).f_bsize
 #endif
 
-static char *filename_template = "df-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:used:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	"DS:free:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int ds_num = 2;
-
-static char *config_keys[] =
+#if DF_HAVE_READ
+static const char *config_keys[] =
 {
 	"Device",
 	"MountPoint",
 	"FSType",
 	"IgnoreSelected",
 	NULL
@@ -70,27 +58,25 @@
 static int config_keys_num = 4;
 
 static ignorelist_t *il_device = NULL;
 static ignorelist_t *il_mountpoint = NULL;
 static ignorelist_t *il_fstype = NULL;
 
-#define BUFSIZE 512
-
-static void df_init (void)
+static int df_init (void)
 {
 	if (il_device == NULL)
 		il_device = ignorelist_create (1);
 	if (il_mountpoint == NULL)
 		il_mountpoint = ignorelist_create (1);
 	if (il_fstype == NULL)
 		il_fstype = ignorelist_create (1);
 
-	return;
+	return (0);
 }
 
-static int df_config (char *key, char *value)
+static int df_config (const char *key, const char *value)
 {
 	df_init ();
 
 	if (strcasecmp (key, "Device") == 0)
 	{
 		if (ignorelist_add (il_device, value))
@@ -128,84 +114,80 @@
 		return (0);
 	}
 
 	return (-1);
 }
 
-static void df_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE];
-	int status;
-
-	status = snprintf (file, BUFSIZE, filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= BUFSIZE)
-		return;
-
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
-
-#if DF_HAVE_READ
 static void df_submit (char *df_name,
-		unsigned long long df_used,
-		unsigned long long df_free)
+		gauge_t df_used,
+		gauge_t df_free)
 {
-	char buf[BUFSIZE];
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu", (unsigned int) curtime,
-				df_used, df_free) >= BUFSIZE)
-		return;
+	values[0].gauge = df_used;
+	values[1].gauge = df_free;
 
-	plugin_submit (MODULE_NAME, df_name, buf);
-}
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "df");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, df_name, sizeof (vl.type_instance));
+
+	plugin_dispatch_values ("df", &vl);
+} /* void df_submit */
 
-static void df_read (void)
+static int df_read (void)
 {
 #if HAVE_STATVFS
 	struct statvfs statbuf;
 #elif HAVE_STATFS
 	struct statfs statbuf;
 #endif
 	/* struct STATANYFS statbuf; */
 	cu_mount_t *mnt_list;
 	cu_mount_t *mnt_ptr;
 
 	unsigned long long blocksize;
-	unsigned long long df_free;
-	unsigned long long df_used;
-	char mnt_name[BUFSIZE];
+	gauge_t df_free;
+	gauge_t df_used;
+	char mnt_name[256];
 
 	mnt_list = NULL;
 	if (cu_mount_getlist (&mnt_list) == NULL)
-		return;
+		return (-1);
 
 	for (mnt_ptr = mnt_list; mnt_ptr != NULL; mnt_ptr = mnt_ptr->next)
 	{
 		if (STATANYFS (mnt_ptr->dir, &statbuf) < 0)
 		{
-			syslog (LOG_ERR, "statv?fs failed: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("statv?fs failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			continue;
 		}
 
 		if (!statbuf.f_blocks)
 			continue;
 
 		blocksize = BLOCKSIZE(statbuf);
 		df_free = statbuf.f_bfree * blocksize;
 		df_used = (statbuf.f_blocks - statbuf.f_bfree) * blocksize;
 
 		if (strcmp (mnt_ptr->dir, "/") == 0)
 		{
-			strncpy (mnt_name, "root", BUFSIZE);
+			strncpy (mnt_name, "root", sizeof (mnt_name));
 		}
 		else
 		{
 			int i, len;
 
-			strncpy (mnt_name, mnt_ptr->dir + 1, BUFSIZE);
+			strncpy (mnt_name, mnt_ptr->dir + 1, sizeof (mnt_name));
 			len = strlen (mnt_name);
 
 			for (i = 0; i < len; i++)
 				if (mnt_name[i] == '/')
 					mnt_name[i] = '-';
 		}
@@ -221,19 +203,20 @@
 			continue;
 
 		df_submit (mnt_name, df_used, df_free);
 	}
 
 	cu_mount_freelist (mnt_list);
-} /* static void df_read (void) */
-#else
-# define df_read NULL
+
+	return (0);
+} /* int df_read */
 #endif /* DF_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, df_init, df_read, df_write);
-	cf_register (MODULE_NAME, df_config, config_keys, config_keys_num);
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+#if DF_HAVE_READ
+	plugin_register_config ("df", df_config,
+			config_keys, config_keys_num);
+	plugin_register_init ("df", df_init);
+	plugin_register_read ("df", df_read);
+#endif
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/disk.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/disk.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/disk.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/disk.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/disk.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,15 +19,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "disk"
 
 #if HAVE_MACH_MACH_TYPES_H
 #  include <mach/mach_types.h>
 #endif
 #if HAVE_MACH_MACH_INIT_H
 #  include <mach/mach_init.h>
@@ -52,79 +48,66 @@
 #  include <IOKit/storage/IOBlockStorageDriver.h>
 #endif
 #if HAVE_IOKIT_IOBSD_H
 #  include <IOKit/IOBSD.h>
 #endif
 
+#if HAVE_LIMITS_H
+# include <limits.h>
+#endif
+#ifndef UINT_MAX
+#  define UINT_MAX 4294967295U
+#endif
+
 #if HAVE_IOKIT_IOKITLIB_H || KERNEL_LINUX || HAVE_LIBKSTAT
 # define DISK_HAVE_READ 1
 #else
 # define DISK_HAVE_READ 0
 #endif
 
-static char *disk_filename_template = "disk-%s.rrd";
-static char *part_filename_template = "partition-%s.rrd";
-
-/* 104857600 == 100 MB */
-static char *disk_ds_def[] =
-{
-	"DS:rcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rmerged:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rbytes:COUNTER:"COLLECTD_HEARTBEAT":0:104857600",
-	"DS:rtime:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wmerged:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wbytes:COUNTER:"COLLECTD_HEARTBEAT":0:104857600",
-	"DS:wtime:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int disk_ds_num = 8;
-
-static char *part_ds_def[] =
-{
-	"DS:rcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rbytes:COUNTER:"COLLECTD_HEARTBEAT":0:104857600",
-	"DS:wcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wbytes:COUNTER:"COLLECTD_HEARTBEAT":0:104857600",
-	NULL
-};
-static int part_ds_num = 4;
-
+#if DISK_HAVE_READ
 #if HAVE_IOKIT_IOKITLIB_H
 static mach_port_t io_master_port = MACH_PORT_NULL;
 /* #endif HAVE_IOKIT_IOKITLIB_H */
 
 #elif KERNEL_LINUX
 typedef struct diskstats
 {
 	char *name;
 
-	/* This overflows in roughly 1361 year */
+	/* This overflows in roughly 1361 years */
 	unsigned int poll_count;
 
-	unsigned long long read_sectors;
-	unsigned long long write_sectors;
+	counter_t read_sectors;
+	counter_t write_sectors;
+
+	counter_t read_bytes;
+	counter_t write_bytes;
+
+	counter_t read_ops;
+	counter_t write_ops;
+	counter_t read_time;
+	counter_t write_time;
 
-	unsigned long long read_bytes;
-	unsigned long long write_bytes;
+	counter_t avg_read_time;
+	counter_t avg_write_time;
 
 	struct diskstats *next;
 } diskstats_t;
 
 static diskstats_t *disklist;
-static int min_poll_count;
 /* #endif KERNEL_LINUX */
 
 #elif HAVE_LIBKSTAT
 #define MAX_NUMDISK 256
 extern kstat_ctl_t *kc;
 static kstat_t *ksp[MAX_NUMDISK];
 static int numdisk = 0;
 #endif /* HAVE_LIBKSTAT */
 
-static void disk_init (void)
+static int disk_init (void)
 {
 #if HAVE_IOKIT_IOKITLIB_H
 	kern_return_t status;
 	
 	if (io_master_port != MACH_PORT_NULL)
 	{
@@ -133,40 +116,30 @@
 		io_master_port = MACH_PORT_NULL;
 	}
 
 	status = IOMasterPort (MACH_PORT_NULL, &io_master_port);
 	if (status != kIOReturnSuccess)
 	{
-		syslog (LOG_ERR, "IOMasterPort failed: %s",
+		ERROR ("IOMasterPort failed: %s",
 				mach_error_string (status));
 		io_master_port = MACH_PORT_NULL;
-		return;
+		return (-1);
 	}
 /* #endif HAVE_IOKIT_IOKITLIB_H */
 
 #elif KERNEL_LINUX
-	int step;
-	int heartbeat;
-
-	step = atoi (COLLECTD_STEP);
-	heartbeat = atoi (COLLECTD_HEARTBEAT);
-
-	assert (step > 0);
-	assert (heartbeat >= step);
-
-	min_poll_count = 1 + (heartbeat / step);
-	DBG ("min_poll_count = %i;", min_poll_count);
+	/* do nothing */
 /* #endif KERNEL_LINUX */
 
 #elif HAVE_LIBKSTAT
 	kstat_t *ksp_chain;
 
 	numdisk = 0;
 
 	if (kc == NULL)
-		return;
+		return (-1);
 
 	for (numdisk = 0, ksp_chain = kc->kc_chain;
 			(numdisk < MAX_NUMDISK) && (ksp_chain != NULL);
 			ksp_chain = ksp_chain->ks_next)
 	{
 		if (strncmp (ksp_chain->ks_class, "disk", 4)
@@ -175,89 +148,35 @@
 		if (ksp_chain->ks_type != KSTAT_TYPE_IO)
 			continue;
 		ksp[numdisk++] = ksp_chain;
 	}
 #endif /* HAVE_LIBKSTAT */
 
-	return;
-}
-
-static void disk_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, disk_filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, disk_ds_def, disk_ds_num);
-}
-
-static void partition_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, part_filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, part_ds_def, part_ds_num);
-}
-
-#if DISK_HAVE_READ
-#define BUFSIZE 512
-static void disk_submit (char *disk_name,
-		unsigned long long read_count,
-		unsigned long long read_merged,
-		unsigned long long read_bytes,
-		unsigned long long read_time,
-		unsigned long long write_count,
-		unsigned long long write_merged,
-		unsigned long long write_bytes,
-		unsigned long long write_time)
-{
-	char buf[BUFSIZE];
-
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu",
-				(unsigned int) curtime,
-				read_count, read_merged, read_bytes, read_time,
-				write_count, write_merged, write_bytes,
-				write_time) >= BUFSIZE)
-		return;
-
-	DBG ("disk_name = %s; buf = %s;",
-			disk_name, buf);
-
-	plugin_submit (MODULE_NAME, disk_name, buf);
-}
-
-#if KERNEL_LINUX || HAVE_LIBKSTAT
-static void partition_submit (char *part_name,
-		unsigned long long read_count,
-		unsigned long long read_bytes,
-		unsigned long long write_count,
-		unsigned long long write_bytes)
-{
-	char buf[BUFSIZE];
+	return (0);
+} /* int disk_init */
 
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu",
-				(unsigned int) curtime,
-				read_count, read_bytes, write_count,
-				write_bytes) >= BUFSIZE)
-		return;
+static void disk_submit (const char *plugin_instance,
+		const char *type,
+		counter_t read, counter_t write)
+{
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
+
+	values[0].counter = read;
+	values[1].counter = write;
+
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "disk");
+	strncpy (vl.plugin_instance, plugin_instance,
+			sizeof (vl.plugin_instance));
 
-	plugin_submit ("partition", part_name, buf);
-}
-#endif /* KERNEL_LINUX || HAVE_LIBKSTAT */
-#undef BUFSIZE
+	plugin_dispatch_values (type, &vl);
+} /* void disk_submit */
 
 #if HAVE_IOKIT_IOKITLIB_H
 static signed long long dict_get_value (CFDictionaryRef dict, const char *key)
 {
 	signed long long val_int;
 	CFNumberRef      val_obj;
@@ -265,38 +184,38 @@
 
 	/* `key_obj' needs to be released. */
 	key_obj = CFStringCreateWithCString (kCFAllocatorDefault, key,
 		       	kCFStringEncodingASCII);
 	if (key_obj == NULL)
 	{
-		DBG ("CFStringCreateWithCString (%s) failed.", key);
+		DEBUG ("CFStringCreateWithCString (%s) failed.", key);
 		return (-1LL);
 	}
 	
 	/* get => we don't need to release (== free) the object */
 	val_obj = (CFNumberRef) CFDictionaryGetValue (dict, key_obj);
 
 	CFRelease (key_obj);
 
 	if (val_obj == NULL)
 	{
-		DBG ("CFDictionaryGetValue (%s) failed.", key);
+		DEBUG ("CFDictionaryGetValue (%s) failed.", key);
 		return (-1LL);
 	}
 
 	if (!CFNumberGetValue (val_obj, kCFNumberSInt64Type, &val_int))
 	{
-		DBG ("CFNumberGetValue (%s) failed.", key);
+		DEBUG ("CFNumberGetValue (%s) failed.", key);
 		return (-1LL);
 	}
 
 	return (val_int);
 }
 #endif /* HAVE_IOKIT_IOKITLIB_H */
 
-static void disk_read (void)
+static int disk_read (void)
 {
 #if HAVE_IOKIT_IOKITLIB_H
 	io_registry_entry_t	disk;
 	io_registry_entry_t	disk_child;
 	io_iterator_t		disk_list;
 	CFDictionaryRef		props_dict;
@@ -321,13 +240,13 @@
 	if (IOServiceGetMatchingServices (io_master_port,
 				IOServiceMatching (kIOBlockStorageDriverClass),
 				&disk_list) != kIOReturnSuccess)
 	{
 		plugin_complain (LOG_ERR, &complain_obj, "disk plugin: "
 				"IOServiceGetMatchingServices failed.");
-		return;
+		return (-1);
 	}
 	else if (complain_obj.interval != 0)
 	{
 		plugin_relief (LOG_NOTICE, &complain_obj, "disk plugin: "
 				"IOServiceGetMatchingServices succeeded.");
 	}
@@ -340,44 +259,44 @@
 
 		/* `disk_child' must be released */
 		if ((status = IORegistryEntryGetChildEntry (disk, kIOServicePlane, &disk_child))
 			       	!= kIOReturnSuccess)
 		{
 			/* This fails for example for DVD/CD drives.. */
-			DBG ("IORegistryEntryGetChildEntry (disk) failed: 0x%08x", status);
+			DEBUG ("IORegistryEntryGetChildEntry (disk) failed: 0x%08x", status);
 			IOObjectRelease (disk);
 			continue;
 		}
 
 		/* We create `props_dict' => we need to release it later */
 		if (IORegistryEntryCreateCFProperties (disk,
 					(CFMutableDictionaryRef *) &props_dict,
 					kCFAllocatorDefault,
 					kNilOptions)
 				!= kIOReturnSuccess)
 		{
-			syslog (LOG_ERR, "disk-plugin: IORegistryEntryCreateCFProperties failed.");
+			ERROR ("disk-plugin: IORegistryEntryCreateCFProperties failed.");
 			IOObjectRelease (disk_child);
 			IOObjectRelease (disk);
 			continue;
 		}
 
 		if (props_dict == NULL)
 		{
-			DBG ("IORegistryEntryCreateCFProperties (disk) failed.");
+			DEBUG ("IORegistryEntryCreateCFProperties (disk) failed.");
 			IOObjectRelease (disk_child);
 			IOObjectRelease (disk);
 			continue;
 		}
 
 		stats_dict = (CFDictionaryRef) CFDictionaryGetValue (props_dict,
 				CFSTR (kIOBlockStorageDriverStatisticsKey));
 
 		if (stats_dict == NULL)
 		{
-			DBG ("CFDictionaryGetValue (%s) failed.",
+			DEBUG ("CFDictionaryGetValue (%s) failed.",
 				       	kIOBlockStorageDriverStatisticsKey);
 			CFRelease (props_dict);
 			IOObjectRelease (disk_child);
 			IOObjectRelease (disk);
 			continue;
 		}
@@ -385,19 +304,20 @@
 		if (IORegistryEntryCreateCFProperties (disk_child,
 					(CFMutableDictionaryRef *) &child_dict,
 					kCFAllocatorDefault,
 					kNilOptions)
 				!= kIOReturnSuccess)
 		{
-			DBG ("IORegistryEntryCreateCFProperties (disk_child) failed.");
+			DEBUG ("IORegistryEntryCreateCFProperties (disk_child) failed.");
 			IOObjectRelease (disk_child);
 			CFRelease (props_dict);
 			IOObjectRelease (disk);
 			continue;
 		}
 
+		/* kIOBSDNameKey */
 		disk_major = (int) dict_get_value (child_dict,
 			       	kIOBSDMajorKey);
 		disk_minor = (int) dict_get_value (child_dict,
 			       	kIOBSDMinorKey);
 		read_ops  = dict_get_value (stats_dict,
 				kIOBlockStorageDriverStatisticsReadsKey);
@@ -406,100 +326,104 @@
 		read_tme  = dict_get_value (stats_dict,
 				kIOBlockStorageDriverStatisticsTotalReadTimeKey);
 		write_ops = dict_get_value (stats_dict,
 				kIOBlockStorageDriverStatisticsWritesKey);
 		write_byt = dict_get_value (stats_dict,
 				kIOBlockStorageDriverStatisticsBytesWrittenKey);
+		/* This property describes the number of nanoseconds spent
+		 * performing writes since the block storage driver was
+		 * instantiated. It is one of the statistic entries listed
+		 * under the top-level kIOBlockStorageDriverStatisticsKey
+		 * property table. It has an OSNumber value. */
 		write_tme = dict_get_value (stats_dict,
 				kIOBlockStorageDriverStatisticsTotalWriteTimeKey);
 
 		if (snprintf (disk_name, 64, "%i-%i", disk_major, disk_minor) >= 64)
 		{
-			DBG ("snprintf (major, minor) failed.");
+			DEBUG ("snprintf (major, minor) failed.");
 			CFRelease (child_dict);
 			IOObjectRelease (disk_child);
 			CFRelease (props_dict);
 			IOObjectRelease (disk);
 			continue;
 		}
-		DBG ("disk_name = %s", disk_name);
+		DEBUG ("disk_name = %s", disk_name);
 
-		if ((read_ops != -1LL)
-				|| (read_byt != -1LL)
-				|| (read_tme != -1LL)
-				|| (write_ops != -1LL)
-				|| (write_byt != -1LL)
-				|| (write_tme != -1LL))
-			disk_submit (disk_name,
-					read_ops, 0ULL, read_byt, read_tme,
-					write_ops, 0ULL, write_byt, write_tme);
+		if ((read_byt != -1LL) || (write_byt != -1LL))
+			disk_submit (disk_name, "disk_octets", read_byt, write_byt);
+		if ((read_ops != -1LL) || (write_ops != -1LL))
+			disk_submit (disk_name, "disk_ops", read_ops, write_ops);
+		if ((read_tme != -1LL) || (write_tme != -1LL))
+			disk_submit (disk_name, "disk_time",
+					read_tme / 1000,
+					write_tme / 1000);
 
 		CFRelease (child_dict);
 		IOObjectRelease (disk_child);
 		CFRelease (props_dict);
 		IOObjectRelease (disk);
 	}
 	IOObjectRelease (disk_list);
 /* #endif HAVE_IOKIT_IOKITLIB_H */
 
 #elif KERNEL_LINUX
 	FILE *fh;
 	char buffer[1024];
-	char disk_name[128];
 	
 	char *fields[32];
 	int numfields;
 	int fieldshift = 0;
 
 	int major = 0;
 	int minor = 0;
 
-	unsigned long long read_sectors  = 0ULL;
-	unsigned long long write_sectors = 0ULL;
+	counter_t read_sectors  = 0;
+	counter_t write_sectors = 0;
 
-	unsigned long long read_count    = 0ULL;
-	unsigned long long read_merged   = 0ULL;
-	unsigned long long read_bytes    = 0ULL;
-	unsigned long long read_time     = 0ULL;
-	unsigned long long write_count   = 0ULL;
-	unsigned long long write_merged  = 0ULL;
-	unsigned long long write_bytes   = 0ULL;
-	unsigned long long write_time    = 0ULL;
+	counter_t read_ops      = 0;
+	counter_t read_merged   = 0;
+	counter_t read_time     = 0;
+	counter_t write_ops     = 0;
+	counter_t write_merged  = 0;
+	counter_t write_time    = 0;
 	int is_disk = 0;
 
 	diskstats_t *ds, *pre_ds;
 
 	static complain_t complain_obj;
 
 	if ((fh = fopen ("/proc/diskstats", "r")) == NULL)
 	{
 		if ((fh = fopen ("/proc/partitions", "r")) == NULL)
 		{
-			plugin_complain (LOG_ERR, &complain_obj, "disk plugin: Failed to open /proc/{diskstats,partitions}.");
-			return;
+			plugin_complain (LOG_ERR, &complain_obj,
+					"disk plugin: Failed to open /proc/"
+					"{diskstats,partitions}.");
+			return (-1);
 		}
 
 		/* Kernel is 2.4.* */
 		fieldshift = 1;
 	}
 
-	plugin_relief (LOG_NOTICE, &complain_obj, "disk plugin: Succeeded to open /proc/{diskstats,partitions}.");
+	plugin_relief (LOG_NOTICE, &complain_obj, "disk plugin: "
+			"Succeeded to open /proc/{diskstats,partitions}.");
 
-	while (fgets (buffer, 1024, fh) != NULL)
+	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
+		char *disk_name;
+
 		numfields = strsplit (buffer, fields, 32);
 
 		if ((numfields != (14 + fieldshift)) && (numfields != 7))
 			continue;
 
 		major = atoll (fields[0]);
 		minor = atoll (fields[1]);
 
-		if (snprintf (disk_name, 128, "%i-%i", major, minor) < 1)
-			continue;
-		disk_name[127] = '\0';
+		disk_name = fields[2];
 
 		for (ds = disklist, pre_ds = disklist; ds != NULL; pre_ds = ds, ds = ds->next)
 			if (strcmp (disk_name, ds->name) == 0)
 				break;
 
 		if (ds == NULL)
@@ -520,21 +444,21 @@
 		}
 
 		is_disk = 0;
 		if (numfields == 7)
 		{
 			/* Kernel 2.6, Partition */
-			read_count    = atoll (fields[3]);
+			read_ops      = atoll (fields[3]);
 			read_sectors  = atoll (fields[4]);
-			write_count   = atoll (fields[5]);
+			write_ops     = atoll (fields[5]);
 			write_sectors = atoll (fields[6]);
 		}
 		else if (numfields == (14 + fieldshift))
 		{
-			read_count  =  atoll (fields[3 + fieldshift]);
-			write_count =  atoll (fields[7 + fieldshift]);
+			read_ops  =  atoll (fields[3 + fieldshift]);
+			write_ops =  atoll (fields[7 + fieldshift]);
 
 			read_sectors  = atoll (fields[5 + fieldshift]);
 			write_sectors = atoll (fields[9 + fieldshift]);
 
 			if ((fieldshift == 0) || (minor == 0))
 			{
@@ -544,85 +468,183 @@
 				write_merged = atoll (fields[8 + fieldshift]);
 				write_time   = atoll (fields[10+ fieldshift]);
 			}
 		}
 		else
 		{
-			DBG ("numfields = %i; => unknown file format.", numfields);
+			DEBUG ("numfields = %i; => unknown file format.", numfields);
 			continue;
 		}
 
+		{
+			counter_t diff_read_sectors;
+			counter_t diff_write_sectors;
+
 		/* If the counter wraps around, it's only 32 bits.. */
-		if (read_sectors < ds->read_sectors)
-			ds->read_bytes += 512 * ((0xFFFFFFFF - ds->read_sectors) + read_sectors);
-		else
-			ds->read_bytes += 512 * (read_sectors - ds->read_sectors);
+			if (read_sectors < ds->read_sectors)
+				diff_read_sectors = 1 + read_sectors
+					+ (UINT_MAX - ds->read_sectors);
+			else
+				diff_read_sectors = read_sectors - ds->read_sectors;
+			if (write_sectors < ds->write_sectors)
+				diff_write_sectors = 1 + write_sectors
+					+ (UINT_MAX - ds->write_sectors);
+			else
+				diff_write_sectors = write_sectors - ds->write_sectors;
 
-		if (write_sectors < ds->write_sectors)
-			ds->write_bytes += 512 * ((0xFFFFFFFF - ds->write_sectors) + write_sectors);
-		else
-			ds->write_bytes += 512 * (write_sectors - ds->write_sectors);
+			ds->read_bytes += 512 * diff_read_sectors;
+			ds->write_bytes += 512 * diff_write_sectors;
+			ds->read_sectors = read_sectors;
+			ds->write_sectors = write_sectors;
+		}
 
-		ds->read_sectors  = read_sectors;
-		ds->write_sectors = write_sectors;
-		read_bytes  = ds->read_bytes;
-		write_bytes = ds->write_bytes;
+		/* Calculate the average time an io-op needs to complete */
+		if (is_disk)
+		{
+			counter_t diff_read_ops;
+			counter_t diff_write_ops;
+			counter_t diff_read_time;
+			counter_t diff_write_time;
+
+			if (read_ops < ds->read_ops)
+				diff_read_ops = 1 + read_ops
+					+ (UINT_MAX - ds->read_ops);
+			else
+				diff_read_ops = read_ops - ds->read_ops;
+			DEBUG ("disk plugin: disk_name = %s; read_ops = %llu; "
+					"ds->read_ops = %llu; diff_read_ops = %llu;",
+					disk_name,
+					read_ops, ds->read_ops, diff_read_ops);
+
+			if (write_ops < ds->write_ops)
+				diff_write_ops = 1 + write_ops
+					+ (UINT_MAX - ds->write_ops);
+			else
+				diff_write_ops = write_ops - ds->write_ops;
+
+			if (read_time < ds->read_time)
+				diff_read_time = 1 + read_time
+					+ (UINT_MAX - ds->read_time);
+			else
+				diff_read_time = read_time - ds->read_time;
+
+			if (write_time < ds->write_time)
+				diff_write_time = 1 + write_time
+					+ (UINT_MAX - ds->write_time);
+			else
+				diff_write_time = write_time - ds->write_time;
+
+			if (diff_read_ops != 0)
+				ds->avg_read_time += (diff_read_time
+						+ (diff_read_ops / 2))
+					/ diff_read_ops;
+			if (diff_write_ops != 0)
+				ds->avg_write_time += (diff_write_time
+						+ (diff_write_ops / 2))
+					/ diff_write_ops;
+
+			ds->read_ops = read_ops;
+			ds->read_time = read_time;
+			ds->write_ops = write_ops;
+			ds->write_time = write_time;
+		} /* if (is_disk) */
 
 		/* Don't write to the RRDs if we've just started.. */
 		ds->poll_count++;
-		if (ds->poll_count <= min_poll_count)
+		if (ds->poll_count <= 2)
 		{
-			DBG ("(ds->poll_count = %i) <= (min_poll_count = %i); => Not writing.",
-					ds->poll_count, min_poll_count);
+			DEBUG ("disk plugin: (ds->poll_count = %i) <= "
+					"(min_poll_count = 2); => Not writing.",
+					ds->poll_count);
 			continue;
 		}
 
-		if ((read_count == 0) && (write_count == 0))
+		if ((read_ops == 0) && (write_ops == 0))
 		{
-			DBG ("((read_count == 0) && (write_count == 0)); => Not writing.");
+			DEBUG ("disk plugin: ((read_ops == 0) && "
+					"(write_ops == 0)); => Not writing.");
 			continue;
 		}
 
+		if ((ds->read_bytes != 0) || (ds->write_bytes != 0))
+			disk_submit (disk_name, "disk_octets",
+					ds->read_bytes, ds->write_bytes);
+
+		if ((ds->read_ops != 0) || (ds->write_ops != 0))
+			disk_submit (disk_name, "disk_ops",
+					read_ops, write_ops);
+
+		if ((ds->avg_read_time != 0) || (ds->avg_write_time != 0))
+			disk_submit (disk_name, "disk_time",
+					ds->avg_read_time, ds->avg_write_time);
+
 		if (is_disk)
-			disk_submit (disk_name, read_count, read_merged, read_bytes, read_time,
-					write_count, write_merged, write_bytes, write_time);
-		else
-			partition_submit (disk_name, read_count, read_bytes, write_count, write_bytes);
-	}
+		{
+			if ((read_merged != -1LL) || (write_merged != -1LL))
+				disk_submit (disk_name, "disk_merged",
+						read_merged, write_merged);
+		} /* if (is_disk) */
+	} /* while (fgets (buffer, sizeof (buffer), fh) != NULL) */
 
 	fclose (fh);
 /* #endif defined(KERNEL_LINUX) */
 
 #elif HAVE_LIBKSTAT
+# if HAVE_KSTAT_IO_T_WRITES && HAVE_KSTAT_IO_T_NWRITES && HAVE_KSTAT_IO_T_WTIME
+#  define KIO_ROCTETS reads
+#  define KIO_WOCTETS writes
+#  define KIO_ROPS    nreads
+#  define KIO_WOPS    nwrites
+#  define KIO_RTIME   rtime
+#  define KIO_WTIME   wtime
+# elif HAVE_KSTAT_IO_T_NWRITTEN && HAVE_KSTAT_IO_T_WRITES && HAVE_KSTAT_IO_T_WTIME
+#  define KIO_ROCTETS nread
+#  define KIO_WOCTETS nwritten
+#  define KIO_ROPS    reads
+#  define KIO_WOPS    writes
+#  define KIO_RTIME   rtime
+#  define KIO_WTIME   wtime
+# else
+#  error "kstat_io_t does not have the required members"
+# endif
 	static kstat_io_t kio;
 	int i;
 
 	if (kc == NULL)
-		return;
+		return (-1);
 
 	for (i = 0; i < numdisk; i++)
 	{
 		if (kstat_read (kc, ksp[i], &kio) == -1)
 			continue;
 
 		if (strncmp (ksp[i]->ks_class, "disk", 4) == 0)
-			disk_submit (ksp[i]->ks_name,
-					kio.reads,  0LL, kio.nread,    kio.rtime,
-					kio.writes, 0LL, kio.nwritten, kio.wtime);
+		{
+			disk_submit (ksp[i]->ks_name, "disk_octets",
+					kio.KIO_ROCTETS, kio.KIO_WOCTETS);
+			disk_submit (ksp[i]->ks_name, "disk_ops",
+					kio.KIO_ROPS, kio.KIO_WOPS);
+			/* FIXME: Convert this to microseconds if necessary */
+			disk_submit (ksp[i]->ks_name, "disk_time",
+					kio.KIO_RTIME, kio.KIO_WTIME);
+		}
 		else if (strncmp (ksp[i]->ks_class, "partition", 9) == 0)
-			partition_submit (ksp[i]->ks_name,
-					kio.reads, kio.nread,
-					kio.writes,kio.nwritten);
+		{
+			disk_submit (ksp[i]->ks_name, "disk_octets",
+					kio.KIO_ROCTETS, kio.KIO_WOCTETS);
+			disk_submit (ksp[i]->ks_name, "disk_ops",
+					kio.KIO_ROPS, kio.KIO_WOPS);
+		}
 	}
 #endif /* defined(HAVE_LIBKSTAT) */
-} /* static void disk_read (void) */
-#else
-# define disk_read NULL
+
+	return (0);
+} /* int disk_read */
 #endif /* DISK_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register ("partition", NULL, NULL, partition_write);
-	plugin_register (MODULE_NAME, disk_init, disk_read, disk_write);
-}
-
-#undef MODULE_NAME
+#if DISK_HAVE_READ
+	plugin_register_init ("disk", disk_init);
+	plugin_register_read ("disk", disk_read);
+#endif /* DISK_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/dns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/dns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/dns.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/dns.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/dns.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006,2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -21,21 +20,18 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "dns"
 
 #if HAVE_LIBPCAP && HAVE_LIBPTHREAD
 # include "utils_dns.h"
 # include <pthread.h>
 # include <pcap.h>
-# include <sys/poll.h>
+# include <poll.h>
 # define DNS_HAVE_READ 1
 #else
 # define DNS_HAVE_READ 0
 #endif
 
 /*
@@ -51,61 +47,26 @@
 typedef struct counter_list_s counter_list_t;
 #endif
 
 /*
  * Private variables
  */
-static char *traffic_file   = "dns/dns_traffic.rrd";
-static char *qtype_file   = "dns/qtype-%s.rrd";
-static char *opcode_file  = "dns/opcode-%s.rrd";
-static char *rcode_file   = "dns/rcode-%s.rrd";
-
-static char *traffic_ds_def[] =
-{
-	/* Limit to 1GBit/s */
-	"DS:queries:COUNTER:"COLLECTD_HEARTBEAT":0:125000000",
-	"DS:responses:COUNTER:"COLLECTD_HEARTBEAT":0:125000000",
-	NULL
-};
-static int traffic_ds_num = 2;
-
-static char *qtype_ds_def[] =
-{
-	"DS:value:COUNTER:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int qtype_ds_num = 1;
-
-static char *opcode_ds_def[] =
-{
-	"DS:value:COUNTER:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int opcode_ds_num = 1;
-
-static char *rcode_ds_def[] =
-{
-	"DS:value:COUNTER:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int rcode_ds_num = 1;
-
 #if DNS_HAVE_READ
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Interface",
 	"IgnoreSource",
 	NULL
 };
 static int config_keys_num = 2;
 
 #define PCAP_SNAPLEN 1460
 static char   *pcap_device = NULL;
 
-static unsigned int    tr_queries;
-static unsigned int    tr_responses;
+static counter_t       tr_queries;
+static counter_t       tr_responses;
 static counter_list_t *qtype_list;
 static counter_list_t *opcode_list;
 static counter_list_t *rcode_list;
 
 static pthread_t       listen_thread;
 static int             listen_thread_init = 0;
@@ -121,29 +82,29 @@
  */
 #if DNS_HAVE_READ
 static counter_list_t *counter_list_search (counter_list_t **list, unsigned int key)
 {
 	counter_list_t *entry;
 
-	DBG ("counter_list_search (list = %p, key = %u)",
+	DEBUG ("counter_list_search (list = %p, key = %u)",
 			(void *) *list, key);
 
 	for (entry = *list; entry != NULL; entry = entry->next)
 		if (entry->key == key)
 			break;
 
-	DBG ("return (%p)", (void *) entry);
+	DEBUG ("return (%p)", (void *) entry);
 	return (entry);
 }
 
 static counter_list_t *counter_list_create (counter_list_t **list,
 		unsigned int key, unsigned int value)
 {
 	counter_list_t *entry;
 
-	DBG ("counter_list_create (list = %p, key = %u, value = %u)",
+	DEBUG ("counter_list_create (list = %p, key = %u, value = %u)",
 			(void *) *list, key, value);
 
 	entry = (counter_list_t *) malloc (sizeof (counter_list_t));
 	if (entry == NULL)
 		return (NULL);
 
@@ -163,38 +124,38 @@
 		while (last->next != NULL)
 			last = last->next;
 
 		last->next = entry;
 	}
 
-	DBG ("return (%p)", (void *) entry);
+	DEBUG ("return (%p)", (void *) entry);
 	return (entry);
 }
 
 static void counter_list_add (counter_list_t **list,
 		unsigned int key, unsigned int increment)
 {
 	counter_list_t *entry;
 
-	DBG ("counter_list_add (list = %p, key = %u, increment = %u)",
+	DEBUG ("counter_list_add (list = %p, key = %u, increment = %u)",
 			(void *) *list, key, increment);
 
 	entry = counter_list_search (list, key);
 
 	if (entry != NULL)
 	{
 		entry->value += increment;
 	}
 	else
 	{
 		counter_list_create (list, key, increment);
 	}
-	DBG ("return ()");
+	DEBUG ("return ()");
 }
 
-static int dns_config (char *key, char *value)
+static int dns_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "Interface") == 0)
 	{
 		if (pcap_device != NULL)
 			free (pcap_device);
 		if ((pcap_device = strdup (value)) == NULL)
@@ -257,214 +218,142 @@
 		sigset_t sigmask;
 		sigemptyset (&sigmask);
 		pthread_sigmask (SIG_SETMASK, &sigmask, NULL);
 	}
 
 	/* Passing `pcap_device == NULL' is okay and the same as passign "any" */
-	DBG ("Creating PCAP object..");
+	DEBUG ("Creating PCAP object..");
 	pcap_obj = pcap_open_live (pcap_device,
 			PCAP_SNAPLEN,
 			0 /* Not promiscuous */,
-			atoi (COLLECTD_STEP),
+			interval_g,
 			pcap_error);
 	if (pcap_obj == NULL)
 	{
-		syslog (LOG_ERR, "dns plugin: Opening interface `%s' "
+		ERROR ("dns plugin: Opening interface `%s' "
 				"failed: %s",
 				(pcap_device != NULL) ? pcap_device : "any",
 				pcap_error);
 		return (NULL);
 	}
 
 	memset (&fp, 0, sizeof (fp));
 	if (pcap_compile (pcap_obj, &fp, "udp port 53", 1, 0) < 0)
 	{
-		DBG ("pcap_compile failed");
-		syslog (LOG_ERR, "dns plugin: pcap_compile failed");
+		DEBUG ("pcap_compile failed");
+		ERROR ("dns plugin: pcap_compile failed");
 		return (NULL);
 	}
 	if (pcap_setfilter (pcap_obj, &fp) < 0)
 	{
-		DBG ("pcap_setfilter failed");
-		syslog (LOG_ERR, "dns plugin: pcap_setfilter failed");
+		DEBUG ("pcap_setfilter failed");
+		ERROR ("dns plugin: pcap_setfilter failed");
 		return (NULL);
 	}
 
-	DBG ("PCAP object created.");
+	DEBUG ("PCAP object created.");
 
 	dnstop_set_pcap_obj (pcap_obj);
 	dnstop_set_callback (dns_child_callback);
 
 	status = pcap_loop (pcap_obj,
 			-1 /* loop forever */,
 			handle_pcap /* callback */,
 			NULL /* Whatever this means.. */);
 	if (status < 0)
-		syslog (LOG_ERR, "dns plugin: Listener thread is exiting "
+		ERROR ("dns plugin: Listener thread is exiting "
 				"abnormally: %s", pcap_geterr (pcap_obj));
 
-	DBG ("child is exiting");
+	DEBUG ("child is exiting");
 
 	pcap_close (pcap_obj);
 	listen_thread_init = 0;
 	pthread_exit (NULL);
 
 	return (NULL);
 } /* static void dns_child_loop (void) */
-#endif /* DNS_HAVE_READ */
 
-static void dns_init (void)
+static int dns_init (void)
 {
-#if DNS_HAVE_READ
 	/* clean up an old thread */
 	int status;
 
 	pthread_mutex_lock (&traffic_mutex);
 	tr_queries   = 0;
 	tr_responses = 0;
 	pthread_mutex_unlock (&traffic_mutex);
 
 	if (listen_thread_init != 0)
-		return;
+		return (-1);
 
 	status = pthread_create (&listen_thread, NULL, dns_child_loop,
 			(void *) 0);
 	if (status != 0)
 	{
-		syslog (LOG_ERR, "dns plugin: pthread_create failed: %s",
-				strerror (status));
-		return;
+		char errbuf[1024];
+		ERROR ("dns plugin: pthread_create failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	listen_thread_init = 1;
-#endif /* DNS_HAVE_READ */
-}
-
-static void traffic_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, traffic_file, val,
-			traffic_ds_def, traffic_ds_num);
-}
-
-static void qtype_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
 
-	status = snprintf (file, 512, qtype_file, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, qtype_ds_def, qtype_ds_num);
-}
-
-static void rcode_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, rcode_file, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, rcode_ds_def, rcode_ds_num);
-}
-
-static void opcode_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, opcode_file, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, opcode_ds_def, opcode_ds_num);
-}
-
-#if DNS_HAVE_READ
-static void traffic_submit (unsigned int queries, unsigned int replies)
-{
-	char buffer[64];
-	int  status;
-
-	status = snprintf (buffer, 64, "N:%u:%u", queries, replies);
-	if ((status < 1) || (status >= 64))
-		return;
-
-	plugin_submit ("dns_traffic", "-", buffer);
-}
+	return (0);
+} /* int dns_init */
 
-static void qtype_submit (int qtype, unsigned int counter)
+static void submit_counter (const char *type, const char *type_instance,
+		counter_t value)
 {
-	char inst[32];
-	char buffer[32];
-	int  status;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	strncpy (inst, qtype_str (qtype), 32);
-	inst[31] = '\0';
+	values[0].counter = value;
 
-	status = snprintf (buffer, 32, "N:%u", counter);
-	if ((status < 1) || (status >= 32))
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "dns");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-	plugin_submit ("dns_qtype", inst, buffer);
-}
+	plugin_dispatch_values (type, &vl);
+} /* void submit_counter */
 
-static void rcode_submit (int rcode, unsigned int counter)
+static void submit_octets (counter_t queries, counter_t responses)
 {
-	char inst[32];
-	char buffer[32];
-	int  status;
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	strncpy (inst, rcode_str (rcode), 32);
-	inst[31] = '\0';
+	values[0].counter = queries;
+	values[1].counter = responses;
 
-	status = snprintf (buffer, 32, "N:%u", counter);
-	if ((status < 1) || (status >= 32))
-		return;
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "dns");
 
-	plugin_submit ("dns_rcode", inst, buffer);
-}
+	plugin_dispatch_values ("dns_octets", &vl);
+} /* void submit_counter */
 
-static void opcode_submit (int opcode, unsigned int counter)
-{
-	char inst[32];
-	char buffer[32];
-	int  status;
-
-	strncpy (inst, opcode_str (opcode), 32);
-	inst[31] = '\0';
-
-	status = snprintf (buffer, 32, "N:%u", counter);
-	if ((status < 1) || (status >= 32))
-		return;
-
-	plugin_submit ("dns_opcode", inst, buffer);
-}
-
-static void dns_read (void)
+static int dns_read (void)
 {
 	unsigned int keys[T_MAX];
 	unsigned int values[T_MAX];
 	int len;
 	int i;
 
 	counter_list_t *ptr;
 
 	pthread_mutex_lock (&traffic_mutex);
 	values[0] = tr_queries;
 	values[1] = tr_responses;
 	pthread_mutex_unlock (&traffic_mutex);
-	traffic_submit (values[0], values[1]);
+
+	if ((values[0] != 0) || (values[1] != 0))
+		submit_octets (values[0], values[1]);
 
 	pthread_mutex_lock (&qtype_mutex);
 	for (ptr = qtype_list, len = 0;
 		       	(ptr != NULL) && (len < T_MAX);
 		       	ptr = ptr->next, len++)
 	{
@@ -472,14 +361,14 @@
 		values[len] = ptr->value;
 	}
 	pthread_mutex_unlock (&qtype_mutex);
 
 	for (i = 0; i < len; i++)
 	{
-		DBG ("qtype = %u; counter = %u;", keys[i], values[i]);
-		qtype_submit (keys[i], values[i]);
+		DEBUG ("qtype = %u; counter = %u;", keys[i], values[i]);
+		submit_counter ("dns_qtype", qtype_str (keys[i]), values[i]);
 	}
 
 	pthread_mutex_lock (&opcode_mutex);
 	for (ptr = opcode_list, len = 0;
 		       	(ptr != NULL) && (len < T_MAX);
 		       	ptr = ptr->next, len++)
@@ -488,14 +377,14 @@
 		values[len] = ptr->value;
 	}
 	pthread_mutex_unlock (&opcode_mutex);
 
 	for (i = 0; i < len; i++)
 	{
-		DBG ("opcode = %u; counter = %u;", keys[i], values[i]);
-		opcode_submit (keys[i], values[i]);
+		DEBUG ("opcode = %u; counter = %u;", keys[i], values[i]);
+		submit_counter ("dns_opcode", opcode_str (keys[i]), values[i]);
 	}
 
 	pthread_mutex_lock (&rcode_mutex);
 	for (ptr = rcode_list, len = 0;
 		       	(ptr != NULL) && (len < T_MAX);
 		       	ptr = ptr->next, len++)
@@ -504,27 +393,22 @@
 		values[len] = ptr->value;
 	}
 	pthread_mutex_unlock (&rcode_mutex);
 
 	for (i = 0; i < len; i++)
 	{
-		DBG ("rcode = %u; counter = %u;", keys[i], values[i]);
-		rcode_submit (keys[i], values[i]);
+		DEBUG ("rcode = %u; counter = %u;", keys[i], values[i]);
+		submit_counter ("dns_rcode", rcode_str (keys[i]), values[i]);
 	}
-}
-#else /* if !DNS_HAVE_READ */
-# define dns_read NULL
+
+	return (0);
+} /* int dns_read */
 #endif
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, dns_init, dns_read, NULL);
-	plugin_register ("dns_traffic", NULL, NULL, traffic_write);
-	plugin_register ("dns_qtype", NULL, NULL, qtype_write);
-	plugin_register ("dns_rcode", NULL, NULL, rcode_write);
-	plugin_register ("dns_opcode", NULL, NULL, opcode_write);
 #if DNS_HAVE_READ
-	cf_register (MODULE_NAME, dns_config, config_keys, config_keys_num);
+	plugin_register_config ("dns", dns_config, config_keys, config_keys_num);
+	plugin_register_init ("dns", dns_init);
+	plugin_register_read ("dns", dns_read);
 #endif
-}
-
-#undef MODULE_NAME
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/email.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/email.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/email.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/email.c	2007-05-30 18:33:14.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/email.c
- * Copyright (C) 2006  Sebastian Harl
+ * Copyright (C) 2006,2007  Sebastian Harl
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -39,31 +38,17 @@
 #include "plugin.h"
 
 #include "configfile.h"
 
 #if HAVE_LIBPTHREAD
 # include <pthread.h>
-# define EMAIL_HAVE_READ 1
-#else
-# define EMAIL_HAVE_READ 0
 #endif
 
-#if HAVE_SYS_SELECT_H
-#	include <sys/select.h>
-#endif /* HAVE_SYS_SELECT_H */
-
-#if HAVE_SYS_SOCKET_H
-#	include <sys/socket.h>
-#endif /* HAVE_SYS_SOCKET_H */
-
-/* *sigh* glibc does not define UNIX_PATH_MAX in sys/un.h ... */
-#if HAVE_LINUX_UN_H
-#	include <linux/un.h>
-#elif HAVE_SYS_UN_H
-#	include <sys/un.h>
-#endif /* HAVE_LINUX_UN_H | HAVE_SYS_UN_H */
+#include <sys/socket.h>
+#include <sys/un.h>
+#include <sys/select.h>
 
 /* some systems (e.g. Darwin) seem to not define UNIX_PATH_MAX at all */
 #ifndef UNIX_PATH_MAX
 # define UNIX_PATH_MAX sizeof (((struct sockaddr_un *)0)->sun_path)
 #endif /* UNIX_PATH_MAX */
 
@@ -81,19 +66,18 @@
 #endif /* COLLECTD_SOCKET_PREFIX */
 
 #define SOCK_PATH COLLECTD_SOCKET_PREFIX"email"
 #define MAX_CONNS 5
 #define MAX_CONNS_LIMIT 16384
 
-#define log_err(...) syslog (LOG_ERR, MODULE_NAME": "__VA_ARGS__)
-#define log_warn(...) syslog (LOG_WARNING, MODULE_NAME": "__VA_ARGS__)
+#define log_err(...) ERROR (MODULE_NAME": "__VA_ARGS__)
+#define log_warn(...) WARNING (MODULE_NAME": "__VA_ARGS__)
 
 /*
  * Private data structures
  */
-#if EMAIL_HAVE_READ
 /* linked list of email and check types */
 typedef struct type {
 	char        *name;
 	int         value;
 	struct type *next;
 } type_t;
@@ -125,52 +109,49 @@
 } conn_t;
 
 typedef struct {
 	conn_t *head;
 	conn_t *tail;
 } conn_list_t;
-#endif /* EMAIL_HAVE_READ */
 
 /*
  * Private variables
  */
-#if EMAIL_HAVE_READ
 /* valid configuration file keys */
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"SocketGroup",
 	"SocketPerms",
-	"MaxConns",
-	NULL
+	"MaxConns"
 };
-static int config_keys_num = 3;
+static int config_keys_num = STATIC_ARRAY_SIZE (config_keys);
 
 /* socket configuration */
 static char *sock_group = COLLECTD_GRP_NAME;
 static int  sock_perms  = S_IRWXU | S_IRWXG;
 static int  max_conns   = MAX_CONNS;
 
 /* state of the plugin */
 static int disabled = 0;
 
 /* thread managing "client" connections */
-static pthread_t connector;
-static int connector_socket;
+static pthread_t connector = (pthread_t) 0;
+static int connector_socket = -1;
 
 /* tell the collector threads that a new connection is available */
 static pthread_cond_t conn_available = PTHREAD_COND_INITIALIZER;
 
 /* connections that are waiting to be processed */
 static pthread_mutex_t conns_mutex = PTHREAD_MUTEX_INITIALIZER;
 static conn_list_t conns;
 
 /* tell the connector thread that a collector is available */
 static pthread_cond_t collector_available = PTHREAD_COND_INITIALIZER;
 
 /* collector threads */
-static collector_t **collectors;
+static collector_t **collectors = NULL;
 
 static pthread_mutex_t available_mutex = PTHREAD_MUTEX_INITIALIZER;
 static int available_collectors;
 
 static pthread_mutex_t count_mutex = PTHREAD_MUTEX_INITIALIZER;
 static type_list_t count;
@@ -181,48 +162,17 @@
 static pthread_mutex_t score_mutex = PTHREAD_MUTEX_INITIALIZER;
 static double score;
 static int score_count;
 
 static pthread_mutex_t check_mutex = PTHREAD_MUTEX_INITIALIZER;
 static type_list_t check;
-#endif /* EMAIL_HAVE_READ */
 
-#define COUNT_FILE "email/email-%s.rrd"
-static char *count_ds_def[] =
-{
-	"DS:count:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int count_ds_num = 1;
-
-#define SIZE_FILE  "email/email_size-%s.rrd"
-static char *size_ds_def[] =
-{
-	"DS:size:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int size_ds_num = 1;
-
-#define SCORE_FILE "email/spam_score.rrd"
-static char *score_ds_def[] =
-{
-	"DS:score:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int score_ds_num = 1;
-
-#define CHECK_FILE "email/spam_check-%s.rrd"
-static char *check_ds_def[] =
-{
-	"DS:hits:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int check_ds_num = 1;
-
-#if EMAIL_HAVE_READ
-static int email_config (char *key, char *value)
+/*
+ * Private functions
+ */
+static int email_config (const char *key, const char *value)
 {
 	if (0 == strcasecmp (key, "SocketGroup")) {
 		sock_group = sstrdup (value);
 	}
 	else if (0 == strcasecmp (key, "SocketPerms")) {
 		/* the user is responsible for providing reasonable values */
@@ -297,25 +247,29 @@
 	fd_set fdset;
 
 	FD_ZERO (&fdset);
 	FD_SET (src->socket, &fdset);
 
 	if (-1 == select (src->socket + 1, &fdset, NULL, NULL, NULL)) {
-		log_err ("select() failed: %s", strerror (errno));
+		char errbuf[1024];
+		log_err ("select() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return '\0';
 	}
 
 	assert (FD_ISSET (src->socket, &fdset));
 
 	do {
 		ssize_t len = 0;
 
 		errno = 0;
 		if (0 > (len = read (src->socket, (void *)&ret, 1))) {
 			if (EINTR != errno) {
-				log_err ("read() failed: %s", strerror (errno));
+				char errbuf[1024];
+				log_err ("read() failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 				return '\0';
 			}
 		}
 
 		if (0 == len)
 			return '\0';
@@ -358,25 +312,29 @@
 		ssize_t len = 0;
 
 		FD_ZERO (&fdset);
 		FD_SET (src->socket, &fdset);
 
 		if (-1 == select (src->socket + 1, &fdset, NULL, NULL, NULL)) {
-			log_err ("select() failed: %s", strerror (errno));
+			char errbuf[1024];
+			log_err ("select() failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			return NULL;
 		}
 
 		assert (FD_ISSET (src->socket, &fdset));
 
 		do {
 			errno = 0;
 			if (0 > (len = read (src->socket,
 							(void *)(src->buffer + src->idx),
 							BUFSIZE - src->idx))) {
 				if (EINTR != errno) {
-					log_err ("read() failed: %s", strerror (errno));
+					char errbuf[1024];
+					log_err ("read() failed: %s",
+							sstrerror (errno, errbuf, sizeof (errbuf)));
 					return NULL;
 				}
 			}
 
 			if (0 == len)
 				return NULL;
@@ -442,19 +400,23 @@
 
 		{ /* put the socket in non-blocking mode */
 			int flags = 0;
 
 			errno = 0;
 			if (-1 == fcntl (connection->socket, F_GETFL, &flags)) {
-				log_err ("fcntl() failed: %s", strerror (errno));
+				char errbuf[1024];
+				log_err ("fcntl() failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 				loop = 0;
 			}
 
 			errno = 0;
 			if (-1 == fcntl (connection->socket, F_SETFL, flags | O_NONBLOCK)) {
-				log_err ("fcntl() failed: %s", strerror (errno));
+				char errbuf[1024];
+				log_err ("fcntl() failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 				loop = 0;
 			}
 		}
 
 		while (loop) {
 			char *line = read_line (connection);
@@ -512,15 +474,16 @@
 			else {
 				log_err ("unknown type '%c'", line[0]);
 			}
 		} /* while (loop) */
 
 		close (connection->socket);
-
 		free (connection);
 
+		this->socket = -1;
+
 		pthread_mutex_lock (&available_mutex);
 		++available_collectors;
 		pthread_mutex_unlock (&available_mutex);
 
 		pthread_cond_signal (&collector_available);
 	} /* while (1) */
@@ -533,14 +496,16 @@
 {
 	struct sockaddr_un addr;
 
 	/* create UNIX socket */
 	errno = 0;
 	if (-1 == (connector_socket = socket (PF_UNIX, SOCK_STREAM, 0))) {
+		char errbuf[1024];
 		disabled = 1;
-		log_err ("socket() failed: %s", strerror (errno));
+		log_err ("socket() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		pthread_exit ((void *)1);
 	}
 
 	addr.sun_family = AF_UNIX;
 
 	strncpy (addr.sun_path, SOCK_PATH, (size_t)(UNIX_PATH_MAX - 1));
@@ -548,45 +513,71 @@
 	unlink (addr.sun_path);
 
 	errno = 0;
 	if (-1 == bind (connector_socket, (struct sockaddr *)&addr,
 				offsetof (struct sockaddr_un, sun_path)
 					+ strlen(addr.sun_path))) {
+		char errbuf[1024];
 		disabled = 1;
-		log_err ("bind() failed: %s", strerror (errno));
+		connector_socket = -1; /* TODO: close? */
+		log_err ("bind() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		pthread_exit ((void *)1);
 	}
 
 	errno = 0;
 	if (-1 == listen (connector_socket, 5)) {
+		char errbuf[1024];
 		disabled = 1;
-		log_err ("listen() failed: %s", strerror (errno));
+		connector_socket = -1; /* TODO: close? */
+		log_err ("listen() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		pthread_exit ((void *)1);
 	}
 
-	if ((uid_t)0 == geteuid ()) {
+	if ((uid_t) 0 == geteuid ())
+	{
+		struct group sg;
 		struct group *grp;
+		char grbuf[2048];
+		int status;
 
-		errno = 0;
-		if (NULL != (grp = getgrnam (sock_group))) {
-			errno = 0;
-			if (0 != chown (SOCK_PATH, (uid_t)-1, grp->gr_gid)) {
-				log_warn ("chown() failed: %s", strerror (errno));
+		grp = NULL;
+		status = getgrnam_r (sock_group, &sg, grbuf, sizeof (grbuf), &grp);
+		if (status != 0)
+		{
+			char errbuf[1024];
+			log_warn ("getgrnam_r (%s) failed: %s", sock_group,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
+		}
+		else if (grp == NULL)
+		{
+			log_warn ("No such group: `%s'", sock_group);
+		}
+		else
+		{
+			status = chown (SOCK_PATH, (uid_t) -1, grp->gr_gid);
+			if (status != 0)
+			{
+				char errbuf[1024];
+				log_warn ("chown (%s, -1, %i) failed: %s",
+						SOCK_PATH, (int) grp->gr_gid,
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 			}
 		}
-		else {
-			log_warn ("getgrnam() failed: %s", strerror (errno));
-		}
 	}
-	else {
+	else /* geteuid != 0 */
+	{
 		log_warn ("not running as root");
 	}
 
 	errno = 0;
 	if (0 != chmod (SOCK_PATH, sock_perms)) {
-		log_warn ("chmod() failed: %s", strerror (errno));
+		char errbuf[1024];
+		log_warn ("chmod() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 	}
 
 	{ /* initialize collector threads */
 		int i   = 0;
 		int err = 0;
 
@@ -602,17 +593,20 @@
 
 		collectors =
 			(collector_t **)smalloc (max_conns * sizeof (collector_t *));
 
 		for (i = 0; i < max_conns; ++i) {
 			collectors[i] = (collector_t *)smalloc (sizeof (collector_t));
-			collectors[i]->socket = 0;
+			collectors[i]->socket = -1;
 
 			if (0 != (err = pthread_create (&collectors[i]->thread, &ptattr,
 							collect, collectors[i]))) {
-				log_err ("pthread_create() failed: %s", strerror (err));
+				char errbuf[1024];
+				log_err ("pthread_create() failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
+				collectors[i]->thread = (pthread_t) 0;
 			}
 		}
 
 		pthread_attr_destroy (&ptattr);
 	}
 
@@ -632,14 +626,17 @@
 		pthread_mutex_unlock (&available_mutex);
 
 		do {
 			errno = 0;
 			if (-1 == (remote = accept (connector_socket, NULL, NULL))) {
 				if (EINTR != errno) {
+					char errbuf[1024];
 					disabled = 1;
-					log_err ("accept() failed: %s", strerror (errno));
+					connector_socket = -1; /* TODO: close? */
+					log_err ("accept() failed: %s",
+							sstrerror (errno, errbuf, sizeof (errbuf)));
 					pthread_exit ((void *)1);
 				}
 			}
 		} while (EINTR == errno);
 
 		connection = (conn_t *)smalloc (sizeof (conn_t));
@@ -661,126 +658,87 @@
 		pthread_mutex_unlock (&conns_mutex);
 
 		pthread_cond_signal (&conn_available);
 	}
 	pthread_exit ((void *)0);
 } /* static void *open_connection (void *) */
-#endif /* EMAIL_HAVE_READ */
 
-static void email_init (void)
+static int email_init (void)
 {
-#if EMAIL_HAVE_READ
 	int err = 0;
 
 	if (0 != (err = pthread_create (&connector, NULL,
 				open_connection, NULL))) {
+		char errbuf[1024];
 		disabled = 1;
-		log_err ("pthread_create() failed: %s", strerror (err));
-		return;
+		log_err ("pthread_create() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
-#endif /* EMAIL_HAVE_READ */
-	return;
-} /* static void email_init (void) */
 
-#if EMAIL_HAVE_READ
-static void email_shutdown (void)
+	return (0);
+} /* int email_init */
+
+static int email_shutdown (void)
 {
 	int i = 0;
 
-	if (disabled)
-		return;
+	if (connector != ((pthread_t) 0)) {
+		pthread_kill (connector, SIGTERM);
+		connector = (pthread_t) 0;
+	}
 
-	pthread_kill (connector, SIGTERM);
-	close (connector_socket);
+	if (connector_socket >= 0) {
+		close (connector_socket);
+		connector_socket = -1;
+	}
 
 	/* don't allow any more connections to be processed */
 	pthread_mutex_lock (&conns_mutex);
 
-	for (i = 0; i < max_conns; ++i) {
-		pthread_kill (collectors[i]->thread, SIGTERM);
-		close (collectors[i]->socket);
-	}
-
-	pthread_mutex_unlock (&conns_mutex);
-
-	unlink (SOCK_PATH);
-	return;
-} /* static void email_shutdown (void) */
-#endif /* EMAIL_HAVE_READ */
-
-static void count_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE] = "";
-	int  len           = 0;
-
-	len = snprintf (file, BUFSIZE, COUNT_FILE, inst);
-	if ((len < 0) || (len >= BUFSIZE))
-		return;
-
-	rrd_update_file (host, file, val, count_ds_def, count_ds_num);
-	return;
-} /* static void email_write (char *host, char *inst, char *val) */
-
-static void size_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE] = "";
-	int  len           = 0;
-
-	len = snprintf (file, BUFSIZE, SIZE_FILE, inst);
-	if ((len < 0) || (len >= BUFSIZE))
-		return;
+	if (collectors != NULL) {
+		for (i = 0; i < max_conns; ++i) {
+			if (collectors[i] == NULL)
+				continue;
 
-	rrd_update_file (host, file, val, size_ds_def, size_ds_num);
-	return;
-} /* static void size_write (char *host, char *inst, char *val) */
+			if (collectors[i]->thread != ((pthread_t) 0)) {
+				pthread_kill (collectors[i]->thread, SIGTERM);
+				collectors[i]->thread = (pthread_t) 0;
+			}
 
-static void score_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, SCORE_FILE, val, score_ds_def, score_ds_num);
-	return;
-} /* static void score_write (char *host, char *inst, char *val) */
+			if (collectors[i]->socket >= 0) {
+				close (collectors[i]->socket);
+				collectors[i]->socket = -1;
+			}
+		}
+	} /* if (collectors != NULL) */
 
-static void check_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE] = "";
-	int  len           = 0;
+	pthread_mutex_unlock (&conns_mutex);
 
-	len = snprintf (file, BUFSIZE, CHECK_FILE, inst);
-	if ((len < 0) || (len >= BUFSIZE))
-		return;
+	unlink (SOCK_PATH);
+	errno = 0;
 
-	rrd_update_file (host, file, val, check_ds_def, check_ds_num);
-	return;
-} /* static void check_write (char *host, char *inst, char *val) */
+	return (0);
+} /* static void email_shutdown (void) */
 
-#if EMAIL_HAVE_READ
-static void type_submit (char *plugin, char *inst, int value)
+static void email_submit (const char *type, const char *type_instance, gauge_t value)
 {
-	char buf[BUFSIZE] = "";
-	int  len          = 0;
-
-	len = snprintf (buf, BUFSIZE, "%u:%i", (unsigned int)curtime, value);
-	if ((len < 0) || (len >= BUFSIZE))
-		return;
-
-	plugin_submit (plugin, inst, buf);
-	return;
-} /* static void type_submit (char *, char *, int) */
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void score_submit (double value)
-{
-	char buf[BUFSIZE] = "";
-	int  len          = 0;
+	values[0].gauge = value;
 
-	len = snprintf (buf, BUFSIZE, "%u:%.2f", (unsigned int)curtime, value);
-	if ((len < 0) || (len >= BUFSIZE))
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "email");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-	plugin_submit ("email_spam_score", "-", buf);
-	return;
-} /* static void score_submit (double) */
+	plugin_dispatch_values (type, &vl);
+} /* void email_submit */
 
 /* Copy list l1 to list l2. l2 may partly exist already, but it is assumed
  * that neither the order nor the name of any element of either list is
  * changed and no elements are deleted. The values of l1 are reset to zero
  * after they have been copied to l2. */
 static void copy_type_list (type_list_t *l1, type_list_t *l2)
@@ -814,24 +772,25 @@
 		ptr2->value = ptr1->value;
 		ptr1->value = 0;
 	}
 	return;
 }
 
-static void email_read (void)
+static int email_read (void)
 {
 	type_t *ptr;
 
-	double sc;
+	double score_old;
+	int score_count_old;
 
 	static type_list_t *cnt;
 	static type_list_t *sz;
 	static type_list_t *chk;
 
 	if (disabled)
-		return;
+		return (-1);
 
 	if (NULL == cnt) {
 		cnt = (type_list_t *)smalloc (sizeof (type_list_t));
 		cnt->head = NULL;
 	}
 
@@ -850,63 +809,55 @@
 
 	copy_type_list (&count, cnt);
 
 	pthread_mutex_unlock (&count_mutex);
 
 	for (ptr = cnt->head; NULL != ptr; ptr = ptr->next) {
-		type_submit ("email_count", ptr->name, ptr->value);
+		email_submit ("email_count", ptr->name, ptr->value);
 	}
 
 	/* email size */
 	pthread_mutex_lock (&size_mutex);
 
 	copy_type_list (&size, sz);
 
 	pthread_mutex_unlock (&size_mutex);
 
 	for (ptr = sz->head; NULL != ptr; ptr = ptr->next) {
-		type_submit ("email_size", ptr->name, ptr->value);
+		email_submit ("email_size", ptr->name, ptr->value);
 	}
 
 	/* spam score */
 	pthread_mutex_lock (&score_mutex);
 
-	sc = score;
+	score_old = score;
+	score_count_old = score_count;
 	score = 0.0;
 	score_count = 0;
 
 	pthread_mutex_unlock (&score_mutex);
 
-	score_submit (sc);
+	if (score_count_old > 0)
+		email_submit ("spam_score", "", score_old);
 
 	/* spam checks */
 	pthread_mutex_lock (&check_mutex);
 
 	copy_type_list (&check, chk);
 
 	pthread_mutex_unlock (&check_mutex);
 
-	for (ptr = chk->head; NULL != ptr; ptr = ptr->next) {
-		type_submit ("email_spam_check", ptr->name, ptr->value);
-	}
-	return;
-} /* static void read (void) */
-#else /* if !EMAIL_HAVE_READ */
-# define email_read NULL
-#endif
+	for (ptr = chk->head; NULL != ptr; ptr = ptr->next)
+		email_submit ("spam_check", ptr->name, ptr->value);
+
+	return (0);
+} /* int email_read */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, email_init, email_read, NULL);
-	plugin_register ("email_count", NULL, NULL, count_write);
-	plugin_register ("email_size", NULL, NULL, size_write);
-	plugin_register ("email_spam_score", NULL, NULL, score_write);
-	plugin_register ("email_spam_check", NULL, NULL, check_write);
-#if EMAIL_HAVE_READ
-	plugin_register_shutdown (MODULE_NAME, email_shutdown);
-	cf_register (MODULE_NAME, email_config, config_keys, config_keys_num);
-#endif /* EMAIL_HAVE_READ */
-	return;
-} /* void module_register (void) */
+	plugin_register_config ("email", email_config, config_keys, config_keys_num);
+	plugin_register_init ("email", email_init);
+	plugin_register_read ("email", email_read);
+	plugin_register_shutdown ("email", email_shutdown);
+} /* void module_register */
 
 /* vim: set sw=4 ts=4 tw=78 noexpandtab : */
-
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: entropy.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: exec.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/hddtemp.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/hddtemp.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/hddtemp.c	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/hddtemp.c	2007-05-30 18:33:14.000000000 +0800
@@ -27,43 +27,34 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "utils_debug.h"
 
-#define MODULE_NAME "hddtemp"
-
-#include <netdb.h>
-#include <sys/socket.h>
-#include <netinet/in.h>
-#include <netinet/tcp.h>
-#include <libgen.h> /* for basename */
+#if HAVE_NETDB_H && HAVE_SYS_SOCKET_H && HAVE_NETINET_IN_H \
+	&& HAVE_NETINET_TCP_H && HAVE_LIBGEN_H
+# include <netdb.h>
+# include <sys/socket.h>
+# include <netinet/in.h>
+# include <netinet/tcp.h>
+# include <libgen.h> /* for basename */
+# define HDDTEMP_HAVE_READ 1
+#else
+# define HDDTEMP_HAVE_READ 0
+#endif
 
 #if HAVE_LINUX_MAJOR_H
 # include <linux/major.h>
 #endif
 
 #define HDDTEMP_DEF_HOST "127.0.0.1"
 #define HDDTEMP_DEF_PORT "7634"
 
-/* BUFFER_SIZE
-   Size of the buffer we use to receive from the hddtemp daemon. */
-#define BUFFER_SIZE 1024
-
-static char *filename_format = "hddtemp-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num = 1;
-
-static char *config_keys[] =
+#if HDDTEMP_HAVE_READ
+static const char *config_keys[] =
 {
 	"Host",
 	"Port",
 	NULL
 };
 static int config_keys_num = 2;
@@ -129,34 +120,39 @@
 	port = hddtemp_port;
 	if (port == NULL)
 		port = HDDTEMP_DEF_PORT;
 
 	if ((ai_return = getaddrinfo (host, port, &ai_hints, &ai_list)) != 0)
 	{
-		syslog (LOG_ERR, "hddtemp: getaddrinfo (%s, %s): %s",
+		char errbuf[1024];
+		ERROR ("hddtemp: getaddrinfo (%s, %s): %s",
 				host, port,
-				ai_return == EAI_SYSTEM ? strerror (errno) : gai_strerror (ai_return));
+				(ai_return == EAI_SYSTEM)
+				? sstrerror (errno, errbuf, sizeof (errbuf))
+				: gai_strerror (ai_return));
 		return (-1);
 	}
 
 	fd = -1;
 	for (ai_ptr = ai_list; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next)
 	{
 		/* create our socket descriptor */
 		if ((fd = socket (ai_ptr->ai_family, ai_ptr->ai_socktype, ai_ptr->ai_protocol)) < 0)
 		{
-			syslog (LOG_ERR, "hddtemp: socket: %s",
-					strerror (errno));
+			char errbuf[1024];
+			ERROR ("hddtemp: socket: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			continue;
 		}
 
 		/* connect to the hddtemp daemon */
 		if (connect (fd, (struct sockaddr *) ai_ptr->ai_addr, ai_ptr->ai_addrlen))
 		{
-			DBG ("hddtemp: connect (%s, %s): %s", host, port,
-					strerror (errno));
+			char errbuf[1024];
+			DEBUG ("hddtemp: connect (%s, %s): %s", host, port,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			close (fd);
 			fd = -1;
 			continue;
 		}
 
 		/* A socket could be opened and connecting succeeded. We're
@@ -165,56 +161,58 @@
 	}
 
 	freeaddrinfo (ai_list);
 
 	if (fd < 0)
 	{
-		syslog (LOG_ERR, "hddtemp: Could not connect to daemon.");
+		ERROR ("hddtemp: Could not connect to daemon.");
 		return (-1);
 	}
 
 	/* receive data from the hddtemp daemon */
 	memset (buffer, '\0', buffer_size);
 
 	buffer_fill = 0;
 	while ((status = read (fd, buffer + buffer_fill, buffer_size - buffer_fill)) != 0)
 	{
 		if (status == -1)
 		{
+			char errbuf[1024];
+
 			if ((errno == EAGAIN) || (errno == EINTR))
 				continue;
 
-			syslog (LOG_ERR, "hddtemp: Error reading from socket: %s",
-						strerror (errno));
+			ERROR ("hddtemp: Error reading from socket: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			close (fd);
 			return (-1);
 		}
 		buffer_fill += status;
 
 		if (buffer_fill >= buffer_size)
 			break;
 	}
 
 	if (buffer_fill >= buffer_size)
 	{
 		buffer[buffer_size - 1] = '\0';
-		syslog (LOG_WARNING, "hddtemp: Message from hddtemp has been truncated.");
+		WARNING ("hddtemp: Message from hddtemp has been truncated.");
 	}
 	else if (buffer_fill == 0)
 	{
-		syslog (LOG_WARNING, "hddtemp: Peer has unexpectedly shut down the socket. "
+		WARNING ("hddtemp: Peer has unexpectedly shut down the socket. "
 				"Buffer: `%s'", buffer);
 		close (fd);
 		return (-1);
 	}
 
 	close (fd);
 	return (0);
 }
 
-static int hddtemp_config (char *key, char *value)
+static int hddtemp_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "host") == 0)
 	{
 		if (hddtemp_host != NULL)
 			free (hddtemp_host);
 		hddtemp_host = strdup (value);
@@ -233,17 +231,17 @@
 	return (0);
 }
 
 /* In the init-function we initialize the `hddname_t' list used to translate
  * disk-names. Under Linux that's done using `/proc/partitions'. Under other
  * operating-systems, it's not done at all. */
-static void hddtemp_init (void)
+static int hddtemp_init (void)
 {
 #if KERNEL_LINUX
 	FILE *fh;
-	char buf[BUFFER_SIZE];
+	char buf[1024];
 	int buflen;
 
 	char *fields[16];
 	int num_fields;
 
 	int major;
@@ -262,15 +260,15 @@
 		free (entry);
 	}
 	first_hddname = NULL;
 
 	if ((fh = fopen ("/proc/partitions", "r")) != NULL)
 	{
-		DBG ("Looking at /proc/partitions...");
+		DEBUG ("Looking at /proc/partitions...");
 
-		while (fgets (buf, BUFFER_SIZE, fh) != NULL)
+		while (fgets (buf, sizeof (buf), fh) != NULL)
 		{
 			/* Delete trailing newlines */
 			buflen = strlen (buf);
 
 			while ((buflen > 0) && ((buf[buflen-1] == '\n') || (buf[buflen-1] == '\r')))
 				buf[--buflen] = '\0';
@@ -336,31 +334,31 @@
 					if(minor != 0 && minor != 64)
 						continue;
 					break;
 
 				/* Skip all other majors. */
 				default:
-					DBG ("Skipping unknown major %i", major);
+					DEBUG ("Skipping unknown major %i", major);
 					continue;
 			} /* switch (major) */
 
 			if ((name = strdup (fields[3])) == NULL)
 			{
-				syslog (LOG_ERR, "hddtemp: strdup(%s) == NULL", fields[3]);
+				ERROR ("hddtemp: strdup(%s) == NULL", fields[3]);
 				continue;
 			}
 
 			if ((entry = (hddname_t *) malloc (sizeof (hddname_t))) == NULL)
 			{
-				syslog (LOG_ERR, "hddtemp: malloc (%u) == NULL",
+				ERROR ("hddtemp: malloc (%u) == NULL",
 						(unsigned int) sizeof (hddname_t));
 				free (name);
 				continue;
 			}
 
-			DBG ("Found disk: %s (%u:%u).", name, major, minor);
+			DEBUG ("Found disk: %s (%u:%u).", name, major, minor);
 
 			entry->major = major;
 			entry->minor = minor;
 			entry->name  = name;
 			entry->next  = NULL;
 
@@ -373,32 +371,24 @@
 				entry->next = first_hddname;
 				first_hddname = entry;
 			}
 		}
 		fclose (fh);
 	}
+#if COLLECT_DEBUG
 	else
-		DBG ("Could not open /proc/partitions: %s",
-				strerror (errno));
+	{
+		char errbuf[1024];
+		DEBUG ("Could not open /proc/partitions: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
+#endif /* COLLECT_DEBUG */
 #endif /* KERNEL_LINUX */
-}
-
-static void hddtemp_write (char *host, char *inst, char *val)
-{
-	char filename[BUFFER_SIZE];
-	int status;
-
-	/* construct filename */
-	status = snprintf (filename, BUFFER_SIZE, filename_format, inst);
-	if (status < 1)
-		return;
-	else if (status >= BUFFER_SIZE)
-		return;
 
-	rrd_update_file (host, filename, val, ds_def, ds_num);
-}
+	return (0);
+} /* int hddtemp_init */
 
 /*
  * hddtemp_get_name
  *
  * Description:
  *   Try to "cook" a bit the drive name as returned
@@ -413,13 +403,13 @@
 	for (list = first_hddname; list != NULL; list = list->next)
 		if (strcmp (drive, list->name) == 0)
 			break;
 
 	if (list == NULL)
 	{
-		DBG ("Don't know %s, keeping name as-is.", drive);
+		DEBUG ("Don't know %s, keeping name as-is.", drive);
 		return (strdup (drive));
 	}
 
 	if ((ret = (char *) malloc (128 * sizeof (char))) == NULL)
 		return (NULL);
 
@@ -429,66 +419,48 @@
 		return (NULL);
 	}
 
 	return (ret);
 }
 
-static void hddtemp_submit (char *inst, double temperature)
+static void hddtemp_submit (char *type_instance, double value)
 {
-	char buf[BUFFER_SIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFFER_SIZE, "%u:%.3f", (unsigned int) curtime, temperature)
-            >= BUFFER_SIZE)
-		return;
+	values[0].gauge = value;
 
-	plugin_submit (MODULE_NAME, inst, buf);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "hddtemp");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
+
+	plugin_dispatch_values ("temperature", &vl);
 }
 
-static void hddtemp_read (void)
+static int hddtemp_read (void)
 {
-	char buf[BUFFER_SIZE];
+	char buf[1024];
 	char *fields[128];
 	char *ptr;
+	char *saveptr;
 	int num_fields;
 	int num_disks;
 	int i;
 
-	static int wait_time = 1;
-	static int wait_left = 0;
-
-	if (wait_left >= 10)
-	{
-		wait_left -= 10;
-		return;
-	}
-
 	/* get data from daemon */
-	if (hddtemp_query_daemon (buf, BUFFER_SIZE) < 0)
-	{
-		/* This limit is reached in log2(86400) =~ 17 steps. Since
-		 * there is a 2^n seconds wait between each step it will need
-		 * roughly one day to reach this limit. -octo */
-		
-		wait_time *= 2;
-		if (wait_time > 86400)
-			wait_time = 86400;
-
-		wait_left = wait_time;
-
-		return;
-	}
-	else
-	{
-		wait_time = 1;
-		wait_left = 0;
-	}
+	if (hddtemp_query_daemon (buf, sizeof (buf)) < 0)
+		return (-1);
 
-	/* NB: strtok will eat up "||" and leading "|"'s */
+	/* NB: strtok_r will eat up "||" and leading "|"'s */
 	num_fields = 0;
 	ptr = buf;
-	while ((fields[num_fields] = strtok (ptr, "|")) != NULL)
+	saveptr = NULL;
+	while ((fields[num_fields] = strtok_r (ptr, "|", &saveptr)) != NULL)
 	{
 		ptr = NULL;
 		num_fields++;
 
 		if (num_fields >= 128)
 			break;
@@ -522,17 +494,22 @@
 		}
 		else
 		{
 			hddtemp_submit (name, temperature);
 		}
 	}
-}
+	
+	return (0);
+} /* int hddtemp_read */
+#endif /* HDDTEMP_HAVE_READ */
 
 /* module_register
    Register collectd plugin. */
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, hddtemp_init, hddtemp_read, hddtemp_write);
-	cf_register (MODULE_NAME, hddtemp_config, config_keys, config_keys_num);
+#if HDDTEMP_HAVE_READ
+	plugin_register_config ("hddtemp", hddtemp_config,
+			config_keys, config_keys_num);
+	plugin_register_init ("hddtemp", hddtemp_init);
+	plugin_register_read ("hddtemp", hddtemp_read);
+#endif /* HDDTEMP_HAVE_READ */
 }
-
-#undef MODULE_NAME
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: interface.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: iptables.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: irq.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src: libconfig
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: liboconfig
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/liboping/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/liboping/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/liboping/Makefile.am	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/liboping/Makefile.am	2007-05-30 18:33:15.000000000 +0800
@@ -6,11 +6,11 @@
 
 EXTRA_DIST = AUTHORS COPYING ChangeLog README
 
 noinst_LTLIBRARIES = liboping.la
 
 #liboping_la_CFLAGS = 
-liboping_la_LDFLAGS = -avoid-version
+liboping_la_LDFLAGS = -version-info 0:3:0
 if BUILD_WITH_LIBSOCKET
 liboping_la_LDFLAGS += -lsocket
 endif
 liboping_la_SOURCES = liboping.c oping.h
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/liboping/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/liboping/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/liboping/Makefile.in	2007-09-28 19:01:08.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/liboping/Makefile.in	2007-06-04 01:13:28.000000000 +0800
@@ -91,52 +91,72 @@
 BUILD_MODULE_BATTERY_FALSE = @BUILD_MODULE_BATTERY_FALSE@
 BUILD_MODULE_BATTERY_TRUE = @BUILD_MODULE_BATTERY_TRUE@
 BUILD_MODULE_CPUFREQ_FALSE = @BUILD_MODULE_CPUFREQ_FALSE@
 BUILD_MODULE_CPUFREQ_TRUE = @BUILD_MODULE_CPUFREQ_TRUE@
 BUILD_MODULE_CPU_FALSE = @BUILD_MODULE_CPU_FALSE@
 BUILD_MODULE_CPU_TRUE = @BUILD_MODULE_CPU_TRUE@
+BUILD_MODULE_CSV_FALSE = @BUILD_MODULE_CSV_FALSE@
+BUILD_MODULE_CSV_TRUE = @BUILD_MODULE_CSV_TRUE@
 BUILD_MODULE_DF_FALSE = @BUILD_MODULE_DF_FALSE@
 BUILD_MODULE_DF_TRUE = @BUILD_MODULE_DF_TRUE@
 BUILD_MODULE_DISK_FALSE = @BUILD_MODULE_DISK_FALSE@
 BUILD_MODULE_DISK_TRUE = @BUILD_MODULE_DISK_TRUE@
 BUILD_MODULE_DNS_FALSE = @BUILD_MODULE_DNS_FALSE@
 BUILD_MODULE_DNS_TRUE = @BUILD_MODULE_DNS_TRUE@
 BUILD_MODULE_EMAIL_FALSE = @BUILD_MODULE_EMAIL_FALSE@
 BUILD_MODULE_EMAIL_TRUE = @BUILD_MODULE_EMAIL_TRUE@
+BUILD_MODULE_ENTROPY_FALSE = @BUILD_MODULE_ENTROPY_FALSE@
+BUILD_MODULE_ENTROPY_TRUE = @BUILD_MODULE_ENTROPY_TRUE@
+BUILD_MODULE_EXEC_FALSE = @BUILD_MODULE_EXEC_FALSE@
+BUILD_MODULE_EXEC_TRUE = @BUILD_MODULE_EXEC_TRUE@
 BUILD_MODULE_HDDTEMP_FALSE = @BUILD_MODULE_HDDTEMP_FALSE@
 BUILD_MODULE_HDDTEMP_TRUE = @BUILD_MODULE_HDDTEMP_TRUE@
+BUILD_MODULE_INTERFACE_FALSE = @BUILD_MODULE_INTERFACE_FALSE@
+BUILD_MODULE_INTERFACE_TRUE = @BUILD_MODULE_INTERFACE_TRUE@
+BUILD_MODULE_IPTABLES_FALSE = @BUILD_MODULE_IPTABLES_FALSE@
+BUILD_MODULE_IPTABLES_TRUE = @BUILD_MODULE_IPTABLES_TRUE@
+BUILD_MODULE_IRQ_FALSE = @BUILD_MODULE_IRQ_FALSE@
+BUILD_MODULE_IRQ_TRUE = @BUILD_MODULE_IRQ_TRUE@
 BUILD_MODULE_LOAD_FALSE = @BUILD_MODULE_LOAD_FALSE@
 BUILD_MODULE_LOAD_TRUE = @BUILD_MODULE_LOAD_TRUE@
+BUILD_MODULE_LOGFILE_FALSE = @BUILD_MODULE_LOGFILE_FALSE@
+BUILD_MODULE_LOGFILE_TRUE = @BUILD_MODULE_LOGFILE_TRUE@
 BUILD_MODULE_MBMON_FALSE = @BUILD_MODULE_MBMON_FALSE@
 BUILD_MODULE_MBMON_TRUE = @BUILD_MODULE_MBMON_TRUE@
 BUILD_MODULE_MEMORY_FALSE = @BUILD_MODULE_MEMORY_FALSE@
 BUILD_MODULE_MEMORY_TRUE = @BUILD_MODULE_MEMORY_TRUE@
 BUILD_MODULE_MULTIMETER_FALSE = @BUILD_MODULE_MULTIMETER_FALSE@
 BUILD_MODULE_MULTIMETER_TRUE = @BUILD_MODULE_MULTIMETER_TRUE@
 BUILD_MODULE_MYSQL_FALSE = @BUILD_MODULE_MYSQL_FALSE@
 BUILD_MODULE_MYSQL_TRUE = @BUILD_MODULE_MYSQL_TRUE@
+BUILD_MODULE_NETWORK_FALSE = @BUILD_MODULE_NETWORK_FALSE@
+BUILD_MODULE_NETWORK_TRUE = @BUILD_MODULE_NETWORK_TRUE@
 BUILD_MODULE_NFS_FALSE = @BUILD_MODULE_NFS_FALSE@
 BUILD_MODULE_NFS_TRUE = @BUILD_MODULE_NFS_TRUE@
 BUILD_MODULE_NTPD_FALSE = @BUILD_MODULE_NTPD_FALSE@
 BUILD_MODULE_NTPD_TRUE = @BUILD_MODULE_NTPD_TRUE@
+BUILD_MODULE_NUT_FALSE = @BUILD_MODULE_NUT_FALSE@
+BUILD_MODULE_NUT_TRUE = @BUILD_MODULE_NUT_TRUE@
+BUILD_MODULE_PERL_FALSE = @BUILD_MODULE_PERL_FALSE@
+BUILD_MODULE_PERL_TRUE = @BUILD_MODULE_PERL_TRUE@
 BUILD_MODULE_PING_FALSE = @BUILD_MODULE_PING_FALSE@
 BUILD_MODULE_PING_TRUE = @BUILD_MODULE_PING_TRUE@
 BUILD_MODULE_PROCESSES_FALSE = @BUILD_MODULE_PROCESSES_FALSE@
 BUILD_MODULE_PROCESSES_TRUE = @BUILD_MODULE_PROCESSES_TRUE@
-BUILD_MODULE_QUOTA_FALSE = @BUILD_MODULE_QUOTA_FALSE@
-BUILD_MODULE_QUOTA_TRUE = @BUILD_MODULE_QUOTA_TRUE@
 BUILD_MODULE_SENSORS_FALSE = @BUILD_MODULE_SENSORS_FALSE@
 BUILD_MODULE_SENSORS_TRUE = @BUILD_MODULE_SENSORS_TRUE@
 BUILD_MODULE_SERIAL_FALSE = @BUILD_MODULE_SERIAL_FALSE@
 BUILD_MODULE_SERIAL_TRUE = @BUILD_MODULE_SERIAL_TRUE@
 BUILD_MODULE_SWAP_FALSE = @BUILD_MODULE_SWAP_FALSE@
 BUILD_MODULE_SWAP_TRUE = @BUILD_MODULE_SWAP_TRUE@
+BUILD_MODULE_SYSLOG_FALSE = @BUILD_MODULE_SYSLOG_FALSE@
+BUILD_MODULE_SYSLOG_TRUE = @BUILD_MODULE_SYSLOG_TRUE@
 BUILD_MODULE_TAPE_FALSE = @BUILD_MODULE_TAPE_FALSE@
 BUILD_MODULE_TAPE_TRUE = @BUILD_MODULE_TAPE_TRUE@
-BUILD_MODULE_TRAFFIC_FALSE = @BUILD_MODULE_TRAFFIC_FALSE@
-BUILD_MODULE_TRAFFIC_TRUE = @BUILD_MODULE_TRAFFIC_TRUE@
+BUILD_MODULE_UNIXSOCK_FALSE = @BUILD_MODULE_UNIXSOCK_FALSE@
+BUILD_MODULE_UNIXSOCK_TRUE = @BUILD_MODULE_UNIXSOCK_TRUE@
 BUILD_MODULE_USERS_FALSE = @BUILD_MODULE_USERS_FALSE@
 BUILD_MODULE_USERS_TRUE = @BUILD_MODULE_USERS_TRUE@
 BUILD_MODULE_VSERVER_FALSE = @BUILD_MODULE_VSERVER_FALSE@
 BUILD_MODULE_VSERVER_TRUE = @BUILD_MODULE_VSERVER_TRUE@
 BUILD_MODULE_WIRELESS_FALSE = @BUILD_MODULE_WIRELESS_FALSE@
 BUILD_MODULE_WIRELESS_TRUE = @BUILD_MODULE_WIRELESS_TRUE@
@@ -146,34 +166,42 @@
 BUILD_WITH_LIBDEVINFO_FALSE = @BUILD_WITH_LIBDEVINFO_FALSE@
 BUILD_WITH_LIBDEVINFO_TRUE = @BUILD_WITH_LIBDEVINFO_TRUE@
 BUILD_WITH_LIBDEVSTAT_FALSE = @BUILD_WITH_LIBDEVSTAT_FALSE@
 BUILD_WITH_LIBDEVSTAT_TRUE = @BUILD_WITH_LIBDEVSTAT_TRUE@
 BUILD_WITH_LIBIOKIT_FALSE = @BUILD_WITH_LIBIOKIT_FALSE@
 BUILD_WITH_LIBIOKIT_TRUE = @BUILD_WITH_LIBIOKIT_TRUE@
+BUILD_WITH_LIBIPTC_FALSE = @BUILD_WITH_LIBIPTC_FALSE@
+BUILD_WITH_LIBIPTC_TRUE = @BUILD_WITH_LIBIPTC_TRUE@
 BUILD_WITH_LIBKSTAT_FALSE = @BUILD_WITH_LIBKSTAT_FALSE@
 BUILD_WITH_LIBKSTAT_TRUE = @BUILD_WITH_LIBKSTAT_TRUE@
 BUILD_WITH_LIBKVM_FALSE = @BUILD_WITH_LIBKVM_FALSE@
 BUILD_WITH_LIBKVM_TRUE = @BUILD_WITH_LIBKVM_TRUE@
 BUILD_WITH_LIBMYSQL_FALSE = @BUILD_WITH_LIBMYSQL_FALSE@
 BUILD_WITH_LIBMYSQL_TRUE = @BUILD_WITH_LIBMYSQL_TRUE@
 BUILD_WITH_LIBOPING_FALSE = @BUILD_WITH_LIBOPING_FALSE@
 BUILD_WITH_LIBOPING_TRUE = @BUILD_WITH_LIBOPING_TRUE@
 BUILD_WITH_LIBPCAP_FALSE = @BUILD_WITH_LIBPCAP_FALSE@
 BUILD_WITH_LIBPCAP_TRUE = @BUILD_WITH_LIBPCAP_TRUE@
+BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
+BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
 BUILD_WITH_LIBSTATGRAB_FALSE = @BUILD_WITH_LIBSTATGRAB_FALSE@
 BUILD_WITH_LIBSTATGRAB_TRUE = @BUILD_WITH_LIBSTATGRAB_TRUE@
+BUILD_WITH_LIBUPSCLIENT_FALSE = @BUILD_WITH_LIBUPSCLIENT_FALSE@
+BUILD_WITH_LIBUPSCLIENT_TRUE = @BUILD_WITH_LIBUPSCLIENT_TRUE@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
+BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
+BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
 BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
 BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
@@ -200,12 +228,15 @@
 GREP = @GREP@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
 LDFLAGS = @LDFLAGS@
+LEX = @LEX@
+LEXLIB = @LEXLIB@
+LEX_OUTPUT_ROOT = @LEX_OUTPUT_ROOT@
 LIBLTDL = @LIBLTDL@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
 LIBTOOL = @LIBTOOL@
 LN_S = @LN_S@
 LTDLINCL = @LTDLINCL@
@@ -216,18 +247,21 @@
 PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
 PACKAGE_NAME = @PACKAGE_NAME@
 PACKAGE_STRING = @PACKAGE_STRING@
 PACKAGE_TARNAME = @PACKAGE_TARNAME@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
+PERL_CFLAGS = @PERL_CFLAGS@
+PERL_LDFLAGS = @PERL_LDFLAGS@
 RANLIB = @RANLIB@
-SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
+YACC = @YACC@
+YFLAGS = @YFLAGS@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -276,13 +310,13 @@
 AUTOMAKE_OPTIONS = foreign no-dependencies
 @COMPILER_IS_GCC_TRUE@AM_CFLAGS = -Wall -Werror
 EXTRA_DIST = AUTHORS COPYING ChangeLog README
 noinst_LTLIBRARIES = liboping.la
 
 #liboping_la_CFLAGS = 
-liboping_la_LDFLAGS = -avoid-version $(am__append_1)
+liboping_la_LDFLAGS = -version-info 0:3:0 $(am__append_1)
 liboping_la_SOURCES = liboping.c oping.h
 all: all-am
 
 .SUFFIXES:
 .SUFFIXES: .c .lo .o .obj
 $(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/load.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/load.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/load.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/load.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/load.c
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -21,14 +20,12 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#define MODULE_NAME "load"
-
 #if defined(HAVE_GETLOADAVG) || defined(KERNEL_LINUX) || defined(HAVE_LIBSTATGRAB)
 # define LOAD_HAVE_READ 1
 #else
 # define LOAD_HAVE_READ 0
 #endif
 
@@ -41,81 +38,77 @@
 #define LOADAVG_1MIN  0
 #define LOADAVG_5MIN  1
 #define LOADAVG_15MIN 2
 #endif
 #endif /* defined(HAVE_GETLOADAVG) */
 
-static char *load_file = "load.rrd";
-
-static char *ds_def[] =
-{
-	"DS:shortterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	"DS:midterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	"DS:longterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	NULL
-};
-static int ds_num = 3;
-
-static void load_init (void)
-{
-	return;
-}
-
-static void load_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, load_file, val, ds_def, ds_num);
-}
-
 #if LOAD_HAVE_READ
-#define BUFSIZE 256
-static void load_submit (double snum, double mnum, double lnum)
+static void load_submit (gauge_t snum, gauge_t mnum, gauge_t lnum)
 {
-	char buf[BUFSIZE];
+	value_t values[3];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFSIZE, "%u:%.2f:%.2f:%.2f", (unsigned int) curtime,
-				snum, mnum, lnum) >= BUFSIZE)
-		return;
+	values[0].gauge = snum;
+	values[1].gauge = mnum;
+	values[2].gauge = lnum;
+
+	vl.values = values;
+	vl.values_len = STATIC_ARRAY_SIZE (values);
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "load");
 
-	plugin_submit (MODULE_NAME, "-", buf);
+	plugin_dispatch_values ("load", &vl);
 }
-#undef BUFSIZE
 
-static void load_read (void)
+static int load_read (void)
 {
 #if defined(HAVE_GETLOADAVG)
 	double load[3];
 
 	if (getloadavg (load, 3) == 3)
 		load_submit (load[LOADAVG_1MIN], load[LOADAVG_5MIN], load[LOADAVG_15MIN]);
 	else
-		syslog (LOG_WARNING, "load: getloadavg failed: %s", strerror (errno));
+	{
+		char errbuf[1024];
+		WARNING ("load: getloadavg failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
 /* #endif HAVE_GETLOADAVG */
 
 #elif defined(KERNEL_LINUX)
-	double snum, mnum, lnum;
+	gauge_t snum, mnum, lnum;
 	FILE *loadavg;
 	char buffer[16];
 
 	char *fields[8];
 	int numfields;
 	
 	if ((loadavg = fopen ("/proc/loadavg", "r")) == NULL)
 	{
-		syslog (LOG_WARNING, "load: fopen: %s", strerror (errno));
+		char errbuf[1024];
+		WARNING ("load: fopen: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return;
 	}
 
 	if (fgets (buffer, 16, loadavg) == NULL)
 	{
-		syslog (LOG_WARNING, "load: fgets: %s", strerror (errno));
+		char errbuf[1024];
+		WARNING ("load: fgets: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		fclose (loadavg);
 		return;
 	}
 
 	if (fclose (loadavg))
-		syslog (LOG_WARNING, "load: fclose: %s", strerror (errno));
+	{
+		char errbuf[1024];
+		WARNING ("load: fclose: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
 
 	numfields = strsplit (buffer, fields, 8);
 
 	if (numfields < 3)
 		return;
 
@@ -124,29 +117,29 @@
 	lnum = atof (fields[2]);
 
 	load_submit (snum, mnum, lnum);
 /* #endif KERNEL_LINUX */
 
 #elif defined(HAVE_LIBSTATGRAB)
-	double snum, mnum, lnum;
+	gauge_t snum, mnum, lnum;
 	sg_load_stats *ls;
 
 	if ((ls = sg_get_load_stats ()) == NULL)
 		return;
 
 	snum = ls->min1;
 	mnum = ls->min5;
 	lnum = ls->min15;
 
 	load_submit (snum, mnum, lnum);
 #endif /* HAVE_LIBSTATGRAB */
+
+	return (0);
 }
-#else
-# define load_read NULL
 #endif /* LOAD_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, load_init, load_read, load_write);
-}
-
-#undef MODULE_NAME
+#if LOAD_HAVE_READ
+	plugin_register_read ("load", load_read);
+#endif
+} /* void module_register */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: logfile.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/Makefile.am	2007-09-28 18:54:14.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/Makefile.am	2007-06-02 18:06:21.000000000 +0800
@@ -1,50 +1,53 @@
-SUBDIRS = libconfig
+SUBDIRS =
+if BUILD_WITH_OWN_LIBOCONFIG
+SUBDIRS += liboconfig
+endif
 if BUILD_WITH_OWN_LIBOPING
 SUBDIRS += liboping
 endif
 
 if COMPILER_IS_GCC
 AM_CFLAGS = -Wall -Werror
 endif
 
 sbin_PROGRAMS = collectd
+bin_PROGRAMS = collectd-nagios
 
 collectd_SOURCES = collectd.c collectd.h \
-		   utils_debug.c utils_debug.h \
+		   utils_avltree.c utils_avltree.h \
 		   utils_mount.c utils_mount.h \
+		   utils_llist.c utils_llist.h \
 		   utils_ignorelist.c utils_ignorelist.h \
 		   common.c common.h \
-		   network.c network.h \
 		   plugin.c plugin.h \
-		   configfile.c configfile.h
+		   configfile.c configfile.h \
+		   types_list.c types_list.h
 collectd_CPPFLAGS = $(LTDLINCL)
+collectd_CPPFLAGS += -DPREFIX='"${prefix}"'
 collectd_CPPFLAGS += -DCONFIGFILE='"${sysconfdir}/${PACKAGE_NAME}.conf"'
 collectd_CPPFLAGS += -DPKGLOCALSTATEDIR='"${localstatedir}/lib/${PACKAGE_NAME}"'
 if BUILD_FEATURE_DAEMON
 collectd_CPPFLAGS += -DPIDFILE='"${localstatedir}/run/${PACKAGE_NAME}.pid"'
 endif
 collectd_CPPFLAGS += -DPLUGINDIR='"${pkglibdir}"'
-if BUILD_FEATURE_DEBUG
-collectd_CPPFLAGS += -DLOGFILE='"${localstatedir}/log/${PACKAGE_NAME}/collectd.log"'
-endif
 
 # Link to these libraries..
 collectd_LDFLAGS = -export-dynamic
-if BUILD_WITH_RRDTOOL
-collectd_LDFLAGS += -lm -lrrd
-endif
 if BUILD_WITH_LIBRT
 collectd_LDFLAGS += -lrt
 endif
 if BUILD_WITH_LIBSOCKET
 collectd_LDFLAGS += -lsocket
 endif
 if BUILD_WITH_LIBRESOLV
 collectd_LDFLAGS += -lresolv
 endif
+if BUILD_WITH_LIBPTHREAD
+collectd_LDFLAGS += -lpthread
+endif
 if BUILD_WITH_LIBKSTAT
 collectd_LDFLAGS += -lkstat
 endif
 if BUILD_WITH_LIBDEVINFO
 collectd_LDFLAGS += -ldevinfo
 endif
@@ -57,14 +60,26 @@
 collectd_LDFLAGS += -ldevstat
 endif
 collectd_LDFLAGS += -lstatgrab
 endif
 
 
-collectd_LDADD = $(LIBLTDL) libconfig/libconfig.la "-dlopen" self
-collectd_DEPENDENCIES = $(LIBLTDL) libconfig/libconfig.la
+collectd_LDADD =
+collectd_DEPENDENCIES =
+if BUILD_WITH_OWN_LIBOCONFIG
+collectd_LDADD += $(LIBLTDL) liboconfig/liboconfig.la
+collectd_DEPENDENCIES += $(LIBLTDL) liboconfig/liboconfig.la
+else
+collectd_LDFLAGS += -loconfig
+endif
+
+collectd_nagios_SOURCES = collectd-nagios.c
+collectd_nagios_LDFLAGS =
+if BUILD_WITH_LIBSOCKET
+collectd_nagios_LDFLAGS += -lsocket
+endif
 
 pkglib_LTLIBRARIES = 
 
 if BUILD_MODULE_APACHE
 pkglib_LTLIBRARIES += apache.la
 apache_la_SOURCES = apache.c
@@ -128,12 +143,20 @@
 cpufreq_la_SOURCES = cpufreq.c
 cpufreq_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" cpufreq.la
 collectd_DEPENDENCIES += cpufreq.la
 endif
 
+if BUILD_MODULE_CSV
+pkglib_LTLIBRARIES += csv.la
+csv_la_SOURCES = csv.c
+csv_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" csv.la
+collectd_DEPENDENCIES += csv.la
+endif
+
 if BUILD_MODULE_DF
 pkglib_LTLIBRARIES += df.la
 df_la_SOURCES = df.c
 df_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" df.la
 collectd_DEPENDENCIES += df.la
@@ -183,34 +206,84 @@
 email_la_LDFLAGS += -lpthread
 endif
 collectd_LDADD += "-dlopen" email.la
 collectd_DEPENDENCIES += email.la
 endif
 
-#if BUILD_MODULE_QUOTA
-#pkglib_LTLIBRARIES += quota.la
-#quota_la_SOURCES = quota_plugin.c quota_plugin.h
-#quota_la_SOURCES += quota_fs.c quota_fs.h
-#quota_la_SOURCES += quota_mnt.c quota_mnt.h
-#quota_la_LDFLAGS = -module -avoid-version
-#quota_la_CFLAGS = -Werror
-#collectd_LDADD += "-dlopen" quota.la
-#collectd_DEPENDENCIES += quota.la
-#endif
+if BUILD_MODULE_ENTROPY
+pkglib_LTLIBRARIES += entropy.la
+entropy_la_SOURCES = entropy.c
+entropy_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" entropy.la
+collectd_DEPENDENCIES += entropy.la
+endif
+
+if BUILD_MODULE_EXEC
+pkglib_LTLIBRARIES += exec.la
+exec_la_SOURCES = exec.c
+exec_la_LDFLAGS = -module -avoid-version
+if BUILD_WITH_LIBPTHREAD
+exec_la_LDFLAGS += -lpthread
+endif
+collectd_LDADD += "-dlopen" exec.la
+collectd_DEPENDENCIES += exec.la
+endif
 
 if BUILD_MODULE_HDDTEMP
 pkglib_LTLIBRARIES += hddtemp.la
 hddtemp_la_SOURCES = hddtemp.c
 hddtemp_la_LDFLAGS = -module -avoid-version
 if BUILD_WITH_LIBSOCKET
 hddtemp_la_LDFLAGS += -lsocket
 endif
 collectd_LDADD += "-dlopen" hddtemp.la
 collectd_DEPENDENCIES += hddtemp.la
 endif
 
+if BUILD_MODULE_INTERFACE
+pkglib_LTLIBRARIES += interface.la
+interface_la_SOURCES = interface.c
+interface_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" interface.la
+collectd_DEPENDENCIES += interface.la
+if BUILD_WITH_LIBKSTAT
+interface_la_LDFLAGS += -lkstat
+endif
+if BUILD_WITH_LIBDEVINFO
+interface_la_LDFLAGS += -ldevinfo
+endif
+if BUILD_WITH_LIBSTATGRAB
+if BUILD_WITH_LIBKVM
+interface_la_LDFLAGS += -lkvm
+endif
+if BUILD_WITH_LIBDEVSTAT
+interface_la_LDFLAGS += -ldevstat
+endif
+interface_la_LDFLAGS += -lstatgrab
+endif
+endif
+
+if BUILD_MODULE_IPTABLES
+pkglib_LTLIBRARIES += iptables.la
+iptables_la_SOURCES = iptables.c
+iptables_la_LDFLAGS = -module -avoid-version
+if BUILD_WITH_LIBIPTC
+iptables_la_LDFLAGS += -liptc
+endif
+collectd_LDADD += "-dlopen" iptables.la
+collectd_DEPENDENCIES += iptables.la
+endif
+
+if BUILD_MODULE_IRQ
+pkglib_LTLIBRARIES += irq.la
+irq_la_SOURCES = irq.c
+irq_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" irq.la
+collectd_DEPENDENCIES += irq.la
+endif
+
 if BUILD_MODULE_LOAD
 pkglib_LTLIBRARIES += load.la
 load_la_SOURCES = load.c
 load_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" load.la
 collectd_DEPENDENCIES += load.la
@@ -222,12 +295,20 @@
 load_la_LDFLAGS += -ldevstat
 endif
 load_la_LDFLAGS += -lstatgrab
 endif
 endif
 
+if BUILD_MODULE_LOGFILE
+pkglib_LTLIBRARIES += logfile.la
+logfile_la_SOURCES = logfile.c
+logfile_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" logfile.la
+collectd_DEPENDENCIES += logfile.la
+endif
+
 if BUILD_MODULE_MBMON
 pkglib_LTLIBRARIES += mbmon.la
 mbmon_la_SOURCES = mbmon.c
 mbmon_la_LDFLAGS = -module -avoid-version
 if BUILD_WITH_LIBSOCKET
 mbmon_la_LDFLAGS += -lsocket
@@ -275,12 +356,26 @@
 mysql_la_LDFLAGS += -lmysqlclient
 endif
 collectd_LDADD += "-dlopen" mysql.la
 collectd_DEPENDENCIES += mysql.la
 endif
 
+if BUILD_MODULE_NETWORK
+pkglib_LTLIBRARIES += network.la
+network_la_SOURCES = network.c network.h
+network_la_LDFLAGS = -module -avoid-version
+if BUILD_WITH_LIBSOCKET
+network_la_LDFLAGS += -lsocket
+endif
+if BUILD_WITH_LIBPTHREAD
+network_la_LDFLAGS += -lpthread
+endif
+collectd_LDADD += "-dlopen" network.la
+collectd_DEPENDENCIES += network.la
+endif
+
 if BUILD_MODULE_NFS
 pkglib_LTLIBRARIES += nfs.la
 nfs_la_SOURCES = nfs.c
 nfs_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" nfs.la
 collectd_DEPENDENCIES += nfs.la
@@ -294,12 +389,40 @@
 ntpd_la_LDFLAGS += -lsocket
 endif
 collectd_LDADD += "-dlopen" ntpd.la
 collectd_DEPENDENCIES += ntpd.la
 endif
 
+if BUILD_MODULE_NUT
+pkglib_LTLIBRARIES += nut.la
+nut_la_SOURCES = nut.c
+nut_la_LDFLAGS = -module -avoid-version
+if BUILD_WITH_LIBUPSCLIENT
+nut_la_LDFLAGS += -lupsclient
+if BUILD_WITH_LIBPTHREAD
+nut_la_LDFLAGS += -lpthread
+endif
+endif
+collectd_LDADD += "-dlopen" nut.la
+collectd_DEPENDENCIES += nut.la
+endif
+
+if BUILD_WITH_LIBPERL
+if BUILD_MODULE_PERL
+pkglib_LTLIBRARIES += perl.la
+perl_la_SOURCES = perl.c
+perl_la_CFLAGS  = $(AM_CFLAGS) \
+		  $(PERL_CFLAGS) \
+		  -DXS_VERSION=\"$(VERSION)\" -DVERSION=\"$(VERSION)\"
+perl_la_LDFLAGS = -module -avoid-version \
+		  $(PERL_LDFLAGS)
+collectd_LDADD += "-dlopen" perl.la
+collectd_DEPENDENCIES += perl.la
+endif
+endif
+
 if BUILD_MODULE_PING
 pkglib_LTLIBRARIES += ping.la
 ping_la_SOURCES = ping.c
 ping_la_LDFLAGS = -module -avoid-version
 if BUILD_WITH_LIBOPING
 if BUILD_WITH_OWN_LIBOPING
@@ -318,12 +441,20 @@
 processes_la_SOURCES = processes.c
 processes_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" processes.la
 collectd_DEPENDENCIES += processes.la
 endif
 
+if BUILD_WITH_RRDTOOL
+pkglib_LTLIBRARIES += rrdtool.la
+rrdtool_la_SOURCES = rrdtool.c
+rrdtool_la_LDFLAGS = -module -avoid-version -lrrd
+collectd_LDADD += "-dlopen" rrdtool.la
+collectd_DEPENDENCIES += rrdtool.la
+endif
+
 if BUILD_MODULE_SENSORS
 pkglib_LTLIBRARIES += sensors.la
 sensors_la_SOURCES = sensors.c
 sensors_la_LDFLAGS = -module -avoid-version
 if BUILD_WITH_LM_SENSORS
 sensors_la_LDFLAGS += -lsensors
@@ -360,12 +491,20 @@
 swap_la_LDFLAGS += -ldevstat
 endif
 swap_la_LDFLAGS += -lstatgrab
 endif
 endif
 
+if BUILD_MODULE_SYSLOG
+pkglib_LTLIBRARIES += syslog.la
+syslog_la_SOURCES = syslog.c
+syslog_la_LDFLAGS = -module -avoid-version
+collectd_LDADD += "-dlopen" syslog.la
+collectd_DEPENDENCIES += syslog.la
+endif
+
 if BUILD_MODULE_TAPE
 pkglib_LTLIBRARIES += tape.la
 tape_la_SOURCES = tape.c
 tape_la_LDFLAGS = -module -avoid-version
 if BUILD_WITH_LIBKSTAT
 tape_la_LDFLAGS += -lkstat
@@ -374,33 +513,19 @@
 tape_la_LDFLAGS += -ldevinfo
 endif
 collectd_LDADD += "-dlopen" tape.la
 collectd_DEPENDENCIES += tape.la
 endif
 
-if BUILD_MODULE_TRAFFIC
-pkglib_LTLIBRARIES += traffic.la
-traffic_la_SOURCES = traffic.c
-traffic_la_LDFLAGS = -module -avoid-version
-collectd_LDADD += "-dlopen" traffic.la
-collectd_DEPENDENCIES += traffic.la
-if BUILD_WITH_LIBKSTAT
-traffic_la_LDFLAGS += -lkstat
-endif
-if BUILD_WITH_LIBDEVINFO
-traffic_la_LDFLAGS += -ldevinfo
-endif
-if BUILD_WITH_LIBSTATGRAB
-if BUILD_WITH_LIBKVM
-traffic_la_LDFLAGS += -lkvm
-endif
-if BUILD_WITH_LIBDEVSTAT
-traffic_la_LDFLAGS += -ldevstat
-endif
-traffic_la_LDFLAGS += -lstatgrab
-endif
+if BUILD_MODULE_UNIXSOCK
+pkglib_LTLIBRARIES += unixsock.la
+unixsock_la_SOURCES = unixsock.c
+unixsock_la_CPPFLAGS = -DPREFIX='"${prefix}"'
+unixsock_la_LDFLAGS = -module -avoid-version -lpthread
+collectd_LDADD += "-dlopen" unixsock.la
+collectd_DEPENDENCIES += unixsock.la
 endif
 
 if BUILD_MODULE_USERS
 pkglib_LTLIBRARIES += users.la
 users_la_SOURCES = users.c
 users_la_LDFLAGS = -module -avoid-version
@@ -421,16 +546,19 @@
 wireless_la_SOURCES = wireless.c
 wireless_la_LDFLAGS = -module -avoid-version
 collectd_LDADD += "-dlopen" wireless.la
 collectd_DEPENDENCIES += wireless.la
 endif
 
-dist_man_MANS = collectd.1 collectd.conf.5
+dist_man_MANS = collectd.1 collectd-nagios.1 collectd.conf.5 \
+		collectd-email.5 collectd-exec.5 collectd-perl.5 \
+		collectd-unixsock.5
+
 #collectd_1_SOURCES = collectd.pod
 
-#EXTRA_DIST = $(man_MANS)
+EXTRA_DIST = types.db
 
 .pod.1:
 	pod2man --release=$(VERSION) --center=$(PACKAGE) $< >$@
 
 .pod.5:
 	pod2man --section=5 --release=$(VERSION) --center=$(PACKAGE) $< >$@
@@ -439,7 +567,8 @@
 	$(mkinstalldirs) $(DESTDIR)$(sysconfdir)
 	if test -e $(DESTDIR)$(sysconfdir)/collectd.conf; \
 	then \
 		$(INSTALL) -m 0640 collectd.conf $(DESTDIR)$(sysconfdir)/collectd.conf.pkg-orig; \
 	else \
 		$(INSTALL) -m 0640 collectd.conf $(DESTDIR)$(sysconfdir)/collectd.conf; \
-	fi
+	fi; \
+	cp -f types.db $(DESTDIR)$(pkglibdir)/;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/Makefile.in	2007-09-28 19:01:07.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/Makefile.in	2007-06-04 01:13:27.000000000 +0800
@@ -34,159 +34,195 @@
 POST_INSTALL = :
 NORMAL_UNINSTALL = :
 PRE_UNINSTALL = :
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-@BUILD_WITH_OWN_LIBOPING_TRUE@am__append_1 = liboping
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@am__append_1 = liboconfig
+@BUILD_WITH_OWN_LIBOPING_TRUE@am__append_2 = liboping
 sbin_PROGRAMS = collectd$(EXEEXT)
-@BUILD_FEATURE_DAEMON_TRUE@am__append_2 = -DPIDFILE='"${localstatedir}/run/${PACKAGE_NAME}.pid"'
-@BUILD_FEATURE_DEBUG_TRUE@am__append_3 = -DLOGFILE='"${localstatedir}/log/${PACKAGE_NAME}/collectd.log"'
-@BUILD_WITH_RRDTOOL_TRUE@am__append_4 = -lm -lrrd
-@BUILD_WITH_LIBRT_TRUE@am__append_5 = -lrt
-@BUILD_WITH_LIBSOCKET_TRUE@am__append_6 = -lsocket
-@BUILD_WITH_LIBRESOLV_TRUE@am__append_7 = -lresolv
+bin_PROGRAMS = collectd-nagios$(EXEEXT)
+@BUILD_FEATURE_DAEMON_TRUE@am__append_3 = -DPIDFILE='"${localstatedir}/run/${PACKAGE_NAME}.pid"'
+@BUILD_WITH_LIBRT_TRUE@am__append_4 = -lrt
+@BUILD_WITH_LIBSOCKET_TRUE@am__append_5 = -lsocket
+@BUILD_WITH_LIBRESOLV_TRUE@am__append_6 = -lresolv
+@BUILD_WITH_LIBPTHREAD_TRUE@am__append_7 = -lpthread
 @BUILD_WITH_LIBKSTAT_TRUE@am__append_8 = -lkstat
 @BUILD_WITH_LIBDEVINFO_TRUE@am__append_9 = -ldevinfo
 @BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_10 = -lkvm
 @BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_11 = -ldevstat
 @BUILD_WITH_LIBSTATGRAB_TRUE@am__append_12 = -lstatgrab
-@BUILD_MODULE_APACHE_TRUE@am__append_13 = apache.la
-@BUILD_MODULE_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_14 = $(BUILD_WITH_LIBCURL_LIBS)
-@BUILD_MODULE_APACHE_TRUE@am__append_15 = "-dlopen" apache.la
-@BUILD_MODULE_APACHE_TRUE@am__append_16 = apache.la
-@BUILD_MODULE_APCUPS_TRUE@am__append_17 = apcups.la
-@BUILD_MODULE_APCUPS_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_18 = -lsocket
-@BUILD_MODULE_APCUPS_TRUE@am__append_19 = "-dlopen" apcups.la
-@BUILD_MODULE_APCUPS_TRUE@am__append_20 = apcups.la
-@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_21 = apple_sensors.la
-@BUILD_MODULE_APPLE_SENSORS_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_22 = -lIOKit
-@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_23 = "-dlopen" apple_sensors.la
-@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_24 = apple_sensors.la
-@BUILD_MODULE_BATTERY_TRUE@am__append_25 = battery.la
-@BUILD_MODULE_BATTERY_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_26 = -lIOKit
-@BUILD_MODULE_BATTERY_TRUE@am__append_27 = "-dlopen" battery.la
-@BUILD_MODULE_BATTERY_TRUE@am__append_28 = battery.la
-@BUILD_MODULE_CPU_TRUE@am__append_29 = cpu.la
-@BUILD_MODULE_CPU_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_30 = -lkstat
-@BUILD_MODULE_CPU_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_31 = -ldevinfo
-@BUILD_MODULE_CPU_TRUE@am__append_32 = "-dlopen" cpu.la
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@am__append_13 = $(LIBLTDL) liboconfig/liboconfig.la
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@am__append_14 = $(LIBLTDL) liboconfig/liboconfig.la
+@BUILD_WITH_OWN_LIBOCONFIG_FALSE@am__append_15 = -loconfig
+@BUILD_WITH_LIBSOCKET_TRUE@am__append_16 = -lsocket
+@BUILD_MODULE_APACHE_TRUE@am__append_17 = apache.la
+@BUILD_MODULE_APACHE_TRUE@@BUILD_WITH_LIBCURL_TRUE@am__append_18 = $(BUILD_WITH_LIBCURL_LIBS)
+@BUILD_MODULE_APACHE_TRUE@am__append_19 = "-dlopen" apache.la
+@BUILD_MODULE_APACHE_TRUE@am__append_20 = apache.la
+@BUILD_MODULE_APCUPS_TRUE@am__append_21 = apcups.la
+@BUILD_MODULE_APCUPS_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_22 = -lsocket
+@BUILD_MODULE_APCUPS_TRUE@am__append_23 = "-dlopen" apcups.la
+@BUILD_MODULE_APCUPS_TRUE@am__append_24 = apcups.la
+@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_25 = apple_sensors.la
+@BUILD_MODULE_APPLE_SENSORS_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_26 = -lIOKit
+@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_27 = "-dlopen" apple_sensors.la
+@BUILD_MODULE_APPLE_SENSORS_TRUE@am__append_28 = apple_sensors.la
+@BUILD_MODULE_BATTERY_TRUE@am__append_29 = battery.la
+@BUILD_MODULE_BATTERY_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_30 = -lIOKit
+@BUILD_MODULE_BATTERY_TRUE@am__append_31 = "-dlopen" battery.la
+@BUILD_MODULE_BATTERY_TRUE@am__append_32 = battery.la
 @BUILD_MODULE_CPU_TRUE@am__append_33 = cpu.la
-@BUILD_MODULE_CPUFREQ_TRUE@am__append_34 = cpufreq.la
-@BUILD_MODULE_CPUFREQ_TRUE@am__append_35 = "-dlopen" cpufreq.la
-@BUILD_MODULE_CPUFREQ_TRUE@am__append_36 = cpufreq.la
-@BUILD_MODULE_DF_TRUE@am__append_37 = df.la
-@BUILD_MODULE_DF_TRUE@am__append_38 = "-dlopen" df.la
-@BUILD_MODULE_DF_TRUE@am__append_39 = df.la
-@BUILD_MODULE_DISK_TRUE@am__append_40 = disk.la
-@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_41 = -lkstat
-@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_42 = -ldevinfo
-@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_43 = -lIOKit
-@BUILD_MODULE_DISK_TRUE@am__append_44 = "-dlopen" disk.la
-@BUILD_MODULE_DISK_TRUE@am__append_45 = disk.la
-@BUILD_MODULE_DNS_TRUE@am__append_46 = dns.la
-@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPCAP_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_47 = utils_dns.c utils_dns.h
-@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPCAP_TRUE@am__append_48 = -lpcap
-@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_49 = -lpthread
-@BUILD_MODULE_DNS_TRUE@am__append_50 = "-dlopen" dns.la
-@BUILD_MODULE_DNS_TRUE@am__append_51 = dns.la
-@BUILD_MODULE_EMAIL_TRUE@am__append_52 = email.la
-@BUILD_MODULE_EMAIL_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_53 = -lpthread
-@BUILD_MODULE_EMAIL_TRUE@am__append_54 = "-dlopen" email.la
-@BUILD_MODULE_EMAIL_TRUE@am__append_55 = email.la
-
-#if BUILD_MODULE_QUOTA
-#pkglib_LTLIBRARIES += quota.la
-#quota_la_SOURCES = quota_plugin.c quota_plugin.h
-#quota_la_SOURCES += quota_fs.c quota_fs.h
-#quota_la_SOURCES += quota_mnt.c quota_mnt.h
-#quota_la_LDFLAGS = -module -avoid-version
-#quota_la_CFLAGS = -Werror
-#collectd_LDADD += "-dlopen" quota.la
-#collectd_DEPENDENCIES += quota.la
-#endif
-@BUILD_MODULE_HDDTEMP_TRUE@am__append_56 = hddtemp.la
-@BUILD_MODULE_HDDTEMP_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_57 = -lsocket
-@BUILD_MODULE_HDDTEMP_TRUE@am__append_58 = "-dlopen" hddtemp.la
-@BUILD_MODULE_HDDTEMP_TRUE@am__append_59 = hddtemp.la
-@BUILD_MODULE_LOAD_TRUE@am__append_60 = load.la
-@BUILD_MODULE_LOAD_TRUE@am__append_61 = "-dlopen" load.la
-@BUILD_MODULE_LOAD_TRUE@am__append_62 = load.la
-@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_63 = -lkvm
-@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_64 = -ldevstat
-@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_65 = -lstatgrab
-@BUILD_MODULE_MBMON_TRUE@am__append_66 = mbmon.la
-@BUILD_MODULE_MBMON_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_67 = -lsocket
-@BUILD_MODULE_MBMON_TRUE@am__append_68 = "-dlopen" mbmon.la
-@BUILD_MODULE_MBMON_TRUE@am__append_69 = mbmon.la
-@BUILD_MODULE_MEMORY_TRUE@am__append_70 = memory.la
-@BUILD_MODULE_MEMORY_TRUE@am__append_71 = "-dlopen" memory.la
-@BUILD_MODULE_MEMORY_TRUE@am__append_72 = memory.la
-@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_73 = -lkstat
-@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_74 = -ldevinfo
-@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_75 = -lkvm
-@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_76 = -ldevstat
-@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_77 = -lstatgrab
-@BUILD_MODULE_MULTIMETER_TRUE@am__append_78 = multimeter.la
-@BUILD_MODULE_MULTIMETER_TRUE@am__append_79 = "-dlopen" multimeter.la
-@BUILD_MODULE_MULTIMETER_TRUE@am__append_80 = multimeter.la
-@BUILD_MODULE_MYSQL_TRUE@am__append_81 = mysql.la
-@BUILD_MODULE_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_82 = -lmysqlclient
-@BUILD_MODULE_MYSQL_TRUE@am__append_83 = "-dlopen" mysql.la
-@BUILD_MODULE_MYSQL_TRUE@am__append_84 = mysql.la
-@BUILD_MODULE_NFS_TRUE@am__append_85 = nfs.la
-@BUILD_MODULE_NFS_TRUE@am__append_86 = "-dlopen" nfs.la
-@BUILD_MODULE_NFS_TRUE@am__append_87 = nfs.la
-@BUILD_MODULE_NTPD_TRUE@am__append_88 = ntpd.la
-@BUILD_MODULE_NTPD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_89 = -lsocket
-@BUILD_MODULE_NTPD_TRUE@am__append_90 = "-dlopen" ntpd.la
-@BUILD_MODULE_NTPD_TRUE@am__append_91 = ntpd.la
-@BUILD_MODULE_PING_TRUE@am__append_92 = ping.la
-@BUILD_MODULE_PING_TRUE@@BUILD_WITH_LIBOPING_TRUE@@BUILD_WITH_OWN_LIBOPING_FALSE@am__append_93 = -loping
-@BUILD_MODULE_PING_TRUE@am__append_94 = "-dlopen" ping.la
-@BUILD_MODULE_PING_TRUE@am__append_95 = ping.la
-@BUILD_MODULE_PROCESSES_TRUE@am__append_96 = processes.la
-@BUILD_MODULE_PROCESSES_TRUE@am__append_97 = "-dlopen" processes.la
-@BUILD_MODULE_PROCESSES_TRUE@am__append_98 = processes.la
-@BUILD_MODULE_SENSORS_TRUE@am__append_99 = sensors.la
-@BUILD_MODULE_SENSORS_TRUE@@BUILD_WITH_LM_SENSORS_TRUE@am__append_100 = -lsensors
-@BUILD_MODULE_SENSORS_TRUE@am__append_101 = "-dlopen" sensors.la
-@BUILD_MODULE_SENSORS_TRUE@am__append_102 = sensors.la
-@BUILD_MODULE_SERIAL_TRUE@am__append_103 = serial.la
-@BUILD_MODULE_SERIAL_TRUE@am__append_104 = "-dlopen" serial.la
-@BUILD_MODULE_SERIAL_TRUE@am__append_105 = serial.la
-@BUILD_MODULE_SWAP_TRUE@am__append_106 = swap.la
-@BUILD_MODULE_SWAP_TRUE@am__append_107 = "-dlopen" swap.la
-@BUILD_MODULE_SWAP_TRUE@am__append_108 = swap.la
-@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_109 = -lkstat
-@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_110 = -ldevinfo
-@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBKVM_TRUE@am__append_111 = -lkvm
-@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_112 = -ldevstat
-@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_113 = -lstatgrab
-@BUILD_MODULE_TAPE_TRUE@am__append_114 = tape.la
-@BUILD_MODULE_TAPE_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_115 = -lkstat
-@BUILD_MODULE_TAPE_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_116 = -ldevinfo
-@BUILD_MODULE_TAPE_TRUE@am__append_117 = "-dlopen" tape.la
-@BUILD_MODULE_TAPE_TRUE@am__append_118 = tape.la
-@BUILD_MODULE_TRAFFIC_TRUE@am__append_119 = traffic.la
-@BUILD_MODULE_TRAFFIC_TRUE@am__append_120 = "-dlopen" traffic.la
-@BUILD_MODULE_TRAFFIC_TRUE@am__append_121 = traffic.la
-@BUILD_MODULE_TRAFFIC_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_122 = -lkstat
-@BUILD_MODULE_TRAFFIC_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_123 = -ldevinfo
-@BUILD_MODULE_TRAFFIC_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_124 = -lkvm
-@BUILD_MODULE_TRAFFIC_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_125 = -ldevstat
-@BUILD_MODULE_TRAFFIC_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_126 = -lstatgrab
-@BUILD_MODULE_USERS_TRUE@am__append_127 = users.la
-@BUILD_MODULE_USERS_TRUE@am__append_128 = "-dlopen" users.la
-@BUILD_MODULE_USERS_TRUE@am__append_129 = users.la
-@BUILD_MODULE_VSERVER_TRUE@am__append_130 = vserver.la
-@BUILD_MODULE_VSERVER_TRUE@am__append_131 = "-dlopen" vserver.la
-@BUILD_MODULE_VSERVER_TRUE@am__append_132 = vserver.la
-@BUILD_MODULE_WIRELESS_TRUE@am__append_133 = wireless.la
-@BUILD_MODULE_WIRELESS_TRUE@am__append_134 = "-dlopen" wireless.la
-@BUILD_MODULE_WIRELESS_TRUE@am__append_135 = wireless.la
+@BUILD_MODULE_CPU_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_34 = -lkstat
+@BUILD_MODULE_CPU_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_35 = -ldevinfo
+@BUILD_MODULE_CPU_TRUE@am__append_36 = "-dlopen" cpu.la
+@BUILD_MODULE_CPU_TRUE@am__append_37 = cpu.la
+@BUILD_MODULE_CPUFREQ_TRUE@am__append_38 = cpufreq.la
+@BUILD_MODULE_CPUFREQ_TRUE@am__append_39 = "-dlopen" cpufreq.la
+@BUILD_MODULE_CPUFREQ_TRUE@am__append_40 = cpufreq.la
+@BUILD_MODULE_CSV_TRUE@am__append_41 = csv.la
+@BUILD_MODULE_CSV_TRUE@am__append_42 = "-dlopen" csv.la
+@BUILD_MODULE_CSV_TRUE@am__append_43 = csv.la
+@BUILD_MODULE_DF_TRUE@am__append_44 = df.la
+@BUILD_MODULE_DF_TRUE@am__append_45 = "-dlopen" df.la
+@BUILD_MODULE_DF_TRUE@am__append_46 = df.la
+@BUILD_MODULE_DISK_TRUE@am__append_47 = disk.la
+@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_48 = -lkstat
+@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_49 = -ldevinfo
+@BUILD_MODULE_DISK_TRUE@@BUILD_WITH_LIBIOKIT_TRUE@am__append_50 = -lIOKit
+@BUILD_MODULE_DISK_TRUE@am__append_51 = "-dlopen" disk.la
+@BUILD_MODULE_DISK_TRUE@am__append_52 = disk.la
+@BUILD_MODULE_DNS_TRUE@am__append_53 = dns.la
+@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPCAP_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_54 = utils_dns.c utils_dns.h
+@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPCAP_TRUE@am__append_55 = -lpcap
+@BUILD_MODULE_DNS_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_56 = -lpthread
+@BUILD_MODULE_DNS_TRUE@am__append_57 = "-dlopen" dns.la
+@BUILD_MODULE_DNS_TRUE@am__append_58 = dns.la
+@BUILD_MODULE_EMAIL_TRUE@am__append_59 = email.la
+@BUILD_MODULE_EMAIL_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_60 = -lpthread
+@BUILD_MODULE_EMAIL_TRUE@am__append_61 = "-dlopen" email.la
+@BUILD_MODULE_EMAIL_TRUE@am__append_62 = email.la
+@BUILD_MODULE_ENTROPY_TRUE@am__append_63 = entropy.la
+@BUILD_MODULE_ENTROPY_TRUE@am__append_64 = "-dlopen" entropy.la
+@BUILD_MODULE_ENTROPY_TRUE@am__append_65 = entropy.la
+@BUILD_MODULE_EXEC_TRUE@am__append_66 = exec.la
+@BUILD_MODULE_EXEC_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_67 = -lpthread
+@BUILD_MODULE_EXEC_TRUE@am__append_68 = "-dlopen" exec.la
+@BUILD_MODULE_EXEC_TRUE@am__append_69 = exec.la
+@BUILD_MODULE_HDDTEMP_TRUE@am__append_70 = hddtemp.la
+@BUILD_MODULE_HDDTEMP_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_71 = -lsocket
+@BUILD_MODULE_HDDTEMP_TRUE@am__append_72 = "-dlopen" hddtemp.la
+@BUILD_MODULE_HDDTEMP_TRUE@am__append_73 = hddtemp.la
+@BUILD_MODULE_INTERFACE_TRUE@am__append_74 = interface.la
+@BUILD_MODULE_INTERFACE_TRUE@am__append_75 = "-dlopen" interface.la
+@BUILD_MODULE_INTERFACE_TRUE@am__append_76 = interface.la
+@BUILD_MODULE_INTERFACE_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_77 = -lkstat
+@BUILD_MODULE_INTERFACE_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_78 = -ldevinfo
+@BUILD_MODULE_INTERFACE_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_79 = -lkvm
+@BUILD_MODULE_INTERFACE_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_80 = -ldevstat
+@BUILD_MODULE_INTERFACE_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_81 = -lstatgrab
+@BUILD_MODULE_IPTABLES_TRUE@am__append_82 = iptables.la
+@BUILD_MODULE_IPTABLES_TRUE@@BUILD_WITH_LIBIPTC_TRUE@am__append_83 = -liptc
+@BUILD_MODULE_IPTABLES_TRUE@am__append_84 = "-dlopen" iptables.la
+@BUILD_MODULE_IPTABLES_TRUE@am__append_85 = iptables.la
+@BUILD_MODULE_IRQ_TRUE@am__append_86 = irq.la
+@BUILD_MODULE_IRQ_TRUE@am__append_87 = "-dlopen" irq.la
+@BUILD_MODULE_IRQ_TRUE@am__append_88 = irq.la
+@BUILD_MODULE_LOAD_TRUE@am__append_89 = load.la
+@BUILD_MODULE_LOAD_TRUE@am__append_90 = "-dlopen" load.la
+@BUILD_MODULE_LOAD_TRUE@am__append_91 = load.la
+@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_92 = -lkvm
+@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_93 = -ldevstat
+@BUILD_MODULE_LOAD_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_94 = -lstatgrab
+@BUILD_MODULE_LOGFILE_TRUE@am__append_95 = logfile.la
+@BUILD_MODULE_LOGFILE_TRUE@am__append_96 = "-dlopen" logfile.la
+@BUILD_MODULE_LOGFILE_TRUE@am__append_97 = logfile.la
+@BUILD_MODULE_MBMON_TRUE@am__append_98 = mbmon.la
+@BUILD_MODULE_MBMON_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_99 = -lsocket
+@BUILD_MODULE_MBMON_TRUE@am__append_100 = "-dlopen" mbmon.la
+@BUILD_MODULE_MBMON_TRUE@am__append_101 = mbmon.la
+@BUILD_MODULE_MEMORY_TRUE@am__append_102 = memory.la
+@BUILD_MODULE_MEMORY_TRUE@am__append_103 = "-dlopen" memory.la
+@BUILD_MODULE_MEMORY_TRUE@am__append_104 = memory.la
+@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_105 = -lkstat
+@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_106 = -ldevinfo
+@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBKVM_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_107 = -lkvm
+@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_108 = -ldevstat
+@BUILD_MODULE_MEMORY_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_109 = -lstatgrab
+@BUILD_MODULE_MULTIMETER_TRUE@am__append_110 = multimeter.la
+@BUILD_MODULE_MULTIMETER_TRUE@am__append_111 = "-dlopen" multimeter.la
+@BUILD_MODULE_MULTIMETER_TRUE@am__append_112 = multimeter.la
+@BUILD_MODULE_MYSQL_TRUE@am__append_113 = mysql.la
+@BUILD_MODULE_MYSQL_TRUE@@BUILD_WITH_LIBMYSQL_TRUE@am__append_114 = -lmysqlclient
+@BUILD_MODULE_MYSQL_TRUE@am__append_115 = "-dlopen" mysql.la
+@BUILD_MODULE_MYSQL_TRUE@am__append_116 = mysql.la
+@BUILD_MODULE_NETWORK_TRUE@am__append_117 = network.la
+@BUILD_MODULE_NETWORK_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_118 = -lsocket
+@BUILD_MODULE_NETWORK_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@am__append_119 = -lpthread
+@BUILD_MODULE_NETWORK_TRUE@am__append_120 = "-dlopen" network.la
+@BUILD_MODULE_NETWORK_TRUE@am__append_121 = network.la
+@BUILD_MODULE_NFS_TRUE@am__append_122 = nfs.la
+@BUILD_MODULE_NFS_TRUE@am__append_123 = "-dlopen" nfs.la
+@BUILD_MODULE_NFS_TRUE@am__append_124 = nfs.la
+@BUILD_MODULE_NTPD_TRUE@am__append_125 = ntpd.la
+@BUILD_MODULE_NTPD_TRUE@@BUILD_WITH_LIBSOCKET_TRUE@am__append_126 = -lsocket
+@BUILD_MODULE_NTPD_TRUE@am__append_127 = "-dlopen" ntpd.la
+@BUILD_MODULE_NTPD_TRUE@am__append_128 = ntpd.la
+@BUILD_MODULE_NUT_TRUE@am__append_129 = nut.la
+@BUILD_MODULE_NUT_TRUE@@BUILD_WITH_LIBUPSCLIENT_TRUE@am__append_130 = -lupsclient
+@BUILD_MODULE_NUT_TRUE@@BUILD_WITH_LIBPTHREAD_TRUE@@BUILD_WITH_LIBUPSCLIENT_TRUE@am__append_131 = -lpthread
+@BUILD_MODULE_NUT_TRUE@am__append_132 = "-dlopen" nut.la
+@BUILD_MODULE_NUT_TRUE@am__append_133 = nut.la
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am__append_134 = perl.la
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am__append_135 = "-dlopen" perl.la
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am__append_136 = perl.la
+@BUILD_MODULE_PING_TRUE@am__append_137 = ping.la
+@BUILD_MODULE_PING_TRUE@@BUILD_WITH_LIBOPING_TRUE@@BUILD_WITH_OWN_LIBOPING_FALSE@am__append_138 = -loping
+@BUILD_MODULE_PING_TRUE@am__append_139 = "-dlopen" ping.la
+@BUILD_MODULE_PING_TRUE@am__append_140 = ping.la
+@BUILD_MODULE_PROCESSES_TRUE@am__append_141 = processes.la
+@BUILD_MODULE_PROCESSES_TRUE@am__append_142 = "-dlopen" processes.la
+@BUILD_MODULE_PROCESSES_TRUE@am__append_143 = processes.la
+@BUILD_WITH_RRDTOOL_TRUE@am__append_144 = rrdtool.la
+@BUILD_WITH_RRDTOOL_TRUE@am__append_145 = "-dlopen" rrdtool.la
+@BUILD_WITH_RRDTOOL_TRUE@am__append_146 = rrdtool.la
+@BUILD_MODULE_SENSORS_TRUE@am__append_147 = sensors.la
+@BUILD_MODULE_SENSORS_TRUE@@BUILD_WITH_LM_SENSORS_TRUE@am__append_148 = -lsensors
+@BUILD_MODULE_SENSORS_TRUE@am__append_149 = "-dlopen" sensors.la
+@BUILD_MODULE_SENSORS_TRUE@am__append_150 = sensors.la
+@BUILD_MODULE_SERIAL_TRUE@am__append_151 = serial.la
+@BUILD_MODULE_SERIAL_TRUE@am__append_152 = "-dlopen" serial.la
+@BUILD_MODULE_SERIAL_TRUE@am__append_153 = serial.la
+@BUILD_MODULE_SWAP_TRUE@am__append_154 = swap.la
+@BUILD_MODULE_SWAP_TRUE@am__append_155 = "-dlopen" swap.la
+@BUILD_MODULE_SWAP_TRUE@am__append_156 = swap.la
+@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_157 = -lkstat
+@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_158 = -ldevinfo
+@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBKVM_TRUE@am__append_159 = -lkvm
+@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBDEVSTAT_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_160 = -ldevstat
+@BUILD_MODULE_SWAP_TRUE@@BUILD_WITH_LIBSTATGRAB_TRUE@am__append_161 = -lstatgrab
+@BUILD_MODULE_SYSLOG_TRUE@am__append_162 = syslog.la
+@BUILD_MODULE_SYSLOG_TRUE@am__append_163 = "-dlopen" syslog.la
+@BUILD_MODULE_SYSLOG_TRUE@am__append_164 = syslog.la
+@BUILD_MODULE_TAPE_TRUE@am__append_165 = tape.la
+@BUILD_MODULE_TAPE_TRUE@@BUILD_WITH_LIBKSTAT_TRUE@am__append_166 = -lkstat
+@BUILD_MODULE_TAPE_TRUE@@BUILD_WITH_LIBDEVINFO_TRUE@am__append_167 = -ldevinfo
+@BUILD_MODULE_TAPE_TRUE@am__append_168 = "-dlopen" tape.la
+@BUILD_MODULE_TAPE_TRUE@am__append_169 = tape.la
+@BUILD_MODULE_UNIXSOCK_TRUE@am__append_170 = unixsock.la
+@BUILD_MODULE_UNIXSOCK_TRUE@am__append_171 = "-dlopen" unixsock.la
+@BUILD_MODULE_UNIXSOCK_TRUE@am__append_172 = unixsock.la
+@BUILD_MODULE_USERS_TRUE@am__append_173 = users.la
+@BUILD_MODULE_USERS_TRUE@am__append_174 = "-dlopen" users.la
+@BUILD_MODULE_USERS_TRUE@am__append_175 = users.la
+@BUILD_MODULE_VSERVER_TRUE@am__append_176 = vserver.la
+@BUILD_MODULE_VSERVER_TRUE@am__append_177 = "-dlopen" vserver.la
+@BUILD_MODULE_VSERVER_TRUE@am__append_178 = vserver.la
+@BUILD_MODULE_WIRELESS_TRUE@am__append_179 = wireless.la
+@BUILD_MODULE_WIRELESS_TRUE@am__append_180 = "-dlopen" wireless.la
+@BUILD_MODULE_WIRELESS_TRUE@am__append_181 = wireless.la
 subdir = src
 DIST_COMMON = $(dist_man_MANS) $(srcdir)/Makefile.am \
 	$(srcdir)/Makefile.in $(srcdir)/collectd.conf.in \
 	$(srcdir)/config.h.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/configure.in
@@ -198,14 +234,15 @@
 am__vpath_adj_setup = srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`;
 am__vpath_adj = case $$p in \
     $(srcdir)/*) f=`echo "$$p" | sed "s|^$$srcdirstrip/||"`;; \
     *) f=$$p;; \
   esac;
 am__strip_dir = `echo $$p | sed -e 's|^.*/||'`;
-am__installdirs = "$(DESTDIR)$(pkglibdir)" "$(DESTDIR)$(sbindir)" \
-	"$(DESTDIR)$(man1dir)" "$(DESTDIR)$(man5dir)"
+am__installdirs = "$(DESTDIR)$(pkglibdir)" "$(DESTDIR)$(bindir)" \
+	"$(DESTDIR)$(sbindir)" "$(DESTDIR)$(man1dir)" \
+	"$(DESTDIR)$(man5dir)"
 pkglibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(pkglib_LTLIBRARIES)
 apache_la_LIBADD =
 am__apache_la_SOURCES_DIST = apache.c
 @BUILD_MODULE_APACHE_TRUE@am_apache_la_OBJECTS = apache.lo
 apache_la_OBJECTS = $(am_apache_la_OBJECTS)
@@ -234,12 +271,17 @@
 @BUILD_MODULE_CPU_TRUE@am_cpu_la_rpath = -rpath $(pkglibdir)
 cpufreq_la_LIBADD =
 am__cpufreq_la_SOURCES_DIST = cpufreq.c
 @BUILD_MODULE_CPUFREQ_TRUE@am_cpufreq_la_OBJECTS = cpufreq.lo
 cpufreq_la_OBJECTS = $(am_cpufreq_la_OBJECTS)
 @BUILD_MODULE_CPUFREQ_TRUE@am_cpufreq_la_rpath = -rpath $(pkglibdir)
+csv_la_LIBADD =
+am__csv_la_SOURCES_DIST = csv.c
+@BUILD_MODULE_CSV_TRUE@am_csv_la_OBJECTS = csv.lo
+csv_la_OBJECTS = $(am_csv_la_OBJECTS)
+@BUILD_MODULE_CSV_TRUE@am_csv_la_rpath = -rpath $(pkglibdir)
 df_la_LIBADD =
 am__df_la_SOURCES_DIST = df.c
 @BUILD_MODULE_DF_TRUE@am_df_la_OBJECTS = df.lo
 df_la_OBJECTS = $(am_df_la_OBJECTS)
 @BUILD_MODULE_DF_TRUE@am_df_la_rpath = -rpath $(pkglibdir)
 disk_la_LIBADD =
@@ -255,22 +297,53 @@
 @BUILD_MODULE_DNS_TRUE@am_dns_la_rpath = -rpath $(pkglibdir)
 email_la_LIBADD =
 am__email_la_SOURCES_DIST = email.c
 @BUILD_MODULE_EMAIL_TRUE@am_email_la_OBJECTS = email.lo
 email_la_OBJECTS = $(am_email_la_OBJECTS)
 @BUILD_MODULE_EMAIL_TRUE@am_email_la_rpath = -rpath $(pkglibdir)
+entropy_la_LIBADD =
+am__entropy_la_SOURCES_DIST = entropy.c
+@BUILD_MODULE_ENTROPY_TRUE@am_entropy_la_OBJECTS = entropy.lo
+entropy_la_OBJECTS = $(am_entropy_la_OBJECTS)
+@BUILD_MODULE_ENTROPY_TRUE@am_entropy_la_rpath = -rpath $(pkglibdir)
+exec_la_LIBADD =
+am__exec_la_SOURCES_DIST = exec.c
+@BUILD_MODULE_EXEC_TRUE@am_exec_la_OBJECTS = exec.lo
+exec_la_OBJECTS = $(am_exec_la_OBJECTS)
+@BUILD_MODULE_EXEC_TRUE@am_exec_la_rpath = -rpath $(pkglibdir)
 hddtemp_la_LIBADD =
 am__hddtemp_la_SOURCES_DIST = hddtemp.c
 @BUILD_MODULE_HDDTEMP_TRUE@am_hddtemp_la_OBJECTS = hddtemp.lo
 hddtemp_la_OBJECTS = $(am_hddtemp_la_OBJECTS)
 @BUILD_MODULE_HDDTEMP_TRUE@am_hddtemp_la_rpath = -rpath $(pkglibdir)
+interface_la_LIBADD =
+am__interface_la_SOURCES_DIST = interface.c
+@BUILD_MODULE_INTERFACE_TRUE@am_interface_la_OBJECTS = interface.lo
+interface_la_OBJECTS = $(am_interface_la_OBJECTS)
+@BUILD_MODULE_INTERFACE_TRUE@am_interface_la_rpath = -rpath \
+@BUILD_MODULE_INTERFACE_TRUE@	$(pkglibdir)
+iptables_la_LIBADD =
+am__iptables_la_SOURCES_DIST = iptables.c
+@BUILD_MODULE_IPTABLES_TRUE@am_iptables_la_OBJECTS = iptables.lo
+iptables_la_OBJECTS = $(am_iptables_la_OBJECTS)
+@BUILD_MODULE_IPTABLES_TRUE@am_iptables_la_rpath = -rpath $(pkglibdir)
+irq_la_LIBADD =
+am__irq_la_SOURCES_DIST = irq.c
+@BUILD_MODULE_IRQ_TRUE@am_irq_la_OBJECTS = irq.lo
+irq_la_OBJECTS = $(am_irq_la_OBJECTS)
+@BUILD_MODULE_IRQ_TRUE@am_irq_la_rpath = -rpath $(pkglibdir)
 load_la_LIBADD =
 am__load_la_SOURCES_DIST = load.c
 @BUILD_MODULE_LOAD_TRUE@am_load_la_OBJECTS = load.lo
 load_la_OBJECTS = $(am_load_la_OBJECTS)
 @BUILD_MODULE_LOAD_TRUE@am_load_la_rpath = -rpath $(pkglibdir)
+logfile_la_LIBADD =
+am__logfile_la_SOURCES_DIST = logfile.c
+@BUILD_MODULE_LOGFILE_TRUE@am_logfile_la_OBJECTS = logfile.lo
+logfile_la_OBJECTS = $(am_logfile_la_OBJECTS)
+@BUILD_MODULE_LOGFILE_TRUE@am_logfile_la_rpath = -rpath $(pkglibdir)
 mbmon_la_LIBADD =
 am__mbmon_la_SOURCES_DIST = mbmon.c
 @BUILD_MODULE_MBMON_TRUE@am_mbmon_la_OBJECTS = mbmon.lo
 mbmon_la_OBJECTS = $(am_mbmon_la_OBJECTS)
 @BUILD_MODULE_MBMON_TRUE@am_mbmon_la_rpath = -rpath $(pkglibdir)
 memory_la_LIBADD =
@@ -287,32 +360,54 @@
 @BUILD_MODULE_MULTIMETER_TRUE@	$(pkglibdir)
 mysql_la_LIBADD =
 am__mysql_la_SOURCES_DIST = mysql.c
 @BUILD_MODULE_MYSQL_TRUE@am_mysql_la_OBJECTS = mysql.lo
 mysql_la_OBJECTS = $(am_mysql_la_OBJECTS)
 @BUILD_MODULE_MYSQL_TRUE@am_mysql_la_rpath = -rpath $(pkglibdir)
+network_la_LIBADD =
+am__network_la_SOURCES_DIST = network.c network.h
+@BUILD_MODULE_NETWORK_TRUE@am_network_la_OBJECTS = network.lo
+network_la_OBJECTS = $(am_network_la_OBJECTS)
+@BUILD_MODULE_NETWORK_TRUE@am_network_la_rpath = -rpath $(pkglibdir)
 nfs_la_LIBADD =
 am__nfs_la_SOURCES_DIST = nfs.c
 @BUILD_MODULE_NFS_TRUE@am_nfs_la_OBJECTS = nfs.lo
 nfs_la_OBJECTS = $(am_nfs_la_OBJECTS)
 @BUILD_MODULE_NFS_TRUE@am_nfs_la_rpath = -rpath $(pkglibdir)
 ntpd_la_LIBADD =
 am__ntpd_la_SOURCES_DIST = ntpd.c
 @BUILD_MODULE_NTPD_TRUE@am_ntpd_la_OBJECTS = ntpd.lo
 ntpd_la_OBJECTS = $(am_ntpd_la_OBJECTS)
 @BUILD_MODULE_NTPD_TRUE@am_ntpd_la_rpath = -rpath $(pkglibdir)
+nut_la_LIBADD =
+am__nut_la_SOURCES_DIST = nut.c
+@BUILD_MODULE_NUT_TRUE@am_nut_la_OBJECTS = nut.lo
+nut_la_OBJECTS = $(am_nut_la_OBJECTS)
+@BUILD_MODULE_NUT_TRUE@am_nut_la_rpath = -rpath $(pkglibdir)
+perl_la_LIBADD =
+am__perl_la_SOURCES_DIST = perl.c
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am_perl_la_OBJECTS = perl_la-perl.lo
+perl_la_OBJECTS = $(am_perl_la_OBJECTS)
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am_perl_la_rpath =  \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@	-rpath \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@	$(pkglibdir)
 am__ping_la_SOURCES_DIST = ping.c
 @BUILD_MODULE_PING_TRUE@am_ping_la_OBJECTS = ping.lo
 ping_la_OBJECTS = $(am_ping_la_OBJECTS)
 @BUILD_MODULE_PING_TRUE@am_ping_la_rpath = -rpath $(pkglibdir)
 processes_la_LIBADD =
 am__processes_la_SOURCES_DIST = processes.c
 @BUILD_MODULE_PROCESSES_TRUE@am_processes_la_OBJECTS = processes.lo
 processes_la_OBJECTS = $(am_processes_la_OBJECTS)
 @BUILD_MODULE_PROCESSES_TRUE@am_processes_la_rpath = -rpath \
 @BUILD_MODULE_PROCESSES_TRUE@	$(pkglibdir)
+rrdtool_la_LIBADD =
+am__rrdtool_la_SOURCES_DIST = rrdtool.c
+@BUILD_WITH_RRDTOOL_TRUE@am_rrdtool_la_OBJECTS = rrdtool.lo
+rrdtool_la_OBJECTS = $(am_rrdtool_la_OBJECTS)
+@BUILD_WITH_RRDTOOL_TRUE@am_rrdtool_la_rpath = -rpath $(pkglibdir)
 sensors_la_LIBADD =
 am__sensors_la_SOURCES_DIST = sensors.c
 @BUILD_MODULE_SENSORS_TRUE@am_sensors_la_OBJECTS = sensors.lo
 sensors_la_OBJECTS = $(am_sensors_la_OBJECTS)
 @BUILD_MODULE_SENSORS_TRUE@am_sensors_la_rpath = -rpath $(pkglibdir)
 serial_la_LIBADD =
@@ -322,22 +417,28 @@
 @BUILD_MODULE_SERIAL_TRUE@am_serial_la_rpath = -rpath $(pkglibdir)
 swap_la_LIBADD =
 am__swap_la_SOURCES_DIST = swap.c
 @BUILD_MODULE_SWAP_TRUE@am_swap_la_OBJECTS = swap.lo
 swap_la_OBJECTS = $(am_swap_la_OBJECTS)
 @BUILD_MODULE_SWAP_TRUE@am_swap_la_rpath = -rpath $(pkglibdir)
+syslog_la_LIBADD =
+am__syslog_la_SOURCES_DIST = syslog.c
+@BUILD_MODULE_SYSLOG_TRUE@am_syslog_la_OBJECTS = syslog.lo
+syslog_la_OBJECTS = $(am_syslog_la_OBJECTS)
+@BUILD_MODULE_SYSLOG_TRUE@am_syslog_la_rpath = -rpath $(pkglibdir)
 tape_la_LIBADD =
 am__tape_la_SOURCES_DIST = tape.c
 @BUILD_MODULE_TAPE_TRUE@am_tape_la_OBJECTS = tape.lo
 tape_la_OBJECTS = $(am_tape_la_OBJECTS)
 @BUILD_MODULE_TAPE_TRUE@am_tape_la_rpath = -rpath $(pkglibdir)
-traffic_la_LIBADD =
-am__traffic_la_SOURCES_DIST = traffic.c
-@BUILD_MODULE_TRAFFIC_TRUE@am_traffic_la_OBJECTS = traffic.lo
-traffic_la_OBJECTS = $(am_traffic_la_OBJECTS)
-@BUILD_MODULE_TRAFFIC_TRUE@am_traffic_la_rpath = -rpath $(pkglibdir)
+unixsock_la_LIBADD =
+am__unixsock_la_SOURCES_DIST = unixsock.c
+@BUILD_MODULE_UNIXSOCK_TRUE@am_unixsock_la_OBJECTS =  \
+@BUILD_MODULE_UNIXSOCK_TRUE@	unixsock_la-unixsock.lo
+unixsock_la_OBJECTS = $(am_unixsock_la_OBJECTS)
+@BUILD_MODULE_UNIXSOCK_TRUE@am_unixsock_la_rpath = -rpath $(pkglibdir)
 users_la_LIBADD =
 am__users_la_SOURCES_DIST = users.c
 @BUILD_MODULE_USERS_TRUE@am_users_la_OBJECTS = users.lo
 users_la_OBJECTS = $(am_users_la_OBJECTS)
 @BUILD_MODULE_USERS_TRUE@am_users_la_rpath = -rpath $(pkglibdir)
 vserver_la_LIBADD =
@@ -347,53 +448,78 @@
 @BUILD_MODULE_VSERVER_TRUE@am_vserver_la_rpath = -rpath $(pkglibdir)
 wireless_la_LIBADD =
 am__wireless_la_SOURCES_DIST = wireless.c
 @BUILD_MODULE_WIRELESS_TRUE@am_wireless_la_OBJECTS = wireless.lo
 wireless_la_OBJECTS = $(am_wireless_la_OBJECTS)
 @BUILD_MODULE_WIRELESS_TRUE@am_wireless_la_rpath = -rpath $(pkglibdir)
+binPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
 sbinPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
-PROGRAMS = $(sbin_PROGRAMS)
+PROGRAMS = $(bin_PROGRAMS) $(sbin_PROGRAMS)
 am_collectd_OBJECTS = collectd-collectd.$(OBJEXT) \
-	collectd-utils_debug.$(OBJEXT) collectd-utils_mount.$(OBJEXT) \
+	collectd-utils_avltree.$(OBJEXT) \
+	collectd-utils_mount.$(OBJEXT) collectd-utils_llist.$(OBJEXT) \
 	collectd-utils_ignorelist.$(OBJEXT) collectd-common.$(OBJEXT) \
-	collectd-network.$(OBJEXT) collectd-plugin.$(OBJEXT) \
-	collectd-configfile.$(OBJEXT)
+	collectd-plugin.$(OBJEXT) collectd-configfile.$(OBJEXT) \
+	collectd-types_list.$(OBJEXT)
 collectd_OBJECTS = $(am_collectd_OBJECTS)
 am__DEPENDENCIES_1 =
-@BUILD_MODULE_APACHE_TRUE@am__DEPENDENCIES_2 = "-dlopen" apache.la
-@BUILD_MODULE_APCUPS_TRUE@am__DEPENDENCIES_3 = "-dlopen" apcups.la
-@BUILD_MODULE_APPLE_SENSORS_TRUE@am__DEPENDENCIES_4 = "-dlopen" \
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@am__DEPENDENCIES_2 =  \
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@	$(am__DEPENDENCIES_1) \
+@BUILD_WITH_OWN_LIBOCONFIG_TRUE@	liboconfig/liboconfig.la
+@BUILD_MODULE_APACHE_TRUE@am__DEPENDENCIES_3 = "-dlopen" apache.la
+@BUILD_MODULE_APCUPS_TRUE@am__DEPENDENCIES_4 = "-dlopen" apcups.la
+@BUILD_MODULE_APPLE_SENSORS_TRUE@am__DEPENDENCIES_5 = "-dlopen" \
 @BUILD_MODULE_APPLE_SENSORS_TRUE@	apple_sensors.la
-@BUILD_MODULE_BATTERY_TRUE@am__DEPENDENCIES_5 = "-dlopen" battery.la
-@BUILD_MODULE_CPU_TRUE@am__DEPENDENCIES_6 = "-dlopen" cpu.la
-@BUILD_MODULE_CPUFREQ_TRUE@am__DEPENDENCIES_7 = "-dlopen" cpufreq.la
-@BUILD_MODULE_DF_TRUE@am__DEPENDENCIES_8 = "-dlopen" df.la
-@BUILD_MODULE_DISK_TRUE@am__DEPENDENCIES_9 = "-dlopen" disk.la
-@BUILD_MODULE_DNS_TRUE@am__DEPENDENCIES_10 = "-dlopen" dns.la
-@BUILD_MODULE_EMAIL_TRUE@am__DEPENDENCIES_11 = "-dlopen" email.la
-@BUILD_MODULE_HDDTEMP_TRUE@am__DEPENDENCIES_12 = "-dlopen" hddtemp.la
-@BUILD_MODULE_LOAD_TRUE@am__DEPENDENCIES_13 = "-dlopen" load.la
-@BUILD_MODULE_MBMON_TRUE@am__DEPENDENCIES_14 = "-dlopen" mbmon.la
-@BUILD_MODULE_MEMORY_TRUE@am__DEPENDENCIES_15 = "-dlopen" memory.la
-@BUILD_MODULE_MULTIMETER_TRUE@am__DEPENDENCIES_16 = "-dlopen" \
+@BUILD_MODULE_BATTERY_TRUE@am__DEPENDENCIES_6 = "-dlopen" battery.la
+@BUILD_MODULE_CPU_TRUE@am__DEPENDENCIES_7 = "-dlopen" cpu.la
+@BUILD_MODULE_CPUFREQ_TRUE@am__DEPENDENCIES_8 = "-dlopen" cpufreq.la
+@BUILD_MODULE_CSV_TRUE@am__DEPENDENCIES_9 = "-dlopen" csv.la
+@BUILD_MODULE_DF_TRUE@am__DEPENDENCIES_10 = "-dlopen" df.la
+@BUILD_MODULE_DISK_TRUE@am__DEPENDENCIES_11 = "-dlopen" disk.la
+@BUILD_MODULE_DNS_TRUE@am__DEPENDENCIES_12 = "-dlopen" dns.la
+@BUILD_MODULE_EMAIL_TRUE@am__DEPENDENCIES_13 = "-dlopen" email.la
+@BUILD_MODULE_ENTROPY_TRUE@am__DEPENDENCIES_14 = "-dlopen" entropy.la
+@BUILD_MODULE_EXEC_TRUE@am__DEPENDENCIES_15 = "-dlopen" exec.la
+@BUILD_MODULE_HDDTEMP_TRUE@am__DEPENDENCIES_16 = "-dlopen" hddtemp.la
+@BUILD_MODULE_INTERFACE_TRUE@am__DEPENDENCIES_17 = "-dlopen" \
+@BUILD_MODULE_INTERFACE_TRUE@	interface.la
+@BUILD_MODULE_IPTABLES_TRUE@am__DEPENDENCIES_18 = "-dlopen" \
+@BUILD_MODULE_IPTABLES_TRUE@	iptables.la
+@BUILD_MODULE_IRQ_TRUE@am__DEPENDENCIES_19 = "-dlopen" irq.la
+@BUILD_MODULE_LOAD_TRUE@am__DEPENDENCIES_20 = "-dlopen" load.la
+@BUILD_MODULE_LOGFILE_TRUE@am__DEPENDENCIES_21 = "-dlopen" logfile.la
+@BUILD_MODULE_MBMON_TRUE@am__DEPENDENCIES_22 = "-dlopen" mbmon.la
+@BUILD_MODULE_MEMORY_TRUE@am__DEPENDENCIES_23 = "-dlopen" memory.la
+@BUILD_MODULE_MULTIMETER_TRUE@am__DEPENDENCIES_24 = "-dlopen" \
 @BUILD_MODULE_MULTIMETER_TRUE@	multimeter.la
-@BUILD_MODULE_MYSQL_TRUE@am__DEPENDENCIES_17 = "-dlopen" mysql.la
-@BUILD_MODULE_NFS_TRUE@am__DEPENDENCIES_18 = "-dlopen" nfs.la
-@BUILD_MODULE_NTPD_TRUE@am__DEPENDENCIES_19 = "-dlopen" ntpd.la
-@BUILD_MODULE_PING_TRUE@am__DEPENDENCIES_20 = "-dlopen" ping.la
-@BUILD_MODULE_PROCESSES_TRUE@am__DEPENDENCIES_21 = "-dlopen" \
+@BUILD_MODULE_MYSQL_TRUE@am__DEPENDENCIES_25 = "-dlopen" mysql.la
+@BUILD_MODULE_NETWORK_TRUE@am__DEPENDENCIES_26 = "-dlopen" network.la
+@BUILD_MODULE_NFS_TRUE@am__DEPENDENCIES_27 = "-dlopen" nfs.la
+@BUILD_MODULE_NTPD_TRUE@am__DEPENDENCIES_28 = "-dlopen" ntpd.la
+@BUILD_MODULE_NUT_TRUE@am__DEPENDENCIES_29 = "-dlopen" nut.la
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@am__DEPENDENCIES_30 =  \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@	"-dlopen" \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@	perl.la
+@BUILD_MODULE_PING_TRUE@am__DEPENDENCIES_31 = "-dlopen" ping.la
+@BUILD_MODULE_PROCESSES_TRUE@am__DEPENDENCIES_32 = "-dlopen" \
 @BUILD_MODULE_PROCESSES_TRUE@	processes.la
-@BUILD_MODULE_SENSORS_TRUE@am__DEPENDENCIES_22 = "-dlopen" sensors.la
-@BUILD_MODULE_SERIAL_TRUE@am__DEPENDENCIES_23 = "-dlopen" serial.la
-@BUILD_MODULE_SWAP_TRUE@am__DEPENDENCIES_24 = "-dlopen" swap.la
-@BUILD_MODULE_TAPE_TRUE@am__DEPENDENCIES_25 = "-dlopen" tape.la
-@BUILD_MODULE_TRAFFIC_TRUE@am__DEPENDENCIES_26 = "-dlopen" traffic.la
-@BUILD_MODULE_USERS_TRUE@am__DEPENDENCIES_27 = "-dlopen" users.la
-@BUILD_MODULE_VSERVER_TRUE@am__DEPENDENCIES_28 = "-dlopen" vserver.la
-@BUILD_MODULE_WIRELESS_TRUE@am__DEPENDENCIES_29 = "-dlopen" \
+@BUILD_WITH_RRDTOOL_TRUE@am__DEPENDENCIES_33 = "-dlopen" rrdtool.la
+@BUILD_MODULE_SENSORS_TRUE@am__DEPENDENCIES_34 = "-dlopen" sensors.la
+@BUILD_MODULE_SERIAL_TRUE@am__DEPENDENCIES_35 = "-dlopen" serial.la
+@BUILD_MODULE_SWAP_TRUE@am__DEPENDENCIES_36 = "-dlopen" swap.la
+@BUILD_MODULE_SYSLOG_TRUE@am__DEPENDENCIES_37 = "-dlopen" syslog.la
+@BUILD_MODULE_TAPE_TRUE@am__DEPENDENCIES_38 = "-dlopen" tape.la
+@BUILD_MODULE_UNIXSOCK_TRUE@am__DEPENDENCIES_39 = "-dlopen" \
+@BUILD_MODULE_UNIXSOCK_TRUE@	unixsock.la
+@BUILD_MODULE_USERS_TRUE@am__DEPENDENCIES_40 = "-dlopen" users.la
+@BUILD_MODULE_VSERVER_TRUE@am__DEPENDENCIES_41 = "-dlopen" vserver.la
+@BUILD_MODULE_WIRELESS_TRUE@am__DEPENDENCIES_42 = "-dlopen" \
 @BUILD_MODULE_WIRELESS_TRUE@	wireless.la
+am_collectd_nagios_OBJECTS = collectd-nagios.$(OBJEXT)
+collectd_nagios_OBJECTS = $(am_collectd_nagios_OBJECTS)
+collectd_nagios_LDADD = $(LDADD)
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I.
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 LTCOMPILE = $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) \
@@ -401,52 +527,64 @@
 	$(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(apache_la_SOURCES) $(apcups_la_SOURCES) \
 	$(apple_sensors_la_SOURCES) $(battery_la_SOURCES) \
-	$(cpu_la_SOURCES) $(cpufreq_la_SOURCES) $(df_la_SOURCES) \
-	$(disk_la_SOURCES) $(dns_la_SOURCES) $(email_la_SOURCES) \
-	$(hddtemp_la_SOURCES) $(load_la_SOURCES) $(mbmon_la_SOURCES) \
-	$(memory_la_SOURCES) $(multimeter_la_SOURCES) \
-	$(mysql_la_SOURCES) $(nfs_la_SOURCES) $(ntpd_la_SOURCES) \
-	$(ping_la_SOURCES) $(processes_la_SOURCES) \
+	$(cpu_la_SOURCES) $(cpufreq_la_SOURCES) $(csv_la_SOURCES) \
+	$(df_la_SOURCES) $(disk_la_SOURCES) $(dns_la_SOURCES) \
+	$(email_la_SOURCES) $(entropy_la_SOURCES) $(exec_la_SOURCES) \
+	$(hddtemp_la_SOURCES) $(interface_la_SOURCES) \
+	$(iptables_la_SOURCES) $(irq_la_SOURCES) $(load_la_SOURCES) \
+	$(logfile_la_SOURCES) $(mbmon_la_SOURCES) $(memory_la_SOURCES) \
+	$(multimeter_la_SOURCES) $(mysql_la_SOURCES) \
+	$(network_la_SOURCES) $(nfs_la_SOURCES) $(ntpd_la_SOURCES) \
+	$(nut_la_SOURCES) $(perl_la_SOURCES) $(ping_la_SOURCES) \
+	$(processes_la_SOURCES) $(rrdtool_la_SOURCES) \
 	$(sensors_la_SOURCES) $(serial_la_SOURCES) $(swap_la_SOURCES) \
-	$(tape_la_SOURCES) $(traffic_la_SOURCES) $(users_la_SOURCES) \
-	$(vserver_la_SOURCES) $(wireless_la_SOURCES) \
-	$(collectd_SOURCES)
+	$(syslog_la_SOURCES) $(tape_la_SOURCES) $(unixsock_la_SOURCES) \
+	$(users_la_SOURCES) $(vserver_la_SOURCES) \
+	$(wireless_la_SOURCES) $(collectd_SOURCES) \
+	$(collectd_nagios_SOURCES)
 DIST_SOURCES = $(am__apache_la_SOURCES_DIST) \
 	$(am__apcups_la_SOURCES_DIST) \
 	$(am__apple_sensors_la_SOURCES_DIST) \
 	$(am__battery_la_SOURCES_DIST) $(am__cpu_la_SOURCES_DIST) \
-	$(am__cpufreq_la_SOURCES_DIST) $(am__df_la_SOURCES_DIST) \
-	$(am__disk_la_SOURCES_DIST) $(am__dns_la_SOURCES_DIST) \
-	$(am__email_la_SOURCES_DIST) $(am__hddtemp_la_SOURCES_DIST) \
-	$(am__load_la_SOURCES_DIST) $(am__mbmon_la_SOURCES_DIST) \
-	$(am__memory_la_SOURCES_DIST) \
+	$(am__cpufreq_la_SOURCES_DIST) $(am__csv_la_SOURCES_DIST) \
+	$(am__df_la_SOURCES_DIST) $(am__disk_la_SOURCES_DIST) \
+	$(am__dns_la_SOURCES_DIST) $(am__email_la_SOURCES_DIST) \
+	$(am__entropy_la_SOURCES_DIST) $(am__exec_la_SOURCES_DIST) \
+	$(am__hddtemp_la_SOURCES_DIST) \
+	$(am__interface_la_SOURCES_DIST) \
+	$(am__iptables_la_SOURCES_DIST) $(am__irq_la_SOURCES_DIST) \
+	$(am__load_la_SOURCES_DIST) $(am__logfile_la_SOURCES_DIST) \
+	$(am__mbmon_la_SOURCES_DIST) $(am__memory_la_SOURCES_DIST) \
 	$(am__multimeter_la_SOURCES_DIST) $(am__mysql_la_SOURCES_DIST) \
-	$(am__nfs_la_SOURCES_DIST) $(am__ntpd_la_SOURCES_DIST) \
-	$(am__ping_la_SOURCES_DIST) $(am__processes_la_SOURCES_DIST) \
-	$(am__sensors_la_SOURCES_DIST) $(am__serial_la_SOURCES_DIST) \
-	$(am__swap_la_SOURCES_DIST) $(am__tape_la_SOURCES_DIST) \
-	$(am__traffic_la_SOURCES_DIST) $(am__users_la_SOURCES_DIST) \
+	$(am__network_la_SOURCES_DIST) $(am__nfs_la_SOURCES_DIST) \
+	$(am__ntpd_la_SOURCES_DIST) $(am__nut_la_SOURCES_DIST) \
+	$(am__perl_la_SOURCES_DIST) $(am__ping_la_SOURCES_DIST) \
+	$(am__processes_la_SOURCES_DIST) \
+	$(am__rrdtool_la_SOURCES_DIST) $(am__sensors_la_SOURCES_DIST) \
+	$(am__serial_la_SOURCES_DIST) $(am__swap_la_SOURCES_DIST) \
+	$(am__syslog_la_SOURCES_DIST) $(am__tape_la_SOURCES_DIST) \
+	$(am__unixsock_la_SOURCES_DIST) $(am__users_la_SOURCES_DIST) \
 	$(am__vserver_la_SOURCES_DIST) $(am__wireless_la_SOURCES_DIST) \
-	$(collectd_SOURCES)
+	$(collectd_SOURCES) $(collectd_nagios_SOURCES)
 RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
 	html-recursive info-recursive install-data-recursive \
 	install-exec-recursive install-info-recursive \
 	install-recursive installcheck-recursive installdirs-recursive \
 	pdf-recursive ps-recursive uninstall-info-recursive \
 	uninstall-recursive
 man1dir = $(mandir)/man1
 man5dir = $(mandir)/man5
 NROFF = nroff
 MANS = $(dist_man_MANS)
 ETAGS = etags
 CTAGS = ctags
-DIST_SUBDIRS = libconfig liboping
+DIST_SUBDIRS = liboconfig liboping
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
 AMTAR = @AMTAR@
 AR = @AR@
@@ -469,52 +607,72 @@
 BUILD_MODULE_BATTERY_FALSE = @BUILD_MODULE_BATTERY_FALSE@
 BUILD_MODULE_BATTERY_TRUE = @BUILD_MODULE_BATTERY_TRUE@
 BUILD_MODULE_CPUFREQ_FALSE = @BUILD_MODULE_CPUFREQ_FALSE@
 BUILD_MODULE_CPUFREQ_TRUE = @BUILD_MODULE_CPUFREQ_TRUE@
 BUILD_MODULE_CPU_FALSE = @BUILD_MODULE_CPU_FALSE@
 BUILD_MODULE_CPU_TRUE = @BUILD_MODULE_CPU_TRUE@
+BUILD_MODULE_CSV_FALSE = @BUILD_MODULE_CSV_FALSE@
+BUILD_MODULE_CSV_TRUE = @BUILD_MODULE_CSV_TRUE@
 BUILD_MODULE_DF_FALSE = @BUILD_MODULE_DF_FALSE@
 BUILD_MODULE_DF_TRUE = @BUILD_MODULE_DF_TRUE@
 BUILD_MODULE_DISK_FALSE = @BUILD_MODULE_DISK_FALSE@
 BUILD_MODULE_DISK_TRUE = @BUILD_MODULE_DISK_TRUE@
 BUILD_MODULE_DNS_FALSE = @BUILD_MODULE_DNS_FALSE@
 BUILD_MODULE_DNS_TRUE = @BUILD_MODULE_DNS_TRUE@
 BUILD_MODULE_EMAIL_FALSE = @BUILD_MODULE_EMAIL_FALSE@
 BUILD_MODULE_EMAIL_TRUE = @BUILD_MODULE_EMAIL_TRUE@
+BUILD_MODULE_ENTROPY_FALSE = @BUILD_MODULE_ENTROPY_FALSE@
+BUILD_MODULE_ENTROPY_TRUE = @BUILD_MODULE_ENTROPY_TRUE@
+BUILD_MODULE_EXEC_FALSE = @BUILD_MODULE_EXEC_FALSE@
+BUILD_MODULE_EXEC_TRUE = @BUILD_MODULE_EXEC_TRUE@
 BUILD_MODULE_HDDTEMP_FALSE = @BUILD_MODULE_HDDTEMP_FALSE@
 BUILD_MODULE_HDDTEMP_TRUE = @BUILD_MODULE_HDDTEMP_TRUE@
+BUILD_MODULE_INTERFACE_FALSE = @BUILD_MODULE_INTERFACE_FALSE@
+BUILD_MODULE_INTERFACE_TRUE = @BUILD_MODULE_INTERFACE_TRUE@
+BUILD_MODULE_IPTABLES_FALSE = @BUILD_MODULE_IPTABLES_FALSE@
+BUILD_MODULE_IPTABLES_TRUE = @BUILD_MODULE_IPTABLES_TRUE@
+BUILD_MODULE_IRQ_FALSE = @BUILD_MODULE_IRQ_FALSE@
+BUILD_MODULE_IRQ_TRUE = @BUILD_MODULE_IRQ_TRUE@
 BUILD_MODULE_LOAD_FALSE = @BUILD_MODULE_LOAD_FALSE@
 BUILD_MODULE_LOAD_TRUE = @BUILD_MODULE_LOAD_TRUE@
+BUILD_MODULE_LOGFILE_FALSE = @BUILD_MODULE_LOGFILE_FALSE@
+BUILD_MODULE_LOGFILE_TRUE = @BUILD_MODULE_LOGFILE_TRUE@
 BUILD_MODULE_MBMON_FALSE = @BUILD_MODULE_MBMON_FALSE@
 BUILD_MODULE_MBMON_TRUE = @BUILD_MODULE_MBMON_TRUE@
 BUILD_MODULE_MEMORY_FALSE = @BUILD_MODULE_MEMORY_FALSE@
 BUILD_MODULE_MEMORY_TRUE = @BUILD_MODULE_MEMORY_TRUE@
 BUILD_MODULE_MULTIMETER_FALSE = @BUILD_MODULE_MULTIMETER_FALSE@
 BUILD_MODULE_MULTIMETER_TRUE = @BUILD_MODULE_MULTIMETER_TRUE@
 BUILD_MODULE_MYSQL_FALSE = @BUILD_MODULE_MYSQL_FALSE@
 BUILD_MODULE_MYSQL_TRUE = @BUILD_MODULE_MYSQL_TRUE@
+BUILD_MODULE_NETWORK_FALSE = @BUILD_MODULE_NETWORK_FALSE@
+BUILD_MODULE_NETWORK_TRUE = @BUILD_MODULE_NETWORK_TRUE@
 BUILD_MODULE_NFS_FALSE = @BUILD_MODULE_NFS_FALSE@
 BUILD_MODULE_NFS_TRUE = @BUILD_MODULE_NFS_TRUE@
 BUILD_MODULE_NTPD_FALSE = @BUILD_MODULE_NTPD_FALSE@
 BUILD_MODULE_NTPD_TRUE = @BUILD_MODULE_NTPD_TRUE@
+BUILD_MODULE_NUT_FALSE = @BUILD_MODULE_NUT_FALSE@
+BUILD_MODULE_NUT_TRUE = @BUILD_MODULE_NUT_TRUE@
+BUILD_MODULE_PERL_FALSE = @BUILD_MODULE_PERL_FALSE@
+BUILD_MODULE_PERL_TRUE = @BUILD_MODULE_PERL_TRUE@
 BUILD_MODULE_PING_FALSE = @BUILD_MODULE_PING_FALSE@
 BUILD_MODULE_PING_TRUE = @BUILD_MODULE_PING_TRUE@
 BUILD_MODULE_PROCESSES_FALSE = @BUILD_MODULE_PROCESSES_FALSE@
 BUILD_MODULE_PROCESSES_TRUE = @BUILD_MODULE_PROCESSES_TRUE@
-BUILD_MODULE_QUOTA_FALSE = @BUILD_MODULE_QUOTA_FALSE@
-BUILD_MODULE_QUOTA_TRUE = @BUILD_MODULE_QUOTA_TRUE@
 BUILD_MODULE_SENSORS_FALSE = @BUILD_MODULE_SENSORS_FALSE@
 BUILD_MODULE_SENSORS_TRUE = @BUILD_MODULE_SENSORS_TRUE@
 BUILD_MODULE_SERIAL_FALSE = @BUILD_MODULE_SERIAL_FALSE@
 BUILD_MODULE_SERIAL_TRUE = @BUILD_MODULE_SERIAL_TRUE@
 BUILD_MODULE_SWAP_FALSE = @BUILD_MODULE_SWAP_FALSE@
 BUILD_MODULE_SWAP_TRUE = @BUILD_MODULE_SWAP_TRUE@
+BUILD_MODULE_SYSLOG_FALSE = @BUILD_MODULE_SYSLOG_FALSE@
+BUILD_MODULE_SYSLOG_TRUE = @BUILD_MODULE_SYSLOG_TRUE@
 BUILD_MODULE_TAPE_FALSE = @BUILD_MODULE_TAPE_FALSE@
 BUILD_MODULE_TAPE_TRUE = @BUILD_MODULE_TAPE_TRUE@
-BUILD_MODULE_TRAFFIC_FALSE = @BUILD_MODULE_TRAFFIC_FALSE@
-BUILD_MODULE_TRAFFIC_TRUE = @BUILD_MODULE_TRAFFIC_TRUE@
+BUILD_MODULE_UNIXSOCK_FALSE = @BUILD_MODULE_UNIXSOCK_FALSE@
+BUILD_MODULE_UNIXSOCK_TRUE = @BUILD_MODULE_UNIXSOCK_TRUE@
 BUILD_MODULE_USERS_FALSE = @BUILD_MODULE_USERS_FALSE@
 BUILD_MODULE_USERS_TRUE = @BUILD_MODULE_USERS_TRUE@
 BUILD_MODULE_VSERVER_FALSE = @BUILD_MODULE_VSERVER_FALSE@
 BUILD_MODULE_VSERVER_TRUE = @BUILD_MODULE_VSERVER_TRUE@
 BUILD_MODULE_WIRELESS_FALSE = @BUILD_MODULE_WIRELESS_FALSE@
 BUILD_MODULE_WIRELESS_TRUE = @BUILD_MODULE_WIRELESS_TRUE@
@@ -524,34 +682,42 @@
 BUILD_WITH_LIBDEVINFO_FALSE = @BUILD_WITH_LIBDEVINFO_FALSE@
 BUILD_WITH_LIBDEVINFO_TRUE = @BUILD_WITH_LIBDEVINFO_TRUE@
 BUILD_WITH_LIBDEVSTAT_FALSE = @BUILD_WITH_LIBDEVSTAT_FALSE@
 BUILD_WITH_LIBDEVSTAT_TRUE = @BUILD_WITH_LIBDEVSTAT_TRUE@
 BUILD_WITH_LIBIOKIT_FALSE = @BUILD_WITH_LIBIOKIT_FALSE@
 BUILD_WITH_LIBIOKIT_TRUE = @BUILD_WITH_LIBIOKIT_TRUE@
+BUILD_WITH_LIBIPTC_FALSE = @BUILD_WITH_LIBIPTC_FALSE@
+BUILD_WITH_LIBIPTC_TRUE = @BUILD_WITH_LIBIPTC_TRUE@
 BUILD_WITH_LIBKSTAT_FALSE = @BUILD_WITH_LIBKSTAT_FALSE@
 BUILD_WITH_LIBKSTAT_TRUE = @BUILD_WITH_LIBKSTAT_TRUE@
 BUILD_WITH_LIBKVM_FALSE = @BUILD_WITH_LIBKVM_FALSE@
 BUILD_WITH_LIBKVM_TRUE = @BUILD_WITH_LIBKVM_TRUE@
 BUILD_WITH_LIBMYSQL_FALSE = @BUILD_WITH_LIBMYSQL_FALSE@
 BUILD_WITH_LIBMYSQL_TRUE = @BUILD_WITH_LIBMYSQL_TRUE@
 BUILD_WITH_LIBOPING_FALSE = @BUILD_WITH_LIBOPING_FALSE@
 BUILD_WITH_LIBOPING_TRUE = @BUILD_WITH_LIBOPING_TRUE@
 BUILD_WITH_LIBPCAP_FALSE = @BUILD_WITH_LIBPCAP_FALSE@
 BUILD_WITH_LIBPCAP_TRUE = @BUILD_WITH_LIBPCAP_TRUE@
+BUILD_WITH_LIBPERL_FALSE = @BUILD_WITH_LIBPERL_FALSE@
+BUILD_WITH_LIBPERL_TRUE = @BUILD_WITH_LIBPERL_TRUE@
 BUILD_WITH_LIBPTHREAD_FALSE = @BUILD_WITH_LIBPTHREAD_FALSE@
 BUILD_WITH_LIBPTHREAD_TRUE = @BUILD_WITH_LIBPTHREAD_TRUE@
 BUILD_WITH_LIBRESOLV_FALSE = @BUILD_WITH_LIBRESOLV_FALSE@
 BUILD_WITH_LIBRESOLV_TRUE = @BUILD_WITH_LIBRESOLV_TRUE@
 BUILD_WITH_LIBRT_FALSE = @BUILD_WITH_LIBRT_FALSE@
 BUILD_WITH_LIBRT_TRUE = @BUILD_WITH_LIBRT_TRUE@
 BUILD_WITH_LIBSOCKET_FALSE = @BUILD_WITH_LIBSOCKET_FALSE@
 BUILD_WITH_LIBSOCKET_TRUE = @BUILD_WITH_LIBSOCKET_TRUE@
 BUILD_WITH_LIBSTATGRAB_FALSE = @BUILD_WITH_LIBSTATGRAB_FALSE@
 BUILD_WITH_LIBSTATGRAB_TRUE = @BUILD_WITH_LIBSTATGRAB_TRUE@
+BUILD_WITH_LIBUPSCLIENT_FALSE = @BUILD_WITH_LIBUPSCLIENT_FALSE@
+BUILD_WITH_LIBUPSCLIENT_TRUE = @BUILD_WITH_LIBUPSCLIENT_TRUE@
 BUILD_WITH_LM_SENSORS_FALSE = @BUILD_WITH_LM_SENSORS_FALSE@
 BUILD_WITH_LM_SENSORS_TRUE = @BUILD_WITH_LM_SENSORS_TRUE@
+BUILD_WITH_OWN_LIBOCONFIG_FALSE = @BUILD_WITH_OWN_LIBOCONFIG_FALSE@
+BUILD_WITH_OWN_LIBOCONFIG_TRUE = @BUILD_WITH_OWN_LIBOCONFIG_TRUE@
 BUILD_WITH_OWN_LIBOPING_FALSE = @BUILD_WITH_OWN_LIBOPING_FALSE@
 BUILD_WITH_OWN_LIBOPING_TRUE = @BUILD_WITH_OWN_LIBOPING_TRUE@
 BUILD_WITH_RRDTOOL_FALSE = @BUILD_WITH_RRDTOOL_FALSE@
 BUILD_WITH_RRDTOOL_TRUE = @BUILD_WITH_RRDTOOL_TRUE@
 CC = @CC@
 CCDEPMODE = @CCDEPMODE@
@@ -578,12 +744,15 @@
 GREP = @GREP@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_STRIP_PROGRAM = @INSTALL_STRIP_PROGRAM@
 LDFLAGS = @LDFLAGS@
+LEX = @LEX@
+LEXLIB = @LEXLIB@
+LEX_OUTPUT_ROOT = @LEX_OUTPUT_ROOT@
 LIBLTDL = @LIBLTDL@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
 LIBTOOL = @LIBTOOL@
 LN_S = @LN_S@
 LTDLINCL = @LTDLINCL@
@@ -594,18 +763,21 @@
 PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
 PACKAGE_NAME = @PACKAGE_NAME@
 PACKAGE_STRING = @PACKAGE_STRING@
 PACKAGE_TARNAME = @PACKAGE_TARNAME@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
+PERL_CFLAGS = @PERL_CFLAGS@
+PERL_LDFLAGS = @PERL_LDFLAGS@
 RANLIB = @RANLIB@
-SED = @SED@
 SET_MAKE = @SET_MAKE@
 SHELL = @SHELL@
 STRIP = @STRIP@
 VERSION = @VERSION@
+YACC = @YACC@
+YFLAGS = @YFLAGS@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -648,152 +820,206 @@
 psdir = @psdir@
 sbindir = @sbindir@
 sharedstatedir = @sharedstatedir@
 subdirs = @subdirs@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-SUBDIRS = libconfig $(am__append_1)
+SUBDIRS = $(am__append_1) $(am__append_2)
 @COMPILER_IS_GCC_TRUE@AM_CFLAGS = -Wall -Werror
 collectd_SOURCES = collectd.c collectd.h \
-		   utils_debug.c utils_debug.h \
+		   utils_avltree.c utils_avltree.h \
 		   utils_mount.c utils_mount.h \
+		   utils_llist.c utils_llist.h \
 		   utils_ignorelist.c utils_ignorelist.h \
 		   common.c common.h \
-		   network.c network.h \
 		   plugin.c plugin.h \
-		   configfile.c configfile.h
+		   configfile.c configfile.h \
+		   types_list.c types_list.h
 
-collectd_CPPFLAGS = $(LTDLINCL) \
+collectd_CPPFLAGS = $(LTDLINCL) -DPREFIX='"${prefix}"' \
 	-DCONFIGFILE='"${sysconfdir}/${PACKAGE_NAME}.conf"' \
 	-DPKGLOCALSTATEDIR='"${localstatedir}/lib/${PACKAGE_NAME}"' \
-	$(am__append_2) -DPLUGINDIR='"${pkglibdir}"' $(am__append_3)
+	$(am__append_3) -DPLUGINDIR='"${pkglibdir}"'
 
 # Link to these libraries..
 collectd_LDFLAGS = -export-dynamic $(am__append_4) $(am__append_5) \
 	$(am__append_6) $(am__append_7) $(am__append_8) \
 	$(am__append_9) $(am__append_10) $(am__append_11) \
-	$(am__append_12)
-collectd_LDADD = $(LIBLTDL) libconfig/libconfig.la "-dlopen" self \
-	$(am__append_15) $(am__append_19) $(am__append_23) \
-	$(am__append_27) $(am__append_32) $(am__append_35) \
-	$(am__append_38) $(am__append_44) $(am__append_50) \
-	$(am__append_54) $(am__append_58) $(am__append_61) \
-	$(am__append_68) $(am__append_71) $(am__append_79) \
-	$(am__append_83) $(am__append_86) $(am__append_90) \
-	$(am__append_94) $(am__append_97) $(am__append_101) \
-	$(am__append_104) $(am__append_107) $(am__append_117) \
-	$(am__append_120) $(am__append_128) $(am__append_131) \
-	$(am__append_134)
-collectd_DEPENDENCIES = $(LIBLTDL) libconfig/libconfig.la \
-	$(am__append_16) $(am__append_20) $(am__append_24) \
-	$(am__append_28) $(am__append_33) $(am__append_36) \
-	$(am__append_39) $(am__append_45) $(am__append_51) \
-	$(am__append_55) $(am__append_59) $(am__append_62) \
-	$(am__append_69) $(am__append_72) $(am__append_80) \
-	$(am__append_84) $(am__append_87) $(am__append_91) \
-	$(am__append_95) $(am__append_98) $(am__append_102) \
-	$(am__append_105) $(am__append_108) $(am__append_118) \
-	$(am__append_121) $(am__append_129) $(am__append_132) \
-	$(am__append_135)
-pkglib_LTLIBRARIES = $(am__append_13) $(am__append_17) \
-	$(am__append_21) $(am__append_25) $(am__append_29) \
-	$(am__append_34) $(am__append_37) $(am__append_40) \
-	$(am__append_46) $(am__append_52) $(am__append_56) \
-	$(am__append_60) $(am__append_66) $(am__append_70) \
-	$(am__append_78) $(am__append_81) $(am__append_85) \
-	$(am__append_88) $(am__append_92) $(am__append_96) \
-	$(am__append_99) $(am__append_103) $(am__append_106) \
-	$(am__append_114) $(am__append_119) $(am__append_127) \
-	$(am__append_130) $(am__append_133)
+	$(am__append_12) $(am__append_15)
+collectd_LDADD = $(am__append_13) $(am__append_19) $(am__append_23) \
+	$(am__append_27) $(am__append_31) $(am__append_36) \
+	$(am__append_39) $(am__append_42) $(am__append_45) \
+	$(am__append_51) $(am__append_57) $(am__append_61) \
+	$(am__append_64) $(am__append_68) $(am__append_72) \
+	$(am__append_75) $(am__append_84) $(am__append_87) \
+	$(am__append_90) $(am__append_96) $(am__append_100) \
+	$(am__append_103) $(am__append_111) $(am__append_115) \
+	$(am__append_120) $(am__append_123) $(am__append_127) \
+	$(am__append_132) $(am__append_135) $(am__append_139) \
+	$(am__append_142) $(am__append_145) $(am__append_149) \
+	$(am__append_152) $(am__append_155) $(am__append_163) \
+	$(am__append_168) $(am__append_171) $(am__append_174) \
+	$(am__append_177) $(am__append_180)
+collectd_DEPENDENCIES = $(am__append_14) $(am__append_20) \
+	$(am__append_24) $(am__append_28) $(am__append_32) \
+	$(am__append_37) $(am__append_40) $(am__append_43) \
+	$(am__append_46) $(am__append_52) $(am__append_58) \
+	$(am__append_62) $(am__append_65) $(am__append_69) \
+	$(am__append_73) $(am__append_76) $(am__append_85) \
+	$(am__append_88) $(am__append_91) $(am__append_97) \
+	$(am__append_101) $(am__append_104) $(am__append_112) \
+	$(am__append_116) $(am__append_121) $(am__append_124) \
+	$(am__append_128) $(am__append_133) $(am__append_136) \
+	$(am__append_140) $(am__append_143) $(am__append_146) \
+	$(am__append_150) $(am__append_153) $(am__append_156) \
+	$(am__append_164) $(am__append_169) $(am__append_172) \
+	$(am__append_175) $(am__append_178) $(am__append_181)
+collectd_nagios_SOURCES = collectd-nagios.c
+collectd_nagios_LDFLAGS = $(am__append_16)
+pkglib_LTLIBRARIES = $(am__append_17) $(am__append_21) \
+	$(am__append_25) $(am__append_29) $(am__append_33) \
+	$(am__append_38) $(am__append_41) $(am__append_44) \
+	$(am__append_47) $(am__append_53) $(am__append_59) \
+	$(am__append_63) $(am__append_66) $(am__append_70) \
+	$(am__append_74) $(am__append_82) $(am__append_86) \
+	$(am__append_89) $(am__append_95) $(am__append_98) \
+	$(am__append_102) $(am__append_110) $(am__append_113) \
+	$(am__append_117) $(am__append_122) $(am__append_125) \
+	$(am__append_129) $(am__append_134) $(am__append_137) \
+	$(am__append_141) $(am__append_144) $(am__append_147) \
+	$(am__append_151) $(am__append_154) $(am__append_162) \
+	$(am__append_165) $(am__append_170) $(am__append_173) \
+	$(am__append_176) $(am__append_179)
 @BUILD_MODULE_APACHE_TRUE@apache_la_SOURCES = apache.c
 @BUILD_MODULE_APACHE_TRUE@apache_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_APACHE_TRUE@	$(am__append_14)
+@BUILD_MODULE_APACHE_TRUE@	$(am__append_18)
 @BUILD_MODULE_APCUPS_TRUE@apcups_la_SOURCES = apcups.c
 @BUILD_MODULE_APCUPS_TRUE@apcups_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_APCUPS_TRUE@	$(am__append_18)
+@BUILD_MODULE_APCUPS_TRUE@	$(am__append_22)
 @BUILD_MODULE_APPLE_SENSORS_TRUE@apple_sensors_la_SOURCES = apple_sensors.c
 @BUILD_MODULE_APPLE_SENSORS_TRUE@apple_sensors_la_LDFLAGS = -module \
 @BUILD_MODULE_APPLE_SENSORS_TRUE@	-avoid-version \
-@BUILD_MODULE_APPLE_SENSORS_TRUE@	$(am__append_22)
+@BUILD_MODULE_APPLE_SENSORS_TRUE@	$(am__append_26)
 @BUILD_MODULE_BATTERY_TRUE@battery_la_SOURCES = battery.c
 @BUILD_MODULE_BATTERY_TRUE@battery_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_BATTERY_TRUE@	$(am__append_26)
+@BUILD_MODULE_BATTERY_TRUE@	$(am__append_30)
 @BUILD_MODULE_CPU_TRUE@cpu_la_SOURCES = cpu.c
 @BUILD_MODULE_CPU_TRUE@cpu_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_CPU_TRUE@	$(am__append_30) $(am__append_31)
+@BUILD_MODULE_CPU_TRUE@	$(am__append_34) $(am__append_35)
 @BUILD_MODULE_CPUFREQ_TRUE@cpufreq_la_SOURCES = cpufreq.c
 @BUILD_MODULE_CPUFREQ_TRUE@cpufreq_la_LDFLAGS = -module -avoid-version
+@BUILD_MODULE_CSV_TRUE@csv_la_SOURCES = csv.c
+@BUILD_MODULE_CSV_TRUE@csv_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_DF_TRUE@df_la_SOURCES = df.c
 @BUILD_MODULE_DF_TRUE@df_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_DISK_TRUE@disk_la_SOURCES = disk.c
 @BUILD_MODULE_DISK_TRUE@disk_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_DISK_TRUE@	$(am__append_41) $(am__append_42) \
-@BUILD_MODULE_DISK_TRUE@	$(am__append_43)
-@BUILD_MODULE_DNS_TRUE@dns_la_SOURCES = dns.c $(am__append_47)
+@BUILD_MODULE_DISK_TRUE@	$(am__append_48) $(am__append_49) \
+@BUILD_MODULE_DISK_TRUE@	$(am__append_50)
+@BUILD_MODULE_DNS_TRUE@dns_la_SOURCES = dns.c $(am__append_54)
 @BUILD_MODULE_DNS_TRUE@dns_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_DNS_TRUE@	$(am__append_48) $(am__append_49)
+@BUILD_MODULE_DNS_TRUE@	$(am__append_55) $(am__append_56)
 @BUILD_MODULE_EMAIL_TRUE@email_la_SOURCES = email.c
 @BUILD_MODULE_EMAIL_TRUE@email_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_EMAIL_TRUE@	$(am__append_53)
+@BUILD_MODULE_EMAIL_TRUE@	$(am__append_60)
+@BUILD_MODULE_ENTROPY_TRUE@entropy_la_SOURCES = entropy.c
+@BUILD_MODULE_ENTROPY_TRUE@entropy_la_LDFLAGS = -module -avoid-version
+@BUILD_MODULE_EXEC_TRUE@exec_la_SOURCES = exec.c
+@BUILD_MODULE_EXEC_TRUE@exec_la_LDFLAGS = -module -avoid-version \
+@BUILD_MODULE_EXEC_TRUE@	$(am__append_67)
 @BUILD_MODULE_HDDTEMP_TRUE@hddtemp_la_SOURCES = hddtemp.c
 @BUILD_MODULE_HDDTEMP_TRUE@hddtemp_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_HDDTEMP_TRUE@	$(am__append_57)
+@BUILD_MODULE_HDDTEMP_TRUE@	$(am__append_71)
+@BUILD_MODULE_INTERFACE_TRUE@interface_la_SOURCES = interface.c
+@BUILD_MODULE_INTERFACE_TRUE@interface_la_LDFLAGS = -module \
+@BUILD_MODULE_INTERFACE_TRUE@	-avoid-version $(am__append_77) \
+@BUILD_MODULE_INTERFACE_TRUE@	$(am__append_78) $(am__append_79) \
+@BUILD_MODULE_INTERFACE_TRUE@	$(am__append_80) $(am__append_81)
+@BUILD_MODULE_IPTABLES_TRUE@iptables_la_SOURCES = iptables.c
+@BUILD_MODULE_IPTABLES_TRUE@iptables_la_LDFLAGS = -module \
+@BUILD_MODULE_IPTABLES_TRUE@	-avoid-version $(am__append_83)
+@BUILD_MODULE_IRQ_TRUE@irq_la_SOURCES = irq.c
+@BUILD_MODULE_IRQ_TRUE@irq_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_LOAD_TRUE@load_la_SOURCES = load.c
 @BUILD_MODULE_LOAD_TRUE@load_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_LOAD_TRUE@	$(am__append_63) $(am__append_64) \
-@BUILD_MODULE_LOAD_TRUE@	$(am__append_65)
+@BUILD_MODULE_LOAD_TRUE@	$(am__append_92) $(am__append_93) \
+@BUILD_MODULE_LOAD_TRUE@	$(am__append_94)
+@BUILD_MODULE_LOGFILE_TRUE@logfile_la_SOURCES = logfile.c
+@BUILD_MODULE_LOGFILE_TRUE@logfile_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_MBMON_TRUE@mbmon_la_SOURCES = mbmon.c
 @BUILD_MODULE_MBMON_TRUE@mbmon_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_MBMON_TRUE@	$(am__append_67)
+@BUILD_MODULE_MBMON_TRUE@	$(am__append_99)
 @BUILD_MODULE_MEMORY_TRUE@memory_la_SOURCES = memory.c
 @BUILD_MODULE_MEMORY_TRUE@memory_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_MEMORY_TRUE@	$(am__append_73) $(am__append_74) \
-@BUILD_MODULE_MEMORY_TRUE@	$(am__append_75) $(am__append_76) \
-@BUILD_MODULE_MEMORY_TRUE@	$(am__append_77)
+@BUILD_MODULE_MEMORY_TRUE@	$(am__append_105) $(am__append_106) \
+@BUILD_MODULE_MEMORY_TRUE@	$(am__append_107) $(am__append_108) \
+@BUILD_MODULE_MEMORY_TRUE@	$(am__append_109)
 @BUILD_MODULE_MULTIMETER_TRUE@multimeter_la_SOURCES = multimeter.c
 @BUILD_MODULE_MULTIMETER_TRUE@multimeter_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_MYSQL_TRUE@mysql_la_SOURCES = mysql.c
 @BUILD_MODULE_MYSQL_TRUE@mysql_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_MYSQL_TRUE@	$(am__append_82)
+@BUILD_MODULE_MYSQL_TRUE@	$(am__append_114)
+@BUILD_MODULE_NETWORK_TRUE@network_la_SOURCES = network.c network.h
+@BUILD_MODULE_NETWORK_TRUE@network_la_LDFLAGS = -module -avoid-version \
+@BUILD_MODULE_NETWORK_TRUE@	$(am__append_118) $(am__append_119)
 @BUILD_MODULE_NFS_TRUE@nfs_la_SOURCES = nfs.c
 @BUILD_MODULE_NFS_TRUE@nfs_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_NTPD_TRUE@ntpd_la_SOURCES = ntpd.c
 @BUILD_MODULE_NTPD_TRUE@ntpd_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_NTPD_TRUE@	$(am__append_89)
+@BUILD_MODULE_NTPD_TRUE@	$(am__append_126)
+@BUILD_MODULE_NUT_TRUE@nut_la_SOURCES = nut.c
+@BUILD_MODULE_NUT_TRUE@nut_la_LDFLAGS = -module -avoid-version \
+@BUILD_MODULE_NUT_TRUE@	$(am__append_130) $(am__append_131)
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@perl_la_SOURCES = perl.c
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@perl_la_CFLAGS = $(AM_CFLAGS) \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@		  $(PERL_CFLAGS) \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@		  -DXS_VERSION=\"$(VERSION)\" -DVERSION=\"$(VERSION)\"
+
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@perl_la_LDFLAGS = -module -avoid-version \
+@BUILD_MODULE_PERL_TRUE@@BUILD_WITH_LIBPERL_TRUE@		  $(PERL_LDFLAGS)
+
 @BUILD_MODULE_PING_TRUE@ping_la_SOURCES = ping.c
 @BUILD_MODULE_PING_TRUE@ping_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_PING_TRUE@	$(am__append_93)
+@BUILD_MODULE_PING_TRUE@	$(am__append_138)
 @BUILD_MODULE_PING_TRUE@@BUILD_WITH_LIBOPING_TRUE@@BUILD_WITH_OWN_LIBOPING_TRUE@ping_la_LIBADD = liboping/liboping.la
 @BUILD_MODULE_PING_TRUE@@BUILD_WITH_LIBOPING_TRUE@@BUILD_WITH_OWN_LIBOPING_TRUE@ping_la_DEPENDENCIES = liboping/liboping.la
 @BUILD_MODULE_PROCESSES_TRUE@processes_la_SOURCES = processes.c
 @BUILD_MODULE_PROCESSES_TRUE@processes_la_LDFLAGS = -module -avoid-version
+@BUILD_WITH_RRDTOOL_TRUE@rrdtool_la_SOURCES = rrdtool.c
+@BUILD_WITH_RRDTOOL_TRUE@rrdtool_la_LDFLAGS = -module -avoid-version -lrrd
 @BUILD_MODULE_SENSORS_TRUE@sensors_la_SOURCES = sensors.c
 @BUILD_MODULE_SENSORS_TRUE@sensors_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_SENSORS_TRUE@	$(am__append_100)
+@BUILD_MODULE_SENSORS_TRUE@	$(am__append_148)
 @BUILD_MODULE_SERIAL_TRUE@serial_la_SOURCES = serial.c
 @BUILD_MODULE_SERIAL_TRUE@serial_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_SWAP_TRUE@swap_la_SOURCES = swap.c
 @BUILD_MODULE_SWAP_TRUE@swap_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_SWAP_TRUE@	$(am__append_109) $(am__append_110) \
-@BUILD_MODULE_SWAP_TRUE@	$(am__append_111) $(am__append_112) \
-@BUILD_MODULE_SWAP_TRUE@	$(am__append_113)
+@BUILD_MODULE_SWAP_TRUE@	$(am__append_157) $(am__append_158) \
+@BUILD_MODULE_SWAP_TRUE@	$(am__append_159) $(am__append_160) \
+@BUILD_MODULE_SWAP_TRUE@	$(am__append_161)
+@BUILD_MODULE_SYSLOG_TRUE@syslog_la_SOURCES = syslog.c
+@BUILD_MODULE_SYSLOG_TRUE@syslog_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_TAPE_TRUE@tape_la_SOURCES = tape.c
 @BUILD_MODULE_TAPE_TRUE@tape_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_TAPE_TRUE@	$(am__append_115) $(am__append_116)
-@BUILD_MODULE_TRAFFIC_TRUE@traffic_la_SOURCES = traffic.c
-@BUILD_MODULE_TRAFFIC_TRUE@traffic_la_LDFLAGS = -module -avoid-version \
-@BUILD_MODULE_TRAFFIC_TRUE@	$(am__append_122) $(am__append_123) \
-@BUILD_MODULE_TRAFFIC_TRUE@	$(am__append_124) $(am__append_125) \
-@BUILD_MODULE_TRAFFIC_TRUE@	$(am__append_126)
+@BUILD_MODULE_TAPE_TRUE@	$(am__append_166) $(am__append_167)
+@BUILD_MODULE_UNIXSOCK_TRUE@unixsock_la_SOURCES = unixsock.c
+@BUILD_MODULE_UNIXSOCK_TRUE@unixsock_la_CPPFLAGS = -DPREFIX='"${prefix}"'
+@BUILD_MODULE_UNIXSOCK_TRUE@unixsock_la_LDFLAGS = -module -avoid-version -lpthread
 @BUILD_MODULE_USERS_TRUE@users_la_SOURCES = users.c
 @BUILD_MODULE_USERS_TRUE@users_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_VSERVER_TRUE@vserver_la_SOURCES = vserver.c
 @BUILD_MODULE_VSERVER_TRUE@vserver_la_LDFLAGS = -module -avoid-version
 @BUILD_MODULE_WIRELESS_TRUE@wireless_la_SOURCES = wireless.c
 @BUILD_MODULE_WIRELESS_TRUE@wireless_la_LDFLAGS = -module -avoid-version
-dist_man_MANS = collectd.1 collectd.conf.5
+dist_man_MANS = collectd.1 collectd-nagios.1 collectd.conf.5 \
+		collectd-email.5 collectd-exec.5 collectd-perl.5 \
+		collectd-unixsock.5
+
+
+#collectd_1_SOURCES = collectd.pod
+EXTRA_DIST = types.db
 all: config.h
 	$(MAKE) $(AM_MAKEFLAGS) all-recursive
 
 .SUFFIXES:
 .SUFFIXES: .1 .5 .c .lo .o .obj .pod
 $(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)
@@ -880,56 +1106,108 @@
 battery.la: $(battery_la_OBJECTS) $(battery_la_DEPENDENCIES) 
 	$(LINK) $(am_battery_la_rpath) $(battery_la_LDFLAGS) $(battery_la_OBJECTS) $(battery_la_LIBADD) $(LIBS)
 cpu.la: $(cpu_la_OBJECTS) $(cpu_la_DEPENDENCIES) 
 	$(LINK) $(am_cpu_la_rpath) $(cpu_la_LDFLAGS) $(cpu_la_OBJECTS) $(cpu_la_LIBADD) $(LIBS)
 cpufreq.la: $(cpufreq_la_OBJECTS) $(cpufreq_la_DEPENDENCIES) 
 	$(LINK) $(am_cpufreq_la_rpath) $(cpufreq_la_LDFLAGS) $(cpufreq_la_OBJECTS) $(cpufreq_la_LIBADD) $(LIBS)
+csv.la: $(csv_la_OBJECTS) $(csv_la_DEPENDENCIES) 
+	$(LINK) $(am_csv_la_rpath) $(csv_la_LDFLAGS) $(csv_la_OBJECTS) $(csv_la_LIBADD) $(LIBS)
 df.la: $(df_la_OBJECTS) $(df_la_DEPENDENCIES) 
 	$(LINK) $(am_df_la_rpath) $(df_la_LDFLAGS) $(df_la_OBJECTS) $(df_la_LIBADD) $(LIBS)
 disk.la: $(disk_la_OBJECTS) $(disk_la_DEPENDENCIES) 
 	$(LINK) $(am_disk_la_rpath) $(disk_la_LDFLAGS) $(disk_la_OBJECTS) $(disk_la_LIBADD) $(LIBS)
 dns.la: $(dns_la_OBJECTS) $(dns_la_DEPENDENCIES) 
 	$(LINK) $(am_dns_la_rpath) $(dns_la_LDFLAGS) $(dns_la_OBJECTS) $(dns_la_LIBADD) $(LIBS)
 email.la: $(email_la_OBJECTS) $(email_la_DEPENDENCIES) 
 	$(LINK) $(am_email_la_rpath) $(email_la_LDFLAGS) $(email_la_OBJECTS) $(email_la_LIBADD) $(LIBS)
+entropy.la: $(entropy_la_OBJECTS) $(entropy_la_DEPENDENCIES) 
+	$(LINK) $(am_entropy_la_rpath) $(entropy_la_LDFLAGS) $(entropy_la_OBJECTS) $(entropy_la_LIBADD) $(LIBS)
+exec.la: $(exec_la_OBJECTS) $(exec_la_DEPENDENCIES) 
+	$(LINK) $(am_exec_la_rpath) $(exec_la_LDFLAGS) $(exec_la_OBJECTS) $(exec_la_LIBADD) $(LIBS)
 hddtemp.la: $(hddtemp_la_OBJECTS) $(hddtemp_la_DEPENDENCIES) 
 	$(LINK) $(am_hddtemp_la_rpath) $(hddtemp_la_LDFLAGS) $(hddtemp_la_OBJECTS) $(hddtemp_la_LIBADD) $(LIBS)
+interface.la: $(interface_la_OBJECTS) $(interface_la_DEPENDENCIES) 
+	$(LINK) $(am_interface_la_rpath) $(interface_la_LDFLAGS) $(interface_la_OBJECTS) $(interface_la_LIBADD) $(LIBS)
+iptables.la: $(iptables_la_OBJECTS) $(iptables_la_DEPENDENCIES) 
+	$(LINK) $(am_iptables_la_rpath) $(iptables_la_LDFLAGS) $(iptables_la_OBJECTS) $(iptables_la_LIBADD) $(LIBS)
+irq.la: $(irq_la_OBJECTS) $(irq_la_DEPENDENCIES) 
+	$(LINK) $(am_irq_la_rpath) $(irq_la_LDFLAGS) $(irq_la_OBJECTS) $(irq_la_LIBADD) $(LIBS)
 load.la: $(load_la_OBJECTS) $(load_la_DEPENDENCIES) 
 	$(LINK) $(am_load_la_rpath) $(load_la_LDFLAGS) $(load_la_OBJECTS) $(load_la_LIBADD) $(LIBS)
+logfile.la: $(logfile_la_OBJECTS) $(logfile_la_DEPENDENCIES) 
+	$(LINK) $(am_logfile_la_rpath) $(logfile_la_LDFLAGS) $(logfile_la_OBJECTS) $(logfile_la_LIBADD) $(LIBS)
 mbmon.la: $(mbmon_la_OBJECTS) $(mbmon_la_DEPENDENCIES) 
 	$(LINK) $(am_mbmon_la_rpath) $(mbmon_la_LDFLAGS) $(mbmon_la_OBJECTS) $(mbmon_la_LIBADD) $(LIBS)
 memory.la: $(memory_la_OBJECTS) $(memory_la_DEPENDENCIES) 
 	$(LINK) $(am_memory_la_rpath) $(memory_la_LDFLAGS) $(memory_la_OBJECTS) $(memory_la_LIBADD) $(LIBS)
 multimeter.la: $(multimeter_la_OBJECTS) $(multimeter_la_DEPENDENCIES) 
 	$(LINK) $(am_multimeter_la_rpath) $(multimeter_la_LDFLAGS) $(multimeter_la_OBJECTS) $(multimeter_la_LIBADD) $(LIBS)
 mysql.la: $(mysql_la_OBJECTS) $(mysql_la_DEPENDENCIES) 
 	$(LINK) $(am_mysql_la_rpath) $(mysql_la_LDFLAGS) $(mysql_la_OBJECTS) $(mysql_la_LIBADD) $(LIBS)
+network.la: $(network_la_OBJECTS) $(network_la_DEPENDENCIES) 
+	$(LINK) $(am_network_la_rpath) $(network_la_LDFLAGS) $(network_la_OBJECTS) $(network_la_LIBADD) $(LIBS)
 nfs.la: $(nfs_la_OBJECTS) $(nfs_la_DEPENDENCIES) 
 	$(LINK) $(am_nfs_la_rpath) $(nfs_la_LDFLAGS) $(nfs_la_OBJECTS) $(nfs_la_LIBADD) $(LIBS)
 ntpd.la: $(ntpd_la_OBJECTS) $(ntpd_la_DEPENDENCIES) 
 	$(LINK) $(am_ntpd_la_rpath) $(ntpd_la_LDFLAGS) $(ntpd_la_OBJECTS) $(ntpd_la_LIBADD) $(LIBS)
+nut.la: $(nut_la_OBJECTS) $(nut_la_DEPENDENCIES) 
+	$(LINK) $(am_nut_la_rpath) $(nut_la_LDFLAGS) $(nut_la_OBJECTS) $(nut_la_LIBADD) $(LIBS)
+perl.la: $(perl_la_OBJECTS) $(perl_la_DEPENDENCIES) 
+	$(LINK) $(am_perl_la_rpath) $(perl_la_LDFLAGS) $(perl_la_OBJECTS) $(perl_la_LIBADD) $(LIBS)
 ping.la: $(ping_la_OBJECTS) $(ping_la_DEPENDENCIES) 
 	$(LINK) $(am_ping_la_rpath) $(ping_la_LDFLAGS) $(ping_la_OBJECTS) $(ping_la_LIBADD) $(LIBS)
 processes.la: $(processes_la_OBJECTS) $(processes_la_DEPENDENCIES) 
 	$(LINK) $(am_processes_la_rpath) $(processes_la_LDFLAGS) $(processes_la_OBJECTS) $(processes_la_LIBADD) $(LIBS)
+rrdtool.la: $(rrdtool_la_OBJECTS) $(rrdtool_la_DEPENDENCIES) 
+	$(LINK) $(am_rrdtool_la_rpath) $(rrdtool_la_LDFLAGS) $(rrdtool_la_OBJECTS) $(rrdtool_la_LIBADD) $(LIBS)
 sensors.la: $(sensors_la_OBJECTS) $(sensors_la_DEPENDENCIES) 
 	$(LINK) $(am_sensors_la_rpath) $(sensors_la_LDFLAGS) $(sensors_la_OBJECTS) $(sensors_la_LIBADD) $(LIBS)
 serial.la: $(serial_la_OBJECTS) $(serial_la_DEPENDENCIES) 
 	$(LINK) $(am_serial_la_rpath) $(serial_la_LDFLAGS) $(serial_la_OBJECTS) $(serial_la_LIBADD) $(LIBS)
 swap.la: $(swap_la_OBJECTS) $(swap_la_DEPENDENCIES) 
 	$(LINK) $(am_swap_la_rpath) $(swap_la_LDFLAGS) $(swap_la_OBJECTS) $(swap_la_LIBADD) $(LIBS)
+syslog.la: $(syslog_la_OBJECTS) $(syslog_la_DEPENDENCIES) 
+	$(LINK) $(am_syslog_la_rpath) $(syslog_la_LDFLAGS) $(syslog_la_OBJECTS) $(syslog_la_LIBADD) $(LIBS)
 tape.la: $(tape_la_OBJECTS) $(tape_la_DEPENDENCIES) 
 	$(LINK) $(am_tape_la_rpath) $(tape_la_LDFLAGS) $(tape_la_OBJECTS) $(tape_la_LIBADD) $(LIBS)
-traffic.la: $(traffic_la_OBJECTS) $(traffic_la_DEPENDENCIES) 
-	$(LINK) $(am_traffic_la_rpath) $(traffic_la_LDFLAGS) $(traffic_la_OBJECTS) $(traffic_la_LIBADD) $(LIBS)
+unixsock.la: $(unixsock_la_OBJECTS) $(unixsock_la_DEPENDENCIES) 
+	$(LINK) $(am_unixsock_la_rpath) $(unixsock_la_LDFLAGS) $(unixsock_la_OBJECTS) $(unixsock_la_LIBADD) $(LIBS)
 users.la: $(users_la_OBJECTS) $(users_la_DEPENDENCIES) 
 	$(LINK) $(am_users_la_rpath) $(users_la_LDFLAGS) $(users_la_OBJECTS) $(users_la_LIBADD) $(LIBS)
 vserver.la: $(vserver_la_OBJECTS) $(vserver_la_DEPENDENCIES) 
 	$(LINK) $(am_vserver_la_rpath) $(vserver_la_LDFLAGS) $(vserver_la_OBJECTS) $(vserver_la_LIBADD) $(LIBS)
 wireless.la: $(wireless_la_OBJECTS) $(wireless_la_DEPENDENCIES) 
 	$(LINK) $(am_wireless_la_rpath) $(wireless_la_LDFLAGS) $(wireless_la_OBJECTS) $(wireless_la_LIBADD) $(LIBS)
+install-binPROGRAMS: $(bin_PROGRAMS)
+	@$(NORMAL_INSTALL)
+	test -z "$(bindir)" || $(mkdir_p) "$(DESTDIR)$(bindir)"
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  p1=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  if test -f $$p \
+	     || test -f $$p1 \
+	  ; then \
+	    f=`echo "$$p1" | sed 's,^.*/,,;$(transform);s/$$/$(EXEEXT)/'`; \
+	   echo " $(INSTALL_PROGRAM_ENV) $(LIBTOOL) --mode=install $(binPROGRAMS_INSTALL) '$$p' '$(DESTDIR)$(bindir)/$$f'"; \
+	   $(INSTALL_PROGRAM_ENV) $(LIBTOOL) --mode=install $(binPROGRAMS_INSTALL) "$$p" "$(DESTDIR)$(bindir)/$$f" || exit 1; \
+	  else :; fi; \
+	done
+
+uninstall-binPROGRAMS:
+	@$(NORMAL_UNINSTALL)
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  f=`echo "$$p" | sed 's,^.*/,,;s/$(EXEEXT)$$//;$(transform);s/$$/$(EXEEXT)/'`; \
+	  echo " rm -f '$(DESTDIR)$(bindir)/$$f'"; \
+	  rm -f "$(DESTDIR)$(bindir)/$$f"; \
+	done
+
+clean-binPROGRAMS:
+	@list='$(bin_PROGRAMS)'; for p in $$list; do \
+	  f=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
+	  echo " rm -f $$p $$f"; \
+	  rm -f $$p $$f ; \
+	done
 install-sbinPROGRAMS: $(sbin_PROGRAMS)
 	@$(NORMAL_INSTALL)
 	test -z "$(sbindir)" || $(mkdir_p) "$(DESTDIR)$(sbindir)"
 	@list='$(sbin_PROGRAMS)'; for p in $$list; do \
 	  p1=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
 	  if test -f $$p \
@@ -955,12 +1233,15 @@
 	  echo " rm -f $$p $$f"; \
 	  rm -f $$p $$f ; \
 	done
 collectd$(EXEEXT): $(collectd_OBJECTS) $(collectd_DEPENDENCIES) 
 	@rm -f collectd$(EXEEXT)
 	$(LINK) $(collectd_LDFLAGS) $(collectd_OBJECTS) $(collectd_LDADD) $(LIBS)
+collectd-nagios$(EXEEXT): $(collectd_nagios_OBJECTS) $(collectd_nagios_DEPENDENCIES) 
+	@rm -f collectd-nagios$(EXEEXT)
+	$(LINK) $(collectd_nagios_LDFLAGS) $(collectd_nagios_OBJECTS) $(collectd_nagios_LDADD) $(LIBS)
 
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
 
 distclean-compile:
 	-rm -f *.tab.c
@@ -969,38 +1250,52 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/apcups.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/apple_sensors.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/battery.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-collectd.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-common.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-configfile.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-network.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-nagios.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-plugin.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-utils_debug.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-types_list.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-utils_avltree.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-utils_ignorelist.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-utils_llist.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/collectd-utils_mount.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/cpu.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/cpufreq.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/csv.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/df.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/disk.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/dns.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/email.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/entropy.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/exec.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/hddtemp.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/interface.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/iptables.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/irq.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/load.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/logfile.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mbmon.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/memory.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/multimeter.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/mysql.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/network.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/nfs.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ntpd.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/nut.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/perl_la-perl.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ping.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/processes.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rrdtool.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/sensors.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/serial.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/swap.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/syslog.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/tape.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/traffic.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/unixsock_la-unixsock.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/users.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/utils_dns.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/vserver.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/wireless.Plo@am__quote@
 
 .c.o:
@@ -1021,12 +1316,26 @@
 @am__fastdepCC_TRUE@	if $(LTCOMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/$*.Tpo" "$(DEPDIR)/$*.Plo"; else rm -f "$(DEPDIR)/$*.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(LTCOMPILE) -c -o $@ $<
 
+perl_la-perl.lo: perl.c
+@am__fastdepCC_TRUE@	if $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(perl_la_CFLAGS) $(CFLAGS) -MT perl_la-perl.lo -MD -MP -MF "$(DEPDIR)/perl_la-perl.Tpo" -c -o perl_la-perl.lo `test -f 'perl.c' || echo '$(srcdir)/'`perl.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/perl_la-perl.Tpo" "$(DEPDIR)/perl_la-perl.Plo"; else rm -f "$(DEPDIR)/perl_la-perl.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='perl.c' object='perl_la-perl.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(perl_la_CFLAGS) $(CFLAGS) -c -o perl_la-perl.lo `test -f 'perl.c' || echo '$(srcdir)/'`perl.c
+
+unixsock_la-unixsock.lo: unixsock.c
+@am__fastdepCC_TRUE@	if $(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(unixsock_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT unixsock_la-unixsock.lo -MD -MP -MF "$(DEPDIR)/unixsock_la-unixsock.Tpo" -c -o unixsock_la-unixsock.lo `test -f 'unixsock.c' || echo '$(srcdir)/'`unixsock.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/unixsock_la-unixsock.Tpo" "$(DEPDIR)/unixsock_la-unixsock.Plo"; else rm -f "$(DEPDIR)/unixsock_la-unixsock.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='unixsock.c' object='unixsock_la-unixsock.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(LIBTOOL) --tag=CC --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(unixsock_la_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o unixsock_la-unixsock.lo `test -f 'unixsock.c' || echo '$(srcdir)/'`unixsock.c
+
 collectd-collectd.o: collectd.c
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-collectd.o -MD -MP -MF "$(DEPDIR)/collectd-collectd.Tpo" -c -o collectd-collectd.o `test -f 'collectd.c' || echo '$(srcdir)/'`collectd.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-collectd.Tpo" "$(DEPDIR)/collectd-collectd.Po"; else rm -f "$(DEPDIR)/collectd-collectd.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='collectd.c' object='collectd-collectd.o' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-collectd.o `test -f 'collectd.c' || echo '$(srcdir)/'`collectd.c
@@ -1035,25 +1344,25 @@
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-collectd.obj -MD -MP -MF "$(DEPDIR)/collectd-collectd.Tpo" -c -o collectd-collectd.obj `if test -f 'collectd.c'; then $(CYGPATH_W) 'collectd.c'; else $(CYGPATH_W) '$(srcdir)/collectd.c'; fi`; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-collectd.Tpo" "$(DEPDIR)/collectd-collectd.Po"; else rm -f "$(DEPDIR)/collectd-collectd.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='collectd.c' object='collectd-collectd.obj' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-collectd.obj `if test -f 'collectd.c'; then $(CYGPATH_W) 'collectd.c'; else $(CYGPATH_W) '$(srcdir)/collectd.c'; fi`
 
-collectd-utils_debug.o: utils_debug.c
-@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_debug.o -MD -MP -MF "$(DEPDIR)/collectd-utils_debug.Tpo" -c -o collectd-utils_debug.o `test -f 'utils_debug.c' || echo '$(srcdir)/'`utils_debug.c; \
-@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_debug.Tpo" "$(DEPDIR)/collectd-utils_debug.Po"; else rm -f "$(DEPDIR)/collectd-utils_debug.Tpo"; exit 1; fi
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_debug.c' object='collectd-utils_debug.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_debug.o `test -f 'utils_debug.c' || echo '$(srcdir)/'`utils_debug.c
-
-collectd-utils_debug.obj: utils_debug.c
-@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_debug.obj -MD -MP -MF "$(DEPDIR)/collectd-utils_debug.Tpo" -c -o collectd-utils_debug.obj `if test -f 'utils_debug.c'; then $(CYGPATH_W) 'utils_debug.c'; else $(CYGPATH_W) '$(srcdir)/utils_debug.c'; fi`; \
-@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_debug.Tpo" "$(DEPDIR)/collectd-utils_debug.Po"; else rm -f "$(DEPDIR)/collectd-utils_debug.Tpo"; exit 1; fi
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_debug.c' object='collectd-utils_debug.obj' libtool=no @AMDEPBACKSLASH@
+collectd-utils_avltree.o: utils_avltree.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_avltree.o -MD -MP -MF "$(DEPDIR)/collectd-utils_avltree.Tpo" -c -o collectd-utils_avltree.o `test -f 'utils_avltree.c' || echo '$(srcdir)/'`utils_avltree.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_avltree.Tpo" "$(DEPDIR)/collectd-utils_avltree.Po"; else rm -f "$(DEPDIR)/collectd-utils_avltree.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_avltree.c' object='collectd-utils_avltree.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_avltree.o `test -f 'utils_avltree.c' || echo '$(srcdir)/'`utils_avltree.c
+
+collectd-utils_avltree.obj: utils_avltree.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_avltree.obj -MD -MP -MF "$(DEPDIR)/collectd-utils_avltree.Tpo" -c -o collectd-utils_avltree.obj `if test -f 'utils_avltree.c'; then $(CYGPATH_W) 'utils_avltree.c'; else $(CYGPATH_W) '$(srcdir)/utils_avltree.c'; fi`; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_avltree.Tpo" "$(DEPDIR)/collectd-utils_avltree.Po"; else rm -f "$(DEPDIR)/collectd-utils_avltree.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_avltree.c' object='collectd-utils_avltree.obj' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_debug.obj `if test -f 'utils_debug.c'; then $(CYGPATH_W) 'utils_debug.c'; else $(CYGPATH_W) '$(srcdir)/utils_debug.c'; fi`
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_avltree.obj `if test -f 'utils_avltree.c'; then $(CYGPATH_W) 'utils_avltree.c'; else $(CYGPATH_W) '$(srcdir)/utils_avltree.c'; fi`
 
 collectd-utils_mount.o: utils_mount.c
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_mount.o -MD -MP -MF "$(DEPDIR)/collectd-utils_mount.Tpo" -c -o collectd-utils_mount.o `test -f 'utils_mount.c' || echo '$(srcdir)/'`utils_mount.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_mount.Tpo" "$(DEPDIR)/collectd-utils_mount.Po"; else rm -f "$(DEPDIR)/collectd-utils_mount.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_mount.c' object='collectd-utils_mount.o' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
@@ -1063,12 +1372,26 @@
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_mount.obj -MD -MP -MF "$(DEPDIR)/collectd-utils_mount.Tpo" -c -o collectd-utils_mount.obj `if test -f 'utils_mount.c'; then $(CYGPATH_W) 'utils_mount.c'; else $(CYGPATH_W) '$(srcdir)/utils_mount.c'; fi`; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_mount.Tpo" "$(DEPDIR)/collectd-utils_mount.Po"; else rm -f "$(DEPDIR)/collectd-utils_mount.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_mount.c' object='collectd-utils_mount.obj' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_mount.obj `if test -f 'utils_mount.c'; then $(CYGPATH_W) 'utils_mount.c'; else $(CYGPATH_W) '$(srcdir)/utils_mount.c'; fi`
 
+collectd-utils_llist.o: utils_llist.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_llist.o -MD -MP -MF "$(DEPDIR)/collectd-utils_llist.Tpo" -c -o collectd-utils_llist.o `test -f 'utils_llist.c' || echo '$(srcdir)/'`utils_llist.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_llist.Tpo" "$(DEPDIR)/collectd-utils_llist.Po"; else rm -f "$(DEPDIR)/collectd-utils_llist.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_llist.c' object='collectd-utils_llist.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_llist.o `test -f 'utils_llist.c' || echo '$(srcdir)/'`utils_llist.c
+
+collectd-utils_llist.obj: utils_llist.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_llist.obj -MD -MP -MF "$(DEPDIR)/collectd-utils_llist.Tpo" -c -o collectd-utils_llist.obj `if test -f 'utils_llist.c'; then $(CYGPATH_W) 'utils_llist.c'; else $(CYGPATH_W) '$(srcdir)/utils_llist.c'; fi`; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_llist.Tpo" "$(DEPDIR)/collectd-utils_llist.Po"; else rm -f "$(DEPDIR)/collectd-utils_llist.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_llist.c' object='collectd-utils_llist.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_llist.obj `if test -f 'utils_llist.c'; then $(CYGPATH_W) 'utils_llist.c'; else $(CYGPATH_W) '$(srcdir)/utils_llist.c'; fi`
+
 collectd-utils_ignorelist.o: utils_ignorelist.c
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-utils_ignorelist.o -MD -MP -MF "$(DEPDIR)/collectd-utils_ignorelist.Tpo" -c -o collectd-utils_ignorelist.o `test -f 'utils_ignorelist.c' || echo '$(srcdir)/'`utils_ignorelist.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-utils_ignorelist.Tpo" "$(DEPDIR)/collectd-utils_ignorelist.Po"; else rm -f "$(DEPDIR)/collectd-utils_ignorelist.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='utils_ignorelist.c' object='collectd-utils_ignorelist.o' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-utils_ignorelist.o `test -f 'utils_ignorelist.c' || echo '$(srcdir)/'`utils_ignorelist.c
@@ -1091,26 +1414,12 @@
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-common.obj -MD -MP -MF "$(DEPDIR)/collectd-common.Tpo" -c -o collectd-common.obj `if test -f 'common.c'; then $(CYGPATH_W) 'common.c'; else $(CYGPATH_W) '$(srcdir)/common.c'; fi`; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-common.Tpo" "$(DEPDIR)/collectd-common.Po"; else rm -f "$(DEPDIR)/collectd-common.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='common.c' object='collectd-common.obj' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-common.obj `if test -f 'common.c'; then $(CYGPATH_W) 'common.c'; else $(CYGPATH_W) '$(srcdir)/common.c'; fi`
 
-collectd-network.o: network.c
-@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-network.o -MD -MP -MF "$(DEPDIR)/collectd-network.Tpo" -c -o collectd-network.o `test -f 'network.c' || echo '$(srcdir)/'`network.c; \
-@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-network.Tpo" "$(DEPDIR)/collectd-network.Po"; else rm -f "$(DEPDIR)/collectd-network.Tpo"; exit 1; fi
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='network.c' object='collectd-network.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-network.o `test -f 'network.c' || echo '$(srcdir)/'`network.c
-
-collectd-network.obj: network.c
-@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-network.obj -MD -MP -MF "$(DEPDIR)/collectd-network.Tpo" -c -o collectd-network.obj `if test -f 'network.c'; then $(CYGPATH_W) 'network.c'; else $(CYGPATH_W) '$(srcdir)/network.c'; fi`; \
-@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-network.Tpo" "$(DEPDIR)/collectd-network.Po"; else rm -f "$(DEPDIR)/collectd-network.Tpo"; exit 1; fi
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='network.c' object='collectd-network.obj' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-network.obj `if test -f 'network.c'; then $(CYGPATH_W) 'network.c'; else $(CYGPATH_W) '$(srcdir)/network.c'; fi`
-
 collectd-plugin.o: plugin.c
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-plugin.o -MD -MP -MF "$(DEPDIR)/collectd-plugin.Tpo" -c -o collectd-plugin.o `test -f 'plugin.c' || echo '$(srcdir)/'`plugin.c; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-plugin.Tpo" "$(DEPDIR)/collectd-plugin.Po"; else rm -f "$(DEPDIR)/collectd-plugin.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='plugin.c' object='collectd-plugin.o' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-plugin.o `test -f 'plugin.c' || echo '$(srcdir)/'`plugin.c
@@ -1133,12 +1442,26 @@
 @am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-configfile.obj -MD -MP -MF "$(DEPDIR)/collectd-configfile.Tpo" -c -o collectd-configfile.obj `if test -f 'configfile.c'; then $(CYGPATH_W) 'configfile.c'; else $(CYGPATH_W) '$(srcdir)/configfile.c'; fi`; \
 @am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-configfile.Tpo" "$(DEPDIR)/collectd-configfile.Po"; else rm -f "$(DEPDIR)/collectd-configfile.Tpo"; exit 1; fi
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	source='configfile.c' object='collectd-configfile.obj' libtool=no @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-configfile.obj `if test -f 'configfile.c'; then $(CYGPATH_W) 'configfile.c'; else $(CYGPATH_W) '$(srcdir)/configfile.c'; fi`
 
+collectd-types_list.o: types_list.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-types_list.o -MD -MP -MF "$(DEPDIR)/collectd-types_list.Tpo" -c -o collectd-types_list.o `test -f 'types_list.c' || echo '$(srcdir)/'`types_list.c; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-types_list.Tpo" "$(DEPDIR)/collectd-types_list.Po"; else rm -f "$(DEPDIR)/collectd-types_list.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='types_list.c' object='collectd-types_list.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-types_list.o `test -f 'types_list.c' || echo '$(srcdir)/'`types_list.c
+
+collectd-types_list.obj: types_list.c
+@am__fastdepCC_TRUE@	if $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -MT collectd-types_list.obj -MD -MP -MF "$(DEPDIR)/collectd-types_list.Tpo" -c -o collectd-types_list.obj `if test -f 'types_list.c'; then $(CYGPATH_W) 'types_list.c'; else $(CYGPATH_W) '$(srcdir)/types_list.c'; fi`; \
+@am__fastdepCC_TRUE@	then mv -f "$(DEPDIR)/collectd-types_list.Tpo" "$(DEPDIR)/collectd-types_list.Po"; else rm -f "$(DEPDIR)/collectd-types_list.Tpo"; exit 1; fi
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	source='types_list.c' object='collectd-types_list.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCC_FALSE@	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(collectd_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o collectd-types_list.obj `if test -f 'types_list.c'; then $(CYGPATH_W) 'types_list.c'; else $(CYGPATH_W) '$(srcdir)/types_list.c'; fi`
+
 mostlyclean-libtool:
 	-rm -f *.lo
 
 clean-libtool:
 	-rm -rf .libs _libs
 
@@ -1412,13 +1735,13 @@
 	done
 check-am: all-am
 check: check-recursive
 all-am: Makefile $(LTLIBRARIES) $(PROGRAMS) $(MANS) config.h
 installdirs: installdirs-recursive
 installdirs-am:
-	for dir in "$(DESTDIR)$(pkglibdir)" "$(DESTDIR)$(sbindir)" "$(DESTDIR)$(man1dir)" "$(DESTDIR)$(man5dir)"; do \
+	for dir in "$(DESTDIR)$(pkglibdir)" "$(DESTDIR)$(bindir)" "$(DESTDIR)$(sbindir)" "$(DESTDIR)$(man1dir)" "$(DESTDIR)$(man5dir)"; do \
 	  test -z "$$dir" || $(mkdir_p) "$$dir"; \
 	done
 install: install-recursive
 install-exec: install-exec-recursive
 install-data: install-data-recursive
 uninstall: uninstall-recursive
@@ -1441,14 +1764,14 @@
 
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"
 	@echo "it deletes files that may require special tools to rebuild."
 clean: clean-recursive
 
-clean-am: clean-generic clean-libtool clean-pkglibLTLIBRARIES \
-	clean-sbinPROGRAMS mostlyclean-am
+clean-am: clean-binPROGRAMS clean-generic clean-libtool \
+	clean-pkglibLTLIBRARIES clean-sbinPROGRAMS mostlyclean-am
 
 distclean: distclean-recursive
 	-rm -rf ./$(DEPDIR)
 	-rm -f Makefile
 distclean-am: clean-am distclean-compile distclean-generic \
 	distclean-hdr distclean-libtool distclean-tags
@@ -1462,13 +1785,14 @@
 info: info-recursive
 
 info-am:
 
 install-data-am: install-man
 
-install-exec-am: install-pkglibLTLIBRARIES install-sbinPROGRAMS
+install-exec-am: install-binPROGRAMS install-pkglibLTLIBRARIES \
+	install-sbinPROGRAMS
 	@$(NORMAL_INSTALL)
 	$(MAKE) $(AM_MAKEFLAGS) install-exec-hook
 
 install-info: install-info-recursive
 
 install-man: install-man1 install-man5
@@ -1490,40 +1814,39 @@
 pdf-am:
 
 ps: ps-recursive
 
 ps-am:
 
-uninstall-am: uninstall-info-am uninstall-man \
+uninstall-am: uninstall-binPROGRAMS uninstall-info-am uninstall-man \
 	uninstall-pkglibLTLIBRARIES uninstall-sbinPROGRAMS
 
 uninstall-info: uninstall-info-recursive
 
 uninstall-man: uninstall-man1 uninstall-man5
 
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am check check-am \
-	clean clean-generic clean-libtool clean-pkglibLTLIBRARIES \
-	clean-recursive clean-sbinPROGRAMS ctags ctags-recursive \
-	distclean distclean-compile distclean-generic distclean-hdr \
-	distclean-libtool distclean-recursive distclean-tags distdir \
-	dvi dvi-am html html-am info info-am install install-am \
+	clean clean-binPROGRAMS clean-generic clean-libtool \
+	clean-pkglibLTLIBRARIES clean-recursive clean-sbinPROGRAMS \
+	ctags ctags-recursive distclean distclean-compile \
+	distclean-generic distclean-hdr distclean-libtool \
+	distclean-recursive distclean-tags distdir dvi dvi-am html \
+	html-am info info-am install install-am install-binPROGRAMS \
 	install-data install-data-am install-exec install-exec-am \
 	install-exec-hook install-info install-info-am install-man \
 	install-man1 install-man5 install-pkglibLTLIBRARIES \
 	install-sbinPROGRAMS install-strip installcheck \
 	installcheck-am installdirs installdirs-am maintainer-clean \
 	maintainer-clean-generic maintainer-clean-recursive \
 	mostlyclean mostlyclean-compile mostlyclean-generic \
 	mostlyclean-libtool mostlyclean-recursive pdf pdf-am ps ps-am \
-	tags tags-recursive uninstall uninstall-am uninstall-info-am \
-	uninstall-man uninstall-man1 uninstall-man5 \
-	uninstall-pkglibLTLIBRARIES uninstall-sbinPROGRAMS
-
-#collectd_1_SOURCES = collectd.pod
+	tags tags-recursive uninstall uninstall-am \
+	uninstall-binPROGRAMS uninstall-info-am uninstall-man \
+	uninstall-man1 uninstall-man5 uninstall-pkglibLTLIBRARIES \
+	uninstall-sbinPROGRAMS
 
-#EXTRA_DIST = $(man_MANS)
 
 .pod.1:
 	pod2man --release=$(VERSION) --center=$(PACKAGE) $< >$@
 
 .pod.5:
 	pod2man --section=5 --release=$(VERSION) --center=$(PACKAGE) $< >$@
@@ -1532,10 +1855,11 @@
 	$(mkinstalldirs) $(DESTDIR)$(sysconfdir)
 	if test -e $(DESTDIR)$(sysconfdir)/collectd.conf; \
 	then \
 		$(INSTALL) -m 0640 collectd.conf $(DESTDIR)$(sysconfdir)/collectd.conf.pkg-orig; \
 	else \
 		$(INSTALL) -m 0640 collectd.conf $(DESTDIR)$(sysconfdir)/collectd.conf; \
-	fi
+	fi; \
+	cp -f types.db $(DESTDIR)$(pkglibdir)/;
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/mbmon.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/mbmon.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/mbmon.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/mbmon.c	2007-05-30 18:33:15.000000000 +0800
@@ -22,56 +22,35 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "utils_debug.h"
 
-#define MODULE_NAME "mbmon"
-
-#include <netdb.h>
-#include <sys/socket.h>
-#include <netinet/in.h>
-#include <netinet/tcp.h>
+#if HAVE_NETDB_H && HAVE_SYS_SOCKET_H && HAVE_NETINET_IN_H && HAVE_NETINET_TCP_H
+# include <netdb.h>
+# include <sys/socket.h>
+# include <netinet/in.h>
+# include <netinet/tcp.h>
+# define MBMON_HAVE_READ 1
+#else
+# define MBMON_HAVE_READ 0
+#endif
 
 #define MBMON_DEF_HOST "127.0.0.1"
 #define MBMON_DEF_PORT "411" /* the default for Debian */
 
-/* BUFFER_SIZE
-   Size of the buffer we use to receive from the mbmon daemon. */
-#define BUFFER_SIZE 1024
-
-static char *filename_temperature = "mbmon/temperature-%s.rrd";
-static char *filename_fanspeed = "mbmon/fanspeed-%s.rrd";
-static char *filename_voltage = "mbmon/voltage-%s.rrd";
-
-/* temperature and fan sensors */
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num = 1;
-
-/* voltage sensors */
-static char *voltage_ds_def[] = 
-{
-	"DS:voltage:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int voltage_ds_num = 1;
-
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Host",
 	"Port",
 	NULL
 };
 static int config_keys_num = 2;
 
+#if MBMON_HAVE_READ
 static char *mbmon_host = NULL;
 static char *mbmon_port = NULL;
 
 /*
  * NAME
  *  mbmon_query_daemon
@@ -127,34 +106,41 @@
 	port = mbmon_port;
 	if (port == NULL)
 		port = MBMON_DEF_PORT;
 
 	if ((ai_return = getaddrinfo (host, port, &ai_hints, &ai_list)) != 0)
 	{
-		syslog (LOG_ERR, "mbmon: getaddrinfo (%s, %s): %s",
+		char errbuf[1024];
+		ERROR ("mbmon: getaddrinfo (%s, %s): %s",
 				host, port,
-				ai_return == EAI_SYSTEM ? strerror (errno) : gai_strerror (ai_return));
+				(ai_return == EAI_SYSTEM)
+				? sstrerror (errno, errbuf, sizeof (errbuf))
+				: gai_strerror (ai_return));
 		return (-1);
 	}
 
 	fd = -1;
 	for (ai_ptr = ai_list; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next)
 	{
 		/* create our socket descriptor */
 		if ((fd = socket (ai_ptr->ai_family, ai_ptr->ai_socktype, ai_ptr->ai_protocol)) < 0)
 		{
-			syslog (LOG_ERR, "mbmon: socket: %s",
-					strerror (errno));
+			char errbuf[1024];
+			ERROR ("mbmon: socket: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			continue;
 		}
 
 		/* connect to the mbmon daemon */
 		if (connect (fd, (struct sockaddr *) ai_ptr->ai_addr, ai_ptr->ai_addrlen))
 		{
-			DBG ("mbmon: connect (%s, %s): %s", host, port,
-					strerror (errno));
+			char errbuf[1024];
+			DEBUG ("mbmon: connect (%s, %s): %s", host, port,
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			close (fd);
 			fd = -1;
 			continue;
 		}
 
 		/* A socket could be opened and connecting succeeded. We're
@@ -163,56 +149,59 @@
 	}
 
 	freeaddrinfo (ai_list);
 
 	if (fd < 0)
 	{
-		syslog (LOG_ERR, "mbmon: Could not connect to daemon.");
+		ERROR ("mbmon: Could not connect to daemon.");
 		return (-1);
 	}
 
 	/* receive data from the mbmon daemon */
 	memset (buffer, '\0', buffer_size);
 
 	buffer_fill = 0;
 	while ((status = read (fd, buffer + buffer_fill, buffer_size - buffer_fill)) != 0)
 	{
 		if (status == -1)
 		{
+			char errbuf[1024];
+
 			if ((errno == EAGAIN) || (errno == EINTR))
 				continue;
 
-			syslog (LOG_ERR, "mbmon: Error reading from socket: %s",
-						strerror (errno));
+			ERROR ("mbmon: Error reading from socket: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			close (fd);
 			return (-1);
 		}
 		buffer_fill += status;
 
 		if (buffer_fill >= buffer_size)
 			break;
 	}
 
 	if (buffer_fill >= buffer_size)
 	{
 		buffer[buffer_size - 1] = '\0';
-		syslog (LOG_WARNING, "mbmon: Message from mbmon has been truncated.");
+		WARNING ("mbmon: Message from mbmon has been truncated.");
 	}
 	else if (buffer_fill == 0)
 	{
-		syslog (LOG_WARNING, "mbmon: Peer has unexpectedly shut down the socket. "
+		WARNING ("mbmon: Peer has unexpectedly shut down the socket. "
 				"Buffer: `%s'", buffer);
 		close (fd);
 		return (-1);
 	}
 
 	close (fd);
 	return (0);
 }
 
-static int mbmon_config (char *key, char *value)
+static int mbmon_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "host") == 0)
 	{
 		if (mbmon_host != NULL)
 			free (mbmon_host);
 		mbmon_host = strdup (value);
@@ -228,110 +217,47 @@
 		return (-1);
 	}
 
 	return (0);
 }
 
-static void mbmon_init (void)
+static void mbmon_submit (const char *type, const char *type_instance,
+		double value)
 {
-	return;
-}
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void mbmon_write_temperature (char *host, char *inst, char *val)
-{
-	char filename[BUFFER_SIZE];
-	int status;
-
-	/* construct filename */
-	status = snprintf (filename, BUFFER_SIZE, filename_temperature, inst);
-	if ((status < 1) || (status >= BUFFER_SIZE))
-		return;
-
-	rrd_update_file (host, filename, val, ds_def, ds_num);
-}
+	values[0].gauge = value;
 
-static void mbmon_write_fanspeed (char *host, char *inst, char *val)
-{
-	char filename[BUFFER_SIZE];
-	int status;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "mbmon");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-	/* construct filename */
-	status = snprintf (filename, BUFFER_SIZE, filename_fanspeed, inst);
-	if ((status < 1) || (status >= BUFFER_SIZE))
-		return;
-
-	rrd_update_file (host, filename, val, ds_def, ds_num);
-}
-
-static void mbmon_write_voltage (char *host, char *inst, char *val)
-{
-	char filename[BUFFER_SIZE];
-	int status;
-
-	/* construct filename */
-	status = snprintf (filename, BUFFER_SIZE, filename_voltage, inst);
-	if ((status < 1) || (status >= BUFFER_SIZE))
-		return;
-
-	rrd_update_file (host, filename, val, voltage_ds_def, voltage_ds_num);
-}
-
-static void mbmon_submit (char *type, char *inst, double value)
-{
-	char buf[BUFFER_SIZE];
-
-	if (snprintf (buf, BUFFER_SIZE, "%u:%.3f", (unsigned int) curtime, value)
-            >= BUFFER_SIZE)
-		return;
-
-	plugin_submit (type, inst, buf);
-}
+	plugin_dispatch_values (type, &vl);
+} /* void mbmon_submit */
 
 /* Trim trailing whitespace from a string. */
 static void trim_spaces (char *s)
 {
 	size_t l;
 
 	for (l = strlen (s) - 1; (l > 0) && isspace (s[l]); l--)
 		s[l] = '\0';
 }
 
-static void mbmon_read (void)
+static int mbmon_read (void)
 {
-	char buf[BUFFER_SIZE];
+	char buf[1024];
 	char *s, *t;
 
-	static int wait_time = 1;
-	static int wait_left = 0;
-
-	if (wait_left >= 10)
-	{
-		wait_left -= 10;
-		return;
-	}
-
 	/* get data from daemon */
-	if (mbmon_query_daemon (buf, BUFFER_SIZE) < 0)
-	{
-		/* This limit is reached in log2(86400) =~ 17 steps. Since
-		 * there is a 2^n seconds wait between each step it will need
-		 * roughly one day to reach this limit. -octo */
-		
-		wait_time *= 2;
-		if (wait_time > 86400)
-			wait_time = 86400;
-
-		wait_left = wait_time;
-
-		return;
-	}
-	else
-	{
-		wait_time = 1;
-		wait_left = 0;
-	}
+	if (mbmon_query_daemon (buf, sizeof (buf)) < 0)
+		return (-1);
 
 	s = buf;
 	while ((t = strchr (s, ':')) != NULL)
 	{
 		double value;
 		char *nextc;
@@ -342,30 +268,30 @@
 		*t++ = '\0';
 		trim_spaces (s);
 
 		value = strtod (t, &nextc);
 		if ((*nextc != '\n') && (*nextc != '\0'))
 		{
-			syslog (LOG_ERR, "mbmon: value for `%s' contains invalid characters: `%s'", s, t);
+			ERROR ("mbmon: value for `%s' contains invalid characters: `%s'", s, t);
 			break;
 		}
 
 		if (strncmp (s, "TEMP", 4) == 0)
 		{
 			inst = s + 4;
-			type = "mbmon_temperature";
+			type = "temperature";
 		}
 		else if (strncmp (s, "FAN", 3) == 0)
 		{
 			inst = s + 3;
-			type = "mbmon_fanspeed";
+			type = "fanspeed";
 		}
 		else if (strncmp (s, "V", 1) == 0)
 		{
 			inst = s + 1;
-			type = "mbmon_voltage";
+			type = "voltage";
 		}
 		else
 		{
 			continue;
 		}
 
@@ -373,20 +299,20 @@
 
 		if (*nextc == '\0')
 			break;
 
 		s = nextc + 1;
 	}
+
+	return (0);
 } /* void mbmon_read */
+#endif /* MBMON_HAVE_READ */
 
 /* module_register
    Register collectd plugin. */
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, mbmon_init, mbmon_read, NULL);
-	plugin_register ("mbmon_temperature", NULL, NULL, mbmon_write_temperature);
-	plugin_register ("mbmon_fanspeed", NULL, NULL, mbmon_write_fanspeed);
-	plugin_register ("mbmon_voltage", NULL, NULL, mbmon_write_voltage);
-	cf_register (MODULE_NAME, mbmon_config, config_keys, config_keys_num);
-}
-
-#undef MODULE_NAME
+#if MBMON_HAVE_READ
+	plugin_register_config ("mbmon", mbmon_config, config_keys, config_keys_num);
+	plugin_register_read ("mbmon", mbmon_read);
+#endif /* MBMON_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/memory.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/memory.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/memory.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/memory.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/memory.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,13 +19,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
 
 #ifdef HAVE_SYS_SYSCTL_H
 # include <sys/sysctl.h>
 #endif
 
 #ifdef HAVE_MACH_KERN_RETURN_H
@@ -48,27 +46,12 @@
 #if defined (HOST_VM_INFO) || HAVE_SYSCTLBYNAME || KERNEL_LINUX || HAVE_LIBKSTAT
 # define MEMORY_HAVE_READ 1
 #else
 # define MEMORY_HAVE_READ 0
 #endif
 
-#define MODULE_NAME "memory"
-
-static char *memory_file = "memory.rrd";
-
-/* 9223372036854775807 == LLONG_MAX */
-static char *ds_def[] =
-{
-	"DS:used:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:free:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:buffers:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:cached:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num = 4;
-
 /* vm_statistics_data_t */
 #if defined(HOST_VM_INFO)
 static mach_port_t port_host;
 static vm_size_t pagesize;
 /* #endif HOST_VM_INFO */
 
@@ -82,13 +65,14 @@
 
 #elif HAVE_LIBKSTAT
 static int pagesize;
 static kstat_t *ksp;
 #endif /* HAVE_LIBKSTAT */
 
-static void memory_init (void)
+#if MEMORY_HAVE_READ
+static int memory_init (void)
 {
 #if defined(HOST_VM_INFO)
 	port_host = mach_host_self ();
 	host_page_size (port_host, &pagesize);
 /* #endif HOST_VM_INFO */
 
@@ -104,58 +88,55 @@
 	/* getpagesize(3C) tells me this does not fail.. */
 	pagesize = getpagesize ();
 	if (get_kstat (&ksp, "unix", 0, "system_pages"))
 		ksp = NULL;
 #endif /* HAVE_LIBKSTAT */
 
-	return;
-}
+	return (0);
+} /* int memory_init */
 
-static void memory_write (char *host, char *inst, char *val)
+static void memory_submit (const char *type_instance, gauge_t value)
 {
-	rrd_update_file (host, memory_file, val, ds_def, ds_num);
-}
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-#if MEMORY_HAVE_READ
-#define BUFSIZE 512
-static void memory_submit (long long mem_used, long long mem_buffered,
-		long long mem_cached, long long mem_free)
-{
-	char buf[BUFSIZE];
+	values[0].gauge = value;
 
-	if (snprintf (buf, BUFSIZE, "%u:%lli:%lli:%lli:%lli",
-				(unsigned int) curtime, mem_used, mem_free,
-				mem_buffered, mem_cached) >= BUFSIZE)
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "memory");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
+	vl.type_instance[sizeof (vl.type_instance) - 1] = '\0';
 
-	plugin_submit (MODULE_NAME, "-", buf);
+	plugin_dispatch_values ("memory", &vl);
 }
-#undef BUFSIZE
 
-static void memory_read (void)
+static int memory_read (void)
 {
 #if defined(HOST_VM_INFO)
 	kern_return_t status;
 	vm_statistics_data_t   vm_data;
 	mach_msg_type_number_t vm_data_len;
 
 	long long wired;
 	long long active;
 	long long inactive;
 	long long free;
 
 	if (!port_host || !pagesize)
-		return;
+		return (-1);
 
 	vm_data_len = sizeof (vm_data) / sizeof (natural_t);
 	if ((status = host_statistics (port_host, HOST_VM_INFO,
 					(host_info_t) &vm_data,
 					&vm_data_len)) != KERN_SUCCESS)
 	{
-		syslog (LOG_ERR, "memory-plugin: host_statistics failed and returned the value %i", (int) status);
-		return;
+		ERROR ("memory-plugin: host_statistics failed and returned the value %i", (int) status);
+		return (-1);
 	}
 
 	/*
 	 * From <http://docs.info.apple.com/article.html?artnum=107918>:
 	 *
 	 * Wired memory
@@ -177,13 +158,16 @@
 
 	wired    = vm_data.wire_count     * pagesize;
 	active   = vm_data.active_count   * pagesize;
 	inactive = vm_data.inactive_count * pagesize;
 	free     = vm_data.free_count     * pagesize;
 
-	memory_submit (wired + active, -1, inactive, free);
+	memory_submit ("wired",    wired);
+	memory_submit ("active",   active);
+	memory_submit ("inactive", inactive);
+	memory_submit ("free",     free);
 /* #endif HOST_VM_INFO */
 
 #elif HAVE_SYSCTLBYNAME
 	/*
 	 * vm.stats.vm.v_page_size: 4096
 	 * vm.stats.vm.v_page_count: 246178
@@ -201,40 +185,43 @@
 		"vm.stats.vm.v_wire_count",
 		"vm.stats.vm.v_active_count",
 		"vm.stats.vm.v_inactive_count",
 		"vm.stats.vm.v_cache_count",
 		NULL
 	};
-	int sysctl_vals[8] = { -1, -1, -1, -1, -1, -1, -1, -1 };
+	double sysctl_vals[8];
 
-	size_t len;
 	int    i;
-	int    status;
 
 	for (i = 0; sysctl_keys[i] != NULL; i++)
 	{
-		len = sizeof (int);
-		if ((status = sysctlbyname (sysctl_keys[i],
-						(void *) &sysctl_vals[i], &len,
-						NULL, 0)) < 0)
+		int value;
+		size_t value_len = sizeof (value);
+
+		if (sysctlbyname (sysctl_keys[i], (void *) &value, &value_len,
+					NULL, 0) == 0)
 		{
-			syslog (LOG_ERR, "memory plugin: sysctlbyname (%s): %s",
-					sysctl_keys[i], strerror (errno));
-			return;
+			sysctl_vals[i] = value;
+			DEBUG ("memory plugin: %26s: %6i", sysctl_keys[i], sysctl_vals[i]);
 		}
-		DBG ("%26s: %6i", sysctl_keys[i], sysctl_vals[i]);
-	} /* for i */
+		else
+		{
+			sysctl_vals[i] = NAN;
+		}
+	} /* for (sysctl_keys) */
 
 	/* multiply all all page counts with the pagesize */
 	for (i = 1; sysctl_keys[i] != NULL; i++)
-		sysctl_vals[i] = sysctl_vals[i] * sysctl_vals[0];
+		if (!isnan (sysctl_vals[i]))
+			sysctl_vals[i] *= sysctl_vals[0];
 
-	memory_submit (sysctl_vals[3] + sysctl_vals[4], /* wired + active */
-			sysctl_vals[6],                 /* cache */
-			sysctl_vals[5],                 /* inactive */
-			sysctl_vals[2]);                /* free */
+	memory_submit ("free",     sysctl_vals[2]);
+	memory_submit ("wired",    sysctl_vals[3]);
+	memory_submit ("active",   sysctl_vals[4]);
+	memory_submit ("inactive", sysctl_vals[5]);
+	memory_submit ("cache",    sysctl_vals[6]);
 /* #endif HAVE_SYSCTLBYNAME */
 
 #elif defined(KERNEL_LINUX)
 	FILE *fh;
 	char buffer[1024];
 	
@@ -245,14 +232,16 @@
 	long long mem_buffered = 0;
 	long long mem_cached = 0;
 	long long mem_free = 0;
 
 	if ((fh = fopen ("/proc/meminfo", "r")) == NULL)
 	{
-		syslog (LOG_WARNING, "memory: fopen: %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		WARNING ("memory: fopen: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	while (fgets (buffer, 1024, fh) != NULL)
 	{
 		long long *val = NULL;
 
@@ -273,57 +262,71 @@
 			continue;
 
 		*val = atoll (fields[1]) * 1024LL;
 	}
 
 	if (fclose (fh))
-		syslog (LOG_WARNING, "memory: fclose: %s", strerror (errno));
+	{
+		char errbuf[1024];
+		WARNING ("memory: fclose: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
 
 	if (mem_used >= (mem_free + mem_buffered + mem_cached))
 	{
 		mem_used -= mem_free + mem_buffered + mem_cached;
-		memory_submit (mem_used, mem_buffered, mem_cached, mem_free);
+		memory_submit ("used",     mem_used);
+		memory_submit ("buffered", mem_buffered);
+		memory_submit ("cached",   mem_cached);
+		memory_submit ("free",     mem_free);
 	}
 /* #endif defined(KERNEL_LINUX) */
 
 #elif defined(HAVE_LIBKSTAT)
 	long long mem_used;
 	long long mem_free;
 	long long mem_lock;
 
 	if (ksp == NULL)
-		return;
+		return (-1);
 
 	mem_used = get_kstat_value (ksp, "pagestotal");
 	mem_free = get_kstat_value (ksp, "pagesfree");
 	mem_lock = get_kstat_value (ksp, "pageslocked");
 
 	if ((mem_used < 0LL) || (mem_free < 0LL) || (mem_lock < 0LL))
-		return;
+		return (-1);
 	if (mem_used < (mem_free + mem_lock))
-		return;
+		return (-1);
 
 	mem_used -= mem_free + mem_lock;
 	mem_used *= pagesize; /* If this overflows you have some serious */
 	mem_free *= pagesize; /* memory.. Why not call me up and give me */
 	mem_lock *= pagesize; /* some? ;) */
 
-	memory_submit (mem_used, mem_lock, 0LL, mem_free);
+	memory_submit ("used",   mem_used);
+	memory_submit ("free",   mem_free);
+	memory_submit ("locked", mem_locked);
 /* #endif defined(HAVE_LIBKSTAT) */
 
 #elif defined(HAVE_LIBSTATGRAB)
 	sg_mem_stats *ios;
 
 	if ((ios = sg_get_mem_stats ()) != NULL)
-		memory_submit (ios->used, 0LL, ios->cache, ios->free);
+	{
+		memory_submit ("used",   ios->used);
+		memory_submit ("cached", ios->cached);
+		memory_submit ("free",   ios->free);
+	}
 #endif /* HAVE_LIBSTATGRAB */
+
+	return (0);
 }
-#else
-# define memory_read NULL
 #endif /* MEMORY_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, memory_init, memory_read, memory_write);
-}
-
-#undef MODULE_NAME
+#if MEMORY_HAVE_READ
+	plugin_register_init ("memory", memory_init);
+	plugin_register_read ("memory", memory_read);
+#endif /* MEMORY_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/multimeter.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/multimeter.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/multimeter.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/multimeter.c	2007-05-30 18:33:15.000000000 +0800
@@ -17,34 +17,29 @@
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Peter Holik <peter at holik.at>
  *
  * Used multimeter: Metex M-4650CR
- *
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#include <termios.h>
-#include <sys/ioctl.h>
-#include <math.h>
-
-#define MODULE_NAME "multimeter"
-
-static char *multimeter_file = "multimeter.rrd";
-
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num = 1;
+#if HAVE_TERMIOS_H && HAVE_SYS_IOCTL_H && HAVE_MATH_H
+# include <termios.h>
+# include <sys/ioctl.h>
+# include <math.h>
+# define MULTIMETER_HAVE_READ 1
+#else
+# define MULTIMETER_HAVE_READ 0
+# error "multimeter cannot read!"
+#endif
 
+#if MULTIMETER_HAVE_READ
 static int fd = -1;
 
 static int multimeter_timeval_sub (struct timeval *tv1, struct timeval *tv2,
                 struct timeval *res)
 {
         if ((tv1->tv_sec < tv2->tv_sec) ||
@@ -73,14 +68,16 @@
 		struct timeval time_end;
 
 		tcflush(fd, TCIFLUSH);
 
 		if (gettimeofday (&time_end, NULL) < 0)
 	        {
-	                syslog (LOG_ERR, MODULE_NAME": gettimeofday failed: %s",
-                                strerror (errno));
+			char errbuf[1024];
+	                ERROR ("multimeter plugin: gettimeofday failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 	                return (-1);
 	        }
 	        time_end.tv_sec++;	
 
 		while (1)
 		{
@@ -95,14 +92,17 @@
 
 			FD_ZERO(&rfds);
 			FD_SET(fd, &rfds);
 
 			if (gettimeofday (&time_now, NULL) < 0)
 	                {
-		                syslog (LOG_ERR, MODULE_NAME": gettimeofday failed: %s",
-                                        strerror (errno));
+				char errbuf[1024];
+		                ERROR ("multimeter plugin: "
+						"gettimeofday failed: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 	                        return (-1);
 	                }
 			if (multimeter_timeval_sub (&time_end, &time_now, &timeout) == -1)
 	                        break;
 
 			status = select(fd+1, &rfds, NULL, NULL, &timeout);
@@ -148,23 +148,25 @@
 			else if ((status == -1) && ((errno == EAGAIN) || (errno == EINTR)))
 			{
 			        continue;
 			}
 			else /* status == -1 */
             		{
-		                syslog (LOG_ERR, MODULE_NAME": select failed: %s",
-                                        strerror (errno));
+				char errbuf[1024];
+		                ERROR ("multimeter plugin: "
+						"select failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 	                        break;
 			}
 		}
 	} while (--retry);
 
 	return (-2);  /* no value received */
-}
+} /* int multimeter_read_value */
 
-static void multimeter_init (void)
+static int multimeter_init (void)
 {
 	int i;
 	char device[] = "/dev/ttyS ";
 
 	for (i = 0; i < 10; i++)
 	{
@@ -184,52 +186,75 @@
 			tios.c_cc[VMIN]  = LINE_LENGTH;
 
 			tcflush(fd, TCIFLUSH);
 			tcsetattr(fd, TCSANOW, &tios);
 			ioctl(fd, TIOCMBIC, &rts);
 			
-    			if (multimeter_read_value(&value) < -1)
+    			if (multimeter_read_value (&value) < -1)
 			{
-				close(fd);
+				close (fd);
 				fd = -1;
 			}
 			else
 			{
-				syslog (LOG_INFO, MODULE_NAME" found (%s)", device);
-				return;
+				INFO ("multimeter plugin: Device "
+						"found at %s", device);
+				return (0);
 			}
 		}
 	}
-	syslog (LOG_ERR, MODULE_NAME" not found");
+
+	ERROR ("multimeter plugin: No device found");
+	return (-1);
 }
 #undef LINE_LENGTH
 
-static void multimeter_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, multimeter_file, val, ds_def, ds_num);
-}
-#define BUFSIZE 128
-static void multimeter_submit (double *value)
+static void multimeter_submit (double value)
 {
-	char buf[BUFSIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFSIZE, "%u:%f", (unsigned int) curtime, *value) >= BUFSIZE)
-		return;
+	values[0].gauge = value;
 
-	plugin_submit (MODULE_NAME, "-", buf);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "multimeter");
+
+	plugin_dispatch_values ("multimeter", &vl);
 }
-#undef BUFSIZE
 
-static void multimeter_read (void)
+static int multimeter_read (void)
 {
 	double value;
 
-	if (fd > -1 && !(multimeter_read_value(&value)))
-		multimeter_submit (&value);
-}
+	if (fd < 0)
+		return (-1);
 
-void module_register (void)
+	if (multimeter_read_value (&value) != 0)
+		return (-1);
+
+	multimeter_submit (value);
+	return (0);
+} /* int multimeter_read */
+
+static int multimeter_shutdown (void)
 {
-	plugin_register (MODULE_NAME, multimeter_init, multimeter_read, multimeter_write);
+	if (fd >= 0)
+	{
+		close (fd);
+		fd = -1;
+	}
+
+	return (0);
 }
+#endif /* MULTIMETER_HAVE_READ */
 
-#undef MODULE_NAME
+void module_register (void)
+{
+#if MULTIMETER_HAVE_READ
+	plugin_register_init ("multimeter", multimeter_init);
+	plugin_register_read ("multimeter", multimeter_read);
+	plugin_register_shutdown ("multimeter", multimeter_shutdown);
+#endif /* MULTIMETER_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/mysql.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/mysql.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/mysql.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/mysql.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/mysql.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006,2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -26,158 +25,93 @@
 #include "configfile.h"
 
 #ifdef HAVE_MYSQL_MYSQL_H
 #include <mysql/mysql.h>
 #endif
 
-#define MODULE_NAME "mysql"
-
 #if COLLECT_LIBMYSQL
 # define MYSQL_HAVE_READ 1
 #else
 # define MYSQL_HAVE_READ 0
 #endif
 
-#define BUFSIZE 512
-
-static char *host = "localhost";
-static char *user;
-static char *pass;
-static char *db = NULL;
-
-/* TODO
- * understand `Select_*' and possibly do that stuff as well..
- */
-
-static char *commands_file = "mysql/mysql_commands-%s.rrd";
-static char *handler_file  = "mysql/mysql_handler-%s.rrd";
-static char *qcache_file   = "mysql/mysql_qcache.rrd";
-static char *threads_file  = "mysql/mysql_threads.rrd";
-static char *traffic_file  = "traffic-mysql.rrd";
-
-static char *commands_ds_def[] =
-{
-	"DS:value:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int commands_ds_num = 1;
-
-static char *handler_ds_def[] =
-{
-	"DS:value:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int handler_ds_num = 1;
-
-static char *qcache_ds_def[] =
-{
-	"DS:hits:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:inserts:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:not_cached:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:lowmem_prunes:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:queries_in_cache:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int qcache_ds_num = 5;
-
-static char *threads_ds_def[] =
-{
-	"DS:running:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	"DS:connected:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	"DS:cached:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	"DS:created:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int threads_ds_num = 4;
-
-static char *traffic_ds_def[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int traffic_ds_num = 2;
+/* TODO: Understand `Select_*' and possibly do that stuff as well.. */
 
-static char *config_keys[] =
+#if MYSQL_HAVE_READ
+static const char *config_keys[] =
 {
 	"Host",
 	"User",
 	"Password",
 	"Database",
 	NULL
 };
 static int config_keys_num = 4;
 
-#if MYSQL_HAVE_READ
+static char *host = "localhost";
+static char *user;
+static char *pass;
+static char *db = NULL;
+
 static MYSQL *getconnection (void)
 {
 	static MYSQL *con;
 	static int    state;
 
 	static int wait_for = 0;
 	static int wait_increase = 60;
 
-	int step;
-
 	if (state != 0)
 	{
 		int err;
 		if ((err = mysql_ping (con)) != 0)
 		{
-			syslog (LOG_WARNING, "mysql_ping failed: %s", mysql_error (con));
+			WARNING ("mysql_ping failed: %s", mysql_error (con));
 			state = 0;
 		}
 		else
 		{
 			state = 1;
 			return (con);
 		}
 	}
 
-	step = atoi (COLLECTD_STEP);
-
 	if (wait_for > 0)
 	{
-		wait_for -= step;
+		wait_for -= interval_g;
 		return (NULL);
 	}
 
 	wait_for = wait_increase;
 	wait_increase *= 2;
 	if (wait_increase > 86400)
 		wait_increase = 86400;
 
 	if ((con = mysql_init (con)) == NULL)
 	{
-		syslog (LOG_ERR, "mysql_init failed: %s", mysql_error (con));
+		ERROR ("mysql_init failed: %s", mysql_error (con));
 		state = 0;
 		return (NULL);
 	}
 
 	if (mysql_real_connect (con, host, user, pass, db, 0, NULL, 0) == NULL)
 	{
-		syslog (LOG_ERR, "mysql_real_connect failed: %s", mysql_error (con));
+		ERROR ("mysql_real_connect failed: %s", mysql_error (con));
 		state = 0;
 		return (NULL);
 	}
 	else
 	{
 		state = 1;
 		wait_for = 0;
 		wait_increase = 60;
 		return (con);
 	}
 } /* static MYSQL *getconnection (void) */
-#endif /* MYSQL_HAVE_READ */
 
-static void init (void)
-{
-	return;
-}
-
-static int config (char *key, char *value)
+static int config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "host") == 0)
 		return ((host = strdup (value)) == NULL ? 1 : 0);
 	else if (strcasecmp (key, "user") == 0)
 		return ((user = strdup (value)) == NULL ? 1 : 0);
 	else if (strcasecmp (key, "password") == 0)
@@ -185,166 +119,90 @@
 	else if (strcasecmp (key, "database") == 0)
 		return ((db = strdup (value)) == NULL ? 1 : 0);
 	else
 		return (-1);
 }
 
-static void commands_write (char *host, char *inst, char *val)
+static void counter_submit (const char *type, const char *type_instance,
+		counter_t value)
 {
-	char buf[BUFSIZE];
-
-	if (snprintf (buf, BUFSIZE, commands_file, inst) >= BUFSIZE)
-		return;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	rrd_update_file (host, buf, val, commands_ds_def, commands_ds_num);
-}
-
-static void handler_write (char *host, char *inst, char *val)
-{
-	char buf[BUFSIZE];
+	values[0].counter = value;
 
-	if (snprintf (buf, BUFSIZE, handler_file, inst) >= BUFSIZE)
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "mysql");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-	rrd_update_file (host, buf, val, handler_ds_def, handler_ds_num);
-}
+	plugin_dispatch_values (type, &vl);
+} /* void counter_submit */
 
-static void qcache_write (char *host, char *inst, char *val)
+static void qcache_submit (counter_t hits, counter_t inserts,
+		counter_t not_cached, counter_t lowmem_prunes,
+		gauge_t queries_in_cache)
 {
-	rrd_update_file (host, qcache_file, val,
-			qcache_ds_def, qcache_ds_num);
-}
+	value_t values[5];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void threads_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, threads_file, val,
-			threads_ds_def, threads_ds_num);
-}
+	values[0].counter = hits;
+	values[1].counter = inserts;
+	values[2].counter = not_cached;
+	values[3].counter = lowmem_prunes;
+	values[4].gauge   = queries_in_cache;
 
-static void traffic_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, traffic_file, val,
-			traffic_ds_def, traffic_ds_num);
-}
+	vl.values = values;
+	vl.values_len = 5;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "mysql");
 
-#if MYSQL_HAVE_READ
-static void commands_submit (char *inst, unsigned long long value)
-{
-	char buf[BUFSIZE];
-	int  status;
+	plugin_dispatch_values ("mysql_qcache", &vl);
+} /* void qcache_submit */
 
-	status = snprintf (buf, BUFSIZE, "%u:%llu", (unsigned int) curtime, value);
-
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "snprintf failed");
-		return;
-	}
-	else if (status >= BUFSIZE)
-	{
-		syslog (LOG_WARNING, "snprintf was truncated");
-		return;
-	}
-
-	plugin_submit ("mysql_commands", inst, buf);
-}
-
-static void handler_submit (char *inst, unsigned long long value)
+static void threads_submit (gauge_t running, gauge_t connected, gauge_t cached,
+		counter_t created)
 {
-	char buf[BUFSIZE];
-	int  status;
+	value_t values[4];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	status = snprintf (buf, BUFSIZE, "%u:%llu", (unsigned int) curtime, value);
+	values[0].gauge   = running;
+	values[1].gauge   = connected;
+	values[2].gauge   = cached;
+	values[3].counter = created;
 
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "snprintf failed");
-		return;
-	}
-	else if (status >= BUFSIZE)
-	{
-		syslog (LOG_WARNING, "snprintf was truncated");
-		return;
-	}
+	vl.values = values;
+	vl.values_len = 4;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "mysql");
 
-	plugin_submit ("mysql_handler", inst, buf);
-}
+	plugin_dispatch_values ("mysql_threads", &vl);
+} /* void threads_submit */
 
-static void qcache_submit (unsigned long long hits, unsigned long long inserts,
-		unsigned long long not_cached, unsigned long long lowmem_prunes,
-		int queries_in_cache)
+static void traffic_submit (counter_t rx, counter_t tx)
 {
-	char buf[BUFSIZE];
-	int  status;
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	status = snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%i",
-			(unsigned int) curtime, hits, inserts, not_cached,
-			lowmem_prunes, queries_in_cache);
+	values[0].counter = rx;
+	values[1].counter = tx;
 
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "snprintf failed");
-		return;
-	}
-	else if (status >= BUFSIZE)
-	{
-		syslog (LOG_WARNING, "snprintf was truncated");
-		return;
-	}
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "mysql");
 
-	plugin_submit ("mysql_qcache", "-", buf);
-}
+	plugin_dispatch_values ("mysql_octets", &vl);
+} /* void traffic_submit */
 
-static void threads_submit (int running, int connected, int cached,
-		unsigned long long created)
-{
-	char buf[BUFSIZE];
-	int  status;
-
-	status = snprintf (buf, BUFSIZE, "%u:%i:%i:%i:%llu",
-			(unsigned int) curtime,
-			running, connected, cached, created);
-
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "snprintf failed");
-		return;
-	}
-	else if (status >= BUFSIZE)
-	{
-		syslog (LOG_WARNING, "snprintf was truncated");
-		return;
-	}
-
-	plugin_submit ("mysql_threads", "-", buf);
-}
-
-static void traffic_submit (unsigned long long incoming,
-		unsigned long long outgoing)
-{
-	char buf[BUFSIZE];
-	int  status;
-
-	status = snprintf (buf, BUFSIZE, "%u:%llu:%llu", (unsigned int) curtime,
-			incoming, outgoing);
-
-	if (status < 0)
-	{
-		syslog (LOG_ERR, "snprintf failed");
-		return;
-	}
-	else if (status >= BUFSIZE)
-	{
-		syslog (LOG_WARNING, "snprintf was truncated");
-		return;
-	}
-
-	plugin_submit ("mysql_traffic", "-", buf);
-}
-
-static void mysql_read (void)
+static int mysql_read (void)
 {
 	MYSQL     *con;
 	MYSQL_RES *res;
 	MYSQL_ROW  row;
 	char      *query;
 	int        query_len;
@@ -363,32 +221,32 @@
 
 	unsigned long long traffic_incoming = 0ULL;
 	unsigned long long traffic_outgoing = 0ULL;
 
 	/* An error message will have been printed in this case */
 	if ((con = getconnection ()) == NULL)
-		return;
+		return (-1);
 
 	query = "SHOW STATUS";
 	if (mysql_get_server_version (con) >= 50002)
 		query = "SHOW GLOBAL STATUS";
 
 	query_len = strlen (query);
 
 	if (mysql_real_query (con, query, query_len))
 	{
-		syslog (LOG_ERR, "mysql_real_query failed: %s\n",
+		ERROR ("mysql_real_query failed: %s\n",
 				mysql_error (con));
-		return;
+		return (-1);
 	}
 
 	if ((res = mysql_store_result (con)) == NULL)
 	{
-		syslog (LOG_ERR, "mysql_store_result failed: %s\n",
+		ERROR ("mysql_store_result failed: %s\n",
 				mysql_error (con));
-		return;
+		return (-1);
 	}
 
 	field_num = mysql_num_fields (res);
 	while ((row = mysql_fetch_row (res)))
 	{
 		char *key;
@@ -401,20 +259,20 @@
 		{
 			if (val == 0ULL)
 				continue;
 
 			/* Ignore `prepared statements' */
 			if (strncmp (key, "Com_stmt_", 9) != 0)
-				commands_submit (key + 4, val);
+				counter_submit ("mysql_commands", key + 4, val);
 		}
 		else if (strncmp (key, "Handler_", 8) == 0)
 		{
 			if (val == 0ULL)
 				continue;
 
-			handler_submit (key + 8, val);
+			counter_submit ("mysql_handler", key + 8, val);
 		}
 		else if (strncmp (key, "Qcache_", 7) == 0)
 		{
 			if (strcmp (key, "Qcache_hits") == 0)
 				qcache_hits = val;
 			else if (strcmp (key, "Qcache_inserts") == 0)
@@ -459,25 +317,17 @@
 				threads_cached, threads_created);
 
 	traffic_submit  (traffic_incoming, traffic_outgoing);
 
 	/* mysql_close (con); */
 
-	return;
-}
-#else
-# define mysql_read NULL
+	return (0);
+} /* int mysql_read */
 #endif /* MYSQL_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, init, mysql_read, NULL);
-	plugin_register ("mysql_commands", NULL, NULL, commands_write);
-	plugin_register ("mysql_handler",  NULL, NULL, handler_write);
-	plugin_register ("mysql_qcache",   NULL, NULL, qcache_write);
-	plugin_register ("mysql_threads",  NULL, NULL, threads_write);
-	plugin_register ("mysql_traffic",  NULL, NULL, traffic_write);
-	cf_register (MODULE_NAME, config, config_keys, config_keys_num);
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+#if MYSQL_HAVE_READ
+	plugin_register_config ("mysql", config, config_keys, config_keys_num);
+	plugin_register_read ("mysql", mysql_read);
+#endif /* MYSQL_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/network.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/network.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/network.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/network.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/network.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -17,90 +16,636 @@
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  **/
 
-#if HAVE_CONFIG_H
-# include "config.h"
-#endif
-
-#include <stdlib.h>
-#include <stdio.h>
-#include <string.h>
-#include <sys/types.h>
-#include <sys/socket.h>
-#include <netdb.h>
-#include <netinet/in.h>
-#include <arpa/inet.h>
-#include <syslog.h>
-#include <errno.h>
-
-#include "network.h"
+#include "collectd.h"
+#include "plugin.h"
 #include "common.h"
 #include "configfile.h"
-#include "utils_debug.h"
+#include "utils_avltree.h"
+
+#include "network.h"
+
+#if HAVE_PTHREAD_H
+# include <pthread.h>
+#endif
+#if HAVE_SYS_SOCKET_H
+# include <sys/socket.h>
+#endif
+#if HAVE_NETDB_H
+# include <netdb.h>
+#endif
+#if HAVE_NETINET_IN_H
+# include <netinet/in.h>
+#endif
+#if HAVE_ARPA_INET_H
+# include <arpa/inet.h>
+#endif
+#if HAVE_POLL_H
+# include <poll.h>
+#endif
 
 /* 1500 - 40 - 8  =  Ethernet packet - IPv6 header - UDP header */
 /* #define BUFF_SIZE 1452 */
 
 #ifndef IPV6_ADD_MEMBERSHIP
 # ifdef IPV6_JOIN_GROUP
 #  define IPV6_ADD_MEMBERSHIP IPV6_JOIN_GROUP
 # else
 #  error "Neither IP_ADD_MEMBERSHIP nor IPV6_JOIN_GROUP is defined"
 # endif
 #endif /* !IP_ADD_MEMBERSHIP */
 
-#define BUFF_SIZE 4096
-
-extern int operating_mode;
+#define BUFF_SIZE 1024
 
+/*
+ * Private data types
+ */
 typedef struct sockent
 {
 	int                      fd;
-	int                      mode;
 	struct sockaddr_storage *addr;
 	socklen_t                addrlen;
 	struct sockent          *next;
 } sockent_t;
 
-static sockent_t *socklist_head = NULL;
+/*                      1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
+ *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+ * +-------+-----------------------+-------------------------------+
+ * ! Ver.  !                       ! Length                        !
+ * +-------+-----------------------+-------------------------------+
+ */
+struct part_header_s
+{
+	uint16_t type;
+	uint16_t length;
+};
+typedef struct part_header_s part_header_t;
+
+/*                      1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
+ *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+ * +-------------------------------+-------------------------------+
+ * ! Type                          ! Length                        !
+ * +-------------------------------+-------------------------------+
+ * : (Length - 4) Bytes                                            :
+ * +---------------------------------------------------------------+
+ */
+struct part_string_s
+{
+	part_header_t *head;
+	char *value;
+};
+typedef struct part_string_s part_string_t;
+
+/*                      1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
+ *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+ * +-------------------------------+-------------------------------+
+ * ! Type                          ! Length                        !
+ * +-------------------------------+-------------------------------+
+ * : (Length - 4 == 2 || 4 || 8) Bytes                             :
+ * +---------------------------------------------------------------+
+ */
+struct part_number_s
+{
+	part_header_t *head;
+	uint64_t *value;
+};
+typedef struct part_number_s part_number_t;
+
+/*                      1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
+ *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+ * +-------------------------------+-------------------------------+
+ * ! Type                          ! Length                        !
+ * +-------------------------------+---------------+---------------+
+ * ! Num of values                 ! Type0         ! Type1         !
+ * +-------------------------------+---------------+---------------+
+ * ! Value0                                                        !
+ * !                                                               !
+ * +---------------------------------------------------------------+
+ * ! Value1                                                        !
+ * !                                                               !
+ * +---------------------------------------------------------------+
+ */
+struct part_values_s
+{
+	part_header_t *head;
+	uint16_t *num_values;
+	uint8_t  *values_types;
+	value_t  *values;
+};
+typedef struct part_values_s part_values_t;
+
+/*
+ * Private variables
+ */
+static const char *config_keys[] =
+{
+	"CacheFlush",
+	"Listen",
+	"Server",
+	"TimeToLive",
+	"Forward"
+};
+static int config_keys_num = STATIC_ARRAY_SIZE (config_keys);
+
+static int network_config_ttl = 0;
+static int network_config_forward = 0;
+
+static sockent_t *sending_sockets = NULL;
+
+static struct pollfd *listen_sockets = NULL;
+static int listen_sockets_num = 0;
+static pthread_t listen_thread = 0;
+static int listen_loop = 0;
+
+static char         send_buffer[BUFF_SIZE];
+static char        *send_buffer_ptr;
+static int          send_buffer_fill;
+static value_list_t send_buffer_vl = VALUE_LIST_INIT;
+static char         send_buffer_type[DATA_MAX_NAME_LEN];
+static pthread_mutex_t send_buffer_lock = PTHREAD_MUTEX_INITIALIZER;
+
+static avl_tree_t      *cache_tree = NULL;
+static pthread_mutex_t  cache_lock = PTHREAD_MUTEX_INITIALIZER;
+static time_t           cache_flush_last;
+static int              cache_flush_interval = 1800;
+
+/*
+ * Private functions
+ */
+static int cache_flush (void)
+{
+	char **keys = NULL;
+	int    keys_num = 0;
 
-static int network_set_ttl (const sockent_t *se, const struct addrinfo *ai)
+	char **tmp;
+	int    i;
+
+	char   *key;
+	time_t *value;
+	avl_iterator_t *iter;
+
+	time_t curtime = time (NULL);
+
+	iter = avl_get_iterator (cache_tree);
+	while (avl_iterator_next (iter, (void *) &key, (void *) &value) == 0)
+	{
+		if ((curtime - *value) <= cache_flush_interval)
+			continue;
+		tmp = (char **) realloc (keys,
+				(keys_num + 1) * sizeof (char *));
+		if (tmp == NULL)
+		{
+			sfree (keys);
+			avl_iterator_destroy (iter);
+			ERROR ("network plugin: cache_flush: realloc"
+					" failed.");
+			return (-1);
+		}
+		keys = tmp;
+		keys[keys_num] = key;
+		keys_num++;
+	} /* while (avl_iterator_next) */
+	avl_iterator_destroy (iter);
+
+	for (i = 0; i < keys_num; i++)
+	{
+		if (avl_remove (cache_tree, keys[i], (void *) &key,
+					(void *) &value) != 0)
+		{
+			WARNING ("network plugin: cache_flush: avl_remove"
+					" (%s) failed.", keys[i]);
+			continue;
+		}
+
+		sfree (key);
+		sfree (value);
+	}
+
+	sfree (keys);
+
+	DEBUG ("network plugin: cache_flush: Removed %i %s",
+			keys_num, (keys_num == 1) ? "entry" : "entries");
+	cache_flush_last = curtime;
+	return (0);
+} /* int cache_flush */
+
+static int cache_check (const char *type, const value_list_t *vl)
+{
+	char key[1024];
+	time_t *value = NULL;
+	int retval = -1;
+
+	if (cache_tree == NULL)
+		return (-1);
+
+	if (format_name (key, sizeof (key), vl->host, vl->plugin,
+				vl->plugin_instance, type, vl->type_instance))
+		return (-1);
+
+	pthread_mutex_lock (&cache_lock);
+
+	if (avl_get (cache_tree, key, (void *) &value) == 0)
+	{
+		if (*value < vl->time)
+		{
+			*value = vl->time;
+			retval = 0;
+		}
+		else
+		{
+			DEBUG ("network plugin: cache_check: *value = %i >= vl->time = %i",
+					(int) *value, (int) vl->time);
+			retval = 1;
+		}
+	}
+	else
+	{
+		char *key_copy = strdup (key);
+		value = malloc (sizeof (time_t));
+		if ((key_copy != NULL) && (value != NULL))
+		{
+			*value = vl->time;
+			avl_insert (cache_tree, key_copy, value);
+			retval = 0;
+		}
+		else
+		{
+			sfree (key_copy);
+			sfree (value);
+		}
+	}
+
+	if ((time (NULL) - cache_flush_last) > cache_flush_interval)
+		cache_flush ();
+
+	pthread_mutex_unlock (&cache_lock);
+
+	DEBUG ("network plugin: cache_check: key = %s; time = %i; retval = %i",
+			key, (int) vl->time, retval);
+
+	return (retval);
+} /* int cache_check */
+
+static int write_part_values (char **ret_buffer, int *ret_buffer_len,
+		const data_set_t *ds, const value_list_t *vl)
 {
-	char *ttl_str;
-	int   ttl_int;
+	part_values_t pv;
+	int i;
 
-	ttl_str = cf_get_option ("TimeToLive", NULL);
-	if (ttl_str == NULL)
+	i = 6 + (9 * vl->values_len);
+	if (*ret_buffer_len < i)
 		return (-1);
+	*ret_buffer_len -= i;
 
-	ttl_int = atoi (ttl_str);
-	if ((ttl_int < 1) || (ttl_int > 255))
+	pv.head = (part_header_t *) *ret_buffer;
+	pv.num_values = (uint16_t *) (pv.head + 1);
+	pv.values_types = (uint8_t *) (pv.num_values + 1);
+	pv.values = (value_t *) (pv.values_types + vl->values_len);
+	*ret_buffer = (void *) (pv.values + vl->values_len);
+
+	pv.head->type = htons (TYPE_VALUES);
+	pv.head->length = htons (6 + (9 * vl->values_len));
+	*pv.num_values = htons ((uint16_t) vl->values_len);
+	
+	for (i = 0; i < vl->values_len; i++)
 	{
-		syslog (LOG_WARNING, "A TTL value of %i is invalid.", ttl_int);
+		if (ds->ds[i].type == DS_TYPE_COUNTER)
+		{
+			pv.values_types[i] = DS_TYPE_COUNTER;
+			pv.values[i].counter = htonll (vl->values[i].counter);
+		}
+		else
+		{
+			pv.values_types[i] = DS_TYPE_GAUGE;
+			pv.values[i].gauge = vl->values[i].gauge;
+		}
+	} /* for (values) */
+
+	return (0);
+} /* int write_part_values */
+
+static int write_part_number (char **ret_buffer, int *ret_buffer_len,
+		int type, uint64_t value)
+{
+	part_number_t pn;
+
+	if (*ret_buffer_len < 12)
 		return (-1);
+
+	pn.head = (part_header_t *) *ret_buffer;
+	pn.value = (uint64_t *) (pn.head + 1);
+
+	pn.head->type = htons (type);
+	pn.head->length = htons (12);
+	*pn.value = htonll (value);
+
+	*ret_buffer = (char *) (pn.value + 1);
+	*ret_buffer_len -= 12;
+
+	return (0);
+} /* int write_part_number */
+
+static int write_part_string (char **ret_buffer, int *ret_buffer_len,
+		int type, const char *str, int str_len)
+{
+	part_string_t ps;
+	int len;
+
+	len = 4 + str_len + 1;
+	if (*ret_buffer_len < len)
+		return (-1);
+	*ret_buffer_len -= len;
+
+	ps.head = (part_header_t *) *ret_buffer;
+	ps.value = (char *) (ps.head + 1);
+
+	ps.head->type = htons ((uint16_t) type);
+	ps.head->length = htons ((uint16_t) str_len + 5);
+	if (str_len > 0)
+		memcpy (ps.value, str, str_len);
+	ps.value[str_len] = '\0';
+	*ret_buffer = (void *) (ps.value + (str_len + 1));
+
+	return (0);
+} /* int write_part_string */
+
+static int parse_part_values (void **ret_buffer, int *ret_buffer_len,
+		value_t **ret_values, int *ret_num_values)
+{
+	char *buffer = *ret_buffer;
+	int   buffer_len = *ret_buffer_len;
+	part_values_t pv;
+	int   i;
+
+	uint16_t h_length;
+	uint16_t h_type;
+	uint16_t h_num;
+
+	if (buffer_len < (15))
+	{
+		DEBUG ("network plugin: packet is too short: buffer_len = %i",
+				buffer_len);
+		return (-1);
+	}
+
+	pv.head = (part_header_t *) buffer;
+	h_length = ntohs (pv.head->length);
+	h_type = ntohs (pv.head->type);
+
+	assert (h_type == TYPE_VALUES);
+
+	pv.num_values = (uint16_t *) (pv.head + 1);
+	h_num = ntohs (*pv.num_values);
+
+	if (h_num != ((h_length - 6) / 9))
+	{
+		DEBUG ("`length' and `num of values' don't match");
+		return (-1);
+	}
+
+	pv.values_types = (uint8_t *) (pv.num_values + 1);
+	pv.values = (value_t *) (pv.values_types + h_num);
+
+	for (i = 0; i < h_num; i++)
+		if (pv.values_types[i] == DS_TYPE_COUNTER)
+			pv.values[i].counter = ntohll (pv.values[i].counter);
+
+	*ret_buffer     = (void *) (pv.values + h_num);
+	*ret_buffer_len = buffer_len - h_length;
+	*ret_num_values = h_num;
+	*ret_values     = pv.values;
+
+	return (0);
+} /* int parse_part_values */
+
+static int parse_part_number (void **ret_buffer, int *ret_buffer_len,
+		uint64_t *value)
+{
+	part_number_t pn;
+	uint16_t len;
+
+	pn.head = (part_header_t *) *ret_buffer;
+	pn.value = (uint64_t *) (pn.head + 1);
+
+	len = ntohs (pn.head->length);
+	if (len != 12)
+		return (-1);
+	if (len > *ret_buffer_len)
+		return (-1);
+	*value = ntohll (*pn.value);
+
+	*ret_buffer = (void *) (pn.value + 1);
+	*ret_buffer_len -= len;
+
+	return (0);
+} /* int parse_part_number */
+
+static int parse_part_string (void **ret_buffer, int *ret_buffer_len,
+		char *output, int output_len)
+{
+	char *buffer = *ret_buffer;
+	int   buffer_len = *ret_buffer_len;
+	part_string_t ps;
+
+	uint16_t h_length;
+	uint16_t h_type;
+
+	DEBUG ("network plugin: parse_part_string: ret_buffer = %p;"
+			" ret_buffer_len = %i; output = %p; output_len = %i;",
+			*ret_buffer, *ret_buffer_len,
+			(void *) output, output_len);
+
+	ps.head = (part_header_t *) buffer;
+
+	h_length = ntohs (ps.head->length);
+	h_type = ntohs (ps.head->type);
+
+	DEBUG ("network plugin: parse_part_string: length = %hu; type = %hu;",
+			h_length, h_type);
+
+	if (buffer_len < h_length)
+	{
+		DEBUG ("packet is too short");
+		return (-1);
+	}
+	assert ((h_type == TYPE_HOST)
+			|| (h_type == TYPE_PLUGIN)
+			|| (h_type == TYPE_PLUGIN_INSTANCE)
+			|| (h_type == TYPE_TYPE)
+			|| (h_type == TYPE_TYPE_INSTANCE));
+
+	ps.value = buffer + 4;
+	if (ps.value[h_length - 5] != '\0')
+	{
+		DEBUG ("String does not end with a nullbyte");
+		return (-1);
+	}
+
+	if (output_len < (h_length - 4))
+	{
+		DEBUG ("output buffer is too small");
+		return (-1);
+	}
+	strcpy (output, ps.value);
+
+	DEBUG ("network plugin: parse_part_string: output = %s", output);
+
+	*ret_buffer = (void *) (buffer + h_length);
+	*ret_buffer_len = buffer_len - h_length;
+
+	return (0);
+} /* int parse_part_string */
+
+static int parse_packet (void *buffer, int buffer_len)
+{
+	part_header_t *header;
+	int status;
+
+	value_list_t vl = VALUE_LIST_INIT;
+	char type[DATA_MAX_NAME_LEN];
+
+	DEBUG ("network plugin: parse_packet: buffer = %p; buffer_len = %i;",
+			buffer, buffer_len);
+
+	memset (&vl, '\0', sizeof (vl));
+	memset (&type, '\0', sizeof (type));
+	status = 0;
+
+	while ((status == 0) && (buffer_len > sizeof (part_header_t)))
+	{
+		header = (part_header_t *) buffer;
+
+		if (ntohs (header->length) > buffer_len)
+			break;
+		/* Assure that this loop terminates eventually */
+		if (ntohs (header->length) < 4)
+			break;
+
+		if (ntohs (header->type) == TYPE_VALUES)
+		{
+			status = parse_part_values (&buffer, &buffer_len,
+					&vl.values, &vl.values_len);
+
+			if (status != 0)
+			{
+				DEBUG ("parse_part_values failed.");
+				break;
+			}
+
+			if ((vl.time > 0)
+					&& (strlen (vl.host) > 0)
+					&& (strlen (vl.plugin) > 0)
+					&& (strlen (type) > 0)
+					&& (cache_check (type, &vl) == 0))
+			{
+				DEBUG ("network plugin: parse_packet:"
+						" dispatching values");
+				plugin_dispatch_values (type, &vl);
+			}
+			else
+			{
+				DEBUG ("network plugin: parse_packet:"
+						" NOT dispatching values");
+			}
+		}
+		else if (ntohs (header->type) == TYPE_TIME)
+		{
+			uint64_t tmp = 0;
+			status = parse_part_number (&buffer, &buffer_len, &tmp);
+			if (status == 0)
+				vl.time = (time_t) tmp;
+		}
+		else if (ntohs (header->type) == TYPE_HOST)
+		{
+			status = parse_part_string (&buffer, &buffer_len,
+					vl.host, sizeof (vl.host));
+			DEBUG ("network plugin: parse_packet: vl.host = %s", vl.host);
+		}
+		else if (ntohs (header->type) == TYPE_PLUGIN)
+		{
+			status = parse_part_string (&buffer, &buffer_len,
+					vl.plugin, sizeof (vl.plugin));
+			DEBUG ("network plugin: parse_packet: vl.plugin = %s", vl.plugin);
+		}
+		else if (ntohs (header->type) == TYPE_PLUGIN_INSTANCE)
+		{
+			status = parse_part_string (&buffer, &buffer_len,
+					vl.plugin_instance, sizeof (vl.plugin_instance));
+			DEBUG ("network plugin: parse_packet: vl.plugin_instance = %s", vl.plugin_instance);
+		}
+		else if (ntohs (header->type) == TYPE_TYPE)
+		{
+			status = parse_part_string (&buffer, &buffer_len,
+					type, sizeof (type));
+			DEBUG ("network plugin: parse_packet: type = %s", type);
+		}
+		else if (ntohs (header->type) == TYPE_TYPE_INSTANCE)
+		{
+			status = parse_part_string (&buffer, &buffer_len,
+					vl.type_instance, sizeof (vl.type_instance));
+			DEBUG ("network plugin: parse_packet: vl.type_instance = %s", vl.type_instance);
+		}
+		else
+		{
+			DEBUG ("network plugin: parse_packet: Unknown part"
+					" type: 0x%0hx", ntohs (header->type));
+			buffer = ((char *) buffer) + ntohs (header->length);
+		}
+	} /* while (buffer_len > sizeof (part_header_t)) */
+
+	return (0);
+} /* int parse_packet */
+
+static void free_sockent (sockent_t *se)
+{
+	sockent_t *next;
+	while (se != NULL)
+	{
+		next = se->next;
+		free (se->addr);
+		free (se);
+		se = next;
 	}
+} /* void free_sockent */
+
+/*
+ * int network_set_ttl
+ *
+ * Set the `IP_MULTICAST_TTL', `IP_TTL', `IPV6_MULTICAST_HOPS' or
+ * `IPV6_UNICAST_HOPS', depending on which option is applicable.
+ *
+ * The `struct addrinfo' is used to destinguish between unicast and multicast
+ * sockets.
+ */
+static int network_set_ttl (const sockent_t *se, const struct addrinfo *ai)
+{
+	if ((network_config_ttl < 1) || (network_config_ttl > 255))
+		return (-1);
 
-	DBG ("ttl = %i", ttl_int);
+	DEBUG ("ttl = %i", network_config_ttl);
 
 	if (ai->ai_family == AF_INET)
 	{
 		struct sockaddr_in *addr = (struct sockaddr_in *) ai->ai_addr;
 		int optname;
 
 		if (IN_MULTICAST (ntohl (addr->sin_addr.s_addr)))
 			optname = IP_MULTICAST_TTL;
 		else
 			optname = IP_TTL;
 
 		if (setsockopt (se->fd, IPPROTO_IP, optname,
-					&ttl_int, sizeof (ttl_int)) == -1)
+					&network_config_ttl,
+					sizeof (network_config_ttl)) == -1)
 		{
-			syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("setsockopt: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			return (-1);
 		}
 	}
 	else if (ai->ai_family == AF_INET6)
 	{
 		/* Useful example: http://gsyc.escet.urjc.es/~eva/IPv6-web/examples/mcast.html */
@@ -110,70 +655,82 @@
 		if (IN6_IS_ADDR_MULTICAST (&addr->sin6_addr))
 			optname = IPV6_MULTICAST_HOPS;
 		else
 			optname = IPV6_UNICAST_HOPS;
 
 		if (setsockopt (se->fd, IPPROTO_IPV6, optname,
-					&ttl_int, sizeof (ttl_int)) == -1)
+					&network_config_ttl,
+					sizeof (network_config_ttl)) == -1)
 		{
-			syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("setsockopt: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (-1);
 		}
 	}
 
 	return (0);
-}
+} /* int network_set_ttl */
 
 static int network_bind_socket (const sockent_t *se, const struct addrinfo *ai)
 {
-	int loop = 1;
+	int loop = 0;
 
-	DBG ("fd = %i; calling `bind'", se->fd);
+	DEBUG ("fd = %i; calling `bind'", se->fd);
 
 	if (bind (se->fd, ai->ai_addr, ai->ai_addrlen) == -1)
 	{
-		syslog (LOG_ERR, "bind: %s", strerror (errno));
+		char errbuf[1024];
+		ERROR ("bind: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 
 	if (ai->ai_family == AF_INET)
 	{
 		struct sockaddr_in *addr = (struct sockaddr_in *) ai->ai_addr;
 		if (IN_MULTICAST (ntohl (addr->sin_addr.s_addr)))
 		{
 			struct ip_mreq mreq;
 
-			DBG ("fd = %i; IPv4 multicast address found", se->fd);
+			DEBUG ("fd = %i; IPv4 multicast address found", se->fd);
 
 			mreq.imr_multiaddr.s_addr = addr->sin_addr.s_addr;
 			mreq.imr_interface.s_addr = htonl (INADDR_ANY);
 
 			if (setsockopt (se->fd, IPPROTO_IP, IP_MULTICAST_LOOP,
 						&loop, sizeof (loop)) == -1)
 			{
-				syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("setsockopt: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 
 			if (setsockopt (se->fd, IPPROTO_IP, IP_ADD_MEMBERSHIP,
 						&mreq, sizeof (mreq)) == -1)
 			{
-				syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("setsockopt: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 		}
 	}
 	else if (ai->ai_family == AF_INET6)
 	{
 		/* Useful example: http://gsyc.escet.urjc.es/~eva/IPv6-web/examples/mcast.html */
 		struct sockaddr_in6 *addr = (struct sockaddr_in6 *) ai->ai_addr;
 		if (IN6_IS_ADDR_MULTICAST (&addr->sin6_addr))
 		{
 			struct ipv6_mreq mreq;
 
-			DBG ("fd = %i; IPv6 multicast address found", se->fd);
+			DEBUG ("fd = %i; IPv6 multicast address found", se->fd);
 
 			memcpy (&mreq.ipv6mr_multiaddr,
 					&addr->sin6_addr,
 					sizeof (addr->sin6_addr));
 
 			/* http://developer.apple.com/documentation/Darwin/Reference/ManPages/man4/ip6.4.html
@@ -187,367 +744,609 @@
 			 * group on more than one interface.*/
 			mreq.ipv6mr_interface = 0;
 
 			if (setsockopt (se->fd, IPPROTO_IPV6, IPV6_MULTICAST_LOOP,
 						&loop, sizeof (loop)) == -1)
 			{
-				syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("setsockopt: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 
 			if (setsockopt (se->fd, IPPROTO_IPV6, IPV6_ADD_MEMBERSHIP,
 						&mreq, sizeof (mreq)) == -1)
 			{
-				syslog (LOG_ERR, "setsockopt: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("setsockopt: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
 				return (-1);
 			}
 		}
 	}
 
 	return (0);
-}
+} /* int network_bind_socket */
 
-int network_create_socket (const char *node, const char *service)
+static sockent_t *network_create_socket (const char *node,
+		const char *service,
+		int listen)
 {
-	sockent_t *socklist_tail;
-
 	struct addrinfo  ai_hints;
 	struct addrinfo *ai_list, *ai_ptr;
 	int              ai_return;
 
-	int num_added = 0;
-
-	DBG ("node = %s, service = %s", node, service);
-
-	if (operating_mode == MODE_LOCAL || operating_mode == MODE_LOG)
-	{
-		syslog (LOG_WARNING, "network_create_socket: There is no point opening a socket when you are in mode `%s'.",
-				operating_mode == MODE_LOCAL ? "Local" : "Log");
-		return (-1);
-	}
+	sockent_t *se_head = NULL;
+	sockent_t *se_tail = NULL;
 
-	socklist_tail = socklist_head;
-	while ((socklist_tail != NULL) && (socklist_tail->next != NULL))
-		socklist_tail = socklist_tail->next;
+	DEBUG ("node = %s, service = %s", node, service);
 
 	memset (&ai_hints, '\0', sizeof (ai_hints));
 	ai_hints.ai_flags    = 0;
 #ifdef AI_PASSIVE
 	ai_hints.ai_flags |= AI_PASSIVE;
 #endif
 #ifdef AI_ADDRCONFIG
 	ai_hints.ai_flags |= AI_ADDRCONFIG;
 #endif
-	ai_hints.ai_family   = PF_UNSPEC;
+	ai_hints.ai_family   = AF_UNSPEC;
 	ai_hints.ai_socktype = SOCK_DGRAM;
 	ai_hints.ai_protocol = IPPROTO_UDP;
 
-	if ((ai_return = getaddrinfo (node, service, &ai_hints, &ai_list)) != 0)
+	ai_return = getaddrinfo (node, service, &ai_hints, &ai_list);
+	if (ai_return != 0)
 	{
-		syslog (LOG_ERR, "getaddrinfo (%s, %s): %s",
-				node == NULL ? "(null)" : node,
-				service == NULL ? "(null)" : service,
-				ai_return == EAI_SYSTEM ? strerror (errno) : gai_strerror (ai_return));
-		return (-1);
+		char errbuf[1024];
+		ERROR ("getaddrinfo (%s, %s): %s",
+				(node == NULL) ? "(null)" : node,
+				(service == NULL) ? "(null)" : service,
+				(ai_return == EAI_SYSTEM)
+				? sstrerror (errno, errbuf, sizeof (errbuf))
+				: gai_strerror (ai_return));
+		return (NULL);
 	}
 
 	for (ai_ptr = ai_list; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next)
 	{
 		sockent_t *se;
 
 		if ((se = (sockent_t *) malloc (sizeof (sockent_t))) == NULL)
 		{
-			syslog (LOG_EMERG, "malloc: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("malloc: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			continue;
 		}
 
 		if ((se->addr = (struct sockaddr_storage *) malloc (sizeof (struct sockaddr_storage))) == NULL)
 		{
-			syslog (LOG_EMERG, "malloc: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("malloc: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			free (se);
 			continue;
 		}
 
 		assert (sizeof (struct sockaddr_storage) >= ai_ptr->ai_addrlen);
 		memset (se->addr, '\0', sizeof (struct sockaddr_storage));
 		memcpy (se->addr, ai_ptr->ai_addr, ai_ptr->ai_addrlen);
 		se->addrlen = ai_ptr->ai_addrlen;
 
-		se->mode = operating_mode;
-		se->fd   = socket (ai_ptr->ai_family, ai_ptr->ai_socktype, ai_ptr->ai_protocol);
+		se->fd   = socket (ai_ptr->ai_family,
+				ai_ptr->ai_socktype,
+				ai_ptr->ai_protocol);
 		se->next = NULL;
 
 		if (se->fd == -1)
 		{
-			syslog (LOG_ERR, "socket: %s", strerror (errno));
+			char errbuf[1024];
+			ERROR ("socket: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			free (se->addr);
 			free (se);
 			continue;
 		}
 
-		if (operating_mode == MODE_SERVER)
+		if (listen != 0)
 		{
 			if (network_bind_socket (se, ai_ptr) != 0)
 			{
 				close (se->fd);
 				free (se->addr);
 				free (se);
 				continue;
 			}
 		}
-		else if (operating_mode == MODE_CLIENT)
+		else /* listen == 0 */
 		{
 			network_set_ttl (se, ai_ptr);
 		}
 
-		if (socklist_tail == NULL)
+		if (se_tail == NULL)
 		{
-			socklist_head = se;
-			socklist_tail = se;
+			se_head = se;
+			se_tail = se;
 		}
 		else
 		{
-			socklist_tail->next = se;
-			socklist_tail = se;
+			se_tail->next = se;
+			se_tail = se;
 		}
 
-		num_added++;
-
 		/* We don't open more than one write-socket per node/service pair.. */
-		if (operating_mode == MODE_CLIENT)
+		if (listen == 0)
 			break;
 	}
 
 	freeaddrinfo (ai_list);
 
-	return (num_added);
-}
+	return (se_head);
+} /* sockent_t *network_create_socket */
 
-static int network_connect_default (void)
+static sockent_t *network_create_default_socket (int listen)
 {
-	int ret;
+	sockent_t *se_ptr  = NULL;
+	sockent_t *se_head = NULL;
+	sockent_t *se_tail = NULL;
 
-	if (socklist_head != NULL)
-		return (0);
+	se_ptr = network_create_socket (NET_DEFAULT_V6_ADDR,
+			NET_DEFAULT_PORT, listen);
 
-	DBG ("socklist_head is NULL");
+	/* Don't send to the same machine in IPv6 and IPv4 if both are available. */
+	if ((listen == 0) && (se_ptr != NULL))
+		return (se_ptr);
 
-	ret = 0;
+	if (se_ptr != NULL)
+	{
+		se_head = se_ptr;
+		se_tail = se_ptr;
+		while (se_tail->next != NULL)
+			se_tail = se_tail->next;
+	}
 
-	if (network_create_socket (NET_DEFAULT_V6_ADDR, NET_DEFAULT_PORT) > 0)
-		ret++;
+	se_ptr = network_create_socket (NET_DEFAULT_V4_ADDR, NET_DEFAULT_PORT, listen);
 
-	/* Don't use IPv4 and IPv6 in parallel by default.. */
-	if ((operating_mode == MODE_CLIENT) && (ret != 0))
-		return (ret);
+	if (se_tail == NULL)
+		return (se_ptr);
 
-	if (network_create_socket (NET_DEFAULT_V4_ADDR, NET_DEFAULT_PORT) > 0)
-		ret++;
+	se_tail->next = se_ptr;
+	return (se_head);
+} /* sockent_t *network_create_default_socket */
 
-	if (ret == 0)
-		ret = -1;
+static int network_add_listen_socket (const char *node, const char *service)
+{
+	sockent_t *se;
+	sockent_t *se_ptr;
+	int se_num = 0;
 
-	return (ret);
-}
+	if (service == NULL)
+		service = NET_DEFAULT_PORT;
 
-static int network_get_listen_socket (void)
-{
-	int fd;
-	int max_fd;
-	int status;
+	if (node == NULL)
+		se = network_create_default_socket (1 /* listen == true */);
+	else
+		se = network_create_socket (node, service, 1 /* listen == true */);
+
+	if (se == NULL)
+		return (-1);
+
+	for (se_ptr = se; se_ptr != NULL; se_ptr = se_ptr->next)
+		se_num++;
+
+	listen_sockets = (struct pollfd *) realloc (listen_sockets,
+			(listen_sockets_num + se_num)
+			* sizeof (struct pollfd));
+
+	for (se_ptr = se; se_ptr != NULL; se_ptr = se_ptr->next)
+	{
+		listen_sockets[listen_sockets_num].fd = se_ptr->fd;
+		listen_sockets[listen_sockets_num].events = POLLIN | POLLPRI;
+		listen_sockets[listen_sockets_num].revents = 0;
+		listen_sockets_num++;
+	} /* for (se) */
 
-	fd_set readfds;
+	free_sockent (se);
+	return (0);
+} /* int network_add_listen_socket */
+
+static int network_add_sending_socket (const char *node, const char *service)
+{
 	sockent_t *se;
+	sockent_t *se_ptr;
 
-	if (socklist_head == NULL)
-		network_connect_default ();
+	if (service == NULL)
+		service = NET_DEFAULT_PORT;
 
-	FD_ZERO (&readfds);
-	max_fd = -1;
-	for (se = socklist_head; se != NULL; se = se->next)
-	{
-		if (se->mode != operating_mode)
-			continue;
+	if (node == NULL)
+		se = network_create_default_socket (0 /* listen == false */);
+	else
+		se = network_create_socket (node, service, 0 /* listen == false */);
 
-		FD_SET (se->fd, &readfds);
-		if (se->fd >= max_fd)
-			max_fd = se->fd + 1;
-	}
+	if (se == NULL)
+		return (-1);
 
-	if (max_fd == -1)
+	if (sending_sockets == NULL)
 	{
-		syslog (LOG_WARNING, "No listen sockets found!");
-		return (-1);
+		sending_sockets = se;
+		return (0);
 	}
 
-	status = select (max_fd, &readfds, NULL, NULL, NULL);
+	for (se_ptr = sending_sockets; se_ptr->next != NULL; se_ptr = se_ptr->next)
+		/* seek end */;
+
+	se_ptr->next = se;
+	return (0);
+} /* int network_get_listen_socket */
 
-	if (status == -1)
+int network_receive (void)
+{
+	char buffer[BUFF_SIZE];
+	int  buffer_len;
+
+	int i;
+	int status;
+
+	if (listen_sockets_num == 0)
+		network_add_listen_socket (NULL, NULL);
+
+	if (listen_sockets_num == 0)
 	{
-		if (errno != EINTR)
-			syslog (LOG_ERR, "select: %s", strerror (errno));
+		ERROR ("network: Failed to open a listening socket.");
 		return (-1);
 	}
 
-	fd = -1;
-	for (se = socklist_head; se != NULL; se = se->next)
+	while (listen_loop == 0)
 	{
-		if (se->mode != operating_mode)
-			continue;
+		status = poll (listen_sockets, listen_sockets_num, -1);
 
-		if (FD_ISSET (se->fd, &readfds))
+		if (status <= 0)
 		{
-			fd = se->fd;
-			break;
+			char errbuf[1024];
+			if (errno == EINTR)
+				continue;
+			ERROR ("poll failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
+			return (-1);
 		}
-	}
 
-	if (fd == -1)
-		syslog (LOG_WARNING, "No socket ready..?");
+		for (i = 0; (i < listen_sockets_num) && (status > 0); i++)
+		{
+			if ((listen_sockets[i].revents & (POLLIN | POLLPRI)) == 0)
+				continue;
+			status--;
 
-	DBG ("fd = %i", fd);
-	return (fd);
+			buffer_len = recv (listen_sockets[i].fd,
+					buffer, sizeof (buffer),
+					0 /* no flags */);
+			if (buffer_len < 0)
+			{
+				char errbuf[1024];
+				ERROR ("recv failed: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
+				return (-1);
+			}
+
+			parse_packet (buffer, buffer_len);
+		} /* for (listen_sockets) */
+	} /* while (listen_loop == 0) */
+
+	return (0);
 }
 
-int network_receive (char **host, char **type, char **inst, char **value)
+static void *receive_thread (void *arg)
 {
-	int fd;
-	char buffer[BUFF_SIZE];
+	return (network_receive () ? (void *) 1 : (void *) 0);
+} /* void *receive_thread */
 
-	struct sockaddr_storage addr;
-	socklen_t               addrlen;
+static void network_send_buffer (const char *buffer, int buffer_len)
+{
+	sockent_t *se;
 	int status;
 
-	char *fields[4];
-
-	assert (operating_mode == MODE_SERVER);
+	DEBUG ("network plugin: network_send_buffer: buffer_len = %i", buffer_len);
 
-	*host  = NULL;
-	*type  = NULL;
-	*inst  = NULL;
-	*value = NULL;
+	for (se = sending_sockets; se != NULL; se = se->next)
+	{
+		while (42)
+		{
+			status = sendto (se->fd, buffer, buffer_len, 0 /* no flags */,
+					(struct sockaddr *) se->addr, se->addrlen);
+			if (status < 0)
+			{
+				char errbuf[1024];
+				if (errno == EINTR)
+					continue;
+				ERROR ("network plugin: sendto failed: %s",
+						sstrerror (errno, errbuf,
+							sizeof (errbuf)));
+				break;
+			}
 
-	if ((fd = network_get_listen_socket ()) < 0)
-		return (-1);
+			break;
+		} /* while (42) */
+	} /* for (sending_sockets) */
+} /* void network_send_buffer */
+
+static int add_to_buffer (char *buffer, int buffer_size,
+		value_list_t *vl_def, char *type_def,
+		const data_set_t *ds, const value_list_t *vl)
+{
+	char *buffer_orig = buffer;
 
-	addrlen = sizeof (addr);
-	if (recvfrom (fd, buffer, BUFF_SIZE, 0, (struct sockaddr *) &addr, &addrlen) == -1)
+	if (strcmp (vl_def->host, vl->host) != 0)
 	{
-		syslog (LOG_ERR, "recvfrom: %s", strerror (errno));
-		return (-1);
+		if (write_part_string (&buffer, &buffer_size, TYPE_HOST,
+					vl->host, strlen (vl->host)) != 0)
+			return (-1);
+		strcpy (vl_def->host, vl->host);
+		DEBUG ("network plugin: add_to_buffer: host = %s", vl->host);
 	}
 
-	if ((*host = (char *) malloc (BUFF_SIZE)) == NULL)
+	if (vl_def->time != vl->time)
 	{
-		syslog (LOG_EMERG, "malloc: %s", strerror (errno));
-		return (-1);
+		if (write_part_number (&buffer, &buffer_size, TYPE_TIME,
+					(uint64_t) vl->time))
+			return (-1);
+		vl_def->time = vl->time;
+		DEBUG ("network plugin: add_to_buffer: time = %u",
+				(unsigned int) vl->time);
 	}
 
-	status = getnameinfo ((struct sockaddr *) &addr, addrlen,
-			*host, BUFF_SIZE, NULL, 0, 0);
-	if (status != 0)
+	if (strcmp (vl_def->plugin, vl->plugin) != 0)
 	{
-		free (*host); *host = NULL;
-		syslog (LOG_ERR, "getnameinfo: %s",
-				status == EAI_SYSTEM ? strerror (errno) : gai_strerror (status));
-		return (-1);
+		if (write_part_string (&buffer, &buffer_size, TYPE_PLUGIN,
+					vl->plugin, strlen (vl->plugin)) != 0)
+			return (-1);
+		strcpy (vl_def->plugin, vl->plugin);
+		DEBUG ("network plugin: add_to_buffer: plugin = %s",
+				vl->plugin);
 	}
 
-	if (strsplit (buffer, fields, 4) != 3)
+	if (strcmp (vl_def->plugin_instance, vl->plugin_instance) != 0)
 	{
-		syslog (LOG_WARNING, "Invalid message from `%s'", *host);
-		free (*host); *host = NULL;
-		return (1);
+		if (write_part_string (&buffer, &buffer_size, TYPE_PLUGIN_INSTANCE,
+					vl->plugin_instance,
+					strlen (vl->plugin_instance)) != 0)
+			return (-1);
+		strcpy (vl_def->plugin_instance, vl->plugin_instance);
+		DEBUG ("network plugin: add_to_buffer: plugin_instance = %s",
+				vl->plugin_instance);
 	}
 
-	if ((*type = strdup (fields[0])) == NULL)
+	if (strcmp (type_def, ds->type) != 0)
 	{
-		syslog (LOG_EMERG, "strdup: %s", strerror (errno));
-		free (*host); *host = NULL;
-		return (-1);
+		if (write_part_string (&buffer, &buffer_size, TYPE_TYPE,
+					ds->type, strlen (ds->type)) != 0)
+			return (-1);
+		strcpy (type_def, ds->type);
+		DEBUG ("network plugin: add_to_buffer: type = %s", ds->type);
 	}
 
-	if ((*inst = strdup (fields[1])) == NULL)
+	if (strcmp (vl_def->type_instance, vl->type_instance) != 0)
 	{
-		syslog (LOG_EMERG, "strdup: %s", strerror (errno));
-		free (*host); *host = NULL;
-		free (*type); *type = NULL;
+		if (write_part_string (&buffer, &buffer_size, TYPE_TYPE_INSTANCE,
+					vl->type_instance,
+					strlen (vl->type_instance)) != 0)
+			return (-1);
+		strcpy (vl_def->type_instance, vl->type_instance);
+		DEBUG ("network plugin: add_to_buffer: type_instance = %s",
+				vl->type_instance);
+	}
+	
+	if (write_part_values (&buffer, &buffer_size, ds, vl) != 0)
 		return (-1);
+
+	return (buffer - buffer_orig);
+} /* int add_to_buffer */
+
+static void flush_buffer (void)
+{
+	DEBUG ("network plugin: flush_buffer: send_buffer_fill = %i",
+			send_buffer_fill);
+
+	network_send_buffer (send_buffer, send_buffer_fill);
+	send_buffer_ptr  = send_buffer;
+	send_buffer_fill = 0;
+	memset (&send_buffer_vl, '\0', sizeof (send_buffer_vl));
+	memset (send_buffer_type, '\0', sizeof (send_buffer_type));
+}
+
+static int network_write (const data_set_t *ds, const value_list_t *vl)
+{
+	int status;
+
+	/* If the value is already in the cache, we have received it via the
+	 * network. We write it again if forwarding is activated. It's then in
+	 * the cache and should we receive it again we will ignore it. */
+	status = cache_check (ds->type, vl);
+	if ((network_config_forward == 0)
+			&& (status != 0))
+		return (0);
+
+	pthread_mutex_lock (&send_buffer_lock);
+
+	status = add_to_buffer (send_buffer_ptr,
+			sizeof (send_buffer) - send_buffer_fill,
+			&send_buffer_vl, send_buffer_type,
+			ds, vl);
+	if (status >= 0)
+	{
+		/* status == bytes added to the buffer */
+		send_buffer_fill += status;
+		send_buffer_ptr  += status;
+	}
+	else
+	{
+		flush_buffer ();
+
+		status = add_to_buffer (send_buffer_ptr,
+				sizeof (send_buffer) - send_buffer_fill,
+				&send_buffer_vl, send_buffer_type,
+				ds, vl);
+
+		if (status >= 0)
+		{
+			send_buffer_fill += status;
+			send_buffer_ptr  += status;
+		}
 	}
 
-	if ((*value = strdup (fields[2])) == NULL)
+	if (status < 0)
 	{
-		syslog (LOG_EMERG, "strdup: %s", strerror (errno));
-		free (*host); *host = NULL;
-		free (*type); *type = NULL;
-		free (*inst); *inst = NULL;
-		return (-1);
+		ERROR ("network plugin: Unable to append to the "
+				"buffer for some weird reason");
+	}
+	else if ((sizeof (send_buffer) - send_buffer_fill) < 15)
+	{
+		flush_buffer ();
 	}
 
-	DBG ("host = %s, type = %s, inst = %s, value = %s",
-			*host, *type, *inst, *value);
+	pthread_mutex_unlock (&send_buffer_lock);
 
-	return (0);
-}
+	return ((status < 0) ? -1 : 0);
+} /* int network_write */
 
-int network_send (char *type, char *inst, char *value)
+static int network_config (const char *key, const char *val)
 {
-	char buf[BUFF_SIZE];
-	int buflen;
+	char *node;
+	char *service;
 
-	sockent_t *se;
+	char *fields[3];
+	int   fields_num;
 
-	int ret;
-	int status;
+	if ((strcasecmp ("Listen", key) == 0)
+			|| (strcasecmp ("Server", key) == 0))
+	{
+		char *val_cpy = strdup (val);
+		if (val_cpy == NULL)
+			return (1);
+
+		service = NET_DEFAULT_PORT;
+		fields_num = strsplit (val_cpy, fields, 3);
+		if ((fields_num != 1)
+				&& (fields_num != 2))
+			return (1);
+		else if (fields_num == 2)
+			service = fields[1];
+		node = fields[0];
 
-	DBG ("type = %s, inst = %s, value = %s", type, inst, value);
+		if (strcasecmp ("Listen", key) == 0)
+			network_add_listen_socket (node, service);
+		else
+			network_add_sending_socket (node, service);
+	}
+	else if (strcasecmp ("TimeToLive", key) == 0)
+	{
+		int tmp = atoi (val);
+		if ((tmp > 0) && (tmp < 256))
+			network_config_ttl = tmp;
+		else
+			return (1);
+	}
+	else if (strcasecmp ("Forward", key) == 0)
+	{
+		if ((strcasecmp ("true", val) == 0)
+				|| (strcasecmp ("yes", val) == 0)
+				|| (strcasecmp ("on", val) == 0))
+			network_config_forward = 1;
+		else
+			network_config_forward = 0;
+	}
+	else if (strcasecmp ("CacheFlush", key) == 0)
+	{
+		int tmp = atoi (val);
+		if (tmp > 0)
+			cache_flush_interval = tmp;
+		else return (1);
+	}
+	else
+	{
+		return (-1);
+	}
+	return (0);
+} /* int network_config */
+
+static int network_shutdown (void)
+{
+	DEBUG ("Shutting down.");
 
-	assert (operating_mode == MODE_CLIENT);
+	listen_loop++;
 
-	buflen = snprintf (buf, BUFF_SIZE, "%s %s %s", type, inst, value);
-	if ((buflen >= BUFF_SIZE) || (buflen < 1))
+	if (listen_thread != (pthread_t) 0)
 	{
-		syslog (LOG_WARNING, "network_send: snprintf failed..");
-		return (-1);
+		pthread_kill (listen_thread, SIGTERM);
+		pthread_join (listen_thread, NULL /* no return value */);
+		listen_thread = (pthread_t) 0;
 	}
-	buf[buflen] = '\0';
-	buflen++;
 
-	if (socklist_head == NULL)
-		network_connect_default ();
+	listen_thread = 0;
 
-	ret = 0;
-	for (se = socklist_head; se != NULL; se = se->next)
+	if (cache_tree != NULL)
 	{
-		if (se->mode != operating_mode)
-			continue;
+		void *key;
+		void *value;
 
-		while (1)
+		while (avl_pick (cache_tree, &key, &value) == 0)
 		{
-			status = sendto (se->fd, buf, buflen, 0,
-					(struct sockaddr *) se->addr, se->addrlen);
-
-			if (status == -1)
-			{
-				if (errno == EINTR)
-				{
-					DBG ("sendto was interrupted");
-					continue;
-				}
-				else
-				{
-					syslog (LOG_ERR, "sendto: %s", strerror (errno));
-					ret = -1;
-					break;
-				}
-			}
-			else if (ret >= 0)
-				ret++;
-			break;
+			sfree (key);
+			sfree (value);
 		}
+		avl_destroy (cache_tree);
+		cache_tree = NULL;
 	}
 
-	if (ret == 0)
-		syslog (LOG_WARNING, "Message wasn't sent to anybody..");
+	/* TODO: Close `sending_sockets' */
 
-	return (ret);
-}
+	plugin_unregister_config ("network");
+	plugin_unregister_init ("network");
+	plugin_unregister_write ("network");
+	plugin_unregister_shutdown ("network");
+
+	return (0);
+} /* int network_shutdown */
+
+static int network_init (void)
+{
+	plugin_register_shutdown ("network", network_shutdown);
+
+	send_buffer_ptr  = send_buffer;
+	send_buffer_fill = 0;
+	memset (&send_buffer_vl, '\0', sizeof (send_buffer_vl));
+	memset (send_buffer_type, '\0', sizeof (send_buffer_type));
+
+	cache_tree = avl_create ((int (*) (const void *, const void *)) strcmp);
+	cache_flush_last = time (NULL);
+
+	/* setup socket(s) and so on */
+	if (sending_sockets != NULL)
+		plugin_register_write ("network", network_write);
+
+	if ((listen_sockets_num != 0) && (listen_thread == 0))
+	{
+		int status;
+
+		status = pthread_create (&listen_thread, NULL /* no attributes */,
+				receive_thread, NULL /* no argument */);
+
+		if (status != 0)
+		{
+			char errbuf[1024];
+			ERROR ("network: pthread_create failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
+		}
+	}
+	return (0);
+} /* int network_init */
+
+void module_register (void)
+{
+	plugin_register_config ("network", network_config,
+			config_keys, config_keys_num);
+	plugin_register_init   ("network", network_init);
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/network.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/network.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/network.h	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/network.h	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/network.h
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -52,11 +51,15 @@
  */
 
 #define NET_DEFAULT_V4_ADDR "239.192.74.66"
 #define NET_DEFAULT_V6_ADDR "ff18::efc0:4a42"
 #define NET_DEFAULT_PORT    "25826"
 
-int network_create_socket (const char *node, const char *service);
-int network_receive (char **host, char **type, char **instance, char **value);
-int network_send (char *type, char *instance, char *value);
+#define TYPE_HOST            0x0000
+#define TYPE_TIME            0x0001
+#define TYPE_PLUGIN          0x0002
+#define TYPE_PLUGIN_INSTANCE 0x0003
+#define TYPE_TYPE            0x0004
+#define TYPE_TYPE_INSTANCE   0x0005
+#define TYPE_VALUES          0x0006
 
 #endif /* NETWORK_H */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/nfs.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/nfs.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/nfs.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/nfs.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/nfs.c
  * Copyright (C) 2005,2006  Jason Pepas
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -22,24 +21,19 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#define MODULE_NAME "nfs"
-
 /* #if defined(KERNEL_LINUX) || defined(HAVE_LIBKSTAT) */
 #if KERNEL_LINUX
 # define NFS_HAVE_READ 1
 #else
 # define NFS_HAVE_READ 0
 #endif
 
-static char *nfs2_procedures_file  = "nfs2_procedures-%s.rrd";
-static char *nfs3_procedures_file  = "nfs3_procedures-%s.rrd";
-
 /*
 see /proc/net/rpc/nfs
 see http://www.missioncriticallinux.com/orph/NFS-Statistics
 
 net x x x x
 rpc_stat.netcnt         Not used; always zero.
@@ -79,63 +73,64 @@
 18                      fsstat
 19                      fsinfo
 20                      pathconf
 21                      commit
 */
 
-static char *nfs2_procedures_ds_def[] =
+#if NFS_HAVE_READ
+static const char *nfs2_procedures_names[] =
 {
-	"DS:null:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:getattr:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:setattr:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:root:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:lookup:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:readlink:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:read:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wrcache:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:write:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:create:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:remove:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rename:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:link:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:symlink:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:mkdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rmdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:readdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:fsstat:COUNTER:"COLLECTD_HEARTBEAT":0:U",
+	"null",
+	"getattr",
+	"setattr",
+	"root",
+	"lookup",
+	"readlink",
+	"read",
+	"wrcache",
+	"write",
+	"create",
+	"remove",
+	"rename",
+	"link",
+	"symlink",
+	"mkdir",
+	"rmdir",
+	"readdir",
+	"fsstat",
 	NULL
 };
-static int nfs2_procedures_ds_num = 18;
+static int nfs2_procedures_names_num = 18;
 
-static char *nfs3_procedures_ds_def[] =
+static const char *nfs3_procedures_names[] =
 {
-	"DS:null:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:getattr:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:setattr:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:lookup:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:access:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:readlink:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:read:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:write:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:create:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:mkdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:symlink:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:mknod:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:remove:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rmdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rename:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:link:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:readdir:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:readdirplus:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:fsstat:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:fsinfo:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:pathconf:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:commit:COUNTER:"COLLECTD_HEARTBEAT":0:U",
+	"null",
+	"getattr",
+	"setattr",
+	"lookup",
+	"access",
+	"readlink",
+	"read",
+	"write",
+	"create",
+	"mkdir",
+	"symlink",
+	"mknod",
+	"remove",
+	"rmdir",
+	"rename",
+	"link",
+	"readdir",
+	"readdirplus",
+	"fsstat",
+	"fsinfo",
+	"pathconf",
+	"commit",
 	NULL
 };
-static int nfs3_procedures_ds_num = 22;
+static int nfs3_procedures_names_num = 22;
 
 #if HAVE_LIBKSTAT && 0
 extern kstat_ctl_t *kc;
 static kstat_t *nfs2_ksp_client;
 static kstat_t *nfs2_ksp_server;
 static kstat_t *nfs3_ksp_client;
@@ -143,13 +138,14 @@
 static kstat_t *nfs4_ksp_client;
 static kstat_t *nfs4_ksp_server;
 #endif
 
 /* Possibly TODO: NFSv4 statistics */
 
-static void nfs_init (void)
+#if 0
+static int nfs_init (void)
 {
 #if HAVE_LIBKSTAT && 0
 	kstat_t *ksp_chain;
 
 	nfs2_ksp_client = NULL;
 	nfs2_ksp_server = NULL;
@@ -178,158 +174,142 @@
 			nfs3_ksp_client = ksp_chain;
 		else if (strncmp (ksp_chain->ks_name, "rfsreqcnt_v4", 12) == 0)
 			nfs4_ksp_client = ksp_chain;
 	}
 #endif
 
-	return;
-}
+	return (0);
+} /* int nfs_init */
+#endif
 
 #define BUFSIZE 1024
-static void nfs2_procedures_write (char *host, char *inst, char *val)
-{
-	char filename[BUFSIZE];
-
-	if (snprintf (filename, BUFSIZE, nfs2_procedures_file, inst) > BUFSIZE)
-		return;
-
-	rrd_update_file (host, filename, val, nfs2_procedures_ds_def,
-			nfs2_procedures_ds_num);
-}
-
-static void nfs3_procedures_write (char *host, char *inst, char *val)
-{
-	char filename[BUFSIZE];
-
-	if (snprintf (filename, BUFSIZE, nfs3_procedures_file, inst) > BUFSIZE)
-		return;
-
-	rrd_update_file (host, filename, val, nfs3_procedures_ds_def,
-			nfs3_procedures_ds_num);
-}
-
-#if NFS_HAVE_READ
-static void nfs2_procedures_submit (unsigned long long *val, char *inst)
+static void nfs_procedures_submit (const char *plugin_instance,
+	       	unsigned long long *val, const char **names, int len)
 {
-	char buf[BUFSIZE];
-	int retval = 0;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
+	int i;
+
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "nfs");
+	strncpy (vl.plugin_instance, plugin_instance,
+		       	sizeof (vl.plugin_instance));
 
-	retval = snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%llu:%llu:"
-			"%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu:"
-			"%llu:%llu:%llu", /* 18x %llu */
-			(unsigned int) curtime,
-			val[0], val[1], val[2], val[3], val[4], val[5], val[6],
-			val[7], val[8], val[9], val[10], val[11], val[12],
-			val[13], val[14], val[15], val[16], val[17]);
-
-
-	if (retval >= BUFSIZE)
-		return;
-	else if (retval < 0)
+	for (i = 0; i < len; i++)
 	{
-		syslog (LOG_ERR, "nfs: snprintf's format failed: %s", strerror (errno));
-		return;
+		values[0].counter = val[i];
+		strncpy (vl.type_instance, names[i],
+				sizeof (vl.type_instance));
+		DEBUG ("%s-%s/nfs_procedure-%s = %llu",
+				vl.plugin, vl.plugin_instance,
+				vl.type_instance, val[i]);
+		plugin_dispatch_values ("nfs_procedure", &vl);
 	}
-
-	plugin_submit ("nfs2_procedures", inst, buf);
-}
-
-static void nfs3_procedures_submit (unsigned long long *val, char *inst)
-{
-	char buf[BUFSIZE];
-	int retval = 0;
-
-	retval = snprintf(buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%llu:%llu:"
-			"%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu:"
-			"%llu:%llu:%llu:%llu:%llu:%llu:%llu", /* 22x %llu */
-			(unsigned int) curtime,
-			val[0], val[1], val[2], val[3], val[4], val[5], val[6],
-			val[7], val[8], val[9], val[10], val[11], val[12],
-			val[13], val[14], val[15], val[16], val[17], val[18],
-			val[19], val[20], val[21]);
-
-	if (retval >= BUFSIZE)
-		return;
-	else if (retval < 0)
-	{
-		syslog (LOG_ERR, "nfs: snprintf's format failed: %s", strerror (errno));
-		return;
-	}
-
-	plugin_submit("nfs3_procedures", inst, buf);
-}
-#endif /* NFS_HAVE_READ */
+} /* void nfs_procedures_submit */
 
 #if KERNEL_LINUX
 static void nfs_read_stats_file (FILE *fh, char *inst)
 {
 	char buffer[BUFSIZE];
 
+	char plugin_instance[DATA_MAX_NAME_LEN];
+
 	char *fields[48];
 	int numfields = 0;
 
 	if (fh == NULL)
 		return;
 
 	while (fgets (buffer, BUFSIZE, fh) != NULL)
 	{
 		numfields = strsplit (buffer, fields, 48);
 
-		if (numfields < 2)
+		if (((numfields - 2) != nfs2_procedures_names_num)
+				&& ((numfields - 2)
+				       	!= nfs3_procedures_names_num))
 			continue;
 
-		if (strncmp (fields[0], "proc2", 5) == 0)
+		if (strcmp (fields[0], "proc2") == 0)
 		{
 			int i;
 			unsigned long long *values;
 
-			if (numfields - 2 != nfs2_procedures_ds_num)
+			if ((numfields - 2) != nfs2_procedures_names_num)
 			{
-				syslog (LOG_WARNING, "nfs: Wrong number of fields (= %i) for NFS2 statistics.", numfields - 2);
+				WARNING ("nfs plugin: Wrong "
+						"number of fields (= %i) "
+						"for NFSv2 statistics.",
+					       	numfields - 2);
 				continue;
 			}
 
-			if ((values = (unsigned long long *) malloc (nfs2_procedures_ds_num * sizeof (unsigned long long))) == NULL)
+			snprintf (plugin_instance, sizeof (plugin_instance),
+					"v2%s", inst);
+			plugin_instance[DATA_MAX_NAME_LEN - 1] = '\0';
+
+			values = (unsigned long long *) malloc (nfs2_procedures_names_num * sizeof (unsigned long long));
+			if (values == NULL)
 			{
-				syslog (LOG_ERR, "nfs: malloc: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("nfs plugin: malloc "
+						"failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 				continue;
 			}
 
-			for (i = 0; i < nfs2_procedures_ds_num; i++)
+			for (i = 0; i < nfs2_procedures_names_num; i++)
 				values[i] = atoll (fields[i + 2]);
 
-			nfs2_procedures_submit (values, inst);
+			nfs_procedures_submit (plugin_instance, values,
+					nfs2_procedures_names,
+					nfs2_procedures_names_num);
 
 			free (values);
 		}
 		else if (strncmp (fields[0], "proc3", 5) == 0)
 		{
 			int i;
 			unsigned long long *values;
 
-			if (numfields - 2 != nfs3_procedures_ds_num)
+			if ((numfields - 2) != nfs3_procedures_names_num)
 			{
-				syslog (LOG_WARNING, "nfs: Wrong number of fields (= %i) for NFS3 statistics.", numfields - 2);
+				WARNING ("nfs plugin: Wrong "
+						"number of fields (= %i) "
+						"for NFSv3 statistics.",
+					       	numfields - 2);
 				continue;
 			}
 
-			if ((values = (unsigned long long *) malloc (nfs3_procedures_ds_num * sizeof (unsigned long long))) == NULL)
+			snprintf (plugin_instance, sizeof (plugin_instance),
+					"v3%s", inst);
+			plugin_instance[DATA_MAX_NAME_LEN - 1] = '\0';
+
+			values = (unsigned long long *) malloc (nfs3_procedures_names_num * sizeof (unsigned long long));
+			if (values == NULL)
 			{
-				syslog (LOG_ERR, "nfs: malloc: %s", strerror (errno));
+				char errbuf[1024];
+				ERROR ("nfs plugin: malloc "
+						"failed: %s",
+						sstrerror (errno, errbuf, sizeof (errbuf)));
 				continue;
 			}
 
-			for (i = 0; i < nfs3_procedures_ds_num; i++)
+			for (i = 0; i < nfs3_procedures_names_num; i++)
 				values[i] = atoll (fields[i + 2]);
 
-			nfs3_procedures_submit (values, inst);
+			nfs_procedures_submit (plugin_instance, values,
+					nfs3_procedures_names,
+					nfs3_procedures_names_num);
 
 			free (values);
 		}
-	}
-}
+	} /* while (fgets (buffer, BUFSIZE, fh) != NULL) */
+} /* void nfs_read_stats_file */
 #endif /* defined(KERNEL_LINUX) */
 #undef BUFSIZE
 
 #if HAVE_LIBKSTAT && 0
 static void nfs2_read_kstat (kstat_t *ksp, char *inst)
 {
@@ -355,14 +335,13 @@
 	values[17] = get_kstat_value (ksp, "statfs");
 
 	nfs2_procedures_submit (values, inst);
 }
 #endif
 
-#if NFS_HAVE_READ
-static void nfs_read (void)
+static int nfs_read (void)
 {
 #if KERNEL_LINUX
 	FILE *fh;
 
 	if ((fh = fopen ("/proc/net/rpc/nfs", "r")) != NULL)
 	{
@@ -381,19 +360,17 @@
 #elif HAVE_LIBKSTAT && 0
 	if (nfs2_ksp_client != NULL)
 		nfs2_read_kstat (nfs2_ksp_client, "client");
 	if (nfs2_ksp_server != NULL)
 		nfs2_read_kstat (nfs2_ksp_server, "server");
 #endif /* defined(HAVE_LIBKSTAT) */
+
+	return (0);
 }
-#else
-# define nfs_read NULL
 #endif /* NFS_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, nfs_init, nfs_read, NULL);
-	plugin_register ("nfs2_procedures", NULL, NULL, nfs2_procedures_write);
-	plugin_register ("nfs3_procedures", NULL, NULL, nfs3_procedures_write);
-}
-
-#undef MODULE_NAME
+#if NFS_HAVE_READ
+	plugin_register_read ("nfs", nfs_read);
+#endif
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/ntpd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/ntpd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/ntpd.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/ntpd.c	2007-05-31 23:33:12.000000000 +0800
@@ -1,9 +1,9 @@
 /**
  * collectd - src/ntpd.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
  * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
@@ -20,15 +20,12 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "ntpd"
 
 #if HAVE_SYS_SOCKET_H
 # define NTPD_HAVE_READ 1
 #else
 # define NTPD_HAVE_READ 0
 #endif
@@ -48,52 +45,30 @@
 #if HAVE_ARPA_INET_H
 # include <arpa/inet.h> /* inet_ntoa */
 #endif
 #if HAVE_NETINET_TCP_H
 # include <netinet/tcp.h>
 #endif
-#if HAVE_SYS_POLL_H
-# include <sys/poll.h>
+#if HAVE_POLL_H
+# include <poll.h>
 #endif
 
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Host",
 	"Port",
 	NULL
 };
 static int config_keys_num = 2;
 
-/* drift */
-static char *time_offset_file     = "ntpd/time_offset-%s.rrd";
-static char *time_dispersion_file = "ntpd/time_dispersion-%s.rrd";
-static char *time_delay_file      = "ntpd/delay-%s.rrd";
-
-/* used for `time_offset', `time_dispersion', and `delay' */
-static char *sec_ds_def[] =
-{
-	"DS:seconds:GAUGE:"COLLECTD_HEARTBEAT":-1000000:1000000",
-	NULL
-};
-static int sec_ds_num = 1;
-
-static char *frequency_offset_file = "ntpd/frequency_offset-%s.rrd";
-static char *frequency_offset_ds_def[] =
-{
-	"DS:ppm:GAUGE:"COLLECTD_HEARTBEAT":-1000000:1000000",
-	NULL
-};
-static int frequency_offset_ds_num = 1;
-
 #if NTPD_HAVE_READ
 # define NTPD_DEFAULT_HOST "localhost"
 # define NTPD_DEFAULT_PORT "123"
 static int   sock_descr = -1;
 static char *ntpd_host = NULL;
 static char *ntpd_port = NULL;
-#endif
 
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  * The following definitions were copied from the NTPd distribution  *
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 #define MAXFILENAME 128
 #define MAXSEQ  127
@@ -283,13 +258,13 @@
 };
 static int refclock_names_num = 45;
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  * End of the copied stuff..                                         *
  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 
-static int ntpd_config (char *key, char *value)
+static int ntpd_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "host") == 0)
 	{
 		if (ntpd_host != NULL)
 			free (ntpd_host);
 		if ((ntpd_host = strdup (value)) == NULL)
@@ -307,70 +282,28 @@
 		return (-1);
 	}
 
 	return (0);
 }
 
-static void ntpd_init (void)
-{
-	return;
-}
-
-static void ntpd_write_sec (char *host, char *inst, char *val, char *file)
-{
-	char buf[256];
-	int  status;
-
-	status = snprintf (buf, 256, file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	rrd_update_file (host, buf, val,
-			sec_ds_def, sec_ds_num);
-}
-
-static void ntpd_write_time_offset (char *host, char *inst, char *val)
-{
-	ntpd_write_sec (host, inst, val, time_offset_file);
-}
-
-static void ntpd_write_time_dispersion (char *host, char *inst, char *val)
-{
-	ntpd_write_sec (host, inst, val, time_dispersion_file);
-}
-
-static void ntpd_write_delay (char *host, char *inst, char *val)
-{
-	ntpd_write_sec (host, inst, val, time_delay_file);
-}
-
-static void ntpd_write_frequency_offset (char *host, char *inst, char *val)
-{
-	char buf[256];
-	int  status;
-
-	status = snprintf (buf, 256, frequency_offset_file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	rrd_update_file (host, buf, val,
-			frequency_offset_ds_def, frequency_offset_ds_num);
-}
-
-#if NTPD_HAVE_READ
-static void ntpd_submit (char *type, char *inst, double value)
+static void ntpd_submit (char *type, char *type_inst, double value)
 {
-	char buf[256];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, 256, "%u:%.8f", (unsigned int) curtime, value) >= 256)
-		return;
+	values[0].gauge = value;
 
-	DBG ("type = %s; inst = %s; value = %s;",
-			type, inst, buf);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "ntpd");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, type_inst, sizeof (vl.type_instance));
 
-	plugin_submit (type, inst, buf);
+	plugin_dispatch_values (type, &vl);
 }
 
 /* returns `tv0 - tv1' in milliseconds or 0 if `tv1 > tv0' */
 static int timeval_sub (const struct timeval *tv0, const struct timeval *tv1)
 {
 	int sec;
@@ -405,13 +338,13 @@
 	struct addrinfo *ai_ptr;
 	int              status;
 
 	if (sock_descr >= 0)
 		return (sock_descr);
 
-	DBG ("Opening a new socket");
+	DEBUG ("Opening a new socket");
 
 	host = ntpd_host;
 	if (host == NULL)
 		host = NTPD_DEFAULT_HOST;
 
 	port = ntpd_port;
@@ -423,18 +356,18 @@
 	ai_hints.ai_family   = PF_UNSPEC;
 	ai_hints.ai_socktype = SOCK_DGRAM;
 	ai_hints.ai_protocol = IPPROTO_UDP;
 
 	if ((status = getaddrinfo (host, port, &ai_hints, &ai_list)) != 0)
 	{
-		DBG ("getaddrinfo (%s, %s): %s",
-				host, port,
-				status == EAI_SYSTEM ? strerror (errno) : gai_strerror (status));
-		syslog (LOG_ERR, "ntpd plugin: getaddrinfo (%s, %s): %s",
+		char errbuf[1024];
+		ERROR ("ntpd plugin: getaddrinfo (%s, %s): %s",
 				host, port,
-				status == EAI_SYSTEM ? strerror (errno) : gai_strerror (status));
+				(status == EAI_SYSTEM)
+				? sstrerror (errno, errbuf, sizeof (errbuf))
+				: gai_strerror (status));
 		return (-1);
 	}
 
 	for (ai_ptr = ai_list; ai_ptr != NULL; ai_ptr = ai_ptr->ai_next)
 	{
 		/* create our socket descriptor */
@@ -455,14 +388,14 @@
 	}
 
 	freeaddrinfo (ai_list);
 
 	if (sock_descr < 0)
 	{
-		DBG ("Unable to connect to server.");
-		syslog (LOG_ERR, "ntpd plugin: Unable to connect to server.");
+		DEBUG ("Unable to connect to server.");
+		ERROR ("ntpd plugin: Unable to connect to server.");
 	}
 
 	return (sock_descr);
 }
 
 /* For a description of the arguments see `ntpd_do_query' below. */
@@ -504,157 +437,161 @@
 	*res_items = 0;
 	*res_size  = 0;
 	*res_data  = NULL;
 
 	if (gettimeofday (&time_end, NULL) < 0)
 	{
-		syslog (LOG_ERR, "ntpd plugin: gettimeofday failed: %s",
-				strerror (errno));
+		char errbuf[1024];
+		ERROR ("ntpd plugin: gettimeofday failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 	time_end.tv_sec++; /* wait for a most one second */
 
 	done = 0;
 	while (done == 0)
 	{
 		if (gettimeofday (&time_now, NULL) < 0)
 		{
-			syslog (LOG_ERR, "ntpd plugin: gettimeofday failed: %s",
-					strerror (errno));
+			char errbuf[1024];
+			ERROR ("ntpd plugin: gettimeofday failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			return (-1);
 		}
 
 		/* timeout reached */
 		if ((timeout = timeval_sub (&time_end, &time_now)) == 0)
 			break;
 
 		poll_s.fd      = sd;
 		poll_s.events  = POLLIN | POLLPRI;
 		poll_s.revents = 0;
 		
-		DBG ("Polling for %ims", timeout);
+		DEBUG ("Polling for %ims", timeout);
 		status = poll (&poll_s, 1, timeout);
 
 		if ((status < 0) && ((errno == EAGAIN) || (errno == EINTR)))
 			continue;
 
 		if (status < 0)
 		{
-			DBG ("poll failed: %s", strerror (errno));
-			syslog (LOG_ERR, "ntpd plugin: poll failed: %s",
-					strerror (errno));
+			char errbuf[1024];
+			ERROR ("ntpd plugin: poll failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			return (-1);
 		}
 
 		if (status == 0) /* timeout */
 		{
-			DBG ("timeout reached.");
+			DEBUG ("timeout reached.");
 			break;
 		}
 
 		memset ((void *) &res, '\0', sizeof (res));
 		status = recv (sd, (void *) &res, sizeof (res), 0 /* no flags */);
 
 		if ((status < 0) && ((errno == EAGAIN) || (errno == EINTR)))
 			continue;
 
 		if (status < 0)
 		{
-			DBG ("recv(2) failed: %s", strerror (errno));
-			DBG ("Closing socket #%i", sd);
+			char errbuf[1024];
+			DEBUG ("recv(2) failed: %s",
+					sstrerror (errno, errbuf, sizeof (errbuf)));
+			DEBUG ("Closing socket #%i", sd);
 			close (sd);
 			sock_descr = sd = -1;
 			return (-1);
 		}
 
-		DBG ("recv'd %i bytes", status);
+		DEBUG ("recv'd %i bytes", status);
 
 		/* 
 		 * Do some sanity checks first
 		 */
 		if (status < RESP_HEADER_SIZE)
 		{
-			syslog (LOG_WARNING, "ntpd plugin: Short (%i bytes) packet received",
+			WARNING ("ntpd plugin: Short (%i bytes) packet received",
 					(int) status);
 			continue;
 		}
 		if (INFO_MODE (res.rm_vn_mode) != MODE_PRIVATE)
 		{
-			syslog (LOG_NOTICE, "ntpd plugin: Packet received with mode %i",
+			NOTICE ("ntpd plugin: Packet received with mode %i",
 					INFO_MODE (res.rm_vn_mode));
 			continue;
 		}
 		if (INFO_IS_AUTH (res.auth_seq))
 		{
-			syslog (LOG_NOTICE, "ntpd plugin: Encrypted packet received");
+			NOTICE ("ntpd plugin: Encrypted packet received");
 			continue;
 		}
 		if (!ISRESPONSE (res.rm_vn_mode))
 		{
-			syslog (LOG_NOTICE, "ntpd plugin: Received request packet, "
+			NOTICE ("ntpd plugin: Received request packet, "
 					"wanted response");
 			continue;
 		}
 		if (INFO_MBZ (res.mbz_itemsize))
 		{
-			syslog (LOG_WARNING, "ntpd plugin: Received packet with nonzero "
+			WARNING ("ntpd plugin: Received packet with nonzero "
 					"MBZ field!");
 			continue;
 		}
 		if (res.implementation != IMPL_XNTPD)
 		{
-			syslog (LOG_WARNING, "ntpd plugin: Asked for request of type %i, "
+			WARNING ("ntpd plugin: Asked for request of type %i, "
 					"got %i", (int) IMPL_XNTPD, (int) res.implementation);
 			continue;
 		}
 
 		/* Check for error code */
 		if (INFO_ERR (res.err_nitems) != 0)
 		{
-			syslog (LOG_ERR, "ntpd plugin: Received error code %i",
+			ERROR ("ntpd plugin: Received error code %i",
 					(int) INFO_ERR(res.err_nitems));
 			return ((int) INFO_ERR (res.err_nitems));
 		}
 
 		/* extract number of items in this packet and the size of these items */
 		pkt_item_num = INFO_NITEMS (res.err_nitems);
 		pkt_item_len = INFO_ITEMSIZE (res.mbz_itemsize);
-		DBG ("pkt_item_num = %i; pkt_item_len = %i;",
+		DEBUG ("pkt_item_num = %i; pkt_item_len = %i;",
 				pkt_item_num, pkt_item_len);
 
 		/* Check if the reported items fit in the packet */
 		if ((pkt_item_num * pkt_item_len) > (status - RESP_HEADER_SIZE))
 		{
-			syslog (LOG_ERR, "ntpd plugin: %i items * %i bytes > "
+			ERROR ("ntpd plugin: %i items * %i bytes > "
 					"%i bytes - %i bytes header",
 					(int) pkt_item_num, (int) pkt_item_len,
 					(int) status, (int) RESP_HEADER_SIZE);
 			continue;
 		}
 
 		if (pkt_item_len > res_item_size)
 		{
-			syslog (LOG_ERR, "ntpd plugin: (pkt_item_len = %i) "
+			ERROR ("ntpd plugin: (pkt_item_len = %i) "
 					">= (res_item_size = %i)",
 					pkt_item_len, res_item_size);
 			continue;
 		}
 
 		/* If this is the first packet (time wise, not sequence wise),
 		 * set `res_size'. If it's not the first packet check if the
 		 * items have the same size. Discard invalid packets. */
 		if (items_num == 0) /* first packet */
 		{
-			DBG ("*res_size = %i", pkt_item_len);
+			DEBUG ("*res_size = %i", pkt_item_len);
 			*res_size = pkt_item_len;
 		}
 		else if (*res_size != pkt_item_len)
 		{
-			DBG ("Error: *res_size = %i; pkt_item_len = %i;",
+			DEBUG ("Error: *res_size = %i; pkt_item_len = %i;",
 					*res_size, pkt_item_len);
-			syslog (LOG_ERR, "Item sizes differ.");
+			ERROR ("Item sizes differ.");
 			continue;
 		}
 
 		/*
 		 * Because the items in the packet may be smaller than the
 		 * items requested, the following holds true:
@@ -663,59 +600,59 @@
 				&& (pkt_item_len <= res_item_size));
 
 		/* Calculate the padding. No idea why there might be any padding.. */
 		pkt_padding = 0;
 		if (pkt_item_len < res_item_size)
 			pkt_padding = res_item_size - pkt_item_len;
-		DBG ("res_item_size = %i; pkt_padding = %i;",
+		DEBUG ("res_item_size = %i; pkt_padding = %i;",
 				res_item_size, pkt_padding);
 
 		/* Extract the sequence number */
 		pkt_sequence = INFO_SEQ (res.auth_seq);
 		if ((pkt_sequence < 0) || (pkt_sequence > MAXSEQ))
 		{
-			syslog (LOG_ERR, "ntpd plugin: Received packet with sequence %i",
+			ERROR ("ntpd plugin: Received packet with sequence %i",
 					pkt_sequence);
 			continue;
 		}
 
 		/* Check if this sequence has been received before. If so, discard it. */
 		if (pkt_recvd[pkt_sequence] != '\0')
 		{
-			syslog (LOG_NOTICE, "ntpd plugin: Sequence %i received twice",
+			NOTICE ("ntpd plugin: Sequence %i received twice",
 					pkt_sequence);
 			continue;
 		}
 
 		/* If `pkt_lastseq != -1' another packet without `more bit' has
 		 * been received. */
 		if (!ISMORE (res.rm_vn_mode))
 		{
 			if (pkt_lastseq != -1)
 			{
-				syslog (LOG_ERR, "ntpd plugin: Two packets which both "
+				ERROR ("ntpd plugin: Two packets which both "
 						"claim to be the last one in the "
 						"sequence have been received.");
 				continue;
 			}
 			pkt_lastseq = pkt_sequence;
-			DBG ("Last sequence = %i;", pkt_lastseq);
+			DEBUG ("Last sequence = %i;", pkt_lastseq);
 		}
 
 		/*
 		 * Enough with the checks. Copy the data now.
 		 * We start by allocating some more memory.
 		 */
-		DBG ("realloc (%p, %i)", (void *) *res_data,
+		DEBUG ("realloc (%p, %i)", (void *) *res_data,
 				(items_num + pkt_item_num) * res_item_size);
 		items = realloc ((void *) *res_data,
 				(items_num + pkt_item_num) * res_item_size);
 		if (items == NULL)
 		{
 			items = *res_data;
-			syslog (LOG_ERR, "ntpd plugin: realloc failed.");
+			ERROR ("ntpd plugin: realloc failed.");
 			continue;
 		}
 		items_num += pkt_item_num;
 		*res_data = items;
 
 		for (i = 0; i < pkt_item_num; i++)
@@ -779,19 +716,19 @@
 	req.err_nitems   = ERR_NITEMS (0, req_items);
 	req.mbz_itemsize = MBZ_ITEMSIZE (req_size);
 	
 	if (req_data != NULL)
 		memcpy ((void *) req.data, (const void *) req_data, req_data_len);
 
-	DBG ("req_items = %i; req_size = %i; req_data = %p;",
+	DEBUG ("req_items = %i; req_size = %i; req_data = %p;",
 			req_items, req_size, (void *) req_data);
 
 	status = swrite (sd, (const char *) &req, REQ_LEN_NOMAC);
 	if (status < 0)
 	{
-		DBG ("`swrite' failed. Closing socket #%i", sd);
+		DEBUG ("`swrite' failed. Closing socket #%i", sd);
 		close (sd);
 		sock_descr = sd = -1;
 		return (status);
 	}
 
 	return (0);
@@ -832,13 +769,13 @@
 	val_int = ntohl (val_int);
 	val_double = ((double) val_int) / FP_FRAC;
 
 	return (val_double);
 }
 
-static void ntpd_read (void)
+static int ntpd_read (void)
 {
 	struct info_kernel *ik;
 	int                 ik_num;
 	int                 ik_size;
 
 	struct info_peer_summary *ps;
@@ -856,53 +793,53 @@
 			0, 0, NULL, /* request data */
 			&ik_num, &ik_size, (char **) ((void *) &ik), /* response data */
 			sizeof (struct info_kernel));
 
 	if (status != 0)
 	{
-		DBG ("ntpd_do_query failed with status %i", status);
-		return;
+		DEBUG ("ntpd_do_query failed with status %i", status);
+		return (-1);
 	}
 	if ((ik == NULL) || (ik_num == 0) || (ik_size == 0))
 	{
-		DBG ("ntpd_do_query returned: ik = %p; ik_num = %i; ik_size = %i;",
+		DEBUG ("ntpd_do_query returned: ik = %p; ik_num = %i; ik_size = %i;",
 				(void *) ik, ik_num, ik_size);
-		return;
+		return (-1);
 	}
 
 	/* kerninfo -> estimated error */
 
-	DBG ("info_kernel:\n"
+	DEBUG ("info_kernel:\n"
 			"  pll offset    = %.8f\n"
 			"  pll frequency = %.8f\n" /* drift compensation */
 			"  est error     = %.8f\n",
 			ntpd_read_fp (ik->offset),
 			ntpd_read_fp (ik->freq),
 			ntpd_read_fp (ik->esterror));
 
-	ntpd_submit ("ntpd_frequency_offset", "loop",  ntpd_read_fp (ik->freq));
-	ntpd_submit ("ntpd_time_offset",      "loop",  ntpd_read_fp (ik->offset));
-	ntpd_submit ("ntpd_time_offset",      "error", ntpd_read_fp (ik->esterror));
+	ntpd_submit ("frequency_offset", "loop",  ntpd_read_fp (ik->freq));
+	ntpd_submit ("time_offset",      "loop",  ntpd_read_fp (ik->offset));
+	ntpd_submit ("time_offset",      "error", ntpd_read_fp (ik->esterror));
 
 	free (ik);
 	ik = NULL;
 
 	status = ntpd_do_query (REQ_PEER_LIST_SUM,
 			0, 0, NULL, /* request data */
 			&ps_num, &ps_size, (char **) ((void *) &ps), /* response data */
 			sizeof (struct info_peer_summary));
 	if (status != 0)
 	{
-		DBG ("ntpd_do_query failed with status %i", status);
-		return;
+		DEBUG ("ntpd_do_query failed with status %i", status);
+		return (-1);
 	}
 	if ((ps == NULL) || (ps_num == 0) || (ps_size == 0))
 	{
-		DBG ("ntpd_do_query returned: ps = %p; ps_num = %i; ps_size = %i;",
+		DEBUG ("ntpd_do_query returned: ps = %p; ps_num = %i; ps_size = %i;",
 				(void *) ps, ps_num, ps_size);
-		return;
+		return (-1);
 	}
 
 	for (i = 0; i < ps_num; i++)
 	{
 		struct info_peer_summary *ptr;
 		double offset;
@@ -933,15 +870,16 @@
 			status = getnameinfo ((const struct sockaddr *) &sa,
 					sizeof (sa),
 					peername, sizeof (peername),
 					NULL, 0, 0 /* no flags */);
 			if (status != 0)
 			{
-				syslog (LOG_ERR, "ntpd plugin: getnameinfo failed: %s",
-						status == EAI_SYSTEM
-						? strerror (errno)
+				char errbuf[1024];
+				ERROR ("ntpd plugin: getnameinfo failed: %s",
+						(status == EAI_SYSTEM)
+						? sstrerror (errno, errbuf, sizeof (errbuf))
 						: gai_strerror (status));
 				continue;
 			}
 		}
 		else if ((ntohl (ptr->srcadr) & REFCLOCK_MASK) == REFCLOCK_ADDR)
 		{
@@ -983,13 +921,13 @@
 			else
 			{
 				strncpy (peername, addr_str, sizeof (peername));
 			}
 		}
 
-		DBG ("peer %i:\n"
+		DEBUG ("peer %i:\n"
 				"  peername   = %s\n"
 				"  srcadr     = 0x%08x\n"
 				"  delay      = %f\n"
 				"  offset_int = %i\n"
 				"  offset_frc = %i\n"
 				"  offset     = %f\n"
@@ -1001,32 +939,27 @@
 				ntohl (ptr->offset_int),
 				ntohl (ptr->offset_frc),
 				offset,
 				ntpd_read_fp (ptr->dispersion));
 
 		if (refclock_id != 1) /* not the system clock (offset will always be zero.. */
-			ntpd_submit ("ntpd_time_offset", peername, offset);
-		ntpd_submit ("ntpd_time_dispersion", peername, ntpd_read_fp (ptr->dispersion));
+			ntpd_submit ("time_offset", peername, offset);
+		ntpd_submit ("time_dispersion", peername, ntpd_read_fp (ptr->dispersion));
 		if (refclock_id == 0) /* not a reference clock */
-			ntpd_submit ("ntpd_delay", peername, ntpd_read_fp (ptr->delay));
+			ntpd_submit ("delay", peername, ntpd_read_fp (ptr->delay));
 	}
 
 	free (ps);
 	ps = NULL;
 
-	return;
-}
-#else
-# define ntpd_read NULL
+	return (0);
+} /* int ntpd_read */
 #endif /* NTPD_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, ntpd_init, ntpd_read, NULL);
-	plugin_register ("ntpd_time_offset", NULL, NULL, ntpd_write_time_offset);
-	plugin_register ("ntpd_time_dispersion", NULL, NULL, ntpd_write_time_dispersion);
-	plugin_register ("ntpd_delay", NULL, NULL, ntpd_write_delay);
-	plugin_register ("ntpd_frequency_offset", NULL, NULL, ntpd_write_frequency_offset);
-	cf_register (MODULE_NAME, ntpd_config, config_keys, config_keys_num);
-}
-
-#undef MODULE_NAME
+#if NTPD_HAVE_READ
+	plugin_register_config ("ntpd", ntpd_config,
+			config_keys, config_keys_num);
+	plugin_register_read ("ntpd", ntpd_read);
+#endif /* NTPD_HAVE_READ */
+} /* void module_register */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: nut.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: perl.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/ping.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/ping.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/ping.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/ping.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/ping.c
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -21,225 +20,239 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "ping"
 
 #include <netinet/in.h>
 #include "liboping/oping.h"
 
+/*
+ * Private data types
+ */
 struct hostlist_s
 {
 	char *host;
 	int   wait_time;
 	int   wait_left;
 	struct hostlist_s *next;
 };
 typedef struct hostlist_s hostlist_t;
 
+/*
+ * Private variables
+ */
 static pingobj_t *pingobj = NULL;
 static hostlist_t *hosts = NULL;
 
-static char *file_template = "ping-%s.rrd";
-
-static char *ds_def[] = 
-{
-	"DS:ping:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int ds_num = 1;
-
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Host",
 	"TTL",
 	NULL
 };
 static int config_keys_num = 2;
 
+/*
+ * Private functions
+ */
 static void add_hosts (void)
 {
 	hostlist_t *hl_this;
 	hostlist_t *hl_prev;
 
-	int step = atoi (COLLECTD_STEP);
-
 	hl_this = hosts;
 	hl_prev = NULL;
 	while (hl_this != NULL)
 	{
-		DBG ("host = %s, wait_left = %i, wait_time = %i, next = %p",
-				hl_this->host, hl_this->wait_left, hl_this->wait_time, (void *) hl_this->next);
+		DEBUG ("ping plugin: host = %s, wait_left = %i, "
+				"wait_time = %i, next = %p",
+				hl_this->host, hl_this->wait_left,
+				hl_this->wait_time, (void *) hl_this->next);
 
 		if (hl_this->wait_left <= 0)
 		{
 			if (ping_host_add (pingobj, hl_this->host) == 0)
 			{
-				DBG ("Successfully added host %s", hl_this->host);
+				DEBUG ("ping plugin: Successfully added host %s", hl_this->host);
 				/* Remove the host from the linked list */
 				if (hl_prev != NULL)
 					hl_prev->next = hl_this->next;
 				else
 					hosts = hl_this->next;
 				free (hl_this->host);
 				free (hl_this);
 				hl_this = (hl_prev != NULL) ? hl_prev : hosts;
 			}
 			else
 			{
+				WARNING ("ping plugin: Failed adding host "
+						"`%s': %s", hl_this->host,
+						ping_get_error (pingobj));
 				hl_this->wait_left = hl_this->wait_time;
 				hl_this->wait_time *= 2;
 				if (hl_this->wait_time > 86400)
 					hl_this->wait_time = 86400;
 			}
 		}
 		else
 		{
-			hl_this->wait_left -= step;
+			hl_this->wait_left -= interval_g;
 		}
 
 		if (hl_this != NULL)
 		{
 			hl_prev = hl_this;
 			hl_this = hl_this->next;
 		}
 	}
 }
 
-static void ping_init (void)
+static int ping_init (void)
 {
 	if (hosts != NULL)
 		add_hosts ();
+
+	return (0);
 }
 
-static int ping_config (char *key, char *value)
+static int ping_config (const char *key, const char *value)
 {
 	if (pingobj == NULL)
 	{
 		if ((pingobj = ping_construct ()) == NULL)
 		{
-			syslog (LOG_ERR, "ping: `ping_construct' failed: %s",
-				       	ping_get_error (pingobj));
+			ERROR ("ping plugin: `ping_construct' failed.");
 			return (1);
 		}
 	}
 
 	if (strcasecmp (key, "host") == 0)
 	{
 		hostlist_t *hl;
 		char *host;
-		int step = atoi (COLLECTD_STEP);
 
 		if ((hl = (hostlist_t *) malloc (sizeof (hostlist_t))) == NULL)
 		{
-			syslog (LOG_ERR, "ping plugin: malloc failed: %s",
-					strerror (errno));
+			char errbuf[1024];
+			ERROR ("ping plugin: malloc failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (1);
 		}
 		if ((host = strdup (value)) == NULL)
 		{
+			char errbuf[1024];
 			free (hl);
-			syslog (LOG_ERR, "ping plugin: strdup failed: %s",
-					strerror (errno));
+			ERROR ("ping plugin: strdup failed: %s",
+					sstrerror (errno, errbuf,
+						sizeof (errbuf)));
 			return (1);
 		}
 
 		hl->host = host;
-		hl->wait_time = 2 * step;
+		hl->wait_time = 2 * interval_g;
 		hl->wait_left = 0;
 		hl->next = hosts;
 		hosts = hl;
 	}
 	else if (strcasecmp (key, "ttl") == 0)
 	{
 		int ttl = atoi (value);
 		if (ping_setopt (pingobj, PING_DEF_TIMEOUT, (void *) &ttl))
 		{
-			syslog (LOG_WARNING, "ping: liboping did not accept the TTL value %i", ttl);
+			WARNING ("ping: liboping did not accept the TTL value %i", ttl);
 			return (1);
 		}
 	}
 	else
 	{
 		return (-1);
 	}
 
 	return (0);
 }
 
-static void ping_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, file_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
-
-#define BUFSIZE 256
 static void ping_submit (char *host, double latency)
 {
-	char buf[BUFSIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFSIZE, "%u:%f", (unsigned int) curtime, latency) >= BUFSIZE)
-		return;
+	values[0].gauge = latency;
 
-	plugin_submit (MODULE_NAME, host, buf);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "ping");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, host, sizeof (vl.type_instance));
+
+	plugin_dispatch_values ("ping", &vl);
 }
-#undef BUFSIZE
 
-static void ping_read (void)
+static int ping_read (void)
 {
 	pingobj_iter_t *iter;
 
 	char   host[512];
 	double latency;
 	size_t buf_len;
+	int    number_of_hosts;
 
 	if (pingobj == NULL)
-		return;
+		return (-1);
 
 	if (hosts != NULL)
 		add_hosts ();
 
 	if (ping_send (pingobj) < 0)
 	{
-		syslog (LOG_ERR, "ping: `ping_send' failed: %s",
+		ERROR ("ping plugin: `ping_send' failed: %s",
 				ping_get_error (pingobj));
-		return;
+		return (-1);
 	}
 
+	number_of_hosts = 0;
 	for (iter = ping_iterator_get (pingobj);
 			iter != NULL;
 			iter = ping_iterator_next (iter))
 	{
 		buf_len = sizeof (host);
 		if (ping_iterator_get_info (iter, PING_INFO_HOSTNAME,
 					host, &buf_len))
+		{
+			WARNING ("ping plugin: ping_iterator_get_info "
+					"(PING_INFO_HOSTNAME) failed.");
 			continue;
+		}
 
 		buf_len = sizeof (latency);
 		if (ping_iterator_get_info (iter, PING_INFO_LATENCY,
 					&latency, &buf_len))
+		{
+			WARNING ("ping plugin: ping_iterator_get_info (%s, "
+					"PING_INFO_LATENCY) failed.", host);
 			continue;
+		}
 
-		DBG ("host = %s, latency = %f", host, latency);
+		DEBUG ("ping plugin: host = %s, latency = %f", host, latency);
 		ping_submit (host, latency);
+		number_of_hosts++;
+	}
+
+	if ((number_of_hosts == 0) && (getuid != 0))
+	{
+		ERROR ("ping plugin: All hosts failed. Try starting collectd as root.");
 	}
-}
+
+	return (number_of_hosts == 0 ? -1 : 0);
+} /* int ping_read */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, ping_init, ping_read, ping_write);
-	cf_register (MODULE_NAME, ping_config, config_keys, config_keys_num);
-}
-
-#undef MODULE_NAME
+	plugin_register_config ("ping", ping_config,
+			config_keys, config_keys_num);
+	plugin_register_init ("ping", ping_init);
+	plugin_register_read ("ping", ping_read);
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/plugin.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/plugin.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/plugin.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/plugin.c	2007-06-04 01:06:02.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/plugin.c
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -21,181 +20,331 @@
  **/
 
 #include "collectd.h"
 
 #include <ltdl.h>
 
+#if HAVE_PTHREAD_H
+# include <pthread.h>
+#endif
+
+#include "common.h"
 #include "plugin.h"
-#include "network.h"
-#include "utils_debug.h"
+#include "configfile.h"
+#include "utils_llist.h"
 
-typedef struct plugin
+/*
+ * Private structures
+ */
+struct read_func_s
 {
-	char *type;
-	void (*init) (void);
-	void (*read) (void);
-	void (*write) (char *host, char *inst, char *val);
-	void (*shutdown) (void);
-	struct plugin *next;
-} plugin_t;
+	int wait_time;
+	int wait_left;
+	int (*callback) (void);
+	enum { DONE = 0, TODO = 1, ACTIVE = 2 } needs_read;
+};
+typedef struct read_func_s read_func_t;
 
-static plugin_t *first_plugin = NULL;
-
-extern int operating_mode;
+/*
+ * Private variables
+ */
+static llist_t *list_init;
+static llist_t *list_read;
+static llist_t *list_write;
+static llist_t *list_shutdown;
+static llist_t *list_data_set;
+static llist_t *list_log;
 
 static char *plugindir = NULL;
 
-char *plugin_get_dir (void)
+static int             read_loop = 1;
+static pthread_mutex_t read_lock = PTHREAD_MUTEX_INITIALIZER;
+static pthread_cond_t  read_cond = PTHREAD_COND_INITIALIZER;
+static pthread_t      *read_threads = NULL;
+static int             read_threads_num = 0;
+
+/*
+ * Static functions
+ */
+static const char *plugin_get_dir (void)
 {
 	if (plugindir == NULL)
 		return (PLUGINDIR);
 	else
 		return (plugindir);
 }
 
-void plugin_set_dir (const char *dir)
+static int register_callback (llist_t **list, const char *name, void *callback)
 {
-	if (plugindir != NULL)
-		free (plugindir);
+	llentry_t *le;
 
-	if (dir == NULL)
-		plugindir = NULL;
-	else if ((plugindir = strdup (dir)) == NULL)
-		syslog (LOG_ERR, "strdup: %s", strerror (errno));
-}
+	if ((*list == NULL)
+			&& ((*list = llist_create ()) == NULL))
+		return (-1);
 
-/*
- * Returns the number of plugins registered
- */
-int plugin_count (void)
-{
-	int i;
-	plugin_t *p;
+	le = llist_search (*list, name);
+	if (le == NULL)
+	{
+		le = llentry_create (name, callback);
+		if (le == NULL)
+			return (-1);
 
-	for (i = 0, p = first_plugin; p != NULL; p = p->next)
-		i++;
+		llist_append (*list, le);
+	}
+	else
+	{
+		le->value = callback;
+	}
 
-	return (i);
-}
+	return (0);
+} /* int register_callback */
 
-/*
- * Returns the plugins with the type `type' or NULL if it's not found.
- */
-plugin_t *plugin_search (const char *type)
+static int plugin_unregister (llist_t *list, const char *name)
 {
-	plugin_t *ret;
+	llentry_t *e;
 
-	if (type == NULL)
-		return (NULL);
+	e = llist_search (list, name);
 
-	for (ret = first_plugin; ret != NULL; ret = ret->next)
-		if (strcmp (ret->type, type) == 0)
-			break;
+	if (e == NULL)
+		return (-1);
 
-	return (ret);
-}
+	llist_remove (list, e);
+	llentry_destroy (e);
 
-/*
- * Returns true if the plugin is loaded (i.e. `exists') and false otherwise.
- * This is used in `configfile.c' to skip sections that are not needed..
- */
-int plugin_exists (char *type)
-{
-	if (plugin_search (type) == NULL)
-		return (0);
-	else
-		return (1);
-}
+	return (0);
+} /* int plugin_unregister */
 
 /*
  * (Try to) load the shared object `file'. Won't complain if it isn't a shared
  * object, but it will bitch about a shared object not having a
  * ``module_register'' symbol..
  */
-int plugin_load_file (char *file)
+static int plugin_load_file (char *file)
 {
 	lt_dlhandle dlh;
 	void (*reg_handle) (void);
 
-	DBG ("file = %s", file);
+	DEBUG ("file = %s", file);
 
 	lt_dlinit ();
 	lt_dlerror (); /* clear errors */
 
 	if ((dlh = lt_dlopen (file)) == NULL)
 	{
 		const char *error = lt_dlerror ();
 
-		syslog (LOG_ERR, "lt_dlopen failed: %s", error);
-		DBG ("lt_dlopen failed: %s", error);
+		ERROR ("lt_dlopen failed: %s", error);
+		DEBUG ("lt_dlopen failed: %s", error);
 		return (1);
 	}
 
 	if ((reg_handle = (void (*) (void)) lt_dlsym (dlh, "module_register")) == NULL)
 	{
-		syslog (LOG_WARNING, "Couldn't find symbol ``module_register'' in ``%s'': %s\n",
+		WARNING ("Couldn't find symbol ``module_register'' in ``%s'': %s\n",
 				file, lt_dlerror ());
 		lt_dlclose (dlh);
 		return (-1);
 	}
 
 	(*reg_handle) ();
 
 	return (0);
 }
 
+static void *plugin_read_thread (void *args)
+{
+	llentry_t   *le;
+	read_func_t *rf;
+	int          status;
+	int          done;
+
+	pthread_mutex_lock (&read_lock);
+
+	while (read_loop != 0)
+	{
+		le = llist_head (list_read);
+		done = 0;
+
+		while ((read_loop != 0) && (le != NULL))
+		{
+			rf = (read_func_t *) le->value;
+
+			if (rf->needs_read != TODO)
+			{
+				le = le->next;
+				continue;
+			}
+
+			/* We will do this read function */
+			rf->needs_read = ACTIVE;
+
+			DEBUG ("[thread #%5lu] plugin: plugin_read_thread: Handling %s",
+					(unsigned long int) pthread_self (), le->key);
+			pthread_mutex_unlock (&read_lock);
+
+			status = rf->callback ();
+			done++;
+
+			if (status != 0)
+			{
+				if (rf->wait_time < interval_g)
+					rf->wait_time = interval_g;
+				rf->wait_left = rf->wait_time;
+				rf->wait_time = rf->wait_time * 2;
+				if (rf->wait_time > 86400)
+					rf->wait_time = 86400;
+
+				NOTICE ("read-function of plugin `%s' "
+						"failed. Will syspend it for %i "
+						"seconds.", le->key, rf->wait_left);
+			}
+			else
+			{
+				rf->wait_left = 0;
+				rf->wait_time = interval_g;
+			}
+
+			pthread_mutex_lock (&read_lock);
+
+			rf->needs_read = DONE;
+			le = le->next;
+		} /* while (le != NULL) */
+
+		if ((read_loop != 0) && (done == 0))
+		{
+			DEBUG ("[thread #%5lu] plugin: plugin_read_thread: Waiting on read_cond.",
+					(unsigned long int) pthread_self ());
+			pthread_cond_wait (&read_cond, &read_lock);
+		}
+	} /* while (read_loop) */
+
+	pthread_mutex_unlock (&read_lock);
+
+	pthread_exit (NULL);
+} /* void *plugin_read_thread */
+
+static void start_threads (int num)
+{
+	int i;
+
+	if (read_threads != NULL)
+		return;
+
+	read_threads = (pthread_t *) calloc (num, sizeof (pthread_t));
+	if (read_threads == NULL)
+	{
+		ERROR ("plugin: start_threads: calloc failed.");
+		return;
+	}
+
+	read_threads_num = 0;
+	for (i = 0; i < num; i++)
+	{
+		if (pthread_create (read_threads + read_threads_num, NULL,
+					plugin_read_thread, NULL) == 0)
+		{
+			read_threads_num++;
+		}
+		else
+		{
+			ERROR ("plugin: start_threads: pthread_create failed.");
+			return;
+		}
+	} /* for (i) */
+} /* void start_threads */
+
+static void stop_threads (void)
+{
+	int i;
+
+	pthread_mutex_lock (&read_lock);
+	read_loop = 0;
+	DEBUG ("plugin: stop_threads: Signalling `read_cond'");
+	pthread_cond_broadcast (&read_cond);
+	pthread_mutex_unlock (&read_lock);
+
+	for (i = 0; i < read_threads_num; i++)
+	{
+		if (pthread_join (read_threads[i], NULL) != 0)
+		{
+			ERROR ("plugin: stop_threads: pthread_join failed.");
+		}
+		read_threads[i] = (pthread_t) 0;
+	}
+	sfree (read_threads);
+	read_threads_num = 0;
+} /* void stop_threads */
+
+/*
+ * Public functions
+ */
+void plugin_set_dir (const char *dir)
+{
+	if (plugindir != NULL)
+		free (plugindir);
+
+	if (dir == NULL)
+		plugindir = NULL;
+	else if ((plugindir = strdup (dir)) == NULL)
+	{
+		char errbuf[1024];
+		ERROR ("strdup failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
+}
+
 #define BUFSIZE 512
 int plugin_load (const char *type)
 {
 	DIR  *dh;
-	char *dir;
+	const char *dir;
 	char  filename[BUFSIZE];
 	char  typename[BUFSIZE];
 	int   typename_len;
 	int   ret;
 	struct stat    statbuf;
 	struct dirent *de;
 
-	DBG ("type = %s", type);
+	DEBUG ("type = %s", type);
 
 	dir = plugin_get_dir ();
 	ret = 1;
 
-	/* don't load twice */
-	if (plugin_search (type) != NULL)
-		return (0);
-
 	/* `cpu' should not match `cpufreq'. To solve this we add `.so' to the
 	 * type when matching the filename */
 	if (snprintf (typename, BUFSIZE, "%s.so", type) >= BUFSIZE)
 	{
-		syslog (LOG_WARNING, "snprintf: truncated: `%s.so'", type);
+		WARNING ("snprintf: truncated: `%s.so'", type);
 		return (-1);
 	}
 	typename_len = strlen (typename);
 
 	if ((dh = opendir (dir)) == NULL)
 	{
-		syslog (LOG_ERR, "opendir (%s): %s", dir, strerror (errno));
+		char errbuf[1024];
+		ERROR ("opendir (%s): %s", dir,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (-1);
 	}
 
 	while ((de = readdir (dh)) != NULL)
 	{
 		if (strncasecmp (de->d_name, typename, typename_len))
 			continue;
 
 		if (snprintf (filename, BUFSIZE, "%s/%s", dir, de->d_name) >= BUFSIZE)
 		{
-			syslog (LOG_WARNING, "snprintf: truncated: `%s/%s'", dir, de->d_name);
+			WARNING ("snprintf: truncated: `%s/%s'", dir, de->d_name);
 			continue;
 		}
 
 		if (lstat (filename, &statbuf) == -1)
 		{
-			syslog (LOG_WARNING, "stat %s: %s", filename, strerror (errno));
+			char errbuf[1024];
+			WARNING ("stat %s: %s", filename,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 			continue;
 		}
 		else if (!S_ISREG (statbuf.st_mode))
 		{
 			/* don't follow symlinks */
 			continue;
@@ -212,221 +361,378 @@
 	closedir (dh);
 
 	return (ret);
 }
 
 /*
- * (Try to) load all plugins in `dir'. Returns the number of loaded plugins..
+ * The `register_*' functions follow
  */
-int plugin_load_all (char *dir)
+int plugin_register_config (const char *name,
+		int (*callback) (const char *key, const char *val),
+		const char **keys, int keys_num)
 {
-	DIR *dh;
-	struct dirent *de;
-	char filename[BUFSIZE];
-	struct stat statbuf;
+	cf_register (name, callback, keys, keys_num);
+	return (0);
+} /* int plugin_register_config */
 
-	if (dir == NULL)
-		dir = plugin_get_dir ();
-	else
-		plugin_set_dir (dir);
+int plugin_register_init (const char *name,
+		int (*callback) (void))
+{
+	return (register_callback (&list_init, name, (void *) callback));
+} /* plugin_register_init */
 
-	if ((dh = opendir (dir)) == NULL)
+int plugin_register_read (const char *name,
+		int (*callback) (void))
+{
+	read_func_t *rf;
+
+	rf = (read_func_t *) malloc (sizeof (read_func_t));
+	if (rf == NULL)
 	{
-		syslog (LOG_ERR, "opendir (%s): %s", dir, strerror (errno));
-		return (0);
+		char errbuf[1024];
+		ERROR ("plugin_register_read: malloc failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
-	while ((de = readdir (dh)) != NULL)
+	memset (rf, '\0', sizeof (read_func_t));
+	rf->wait_time = interval_g;
+	rf->wait_left = 0;
+	rf->callback = callback;
+	rf->needs_read = DONE;
+
+	return (register_callback (&list_read, name, (void *) rf));
+} /* int plugin_register_read */
+
+int plugin_register_write (const char *name,
+		int (*callback) (const data_set_t *ds, const value_list_t *vl))
+{
+	return (register_callback (&list_write, name, (void *) callback));
+} /* int plugin_register_write */
+
+int plugin_register_shutdown (char *name,
+		int (*callback) (void))
+{
+	return (register_callback (&list_shutdown, name, (void *) callback));
+} /* int plugin_register_shutdown */
+
+int plugin_register_data_set (const data_set_t *ds)
+{
+	data_set_t *ds_copy;
+	int i;
+
+	if ((list_data_set != NULL)
+			&& (llist_search (list_data_set, ds->type) != NULL))
 	{
-		if (snprintf (filename, BUFSIZE, "%s/%s", dir, de->d_name) >= BUFSIZE)
-		{
-			syslog (LOG_WARNING, "snprintf: truncated: %s/%s", dir, de->d_name);
-			continue;
-		}
+		NOTICE ("Replacing DS `%s' with another version.", ds->type);
+		plugin_unregister_data_set (ds->type);
+	}
 
-		if (lstat (filename, &statbuf) == -1)
-		{
-			syslog (LOG_WARNING, "stat %s: %s", filename, strerror (errno));
-			continue;
-		}
-		else if (!S_ISREG (statbuf.st_mode))
-		{
-			continue;
-		}
+	ds_copy = (data_set_t *) malloc (sizeof (data_set_t));
+	if (ds_copy == NULL)
+		return (-1);
+	memcpy(ds_copy, ds, sizeof (data_set_t));
 
-		plugin_load_file (filename);
+	ds_copy->ds = (data_source_t *) malloc (sizeof (data_source_t)
+			* ds->ds_num);
+	if (ds_copy->ds == NULL)
+	{
+		free (ds_copy);
+		return (-1);
 	}
 
-	closedir (dh);
+	for (i = 0; i < ds->ds_num; i++)
+		memcpy (ds_copy->ds + i, ds->ds + i, sizeof (data_source_t));
+
+	return (register_callback (&list_data_set, ds->type, (void *) ds_copy));
+} /* int plugin_register_data_set */
 
-	return (plugin_count ());
+int plugin_register_log (char *name,
+		void (*callback) (int priority, const char *msg))
+{
+	return (register_callback (&list_log, name, (void *) callback));
+} /* int plugin_register_log */
+
+int plugin_unregister_config (const char *name)
+{
+	cf_unregister (name);
+	return (0);
+} /* int plugin_unregister_config */
+
+int plugin_unregister_init (const char *name)
+{
+	return (plugin_unregister (list_init, name));
 }
-#undef BUFSIZE
 
-/*
- * Call `init' on all plugins (if given)
- */
-void plugin_init_all (void)
+int plugin_unregister_read (const char *name)
 {
-	plugin_t *p;
+	llentry_t *e;
+
+	e = llist_search (list_read, name);
+
+	if (e == NULL)
+		return (-1);
 
-	for (p = first_plugin; p != NULL; p = p->next)
-		if (p->init != NULL)
-			(*p->init) ();
+	llist_remove (list_read, e);
+	free (e->value);
+	llentry_destroy (e);
+
+	return (0);
 }
 
-/*
- * Call `read' on all plugins (if given)
- */
-void plugin_read_all (const int *loop)
+int plugin_unregister_write (const char *name)
 {
-	plugin_t *p;
+	return (plugin_unregister (list_write, name));
+}
 
-	for (p = first_plugin; (*loop == 0) && (p != NULL); p = p->next)
-		if (p->read != NULL)
-			(*p->read) ();
+int plugin_unregister_shutdown (const char *name)
+{
+	return (plugin_unregister (list_shutdown, name));
 }
 
-/*
- * Call `shutdown' on all plugins (if given)
- */
-void plugin_shutdown_all (void)
+int plugin_unregister_data_set (const char *name)
 {
-	plugin_t *p;
+	llentry_t  *e;
+	data_set_t *ds;
+
+	if (list_data_set == NULL)
+		return (-1);
+
+	e = llist_search (list_data_set, name);
+
+	if (e == NULL)
+		return (-1);
+
+	llist_remove (list_data_set, e);
+	ds = (data_set_t *) e->value;
+	llentry_destroy (e);
+
+	sfree (ds->ds);
+	sfree (ds);
+
+	return (0);
+} /* int plugin_unregister_data_set */
 
-	for (p = first_plugin; NULL != p; p = p->next)
-		if (NULL != p->shutdown)
-			(*p->shutdown) ();
-	return;
+int plugin_unregister_log (const char *name)
+{
+	return (plugin_unregister (list_log, name));
 }
 
-/*
- * Add plugin to the linked list of registered plugins.
- */
-void plugin_register (char *type,
-		void (*init) (void),
-		void (*read) (void),
-		void (*write) (char *, char *, char *))
+void plugin_init_all (void)
 {
-	plugin_t *p;
+	int (*callback) (void);
+	llentry_t *le;
+	int status;
 
-	if (plugin_search (type) != NULL)
+	/* Start read-threads */
+	if (list_read != NULL)
+	{
+		const char *rt;
+		int num;
+		rt = global_option_get ("ReadThreads");
+		num = atoi (rt);
+		start_threads ((num > 0) ? num : 5);
+	}
+
+	if (list_init == NULL)
 		return;
 
-#ifdef HAVE_LIBRRD
-	if (operating_mode != MODE_SERVER)
-#endif
-		if ((init != NULL) && (read == NULL))
-			syslog (LOG_NOTICE, "Plugin `%s' doesn't provide a read function.", type);
+	le = llist_head (list_init);
+	while (le != NULL)
+	{
+		callback = (int (*) (void)) le->value;
+		status = (*callback) ();
+
+		if (status != 0)
+		{
+			ERROR ("Initialization of plugin `%s' "
+					"failed with status %i. "
+					"Plugin will be unloaded.",
+					le->key, status);
+			/* FIXME: Unload _all_ functions */
+			plugin_unregister_read (le->key);
+		}
 
-	if ((p = (plugin_t *) malloc (sizeof (plugin_t))) == NULL)
+		le = le->next;
+	}
+} /* void plugin_init_all */
+
+void plugin_read_all (const int *loop)
+{
+	llentry_t   *le;
+	read_func_t *rf;
+
+	if (list_read == NULL)
 		return;
 
-	if ((p->type = strdup (type)) == NULL)
+	pthread_mutex_lock (&read_lock);
+
+	le = llist_head (list_read);
+	while (le != NULL)
 	{
-		free (p);
-		return;
+		rf = (read_func_t *) le->value;
+
+		if (rf->needs_read != DONE)
+		{
+			le = le->next;
+			continue;
+		}
+
+		if (rf->wait_left > 0)
+			rf->wait_left -= interval_g;
+
+		if (rf->wait_left <= 0)
+		{
+			rf->needs_read = TODO;
+		}
+
+		le = le->next;
 	}
 
-	p->init  = init;
-	p->read  = read;
-	p->write = write;
+	DEBUG ("plugin: plugin_read_all: Signalling `read_cond'");
+	pthread_cond_broadcast (&read_cond);
+	pthread_mutex_unlock (&read_lock);
+} /* void plugin_read_all */
 
-	p->shutdown = NULL;
+void plugin_shutdown_all (void)
+{
+	int (*callback) (void);
+	llentry_t *le;
 
-	p->next = first_plugin;
-	first_plugin = p;
-}
+	stop_threads ();
 
-/*
- * Register the shutdown function (optional).
- */
-int plugin_register_shutdown (char *type, void (*shutdown) (void))
+	if (list_shutdown == NULL)
+		return;
+
+	le = llist_head (list_shutdown);
+	while (le != NULL)
+	{
+		callback = (int (*) (void)) le->value;
+
+		/* Advance the pointer before calling the callback allows
+		 * shutdown functions to unregister themselves. If done the
+		 * other way around the memory `le' points to will be freed
+		 * after callback returns. */
+		le = le->next;
+
+		(*callback) ();
+	}
+} /* void plugin_shutdown_all */
+
+int plugin_dispatch_values (const char *name, value_list_t *vl)
 {
-	plugin_t *p = plugin_search (type);
+	int (*callback) (const data_set_t *, const value_list_t *);
+	data_set_t *ds;
+	llentry_t *le;
 
-	if (NULL == p)
-		return -1;
+	if ((list_write == NULL) || (list_data_set == NULL))
+		return (-1);
 
-	p->shutdown = shutdown;
-	return 0;
-}
+	le = llist_search (list_data_set, name);
+	if (le == NULL)
+	{
+		DEBUG ("No such dataset registered: %s", name);
+		return (-1);
+	}
 
-/*
- * Send received data back to the plugin/module which will append DS
- * definitions and pass it on to ``rrd_update_file''.
- */
-void plugin_write (char *host, char *type, char *inst, char *val)
+	ds = (data_set_t *) le->value;
+
+	DEBUG ("plugin: plugin_dispatch_values: time = %u; host = %s; "
+			"plugin = %s; plugin_instance = %s; type = %s; "
+			"type_instance = %s;",
+			(unsigned int) vl->time, vl->host,
+			vl->plugin, vl->plugin_instance,
+			ds->type, vl->type_instance);
+
+#if COLLECT_DEBUG
+	assert (ds->ds_num == vl->values_len);
+#else
+	if (ds->ds_num != vl->values_len)
+	{
+		ERROR ("plugin: ds->type = %s: (ds->ds_num = %i) != "
+				"(vl->values_len = %i)",
+				ds->type, ds->ds_num, vl->values_len);
+		return (-1);
+	}
+#endif
+
+	escape_slashes (vl->host, sizeof (vl->host));
+	escape_slashes (vl->plugin, sizeof (vl->plugin));
+	escape_slashes (vl->plugin_instance, sizeof (vl->plugin_instance));
+	escape_slashes (vl->type_instance, sizeof (vl->type_instance));
+
+	le = llist_head (list_write);
+	while (le != NULL)
+	{
+		callback = (int (*) (const data_set_t *, const value_list_t *)) le->value;
+		(*callback) (ds, vl);
+
+		le = le->next;
+	}
+
+	return (0);
+} /* int plugin_dispatch_values */
+
+void plugin_log (int level, const char *format, ...)
 {
-	plugin_t *p;
+	char msg[512];
+	va_list ap;
 
-	if ((p = plugin_search (type)) == NULL)
-		return;
+	void (*callback) (int, const char *);
+	llentry_t *le;
 
-	if (p->write == NULL)
+	if (list_log == NULL)
 		return;
 
-	(*p->write) (host, inst, val);
-}
+#if !COLLECT_DEBUG
+	if (level >= LOG_DEBUG)
+		return;
+#endif
 
-/*
- * Receive data from the plugin/module and get it somehow to ``plugin_write'':
- * Either using ``network_send'' (when in network/client mode) or call it
- * directly (in local mode).
- */
-void plugin_submit (char *type, char *inst, char *val)
-{
-	if (inst == NULL)
-		inst = "-";
+	va_start (ap, format);
+	vsnprintf (msg, 512, format, ap);
+	msg[511] = '\0';
+	va_end (ap);
 
-	if ((type == NULL) || (val == NULL))
+	le = llist_head (list_log);
+	while (le != NULL)
 	{
-		DBG ("Help! NULL-pointer! type = %s; inst = %s; val = %s;",
-				(type == NULL) ? "(null)" : type,
-				inst,
-				(val == NULL) ? "(null)" : val);
-		return;
-	}
+		callback = (void (*) (int, const char *)) le->value;
+		(*callback) (level, msg);
 
-        if (operating_mode == MODE_CLIENT)
-		network_send (type, inst, val);
-	else
-		plugin_write (NULL, type, inst, val);
-}
+		le = le->next;
+	}
+} /* void plugin_log */
 
 void plugin_complain (int level, complain_t *c, const char *format, ...)
 {
 	char message[512];
 	va_list ap;
-	int step;
 
 	if (c->delay > 0)
 	{
 		c->delay--;
 		return;
 	}
 
-	step = atoi (COLLECTD_STEP);
-	assert (step > 0);
-
-	if (c->interval < step)
-		c->interval = step;
+	if (c->interval < interval_g)
+		c->interval = interval_g;
 	else
 		c->interval *= 2;
 
 	if (c->interval > 86400)
 		c->interval = 86400;
 
-	c->delay = c->interval / step;
+	c->delay = c->interval / interval_g;
 
 	va_start (ap, format);
 	vsnprintf (message, 512, format, ap);
 	message[511] = '\0';
 	va_end (ap);
 
-	syslog (level, message);
+	plugin_log (level, message);
 }
 
 void plugin_relief (int level, complain_t *c, const char *format, ...)
 {
 	char message[512];
 	va_list ap;
@@ -438,8 +744,25 @@
 
 	va_start (ap, format);
 	vsnprintf (message, 512, format, ap);
 	message[511] = '\0';
 	va_end (ap);
 
-	syslog (level, message);
+	plugin_log (level, message);
 }
+
+const data_set_t *plugin_get_ds (const char *name)
+{
+	data_set_t *ds;
+	llentry_t *le;
+
+	le = llist_search (list_data_set, name);
+	if (le == NULL)
+	{
+		DEBUG ("No such dataset registered: %s", name);
+		return (NULL);
+	}
+
+	ds = (data_set_t *) le->value;
+
+	return (ds);
+} /* data_set_t *plugin_get_ds */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/plugin.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/plugin.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/plugin.h	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/plugin.h	2007-06-04 01:06:02.000000000 +0800
@@ -4,14 +4,13 @@
 /**
  * collectd - src/plugin.h
  * Copyright (C) 2005,2006  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -20,15 +19,77 @@
  * 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
  *
  * Authors:
  *   Florian octo Forster <octo at verplant.org>
  **/
 
+#define DATA_MAX_NAME_LEN 64
+
+#define DS_TYPE_COUNTER 0
+#define DS_TYPE_GAUGE   1
+
+#ifndef LOG_ERR
+# define LOG_ERR 3
+#endif
+#ifndef LOG_WARNING
+# define LOG_WARNING 4
+#endif
+#ifndef LOG_NOTICE
+# define LOG_NOTICE 5
+#endif
+#ifndef LOG_INFO
+# define LOG_INFO 6
+#endif
+#ifndef LOG_DEBUG
+# define LOG_DEBUG 7
+#endif
+
 /*
- *
+ * Public data types
  */
+typedef unsigned long long counter_t;
+typedef double gauge_t;
+
+union value_u
+{
+	counter_t counter;
+	gauge_t   gauge;
+};
+typedef union value_u value_t;
+
+struct value_list_s
+{
+	value_t *values;
+	int      values_len;
+	time_t   time;
+	char     host[DATA_MAX_NAME_LEN];
+	char     plugin[DATA_MAX_NAME_LEN];
+	char     plugin_instance[DATA_MAX_NAME_LEN];
+	char     type_instance[DATA_MAX_NAME_LEN];
+};
+typedef struct value_list_s value_list_t;
+
+#define VALUE_LIST_INIT { NULL, 0, 0, "localhost", "", "", "" }
+
+struct data_source_s
+{
+	char   name[DATA_MAX_NAME_LEN];
+	int    type;
+	double min;
+	double max;
+};
+typedef struct data_source_s data_source_t;
+
+struct data_set_s
+{
+	char           type[DATA_MAX_NAME_LEN];
+	int            ds_num;
+	data_source_t *ds;
+};
+typedef struct data_set_s data_set_t;
+
 typedef struct complain_s
 {
 	unsigned int interval; /* how long we wait for reporting this error again */
 	unsigned int delay;    /* how many more iterations we still need to wait */
 } complain_t;
 
@@ -46,92 +107,90 @@
  *  If `dir' is NULL the compiled in default `PLUGINDIR' is used.
  */
 void plugin_set_dir (const char *dir);
 
 /*
  * NAME
- *  plugin_count
- *
- * DESCRIPTION
- *  trivial
- *
- * RETURN VALUE
- *  The number of currently loaded plugins
- */
-int plugin_count (void);
-
-/*
- * NAME
- *  plugin_exists
- *
- * DESCRIPTION
- *  trivial
- *
- * ARGUMENTS
- *  `type'      Name of the plugin.
- *
- * RETURN VALUE
- *  Returns non-zero if a plugin with the name $type is found and zero
- *  otherwise.
- */
-int plugin_exists (char *type);
-
-/*
- * NAME
  *  plugin_load
  *
  * DESCRIPTION
  *  Searches the current `plugindir' (see `plugin_set_dir') for the plugin
  *  named $type and loads it. Afterwards the plugin's `module_register'
  *  function is called, which then calls `plugin_register' to register callback
  *  functions.
  *
  * ARGUMENTS
- *  `type'      Name of the plugin to load.
+ *  `name'      Name of the plugin to load.
+ *  `mr'        Types of functions to request from the plugin.
  *
  * RETURN VALUE
  *  Returns zero upon success, a value greater than zero if no plugin was found
  *  and a value below zero if an error occurs.
  *
  * NOTES
  *  No attempt is made to re-load an already loaded module.
  */
-int  plugin_load (const char *type);
+int plugin_load (const char *name);
 
-int  plugin_load_all (char *dir);
 void plugin_init_all (void);
 void plugin_read_all (const int *loop);
-
 void plugin_shutdown_all (void);
 
-void plugin_register (char *type,
-		void (*init) (void),
-		void (*read) (void),
-		void (*write) (char *, char *, char *));
-
-int plugin_register_shutdown (char *, void (*) (void));
+/*
+ * The `plugin_register_*' functions are used to make `config', `init',
+ * `read', `write' and `shutdown' functions known to the plugin
+ * infrastructure. Also, the data-formats are made public like this.
+ */
+int plugin_register_config (const char *name,
+		int (*callback) (const char *key, const char *val),
+		const char **keys, int keys_num);
+int plugin_register_init (const char *name,
+		int (*callback) (void));
+int plugin_register_read (const char *name,
+		int (*callback) (void));
+int plugin_register_write (const char *name,
+		int (*callback) (const data_set_t *ds, const value_list_t *vl));
+int plugin_register_shutdown (char *name,
+		int (*callback) (void));
+int plugin_register_data_set (const data_set_t *ds);
+int plugin_register_log (char *name,
+		void (*callback) (int, const char *));
+
+int plugin_unregister_config (const char *name);
+int plugin_unregister_init (const char *name);
+int plugin_unregister_read (const char *name);
+int plugin_unregister_write (const char *name);
+int plugin_unregister_shutdown (const char *name);
+int plugin_unregister_data_set (const char *name);
+int plugin_unregister_log (const char *name);
 
 /*
  * NAME
- *  plugin_write
+ *  plugin_dispatch_values
  *
  * DESCRIPTION
- *  Searches the plugin for `type' in the plugin-list. If found, and a `write'
- *  function is registered, it's called. If either the plugin is not found or
- *  the plugin doesn't provide a `write' function this function will return
- *  without further notice.
+ *  This function is called by reading processes with the values they've
+ *  aquired. The function fetches the data-set definition (that has been
+ *  registered using `plugin_register_data_set') and calls _all_ registered
+ *  write-functions.
  *
  * ARGUMENTS
- *  `host'      Host(name) from which the data originates.
- *  `type'      Name of the plugin.
- *  `inst'      Instance (passed to the plugin's `write' function.
- *  `val'       Values for the RRD files. Also passed to the plugin.
- */
-void plugin_write    (char *host, char *type, char *inst, char *val);
-
-void plugin_submit   (char *type, char *inst, char *val);
-
+ *  `name'      Name/type of the data-set that describe the values in `vl'.
+ *  `vl'        Value list of the values that have been read by a `read'
+ *              function.
+ */
+int plugin_dispatch_values (const char *name, value_list_t *vl);
+
+void plugin_log (int level, const char *format, ...);
+#define ERROR(...)   plugin_log (LOG_ERR,     __VA_ARGS__)
+#define WARNING(...) plugin_log (LOG_WARNING, __VA_ARGS__)
+#define NOTICE(...)  plugin_log (LOG_NOTICE,  __VA_ARGS__)
+#define INFO(...)    plugin_log (LOG_INFO,    __VA_ARGS__)
+#define DEBUG(...)   plugin_log (LOG_DEBUG,   __VA_ARGS__)
 
+/* TODO: Move plugin_{complain,relief} into `utils_complain.[ch]'. -octo */
 void plugin_complain (int level, complain_t *c, const char *format, ...);
 void plugin_relief (int level, complain_t *c, const char *format, ...);
 
+const data_set_t *plugin_get_ds (const char *name);
+
 #endif /* PLUGIN_H */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/processes.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/processes.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/processes.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/processes.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,10 +1,10 @@
 /**
  * collectd - src/processes.c
  * Copyright (C) 2005  Lyonel Vincent
- * Copyright (C) 2006  Florian Forster (Mach code)
+ * Copyright (C) 2006-2007  Florian Forster (Mach code)
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
  * Free Software Foundation; either version 2 of the License, or (at your
  * option) any later version.
  *
@@ -22,13 +22,12 @@
  *   Florian octo Forster <octo at verplant.org>
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
-#include "utils_debug.h"
 #include "configfile.h"
 
 /* Include header files for the mach system, if they exist.. */
 #if HAVE_THREAD_INFO
 #  if HAVE_MACH_MACH_INIT_H
 #    include <mach/mach_init.h>
@@ -90,65 +89,15 @@
 #else
 # define PROCESSES_HAVE_READ 0
 #endif
 
 #define BUFSIZE 256
 
-static char *processes_file = "processes.rrd";
-static char *processes_ds_def[] =
-{
-	"DS:running:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:sleeping:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:zombies:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:stopped:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:paging:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:blocked:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int processes_ds_num = 6;
-
-static char *ps_rss_file = "processes/ps_rss-%s.rrd";
-static char *ps_rss_ds_def[] =
-{
-	/* max = 2^63 - 1 */
-	"DS:byte:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ps_rss_ds_num = 1;
-
-static char *ps_cputime_file = "processes/ps_cputime-%s.rrd";
-static char *ps_cputime_ds_def[] =
-{
-	/* 1 second in user-mode per second ought to be enough.. */
-	"DS:user:COUNTER:"COLLECTD_HEARTBEAT":0:1000000",
-	"DS:syst:COUNTER:"COLLECTD_HEARTBEAT":0:1000000",
-	NULL
-};
-static int ps_cputime_ds_num = 2;
-
-static char *ps_count_file = "processes/ps_count-%s.rrd";
-static char *ps_count_ds_def[] =
-{
-	"DS:processes:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:threads:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int ps_count_ds_num = 2;
-
-static char *ps_pagefaults_file = "processes/ps_pagefaults-%s.rrd";
-static char *ps_pagefaults_ds_def[] =
-{
-	/* max = 2^63 - 1 */
-	"DS:minflt:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:majflt:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ps_pagefaults_ds_num = 2;
-
+#if PROCESSES_HAVE_READ
 #if HAVE_THREAD_INFO | KERNEL_LINUX
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Process",
 	NULL
 };
 static int config_keys_num = 1;
 #endif
@@ -378,13 +327,13 @@
 		pse_prev = NULL;
 		pse = ps->instances;
 		while (pse != NULL)
 		{
 			if (pse->age > 10)
 			{
-				DBG ("Removing this procstat entry cause it's too old: "
+				DEBUG ("Removing this procstat entry cause it's too old: "
 						"id = %lu; name = %s;",
 						pse->id, ps->name);
 
 				if (pse_prev == NULL)
 				{
 					ps->instances = pse->next;
@@ -405,13 +354,13 @@
 				pse = pse->next;
 			}
 		} /* while (pse != NULL) */
 	} /* for (ps = list_head_g; ps != NULL; ps = ps->next) */
 }
 
-static int ps_config (char *key, char *value)
+static int ps_config (const char *key, const char *value)
 {
 	if (strcasecmp (key, "Process") == 0)
 	{
 		ps_list_register (value);
 	}
 	else
@@ -420,13 +369,13 @@
 	}
 
 	return (0);
 }
 #endif /* HAVE_THREAD_INFO | KERNEL_LINUX */
 
-static void ps_init (void)
+static int ps_init (void)
 {
 #if HAVE_THREAD_INFO
 	kern_return_t status;
 
 	port_host_self = mach_host_self ();
 	port_task_self = mach_task_self ();
@@ -441,155 +390,85 @@
 	}
 
 	if ((status = host_processor_sets (port_host_self,
 					&pset_list,
 				       	&pset_list_len)) != KERN_SUCCESS)
 	{
-		syslog (LOG_ERR, "host_processor_sets failed: %s\n",
+		ERROR ("host_processor_sets failed: %s\n",
 			       	mach_error_string (status));
 		pset_list = NULL;
 		pset_list_len = 0;
-		return;
+		return (-1);
 	}
 /* #endif HAVE_THREAD_INFO */
 
 #elif KERNEL_LINUX
 	pagesize_g = sysconf(_SC_PAGESIZE);
-	DBG ("pagesize_g = %li; CONFIG_HZ = %i;",
+	DEBUG ("pagesize_g = %li; CONFIG_HZ = %i;",
 			pagesize_g, CONFIG_HZ);
 #endif /* KERNEL_LINUX */
 
-	return;
-}
-
-static void ps_write (char *host, char *inst, char *val)
-{
-	rrd_update_file (host, processes_file, val,
-			processes_ds_def, processes_ds_num);
-}
-
-static void ps_rss_write (char *host, char *inst, char *val)
-{
-	char filename[256];
-	int status;
-
-	status = snprintf (filename, 256, ps_rss_file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	rrd_update_file (host, filename, val, ps_rss_ds_def, ps_rss_ds_num);
-}
-
-static void ps_cputime_write (char *host, char *inst, char *val)
-{
-	char filename[256];
-	int status;
-
-	status = snprintf (filename, 256, ps_cputime_file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	DBG ("host = %s; filename = %s; val = %s;",
-			host, filename, val);
-	rrd_update_file (host, filename, val,
-			ps_cputime_ds_def, ps_cputime_ds_num);
-}
-
-static void ps_count_write (char *host, char *inst, char *val)
-{
-	char filename[256];
-	int status;
-
-	status = snprintf (filename, 256, ps_count_file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	DBG ("host = %s; filename = %s; val = %s;",
-			host, filename, val);
-	rrd_update_file (host, filename, val,
-			ps_count_ds_def, ps_count_ds_num);
-}
-
-static void ps_pagefaults_write (char *host, char *inst, char *val)
-{
-	char filename[256];
-	int status;
-
-	status = snprintf (filename, 256, ps_pagefaults_file, inst);
-	if ((status < 1) || (status >= 256))
-		return;
-
-	DBG ("host = %s; filename = %s; val = %s;",
-			host, filename, val);
-	rrd_update_file (host, filename, val,
-			ps_pagefaults_ds_def, ps_pagefaults_ds_num);
-}
+	return (0);
+} /* int ps_init */
 
-#if PROCESSES_HAVE_READ
-static void ps_submit (int running,
-		int sleeping,
-		int zombies,
-		int stopped,
-		int paging,
-		int blocked)
+static void ps_submit_state (const char *state, double value)
 {
-	char buf[BUFSIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (buf, BUFSIZE, "%u:%i:%i:%i:%i:%i:%i",
-				(unsigned int) curtime,
-				running, sleeping, zombies, stopped, paging,
-				blocked) >= BUFSIZE)
-		return;
+	values[0].gauge = value;
 
-	DBG ("running = %i; sleeping = %i; zombies = %i; stopped = %i; paging = %i; blocked = %i;",
-			running, sleeping, zombies, stopped, paging, blocked);
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "processes");
+	strcpy (vl.plugin_instance, "");
+	strncpy (vl.type_instance, state, sizeof (vl.type_instance));
 
-	plugin_submit (MODULE_NAME, "-", buf);
+	plugin_dispatch_values ("ps_state", &vl);
 }
 
 static void ps_submit_proc_list (procstat_t *ps)
 {
-	char buffer[64];
-
-	if (ps == NULL)
-		return;
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	snprintf (buffer, 64, "%u:%lu",
-			(unsigned int) curtime,
-			ps->vmem_rss);
-	buffer[63] = '\0';
-	plugin_submit ("ps_rss", ps->name, buffer);
-
-	snprintf (buffer, 64, "%u:%u:%u",
-			(unsigned int) curtime,
-			/* Make the counter overflow */
-			(unsigned int) (ps->cpu_user_counter   & 0xFFFFFFFF),
-			(unsigned int) (ps->cpu_system_counter & 0xFFFFFFFF));
-	buffer[63] = '\0';
-	plugin_submit ("ps_cputime", ps->name, buffer);
-
-	snprintf (buffer, 64, "%u:%lu:%lu",
-			(unsigned int) curtime,
-			ps->num_proc, ps->num_lwp);
-	buffer[63] = '\0';
-	plugin_submit ("ps_count", ps->name, buffer);
-
-	snprintf (buffer, 64, "%u:%lu:%lu",
-			(unsigned int) curtime,
-			ps->vmem_minflt_counter, ps->vmem_majflt_counter);
-	buffer[63] = '\0';
-	plugin_submit ("ps_pagefaults", ps->name, buffer);
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "processes");
+	strncpy (vl.plugin_instance, ps->name, sizeof (vl.plugin_instance));
+
+	vl.values[0].gauge = ps->vmem_rss;
+	vl.values_len = 1;
+	plugin_dispatch_values ("ps_rss", &vl);
+
+	vl.values[0].counter = ps->cpu_user_counter;
+	vl.values[1].counter = ps->cpu_system_counter;
+	vl.values_len = 2;
+	plugin_dispatch_values ("ps_cputime", &vl);
+
+	vl.values[0].gauge = ps->num_proc;
+	vl.values[1].gauge = ps->num_lwp;
+	vl.values_len = 2;
+	plugin_dispatch_values ("ps_count", &vl);
+
+	vl.values[0].counter = ps->vmem_minflt_counter;
+	vl.values[1].counter = ps->vmem_majflt_counter;
+	vl.values_len = 2;
+	plugin_dispatch_values ("ps_pagefaults", &vl);
 
-	DBG ("name = %s; num_proc = %lu; num_lwp = %lu; vmem_rss = %lu; "
+	DEBUG ("name = %s; num_proc = %lu; num_lwp = %lu; vmem_rss = %lu; "
 			"vmem_minflt_counter = %lu; vmem_majflt_counter = %lu; "
 			"cpu_user_counter = %lu; cpu_system_counter = %lu;",
 			ps->name, ps->num_proc, ps->num_lwp, ps->vmem_rss,
-			ps->vmem_minflt_counter, ps->vmem_majflt_counter, ps->cpu_user_counter,
-			ps->cpu_system_counter);
-
-}
+			ps->vmem_minflt_counter, ps->vmem_majflt_counter,
+		       	ps->cpu_user_counter, ps->cpu_system_counter);
+} /* void ps_submit_proc_list */
 
 #if KERNEL_LINUX
 static int *ps_read_tasks (int pid)
 {
 	int *list = NULL;
 	int  list_size = 1; /* size of allocated space, in elements */
@@ -601,13 +480,13 @@
 
 	snprintf (dirname, 64, "/proc/%i/task", pid);
 	dirname[63] = '\0';
 
 	if ((dh = opendir (dirname)) == NULL)
 	{
-		DBG ("Failed to open directory `%s'", dirname);
+		DEBUG ("Failed to open directory `%s'", dirname);
 		return (NULL);
 	}
 
 	while ((ent = readdir (dh)) != NULL)
 	{
 		if (!isdigit (ent->d_name[0]))
@@ -621,13 +500,13 @@
 
 			new_ptr = (int *) realloc (list, (size_t) (sizeof (int) * new_size));
 			if (new_ptr == NULL)
 			{
 				if (list != NULL)
 					free (list);
-				syslog (LOG_ERR, "processes plugin: "
+				ERROR ("processes plugin: "
 						"Failed to allocate more memory.");
 				return (NULL);
 			}
 
 			list = new_ptr;
 			list_size = new_size;
@@ -639,20 +518,17 @@
 		if (list[list_len] != 0)
 			list_len++;
 	}
 
 	closedir (dh);
 
-	if (list_len == 0)
-		return (NULL);
-
 	assert (list_len < list_size);
 	assert (list[list_len] == 0);
 
 	return (list);
-} /* int *ps_read_tasks */
+}
 
 int ps_read_process (int pid, procstat_t *ps, char *state)
 {
 	char  filename[64];
 	char  buffer[1024];
 	FILE *fh;
@@ -686,36 +562,33 @@
 
 	fclose (fh);
 
 	fields_len = strsplit (buffer, fields, 64);
 	if (fields_len < 24)
 	{
-		DBG ("`%s' has only %i fields..",
-				filename, fields_len);
+		DEBUG ("processes plugin: ps_read_process (pid = %i):"
+				" `%s' has only %i fields..",
+				(int) pid, filename, fields_len);
 		return (-1);
 	}
-	else if (fields_len != 41)
-	{
-		DBG ("WARNING: (fields_len = %i) != 41", fields_len);
-	}
 
 	/* copy the name, strip brackets in the process */
 	name_len = strlen (fields[1]) - 2;
 	if ((fields[1][0] != '(') || (fields[1][name_len + 1] != ')'))
 	{
-		DBG ("No brackets found in process name: `%s'", fields[1]);
+		DEBUG ("No brackets found in process name: `%s'", fields[1]);
 		return (-1);
 	}
 	fields[1] = fields[1] + 1;
 	fields[1][name_len] = '\0';
 	strncpy (ps->name, fields[1], PROCSTAT_NAME_LEN);
 
 	ppid = atoi (fields[3]);
 
  	*state = fields[2][0];
- 
+
  	if (*state == 'Z')
   	{
   		ps->num_lwp  = 0;
   		ps->num_proc = 0;
   	}
  	else if ((tasks = ps_read_tasks (pid)) == NULL)
@@ -735,13 +608,13 @@
 		tasks = NULL;
 	}
 
  	/* Leave the rest at zero if this is only a zombi */
 	if (ps->num_proc == 0)
 	{
- 		DBG ("This is only a zombi: pid = %i; name = %s;",
+		DEBUG ("This is only a zombi: pid = %i; name = %s;",
 				pid, ps->name);
 		return (0);
 	}
 
 	cpu_user_counter   = atoll (fields[13]);
 	cpu_system_counter = atoll (fields[14]);
@@ -786,23 +659,23 @@
 	if (name_max_len > (MAXCOMLEN + 1))
 		name_max_len = MAXCOMLEN + 1;
 
 	strncpy (name, kp.kp_proc.p_comm, name_max_len - 1);
 	name[name_max_len - 1] = '\0';
 
-	DBG ("pid = %i; name = %s;", *pid, name);
+	DEBUG ("pid = %i; name = %s;", *pid, name);
 
 	/* We don't do the special handling for `p_comm == "LaunchCFMApp"' as
 	 * `top' does it, because it is a lot of work and only used when
 	 * debugging. -octo */
 
 	return (0);
 }
 #endif /* HAVE_THREAD_INFO */
 
-static void ps_read (void)
+static int ps_read (void)
 {
 #if HAVE_THREAD_INFO
 	kern_return_t            status;
 
 	int                      pset;
 	processor_set_t          port_pset_priv;
@@ -842,22 +715,22 @@
 	for (pset = 0; pset < pset_list_len; pset++)
 	{
 		if ((status = host_processor_set_priv (port_host_self,
 						pset_list[pset],
 						&port_pset_priv)) != KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "host_processor_set_priv failed: %s\n",
+			ERROR ("host_processor_set_priv failed: %s\n",
 					mach_error_string (status));
 			continue;
 		}
 
 		if ((status = processor_set_tasks (port_pset_priv,
 						&task_list,
 						&task_list_len)) != KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "processor_set_tasks failed: %s\n",
+			ERROR ("processor_set_tasks failed: %s\n",
 					mach_error_string (status));
 			mach_port_deallocate (port_task_self, port_pset_priv);
 			continue;
 		}
 
 		for (task = 0; task < task_list_len; task++)
@@ -885,37 +758,37 @@
 				status = task_info (task_list[task],
 						TASK_BASIC_INFO,
 						(task_info_t) &task_basic_info,
 						&task_basic_info_len);
 				if (status != KERN_SUCCESS)
 				{
-					syslog (LOG_ERR, "task_info failed: %s",
+					ERROR ("task_info failed: %s",
 							mach_error_string (status));
 					continue; /* with next thread_list */
 				}
 
 				task_events_info_len = TASK_EVENTS_INFO_COUNT;
 				status = task_info (task_list[task],
 						TASK_EVENTS_INFO,
 						(task_info_t) &task_events_info,
 						&task_events_info_len);
 				if (status != KERN_SUCCESS)
 				{
-					syslog (LOG_ERR, "task_info failed: %s",
+					ERROR ("task_info failed: %s",
 							mach_error_string (status));
 					continue; /* with next thread_list */
 				}
 
 				task_absolutetime_info_len = TASK_ABSOLUTETIME_INFO_COUNT;
 				status = task_info (task_list[task],
 						TASK_ABSOLUTETIME_INFO,
 						(task_info_t) &task_absolutetime_info,
 						&task_absolutetime_info_len);
 				if (status != KERN_SUCCESS)
 				{
-					syslog (LOG_ERR, "task_info failed: %s",
+					ERROR ("task_info failed: %s",
 							mach_error_string (status));
 					continue; /* with next thread_list */
 				}
 
 				pse.num_proc++;
 				pse.vmem_rss = task_basic_info.resident_size;
@@ -933,13 +806,13 @@
 			{
 				/* Apple's `top' treats this case a zombie. It
 				 * makes sense to some extend: A `zombie'
 				 * thread is nonsense, since the task/process
 				 * is dead. */
 				zombies++;
-				DBG ("task_threads failed: %s",
+				DEBUG ("task_threads failed: %s",
 						mach_error_string (status));
 				if (task_list[task] != port_task_self)
 					mach_port_deallocate (port_task_self,
 							task_list[task]);
 				continue; /* with next task_list */
 			}
@@ -950,13 +823,13 @@
 				status = thread_info (thread_list[thread],
 						THREAD_BASIC_INFO,
 						(thread_info_t) &thread_data,
 						&thread_data_len);
 				if (status != KERN_SUCCESS)
 				{
-					syslog (LOG_ERR, "thread_info failed: %s",
+					ERROR ("thread_info failed: %s",
 							mach_error_string (status));
 					if (task_list[task] != port_task_self)
 						mach_port_deallocate (port_task_self,
 								thread_list[thread]);
 					continue; /* with next thread_list */
 				}
@@ -982,34 +855,33 @@
 						break;
 					/* There is no `zombie' case here,
 					 * since there are no zombie-threads.
 					 * There's only zombie tasks, which are
 					 * handled above. */
 					default:
-						syslog (LOG_WARNING,
-								"Unknown thread status: %s",
+						WARNING ("Unknown thread status: %s",
 								thread_data.run_state);
 						break;
 				} /* switch (thread_data.run_state) */
 
 				if (task_list[task] != port_task_self)
 				{
 					status = mach_port_deallocate (port_task_self,
 							thread_list[thread]);
 					if (status != KERN_SUCCESS)
-						syslog (LOG_ERR, "mach_port_deallocate failed: %s",
+						ERROR ("mach_port_deallocate failed: %s",
 								mach_error_string (status));
 				}
 			} /* for (thread_list) */
 
 			if ((status = vm_deallocate (port_task_self,
 							(vm_address_t) thread_list,
 							thread_list_len * sizeof (thread_act_t)))
 					!= KERN_SUCCESS)
 			{
-				syslog (LOG_ERR, "vm_deallocate failed: %s",
+				ERROR ("vm_deallocate failed: %s",
 						mach_error_string (status));
 			}
 			thread_list = NULL;
 			thread_list_len = 0;
 
 			/* Only deallocate the task port, if it isn't our own.
@@ -1017,39 +889,43 @@
 			 * is what Apple's top does.. ;) */
 			if (task_list[task] != port_task_self)
 			{
 				status = mach_port_deallocate (port_task_self,
 						task_list[task]);
 				if (status != KERN_SUCCESS)
-					syslog (LOG_ERR, "mach_port_deallocate failed: %s",
+					ERROR ("mach_port_deallocate failed: %s",
 							mach_error_string (status));
 			}
 
 			if (ps != NULL)
 				ps_list_add (task_name, &pse);
 		} /* for (task_list) */
 
 		if ((status = vm_deallocate (port_task_self,
 				(vm_address_t) task_list,
 				task_list_len * sizeof (task_t))) != KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "vm_deallocate failed: %s",
+			ERROR ("vm_deallocate failed: %s",
 					mach_error_string (status));
 		}
 		task_list = NULL;
 		task_list_len = 0;
 
 		if ((status = mach_port_deallocate (port_task_self, port_pset_priv))
 				!= KERN_SUCCESS)
 		{
-			syslog (LOG_ERR, "mach_port_deallocate failed: %s",
+			ERROR ("mach_port_deallocate failed: %s",
 					mach_error_string (status));
 		}
 	} /* for (pset_list) */
 
-	ps_submit (running, sleeping, zombies, stopped, -1, blocked);
+	ps_submit_state ("running", running);
+	ps_submit_state ("sleeping", sleeping);
+	ps_submit_state ("zombies", zombies);
+	ps_submit_state ("stopped", stopped);
+	ps_submit_state ("blocked", blocked);
 
 	for (ps = list_head_g; ps != NULL; ps = ps->next)
 		ps_submit_proc_list (ps);
 /* #endif HAVE_THREAD_INFO */
 
 #elif KERNEL_LINUX
@@ -1073,14 +949,16 @@
 
 	running = sleeping = zombies = stopped = paging = blocked = 0;
 	ps_list_reset ();
 
 	if ((proc = opendir ("/proc")) == NULL)
 	{
-		syslog (LOG_ERR, "Cannot open `/proc': %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		ERROR ("Cannot open `/proc': %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	while ((ent = readdir (proc)) != NULL)
 	{
 		if (!isdigit (ent->d_name[0]))
 			continue;
@@ -1088,13 +966,13 @@
 		if ((pid = atoi (ent->d_name)) < 1)
 			continue;
 
 		status = ps_read_process (pid, &ps, &state);
 		if (status != 0)
 		{
-			DBG ("ps_read_process failed: %i", status);
+			DEBUG ("ps_read_process failed: %i", status);
 			continue;
 		}
 
 		pse.id       = pid;
 		pse.age      = 0;
 
@@ -1124,30 +1002,32 @@
 
 		ps_list_add (ps.name, &pse);
 	}
 
 	closedir (proc);
 
-	ps_submit (running, sleeping, zombies, stopped, paging, blocked);
+	ps_submit_state ("running",  running);
+	ps_submit_state ("sleeping", sleeping);
+	ps_submit_state ("zombies",  zombies);
+	ps_submit_state ("stopped",  stopped);
+	ps_submit_state ("paging",   paging);
+	ps_submit_state ("blocked",  blocked);
 
 	for (ps_ptr = list_head_g; ps_ptr != NULL; ps_ptr = ps_ptr->next)
 		ps_submit_proc_list (ps_ptr);
 #endif /* KERNEL_LINUX */
-}
-#else
-# define ps_read NULL
+
+	return (0);
+} /* int ps_read */
 #endif /* PROCESSES_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, ps_init, ps_read, ps_write);
-	plugin_register ("ps_rss", NULL, NULL, ps_rss_write);
-	plugin_register ("ps_cputime", NULL, NULL, ps_cputime_write);
-	plugin_register ("ps_count", NULL, NULL, ps_count_write);
-	plugin_register ("ps_pagefaults", NULL, NULL, ps_pagefaults_write);
+#if PROCESSES_HAVE_READ
 #if HAVE_THREAD_INFO | KERNEL_LINUX
-	cf_register (MODULE_NAME, ps_config, config_keys, config_keys_num);
+	plugin_register_config ("processes", ps_config,
+			config_keys, config_keys_num);
 #endif
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+	plugin_register_init ("processes", ps_init);
+	plugin_register_read ("processes", ps_read);
+#endif /* PROCESSES_HAVE_READ */
+} /* void module_register */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: rrdtool.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/sensors.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/sensors.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/sensors.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/sensors.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/sensors.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -31,16 +30,12 @@
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 #include "configfile.h"
 #include "utils_ignorelist.h"
-#include "utils_debug.h"
-
-#define MODULE_NAME "sensors"
-#define MODULE_NAME_VOLTAGE MODULE_NAME"_voltage"
 
 #if defined(HAVE_SENSORS_SENSORS_H)
 # include <sensors/sensors.h>
 #else
 # undef HAVE_LIBSENSORS
 #endif
@@ -48,63 +43,37 @@
 #if defined(HAVE_LIBSENSORS)
 # define SENSORS_HAVE_READ 1
 #else
 # define SENSORS_HAVE_READ 0
 #endif
 
-#define BUFSIZE 512
-
-/* temperature and fan sensors */
-static char *ds_def[] =
-{
-	"DS:value:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int ds_num = 1;
-
-/* voltage sensors */
-static char *sensor_voltage_ds_def[] = 
-{
-	"DS:voltage:GAUGE:"COLLECTD_HEARTBEAT":U:U",
-	NULL
-};
-static int sensor_voltage_ds_num = 1;
-
-/* old naming */
-static char *old_filename_format = "sensors-%s.rrd";
-/* end old naming */
-
-/* new naming <chip-bus-address/type-feature */
-static char *extended_filename_format = "lm_sensors-%s.rrd";
-
-#define SENSOR_TYPE_UNKNOWN 0
-#define SENSOR_TYPE_VOLTAGE 1
-#define SENSOR_TYPE_FANSPEED 2
-#define SENSOR_TYPE_TEMPERATURE 3
-
 #if SENSORS_HAVE_READ
-static char *sensor_type_prefix[] =
+#define SENSOR_TYPE_VOLTAGE     0
+#define SENSOR_TYPE_FANSPEED    1
+#define SENSOR_TYPE_TEMPERATURE 2
+#define SENSOR_TYPE_UNKNOWN     3
+
+static char *sensor_to_type[] =
 {
-	"unknown",
 	"voltage",
 	"fanspeed",
 	"temperature",
 	NULL
 };
-#endif
 
-typedef struct sensors_labeltypes {
+struct sensors_labeltypes_s
+{
 	char *label;
 	int type;
-} sensors_labeltypes;
+};
+typedef struct sensors_labeltypes_s sensors_labeltypes_t;
 
 /*
  * finite list of known labels extracted from lm_sensors
  */
-#if SENSORS_HAVE_READ
-static sensors_labeltypes known_features[] = 
+static sensors_labeltypes_t known_features[] = 
 {
 	{ "fan1", SENSOR_TYPE_FANSPEED },
 	{ "fan2", SENSOR_TYPE_FANSPEED },
 	{ "fan3", SENSOR_TYPE_FANSPEED },
 	{ "fan4", SENSOR_TYPE_FANSPEED },
 	{ "fan5", SENSOR_TYPE_FANSPEED },
@@ -151,40 +120,30 @@
 	{ "vrm", SENSOR_TYPE_VOLTAGE },
 	{ "5.0V", SENSOR_TYPE_VOLTAGE },
 	{ "5V", SENSOR_TYPE_VOLTAGE },
 	{ "3.3V", SENSOR_TYPE_VOLTAGE },
 	{ "2.5V", SENSOR_TYPE_VOLTAGE },
 	{ "2.0V", SENSOR_TYPE_VOLTAGE },
-	{ "12V", SENSOR_TYPE_VOLTAGE },
-	{ 0, -1 }
+	{ "12V", SENSOR_TYPE_VOLTAGE }
 };
-#endif
+static int known_features_num = STATIC_ARRAY_SIZE (known_features);
 /* end new naming */
 
-static char *config_keys[] =
+static const char *config_keys[] =
 {
 	"Sensor",
 	"IgnoreSelected",
-	"ExtendedSensorNaming",
 	NULL
 };
-static int config_keys_num = 3;
+static int config_keys_num = 2;
 
 static ignorelist_t *sensor_list;
 
-/* 
- * sensor_extended_naming:
- * 0 => default is to create chip-feature
- * 1 => use new naming scheme chip-bus-address/type-feature
- */
-static int sensor_extended_naming = 0;
-
-#if SENSORS_HAVE_READ
-#  ifndef SENSORS_CONF_PATH
-#    define SENSORS_CONF_PATH "/etc/sensors.conf"
-#  endif
+#ifndef SENSORS_CONF_PATH
+# define SENSORS_CONF_PATH "/etc/sensors.conf"
+#endif
 
 static const char *conffile = SENSORS_CONF_PATH;
 /* SENSORS_CONF_PATH */
 
 /*
  * remember stat of the loaded config
@@ -197,53 +156,43 @@
 	const sensors_feature_data *data;
 	int                         type;
 	struct featurelist         *next;
 } featurelist_t;
 
 featurelist_t *first_feature = NULL;
-#endif /* if SENSORS_HAVE_READ */
 
-static int sensors_config (char *key, char *value)
+static int sensors_config (const char *key, const char *value)
 {
 	if (sensor_list == NULL)
 		sensor_list = ignorelist_create (1);
 
 	if (strcasecmp (key, "Sensor") == 0)
 	{
 		if (ignorelist_add (sensor_list, value))
 		{
-			syslog (LOG_EMERG, MODULE_NAME": Cannot add value to ignorelist.");
+			ERROR ("sensors plugin: "
+					"Cannot add value to ignorelist.");
 			return (1);
 		}
 	}
 	else if (strcasecmp (key, "IgnoreSelected") == 0)
 	{
 		ignorelist_set_invert (sensor_list, 1);
 		if ((strcasecmp (value, "True") == 0)
 				|| (strcasecmp (value, "Yes") == 0)
 				|| (strcasecmp (value, "On") == 0))
 			ignorelist_set_invert (sensor_list, 0);
 	}
-	else if (strcasecmp (key, "ExtendedSensorNaming") == 0)
-	{
-		if ((strcasecmp (value, "True") == 0)
-				|| (strcasecmp (value, "Yes") == 0)
-				|| (strcasecmp (value, "On") == 0))
-			sensor_extended_naming = 1;
-		else
-			sensor_extended_naming = 0;
-	}
 	else
 	{
 		return (-1);
 	}
 
 	return (0);
 }
 
-#if SENSORS_HAVE_READ
 void sensors_free_features (void)
 {
 	featurelist_t *thisft;
 	featurelist_t *nextft;
 
 	if (first_feature == NULL)
@@ -256,13 +205,13 @@
 		nextft = thisft->next;
 		sfree (thisft);
 	}
 	first_feature = NULL;
 }
 
-static void sensors_load_conf (void)
+static int sensors_load_conf (void)
 {
 	FILE *fh;
 	featurelist_t *last_feature = NULL;
 	featurelist_t *new_feature = NULL;
 	
 	const sensors_chip_name *chip;
@@ -274,44 +223,46 @@
 	struct stat statbuf;
 	int status;
 	
 	status = stat (conffile, &statbuf);
 	if (status != 0)
 	{
-		syslog (LOG_ERR, MODULE_NAME": stat(%s) failed: %s",
-				conffile, strerror (errno));
+		char errbuf[1024];
+		ERROR ("sensors plugin: stat (%s) failed: %s", conffile,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		sensors_config_mtime = 0;
 	}
 
 	if ((sensors_config_mtime != 0)
 			&& (sensors_config_mtime == statbuf.st_mtime))
-		return;
+		return (0);
 
 	if (sensors_config_mtime != 0)
 	{
-		syslog (LOG_NOTICE, MODULE_NAME": Reloading config from %s",
+		NOTICE ("sensors plugin: Reloading config from %s",
 				conffile);
 		sensors_free_features ();
 		sensors_config_mtime = 0;
 	}
 
 	fh = fopen (conffile, "r");
 	if (fh == NULL)
 	{
-		syslog (LOG_ERR, MODULE_NAME": fopen(%s) failed: %s",
-				conffile, strerror(errno));
-		return;
+		char errbuf[1024];
+		ERROR ("sensors plugin: fopen(%s) failed: %s", conffile,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	status = sensors_init (fh);
 	fclose (fh);
 	if (status != 0)
 	{
-		syslog (LOG_ERR, MODULE_NAME": Cannot initialize sensors. "
+		ERROR ("sensors plugin: Cannot initialize sensors. "
 				"Data will not be collected.");
-		return;
+		return (-1);
 	}
 
 	sensors_config_mtime = statbuf.st_mtime;
 
 	chip_num = 0;
 	while ((chip = sensors_get_detected_chips (&chip_num)) != NULL)
@@ -326,31 +277,31 @@
 
 			/* "master features" only */
 			if (data->mapping != SENSORS_NO_MAPPING)
 				continue;
 
 			/* Only known features */
-			for (i = 0; known_features[i].type >= 0; i++)
+			for (i = 0; i < known_features_num; i++)
 			{
 				if (strcmp (data->name, known_features[i].label) != 0)
 					continue;
 
 				/* skip ignored in sensors.conf */
 				if (sensors_get_ignored (*chip, data->number) == 0)
 					break;
 
-				DBG ("Adding feature: %s-%s-%s",
+				DEBUG ("Adding feature: %s-%s-%s",
 						chip->prefix,
-						sensor_type_prefix[known_features[i].type],
+						sensor_to_type[known_features[i].type],
 						data->name);
 
 				if ((new_feature = (featurelist_t *) malloc (sizeof (featurelist_t))) == NULL)
 				{
-					DBG ("malloc: %s", strerror (errno));
-					syslog (LOG_ERR, MODULE_NAME":  malloc: %s",
-							strerror (errno));
+					char errbuf[1024];
+					ERROR ("sensors plugin: malloc: %s",
+							sstrerror (errno, errbuf, sizeof (errbuf)));
 					break;
 				}
 
 				new_feature->chip = chip;
 				new_feature->data = data;
 				new_feature->type = known_features[i].type;
@@ -373,174 +324,111 @@
 		} /* while sensors_get_all_features */
 	} /* while sensors_get_detected_chips */
 
 	if (first_feature == NULL)
 	{
 		sensors_cleanup ();
-		syslog (LOG_INFO, MODULE_NAME": lm_sensors reports no features. "
-			"Data will not be collected.");
+		INFO ("sensors plugin: lm_sensors reports no "
+				"features. Data will not be collected.");
+		return (-1);
 	}
-} /* void sensors_load_conf */
-#endif /* if SENSORS_HAVE_READ */
 
-static void collectd_sensors_init (void)
-{
-	return;
-}
+	return (0);
+} /* int sensors_load_conf */
 
-static void sensors_shutdown (void)
+static int sensors_shutdown (void)
 {
-#if SENSORS_HAVE_READ
 	sensors_free_features ();
-#endif /* if SENSORS_HAVE_READ */
-
-	if (NULL != sensor_list)
-		ignorelist_free (sensor_list);
-}
-
-static void sensors_voltage_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE];
-	int status;
-
-	/* skip ignored in our config */
-	if ((NULL != sensor_list) && ignorelist_match (sensor_list, inst))
-		return;
-
-	/* extended sensor naming */
-	if(sensor_extended_naming)
-		status = snprintf (file, BUFSIZE, extended_filename_format, inst);
-	else
-		status = snprintf (file, BUFSIZE, old_filename_format, inst);
+	ignorelist_free (sensor_list);
 
-	if ((status < 1) || (status >= BUFSIZE))
-		return;
-
-	rrd_update_file (host, file, val, sensor_voltage_ds_def, sensor_voltage_ds_num);
-}
-
-static void sensors_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE];
-	int status;
-
-	/* skip ignored in our config */
-	if ((NULL != sensor_list) && ignorelist_match (sensor_list, inst))
-		return;
-
-	/* extended sensor naming */
-	if (sensor_extended_naming)
-		status = snprintf (file, BUFSIZE, extended_filename_format, inst);
-	else
-		status = snprintf (file, BUFSIZE, old_filename_format, inst);
-
-	if ((status < 1) || (status >= BUFSIZE))
-		return;
-
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
+	return (0);
+} /* int sensors_shutdown */
 
-#if SENSORS_HAVE_READ
-static void sensors_submit (const char *feat_name,
-		const char *chip_prefix, double value, int type)
+static void sensors_submit (const char *plugin_instance,
+		const char *type, const char *type_instance,
+		double val)
 {
-	char buf[BUFSIZE];
-	char inst[BUFSIZE];
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf (inst, BUFSIZE, "%s-%s", chip_prefix, feat_name)
-			>= BUFSIZE)
+	if ((sensor_list != NULL)
+			&& (ignorelist_match (sensor_list, type_instance)))
 		return;
 
-	/* skip ignored in our config */
-	if ((NULL != sensor_list) && ignorelist_match (sensor_list, inst))
-		return;
+	values[0].gauge = val;
 
-	if (snprintf (buf, BUFSIZE, "%u:%.3f", (unsigned int) curtime,
-				value) >= BUFSIZE)
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "sensors");
+	strcpy (vl.plugin_instance, plugin_instance);
+	strcpy (vl.type_instance, type_instance);
 
-	if (type == SENSOR_TYPE_VOLTAGE)
-	{
-		DBG ("%s: %s/%s, %s", MODULE_NAME_VOLTAGE,
-				sensor_type_prefix[type], inst, buf);
-		plugin_submit (MODULE_NAME_VOLTAGE, inst, buf);
-	}
-	else
-	{
-		DBG ("%s: %s/%s, %s", MODULE_NAME,
-				sensor_type_prefix[type], inst, buf);
-		plugin_submit (MODULE_NAME, inst, buf);
-	}
-}
+	plugin_dispatch_values (type, &vl);
+} /* void sensors_submit */
 
-static void sensors_read (void)
+static int sensors_read (void)
 {
 	featurelist_t *feature;
 	double value;
-	char chip_fullprefix[BUFSIZE];
 
-	sensors_load_conf ();
+	char plugin_instance[DATA_MAX_NAME_LEN];
+	char type_instance[DATA_MAX_NAME_LEN];
+
+	if (sensors_load_conf () != 0)
+		return (-1);
 
 	for (feature = first_feature; feature != NULL; feature = feature->next)
 	{
 		if (sensors_get_feature (*feature->chip, feature->data->number, &value) < 0)
 			continue;
 
-		if (sensor_extended_naming)
+		/* full chip name logic borrowed from lm_sensors */
+		if (feature->chip->bus == SENSORS_CHIP_NAME_BUS_ISA)
 		{
-			/* full chip name logic borrowed from lm_sensors */
-			if (feature->chip->bus == SENSORS_CHIP_NAME_BUS_ISA)
-			{
-				if (snprintf (chip_fullprefix, BUFSIZE, "%s-isa-%04x/%s",
-							feature->chip->prefix,
-							feature->chip->addr,
-							sensor_type_prefix[feature->type])
-						>= BUFSIZE)
-					continue;
-			}
-			else if (feature->chip->bus == SENSORS_CHIP_NAME_BUS_DUMMY)
-			{
-				if (snprintf (chip_fullprefix, BUFSIZE, "%s-%s-%04x/%s",
-							feature->chip->prefix,
-							feature->chip->busname,
-							feature->chip->addr,
-							sensor_type_prefix[feature->type])
-						>= BUFSIZE)
-					continue;
-			}
-			else
-			{
-				if (snprintf (chip_fullprefix, BUFSIZE, "%s-i2c-%d-%02x/%s",
-							feature->chip->prefix,
-							feature->chip->bus,
-							feature->chip->addr,
-							sensor_type_prefix[feature->type])
-						>= BUFSIZE)
-					continue;
-			}
-
-			sensors_submit (feature->data->name,
-					chip_fullprefix,
-					value, feature->type);
+			if (snprintf (plugin_instance, DATA_MAX_NAME_LEN, "%s-isa-%04x",
+						feature->chip->prefix,
+						feature->chip->addr)
+					>= 512)
+				continue;
+		}
+		else if (feature->chip->bus == SENSORS_CHIP_NAME_BUS_DUMMY)
+		{
+			if (snprintf (plugin_instance, 512, "%s-%s-%04x",
+						feature->chip->prefix,
+						feature->chip->busname,
+						feature->chip->addr)
+					>= 512)
+				continue;
 		}
 		else
 		{
-			sensors_submit (feature->data->name,
-					feature->chip->prefix,
-					value, feature->type);
+			if (snprintf (plugin_instance, 512, "%s-i2c-%d-%02x",
+						feature->chip->prefix,
+						feature->chip->bus,
+						feature->chip->addr)
+					>= 512)
+				continue;
 		}
+
+		strncpy (type_instance, feature->data->name, DATA_MAX_NAME_LEN);
+
+		sensors_submit (plugin_instance,
+				sensor_to_type[feature->type],
+				type_instance,
+				value);
 	} /* for feature = first_feature .. NULL */
-} /* void sensors_read */
-#else
-# define sensors_read NULL
+
+	return (0);
+} /* int sensors_read */
 #endif /* SENSORS_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, collectd_sensors_init, sensors_read, sensors_write);
-	plugin_register (MODULE_NAME_VOLTAGE, NULL, NULL, sensors_voltage_write);
-	plugin_register_shutdown (MODULE_NAME, sensors_shutdown);
-	cf_register (MODULE_NAME, sensors_config, config_keys, config_keys_num);
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+#if SENSORS_HAVE_READ
+	plugin_register_config ("sensors", sensors_config,
+			config_keys, config_keys_num);
+	plugin_register_read ("sensors", sensors_read);
+	plugin_register_shutdown ("sensors", sensors_shutdown);
+#endif
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/serial.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/serial.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/serial.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/serial.c	2007-05-30 18:33:15.000000000 +0800
@@ -22,96 +22,66 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#define MODULE_NAME "serial"
-
 #if defined(KERNEL_LINUX)
 # define SERIAL_HAVE_READ 1
 #else
 # define SERIAL_HAVE_READ 0
 #endif
 
-static char *serial_filename_template = "serial-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int ds_num = 2;
-
-static void serial_init (void)
+#if SERIAL_HAVE_READ
+static void serial_submit (const char *type_instance,
+		counter_t rx, counter_t tx)
 {
-	return;
-}
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void serial_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
+	values[0].counter = rx;
+	values[1].counter = tx;
 
-	status = snprintf (file, 512, serial_filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "serial");
+	strncpy (vl.type_instance, type_instance,
+			sizeof (vl.type_instance));
 
-	rrd_update_file (host, file, val, ds_def, ds_num);
+	plugin_dispatch_values ("serial_octets", &vl);
 }
 
-#if SERIAL_HAVE_READ
-#define BUFSIZE 512
-static void serial_submit (char *device,
-		unsigned long long incoming,
-		unsigned long long outgoing)
-{
-	char buf[BUFSIZE];
-        
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu", (unsigned int) curtime,
-				incoming, outgoing) >= BUFSIZE)
-		return;
-
-	plugin_submit (MODULE_NAME, device, buf);
-}
-#undef BUFSIZE
-
-static void serial_read (void)
+static int serial_read (void)
 {
 #ifdef KERNEL_LINUX
-
 	FILE *fh;
 	char buffer[1024];
-	unsigned long long incoming, outgoing;
+
+	counter_t rx = 0;
+	counter_t tx = 0;
 	
 	char *fields[16];
 	int i, numfields;
 	int len;
 
 	/* there are a variety of names for the serial device */
 	if ((fh = fopen ("/proc/tty/driver/serial", "r")) == NULL &&
 		(fh = fopen ("/proc/tty/driver/ttyS", "r")) == NULL)
 	{
-		syslog (LOG_WARNING, "serial: fopen: %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		WARNING ("serial: fopen: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
-	while (fgets (buffer, 1024, fh) != NULL)
+	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
 		int have_rx = 0, have_tx = 0;
 
-		/* stupid compiler:
-		 * serial.c:87: warning: 'incoming' may be used uninitialized in this function
-		 * serial.c:87: warning: 'outgoing' may be used uninitialized in this function
-		 */
-		incoming = 0ULL;
-		outgoing = 0ULL;
-
 		numfields = strsplit (buffer, fields, 16);
 
 		if (numfields < 6)
 			continue;
 
 		/*
@@ -130,35 +100,34 @@
 			len = strlen (fields[i]);
 			if (len < 4)
 				continue;
 
 			if (strncmp (fields[i], "tx:", 3) == 0)
 			{
-				outgoing = atoll (fields[i] + 3);
+				tx = atoll (fields[i] + 3);
 				have_tx++;
 			}
 			else if (strncmp (fields[i], "rx:", 3) == 0)
 			{
-				incoming = atoll (fields[i] + 3);
+				rx = atoll (fields[i] + 3);
 				have_rx++;
 			}
 		}
 
 		if ((have_rx == 0) || (have_tx == 0))
 			continue;
 
-		serial_submit (fields[0], incoming, outgoing);
+		serial_submit (fields[0], rx, tx);
 	}
 
 	fclose (fh);
+	return (0);
 #endif /* KERNEL_LINUX */
-}
-#else
-# define serial_read NULL
+} /* int serial_read */
 #endif /* SERIAL_HAVE_READ */
 
 void module_register (void)
 {
-   plugin_register (MODULE_NAME, serial_init, serial_read, serial_write);
-}
-
-#undef MODULE_NAME
+#if SERIAL_HAVE_READ
+	plugin_register_read ("serial", serial_read);
+#endif /* SERIAL_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/swap.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/swap.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/swap.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/swap.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/swap.c
- * Copyright (C) 2005,2006  Florian octo Forster
+ * Copyright (C) 2005-2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -34,36 +33,22 @@
 #  include <sys/sysctl.h>
 #endif
 #if HAVE_KVM_H
 #  include <kvm.h>
 #endif
 
-#define MODULE_NAME "swap"
-
 #if KERNEL_LINUX || HAVE_LIBKSTAT || defined(VM_SWAPUSAGE) || HAVE_LIBKVM || HAVE_LIBSTATGRAB
 # define SWAP_HAVE_READ 1
 #else
 # define SWAP_HAVE_READ 0
 #endif
 
 #undef  MAX
 #define MAX(x,y) ((x) > (y) ? (x) : (y))
 
-static char *swap_file = "swap.rrd";
-
-/* 1099511627776 == 1TB ought to be enough for anyone ;) */
-static char *ds_def[] =
-{
-	"DS:used:GAUGE:"COLLECTD_HEARTBEAT":0:1099511627776",
-	"DS:free:GAUGE:"COLLECTD_HEARTBEAT":0:1099511627776",
-	"DS:cached:GAUGE:"COLLECTD_HEARTBEAT":0:1099511627776",
-	"DS:resv:GAUGE:"COLLECTD_HEARTBEAT":0:1099511627776",
-	NULL
-};
-static int ds_num = 4;
-
+#if SWAP_HAVE_READ
 #if KERNEL_LINUX
 /* No global variables */
 /* #endif KERNEL_LINUX */
 
 #elif HAVE_LIBKSTAT
 static unsigned long long pagesize;
@@ -80,13 +65,13 @@
 /* #endif HAVE_LIBKVM */
 
 #elif HAVE_LIBSTATGRAB
 /* No global variables */
 #endif /* HAVE_LIBSTATGRAB */
 
-static void swap_init (void)
+static int swap_init (void)
 {
 #if KERNEL_LINUX
 	/* No init stuff */
 /* #endif KERNEL_LINUX */
 
 #elif HAVE_LIBKSTAT
@@ -113,45 +98,42 @@
 					NULL, /* corefile */
 					NULL, /* swapfile */
 					O_RDONLY, /* flags */
 					NULL)) /* errstr */
 			== NULL)
 	{
-		syslog (LOG_ERR, "swap plugin: kvm_open failed.");
-		return;
+		ERROR ("swap plugin: kvm_open failed.");
+		return (-1);
 	}
 /* #endif HAVE_LIBKVM */
 
 #elif HAVE_LIBSTATGRAB
 	/* No init stuff */
 #endif /* HAVE_LIBSTATGRAB */
 
-	return;
+	return (0);
 }
 
-static void swap_write (char *host, char *inst, char *val)
+static void swap_submit (const char *type_instance, double value)
 {
-	rrd_update_file (host, swap_file, val, ds_def, ds_num);
-}
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-#if SWAP_HAVE_READ
-static void swap_submit (unsigned long long swap_used,
-		unsigned long long swap_free,
-		unsigned long long swap_cached,
-		unsigned long long swap_resv)
-{
-	char buffer[512];
+	values[0].gauge = value;
 
-	if (snprintf (buffer, 512, "%u:%llu:%llu:%llu:%llu", (unsigned int) curtime,
-				swap_used, swap_free, swap_cached, swap_resv) >= 512)
-		return;
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "swap");
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-	plugin_submit (MODULE_NAME, "-", buffer);
-}
+	plugin_dispatch_values ("swap", &vl);
+} /* void swap_submit */
 
-static void swap_read (void)
+static int swap_read (void)
 {
 #if KERNEL_LINUX
 	FILE *fh;
 	char buffer[1024];
 	
 	char *fields[8];
@@ -161,14 +143,16 @@
 	unsigned long long swap_cached = 0LL;
 	unsigned long long swap_free   = 0LL;
 	unsigned long long swap_total  = 0LL;
 
 	if ((fh = fopen ("/proc/meminfo", "r")) == NULL)
 	{
-		syslog (LOG_WARNING, "memory: fopen: %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		WARNING ("memory: fopen: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	while (fgets (buffer, 1024, fh) != NULL)
 	{
 		unsigned long long *val = NULL;
 
@@ -187,34 +171,41 @@
 			continue;
 
 		*val = atoll (fields[1]) * 1024LL;
 	}
 
 	if (fclose (fh))
-		syslog (LOG_WARNING, "memory: fclose: %s", strerror (errno));
+	{
+		char errbuf[1024];
+		WARNING ("memory: fclose: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+	}
 
 	if ((swap_total == 0LL) || ((swap_free + swap_cached) > swap_total))
-		return;
+		return (-1);
 
 	swap_used = swap_total - (swap_free + swap_cached);
 
-	swap_submit (swap_used, swap_free, swap_cached, -1LL);
+	swap_submit ("used", swap_used);
+	swap_submit ("free", swap_free);
+	swap_submit ("cached", swap_cached);
 /* #endif KERNEL_LINUX */
 
 #elif HAVE_LIBKSTAT
 	unsigned long long swap_alloc;
 	unsigned long long swap_resv;
 	unsigned long long swap_avail;
 
 	struct anoninfo ai;
 
 	if (swapctl (SC_AINFO, &ai) == -1)
 	{
-		syslog (LOG_ERR, "swap plugin: swapctl failed: %s",
-				strerror (errno));
-		return;
+		char errbuf[1024];
+		ERROR ("swap plugin: swapctl failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
 	/*
 	 * Calculations from:
 	 * http://cvs.opensolaris.org/source/xref/on/usr/src/cmd/swap/swap.c
 	 * Also see:
@@ -239,13 +230,15 @@
 	swap_alloc *= pagesize;
 	swap_resv   = ai.ani_resv + ai.ani_free - ai.ani_max;
 	swap_resv  *= pagesize;
 	swap_avail  = ai.ani_max - ai.ani_resv;
 	swap_avail *= pagesize;
 
-	swap_submit (swap_alloc, swap_avail, -1LL, swap_resv - swap_alloc);
+	swap_submit ("used", swap_alloc);
+	swap_submit ("free", swap_avail);
+	swap_submit ("reserved", swap_resv - swap_alloc);
 /* #endif HAVE_LIBKSTAT */
 
 #elif defined(VM_SWAPUSAGE)
 	int              mib[3];
 	size_t           mib_len;
 	struct xsw_usage sw_usage;
@@ -255,56 +248,64 @@
 	mib[0]  = CTL_VM;
 	mib[1]  = VM_SWAPUSAGE;
 
 	sw_usage_len = sizeof (struct xsw_usage);
 
 	if (sysctl (mib, mib_len, &sw_usage, &sw_usage_len, NULL, 0) != 0)
-		return;
+		return (-1);
 
 	/* The returned values are bytes. */
-	swap_submit (sw_usage.xsu_used, sw_usage.xsu_avail, -1LL, -1LL);
+	swap_submit ("used", sw_usage.xsu_used);
+	swap_submit ("free", sw_usage.xsu_avail);
 /* #endif VM_SWAPUSAGE */
 
 #elif HAVE_LIBKVM
 	struct kvm_swap data_s;
 	int             status;
 
 	unsigned long long used;
 	unsigned long long free;
 	unsigned long long total;
 
 	if (kvm_obj == NULL)
-		return;
+		return (-1);
 
 	/* only one structure => only get the grand total, no details */
 	status = kvm_getswapinfo (kvm_obj, &data_s, 1, 0);
 	if (status == -1)
-		return;
+		return (-1);
 
 	total = (unsigned long long) data_s.ksw_total;
 	used  = (unsigned long long) data_s.ksw_used;
 
 	total *= (unsigned long long) kvm_pagesize;
 	used  *= (unsigned long long) kvm_pagesize;
 
 	free = total - used;
 
-	swap_submit (used, free, -1LL, -1LL);
+	swap_submit ("used", used);
+	swap_submit ("free", free);
 /* #endif HAVE_LIBKVM */
 
 #elif HAVE_LIBSTATGRAB
 	sg_swap_stats *swap;
 
-	if ((swap = sg_get_swap_stats ()) != NULL)
-		swap_submit (swap->used, swap->free, -1LL, -1LL);
+	swap = sg_get_swap_stats ();
+
+	if (swap == NULL)
+		return (-1);
+
+	swap_submit ("used", swap->used);
+	swap_submit ("free", swap->free);
 #endif /* HAVE_LIBSTATGRAB */
-}
-#else
-# define swap_read NULL
+
+	return (0);
+} /* int swap_read */
 #endif /* SWAP_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, swap_init, swap_read, swap_write);
-}
-
-#undef MODULE_NAME
+#if SWAP_HAVE_READ
+	plugin_register_init ("swap", swap_init);
+	plugin_register_read ("swap", swap_read);
+#endif /* SWAP_HAVE_READ */
+} /* void module_register */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: syslog.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/tape.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/tape.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/tape.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/tape.c	2007-05-30 18:33:15.000000000 +0800
@@ -21,53 +21,35 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#define MODULE_NAME "tape"
-
 #if defined(HAVE_LIBKSTAT)
 # define TAPE_HAVE_READ 1
 #else
 # define TAPE_HAVE_READ 0
 #endif
 
-static char *tape_filename_template = "tape-%s.rrd";
-
-/* 104857600 == 100 MB */
-static char *tape_ds_def[] =
-{
-	"DS:rcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rmerged:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rbytes:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:rtime:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wcount:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wmerged:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wbytes:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	"DS:wtime:COUNTER:"COLLECTD_HEARTBEAT":0:U",
-	NULL
-};
-static int tape_ds_num = 8;
-
+#if TAPE_HAVE_READ
 #if defined(HAVE_LIBKSTAT)
 #define MAX_NUMTAPE 256
 extern kstat_ctl_t *kc;
 static kstat_t *ksp[MAX_NUMTAPE];
 static int numtape = 0;
 #endif /* HAVE_LIBKSTAT */
 
-static void tape_init (void)
+static int tape_init (void)
 {
 #ifdef HAVE_LIBKSTAT
 	kstat_t *ksp_chain;
 
 	numtape = 0;
 
 	if (kc == NULL)
-		return;
+		return (-1);
 
 	for (numtape = 0, ksp_chain = kc->kc_chain;
 			(numtape < MAX_NUMTAPE) && (ksp_chain != NULL);
 			ksp_chain = ksp_chain->ks_next)
 	{
 		if (strncmp (ksp_chain->ks_class, "tape", 4) )
@@ -75,83 +57,89 @@
 		if (ksp_chain->ks_type != KSTAT_TYPE_IO)
 			continue;
 		ksp[numtape++] = ksp_chain;
 	}
 #endif
 
-	return;
-}
-
-static void tape_write (char *host, char *inst, char *val)
-{
-	char file[512];
-	int status;
-
-	status = snprintf (file, 512, tape_filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= 512)
-		return;
-
-	rrd_update_file (host, file, val, tape_ds_def, tape_ds_num);
+	return (0);
 }
 
+static void tape_submit (const char *plugin_instance,
+		const char *type,
+		counter_t read, counter_t write)
+{
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
+
+	values[0].counter = read;
+	values[1].counter = write;
+
+	vl.values = values;
+	vl.values_len = 2;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "tape");
+	strncpy (vl.plugin_instance, plugin_instance,
+			sizeof (vl.plugin_instance));
 
-#if TAPE_HAVE_READ
-#define BUFSIZE 512
-static void tape_submit (char *tape_name,
-		unsigned long long read_count,
-		unsigned long long read_merged,
-		unsigned long long read_bytes,
-		unsigned long long read_time,
-		unsigned long long write_count,
-		unsigned long long write_merged,
-		unsigned long long write_bytes,
-		unsigned long long write_time)
+	plugin_dispatch_values (type, &vl);
+} /* void tape_submit */
 
-{
-	char buf[BUFSIZE];
-
-	if (snprintf (buf, BUFSIZE, "%u:%llu:%llu:%llu:%llu:%llu:%llu:%llu:%llu",
-				(unsigned int) curtime,
-				read_count, read_merged, read_bytes, read_time,
-				write_count, write_merged, write_bytes,
-				write_time) >= BUFSIZE)
-		return;
-
-	plugin_submit (MODULE_NAME, tape_name, buf);
-}
-
-#undef BUFSIZE
-
-static void tape_read (void)
+static int tape_read (void)
 {
 
 #if defined(HAVE_LIBKSTAT)
+# if HAVE_KSTAT_IO_T_WRITES && HAVE_KSTAT_IO_T_NWRITES && HAVE_KSTAT_IO_T_WTIME
+#  define KIO_ROCTETS reads
+#  define KIO_WOCTETS writes
+#  define KIO_ROPS    nreads
+#  define KIO_WOPS    nwrites
+#  define KIO_RTIME   rtime
+#  define KIO_WTIME   wtime
+# elif HAVE_KSTAT_IO_T_NWRITTEN && HAVE_KSTAT_IO_T_WRITES && HAVE_KSTAT_IO_T_WTIME
+#  define KIO_ROCTETS nread
+#  define KIO_WOCTETS nwritten
+#  define KIO_ROPS    reads
+#  define KIO_WOPS    writes
+#  define KIO_RTIME   rtime
+#  define KIO_WTIME   wtime
+# else
+#  error "kstat_io_t does not have the required members"
+# endif
 	static kstat_io_t kio;
 	int i;
 
 	if (kc == NULL)
-		return;
+		return (-1);
+
+	if (numtape <= 0)
+		return (-1);
 
 	for (i = 0; i < numtape; i++)
 	{
 		if (kstat_read (kc, ksp[i], &kio) == -1)
 			continue;
 
 		if (strncmp (ksp[i]->ks_class, "tape", 4) == 0)
-			tape_submit (ksp[i]->ks_name,
-					kio.reads,  0LL, kio.nread,    kio.rtime,
-					kio.writes, 0LL, kio.nwritten, kio.wtime);
+		{
+			tape_submit (ksp[i]->ks_name, "tape_octets",
+					kio.KIO_ROCTETS, kio.KIO_WOCTETS);
+			tape_submit (ksp[i]->ks_name, "tape_ops",
+					kio.KIO_ROPS, kio.KIO_WOPS);
+			/* FIXME: Convert this to microseconds if necessary */
+			tape_submit (ksp[i]->ks_name, "tape_time",
+					kio.KIO_RTIME, kio.KIO_WTIME);
+		}
 	}
 #endif /* defined(HAVE_LIBKSTAT) */
+
+	return (0);
 }
-#else
-# define tape_read NULL
 #endif /* TAPE_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, tape_init, tape_read, tape_write);
+#if TAPE_HAVE_READ
+	plugin_register_init ("tape", tape_init);
+	plugin_register_read ("tape", tape_read);
+#endif /* TAPE_HAVE_READ */
 }
-
-#undef MODULE_NAME
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src: traffic.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: types.db
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: types_list.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: types_list.h
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: unixsock.c
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/users.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/users.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/users.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/users.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/users.c
- * Copyright (C) 2005,2006  Sebastian Harl
+ * Copyright (C) 2005-2007  Sebastian Harl
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the license is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -37,52 +36,30 @@
 #if HAVE_GETUTXENT || HAVE_GETUTENT
 # define USERS_HAVE_READ 1
 #else
 # define USERS_HAVE_READ 0
 #endif
 
-static char *rrd_file = "users.rrd";
-static char *ds_def[] =
-{
-	"DS:users:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int ds_num = 1;
-
-static void users_init (void)
-{
-	/* we have nothing to do here :-) */
-	return;
-} /* static void users_init(void) */
-
-static void users_write (char *host, char *inst, char *val)
-{
-	rrd_update_file(host, rrd_file, val, ds_def, ds_num);
-	return;
-} /* static void users_write(char *host, char *inst, char *val) */
-
 #if USERS_HAVE_READ
-/* I don't like this temporary macro definition - well it's used everywhere
-   else in the collectd-sources, so I will just stick with it...  */
-#define BUFSIZE 256
-static void users_submit (unsigned int users)
+static void users_submit (gauge_t value)
 {
-	char buf[BUFSIZE] = "";
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	if (snprintf(buf, BUFSIZE, "%u:%u", 
-		(unsigned int)curtime, users) >= BUFSIZE)
-	{
-		return;
-	}
+	values[0].gauge = value;
+
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "users");
 
-	plugin_submit(MODULE_NAME, "-", buf);
-	return;
-} /* static void users_submit(unsigned int users) */
-#undef BUFSIZE
+	plugin_dispatch_values ("users", &vl);
+} /* void users_submit */
 
-static void users_read (void)
+static int users_read (void)
 {
 #if HAVE_GETUTXENT
 	unsigned int users = 0;
 	struct utmpx *entry = NULL;
 
 	/* according to the *utent(3) man page none of the functions sets errno
@@ -111,20 +88,19 @@
 		if (USER_PROCESS == entry->ut_type) {
 			++users;
 		}
 	}
 	endutent();
 
-	users_submit(users);
+	users_submit (users);
 #endif /* HAVE_GETUTENT */
 
-	return;
-} /* static void users_read(void) */
-#else
-# define users_read NULL
+	return (0);
+} /* int users_read */
 #endif /* USERS_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, users_init, users_read, users_write);
-	return;
+#if USERS_HAVE_READ
+	plugin_register_read ("users", users_read);
+#endif
 } /* void module_register(void) */
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: utils_avltree.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: utils_avltree.h
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src: utils_debug.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src: utils_debug.h
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/utils_ignorelist.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/utils_ignorelist.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/utils_ignorelist.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/utils_ignorelist.c	2007-05-30 18:33:15.000000000 +0800
@@ -49,13 +49,13 @@
 
 #if HAVE_CONFIG_H
 # include "config.h"
 #endif
 
 #include "common.h"
-#include "utils_debug.h"
+#include "plugin.h"
 #include "utils_ignorelist.h"
 
 /*
  * private prototypes
  */
 struct ignorelist_item_s
@@ -95,13 +95,13 @@
 	char *regerr = NULL;
 	ignorelist_item_t *new;
 
 	/* create buffer */
 	if ((regtemp = malloc(sizeof(regex_t))) == NULL)
 	{
-		syslog (LOG_ERR, "cannot allocate new config entry");
+		ERROR ("cannot allocate new config entry");
 		return (1);
 	}
 	memset (regtemp, '\0', sizeof(regex_t));
 
 	/* compile regex */
 	if ((rcompile = regcomp (regtemp, entry, REG_EXTENDED)) != 0)
@@ -112,34 +112,34 @@
 			regerr = smalloc(errsize);
 		/* get error message */
 		if (regerror (rcompile, regtemp, regerr, errsize))
 		{
 			fprintf (stderr, "Cannot compile regex %s: %i/%s",
 					entry, rcompile, regerr);
-			syslog (LOG_ERR, "Cannot compile regex %s: %i/%s",
+			ERROR ("Cannot compile regex %s: %i/%s",
 					entry, rcompile, regerr);
 		}
 		else
 		{
 			fprintf (stderr, "Cannot compile regex %s: %i",
 					entry, rcompile);
-			syslog (LOG_ERR, "Cannot compile regex %s: %i",
+			ERROR ("Cannot compile regex %s: %i",
 					entry, rcompile);
 		}
 
 		if (errsize)
 			sfree (regerr);
 		regfree (regtemp);
 		return (1);
 	}
-	DBG("regex compiled: %s - %i", entry, rcompile);
+	DEBUG("regex compiled: %s - %i", entry, rcompile);
 
 	/* create new entry */
 	if ((new = malloc(sizeof(ignorelist_item_t))) == NULL)
 	{
-		syslog (LOG_ERR, "cannot allocate new config entry");
+		ERROR ("cannot allocate new config entry");
 		regfree (regtemp);
 		return (1);
 	}
 	memset (new, '\0', sizeof(ignorelist_item_t));
 	new->rmatch = regtemp;
 
@@ -154,13 +154,13 @@
 {
 	ignorelist_item_t *new;
 
 	/* create new entry */
 	if ((new = malloc(sizeof(ignorelist_item_t))) == NULL )
 	{
-		syslog (LOG_ERR, "cannot allocate new entry");
+		ERROR ("cannot allocate new entry");
 		return (1);
 	}
 	memset (new, '\0', sizeof(ignorelist_item_t));
 	new->smatch = sstrdup(entry);
 
 	/* append new entry */
@@ -214,13 +214,13 @@
 ignorelist_t *ignorelist_create (int invert)
 {
 	ignorelist_t *il;
 
 	/* smalloc exits if it failes */
 	il = (ignorelist_t *) smalloc (sizeof (ignorelist_t));
-	DBG("Ignorelist created 0x%p, default is %s",
+	DEBUG("Ignorelist created 0x%p, default is %s",
 			(void *) il,
 			invert ? "collect" : "ignore");
 
 	memset (il, '\0', sizeof (ignorelist_t));
 
 	/*
@@ -237,13 +237,13 @@
  */
 void ignorelist_free (ignorelist_t *il)
 {
 	ignorelist_item_t *this;
 	ignorelist_item_t *next;
 
-	DBG ("(il = 0x%p)", (void *) il);
+	DEBUG ("(il = 0x%p)", (void *) il);
 
 	if (il == NULL)
 		return;
 
 	for (this = il->head; this != NULL; this = next)
 	{
@@ -271,13 +271,13 @@
  * set ignore state of the ignorelist_t
  */
 void ignorelist_set_invert (ignorelist_t *il, int invert)
 {
 	if (il == NULL)
 	{
-		DBG("ignore call with ignorelist_t == NULL");
+		DEBUG("ignore call with ignorelist_t == NULL");
 		return;
 	}
 
 	il->ignore = invert ? 0 : 1;
 } /* void ignorelist_set_invert (ignorelist_t *il, int ignore) */
 
@@ -289,22 +289,22 @@
 {
 	int ret;
 	size_t entry_len;
 
 	if (il == NULL)
 	{
-		DBG ("add called with ignorelist_t == NULL");
+		DEBUG ("add called with ignorelist_t == NULL");
 		return (1);
 	}
 
 	entry_len = strlen (entry);
 
 	/* append nothing */
 	if (entry_len == 0)
 	{
-		DBG("not appending: empty entry");
+		DEBUG("not appending: empty entry");
 		return (1);
 	}
 
 #if HAVE_REGEX_H
 	/* regex string is enclosed in "/.../" */
 	if ((entry_len > 2) && (entry[0] == '/') && entry[entry_len - 1] == '/')
@@ -313,20 +313,20 @@
 
 		/* We need to copy `entry' since it's const */
 		entry_copy = smalloc (entry_len);
 		memset (entry_copy, '\0', entry_len);
 		strncpy (entry_copy, entry + 1, entry_len - 2);
 
-		DBG("I'm about to add regex entry: %s", entry_copy);
+		DEBUG("I'm about to add regex entry: %s", entry_copy);
 		ret = ignorelist_append_regex(il, entry_copy);
 		sfree (entry_copy);
 	}
 	else
 #endif
 	{
-		DBG("to add entry: %s", entry);
+		DEBUG("to add entry: %s", entry);
 		ret = ignorelist_append_string(il, entry);
 	}
 
 	return (ret);
 } /* int ignorelist_add (ignorelist_t *il, const char *entry) */
 
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: utils_llist.c
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src: utils_llist.h
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/utils_mount.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/utils_mount.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/utils_mount.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/utils_mount.c	2007-05-30 18:33:15.000000000 +0800
@@ -29,13 +29,13 @@
 #if HAVE_XFS_XQM_H
 # include <xfs/xqm.h>
 #define XFS_SUPER_MAGIC_STR "XFSB"
 #define XFS_SUPER_MAGIC2_STR "BSFX"
 #endif
 
-#include "utils_debug.h"
+#include "plugin.h"
 #include "utils_mount.h"
 
 #if HAVE_GETVFSSTAT
 #  if HAVE_SYS_TYPES_H
 #    include <sys/types.h>
 #  endif
@@ -331,13 +331,13 @@
 		uuid[i] = ((fromhex(s[0]) << 4) | fromhex(s[1]));
 		s += 2;
 	}
 	return get_spec_by_x(UUID, uuid);
 
 	bad_uuid:
-		DBG("Found an invalid UUID: %s", s);
+		DEBUG("Found an invalid UUID: %s", s);
 	return NULL;
 }
 
 static char *get_spec_by_volume_label(const char *s)
 {
         return get_spec_by_x (VOL, s);
@@ -350,28 +350,28 @@
 	if (optstr == NULL)
 	{
 		return (NULL);
 	}
 	else if (strncmp (optstr, "UUID=", 5) == 0)
 	{
-		DBG ("TODO: check UUID= code!");
+		DEBUG ("TODO: check UUID= code!");
 		rc = get_spec_by_uuid (optstr + 5);
 	}
 	else if (strncmp (optstr, "LABEL=", 6) == 0)
 	{
-		DBG ("TODO: check LABEL= code!");
+		DEBUG ("TODO: check LABEL= code!");
 		rc = get_spec_by_volume_label (optstr + 6);
 	}
 	else
 	{
 		rc = sstrdup (optstr);
 	}
 
 	if(!rc)
 	{
-		DBG ("Error checking device name: optstr = %s", optstr);
+		DEBUG ("Error checking device name: optstr = %s", optstr);
 	}
 	return rc;
 }
 
 /* What weird OS is this..? I can't find any info with google :/ -octo */
 #if HAVE_LISTMNTENT && 0
@@ -380,24 +380,26 @@
 	cu_mount_t *last = *list;
 	struct tabmntent *p;
 	struct mntent *mnt;
 
 	struct tabmntent *mntlist;
 	if(listmntent(&mntlist, COLLECTD_MNTTAB, NULL, NULL) < 0) {
-		DBG("calling listmntent() failed: %s", strerror(errno));
+		char errbuf[1024];
+		DEBUG("calling listmntent() failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 	}
 
 	for(p = mntlist; p; p = p->next) {
 		char *loop = NULL, *device = NULL;
 
 		mnt = p->ment;
 		loop = cu_mount_getoptionvalue(mnt->mnt_opts, "loop=");
 		if(loop == NULL) {   /* no loop= mount */
 			device = get_device_name(mnt->mnt_fsname);
 			if(device == NULL) {
-				DBG("can't get devicename for fs (%s) %s (%s)"
+				DEBUG("can't get devicename for fs (%s) %s (%s)"
 					": ignored", mnt->mnt_type,
 					mnt->mnt_dir, mnt->mnt_fsname);
 				continue;
 			}
 		} else {
 			device = loop;
@@ -449,26 +451,30 @@
 	cu_mount_t *last  = NULL;
 	cu_mount_t *new   = NULL;
 
 	/* Get the number of mounted file systems */
 	if ((bufsize = CMD_STATFS (NULL, 0, FLAGS_STATFS)) < 1)
 	{
-		DBG ("getv?fsstat failed: %s", strerror (errno));
+		char errbuf[1024];
+		DEBUG ("getv?fsstat failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (NULL);
 	}
 
 	if ((buf = (STRUCT_STATFS *) malloc (bufsize * sizeof (STRUCT_STATFS)))
 			== NULL)
 		return (NULL);
 	memset (buf, '\0', bufsize * sizeof (STRUCT_STATFS));
 
 	/* The bufsize needs to be passed in bytes. Really. This is not in the
 	 * manpage.. -octo */
 	if ((num = CMD_STATFS (buf, bufsize * sizeof (STRUCT_STATFS), FLAGS_STATFS)) < 1)
 	{
-		DBG ("getv?fsstat failed: %s", strerror (errno));
+		char errbuf[1024];
+		DEBUG ("getv?fsstat failed: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		free (buf);
 		return (NULL);
 	}
 
 	for (i = 0; i < num; i++)
 	{
@@ -511,17 +517,19 @@
 	FILE *fp;
 
 	cu_mount_t *first = NULL;
 	cu_mount_t *last  = NULL;
 	cu_mount_t *new   = NULL;
 
-	DBG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
+	DEBUG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
 
 	if ((fp = fopen (COLLECTD_MNTTAB, "r")) == NULL)
 	{
-		syslog (LOG_ERR, "fopen (%s): %s", COLLECTD_MNTTAB, strerror (errno));
+		char errbuf[1024];
+		ERROR ("fopen (%s): %s", COLLECTD_MNTTAB,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (NULL);
 	}
 
 	while (getmntent (fp, &mt) == 0)
 	{
 		if ((new = malloc (sizeof (cu_mount_t))) == NULL)
@@ -566,17 +574,19 @@
 	struct mntent *me;
 
 	cu_mount_t *first = NULL;
 	cu_mount_t *last  = NULL;
 	cu_mount_t *new   = NULL;
 
-	DBG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
+	DEBUG ("(void); COLLECTD_MNTTAB = %s", COLLECTD_MNTTAB);
 
 	if ((fp = setmntent (COLLECTD_MNTTAB, "r")) == NULL)
 	{
-		syslog (LOG_ERR, "setmntent (%s): %s", COLLECTD_MNTTAB, strerror (errno));
+		char errbuf[1024];
+		ERROR ("setmntent (%s): %s", COLLECTD_MNTTAB,
+				sstrerror (errno, errbuf, sizeof (errbuf)));
 		return (NULL);
 	}
 
 	while ((me = getmntent (fp)) != NULL)
 	{
 		if ((new = malloc (sizeof (cu_mount_t))) == NULL)
@@ -588,13 +598,13 @@
 		new->spec_device = sstrdup (me->mnt_fsname);
 		new->type        = sstrdup (me->mnt_type);
 		new->options     = sstrdup (me->mnt_opts);
 		new->device      = get_device_name (new->options);
 		new->next        = NULL;
 
-		DBG ("new = {dir = %s, spec_device = %s, type = %s, options = %s, device = %s}",
+		DEBUG ("new = {dir = %s, spec_device = %s, type = %s, options = %s, device = %s}",
 				new->dir, new->spec_device, new->type, new->options, new->device);
 
 		/* Append to list */
 		if (first == NULL)
 		{
 			first = new;
@@ -606,13 +616,13 @@
 			last       = new;
 		}
 	}
 
 	endmntent (fp);
 
-	DBG ("return (0x%p)", (void *) first);
+	DEBUG ("return (0x%p)", (void *) first);
 
 	return (first);
 }
 #endif /* HAVE_ONE_GETMNTENT */
 
 /* *** *** *** ******************************************** *** *** *** */
@@ -669,13 +679,13 @@
 
 void cu_mount_freelist (cu_mount_t *list)
 {
 	cu_mount_t *this;
 	cu_mount_t *next;
 
-	DBG ("(list = 0x%p)", (void *) list);
+	DEBUG ("(list = 0x%p)", (void *) list);
 
 	for (this = list; this != NULL; this = next)
 	{
 		next = this->next;
 
 		sfree (this->dir);
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/vserver.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/vserver.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/vserver.c	2007-09-28 18:54:15.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/vserver.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/vserver.c
- * Copyright (C) 2006  Sebastian Harl
+ * Copyright (C) 2006,2007  Sebastian Harl
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the license is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -22,513 +21,299 @@
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
 #include <dirent.h>
-#include <errno.h>
-#include <stdio.h>
-#include <string.h>
-#include <syslog.h>
 #include <sys/types.h>
-#include <unistd.h>
 
 #define BUFSIZE 512
 
 #define MODULE_NAME "vserver"
 #define PROCDIR "/proc/virtual"
 
 #if defined(KERNEL_LINUX)
 # define VSERVER_HAVE_READ 1
 #else
 # define VSERVER_HAVE_READ 0
 #endif /* defined(KERNEL_LINUX) */
 
-static char *rrd_unix	= "vserver-%s/traffic-unix.rrd";
-static char *rrd_inet	= "vserver-%s/traffic-inet.rrd";
-static char *rrd_inet6	= "vserver-%s/traffic-inet6.rrd";
-static char *rrd_other	= "vserver-%s/traffic-other.rrd";
-static char *rrd_unspec	= "vserver-%s/traffic-unspec.rrd";
-
-static char *rrd_thread	= "vserver-%s/vs_threads.rrd";
-
-static char *rrd_load	= "vserver-%s/load.rrd";
-
-static char *rrd_procs	= "vserver-%s/vs_processes.rrd";
-static char *rrd_memory	= "vserver-%s/vs_memory.rrd";
-
-/* 9223372036854775807 == LLONG_MAX */
-/* bytes transferred */
-static char *ds_def_unix[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:failed:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_unix = 3;
-
-static char *ds_def_inet[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:failed:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_inet = 3;
-
-static char *ds_def_inet6[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:failed:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_inet6 = 3;
-
-static char *ds_def_other[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:failed:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_other = 3;
-
-static char *ds_def_unspec[] =
-{
-	"DS:incoming:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:outgoing:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:failed:COUNTER:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_unspec = 3;
-
-static char *ds_def_threads[] =
-{
-	"DS:total:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:running:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:uninterruptible:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	"DS:onhold:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int ds_num_threads = 4;
-
-static char *ds_def_load[] =
-{
-	"DS:shortterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	"DS:midterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	"DS:longterm:GAUGE:"COLLECTD_HEARTBEAT":0:100",
-	NULL
-};
-static int ds_num_load = 3;
-
-static char *ds_def_procs[] =
-{
-	"DS:total:GAUGE:"COLLECTD_HEARTBEAT":0:65535",
-	NULL
-};
-static int ds_num_procs = 1;
-
-/* 9223372036854775807 == LLONG_MAX */
-/* bytes */
-static char *ds_def_memory[] =
-{
-	"DS:vm:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:vml:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:rss:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	"DS:anon:GAUGE:"COLLECTD_HEARTBEAT":0:9223372036854775807",
-	NULL
-};
-static int ds_num_memory = 4;
-
+#if VSERVER_HAVE_READ
 static int pagesize = 0;
 
-static void vserver_init (void)
+static int vserver_init (void)
 {
 	/* XXX Should we check for getpagesize () in configure?
 	 * What's the right thing to do, if there is no getpagesize ()? */
 	pagesize = getpagesize ();
-	return;
-} /* static void vserver_init(void) */
 
-static void vserver_unix_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_unix, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_unix, ds_num_unix);
-	return;
-} /* static void vserver_unix_write(char *host, char *inst, char *val) */
-
-static void vserver_inet_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_inet, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_inet, ds_num_inet);
-	return;
-} /* static void vserver_inet_write(char *host, char *inst, char *val) */
-
-static void vserver_inet6_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_inet6, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_inet6, ds_num_inet6);
-	return;
-} /* static void vserver_inet6_write(char *host, char *inst, char *val) */
-
-static void vserver_other_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_other, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_other, ds_num_other);
-	return;
-} /* static void vserver_other_write(char *host, char *inst, char *val) */
-
-static void vserver_unspec_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_unspec, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_unspec, ds_num_unspec);
-	return;
-} /* static void vserver_unspec_write(char *host, char *inst, char *val) */
-
-static void vserver_threads_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_thread, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_threads, ds_num_threads);
-	return;
-} /* static void vserver_threads_write(char *host, char *inst, char *val) */
+	return (0);
+} /* static void vserver_init(void) */
 
-static void vserver_load_write (char *host, char *inst, char *val)
+static void traffic_submit (const char *plugin_instance,
+		const char *type_instance, counter_t rx, counter_t tx)
 {
-	int  len;
-	char filename[BUFSIZE];
-
-	len = snprintf (filename, BUFSIZE, rrd_load, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_load, ds_num_load);
-	return;
-} /* static void vserver_load_write(char *host, char *inst, char *val) */
+	value_t values[2];
+	value_list_t vl = VALUE_LIST_INIT;
 
-static void vserver_procs_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
+	values[0].counter = rx;
+	values[1].counter = tx;
 
-	len = snprintf (filename, BUFSIZE, rrd_procs, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_procs, ds_num_procs);
-	return;
-} /* static void vserver_procs_write(char *host, char *inst, char *val) */
+	vl.values = values;
+	vl.values_len = STATIC_ARRAY_SIZE (values);
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "vserver");
+	strncpy (vl.plugin_instance, plugin_instance, sizeof (vl.plugin_instance));
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
+
+	plugin_dispatch_values ("if_octets", &vl);
+} /* void traffic_submit */
+
+static void load_submit (const char *plugin_instance,
+		gauge_t snum, gauge_t mnum, gauge_t lnum)
+{
+	value_t values[3];
+	value_list_t vl = VALUE_LIST_INIT;
+
+	values[0].gauge = snum;
+	values[1].gauge = mnum;
+	values[2].gauge = lnum;
+
+	vl.values = values;
+	vl.values_len = STATIC_ARRAY_SIZE (values);
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "vserver");
+	strncpy (vl.plugin_instance, plugin_instance, sizeof (vl.plugin_instance));
 
-static void vserver_memory_write (char *host, char *inst, char *val)
-{
-	int  len;
-	char filename[BUFSIZE];
+	plugin_dispatch_values ("load", &vl);
+}
 
-	len = snprintf (filename, BUFSIZE, rrd_memory, inst);
-	if ((len > 0) && (len < BUFSIZE))
-		rrd_update_file (host, filename, val, ds_def_memory, ds_num_memory);
-	return;
-} /* static void vserver_memory_write(char *host, char *inst, char *val) */
+static void submit_gauge (const char *plugin_instance, const char *type,
+		const char *type_instance, gauge_t value)
 
-#if VSERVER_HAVE_READ
-static void vserver_submit (char *inst, long long unix_in, long long unix_out, 
-		long long unix_failed, long long inet_in, long long inet_out, 
-		long long inet_failed, long long inet6_in, long long inet6_out, 
-		long long inet6_failed, long long other_in, long long other_out,
-		long long other_failed, long long unspec_in, long long unspec_out, 
-		long long unspec_failed, int t_total, int t_running, 
-		int t_uninterruptible, int t_onhold, double avg1, double avg5, 
-		double avg15, int p_total, long long vm, long long vml, long long rss, 
-		long long anon)
 {
-	int  len;
-	char buffer[BUFSIZE];
-
-	len = snprintf (buffer, BUFSIZE, 
-			"N:%lld:%lld:%lld", unix_in, unix_out, unix_failed);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_unix", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, 
-			"N:%lld:%lld:%lld", inet_in, inet_out, inet_failed);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_inet", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, 
-			"N:%lld:%lld:%lld", inet6_in, inet6_out, inet6_failed);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_inet6", inst, buffer);
-
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	len = snprintf (buffer, BUFSIZE, 
-			"N:%lld:%lld:%lld", other_in, other_out, other_failed);
+	values[0].gauge = value;
 
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_other", inst, buffer);
+	vl.values = values;
+	vl.values_len = STATIC_ARRAY_SIZE (values);
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "vserver");
+	strncpy (vl.plugin_instance, plugin_instance, sizeof (vl.plugin_instance));
+	strncpy (vl.type_instance, type_instance, sizeof (vl.type_instance));
 
-
-	len = snprintf (buffer, BUFSIZE, 
-			"N:%lld:%lld:%lld", unspec_in, unspec_out, unspec_failed);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_unspec", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, "N:%d:%d:%d:%d",
-			t_total, t_running, t_uninterruptible, t_onhold);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_threads", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, "N:%.2f:%.2f:%.2f",
-			avg1, avg5, avg15);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_load", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, "N:%d",
-			p_total);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_procs", inst, buffer);
-
-
-	len = snprintf (buffer, BUFSIZE, "N:%lld:%lld:%lld:%lld",
-			vm, vml, rss, anon);
-
-	if ((len > 0) && (len < BUFSIZE))
-		plugin_submit ("vserver_memory", inst, buffer);
-	return;
-} /* static void vserver_submit() */
+	plugin_dispatch_values (type, &vl);
+} /* void submit_gauge */
 
 static inline long long __get_sock_bytes(const char *s)
 {
 	while (s[0] != '/')
 		++s;
 
 	/* Remove '/' */
 	++s;
 	return atoll(s);
 }
 
-static void vserver_read (void)
+static int vserver_read (void)
 {
 	DIR 			*proc;
 	struct dirent 	*dent; /* 42 */
 
-	static complain_t complain_obj;
-
 	errno = 0;
 	if (NULL == (proc = opendir (PROCDIR)))
 	{
-		plugin_complain (LOG_ERR, &complain_obj, "vserver plugin: "
-				"fopen (%s) failed: %s", PROCDIR, strerror (errno));
-		return;
+		char errbuf[1024];
+		ERROR ("vserver plugin: fopen (%s): %s", PROCDIR, 
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
-	plugin_relief (LOG_NOTICE, &complain_obj, "vserver plugin: "
-			"fopen (%s) succeeded.", PROCDIR);
 
-	while (NULL != (dent = readdir (proc))) {
+	while (NULL != (dent = readdir (proc)))
+	{
 		int  len;
 		char file[BUFSIZE];
 
 		FILE *fh;
 		char buffer[BUFSIZE];
 
 		char *cols[4];
 
-		long long	unix_s[3]	= {-1, -1, -1};
-		long long	inet[3]		= {-1, -1, -1};
-		long long	inet6[3]	= {-1, -1, -1};
-		long long	other[3]	= {-1, -1, -1};
-		long long	unspec[3]	= {-1, -1, -1};
-		int			threads[4]	= {-1, -1, -1, -1};
-		double		load[3]		= {-1, -1, -1};
-		/* Just to be consistent ;-) */
-		int			procs[1]	= {-1};
-		long long	memory[4]	= {-1, -1, -1, -1};
-
 		if (dent->d_name[0] == '.')
 			continue;
 
-		/* XXX This check is just the result of a trial-and-error test.
-		 * I did not find any documentation describing the d_type field. */
-		if (!(dent->d_type & 0x4))
-			/* This is not a directory */
+		/* This is not a directory */
+		if (dent->d_type != DT_DIR)
 			continue;
 
 		/* socket message accounting */
 		len = snprintf (file, BUFSIZE, PROCDIR "/%s/cacct", dent->d_name);
 		if ((len < 0) || (len >= BUFSIZE))
 			continue;
 
-		if (NULL == (fh = fopen (file, "r"))) {
-			syslog (LOG_ERR, "Cannot open '%s': %s", file, strerror (errno));
-			continue;
+		if (NULL == (fh = fopen (file, "r")))
+		{
+			char errbuf[1024];
+			ERROR ("Cannot open '%s': %s", file,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 		}
 
-		while (NULL != fgets (buffer, BUFSIZE, fh)) {
+		while ((fh != NULL) && (NULL != fgets (buffer, BUFSIZE, fh)))
+		{
+			counter_t rx;
+			counter_t tx;
+			char *type_instance;
+
 			if (strsplit (buffer, cols, 4) < 4)
 				continue;
 
-			if (0 == strcmp (cols[0], "UNIX:")) {
-				unix_s[0] = __get_sock_bytes (cols[1]);
-				unix_s[1] = __get_sock_bytes (cols[2]);
-				unix_s[2] = __get_sock_bytes (cols[3]);
-			}
-			else if (0 == strcmp (cols[0], "INET:")) {
-				inet[0] = __get_sock_bytes (cols[1]);
-				inet[1] = __get_sock_bytes (cols[2]);
-				inet[2] = __get_sock_bytes (cols[3]);
-			}
-			else if (0 == strcmp (cols[0], "INET6:")) {
-				inet6[0] = __get_sock_bytes (cols[1]);
-				inet6[1] = __get_sock_bytes (cols[2]);
-				inet6[2] = __get_sock_bytes (cols[3]);
-			}
-			else if (0 == strcmp (cols[0], "OTHER:")) {
-				other[0] = __get_sock_bytes (cols[1]);
-				other[1] = __get_sock_bytes (cols[2]);
-				other[2] = __get_sock_bytes (cols[3]);
-			}
-			else if (0 == strcmp (cols[0], "UNSPEC:")) {
-				unspec[0] = __get_sock_bytes (cols[1]);
-				unspec[1] = __get_sock_bytes (cols[2]);
-				unspec[2] = __get_sock_bytes (cols[3]);
-			}
-		}
+			if (0 == strcmp (cols[0], "UNIX:"))
+				type_instance = "unix";
+			else if (0 == strcmp (cols[0], "INET:"))
+				type_instance = "inet";
+			else if (0 == strcmp (cols[0], "INET6:"))
+				type_instance = "inet6";
+			else if (0 == strcmp (cols[0], "OTHER:"))
+				type_instance = "other";
+			else if (0 == strcmp (cols[0], "UNSPEC:"))
+				type_instance = "unspec";
+			else
+				continue;
 
-		fclose (fh);
+			rx = __get_sock_bytes (cols[1]);
+			tx = __get_sock_bytes (cols[2]);
+			/* cols[3] == errors */
+
+			traffic_submit (dent->d_name, type_instance, rx, tx);
+		} /* while (fgets) */
+
+		if (fh != NULL)
+		{
+			fclose (fh);
+			fh = NULL;
+		}
 
 		/* thread information and load */
 		len = snprintf (file, BUFSIZE, PROCDIR "/%s/cvirt", dent->d_name);
 		if ((len < 0) || (len >= BUFSIZE))
 			continue;
 
-		if (NULL == (fh = fopen (file, "r"))) {
-			syslog (LOG_ERR, "Cannot open '%s': %s", file, strerror (errno));
-			continue;
+		if (NULL == (fh = fopen (file, "r")))
+		{
+			char errbuf[1024];
+			ERROR ("Cannot open '%s': %s", file,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 		}
 
-		while (NULL != fgets (buffer, BUFSIZE, fh)) {
+		while ((fh != NULL) && (NULL != fgets (buffer, BUFSIZE, fh)))
+		{
 			int n = strsplit (buffer, cols, 4);
 
-			if (2 == n) {
-				if (0 == strcmp (cols[0], "nr_threads:")) {
-					threads[0] = atoi (cols[1]);
-				}
-				else if (0 == strcmp (cols[0], "nr_running:")) {
-					threads[1] = atoi (cols[1]);
-				}
-				else if (0 == strcmp (cols[0], "nr_unintr:")) {
-					threads[2] = atoi (cols[1]);
-				}
-				else if (0 == strcmp (cols[0], "nr_onhold:")) {
-					threads[3] = atoi (cols[1]);
-				}
+			if (2 == n)
+			{
+				char   *type_instance;
+				gauge_t value;
+
+				if (0 == strcmp (cols[0], "nr_threads:"))
+					type_instance = "total";
+				else if (0 == strcmp (cols[0], "nr_running:"))
+					type_instance = "running";
+				else if (0 == strcmp (cols[0], "nr_unintr:"))
+					type_instance = "uninterruptable";
+				else if (0 == strcmp (cols[0], "nr_onhold:"))
+					type_instance = "onhold";
+				else
+					continue;
+
+				value = atof (cols[1]);
+				submit_gauge (dent->d_name, "vs_threads", type_instance, value);
 			}
 			else if (4 == n) {
-				if (0 == strcmp (cols[0], "loadavg:")) {
-					load[0] = atof (cols[1]);
-					load[1] = atof (cols[2]);
-					load[2] = atof (cols[3]);
+				if (0 == strcmp (cols[0], "loadavg:"))
+				{
+					gauge_t snum = atof (cols[1]);
+					gauge_t mnum = atof (cols[2]);
+					gauge_t lnum = atof (cols[3]);
+					load_submit (dent->d_name, snum, mnum, lnum);
 				}
 			}
-		}
+		} /* while (fgets) */
 
-		fclose (fh);
+		if (fh != NULL)
+		{
+			fclose (fh);
+			fh = NULL;
+		}
 
 		/* processes and memory usage */
 		len = snprintf (file, BUFSIZE, PROCDIR "/%s/limit", dent->d_name);
 		if ((len < 0) || (len >= BUFSIZE))
 			continue;
 
-		if (NULL == (fh = fopen (file, "r"))) {
-			syslog (LOG_ERR, "Cannot open '%s': %s", file, strerror (errno));
-			continue;
+		if (NULL == (fh = fopen (file, "r")))
+		{
+			char errbuf[1024];
+			ERROR ("Cannot open '%s': %s", file,
+					sstrerror (errno, errbuf, sizeof (errbuf)));
 		}
 
-		while (NULL != fgets (buffer, BUFSIZE, fh)) {
+		while ((fh != NULL) && (NULL != fgets (buffer, BUFSIZE, fh)))
+		{
+			char *type = "vs_memory";
+			char *type_instance;
+			gauge_t value;
+
 			if (strsplit (buffer, cols, 2) < 2)
 				continue;
 
-			if (0 == strcmp (cols[0], "PROC:")) {
-				procs[0] = atoi (cols[1]);
-			}
-			else if (0 == strcmp (cols[0], "VM:")) {
-				memory[0] = atoll (cols[1]) * pagesize;
-			}
-			else if (0 == strcmp (cols[0], "VML:")) {
-				memory[1] = atoll (cols[1]) * pagesize;
-			}
-			else if (0 == strcmp (cols[0], "RSS:")) {
-				memory[2] = atoll (cols[1]) * pagesize;
-			}
-			else if (0 == strcmp (cols[0], "ANON:")) {
-				memory[3] = atoll (cols[1]) * pagesize;
-			}
+			if (0 == strcmp (cols[0], "PROC:"))
+			{
+				type = "vs_processes";
+				type_instance = "";
+				value = atof (cols[1]);
+			}
+			else
+			{
+				if (0 == strcmp (cols[0], "VM:"))
+					type_instance = "vm";
+				else if (0 == strcmp (cols[0], "VML:"))
+					type_instance = "vml";
+				else if (0 == strcmp (cols[0], "RSS:"))
+					type_instance = "rss";
+				else if (0 == strcmp (cols[0], "ANON:"))
+					type_instance = "anon";
+				else
+					continue;
+
+				value = atof (cols[1]) * pagesize;
+			}
+
+			submit_gauge (dent->d_name, type, type_instance, value);
+		} /* while (fgets) */
+
+		if (fh != NULL)
+		{
+			fclose (fh);
+			fh = NULL;
 		}
-
-		fclose (fh);
-
-		/* XXX What to do in case of an error (i.e. some value is
-		 * still -1)? */
-
-		vserver_submit (dent->d_name, unix_s[0], unix_s[1], unix_s[2], 
-				inet[0], inet[1], inet[2], inet6[0], inet6[1], inet6[2], 
-				other[0], other[1], other[2], unspec[0], unspec[1], unspec[2],
-				threads[0], threads[1], threads[2], threads[3], load[0], 
-				load[1], load[2], procs[0], memory[0], memory[1], memory[2], 
-				memory[3]);
-	}
+	} /* while (readdir) */
 
 	closedir (proc);
-	return;
-} /* static void vserver_read(void) */
-#else
-# define vserver_read NULL
+
+	return (0);
+} /* int vserver_read */
 #endif /* VSERVER_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, vserver_init, vserver_read, NULL);
-	plugin_register ("vserver_unix", NULL, NULL, vserver_unix_write);
-	plugin_register ("vserver_inet", NULL, NULL, vserver_inet_write);
-	plugin_register ("vserver_inet6", NULL, NULL, vserver_inet6_write);
-	plugin_register ("vserver_other", NULL, NULL, vserver_other_write);
-	plugin_register ("vserver_unspec", NULL, NULL, vserver_unspec_write);
-	plugin_register ("vserver_threads", NULL, NULL, vserver_threads_write);
-	plugin_register ("vserver_load", NULL, NULL, vserver_load_write);
-	plugin_register ("vserver_procs", NULL, NULL, vserver_procs_write);
-	plugin_register ("vserver_memory", NULL, NULL, vserver_memory_write);
-	return;
+#if VSERVER_HAVE_READ
+	plugin_register_init ("vserver", vserver_init);
+	plugin_register_read ("vserver", vserver_read);
+#endif /* VSERVER_HAVE_READ */
 } /* void module_register(void) */
 
 /* vim: set ts=4 sw=4 noexpandtab : */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/wireless.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/wireless.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/src/wireless.c	2007-09-28 18:54:19.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/src/wireless.c	2007-05-30 18:33:15.000000000 +0800
@@ -1,14 +1,13 @@
 /**
  * collectd - src/wireless.c
- * Copyright (C) 2006  Florian octo Forster
+ * Copyright (C) 2006,2007  Florian octo Forster
  *
  * This program is free software; you can redistribute it and/or modify it
  * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
+ * Free Software Foundation; only version 2 of the License is applicable.
  *
  * This program is distributed in the hope that it will be useful, but
  * WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * General Public License for more details.
  *
@@ -21,64 +20,20 @@
  **/
 
 #include "collectd.h"
 #include "common.h"
 #include "plugin.h"
 
-#define MODULE_NAME "wireless"
-#define BUFSIZE 1024
-
 #if defined(KERNEL_LINUX)
 # define WIRELESS_HAVE_READ 1
 #else
 # define WIRELESS_HAVE_READ 0
 #endif
 
 #define WIRELESS_PROC_FILE "/proc/net/wireless"
 
-static char *filename_template = "wireless-%s.rrd";
-
-static char *ds_def[] =
-{
-	"DS:quality:GAUGE:"COLLECTD_HEARTBEAT":0:U",
-	"DS:power:GAUGE:"COLLECTD_HEARTBEAT":U:0",
-	"DS:noise:GAUGE:"COLLECTD_HEARTBEAT":U:0",
-	NULL
-};
-static int ds_num = 3;
-
-#if WIRELESS_HAVE_READ
-static int proc_file_found = 0;
-#endif
-
-static void wireless_init (void)
-{
-#if WIRELESS_HAVE_READ
-	if (access (WIRELESS_PROC_FILE, R_OK) == 0)
-		proc_file_found = 1;
-	else
-		proc_file_found = 0;
-#endif
-
-	return;
-}
-
-static void wireless_write (char *host, char *inst, char *val)
-{
-	char file[BUFSIZE];
-	int status;
-
-	status = snprintf (file, BUFSIZE, filename_template, inst);
-	if (status < 1)
-		return;
-	else if (status >= BUFSIZE)
-		return;
-
-	rrd_update_file (host, file, val, ds_def, ds_num);
-}
-
 #if WIRELESS_HAVE_READ
 #if 0
 static double wireless_dbm_to_watt (double dbm)
 {
 	double watt;
 
@@ -90,67 +45,60 @@
 	watt = pow (10.0, (dbm / 10.0)) / 1000.0;
 
 	return (watt);
 }
 #endif
 
-static void wireless_submit (char *device,
-		double quality, double power, double noise)
+static void wireless_submit (const char *plugin_instance, const char *type,
+		double value)
 {
-	char buf[BUFSIZE];
-	int  status;
+	value_t values[1];
+	value_list_t vl = VALUE_LIST_INIT;
 
-	status = snprintf (buf, BUFSIZE, "%u:%f:%f:%f",
-			(unsigned int) curtime,
-			quality, power, noise);
-	if ((status < 1) || (status >= BUFSIZE))
-		return;
+	values[0].gauge = value;
 
-	plugin_submit (MODULE_NAME, device, buf);
-}
-
-#define POWER_MIN -90.0
-#define POWER_MAX -50.0
-static double wireless_percent_to_power (double quality)
-{
-	assert ((quality >= 0.0) && (quality <= 100.0));
+	vl.values = values;
+	vl.values_len = 1;
+	vl.time = time (NULL);
+	strcpy (vl.host, hostname_g);
+	strcpy (vl.plugin, "wireless");
+	strncpy (vl.plugin_instance, plugin_instance,
+			sizeof (vl.plugin_instance));
 
-	return ((quality * (POWER_MAX - POWER_MIN)) + POWER_MIN);
-} /* double wireless_percent_to_power */
+	plugin_dispatch_values (type, &vl);
+} /* void wireless_submit */
 
-static void wireless_read (void)
+static int wireless_read (void)
 {
 #ifdef KERNEL_LINUX
-
 	FILE *fh;
-	char buffer[BUFSIZE];
+	char buffer[1024];
 
 	char   *device;
 	double  quality;
 	double  power;
 	double  noise;
 	
 	char *fields[8];
 	int   numfields;
 
+	int devices_found;
 	int len;
 
-	if (!proc_file_found)
-		return;
-
 	/* there are a variety of names for the wireless device */
 	if ((fh = fopen (WIRELESS_PROC_FILE, "r")) == NULL)
 	{
-		syslog (LOG_WARNING, "wireless: fopen: %s", strerror (errno));
-		return;
+		char errbuf[1024];
+		WARNING ("wireless: fopen: %s",
+				sstrerror (errno, errbuf, sizeof (errbuf)));
+		return (-1);
 	}
 
-	while (fgets (buffer, BUFSIZE, fh) != NULL)
+	devices_found = 0;
+	while (fgets (buffer, sizeof (buffer), fh) != NULL)
 	{
-		char *endptr;
-
 		numfields = strsplit (buffer, fields, 8);
 
 		if (numfields < 5)
 			continue;
 
 		len = strlen (fields[0]) - 1;
@@ -158,46 +106,45 @@
 			continue;
 		if (fields[0][len] != ':')
 			continue;
 		fields[0][len] = '\0';
 
 		device  = fields[0];
+		quality = atof (fields[2]);
+		power   = atof (fields[3]);
+		noise   = atof (fields[4]);
+
+		/* Fill in invalid values when conversion failed.. */
+		if (quality == 0.0)
+			quality = -1.0; /* quality >= 0 */
+
+		if (power == 0.0)
+			power = 1.0; /* power <= 0 */
+
+		if (noise == 0.0)
+			noise = 1.0; /* noise <= 0 */
 
-		quality = strtod (fields[2], &endptr);
-		if (fields[2] == endptr)
-			quality = -1.0; /* invalid */
-
-		/* power [dBm] < 0.0 */
-		power = strtod (fields[3], &endptr);
-		if (fields[3] == endptr)
-			power = 1.0; /* invalid */
-		else if ((power >= 0.0) && (power <= 100.0))
-			power = wireless_percent_to_power (power);
-		else if (power > 100.0)
-			power = 1.0; /* invalid */
-
-		/* noise [dBm] < 0.0 */
-		noise = strtod (fields[3], &endptr);
-		if (fields[3] == endptr)
-			noise = 1.0; /* invalid */
-		else if ((noise >= 0.0) && (noise <= 100.0))
-			noise = wireless_percent_to_power (noise);
-		else if (noise > 100.0)
-			noise = 1.0; /* invalid */
+		wireless_submit (device, "signal_quality", quality);
+		wireless_submit (device, "signal_power", power);
+		wireless_submit (device, "signal_noise", noise);
 
-		wireless_submit (device, quality, power, noise);
+		devices_found++;
 	}
 
 	fclose (fh);
+
+	/* If no wireless devices are present return an error, so the plugin
+	 * code delays our read function. */
+	if (devices_found == 0)
+		return (-1);
 #endif /* KERNEL_LINUX */
-}
-#else
-# define wireless_read NULL
+
+	return (0);
+} /* int wireless_read */
 #endif /* WIRELESS_HAVE_READ */
 
 void module_register (void)
 {
-	plugin_register (MODULE_NAME, wireless_init, wireless_read, wireless_write);
-}
-
-#undef BUFSIZE
-#undef MODULE_NAME
+#if WIRELESS_HAVE_READ
+	plugin_register_read ("wireless", wireless_read);
+#endif /* WIRELESS_HAVE_READ */
+} /* void module_register */
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/TODO /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/TODO
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-3.11.7/TODO	2007-06-07 15:44:51.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.0.0/TODO	2007-06-02 05:18:01.000000000 +0800
@@ -1,6 +1,11 @@
+- Check dependencies of plugins in the configure-script. I. e. all the
+  `XXX_HAVE_READ' defines should be removed.
+- Flush values in the network plugin upon exiting.
+- Add the interval to the value-lists.
+
 src/battery.c: commend not working code.
 general: build Darwin package
 
 Near future:
 * Update the RPM specfile to
   - build `collectd-apache'
