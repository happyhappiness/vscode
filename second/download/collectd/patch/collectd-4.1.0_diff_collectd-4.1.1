diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/ChangeLog /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/ChangeLog
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/ChangeLog	2007-09-02 05:41:26.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/ChangeLog	2007-09-12 20:57:11.000000000 +0800
@@ -1,12 +1,26 @@
+2007-09-12, Version 4.1.1
+	* Build system: The detection of `libnetlink' has been improved.
+	* collectd: The documentation has been fixed in numerous places.
+	* exec plugin: Setting the group under which to run a program has been
+	  fixed.
+	* collectd: The `sstrerror' function was improved to work correctly
+	  with the broken GNU version of `strerror_r'.
+	* collectd: Write an error message to STDERR when loading of a plugin
+	  fails.
+	* apcups plugin: Fix the `types' used to submit the values: They still
+	  has an `apcups_' prefix which doesn't work anymore.
+	* rrdtool plugin: Create new RRD-files with the `begin' time set to
+	  whatever the client thinks is `now'..
+
 2007-09-01, Version 4.1.0
 	* Build system: The build system has been changed to automatically
 	  disable all plugins, which are missing dependencies. The dependency
 	  checking has been removed from the plugins themselves to remove
 	  redundancy.
-	* Flexible interval: The interval of collected data is not sent along
+	* Flexible interval: The interval of collected data is now sent along
 	  with the data itself over the network, so that the interval-settings
 	  of server and clients no longer needs to match.
 	* netlink plugin: The new `netlink' plugin connects to the Linux
 	  kernel using a netlink socket and uses it to query information about
 	  interfaces, qdiscs and classes.
 	* rrdtool plugin: The cache is now dumped to disk in an extra thread
@@ -16,22 +30,33 @@
 	  monitoring servers, etc. The collectd-snmp(5) manpage documents this
 	  plugin.
 	* unixsock plugin: Added the `LISTVAL' command.
 	* xmms plugin: The new `xmms' plugin graphs the bitrate and frequency
 	  of music played with xmms.
 
+2007-09-12, Version 4.0.8
+	* collectd: The `sstrerror' function was improved to work correctly
+	  with the broken GNU version of `strerror_r'.
+	* collectd: Write an error message to STDERR when loading of a plugin
+	  fails.
+	* apcups plugin: Fix the `types' used to submit the values: They still
+	  has an `apcups_' prefix which doesn't work anymore.
+	* rrdtool plugin: Create new RRD-files with the `begin' time set to
+	  whatever the client thinks is `now'..
+
 2007-08-26, Version 4.0.7
 	* documentation: Some typos have been fixed and some information has
 	  been improved.
 	* build system: Many fixes for detecting libraries in unusual places,
 	  such as on RedHat systems. The affected libraries are `libcurl',
 	  `libmysql', and `libupsclient'.
 	* network plugin: Allow the `Port' option to be specified as a number
 	  (i. e. without quotes).
 	* nut plugin: A fix allows linking the nut plugin against
 	  libupsclient, version >= 2.2.0.
+	* processes plugin: Fix a potential segmentation fault.
 
 2007-07-30, Version 4.0.6
 	* sensors plugin: Fix the ignorelist functionality: Only the `type
 	  instance' was used to match against the list, but the documentation
 	  told otherwise. This release fixes the code, so it complies with the
 	  documentation.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/configure	2007-09-02 04:12:23.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/configure	2007-09-12 20:59:04.000000000 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.61 for collectd 4.1.0.
+# Generated by GNU Autoconf 2.61 for collectd 4.1.1.
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 # 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
 # gives unlimited permission to copy, distribute and modify it.
 ## --------------------- ##
@@ -723,14 +723,14 @@
 MAKEFLAGS=
 SHELL=${CONFIG_SHELL-/bin/sh}
 
 # Identity of this package.
 PACKAGE_NAME='collectd'
 PACKAGE_TARNAME='collectd'
-PACKAGE_VERSION='4.1.0'
-PACKAGE_STRING='collectd 4.1.0'
+PACKAGE_VERSION='4.1.1'
+PACKAGE_STRING='collectd 4.1.1'
 PACKAGE_BUGREPORT=''
 
 ac_unique_file="src/collectd.c"
 ac_default_prefix="/opt/collectd"
 # Factoring default headers for most tests.
 ac_includes_default="\
@@ -1550,13 +1550,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures collectd 4.1.0 to adapt to many kinds of systems.
+\`configure' configures collectd 4.1.1 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -1620,13 +1620,13 @@
   --host=HOST       cross-compile to build programs to run on HOST [BUILD]
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of collectd 4.1.0:";;
+     short | recursive ) echo "Configuration of collectd 4.1.1:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
@@ -1804,13 +1804,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-collectd configure 4.1.0
+collectd configure 4.1.1
 generated by GNU Autoconf 2.61
 
 Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
@@ -1818,13 +1818,13 @@
   exit
 fi
 cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by collectd $as_me 4.1.0, which was
+It was created by collectd $as_me 4.1.1, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 exec 5>>config.log
@@ -2491,13 +2491,13 @@
   fi
 fi
 
 
 # Define the identity of the package.
  PACKAGE='collectd'
- VERSION='4.1.0'
+ VERSION='4.1.1'
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -25335,12 +25335,301 @@
 _ACEOF
 
 fi
 done
 
 
+{ echo "$as_me:$LINENO: checking whether strerror_r is declared" >&5
+echo $ECHO_N "checking whether strerror_r is declared... $ECHO_C" >&6; }
+if test "${ac_cv_have_decl_strerror_r+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+#ifndef strerror_r
+  (void) strerror_r;
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_have_decl_strerror_r=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_cv_have_decl_strerror_r=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_have_decl_strerror_r" >&5
+echo "${ECHO_T}$ac_cv_have_decl_strerror_r" >&6; }
+if test $ac_cv_have_decl_strerror_r = yes; then
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_DECL_STRERROR_R 1
+_ACEOF
+
+
+else
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_DECL_STRERROR_R 0
+_ACEOF
+
+
+fi
+
+
+
+for ac_func in strerror_r
+do
+as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
+{ echo "$as_me:$LINENO: checking for $ac_func" >&5
+echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
+if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+/* Define $ac_func to an innocuous variant, in case <limits.h> declares $ac_func.
+   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
+#define $ac_func innocuous_$ac_func
+
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char $ac_func (); below.
+    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
+    <limits.h> exists even on freestanding compilers.  */
+
+#ifdef __STDC__
+# include <limits.h>
+#else
+# include <assert.h>
+#endif
+
+#undef $ac_func
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char $ac_func ();
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined __stub_$ac_func || defined __stub___$ac_func
+choke me
+#endif
+
+int
+main ()
+{
+return $ac_func ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext &&
+       $as_test_x conftest$ac_exeext; then
+  eval "$as_ac_var=yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	eval "$as_ac_var=no"
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+fi
+ac_res=`eval echo '${'$as_ac_var'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+if test `eval echo '${'$as_ac_var'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+done
+
+{ echo "$as_me:$LINENO: checking whether strerror_r returns char *" >&5
+echo $ECHO_N "checking whether strerror_r returns char *... $ECHO_C" >&6; }
+if test "${ac_cv_func_strerror_r_char_p+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+    ac_cv_func_strerror_r_char_p=no
+    if test $ac_cv_have_decl_strerror_r = yes; then
+      cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+
+	  char buf[100];
+	  char x = *strerror_r (0, buf, sizeof buf);
+	  char *p = strerror_r (0, buf, sizeof buf);
+	  return !p || x;
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_cv_func_strerror_r_char_p=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+    else
+      # strerror_r is not declared.  Choose between
+      # systems that have relatively inaccessible declarations for the
+      # function.  BeOS and DEC UNIX 4.0 fall in this category, but the
+      # former has a strerror_r that returns char*, while the latter
+      # has a strerror_r that returns `int'.
+      # This test should segfault on the DEC system.
+      if test "$cross_compiling" = yes; then
+  :
+else
+  cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+	extern char *strerror_r ();
+int
+main ()
+{
+char buf[100];
+	  char x = *strerror_r (0, buf, sizeof buf);
+	  return ! isalpha (x);
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest$ac_exeext
+if { (ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
+  { (case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_cv_func_strerror_r_char_p=yes
+else
+  echo "$as_me: program exited with status $ac_status" >&5
+echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
+fi
+
+
+    fi
+
+fi
+{ echo "$as_me:$LINENO: result: $ac_cv_func_strerror_r_char_p" >&5
+echo "${ECHO_T}$ac_cv_func_strerror_r_char_p" >&6; }
+if test $ac_cv_func_strerror_r_char_p = yes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define STRERROR_R_CHAR_P 1
+_ACEOF
+
+fi
+
+
 
 for ac_func in getpwnam_r
 do
 as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_func" >&5
 echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
@@ -30707,13 +30996,13 @@
 then
 	with_curl_cflags=`$with_curl_config --cflags 2>/dev/null`
 	curl_config_status=$?
 
 	if test $curl_config_status -ne 0
 	then
-		with_libcurl="no"
+		with_libcurl="no ($with_curl_config failed)"
 	else
 		SAVE_CFLAGS=$CFLAGS
 		CFLAGS="$CFLAGS $with_curl_cflags"
 
 
 for ac_header in curl/curl.h
@@ -30865,13 +31154,13 @@
 then
 	with_curl_libs=`$with_curl_config --libs 2>/dev/null`
 	curl_config_status=$?
 
 	if test $curl_config_status -ne 0
 	then
-		with_libcurl="no"
+		with_libcurl="no ($with_curl_config failed)"
 	else
 		{ echo "$as_me:$LINENO: checking for curl_easy_init in -lcurl" >&5
 echo $ECHO_N "checking for curl_easy_init in -lcurl... $ECHO_C" >&6; }
 if test "${ac_cv_lib_curl_curl_easy_init+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -30929,21 +31218,13 @@
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
 { echo "$as_me:$LINENO: result: $ac_cv_lib_curl_curl_easy_init" >&5
 echo "${ECHO_T}$ac_cv_lib_curl_curl_easy_init" >&6; }
 if test $ac_cv_lib_curl_curl_easy_init = yes; then
-
-		  # We need to do this to have `HAVE_LIBCURL' defined but
-		  # `-lcurl' NOT added to the default LDFLAGS.
-
-cat >>confdefs.h <<\_ACEOF
-#define HAVE_LIBCURL 1
-_ACEOF
-
-
+  with_libcurl="yes"
 else
   with_libcurl="no (symbol 'curl_easy_init' not found)"
 fi
 
 	fi
 fi
@@ -32010,23 +32291,15 @@
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
 { echo "$as_me:$LINENO: result: $ac_cv_lib_mysqlclient_mysql_init" >&5
 echo "${ECHO_T}$ac_cv_lib_mysqlclient_mysql_init" >&6; }
 if test $ac_cv_lib_mysqlclient_mysql_init = yes; then
-
-		  # We need to do this to have `HAVE_LIBMYSQLCLIENT' defined
-		  # but `-lmysqlclient' NOT added to the default LDFLAGS.
-
-cat >>confdefs.h <<\_ACEOF
-#define HAVE_LIBMYSQLCLIENT 1
-_ACEOF
-
-
+  with_libmysql="yes"
 else
-  with_libmysql="no (libmysql not found)"
+  with_libmysql="no (symbol 'mysql_init' not found)"
 fi
 
 	fi
 fi
 if test "x$with_libmysql" = "xyes"
 then
@@ -33223,13 +33496,18 @@
 	then
 		with_libupsclient="no"
 	else
 		with_libupsclient="yes"
 		if "x$withval" != "xyes"
 		then
-			with_upsclient_config="$withval/bin/libupsclient-config"
+			if test -x "$withval"
+			then
+				with_upsclient_config="$withval"
+			else
+				with_upsclient_config="$withval/bin/libupsclient-config"
+			fi
 		fi
 	fi
 
 else
 
 	with_libupsclient="yes"
@@ -33240,38 +33518,184 @@
 then
 	with_upsclient_cflags=`$with_upsclient_config --cflags 2>/dev/null`
 	upsclient_config_status=$?
 
 	if test $upsclient_config_status -ne 0
 	then
-		with_libupsclient="no"
+		with_libupsclient="no ($with_upsclient_config failed)"
 	fi
 fi
 if test "x$with_libupsclient" = "xyes"
 then
+	SAVE_CFLAGS="$CFLAGS"
+	CFLAGS="$CFLAGS $with_upsclient_cflags"
+
+
+for ac_header in upsclient.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  { echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_compile") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_header_compiler=no
+fi
+
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+
+rm -f conftest.err conftest.$ac_ext
+{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
+  yes:no: )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
+    ac_header_preproc=yes
+    ;;
+  no:yes:* )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
+
+    ;;
+esac
+{ echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
+if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=\$ac_header_preproc"
+fi
+ac_res=`eval echo '${'$as_ac_Header'}'`
+	       { echo "$as_me:$LINENO: result: $ac_res" >&5
+echo "${ECHO_T}$ac_res" >&6; }
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+else
+  with_libupsclient="no (upsclient.h not found)"
+fi
+
+done
+
+
+	CFLAGS="$SAVE_CFLAGS"
+fi
+if test "x$with_libupsclient" = "xyes"
+then
 	with_upsclient_libs=`$with_upsclient_config --libs 2>/dev/null`
 	upsclient_config_status=$?
 
 	if test $upsclient_config_status -ne 0
 	then
-		with_libupsclient="no"
+		with_libupsclient="no ($with_upsclient_config failed)"
 	fi
 fi
 if test "x$with_libupsclient" = "xyes"
 then
-	CFLAGS_ORIG=$CFLAGS
-	CFLAGS="$CFLAGS $with_upsclient_cflags"
-	LDFLAGS_ORIG=$LDFLAGS
-	LDFLAGS="$LDFLAGS $with_upsclient_libs"
 	{ echo "$as_me:$LINENO: checking for upscli_connect in -lupsclient" >&5
 echo $ECHO_N "checking for upscli_connect in -lupsclient... $ECHO_C" >&6; }
 if test "${ac_cv_lib_upsclient_upscli_connect+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lupsclient  $LIBS"
+LIBS="-lupsclient $with_upsclient_libs $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
@@ -33329,25 +33753,15 @@
 		BUILD_WITH_LIBUPSCLIENT_LIBS="$with_upsclient_libs"
 
 
 
 else
 
-		with_libupsclient="no"
-
-fi
+		with_libupsclient="no (symbol 'upscli_connect' not found)"
 
-	CFLAGS=$CFLAGS_ORIG
-	LDFLAGS=$LDFLAGS_ORIG
 fi
-if test "x$with_libupsclient" = "xyes"
-then
-
-cat >>confdefs.h <<\_ACEOF
-#define HAVE_LIBUPSCLIENT 1
-_ACEOF
 
 fi
 if test "x$with_libupsclient" = "xyes"
 then
 	{ echo "$as_me:$LINENO: checking for UPSCONN_t" >&5
 echo $ECHO_N "checking for UPSCONN_t... $ECHO_C" >&6; }
@@ -33676,14 +34090,18 @@
 
 if test "x$with_libnetlink" = "xyes"
 then
 	SAVE_CFLAGS=$CFLAGS
 	CFLAGS="$CFLAGS $with_libnetlink_cflags"
 
+	with_libnetlink="no (libnetlink.h not found)"
+
 
-for ac_header in iproute/libnetlink.h
+
+
+for ac_header in libnetlink.h iproute/libnetlink.h linux/libnetlink.h
 do
 as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
 { echo "$as_me:$LINENO: checking for $ac_header" >&5
 echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
 if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
@@ -33693,12 +34111,13 @@
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 #include <stdio.h>
 #include <sys/types.h>
+#include <asm/types.h>
 #include <sys/socket.h>
 #include <linux/netlink.h>
 #include <linux/rtnetlink.h>
 
 #include <$ac_header>
 _ACEOF
@@ -33734,14 +34153,15 @@
 echo "${ECHO_T}$ac_res" >&6; }
 if test `eval echo '${'$as_ac_Header'}'` = yes; then
   cat >>confdefs.h <<_ACEOF
 #define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
 
-else
-  with_libnetlink="no (iproute/libnetlink.h not found)"
+	 with_libnetlink="yes"
+	 break
+
 fi
 
 done
 
 
 	CFLAGS="$SAVE_CFLAGS"
@@ -36903,13 +37323,13 @@
 exec 6>&1
 
 # Save the log message, to keep $[0] and so on meaningful, and to
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by collectd $as_me 4.1.0, which was
+This file was extended by collectd $as_me 4.1.1, which was
 generated by GNU Autoconf 2.61.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -36956,13 +37376,13 @@
 
 Report bugs to <bug-autoconf@gnu.org>."
 
 _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-collectd config.status 4.1.0
+collectd config.status 4.1.1
 configured by $0, generated by GNU Autoconf 2.61,
   with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"
 
 Copyright (C) 2006 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/configure.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/configure.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/configure.in	2007-09-02 04:11:52.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/configure.in	2007-09-12 20:57:11.000000000 +0800
@@ -362,12 +362,14 @@
 #
 # Checks for library functions.
 #
 AC_PROG_GCC_TRADITIONAL
 AC_CHECK_FUNCS(gettimeofday select strdup strtol getaddrinfo getnameinfo strchr memcpy strstr strcmp strncmp strncpy strlen strncasecmp strcasecmp openlog closelog)
 
+AC_FUNC_STRERROR_R
+
 AC_CHECK_FUNCS(getpwnam_r)
 AC_CHECK_FUNCS(getgrnam_r)
 
 socket_needs_socket="no"
 AC_CHECK_FUNCS(socket, [], AC_CHECK_LIB(socket, socket, [socket_needs_socket="yes"], AC_MSG_ERROR(cannot find socket)))
 AM_CONDITIONAL(BUILD_WITH_LIBSOCKET, test "x$socket_needs_socket" = "xyes")
@@ -784,13 +786,13 @@
 then
 	with_curl_cflags=`$with_curl_config --cflags 2>/dev/null`
 	curl_config_status=$?
 
 	if test $curl_config_status -ne 0
 	then
-		with_libcurl="no"
+		with_libcurl="no ($with_curl_config failed)"
 	else
 		SAVE_CFLAGS=$CFLAGS
 		CFLAGS="$CFLAGS $with_curl_cflags"
 
 		AC_CHECK_HEADERS(curl/curl.h, [], [with_libcurl="no (curl/curl.h not found)"], [])
 
@@ -801,21 +803,16 @@
 then
 	with_curl_libs=`$with_curl_config --libs 2>/dev/null`
 	curl_config_status=$?
 
 	if test $curl_config_status -ne 0
 	then
-		with_libcurl="no"
+		with_libcurl="no ($with_curl_config failed)"
 	else
 		AC_CHECK_LIB(curl, curl_easy_init,
-		 [
-		  # We need to do this to have `HAVE_LIBCURL' defined but
-		  # `-lcurl' NOT added to the default LDFLAGS.
-			AC_DEFINE(HAVE_LIBCURL, 1,
-				  [Define to 1 if you have the curl library.])
-		 ],
+		 [with_libcurl="yes"],
 		 [with_libcurl="no (symbol 'curl_easy_init' not found)"],
 		 [$with_curl_libs])
 	fi
 fi
 if test "x$with_libcurl" = "xyes"
 then
@@ -981,19 +978,14 @@
 
 	if test $mysql_config_status -ne 0
 	then
 		with_libmysql="no"
 	else
 		AC_CHECK_LIB(mysqlclient, mysql_init,
-		 [
-		  # We need to do this to have `HAVE_LIBMYSQLCLIENT' defined
-		  # but `-lmysqlclient' NOT added to the default LDFLAGS.
-			AC_DEFINE(HAVE_LIBMYSQLCLIENT, 1,
-				  [Define to 1 if you have the mysqlclient library.])
-		 ],
-		 [with_libmysql="no (libmysql not found)"],
+		 [with_libmysql="yes"],
+		 [with_libmysql="no (symbol 'mysql_init' not found)"],
 		 [$with_mysql_libs])
 	fi
 fi
 if test "x$with_libmysql" = "xyes"
 then
 	BUILD_WITH_LIBMYSQL_CFLAGS="$with_mysql_cflags"
@@ -1266,13 +1258,18 @@
 	then
 		with_libupsclient="no"
 	else
 		with_libupsclient="yes"
 		if "x$withval" != "xyes"
 		then
-			with_upsclient_config="$withval/bin/libupsclient-config"
+			if test -x "$withval"
+			then
+				with_upsclient_config="$withval"
+			else
+				with_upsclient_config="$withval/bin/libupsclient-config"
+			fi
 		fi
 	fi
 ],
 [
 	with_libupsclient="yes"
 ])
@@ -1280,47 +1277,46 @@
 then
 	with_upsclient_cflags=`$with_upsclient_config --cflags 2>/dev/null`
 	upsclient_config_status=$?
 
 	if test $upsclient_config_status -ne 0
 	then
-		with_libupsclient="no"
+		with_libupsclient="no ($with_upsclient_config failed)"
 	fi
 fi
 if test "x$with_libupsclient" = "xyes"
 then
+	SAVE_CFLAGS="$CFLAGS"
+	CFLAGS="$CFLAGS $with_upsclient_cflags"
+
+	AC_CHECK_HEADERS(upsclient.h, [], [with_libupsclient="no (upsclient.h not found)"])
+
+	CFLAGS="$SAVE_CFLAGS"
+fi
+if test "x$with_libupsclient" = "xyes"
+then
 	with_upsclient_libs=`$with_upsclient_config --libs 2>/dev/null`
 	upsclient_config_status=$?
 
 	if test $upsclient_config_status -ne 0
 	then
-		with_libupsclient="no"
+		with_libupsclient="no ($with_upsclient_config failed)"
 	fi
 fi
 if test "x$with_libupsclient" = "xyes"
 then
-	CFLAGS_ORIG=$CFLAGS
-	CFLAGS="$CFLAGS $with_upsclient_cflags"
-	LDFLAGS_ORIG=$LDFLAGS
-	LDFLAGS="$LDFLAGS $with_upsclient_libs"
 	AC_CHECK_LIB(upsclient, upscli_connect,
 	[
 		BUILD_WITH_LIBUPSCLIENT_CFLAGS="$with_upsclient_cflags"
 		BUILD_WITH_LIBUPSCLIENT_LIBS="$with_upsclient_libs"
 		AC_SUBST(BUILD_WITH_LIBUPSCLIENT_CFLAGS)
 		AC_SUBST(BUILD_WITH_LIBUPSCLIENT_LIBS)
 	],
 	[
-		with_libupsclient="no"
-	])
-	CFLAGS=$CFLAGS_ORIG
-	LDFLAGS=$LDFLAGS_ORIG
-fi
-if test "x$with_libupsclient" = "xyes"
-then
-	AC_DEFINE(HAVE_LIBUPSCLIENT, 1, [Define to 1 if you have the upsclient library (-lupsclient).])
+		with_libupsclient="no (symbol 'upscli_connect' not found)"
+	], [$with_upsclient_libs])
 fi
 if test "x$with_libupsclient" = "xyes"
 then
 	AC_CHECK_TYPES([UPSCONN_t, UPSCONN], [], [], 
 [#include <stdlib.h>
 #include <stdio.h>
@@ -1426,15 +1422,22 @@
 ])
 if test "x$with_libnetlink" = "xyes"
 then
 	SAVE_CFLAGS=$CFLAGS
 	CFLAGS="$CFLAGS $with_libnetlink_cflags"
 
-	AC_CHECK_HEADERS(iproute/libnetlink.h, [], [with_libnetlink="no (iproute/libnetlink.h not found)"],
+	with_libnetlink="no (libnetlink.h not found)"
+
+	AC_CHECK_HEADERS(libnetlink.h iproute/libnetlink.h linux/libnetlink.h,
+	[
+	 with_libnetlink="yes"
+	 break
+	], [],
 [#include <stdio.h>
 #include <sys/types.h>
+#include <asm/types.h>
 #include <sys/socket.h>
 #include <linux/netlink.h>
 #include <linux/rtnetlink.h>])
 
 	CFLAGS="$SAVE_CFLAGS"
 fi
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/contrib/collection.cgi /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/contrib/collection.cgi
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/contrib/collection.cgi	2007-09-02 03:00:40.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/contrib/collection.cgi	2007-09-12 18:31:35.000000000 +0800
@@ -456,279 +456,198 @@
 
 sub action_show_host
 {
   my @hosts = _get_param_host ();
   @hosts = sort (@hosts);
 
-  my $all_plugins = {};
-  my $plugins_per_host = {};
+  my $timespan = _get_param_timespan ();
+  my $all_plugins = _find_files_for_hosts (@hosts);
+
+  my $url_prefix = script_name () . '?action=show_plugin'
+  . join ('', map { ';host=' . uri_escape ($_) } (@hosts))
+  . ';timespan=' . uri_escape ($timespan);
+
+  print qq(    <div><a href="${\script_name ()}?action=overview">Back to list of hosts</a></div>\n);
 
+  print "    <p>Available plugins:</p>\n"
+  . "    <ul>\n";
+  for (sort (keys %$all_plugins))
+  {
+    my $plugin = $_;
+    my $plugin_html = encode_entities ($plugin);
+    my $url_plugin = $url_prefix . ';plugin=' . uri_escape ($plugin);
+    print qq(      <li><a href="$url_plugin">$plugin_html</a></li>\n);
+  }
+  print "   </ul>\n";
+} # action_show_host
+
+sub action_show_plugin
+{
+  my @hosts = _get_param_host ();
+  my $plugin = shift;
+  my $plugin_instance = shift;
   my $timespan = _get_param_timespan ();
 
+  my $hosts_url = join (';', map { 'host=' . uri_escape ($_) } (@hosts));
+  my $url_prefix = script_name () . "?$hosts_url";
+
+  my $all_plugins = {};
+  my $plugins_per_host = {};
+  my $selected_plugins = {};
+
   for (my $i = 0; $i < @hosts; $i++)
   {
     $plugins_per_host->{$hosts[$i]} = _find_files_for_host ($hosts[$i]);
     _files_union ($all_plugins, $plugins_per_host->{$hosts[$i]});
   }
 
-  my $param_host = join (";", map { "host=" . encode_entities ($_) } (@hosts));
-
-  print '<!-- ', Data::Dumper->Dump ([$all_plugins], ['all_plugins']), " -->\n";
-
-  my @plugins = sort (keys %$all_plugins);
+  for (param ('plugin'))
+  {
+    if (defined ($all_plugins->{$_}))
+    {
+      $selected_plugins->{$_} = 1;
+    }
+  }
 
-  print qq(    <div><a href="${\script_name ()}?action=overview">Back to list of hosts</a></div>\n);
+  print qq(    <div><a href="${\script_name ()}?action=show_host;$hosts_url">Back to list of plugins</a></div>\n);
 
+  # Print table header
   print <<HTML;
     <table class="graphs">
       <tr>
-	<th>Plugin</th>
+        <th>Plugins</th>
 HTML
-  for (my $i = 0; $i < @hosts; $i++)
+  for (@hosts)
   {
-    print "\t<th>", encode_entities ($hosts[$i]), "</th>\n";
+    print "\t<th>", encode_entities ($_), "</th>\n";
   }
   print "      </tr>\n";
-  for (my $i = 0; $i < @plugins; $i++)
-  {
-    my $plugin = $plugins[$i];
-    my $plugin_esc = encode_entities ($plugins[$i]);
 
-    my @pinsts = sort (keys %{$all_plugins->{$plugin}});
+  for (sort (keys %$selected_plugins))
+  {
+    my $plugin = $_;
+    my $plugin_html = encode_entities ($plugin);
+    my $plugin_url = "$url_prefix;plugin=" . uri_escape ($plugin);
+    my $all_pinst = $all_plugins->{$plugin};
 
-    for (my $j = 0; $j < @pinsts; $j++)
+    for (sort (keys %$all_pinst))
     {
-      my $pinst = $pinsts[$j];
-      my $pinst_esc = encode_entities ($pinst);
-      my $title = $plugin . ($pinst ne '-' ? " ($pinst)" : '');
-      my $title_esc = encode_entities ($title);
+      my $pinst = $_;
+      my $pinst_html = '';
+      my $pinst_url = $plugin_url;
 
-      my $param_plugin = "plugin=$plugin_esc";
       if ($pinst ne '-')
       {
-	$param_plugin .= ";plugin_instance=$pinst_esc";
+	$pinst_html = encode_entities ($pinst);
+	$pinst_url .= ';plugin_instance=' . uri_escape ($pinst);
       }
 
       my $files_printed = 0;
-      my $files_num = _files_plugin_inst_count ($all_plugins->{$plugin}{$pinst});
-      next if (!$files_num);
-
+      my $files_num = _files_plugin_inst_count ($all_pinst->{$pinst});
+      if ($files_num < 1)
+      {
+	next;
+      }
       my $rowspan = ($files_num == 1) ? '' : qq( rowspan="$files_num");
 
       for (sort (keys %{$all_plugins->{$plugin}{$pinst}}))
       {
 	my $type = $_;
-	my $type_esc = encode_entities ($type);
+	my $type_html = encode_entities ($type);
+	my $type_url = "$pinst_url;type=" . uri_escape ($type);
+
+	if ($files_printed == 0)
+	{
+	  my $title = $plugin_html;
+	  if ($pinst ne '-')
+	  {
+	    $title .= " ($pinst_html)";
+	  }
+	  print "      <tr>\n";
+	  print "\t<td$rowspan>$title</td>\n";
+	}
 
 	if (exists ($MetaGraphDefs->{$type}))
 	{
-	  my $param_type = "type=$type_esc";
+	  my $graph_url = script_name () . '?action=show_graph'
+	  . ';plugin=' . uri_escape ($plugin)
+	  . ';type=' . uri_escape ($type)
+	  . ';timespan=' . uri_escape ($timespan);
+	  if ($pinst ne '-')
+	  {
+	    $graph_url .= ';plugin_instance=' . uri_escape ($pinst);
+	  }
 
-	  print "      <tr>\n";
-	  if ($files_printed == 0)
+	  if ($files_printed != 0)
 	  {
-	    print "\t<td$rowspan>$title_esc</td>\n";
+	    print "      <tr>\n";
 	  }
 
-	  for (my $k = 0; $k < @hosts; $k++)
+	  for (@hosts)
 	  {
-	    my $host = $hosts[$k];
-	    my $host_esc = encode_entities ($host);
+	    my $host = $_;
+	    my $host_graph_url = $graph_url . ';host=' . uri_escape ($host);
 
 	    print "\t<td>";
 	    if (exists $plugins_per_host->{$host}{$plugin}{$pinst}{$type})
 	    {
-	      #print qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />);
-	      print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
+	      print qq(<img src="$host_graph_url" />);
+	      #print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
 	    }
 	    print "</td>\n";
 	  } # for (my $k = 0; $k < @hosts; $k++)
 
 	  print "      </tr>\n";
 
 	  $files_printed++;
 	  next; # pinst
-	}
+	} # if (exists ($MetaGraphDefs->{$type}))
 
 	for (sort (keys %{$all_plugins->{$plugin}{$pinst}{$type}}))
 	{
 	  my $tinst = $_;
 	  my $tinst_esc = encode_entities ($tinst);
-
-	  my $param_type = "type=$type_esc";
+	  my $graph_url = script_name () . '?action=show_graph'
+	  . ';plugin=' . uri_escape ($plugin)
+	  . ';type=' . uri_escape ($type)
+	  . ';timespan=' . uri_escape ($timespan);
+	  if ($pinst ne '-')
+	  {
+	    $graph_url .= ';plugin_instance=' . uri_escape ($pinst);
+	  }
 	  if ($tinst ne '-')
 	  {
-	    $param_type .= ";type_instance=$tinst_esc";
+	    $graph_url .= ';type_instance=' . uri_escape ($tinst);
 	  }
 
-	  print "      <tr>\n";
-	  if ($files_printed == 0)
+	  if ($files_printed != 0)
 	  {
-	    print "\t<td$rowspan>$title_esc</td>\n";
+	    print "      <tr>\n";
 	  }
 
 	  for (my $k = 0; $k < @hosts; $k++)
 	  {
 	    my $host = $hosts[$k];
-	    my $host_esc = encode_entities ($host);
+	    my $host_graph_url = $graph_url . ';host=' . uri_escape ($host);
 
 	    print "\t<td>";
 	    if ($plugins_per_host->{$host}{$plugin}{$pinst}{$type}{$tinst})
 	    {
-	      #print qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />);
-	      print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
+	      print qq(<img src="$host_graph_url" />);
+	      #print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
 	    }
 	    print "</td>\n";
 	  } # for (my $k = 0; $k < @hosts; $k++)
 
 	  print "      </tr>\n";
 
 	  $files_printed++;
 	} # for ($tinst)
       } # for ($type)
-    } # for (my $j = 0; $j < @pinsts; $j++)
-  } # for (my $i = 0; $i < @plugins; $i++)
-  print "   </table>\n";
-} # action_show_host
-
-sub action_show_plugin
-{
-  my @hosts = _get_param_host ();
-  my $plugin = shift;
-  my $plugin_instance = shift;
-  my $timespan = _get_param_timespan ();
-
-  my $hosts_url = join (';', map { 'host=' . uri_escape ($_) } (@hosts));
-  my $plugin_esc = encode_entities ($plugin);
-  my $plugin_url = uri_escape ($plugin);
-  my $plugin_instance_url = defined ($plugin_instance) ? uri_escape ($plugin_instance) : undef;
-
-  my $all_plugins = {};
-  my $plugins_per_host = {};
-
-  for (my $i = 0; $i < @hosts; $i++)
-  {
-    $plugins_per_host->{$hosts[$i]} = _find_files_for_host ($hosts[$i]);
-    _files_union ($all_plugins, $plugins_per_host->{$hosts[$i]});
-  }
-
-  my $url_prefix = script_name () . "?$hosts_url;plugin=$plugin_url";
-  $url_prefix .= ";plugin_instance=$plugin_instance_url" if (defined ($plugin_instance));
-
-  print qq(    <div><a href="${\script_name ()}?action=show_host;$hosts_url">Back to list of plugins</a></div>\n);
-
-  if (!defined ($all_plugins->{$plugin}))
-  {
-    print qq(    <div class="error">Plugin &quot;${\encode_entities ($plugin)}&quot; not found for host &quot;${\encode_entities (@hosts)}&quot;.</div>\n);
-    return;
-  }
-
-  my @pinsts = sort (keys %{$all_plugins->{$plugin}});
-
-  print <<HTML;
-    <table class="graphs">
-      <tr>
-	<th>Plugin</th>
-HTML
-  for (my $i = 0; $i < @hosts; $i++)
-  {
-    print "\t<th>", encode_entities ($hosts[$i]), "</th>\n";
-  }
-  print "      </tr>\n";
-
-  for (my $j = 0; $j < @pinsts; $j++)
-  {
-    my $pinst = $pinsts[$j];
-    my $pinst_esc = encode_entities ($pinst);
-    my $title = $plugin . ($pinst ne '-' ? " ($pinst)" : '');
-    my $title_esc = encode_entities ($title);
-
-    my $param_plugin = "plugin=$plugin_esc";
-    if ($pinst ne '-')
-    {
-      $param_plugin .= ";plugin_instance=$pinst_esc";
-    }
-
-    my $files_printed = 0;
-    my $files_num = _files_plugin_inst_count ($all_plugins->{$plugin}{$pinst});
-    next if (!$files_num);
-
-    my $rowspan = ($files_num == 1) ? '' : qq( rowspan="$files_num");
-
-    for (sort (keys %{$all_plugins->{$plugin}{$pinst}}))
-    {
-      my $type = $_;
-      my $type_esc = encode_entities ($type);
-
-      if (exists ($MetaGraphDefs->{$type}))
-      {
-	my $param_type = "type=$type_esc";
-
-	print "      <tr>\n";
-	if ($files_printed == 0)
-	{
-	  print "\t<td$rowspan>$title_esc</td>\n";
-	}
-
-	for (my $k = 0; $k < @hosts; $k++)
-	{
-	  my $host = $hosts[$k];
-	  my $host_esc = encode_entities ($host);
-
-	  print "\t<td>";
-	  if (exists $plugins_per_host->{$host}{$plugin}{$pinst}{$type})
-	  {
-	    print qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />);
-	    #print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
-	  }
-	  print "</td>\n";
-	} # for (my $k = 0; $k < @hosts; $k++)
-
-	print "      </tr>\n";
-
-	$files_printed++;
-	next; # pinst
-      }
-
-      for (sort (keys %{$all_plugins->{$plugin}{$pinst}{$type}}))
-      {
-	my $tinst = $_;
-	my $tinst_esc = encode_entities ($tinst);
-
-	my $param_type = "type=$type_esc";
-	if ($tinst ne '-')
-	{
-	  $param_type .= ";type_instance=$tinst_esc";
-	}
-
-	print "      <tr>\n";
-	if ($files_printed == 0)
-	{
-	  print "\t<td$rowspan>$title_esc</td>\n";
-	}
-
-	for (my $k = 0; $k < @hosts; $k++)
-	{
-	  my $host = $hosts[$k];
-	  my $host_esc = encode_entities ($host);
-
-	  print "\t<td>";
-	  if ($plugins_per_host->{$host}{$plugin}{$pinst}{$type}{$tinst})
-	  {
-	    print qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />);
-	    #print encode_entities (qq(<img src="${\script_name ()}?action=show_graph;host=$host_esc;$param_plugin;$param_type;timespan=$timespan" />));
-	  }
-	  print "</td>\n";
-	} # for (my $k = 0; $k < @hosts; $k++)
-
-	print "      </tr>\n";
-
-	$files_printed++;
-      } # for ($tinst)
-    } # for ($type)
-  } # for (my $j = 0; $j < @pinsts; $j++)
+    } # for ($pinst)
+  } # for ($plugin)
   print "   </table>\n";
 } # action_show_plugin
 
 sub action_show_type
 {
   my $host = shift;
@@ -827,13 +746,13 @@
     print qq(\t  <option value="$host"$selected>$host</option>\n);
   }
   print "\t</select>\n";
 
   if (keys %selected_hosts)
   {
-    my $all_plugins = _find_files_for_hosts (@hosts);
+    my $all_plugins = _find_files_for_hosts (keys %selected_hosts);
     my %selected_plugins = map { $_ => 1 } (param ('plugin'));
 
     print qq(\t<select name="plugin" multiple="multiple" size="10">\n);
     for (sort (keys %$all_plugins))
     {
       my $plugin = $_;
@@ -1666,57 +1585,63 @@
     mysql_commands => ['-v', 'Issues/s',
     "DEF:val_avg={file}:value:AVERAGE",
     "DEF:val_min={file}:value:MIN",
     "DEF:val_max={file}:value:MAX",
     "AREA:val_max#$HalfBlue",
     "AREA:val_min#$Canvas",
-    "LINE1:val_avg#$FullBlue:{inst}",
+    "LINE1:val_avg#$FullBlue:Issues/s",
     'GPRINT:val_min:MIN:%5.2lf Min,',
     'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
     'GPRINT:val_max:MAX:%5.2lf Max,',
     'GPRINT:val_avg:LAST:%5.2lf Last'
     ],
     mysql_handler => ['-v', 'Issues/s',
     "DEF:val_avg={file}:value:AVERAGE",
     "DEF:val_min={file}:value:MIN",
     "DEF:val_max={file}:value:MAX",
     "AREA:val_max#$HalfBlue",
     "AREA:val_min#$Canvas",
-    "LINE1:val_avg#$FullBlue:{inst}",
+    "LINE1:val_avg#$FullBlue:Issues/s",
     'GPRINT:val_min:MIN:%5.2lf Min,',
     'GPRINT:val_avg:AVERAGE:%5.2lf Avg,',
     'GPRINT:val_max:MAX:%5.2lf Max,',
     'GPRINT:val_avg:LAST:%5.2lf Last'
     ],
-    mysql_octets => ['-v', 'Bytes/s',
+    mysql_octets => ['-v', 'Bits/s',
     'DEF:out_min={file}:tx:MIN',
     'DEF:out_avg={file}:tx:AVERAGE',
     'DEF:out_max={file}:tx:MAX',
     'DEF:inc_min={file}:rx:MIN',
     'DEF:inc_avg={file}:rx:AVERAGE',
     'DEF:inc_max={file}:rx:MAX',
-    'CDEF:overlap=out_avg,inc_avg,GT,inc_avg,out_avg,IF',
     'CDEF:mytime=out_avg,TIME,TIME,IF',
     'CDEF:sample_len_raw=mytime,PREV(mytime),-',
     'CDEF:sample_len=sample_len_raw,UN,0,sample_len_raw,IF',
     'CDEF:out_avg_sample=out_avg,UN,0,out_avg,IF,sample_len,*',
     'CDEF:out_avg_sum=PREV,UN,0,PREV,IF,out_avg_sample,+',
     'CDEF:inc_avg_sample=inc_avg,UN,0,inc_avg,IF,sample_len,*',
     'CDEF:inc_avg_sum=PREV,UN,0,PREV,IF,inc_avg_sample,+',
-    "AREA:out_avg#$HalfGreen",
-    "AREA:inc_avg#$HalfBlue",
+    'CDEF:out_bit_min=out_min,8,*',
+    'CDEF:out_bit_avg=out_avg,8,*',
+    'CDEF:out_bit_max=out_max,8,*',
+    'CDEF:inc_bit_min=inc_min,8,*',
+    'CDEF:inc_bit_avg=inc_avg,8,*',
+    'CDEF:inc_bit_max=inc_max,8,*',
+    'CDEF:overlap=out_bit_avg,inc_bit_avg,GT,inc_bit_avg,out_bit_avg,IF',
+    "AREA:out_bit_avg#$HalfGreen",
+    "AREA:inc_bit_avg#$HalfBlue",
     "AREA:overlap#$HalfBlueGreen",
-    "LINE1:out_avg#$FullGreen:Written",
-    'GPRINT:out_avg:AVERAGE:%5.1lf%s Avg,',
-    'GPRINT:out_max:MAX:%5.1lf%s Max,',
-    'GPRINT:out_avg:LAST:%5.1lf%s Last',
+    "LINE1:out_bit_avg#$FullGreen:Written",
+    'GPRINT:out_bit_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:out_bit_max:MAX:%5.1lf%s Max,',
+    'GPRINT:out_bit_avg:LAST:%5.1lf%s Last',
     'GPRINT:out_avg_sum:LAST:(ca. %5.1lf%sB Total)\l',
-    "LINE1:inc_avg#$FullBlue:Read   ",
-    'GPRINT:inc_avg:AVERAGE:%5.1lf%s Avg,',
-    'GPRINT:inc_max:MAX:%5.1lf%s Max,',
-    'GPRINT:inc_avg:LAST:%5.1lf%s Last',
+    "LINE1:inc_bit_avg#$FullBlue:Read   ",
+    'GPRINT:inc_bit_avg:AVERAGE:%5.1lf%s Avg,',
+    'GPRINT:inc_bit_max:MAX:%5.1lf%s Max,',
+    'GPRINT:inc_bit_avg:LAST:%5.1lf%s Last',
     'GPRINT:inc_avg_sum:LAST:(ca. %5.1lf%sB Total)\l'
     ],
     mysql_qcache => ['-v', 'Queries/s',
     "DEF:hits_min={file}:hits:MIN",
     "DEF:hits_avg={file}:hits:AVERAGE",
     "DEF:hits_max={file}:hits:MAX",
@@ -2203,20 +2128,14 @@
     ],
     temperature => ['-v', 'Celsius',
     'DEF:temp_avg={file}:value:AVERAGE',
     'DEF:temp_min={file}:value:MIN',
     'DEF:temp_max={file}:value:MAX',
     'CDEF:average=temp_avg,0.2,*,PREV,UN,temp_avg,PREV,IF,0.8,*,+',
-    'CDEF:derivative=PREV(average),average,-',
-    'CDEF:rising=derivative,-0.01,LT,INF,UNKN,IF',
-    'CDEF:falling=derivative,0.01,GT,INF,UNKN,IF',
-    "AREA:rising#f0fff0",
-    "AREA:falling#fff0f0",
     "AREA:temp_max#$HalfRed",
     "AREA:temp_min#$Canvas",
-    #"LINE1:average#000000",
     "LINE1:temp_avg#$FullRed:Temperature",
     'GPRINT:temp_min:MIN:%4.1lf Min,',
     'GPRINT:temp_avg:AVERAGE:%4.1lf Avg,',
     'GPRINT:temp_max:MAX:%4.1lf Max,',
     'GPRINT:temp_avg:LAST:%4.1lf Last\l'
     ],
@@ -2410,13 +2329,20 @@
     ],
   };
   $GraphDefs->{'if_multicast'} = $GraphDefs->{'ipt_packets'};
   $GraphDefs->{'if_tx_errors'} = $GraphDefs->{'if_rx_errors'};
 
   $MetaGraphDefs->{'cpu'} = \&meta_graph_cpu;
+  $MetaGraphDefs->{'if_rx_errors'} = \&meta_graph_if_rx_errors;
+  $MetaGraphDefs->{'if_tx_errors'} = \&meta_graph_if_rx_errors;
   $MetaGraphDefs->{'memory'} = \&meta_graph_memory;
+  $MetaGraphDefs->{'nfs_procedure'} = \&meta_graph_nfs_procedure;
+  $MetaGraphDefs->{'ps_state'} = \&meta_graph_ps_state;
+  $MetaGraphDefs->{'swap'} = \&meta_graph_swap;
+  $MetaGraphDefs->{'mysql_commands'} = \&meta_graph_mysql_commands;
+  $MetaGraphDefs->{'mysql_handler'} = \&meta_graph_mysql_commands;
 } # load_graph_definitions
 
 sub meta_graph_generic_stack
 {
   confess ("Wrong number of arguments") if (@_ != 2);
 
@@ -2454,23 +2380,27 @@
       qq#DEF:${inst_name}_min=$file:value:MIN#,
       qq#DEF:${inst_name}_avg=$file:value:AVERAGE#,
       qq#DEF:${inst_name}_max=$file:value:MAX#,
       qq#CDEF:${inst_name}_nnl=${inst_name}_avg,UN,0,${inst_name}_avg,IF#);
   }
 
-  for (my $i = 0; $i < @$sources; $i++)
   {
-    my $inst_data0 = $sources->[@$sources - (1 + $i)];
-    my $inst_data1 = $sources->[@$sources - (($i == 0) ? 1 : $i)];
+    my $inst_data = $sources->[@$sources - 1];
+    my $inst_name = $inst_data->{'name'};
+
+    push (@cmd, qq#CDEF:${inst_name}_stk=${inst_name}_nnl#);
+  }
+  for (my $i = 1; $i < @$sources; $i++)
+  {
+    my $inst_data0 = $sources->[@$sources - ($i + 1)];
+    my $inst_data1 = $sources->[@$sources - $i];
 
     my $inst_name0 = $inst_data0->{'name'};
     my $inst_name1 = $inst_data1->{'name'};
 
-    my $cdef_name = ($i == 0) ? 'nnl' : 'stk';
-
-    push (@cmd, qq#CDEF:${inst_name0}_stk=${inst_name0}_nnl,${inst_name1}_${cdef_name},+#);
+    push (@cmd, qq#CDEF:${inst_name0}_stk=${inst_name0}_nnl,${inst_name1}_stk,+#);
   }
 
   for (my $i = 0; $i < @$sources; $i++)
   {
     my $inst_data = $sources->[$i];
     my $inst_name = $inst_data->{'name'};
@@ -2496,13 +2426,13 @@
 
     push (@cmd, qq(AREA:${inst_name}_stk#$area_color),
       qq(LINE1:${inst_name}_stk#$line_color:$legend),
       qq(GPRINT:${inst_name}_min:MIN:$number_format Min,),
       qq(GPRINT:${inst_name}_avg:AVERAGE:$number_format Avg,),
       qq(GPRINT:${inst_name}_max:MAX:$number_format Max,),
-      qq(GPRINT:${inst_name}_avg:LAST:$number_format Last\l),
+      qq(GPRINT:${inst_name}_avg:LAST:$number_format Last\\l),
     );
   }
 
   RRDs::graph (@cmd);
   if (my $errmsg = RRDs::error ())
   {
@@ -2626,7 +2556,261 @@
     );
   } # for (@$type_instances)
 
   return (meta_graph_generic_stack ($opts, $sources));
 } # meta_graph_cpu
 
+sub meta_graph_if_rx_errors
+{
+  confess ("Wrong number of arguments") if (@_ != 5);
+
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instances = shift;
+
+  my $opts = {};
+  my $sources = [];
+
+  $opts->{'title'} = "$host/$plugin"
+  . (defined ($plugin_instance) ? "-$plugin_instance" : '') . "/$type";
+  $opts->{'number_format'} = '%5.2lf';
+  $opts->{'rrd_opts'} = ['-v', 'Errors/s'];
+
+  my @files = ();
+
+  for (sort @$type_instances)
+  {
+    my $inst = $_;
+    my $file = '';
+    my $title = $opts->{'title'};
+
+    for (@DataDirs)
+    {
+      if (-e "$_/$title-$inst.rrd")
+      {
+	$file = "$_/$title-$inst.rrd";
+	last;
+      }
+    }
+    confess ("No file found for $title") if ($file eq '');
+
+    push (@$sources,
+      {
+	name => $inst,
+	file => $file
+      }
+    );
+  } # for (@$type_instances)
+
+  return (meta_graph_generic_stack ($opts, $sources));
+} # meta_graph_if_rx_errors
+
+sub meta_graph_mysql_commands
+{
+  confess ("Wrong number of arguments") if (@_ != 5);
+
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instances = shift;
+
+  my $opts = {};
+  my $sources = [];
+
+  $opts->{'title'} = "$host/$plugin"
+  . (defined ($plugin_instance) ? "-$plugin_instance" : '') . "/$type";
+  $opts->{'number_format'} = '%5.2lf';
+
+  my @files = ();
+
+  for (sort @$type_instances)
+  {
+    my $inst = $_;
+    my $file = '';
+    my $title = $opts->{'title'};
+
+    for (@DataDirs)
+    {
+      if (-e "$_/$title-$inst.rrd")
+      {
+	$file = "$_/$title-$inst.rrd";
+	last;
+      }
+    }
+    confess ("No file found for $title") if ($file eq '');
+
+    push (@$sources,
+      {
+	name => $inst,
+	file => $file
+      }
+    );
+  } # for (@$type_instances)
+
+  return (meta_graph_generic_stack ($opts, $sources));
+} # meta_graph_mysql_commands
+
+sub meta_graph_nfs_procedure
+{
+  confess ("Wrong number of arguments") if (@_ != 5);
+
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instances = shift;
+
+  my $opts = {};
+  my $sources = [];
+
+  $opts->{'title'} = "$host/$plugin"
+  . (defined ($plugin_instance) ? "-$plugin_instance" : '') . "/$type";
+  $opts->{'number_format'} = '%5.1lf%s';
+
+  my @files = ();
+
+  for (sort @$type_instances)
+  {
+    my $inst = $_;
+    my $file = '';
+    my $title = $opts->{'title'};
+
+    for (@DataDirs)
+    {
+      if (-e "$_/$title-$inst.rrd")
+      {
+	$file = "$_/$title-$inst.rrd";
+	last;
+      }
+    }
+    confess ("No file found for $title") if ($file eq '');
+
+    push (@$sources,
+      {
+	name => $inst,
+	file => $file
+      }
+    );
+  } # for (@$type_instances)
+
+  return (meta_graph_generic_stack ($opts, $sources));
+} # meta_graph_nfs_procedure
+
+sub meta_graph_ps_state
+{
+  confess ("Wrong number of arguments") if (@_ != 5);
+
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instances = shift;
+
+  my $opts = {};
+  my $sources = [];
+
+  $opts->{'title'} = "$host/$plugin"
+  . (defined ($plugin_instance) ? "-$plugin_instance" : '') . "/$type";
+
+  my @files = ();
+
+  $opts->{'colors'} =
+  {
+    'Running'      => '00e000',
+    'Sleeping'  => '0000ff',
+    'Paging'      => 'ffb000',
+    'Zombies'   => 'ff0000',
+    'Blocked'   => 'ff00ff',
+    'Stopped' => 'a000a0'
+  };
+
+  _custom_sort_arrayref ($type_instances,
+    [qw(paging blocked zombies stopped running sleeping)]);
+
+  for (@$type_instances)
+  {
+    my $inst = $_;
+    my $file = '';
+    my $title = $opts->{'title'};
+
+    for (@DataDirs)
+    {
+      if (-e "$_/$title-$inst.rrd")
+      {
+	$file = "$_/$title-$inst.rrd";
+	last;
+      }
+    }
+    confess ("No file found for $title") if ($file eq '');
+
+    push (@$sources,
+      {
+	name => ucfirst ($inst),
+	file => $file
+      }
+    );
+  } # for (@$type_instances)
+
+  return (meta_graph_generic_stack ($opts, $sources));
+} # meta_graph_ps_state
+
+sub meta_graph_swap
+{
+  confess ("Wrong number of arguments") if (@_ != 5);
+
+  my $host = shift;
+  my $plugin = shift;
+  my $plugin_instance = shift;
+  my $type = shift;
+  my $type_instances = shift;
+
+  my $opts = {};
+  my $sources = [];
+
+  $opts->{'title'} = "$host/$plugin"
+  . (defined ($plugin_instance) ? "-$plugin_instance" : '') . "/$type";
+  $opts->{'number_format'} = '%5.1lf%s';
+
+  my @files = ();
+
+  $opts->{'colors'} =
+  {
+    'Free'   => '00e000',
+    'Cached'  => '0000ff',
+    'Reserved'      => 'ffb000',
+    'Used'   => 'ff0000'
+  };
+
+  _custom_sort_arrayref ($type_instances,
+    [qw(free cached reserved used)]);
+
+  for (@$type_instances)
+  {
+    my $inst = $_;
+    my $file = '';
+    my $title = $opts->{'title'};
+
+    for (@DataDirs)
+    {
+      if (-e "$_/$title-$inst.rrd")
+      {
+	$file = "$_/$title-$inst.rrd";
+	last;
+      }
+    }
+    confess ("No file found for $title") if ($file eq '');
+
+    push (@$sources,
+      {
+	name => ucfirst ($inst),
+	file => $file
+      }
+    );
+  } # for (@$type_instances)
+
+  return (meta_graph_generic_stack ($opts, $sources));
+} # meta_graph_swap
+
 # vim: shiftwidth=2:softtabstop=2:tabstop=8
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/contrib/PerlLib/Collectd.pm /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/contrib/PerlLib/Collectd.pm
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/contrib/PerlLib/Collectd.pm	2007-09-02 03:55:18.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/contrib/PerlLib/Collectd.pm	2007-09-12 20:57:50.000000000 +0800
@@ -41,12 +41,12 @@
 	push @{$EXPORT_TAGS{'all'}}, grep {! $seen{$_}++ } @{$EXPORT_TAGS{$_}}
 		foreach keys %EXPORT_TAGS;
 }
 
 Exporter::export_ok_tags('all');
 
-bootstrap Collectd "4.1.0";
+bootstrap Collectd "4.1.1";
 
 1;
 
 # vim: set sw=4 ts=4 tw=78 noexpandtab :
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/README	2007-09-02 03:00:34.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/README	2007-09-12 20:57:11.000000000 +0800
@@ -131,12 +131,17 @@
       System sensors, accessed using lm_sensors: Voltages, temperatures and
       fan rotation speeds.
 
     - serial
       RX and TX of serial interfaces. Linux only; needs root privileges.
 
+    - snmp
+      Read values from SNMP (Simple Network Management Protocol) enabled
+      network devices such as switches, routers, thermometers, rack monitoring
+      servers, etc. See collectd-snmp(5).
+
     - swap
       Pages swapped out onto harddisk or whatever is called `swap' by the OS..
 
     - tape
       Bytes and operations read and written on tape devices. Solaris only.
 
@@ -147,12 +152,15 @@
       System resources used by Linux VServers.
       See <http://linux-vserver.org/>.
 
     - wireless
       Link quality of wireless cards. Linux only.
 
+    - xmms
+      Bitrate and frequency of music played with XMMS.
+
   * Output can be written or send to various destinations by the following
     plugins:
 
     - csv
       Write to comma separated values (CSV) files. This needs lots of
       diskspace but is extremely portable and can be analysed with almost
@@ -246,12 +254,16 @@
 
   * libiptc (optional)
     For querying iptables counters.
 
   * libmysqlclient (optional)
 
+  * libnetlink (optional)
+
+  * libnetsnmp (optional)
+
   * liboping (optional, if not found a version shipped with this distribution
     can be used)
     Used by the `ping' plugin to send and receive ICMP packets.
 
   * libpcap (optional)
     Used to capture packets by the `dns' plugin.
@@ -270,12 +282,14 @@
     by this library, are not supported in collectd right now..
     <http://www.i-scream.org/libstatgrab/> 
 
   * libupsclient/nut (optional)
     For the `nut' plugin which queries nut's `upsd'.
 
+  * libxmms (optional)
+
   * librt, libsocket, libkstat, libdevinfo
     Various standard Solaris libraries which provide system functions.
 
   * CoreFoundation.framework and IOKit.framework
     For compiling on Darwin in general and the `apple_sensors' plugin in
     particular.
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/apcups.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/apcups.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/apcups.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/apcups.c	2007-09-12 20:57:11.000000000 +0800
@@ -386,20 +386,20 @@
 
 	plugin_dispatch_values (type, &vl);
 }
 
 static void apc_submit (struct apc_detail_s *apcups_detail)
 {
-	apc_submit_generic ("apcups_voltage",    "input",   apcups_detail->linev);
-	apc_submit_generic ("apcups_voltage",    "output",  apcups_detail->outputv);
-	apc_submit_generic ("apcups_voltage",    "battery", apcups_detail->battv);
-	apc_submit_generic ("apcups_charge",     "",        apcups_detail->bcharge);
-	apc_submit_generic ("apcups_charge_pct", "",        apcups_detail->loadpct);
-	apc_submit_generic ("apcups_timeleft",   "",        apcups_detail->timeleft);
-	apc_submit_generic ("apcups_temp",       "",        apcups_detail->itemp);
-	apc_submit_generic ("apcups_frequency",  "input",   apcups_detail->linefreq);
+	apc_submit_generic ("voltage",    "input",   apcups_detail->linev);
+	apc_submit_generic ("voltage",    "output",  apcups_detail->outputv);
+	apc_submit_generic ("voltage",    "battery", apcups_detail->battv);
+	apc_submit_generic ("charge",     "",        apcups_detail->bcharge);
+	apc_submit_generic ("percent",    "charge",  apcups_detail->loadpct);
+	apc_submit_generic ("timeleft",   "",        apcups_detail->timeleft);
+	apc_submit_generic ("temperature", "",       apcups_detail->itemp);
+	apc_submit_generic ("frequency",  "input",   apcups_detail->linefreq);
 }
 
 static int apcups_read (void)
 {
 	struct apc_detail_s apcups_detail;
 	int status;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.1	2007-09-02 05:53:37.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.1	2007-09-12 21:23:54.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD 1"
-.TH COLLECTD 1 "2007-09-01" "4.1.0" "collectd"
+.TH COLLECTD 1 "2007-09-12" "4.1.1" "collectd"
 .SH "NAME"
 collectd \- System statistics collection daemon
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.c	2007-08-31 21:49:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.c	2007-09-12 18:31:35.000000000 +0800
@@ -111,13 +111,13 @@
 	{
 		if (errno == ENOENT)
 		{
 			if (mkdir (orig_dir, 0755) == -1)
 			{
 				char errbuf[1024];
-				ERROR ("mkdir (%s): %s", orig_dir,
+				ERROR ("change_basedir: mkdir (%s): %s", orig_dir,
 						sstrerror (errno, errbuf,
 							sizeof (errbuf)));
 				return (-1);
 			}
 			else if (chdir (orig_dir) == -1)
 			{
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.conf.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.conf.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.conf.5	2007-09-02 05:53:37.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.conf.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD.CONF 5"
-.TH COLLECTD.CONF 5 "2007-09-01" "4.1.0" "collectd"
+.TH COLLECTD.CONF 5 "2007-09-12" "4.1.1" "collectd"
 .SH "NAME"
 collectd.conf \- Configuration for the system statistics collection daemon \fBcollectd\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 3
 \&  BaseDir "/path/to/data/"
@@ -332,15 +332,21 @@
 Please make sure to read \fIcollectd\-exec\fR\|(5) before using this plugin. It
 contains valuable information on when the executable is executed and the
 output that is expected from it.
 .IP "\fBExec\fR \fIUser\fR[:[\fIGroup\fR]] \fIExecutable\fR" 4
 .IX Item "Exec User[:[Group]] Executable"
 Execute the executable \fIExecutable\fR as user \fIUser\fR. If the user name is
-followed by a colon and a group name, the program is executed as the specified
-group. If only the colon follows the user name the group defaults to the
-user's login group.
+followed by a colon and a group name, the effective group is set to that group.
+The real group and saved-set group will be set to the default group of that
+user. If no group is given the effective group \s-1ID\s0 will be the same as the real
+group \s-1ID\s0.
+.Sp
+Please note that in order to change the user and/or group the daemon needs
+superuser privileges. If the daemon is run as an unprivileged user you must
+specify the same user/group here. If the daemon is run with superuser
+privileges, you must supply a non-root user here.
 .ie n .Sh "Plugin ""hddtemp"""
 .el .Sh "Plugin \f(CWhddtemp\fP"
 .IX Subsection "Plugin hddtemp"
 To get values from \fBhddtemp\fR collectd connects to \fBlocalhost\fR (127.0.0.1),
 port \fB7634/tcp\fR. The \fBHost\fR and \fBPort\fR options can be used to change these
 default values, see below. \f(CW\*(C`hddtemp\*(C'\fR has to be running to work correctly. If
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.conf.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.conf.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd.conf.in	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd.conf.in	2007-09-12 20:57:11.000000000 +0800
@@ -43,19 +43,21 @@
 @BUILD_PLUGIN_PERL_TRUE@LoadPlugin perl
 @BUILD_PLUGIN_PING_TRUE@LoadPlugin ping
 @BUILD_PLUGIN_PROCESSES_TRUE@LoadPlugin processes
 @BUILD_PLUGIN_RRDTOOL_TRUE@LoadPlugin rrdtool
 @BUILD_PLUGIN_SENSORS_TRUE@LoadPlugin sensors
 @BUILD_PLUGIN_SERIAL_TRUE@LoadPlugin serial
+@BUILD_PLUGIN_SNMP_TRUE@LoadPlugin snmp
 @BUILD_PLUGIN_SWAP_TRUE@LoadPlugin swap
 @BUILD_PLUGIN_SYSLOG_TRUE@LoadPlugin syslog
 @BUILD_PLUGIN_TAPE_TRUE@LoadPlugin tape
 @BUILD_PLUGIN_UNIXSOCK_TRUE@LoadPlugin unixsock
 @BUILD_PLUGIN_USERS_TRUE@LoadPlugin users
 @BUILD_PLUGIN_VSERVER_TRUE@LoadPlugin vserver
 @BUILD_PLUGIN_WIRELESS_TRUE@LoadPlugin wireless
+@BUILD_PLUGIN_XMMS_TRUE@LoadPlugin xmms
 
 #<Plugin apache>
 #	URL "http://localhost/status?auto"
 #	User "www-user"
 #	Password "secret"
 #	CACert "/etc/ssl/ca.crt"
@@ -88,13 +90,13 @@
 #	SocketGroup "collectd"
 #	SocketPerms "0770"
 #	MaxConns 5
 #</Plugin>
 
 #<Plugin exec>
-#	Exec user "/path/to/exec"
+#	Exec "user:group" "/path/to/exec"
 #</Plugin>
 
 #<Plugin hddtemp>
 #	Host "127.0.0.1"
 #	Port 7634
 #</Plugin>
@@ -187,12 +189,54 @@
 #	Sensor "it8712-isa-0290/temperature-temp1"
 #	Sensor "it8712-isa-0290/fanspeed-fan3"
 #	Sensor "it8712-isa-0290/voltage-in8"
 #	IgnoreSelected false
 #</Plugin>
 
+#<Plugin snmp>
+#   <Data "powerplus_voltge_input">
+#       Type "voltage"
+#       Table false
+#       Instance "input_line1"
+#       Values "SNMPv2-SMI::enterprises.6050.5.4.1.1.2.1"
+#   </Data>
+#   <Data "hr_users">
+#       Type "users"
+#       Table false
+#       Instance ""
+#       Values "HOST-RESOURCES-MIB::hrSystemNumUsers.0"
+#   </Data>
+#   <Data "std_traffic">
+#       Type "if_octets"
+#       Table true
+#       Instance "IF-MIB::ifDescr"
+#       Values "IF-MIB::ifInOctets" "IF-MIB::ifOutOctets"
+#   </Data>
+#   
+#   <Host "some.switch.mydomain.org">
+#       Address "192.168.0.2"
+#       Version 1
+#       Community "community_string"
+#       Collect "std_traffic"
+#       Inverval 120
+#   </Host>
+#   <Host "some.server.mydomain.org">
+#       Address "192.168.0.42"
+#       Version 2
+#       Community "another_string"
+#       Collect "std_traffic" "hr_users"
+#   </Host>
+#   <Host "some.ups.mydomain.org">
+#       Address "192.168.0.3"
+#       Version 1
+#       Community "more_communities"
+#       Collect "powerplus_voltge_input"
+#       Interval 300
+#   </Host>
+#</Plugin>
+
 #<Plugin syslog>
 #	LogLevel info
 #</Plugin>
 
 #<Plugin unixsock>
 #	SocketFile "@prefix@/var/run/@PACKAGE_NAME@-unixsock"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-email.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-email.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-email.5	2007-09-02 05:53:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-email.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EMAIL 5"
-.TH COLLECTD-EMAIL 5 "2007-08-31" "4.1.0" "collectd"
+.TH COLLECTD-EMAIL 5 "2007-08-31" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-email \- Documentation of collectd's \f(CW\*(C`email plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-exec.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-exec.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-exec.5	2007-09-02 05:53:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-exec.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,24 +126,24 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-EXEC 5"
-.TH COLLECTD-EXEC 5 "2007-09-01" "4.1.0" "collectd"
+.TH COLLECTD-EXEC 5 "2007-09-12" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-exec \- Documentation of collectd's \f(CW\*(C`exec plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 7
 \&  # See collectd.conf(5)
 \&  LoadPlugin exec
 \&  # ...
 \&  <Plugin exec>
-\&    Exec myuser myprog
-\&    Exec otheruser /path/to/another/binary
+\&    Exec "myuser:mygroup" "myprog"
+\&    Exec "otheruser" "/path/to/another/binary"
 \&  </Plugin>
 .Ve
 .SH "DESCRIPTION"
 .IX Header "DESCRIPTION"
 The \f(CW\*(C`exec plugin\*(C'\fR forks of an executable and reads back values that it writes
 to \f(CW\*(C`STDOUT\*(C'\fR. The executable is forked in a fashion similar to init: It is
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-nagios.1 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-nagios.1
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-nagios.1	2007-09-02 05:53:37.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-nagios.1	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-NAGIOS 1"
-.TH COLLECTD-NAGIOS 1 "2007-08-31" "4.1.0" "collectd"
+.TH COLLECTD-NAGIOS 1 "2007-09-02" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-nagios \- Nagios plugin for querying collectd
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 collectd-nagios \fB\-s\fR \fIsocket\fR \fB\-n\fR \fIvalue_spec\fR \fB\-H\fR \fIhostname\fR \fI[options]\fR
 .SH "DESCRIPTION"
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-perl.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-perl.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-perl.5	2007-09-02 05:53:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-perl.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-PERL 5"
-.TH COLLECTD-PERL 5 "2007-08-31" "4.1.0" "collectd"
+.TH COLLECTD-PERL 5 "2007-09-02" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-perl \- Documentation of collectd's \f(CW\*(C`perl plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-snmp.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-snmp.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-snmp.5	2007-09-02 05:53:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-snmp.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-SNMP 5"
-.TH COLLECTD-SNMP 5 "2007-09-01" "4.1.0" "collectd"
+.TH COLLECTD-SNMP 5 "2007-09-12" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-snmp \- Documentation of collectd's \f(CW\*(C`snmp plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 21
 \&  LoadPlugin snmp
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-unixsock.5 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-unixsock.5
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/collectd-unixsock.5	2007-09-02 05:53:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/collectd-unixsock.5	2007-09-12 21:23:55.000000000 +0800
@@ -126,13 +126,13 @@
 .    ds Ae AE
 .\}
 .rm #[ #] #H #V #F C
 .\" ========================================================================
 .\"
 .IX Title "COLLECTD-UNIXSOCK 5"
-.TH COLLECTD-UNIXSOCK 5 "2007-09-01" "4.1.0" "collectd"
+.TH COLLECTD-UNIXSOCK 5 "2007-09-12" "4.1.1" "collectd"
 .SH "NAME"
 collectd\-unixsock \- Documentation of collectd's \f(CW\*(C`unixsock plugin\*(C'\fR
 .SH "SYNOPSIS"
 .IX Header "SYNOPSIS"
 .Vb 8
 \&  # See collectd.conf(5)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/common.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/common.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/common.c	2007-08-31 21:49:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/common.c	2007-09-12 18:31:35.000000000 +0800
@@ -67,18 +67,41 @@
 		exit(3);
 	}
 
 	return (r);
 }
 
-/* Don't use the return value of `strerror_r', because the GNU-people got
- * inventive there.. -octo */
+/* Even though Posix requires "strerror_r" to return an "int",
+ * some systems (e.g. the GNU libc) return a "char *" _and_
+ * ignore the second argument ... -tokkee */
 char *sstrerror (int errnum, char *buf, size_t buflen)
 {
 	buf[0] = '\0';
-	strerror_r (errnum, buf, buflen);
+#ifdef STRERROR_R_CHAR_P
+	{
+		char *temp;
+		temp = strerror_r (errnum, buf, buflen);
+		if (buf[0] == '\0')
+		{
+			if ((temp != NULL) && (temp != buf) && (temp[0] != '\0'))
+				strncpy (buf, temp, buflen);
+			else
+				strncpy (buf, "strerror_r did not return "
+						"an error message", buflen);
+			buf[buflen - 1] = '\0';
+		}
+	}
+#else
+	if (strerror_r (errnum, buf, buflen) != 0)
+	{
+		snprintf (buf, buflen, "Error #%i; "
+				"Additionally, strerror_r failed.",
+				errnum);
+	}
+#endif /* STRERROR_R_CHAR_P */
+	buf[buflen - 1] = '\0';
 	return (buf);
 } /* char *sstrerror */
 
 void *smalloc (size_t size)
 {
 	void *r;
@@ -395,13 +418,13 @@
 		{
 			if (errno == ENOENT)
 			{
 				if (mkdir (dir, 0755) == -1)
 				{
 					char errbuf[1024];
-					ERROR ("mkdir (%s): %s", dir,
+					ERROR ("check_create_dir: mkdir (%s): %s", dir,
 							sstrerror (errno,
 								errbuf, sizeof (errbuf)));
 					return (-1);
 				}
 			}
 			else
@@ -418,13 +441,13 @@
 			ERROR ("stat (%s): Not a directory!", dir);
 			return (-1);
 		}
 	}
 
 	return (0);
-}
+} /* check_create_dir */
 
 #ifdef HAVE_LIBKSTAT
 int get_kstat (kstat_t **ksp_ptr, char *module, int instance, char *name)
 {
 	char ident[128];
 	
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/config.h.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/config.h.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/config.h.in	2007-09-02 04:14:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/config.h.in	2007-09-12 21:22:58.000000000 +0800
@@ -46,12 +46,16 @@
 /* Define to 1 if you have the <ctype.h> header file. */
 #undef HAVE_CTYPE_H
 
 /* Define to 1 if you have the <curl/curl.h> header file. */
 #undef HAVE_CURL_CURL_H
 
+/* Define to 1 if you have the declaration of `strerror_r', and to 0 if you
+   don't. */
+#undef HAVE_DECL_STRERROR_R
+
 /* Define to 1 if you have the <dirent.h> header file, and it defines `DIR'.
    */
 #undef HAVE_DIRENT_H
 
 /* Define to 1 if you have the <dlfcn.h> header file. */
 #undef HAVE_DLFCN_H
@@ -156,15 +160,12 @@
 /* Define to 1 if `wtime' is member of `kstat_io_t'. */
 #undef HAVE_KSTAT_IO_T_WTIME
 
 /* Define to 1 if you have the <kvm.h> header file. */
 #undef HAVE_KVM_H
 
-/* Define to 1 if you have the curl library. */
-#undef HAVE_LIBCURL
-
 /* Define to 1 if you have the <libgen.h> header file. */
 #undef HAVE_LIBGEN_H
 
 /* Define to 1 if you have the iptc library (-liptc). */
 #undef HAVE_LIBIPTC
 
@@ -177,14 +178,14 @@
 /* Define to 1 if you have the 'kvm' library (-lkvm) */
 #undef HAVE_LIBKVM
 
 /* Define to 1 if you have the `m' library (-lm). */
 #undef HAVE_LIBM
 
-/* Define to 1 if you have the mysqlclient library. */
-#undef HAVE_LIBMYSQLCLIENT
+/* Define to 1 if you have the <libnetlink.h> header file. */
+#undef HAVE_LIBNETLINK_H
 
 /* Define to 1 if you have the pcap library (-lpcap). */
 #undef HAVE_LIBPCAP
 
 /* Define if libperl is present and usable. */
 #undef HAVE_LIBPERL
@@ -201,27 +202,27 @@
 /* Define to 1 if you have the sensors library (-lsensors). */
 #undef HAVE_LIBSENSORS
 
 /* Define to 1 if you have the Net-SNMP library (-lnetsnmp). */
 #undef HAVE_LIBSNMP
 
-/* Define to 1 if you have the upsclient library (-lupsclient). */
-#undef HAVE_LIBUPSCLIENT
-
 /* Define to 1 if you have the 'xmms' library (-lxmms). */
 #undef HAVE_LIBXMMS
 
 /* Define to 1 if you have the <limits.h> header file. */
 #undef HAVE_LIMITS_H
 
 /* Define to 1 if you have the <linux/config.h> header file. */
 #undef HAVE_LINUX_CONFIG_H
 
 /* Define to 1 if you have the <linux/if.h> header file. */
 #undef HAVE_LINUX_IF_H
 
+/* Define to 1 if you have the <linux/libnetlink.h> header file. */
+#undef HAVE_LINUX_LIBNETLINK_H
+
 /* Define to 1 if you have the <linux/major.h> header file. */
 #undef HAVE_LINUX_MAJOR_H
 
 /* Define to 1 if you have the <linux/netdevice.h> header file. */
 #undef HAVE_LINUX_NETDEVICE_H
 
@@ -570,12 +571,15 @@
 /* Define to 1 if you have the `strcmp' function. */
 #undef HAVE_STRCMP
 
 /* Define to 1 if you have the `strdup' function. */
 #undef HAVE_STRDUP
 
+/* Define to 1 if you have the `strerror_r' function. */
+#undef HAVE_STRERROR_R
+
 /* Define to 1 if you have the <strings.h> header file. */
 #undef HAVE_STRINGS_H
 
 /* Define to 1 if you have the <string.h> header file. */
 #undef HAVE_STRING_H
 
@@ -734,12 +738,15 @@
 /* Define if the function getmntent exists and takes two arguments. */
 #undef HAVE_TWO_GETMNTENT
 
 /* Define to 1 if you have the <unistd.h> header file. */
 #undef HAVE_UNISTD_H
 
+/* Define to 1 if you have the <upsclient.h> header file. */
+#undef HAVE_UPSCLIENT_H
+
 /* Define to 1 if the system has the type `UPSCONN'. */
 #undef HAVE_UPSCONN
 
 /* Define to 1 if the system has the type `UPSCONN_t'. */
 #undef HAVE_UPSCONN_T
 
@@ -786,12 +793,15 @@
 /* Define to the version of this package. */
 #undef PACKAGE_VERSION
 
 /* Define to 1 if you have the ANSI C header files. */
 #undef STDC_HEADERS
 
+/* Define to 1 if strerror_r returns char *. */
+#undef STRERROR_R_CHAR_P
+
 /* Define to 1 if you can safely include both <sys/time.h> and <time.h>. */
 #undef TIME_WITH_SYS_TIME
 
 /* Version number of package */
 #undef VERSION
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/dns.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/dns.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/dns.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/dns.c	2007-09-12 20:57:11.000000000 +0800
@@ -226,19 +226,17 @@
 		return (NULL);
 	}
 
 	memset (&fp, 0, sizeof (fp));
 	if (pcap_compile (pcap_obj, &fp, "udp port 53", 1, 0) < 0)
 	{
-		DEBUG ("pcap_compile failed");
 		ERROR ("dns plugin: pcap_compile failed");
 		return (NULL);
 	}
 	if (pcap_setfilter (pcap_obj, &fp) < 0)
 	{
-		DEBUG ("pcap_setfilter failed");
 		ERROR ("dns plugin: pcap_setfilter failed");
 		return (NULL);
 	}
 
 	DEBUG ("PCAP object created.");
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/exec.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/exec.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/exec.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/exec.c	2007-09-12 20:57:11.000000000 +0800
@@ -115,12 +115,13 @@
 
 static void exec_child (program_list_t *pl)
 {
   int status;
   int uid;
   int gid;
+  int egid;
   char *arg0;
 
   struct passwd *sp_ptr;
   struct passwd sp;
   char nambuf[2048];
   char errbuf[1024];
@@ -137,26 +138,22 @@
   {
     ERROR ("exec plugin: No such user: `%s'", pl->user);
     exit (-1);
   }
 
   uid = sp.pw_uid;
+  gid = sp.pw_gid;
   if (uid == 0)
   {
     ERROR ("exec plugin: Cowardly refusing to exec program as root.");
     exit (-1);
   }
 
-  status = setuid (uid);
-  if (status != 0)
-  {
-    ERROR ("exec plugin: setuid failed: %s",
-	sstrerror (errno, errbuf, sizeof (errbuf)));
-    exit (-1);
-  }
-
+  /* The group configured in the configfile is set as effective group, because
+   * this way the forked process can (re-)gain the user's primary group. */
+  egid = -1;
   if (NULL != pl->group)
   {
     if ('\0' != *pl->group) {
       struct group *gr_ptr = NULL;
       struct group gr;
 
@@ -170,28 +167,47 @@
       if (NULL == gr_ptr)
       {
 	ERROR ("exec plugin: No such group: `%s'", pl->group);
 	exit (-1);
       }
 
-      gid = gr.gr_gid;
+      egid = gr.gr_gid;
     }
     else
     {
-      gid = sp.pw_gid;
+      egid = gid;
     }
+  } /* if (pl->group == NULL) */
 
-    status = setgid (gid);
-    if (0 != status)
+  status = setgid (gid);
+  if (status != 0)
+  {
+    ERROR ("exec plugin: setgid (%i) failed: %s",
+	gid, sstrerror (errno, errbuf, sizeof (errbuf)));
+    exit (-1);
+  }
+
+  if (egid != -1)
+  {
+    status = setegid (egid);
+    if (status != 0)
     {
-      ERROR ("exec plugin: setgid failed: %s",
-	  sstrerror (errno, errbuf, sizeof (errbuf)));
+      ERROR ("exec plugin: setegid (%i) failed: %s",
+	  egid, sstrerror (errno, errbuf, sizeof (errbuf)));
       exit (-1);
     }
   }
 
+  status = setuid (uid);
+  if (status != 0)
+  {
+    ERROR ("exec plugin: setuid (%i) failed: %s",
+	uid, sstrerror (errno, errbuf, sizeof (errbuf)));
+    exit (-1);
+  }
+
   arg0 = strrchr (pl->exec, '/');
   if (arg0 != NULL)
     arg0++;
   if ((arg0 == NULL) || (*arg0 == '\0'))
     arg0 = pl->exec;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/netlink.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/netlink.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/netlink.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/netlink.c	2007-09-12 20:57:11.000000000 +0800
@@ -22,18 +22,23 @@
 #include "collectd.h"
 #include "plugin.h"
 #include "common.h"
 
 #include <asm/types.h>
 #include <sys/socket.h>
-#include <iproute/libnetlink.h>
 #include <linux/netlink.h>
 #include <linux/rtnetlink.h>
 #include <linux/gen_stats.h>
 
-#include <iproute/ll_map.h>
+#if HAVE_LIBNETLINK_H
+# include <libnetlink.h>
+#elif HAVE_IPROUTE_LIBNETLINK_H
+# include <iproute/libnetlink.h>
+#elif HAVE_LINUX_LIBNETLINK_H
+# include <linux/libnetlink.h>
+#endif
 
 typedef struct ir_ignorelist_s
 {
   char *device;
   char *type;
   char *inst;
@@ -502,19 +507,13 @@
 static int ir_init (void)
 {
   memset (&rth, '\0', sizeof (rth));
 
   if (rtnl_open (&rth, 0) != 0)
   {
-    ERROR ("netlink plugin: ir_read: rtnl_open failed.");
-    return (-1);
-  }
-
-  if (ll_init_map (&rth) != 0)
-  {
-    ERROR ("netlink plugin: ir_read: ll_init_map failed.");
+    ERROR ("netlink plugin: ir_init: rtnl_open failed.");
     return (-1);
   }
 
   return (0);
 } /* int ir_init */
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/ntpd.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/ntpd.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/ntpd.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/ntpd.c	2007-09-12 20:57:11.000000000 +0800
@@ -387,13 +387,12 @@
 	}
 
 	freeaddrinfo (ai_list);
 
 	if (sock_descr < 0)
 	{
-		DEBUG ("Unable to connect to server.");
 		ERROR ("ntpd plugin: Unable to connect to server.");
 	}
 
 	return (sock_descr);
 }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/plugin.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/plugin.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/plugin.c	2007-09-02 03:00:46.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/plugin.c	2007-09-12 20:57:11.000000000 +0800
@@ -130,12 +130,13 @@
 
 	if ((dlh = lt_dlopen (file)) == NULL)
 	{
 		const char *error = lt_dlerror ();
 
 		ERROR ("lt_dlopen failed: %s", error);
+		fprintf (stderr, "lt_dlopen failed: %s\n", error);
 		return (1);
 	}
 
 	if ((reg_handle = (void (*) (void)) lt_dlsym (dlh, "module_register")) == NULL)
 	{
 		WARNING ("Couldn't find symbol ``module_register'' in ``%s'': %s\n",
@@ -352,12 +353,16 @@
 		if (plugin_load_file (filename) == 0)
 		{
 			/* success */
 			ret = 0;
 			break;
 		}
+		else
+		{
+			fprintf (stderr, "Unable to load plugin %s.\n", type);
+		}
 	}
 
 	closedir (dh);
 
 	return (ret);
 }
@@ -644,16 +649,18 @@
 		DEBUG ("No such dataset registered: %s", name);
 		return (-1);
 	}
 
 	ds = (data_set_t *) le->value;
 
-	DEBUG ("plugin: plugin_dispatch_values: time = %u; host = %s; "
-			"plugin = %s; plugin_instance = %s; type = %s; "
-			"type_instance = %s;",
-			(unsigned int) vl->time, vl->host,
+	DEBUG ("plugin: plugin_dispatch_values: time = %u; interval = %i; "
+			"host = %s; "
+			"plugin = %s; plugin_instance = %s; "
+			"type = %s; type_instance = %s;",
+			(unsigned int) vl->time, vl->interval,
+			vl->host,
 			vl->plugin, vl->plugin_instance,
 			ds->type, vl->type_instance);
 
 #if COLLECT_DEBUG
 	assert (ds->ds_num == vl->values_len);
 #else
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/rrdtool.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/rrdtool.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/rrdtool.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/rrdtool.c	2007-09-12 20:57:11.000000000 +0800
@@ -334,12 +334,13 @@
 	char **rra_def;
 	int rra_num;
 	char **ds_def;
 	int ds_num;
 	int i, j;
 	char stepsize_str[16];
+	char begin_str[16];
 	int status = 0;
 
 	if (check_create_dir (filename))
 		return (-1);
 
 	if ((rra_num = rra_get (&rra_def, vl)) < 1)
@@ -351,13 +352,13 @@
 	if ((ds_num = ds_get (&ds_def, ds, vl)) < 1)
 	{
 		ERROR ("rrd_create_file failed: Could not calculate DSes");
 		return (-1);
 	}
 
-	argc = ds_num + rra_num + 4;
+	argc = ds_num + rra_num + 6;
 
 	if ((argv = (char **) malloc (sizeof (char *) * (argc + 1))) == NULL)
 	{
 		char errbuf[1024];
 		ERROR ("rrd_create failed: %s",
 				sstrerror (errno, errbuf, sizeof (errbuf)));
@@ -372,18 +373,29 @@
 		free (argv);
 		ds_free (ds_num, ds_def);
 		rra_free (rra_num, rra_def);
 		return (-1);
 	}
 
+	assert (vl->time > 10);
+	status = snprintf (begin_str, sizeof (begin_str),
+			"%llu", (unsigned long long) (vl->time - 10));
+	if ((status < 1) || (status >= sizeof (begin_str)))
+	{
+		ERROR ("rrdtool plugin: snprintf failed.");
+		return (-1);
+	}
+
 	argv[0] = "create";
 	argv[1] = filename;
-	argv[2] = "-s";
-	argv[3] = stepsize_str;
+	argv[2] = "-b";
+	argv[3] = begin_str;
+	argv[4] = "-s";
+	argv[5] = stepsize_str;
 
-	j = 4;
+	j = 6;
 	for (i = 0; i < ds_num; i++)
 		argv[j++] = ds_def[i];
 	for (i = 0; i < rra_num; i++)
 		argv[j++] = rra_def[i];
 	argv[j] = NULL;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/unixsock.c /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/unixsock.c
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.0/src/unixsock.c	2007-09-02 03:00:35.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/collectd/repos/collectd-4.1.1/src/unixsock.c	2007-09-12 20:57:12.000000000 +0800
@@ -349,18 +349,19 @@
 	memset (&sa, '\0', sizeof (sa));
 	sa.sun_family = AF_UNIX;
 	strncpy (sa.sun_path, (sock_file != NULL) ? sock_file : US_DEFAULT_PATH,
 			sizeof (sa.sun_path) - 1);
 	/* unlink (sa.sun_path); */
 
+	DEBUG ("unixsock plugin: socket path = %s", sa.sun_path);
+
 	status = bind (sock_fd, (struct sockaddr *) &sa, sizeof (sa));
 	if (status != 0)
 	{
 		char errbuf[1024];
 		sstrerror (errno, errbuf, sizeof (errbuf));
-		DEBUG ("bind failed: %s; sa.sun_path = %s", errbuf, sa.sun_path);
 		ERROR ("unixsock plugin: bind failed: %s", errbuf);
 		close (sock_fd);
 		sock_fd = -1;
 		return (-1);
 	}
 
