<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/curl/gumtree/curl_repos_function_248.cpp" pos:tabs="8"><function><type><name pos:line="1" pos:column="1">CURLcode<pos:position pos:line="1" pos:column="9"/></name></type> <name pos:line="1" pos:column="10">Curl_follow<pos:position pos:line="1" pos:column="21"/></name><parameter_list pos:line="1" pos:column="21">(<parameter><decl><type><name><name pos:line="1" pos:column="22">struct<pos:position pos:line="1" pos:column="28"/></name> <name pos:line="1" pos:column="29">SessionHandle<pos:position pos:line="1" pos:column="42"/></name></name> <modifier pos:line="1" pos:column="43">*<pos:position pos:line="1" pos:column="44"/></modifier></type><name pos:line="1" pos:column="44">data<pos:position pos:line="1" pos:column="48"/></name></decl></parameter>,
                     <parameter><decl><type><name pos:line="2" pos:column="22">char<pos:position pos:line="2" pos:column="26"/></name> <modifier pos:line="2" pos:column="27">*<pos:position pos:line="2" pos:column="28"/></modifier></type><name pos:line="2" pos:column="28">newurl<pos:position pos:line="2" pos:column="34"/></name></decl></parameter>, <comment type="block" pos:line="2" pos:column="36">/* this 'newurl' is the Location: string,
                                      and it must be malloc()ed before passed
                                      here */</comment>
                     <parameter><decl><type><name pos:line="5" pos:column="22">bool<pos:position pos:line="5" pos:column="26"/></name></type> <name pos:line="5" pos:column="27">retry<pos:position pos:line="5" pos:column="32"/></name></decl></parameter>)<pos:position pos:line="5" pos:column="33"/></parameter_list> <comment type="block" pos:line="5" pos:column="34">/* set TRUE if this is a request retry as
                                    opposed to a real redirect following */</comment>
<block pos:line="7" pos:column="1">{
  <comment type="block" pos:line="8" pos:column="3">/* Location: redirect */</comment>
  <decl_stmt><decl><type><name pos:line="9" pos:column="3">char<pos:position pos:line="9" pos:column="7"/></name></type> <name><name pos:line="9" pos:column="8">prot<pos:position pos:line="9" pos:column="12"/></name><index pos:line="9" pos:column="12">[<expr><literal type="number" pos:line="9" pos:column="13">16<pos:position pos:line="9" pos:column="15"/></literal></expr>]<pos:position pos:line="9" pos:column="16"/></index></name></decl>;<pos:position pos:line="9" pos:column="17"/></decl_stmt> <comment type="block" pos:line="9" pos:column="18">/* URL protocol string storage */</comment>
  <decl_stmt><decl><type><name pos:line="10" pos:column="3">char<pos:position pos:line="10" pos:column="7"/></name></type> <name pos:line="10" pos:column="8">letter<pos:position pos:line="10" pos:column="14"/></name></decl>;<pos:position pos:line="10" pos:column="15"/></decl_stmt>   <comment type="block" pos:line="10" pos:column="18">/* used for a silly sscanf */</comment>
  <decl_stmt><decl><type><name pos:line="11" pos:column="3">size_t<pos:position pos:line="11" pos:column="9"/></name></type> <name pos:line="11" pos:column="10">newlen<pos:position pos:line="11" pos:column="16"/></name></decl>;<pos:position pos:line="11" pos:column="17"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="12" pos:column="3">char<pos:position pos:line="12" pos:column="7"/></name> <modifier pos:line="12" pos:column="8">*<pos:position pos:line="12" pos:column="9"/></modifier></type><name pos:line="12" pos:column="9">newest<pos:position pos:line="12" pos:column="15"/></name></decl>;<pos:position pos:line="12" pos:column="16"/></decl_stmt>

  <if pos:line="14" pos:column="3">if <condition pos:line="14" pos:column="6">(<expr><name><name pos:line="14" pos:column="7">data<pos:position pos:line="14" pos:column="11"/></name><operator pos:line="14" pos:column="11">-&gt;<pos:position pos:line="14" pos:column="16"/></operator><name pos:line="14" pos:column="13">set<pos:position pos:line="14" pos:column="16"/></name><operator pos:line="14" pos:column="16">.<pos:position pos:line="14" pos:column="17"/></operator><name pos:line="14" pos:column="17">maxredirs<pos:position pos:line="14" pos:column="26"/></name></name> <operator pos:line="14" pos:column="27">&amp;&amp;<pos:position pos:line="14" pos:column="37"/></operator>
      <operator pos:line="15" pos:column="7">(<pos:position pos:line="15" pos:column="8"/></operator><name><name pos:line="15" pos:column="8">data<pos:position pos:line="15" pos:column="12"/></name><operator pos:line="15" pos:column="12">-&gt;<pos:position pos:line="15" pos:column="17"/></operator><name pos:line="15" pos:column="14">set<pos:position pos:line="15" pos:column="17"/></name><operator pos:line="15" pos:column="17">.<pos:position pos:line="15" pos:column="18"/></operator><name pos:line="15" pos:column="18">followlocation<pos:position pos:line="15" pos:column="32"/></name></name> <operator pos:line="15" pos:column="33">&gt;=<pos:position pos:line="15" pos:column="38"/></operator> <name><name pos:line="15" pos:column="36">data<pos:position pos:line="15" pos:column="40"/></name><operator pos:line="15" pos:column="40">-&gt;<pos:position pos:line="15" pos:column="45"/></operator><name pos:line="15" pos:column="42">set<pos:position pos:line="15" pos:column="45"/></name><operator pos:line="15" pos:column="45">.<pos:position pos:line="15" pos:column="46"/></operator><name pos:line="15" pos:column="46">maxredirs<pos:position pos:line="15" pos:column="55"/></name></name><operator pos:line="15" pos:column="55">)<pos:position pos:line="15" pos:column="56"/></operator></expr>)<pos:position pos:line="15" pos:column="57"/></condition><then pos:line="15" pos:column="57"> <block pos:line="15" pos:column="58">{
    <expr_stmt><expr><call><name pos:line="16" pos:column="5">failf<pos:position pos:line="16" pos:column="10"/></name><argument_list pos:line="16" pos:column="10">(<argument><expr><name pos:line="16" pos:column="11">data<pos:position pos:line="16" pos:column="15"/></name></expr></argument>,<argument><expr><literal type="string" pos:line="16" pos:column="16">"Maximum (%d) redirects followed"<pos:position pos:line="16" pos:column="49"/></literal></expr></argument>, <argument><expr><name><name pos:line="16" pos:column="51">data<pos:position pos:line="16" pos:column="55"/></name><operator pos:line="16" pos:column="55">-&gt;<pos:position pos:line="16" pos:column="60"/></operator><name pos:line="16" pos:column="57">set<pos:position pos:line="16" pos:column="60"/></name><operator pos:line="16" pos:column="60">.<pos:position pos:line="16" pos:column="61"/></operator><name pos:line="16" pos:column="61">maxredirs<pos:position pos:line="16" pos:column="70"/></name></name></expr></argument>)<pos:position pos:line="16" pos:column="71"/></argument_list></call></expr>;<pos:position pos:line="16" pos:column="72"/></expr_stmt>
    <return pos:line="17" pos:column="5">return <expr><name pos:line="17" pos:column="12">CURLE_TOO_MANY_REDIRECTS<pos:position pos:line="17" pos:column="36"/></name></expr>;<pos:position pos:line="17" pos:column="37"/></return>
  }<pos:position pos:line="18" pos:column="4"/></block></then></if>

  <if pos:line="20" pos:column="3">if<condition pos:line="20" pos:column="5">(<expr><operator pos:line="20" pos:column="6">!<pos:position pos:line="20" pos:column="7"/></operator><name pos:line="20" pos:column="7">retry<pos:position pos:line="20" pos:column="12"/></name></expr>)<pos:position pos:line="20" pos:column="13"/></condition><then pos:line="20" pos:column="13">
    <comment type="block" pos:line="21" pos:column="5">/* mark the next request as a followed location: */</comment>
    <block type="pseudo"><expr_stmt><expr><name><name pos:line="22" pos:column="5">data<pos:position pos:line="22" pos:column="9"/></name><operator pos:line="22" pos:column="9">-&gt;<pos:position pos:line="22" pos:column="14"/></operator><name pos:line="22" pos:column="11">state<pos:position pos:line="22" pos:column="16"/></name><operator pos:line="22" pos:column="16">.<pos:position pos:line="22" pos:column="17"/></operator><name pos:line="22" pos:column="17">this_is_a_follow<pos:position pos:line="22" pos:column="33"/></name></name> <operator pos:line="22" pos:column="34">=<pos:position pos:line="22" pos:column="35"/></operator> <name pos:line="22" pos:column="36">TRUE<pos:position pos:line="22" pos:column="40"/></name></expr>;<pos:position pos:line="22" pos:column="41"/></expr_stmt></block></then></if>

  <expr_stmt><expr><name><name pos:line="24" pos:column="3">data<pos:position pos:line="24" pos:column="7"/></name><operator pos:line="24" pos:column="7">-&gt;<pos:position pos:line="24" pos:column="12"/></operator><name pos:line="24" pos:column="9">set<pos:position pos:line="24" pos:column="12"/></name><operator pos:line="24" pos:column="12">.<pos:position pos:line="24" pos:column="13"/></operator><name pos:line="24" pos:column="13">followlocation<pos:position pos:line="24" pos:column="27"/></name></name><operator pos:line="24" pos:column="27">++<pos:position pos:line="24" pos:column="29"/></operator></expr>;<pos:position pos:line="24" pos:column="30"/></expr_stmt> <comment type="block" pos:line="24" pos:column="31">/* count location-followers */</comment>

  <if pos:line="26" pos:column="3">if<condition pos:line="26" pos:column="5">(<expr><name><name pos:line="26" pos:column="6">data<pos:position pos:line="26" pos:column="10"/></name><operator pos:line="26" pos:column="10">-&gt;<pos:position pos:line="26" pos:column="15"/></operator><name pos:line="26" pos:column="12">set<pos:position pos:line="26" pos:column="15"/></name><operator pos:line="26" pos:column="15">.<pos:position pos:line="26" pos:column="16"/></operator><name pos:line="26" pos:column="16">http_auto_referer<pos:position pos:line="26" pos:column="33"/></name></name></expr>)<pos:position pos:line="26" pos:column="34"/></condition><then pos:line="26" pos:column="34"> <block pos:line="26" pos:column="35">{
    <comment type="block" pos:line="27" pos:column="5">/* We are asked to automatically set the previous URL as the
       referer when we get the next URL. We pick the -&gt;url field,
       which may or may not be 100% correct */</comment>

    <if pos:line="31" pos:column="5">if<condition pos:line="31" pos:column="7">(<expr><name><name pos:line="31" pos:column="8">data<pos:position pos:line="31" pos:column="12"/></name><operator pos:line="31" pos:column="12">-&gt;<pos:position pos:line="31" pos:column="17"/></operator><name pos:line="31" pos:column="14">change<pos:position pos:line="31" pos:column="20"/></name><operator pos:line="31" pos:column="20">.<pos:position pos:line="31" pos:column="21"/></operator><name pos:line="31" pos:column="21">referer_alloc<pos:position pos:line="31" pos:column="34"/></name></name></expr>)<pos:position pos:line="31" pos:column="35"/></condition><then pos:line="31" pos:column="35">
      <comment type="block" pos:line="32" pos:column="7">/* If we already have an allocated referer, free this first */</comment>
      <block type="pseudo"><expr_stmt><expr><call><name pos:line="33" pos:column="7">free<pos:position pos:line="33" pos:column="11"/></name><argument_list pos:line="33" pos:column="11">(<argument><expr><name><name pos:line="33" pos:column="12">data<pos:position pos:line="33" pos:column="16"/></name><operator pos:line="33" pos:column="16">-&gt;<pos:position pos:line="33" pos:column="21"/></operator><name pos:line="33" pos:column="18">change<pos:position pos:line="33" pos:column="24"/></name><operator pos:line="33" pos:column="24">.<pos:position pos:line="33" pos:column="25"/></operator><name pos:line="33" pos:column="25">referer<pos:position pos:line="33" pos:column="32"/></name></name></expr></argument>)<pos:position pos:line="33" pos:column="33"/></argument_list></call></expr>;<pos:position pos:line="33" pos:column="34"/></expr_stmt></block></then></if>

    <expr_stmt><expr><name><name pos:line="35" pos:column="5">data<pos:position pos:line="35" pos:column="9"/></name><operator pos:line="35" pos:column="9">-&gt;<pos:position pos:line="35" pos:column="14"/></operator><name pos:line="35" pos:column="11">change<pos:position pos:line="35" pos:column="17"/></name><operator pos:line="35" pos:column="17">.<pos:position pos:line="35" pos:column="18"/></operator><name pos:line="35" pos:column="18">referer<pos:position pos:line="35" pos:column="25"/></name></name> <operator pos:line="35" pos:column="26">=<pos:position pos:line="35" pos:column="27"/></operator> <call><name pos:line="35" pos:column="28">strdup<pos:position pos:line="35" pos:column="34"/></name><argument_list pos:line="35" pos:column="34">(<argument><expr><name><name pos:line="35" pos:column="35">data<pos:position pos:line="35" pos:column="39"/></name><operator pos:line="35" pos:column="39">-&gt;<pos:position pos:line="35" pos:column="44"/></operator><name pos:line="35" pos:column="41">change<pos:position pos:line="35" pos:column="47"/></name><operator pos:line="35" pos:column="47">.<pos:position pos:line="35" pos:column="48"/></operator><name pos:line="35" pos:column="48">url<pos:position pos:line="35" pos:column="51"/></name></name></expr></argument>)<pos:position pos:line="35" pos:column="52"/></argument_list></call></expr>;<pos:position pos:line="35" pos:column="53"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="36" pos:column="5">data<pos:position pos:line="36" pos:column="9"/></name><operator pos:line="36" pos:column="9">-&gt;<pos:position pos:line="36" pos:column="14"/></operator><name pos:line="36" pos:column="11">change<pos:position pos:line="36" pos:column="17"/></name><operator pos:line="36" pos:column="17">.<pos:position pos:line="36" pos:column="18"/></operator><name pos:line="36" pos:column="18">referer_alloc<pos:position pos:line="36" pos:column="31"/></name></name> <operator pos:line="36" pos:column="32">=<pos:position pos:line="36" pos:column="33"/></operator> <name pos:line="36" pos:column="34">TRUE<pos:position pos:line="36" pos:column="38"/></name></expr>;<pos:position pos:line="36" pos:column="39"/></expr_stmt> <comment type="block" pos:line="36" pos:column="40">/* yes, free this later */</comment>
  }<pos:position pos:line="37" pos:column="4"/></block></then></if>

  <if pos:line="39" pos:column="3">if<condition pos:line="39" pos:column="5">(<expr><literal type="number" pos:line="39" pos:column="6">2<pos:position pos:line="39" pos:column="7"/></literal> <operator pos:line="39" pos:column="8">!=<pos:position pos:line="39" pos:column="10"/></operator> <call><name pos:line="39" pos:column="11">sscanf<pos:position pos:line="39" pos:column="17"/></name><argument_list pos:line="39" pos:column="17">(<argument><expr><name pos:line="39" pos:column="18">newurl<pos:position pos:line="39" pos:column="24"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="39" pos:column="26">"%15[^?&amp;/:]://%c"<pos:position pos:line="39" pos:column="47"/></literal></expr></argument>, <argument><expr><name pos:line="39" pos:column="45">prot<pos:position pos:line="39" pos:column="49"/></name></expr></argument>, <argument><expr><operator pos:line="39" pos:column="51">&amp;<pos:position pos:line="39" pos:column="56"/></operator><name pos:line="39" pos:column="52">letter<pos:position pos:line="39" pos:column="58"/></name></expr></argument>)<pos:position pos:line="39" pos:column="59"/></argument_list></call></expr>)<pos:position pos:line="39" pos:column="60"/></condition><then pos:line="39" pos:column="60"> <block pos:line="39" pos:column="61">{
    <comment type="block" format="doxygen" pos:line="40" pos:column="5">/***
     *DANG* this is an RFC 2068 violation. The URL is supposed
     to be absolute and this doesn't seem to be that!
     ***
     Instead, we have to TRY to append this new path to the old URL
     to the right of the host part. Oh crap, this is doomed to cause
     problems in the future...
    */</comment>
    <decl_stmt><decl><type><name pos:line="48" pos:column="5">char<pos:position pos:line="48" pos:column="9"/></name> <modifier pos:line="48" pos:column="10">*<pos:position pos:line="48" pos:column="11"/></modifier></type><name pos:line="48" pos:column="11">protsep<pos:position pos:line="48" pos:column="18"/></name></decl>;<pos:position pos:line="48" pos:column="19"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="49" pos:column="5">char<pos:position pos:line="49" pos:column="9"/></name> <modifier pos:line="49" pos:column="10">*<pos:position pos:line="49" pos:column="11"/></modifier></type><name pos:line="49" pos:column="11">pathsep<pos:position pos:line="49" pos:column="18"/></name></decl>;<pos:position pos:line="49" pos:column="19"/></decl_stmt>

    <decl_stmt><decl><type><name pos:line="51" pos:column="5">char<pos:position pos:line="51" pos:column="9"/></name> <modifier pos:line="51" pos:column="10">*<pos:position pos:line="51" pos:column="11"/></modifier></type><name pos:line="51" pos:column="11">useurl<pos:position pos:line="51" pos:column="17"/></name> <init pos:line="51" pos:column="18">= <expr><name pos:line="51" pos:column="20">newurl<pos:position pos:line="51" pos:column="26"/></name></expr></init></decl>;<pos:position pos:line="51" pos:column="27"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="52" pos:column="5">size_t<pos:position pos:line="52" pos:column="11"/></name></type> <name pos:line="52" pos:column="12">urllen<pos:position pos:line="52" pos:column="18"/></name></decl>;<pos:position pos:line="52" pos:column="19"/></decl_stmt>

    <comment type="block" pos:line="54" pos:column="5">/* we must make our own copy of the URL to play with, as it may
       point to read-only data */</comment>
    <decl_stmt><decl><type><name pos:line="56" pos:column="5">char<pos:position pos:line="56" pos:column="9"/></name> <modifier pos:line="56" pos:column="10">*<pos:position pos:line="56" pos:column="11"/></modifier></type><name pos:line="56" pos:column="11">url_clone<pos:position pos:line="56" pos:column="20"/></name><init pos:line="56" pos:column="20">=<expr><call><name pos:line="56" pos:column="21">strdup<pos:position pos:line="56" pos:column="27"/></name><argument_list pos:line="56" pos:column="27">(<argument><expr><name><name pos:line="56" pos:column="28">data<pos:position pos:line="56" pos:column="32"/></name><operator pos:line="56" pos:column="32">-&gt;<pos:position pos:line="56" pos:column="37"/></operator><name pos:line="56" pos:column="34">change<pos:position pos:line="56" pos:column="40"/></name><operator pos:line="56" pos:column="40">.<pos:position pos:line="56" pos:column="41"/></operator><name pos:line="56" pos:column="41">url<pos:position pos:line="56" pos:column="44"/></name></name></expr></argument>)<pos:position pos:line="56" pos:column="45"/></argument_list></call></expr></init></decl>;<pos:position pos:line="56" pos:column="46"/></decl_stmt>

    <if pos:line="58" pos:column="5">if<condition pos:line="58" pos:column="7">(<expr><operator pos:line="58" pos:column="8">!<pos:position pos:line="58" pos:column="9"/></operator><name pos:line="58" pos:column="9">url_clone<pos:position pos:line="58" pos:column="18"/></name></expr>)<pos:position pos:line="58" pos:column="19"/></condition><then pos:line="58" pos:column="19">
      <block type="pseudo"><return pos:line="59" pos:column="7">return <expr><name pos:line="59" pos:column="14">CURLE_OUT_OF_MEMORY<pos:position pos:line="59" pos:column="33"/></name></expr>;<pos:position pos:line="59" pos:column="34"/></return></block></then></if> <comment type="block" pos:line="59" pos:column="35">/* skip out of this NOW */</comment>

    <comment type="block" pos:line="61" pos:column="5">/* protsep points to the start of the host name */</comment>
    <expr_stmt><expr><name pos:line="62" pos:column="5">protsep<pos:position pos:line="62" pos:column="12"/></name><operator pos:line="62" pos:column="12">=<pos:position pos:line="62" pos:column="13"/></operator><call><name pos:line="62" pos:column="13">strstr<pos:position pos:line="62" pos:column="19"/></name><argument_list pos:line="62" pos:column="19">(<argument><expr><name pos:line="62" pos:column="20">url_clone<pos:position pos:line="62" pos:column="29"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="62" pos:column="31">"//"<pos:position pos:line="62" pos:column="35"/></literal></expr></argument>)<pos:position pos:line="62" pos:column="36"/></argument_list></call></expr>;<pos:position pos:line="62" pos:column="37"/></expr_stmt>
    <if pos:line="63" pos:column="5">if<condition pos:line="63" pos:column="7">(<expr><operator pos:line="63" pos:column="8">!<pos:position pos:line="63" pos:column="9"/></operator><name pos:line="63" pos:column="9">protsep<pos:position pos:line="63" pos:column="16"/></name></expr>)<pos:position pos:line="63" pos:column="17"/></condition><then pos:line="63" pos:column="17">
      <block type="pseudo"><expr_stmt><expr><name pos:line="64" pos:column="7">protsep<pos:position pos:line="64" pos:column="14"/></name><operator pos:line="64" pos:column="14">=<pos:position pos:line="64" pos:column="15"/></operator><name pos:line="64" pos:column="15">url_clone<pos:position pos:line="64" pos:column="24"/></name></expr>;<pos:position pos:line="64" pos:column="25"/></expr_stmt></block></then>
    <else pos:line="65" pos:column="5">else
      <block type="pseudo"><expr_stmt><expr><name pos:line="66" pos:column="7">protsep<pos:position pos:line="66" pos:column="14"/></name><operator pos:line="66" pos:column="14">+=<pos:position pos:line="66" pos:column="16"/></operator><literal type="number" pos:line="66" pos:column="16">2<pos:position pos:line="66" pos:column="17"/></literal></expr>;<pos:position pos:line="66" pos:column="18"/></expr_stmt></block></else></if> <comment type="block" pos:line="66" pos:column="19">/* pass the slashes */</comment>

    <if pos:line="68" pos:column="5">if<condition pos:line="68" pos:column="7">(<expr><literal type="char" pos:line="68" pos:column="8">'/'<pos:position pos:line="68" pos:column="11"/></literal> <operator pos:line="68" pos:column="12">!=<pos:position pos:line="68" pos:column="14"/></operator> <name><name pos:line="68" pos:column="15">newurl<pos:position pos:line="68" pos:column="21"/></name><index pos:line="68" pos:column="21">[<expr><literal type="number" pos:line="68" pos:column="22">0<pos:position pos:line="68" pos:column="23"/></literal></expr>]<pos:position pos:line="68" pos:column="24"/></index></name></expr>)<pos:position pos:line="68" pos:column="25"/></condition><then pos:line="68" pos:column="25"> <block pos:line="68" pos:column="26">{
      <decl_stmt><decl><type><name pos:line="69" pos:column="7">int<pos:position pos:line="69" pos:column="10"/></name></type> <name pos:line="69" pos:column="11">level<pos:position pos:line="69" pos:column="16"/></name><init pos:line="69" pos:column="16">=<expr><literal type="number" pos:line="69" pos:column="17">0<pos:position pos:line="69" pos:column="18"/></literal></expr></init></decl>;<pos:position pos:line="69" pos:column="19"/></decl_stmt>

      <comment type="block" pos:line="71" pos:column="7">/* First we need to find out if there's a ?-letter in the URL,
         and cut it and the right-side of that off */</comment>
      <expr_stmt><expr><name pos:line="73" pos:column="7">pathsep<pos:position pos:line="73" pos:column="14"/></name> <operator pos:line="73" pos:column="15">=<pos:position pos:line="73" pos:column="16"/></operator> <call><name pos:line="73" pos:column="17">strrchr<pos:position pos:line="73" pos:column="24"/></name><argument_list pos:line="73" pos:column="24">(<argument><expr><name pos:line="73" pos:column="25">protsep<pos:position pos:line="73" pos:column="32"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="73" pos:column="34">'?'<pos:position pos:line="73" pos:column="37"/></literal></expr></argument>)<pos:position pos:line="73" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="73" pos:column="39"/></expr_stmt>
      <if pos:line="74" pos:column="7">if<condition pos:line="74" pos:column="9">(<expr><name pos:line="74" pos:column="10">pathsep<pos:position pos:line="74" pos:column="17"/></name></expr>)<pos:position pos:line="74" pos:column="18"/></condition><then pos:line="74" pos:column="18">
        <block type="pseudo"><expr_stmt><expr><operator pos:line="75" pos:column="9">*<pos:position pos:line="75" pos:column="10"/></operator><name pos:line="75" pos:column="10">pathsep<pos:position pos:line="75" pos:column="17"/></name><operator pos:line="75" pos:column="17">=<pos:position pos:line="75" pos:column="18"/></operator><literal type="number" pos:line="75" pos:column="18">0<pos:position pos:line="75" pos:column="19"/></literal></expr>;<pos:position pos:line="75" pos:column="20"/></expr_stmt></block></then></if>

      <comment type="block" pos:line="77" pos:column="7">/* we have a relative path to append to the last slash if
         there's one available */</comment>
      <expr_stmt><expr><name pos:line="79" pos:column="7">pathsep<pos:position pos:line="79" pos:column="14"/></name> <operator pos:line="79" pos:column="15">=<pos:position pos:line="79" pos:column="16"/></operator> <call><name pos:line="79" pos:column="17">strrchr<pos:position pos:line="79" pos:column="24"/></name><argument_list pos:line="79" pos:column="24">(<argument><expr><name pos:line="79" pos:column="25">protsep<pos:position pos:line="79" pos:column="32"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="79" pos:column="34">'/'<pos:position pos:line="79" pos:column="37"/></literal></expr></argument>)<pos:position pos:line="79" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="79" pos:column="39"/></expr_stmt>
      <if pos:line="80" pos:column="7">if<condition pos:line="80" pos:column="9">(<expr><name pos:line="80" pos:column="10">pathsep<pos:position pos:line="80" pos:column="17"/></name></expr>)<pos:position pos:line="80" pos:column="18"/></condition><then pos:line="80" pos:column="18">
        <block type="pseudo"><expr_stmt><expr><operator pos:line="81" pos:column="9">*<pos:position pos:line="81" pos:column="10"/></operator><name pos:line="81" pos:column="10">pathsep<pos:position pos:line="81" pos:column="17"/></name><operator pos:line="81" pos:column="17">=<pos:position pos:line="81" pos:column="18"/></operator><literal type="number" pos:line="81" pos:column="18">0<pos:position pos:line="81" pos:column="19"/></literal></expr>;<pos:position pos:line="81" pos:column="20"/></expr_stmt></block></then></if>

      <comment type="block" pos:line="83" pos:column="7">/* Check if there's any slash after the host name, and if so,
         remember that position instead */</comment>
      <expr_stmt><expr><name pos:line="85" pos:column="7">pathsep<pos:position pos:line="85" pos:column="14"/></name> <operator pos:line="85" pos:column="15">=<pos:position pos:line="85" pos:column="16"/></operator> <call><name pos:line="85" pos:column="17">strchr<pos:position pos:line="85" pos:column="23"/></name><argument_list pos:line="85" pos:column="23">(<argument><expr><name pos:line="85" pos:column="24">protsep<pos:position pos:line="85" pos:column="31"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="85" pos:column="33">'/'<pos:position pos:line="85" pos:column="36"/></literal></expr></argument>)<pos:position pos:line="85" pos:column="37"/></argument_list></call></expr>;<pos:position pos:line="85" pos:column="38"/></expr_stmt>
      <if pos:line="86" pos:column="7">if<condition pos:line="86" pos:column="9">(<expr><name pos:line="86" pos:column="10">pathsep<pos:position pos:line="86" pos:column="17"/></name></expr>)<pos:position pos:line="86" pos:column="18"/></condition><then pos:line="86" pos:column="18">
        <block type="pseudo"><expr_stmt><expr><name pos:line="87" pos:column="9">protsep<pos:position pos:line="87" pos:column="16"/></name> <operator pos:line="87" pos:column="17">=<pos:position pos:line="87" pos:column="18"/></operator> <name pos:line="87" pos:column="19">pathsep<pos:position pos:line="87" pos:column="26"/></name><operator pos:line="87" pos:column="26">+<pos:position pos:line="87" pos:column="27"/></operator><literal type="number" pos:line="87" pos:column="27">1<pos:position pos:line="87" pos:column="28"/></literal></expr>;<pos:position pos:line="87" pos:column="29"/></expr_stmt></block></then>
      <else pos:line="88" pos:column="7">else
        <block type="pseudo"><expr_stmt><expr><name pos:line="89" pos:column="9">protsep<pos:position pos:line="89" pos:column="16"/></name> <operator pos:line="89" pos:column="17">=<pos:position pos:line="89" pos:column="18"/></operator> <name pos:line="89" pos:column="19">NULL<pos:position pos:line="89" pos:column="23"/></name></expr>;<pos:position pos:line="89" pos:column="24"/></expr_stmt></block></else></if>

      <comment type="block" pos:line="91" pos:column="7">/* now deal with one "./" or any amount of "../" in the newurl
         and act accordingly */</comment>

      <if pos:line="94" pos:column="7">if<condition pos:line="94" pos:column="9">(<expr><operator pos:line="94" pos:column="10">(<pos:position pos:line="94" pos:column="11"/></operator><name><name pos:line="94" pos:column="11">useurl<pos:position pos:line="94" pos:column="17"/></name><index pos:line="94" pos:column="17">[<expr><literal type="number" pos:line="94" pos:column="18">0<pos:position pos:line="94" pos:column="19"/></literal></expr>]<pos:position pos:line="94" pos:column="20"/></index></name> <operator pos:line="94" pos:column="21">==<pos:position pos:line="94" pos:column="23"/></operator> <literal type="char" pos:line="94" pos:column="24">'.'<pos:position pos:line="94" pos:column="27"/></literal><operator pos:line="94" pos:column="27">)<pos:position pos:line="94" pos:column="28"/></operator> <operator pos:line="94" pos:column="29">&amp;&amp;<pos:position pos:line="94" pos:column="39"/></operator> <operator pos:line="94" pos:column="32">(<pos:position pos:line="94" pos:column="33"/></operator><name><name pos:line="94" pos:column="33">useurl<pos:position pos:line="94" pos:column="39"/></name><index pos:line="94" pos:column="39">[<expr><literal type="number" pos:line="94" pos:column="40">1<pos:position pos:line="94" pos:column="41"/></literal></expr>]<pos:position pos:line="94" pos:column="42"/></index></name> <operator pos:line="94" pos:column="43">==<pos:position pos:line="94" pos:column="45"/></operator> <literal type="char" pos:line="94" pos:column="46">'/'<pos:position pos:line="94" pos:column="49"/></literal><operator pos:line="94" pos:column="49">)<pos:position pos:line="94" pos:column="50"/></operator></expr>)<pos:position pos:line="94" pos:column="51"/></condition><then pos:line="94" pos:column="51">
        <block type="pseudo"><expr_stmt><expr><name pos:line="95" pos:column="9">useurl<pos:position pos:line="95" pos:column="15"/></name><operator pos:line="95" pos:column="15">+=<pos:position pos:line="95" pos:column="17"/></operator><literal type="number" pos:line="95" pos:column="17">2<pos:position pos:line="95" pos:column="18"/></literal></expr>;<pos:position pos:line="95" pos:column="19"/></expr_stmt></block></then></if> <comment type="block" pos:line="95" pos:column="20">/* just skip the "./" */</comment>

      <while pos:line="97" pos:column="7">while<condition pos:line="97" pos:column="12">(<expr><operator pos:line="97" pos:column="13">(<pos:position pos:line="97" pos:column="14"/></operator><name><name pos:line="97" pos:column="14">useurl<pos:position pos:line="97" pos:column="20"/></name><index pos:line="97" pos:column="20">[<expr><literal type="number" pos:line="97" pos:column="21">0<pos:position pos:line="97" pos:column="22"/></literal></expr>]<pos:position pos:line="97" pos:column="23"/></index></name> <operator pos:line="97" pos:column="24">==<pos:position pos:line="97" pos:column="26"/></operator> <literal type="char" pos:line="97" pos:column="27">'.'<pos:position pos:line="97" pos:column="30"/></literal><operator pos:line="97" pos:column="30">)<pos:position pos:line="97" pos:column="31"/></operator> <operator pos:line="97" pos:column="32">&amp;&amp;<pos:position pos:line="97" pos:column="42"/></operator>
            <operator pos:line="98" pos:column="13">(<pos:position pos:line="98" pos:column="14"/></operator><name><name pos:line="98" pos:column="14">useurl<pos:position pos:line="98" pos:column="20"/></name><index pos:line="98" pos:column="20">[<expr><literal type="number" pos:line="98" pos:column="21">1<pos:position pos:line="98" pos:column="22"/></literal></expr>]<pos:position pos:line="98" pos:column="23"/></index></name> <operator pos:line="98" pos:column="24">==<pos:position pos:line="98" pos:column="26"/></operator> <literal type="char" pos:line="98" pos:column="27">'.'<pos:position pos:line="98" pos:column="30"/></literal><operator pos:line="98" pos:column="30">)<pos:position pos:line="98" pos:column="31"/></operator> <operator pos:line="98" pos:column="32">&amp;&amp;<pos:position pos:line="98" pos:column="42"/></operator>
            <operator pos:line="99" pos:column="13">(<pos:position pos:line="99" pos:column="14"/></operator><name><name pos:line="99" pos:column="14">useurl<pos:position pos:line="99" pos:column="20"/></name><index pos:line="99" pos:column="20">[<expr><literal type="number" pos:line="99" pos:column="21">2<pos:position pos:line="99" pos:column="22"/></literal></expr>]<pos:position pos:line="99" pos:column="23"/></index></name> <operator pos:line="99" pos:column="24">==<pos:position pos:line="99" pos:column="26"/></operator> <literal type="char" pos:line="99" pos:column="27">'/'<pos:position pos:line="99" pos:column="30"/></literal><operator pos:line="99" pos:column="30">)<pos:position pos:line="99" pos:column="31"/></operator></expr>)<pos:position pos:line="99" pos:column="32"/></condition> <block pos:line="99" pos:column="33">{
        <expr_stmt><expr><name pos:line="100" pos:column="9">level<pos:position pos:line="100" pos:column="14"/></name><operator pos:line="100" pos:column="14">++<pos:position pos:line="100" pos:column="16"/></operator></expr>;<pos:position pos:line="100" pos:column="17"/></expr_stmt>
        <expr_stmt><expr><name pos:line="101" pos:column="9">useurl<pos:position pos:line="101" pos:column="15"/></name><operator pos:line="101" pos:column="15">+=<pos:position pos:line="101" pos:column="17"/></operator><literal type="number" pos:line="101" pos:column="17">3<pos:position pos:line="101" pos:column="18"/></literal></expr>;<pos:position pos:line="101" pos:column="19"/></expr_stmt> <comment type="block" pos:line="101" pos:column="20">/* pass the "../" */</comment>
      }<pos:position pos:line="102" pos:column="8"/></block></while>

      <if pos:line="104" pos:column="7">if<condition pos:line="104" pos:column="9">(<expr><name pos:line="104" pos:column="10">protsep<pos:position pos:line="104" pos:column="17"/></name></expr>)<pos:position pos:line="104" pos:column="18"/></condition><then pos:line="104" pos:column="18"> <block pos:line="104" pos:column="19">{
        <while pos:line="105" pos:column="9">while<condition pos:line="105" pos:column="14">(<expr><name pos:line="105" pos:column="15">level<pos:position pos:line="105" pos:column="20"/></name><operator pos:line="105" pos:column="20">--<pos:position pos:line="105" pos:column="22"/></operator></expr>)<pos:position pos:line="105" pos:column="23"/></condition> <block pos:line="105" pos:column="24">{
          <comment type="block" pos:line="106" pos:column="11">/* cut off one more level from the right of the original URL */</comment>
          <expr_stmt><expr><name pos:line="107" pos:column="11">pathsep<pos:position pos:line="107" pos:column="18"/></name> <operator pos:line="107" pos:column="19">=<pos:position pos:line="107" pos:column="20"/></operator> <call><name pos:line="107" pos:column="21">strrchr<pos:position pos:line="107" pos:column="28"/></name><argument_list pos:line="107" pos:column="28">(<argument><expr><name pos:line="107" pos:column="29">protsep<pos:position pos:line="107" pos:column="36"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="107" pos:column="38">'/'<pos:position pos:line="107" pos:column="41"/></literal></expr></argument>)<pos:position pos:line="107" pos:column="42"/></argument_list></call></expr>;<pos:position pos:line="107" pos:column="43"/></expr_stmt>
          <if pos:line="108" pos:column="11">if<condition pos:line="108" pos:column="13">(<expr><name pos:line="108" pos:column="14">pathsep<pos:position pos:line="108" pos:column="21"/></name></expr>)<pos:position pos:line="108" pos:column="22"/></condition><then pos:line="108" pos:column="22">
            <block type="pseudo"><expr_stmt><expr><operator pos:line="109" pos:column="13">*<pos:position pos:line="109" pos:column="14"/></operator><name pos:line="109" pos:column="14">pathsep<pos:position pos:line="109" pos:column="21"/></name><operator pos:line="109" pos:column="21">=<pos:position pos:line="109" pos:column="22"/></operator><literal type="number" pos:line="109" pos:column="22">0<pos:position pos:line="109" pos:column="23"/></literal></expr>;<pos:position pos:line="109" pos:column="24"/></expr_stmt></block></then>
          <else pos:line="110" pos:column="11">else <block pos:line="110" pos:column="16">{
            <expr_stmt><expr><operator pos:line="111" pos:column="13">*<pos:position pos:line="111" pos:column="14"/></operator><name pos:line="111" pos:column="14">protsep<pos:position pos:line="111" pos:column="21"/></name><operator pos:line="111" pos:column="21">=<pos:position pos:line="111" pos:column="22"/></operator><literal type="number" pos:line="111" pos:column="22">0<pos:position pos:line="111" pos:column="23"/></literal></expr>;<pos:position pos:line="111" pos:column="24"/></expr_stmt>
            <break pos:line="112" pos:column="13">break;<pos:position pos:line="112" pos:column="19"/></break>
          }<pos:position pos:line="113" pos:column="12"/></block></else></if>
        }<pos:position pos:line="114" pos:column="10"/></block></while>
      }<pos:position pos:line="115" pos:column="8"/></block></then></if>
    }<pos:position pos:line="116" pos:column="6"/></block></then>
    <else pos:line="117" pos:column="5">else <block pos:line="117" pos:column="10">{
      <comment type="block" pos:line="118" pos:column="7">/* We got a new absolute path for this server, cut off from the
         first slash */</comment>
      <expr_stmt><expr><name pos:line="120" pos:column="7">pathsep<pos:position pos:line="120" pos:column="14"/></name> <operator pos:line="120" pos:column="15">=<pos:position pos:line="120" pos:column="16"/></operator> <call><name pos:line="120" pos:column="17">strchr<pos:position pos:line="120" pos:column="23"/></name><argument_list pos:line="120" pos:column="23">(<argument><expr><name pos:line="120" pos:column="24">protsep<pos:position pos:line="120" pos:column="31"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="120" pos:column="33">'/'<pos:position pos:line="120" pos:column="36"/></literal></expr></argument>)<pos:position pos:line="120" pos:column="37"/></argument_list></call></expr>;<pos:position pos:line="120" pos:column="38"/></expr_stmt>
      <if pos:line="121" pos:column="7">if<condition pos:line="121" pos:column="9">(<expr><name pos:line="121" pos:column="10">pathsep<pos:position pos:line="121" pos:column="17"/></name></expr>)<pos:position pos:line="121" pos:column="18"/></condition><then pos:line="121" pos:column="18"> <block pos:line="121" pos:column="19">{
        <comment type="block" pos:line="122" pos:column="9">/* When people use badly formatted URLs, such as
           "http://www.url.com?dir=/home/daniel" we must not use the first
           slash, if there's a ?-letter before it! */</comment>
        <decl_stmt><decl><type><name pos:line="125" pos:column="9">char<pos:position pos:line="125" pos:column="13"/></name> <modifier pos:line="125" pos:column="14">*<pos:position pos:line="125" pos:column="15"/></modifier></type><name pos:line="125" pos:column="15">sep<pos:position pos:line="125" pos:column="18"/></name> <init pos:line="125" pos:column="19">= <expr><call><name pos:line="125" pos:column="21">strchr<pos:position pos:line="125" pos:column="27"/></name><argument_list pos:line="125" pos:column="27">(<argument><expr><name pos:line="125" pos:column="28">protsep<pos:position pos:line="125" pos:column="35"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="125" pos:column="37">'?'<pos:position pos:line="125" pos:column="40"/></literal></expr></argument>)<pos:position pos:line="125" pos:column="41"/></argument_list></call></expr></init></decl>;<pos:position pos:line="125" pos:column="42"/></decl_stmt>
        <if pos:line="126" pos:column="9">if<condition pos:line="126" pos:column="11">(<expr><name pos:line="126" pos:column="12">sep<pos:position pos:line="126" pos:column="15"/></name> <operator pos:line="126" pos:column="16">&amp;&amp;<pos:position pos:line="126" pos:column="26"/></operator> <operator pos:line="126" pos:column="19">(<pos:position pos:line="126" pos:column="20"/></operator><name pos:line="126" pos:column="20">sep<pos:position pos:line="126" pos:column="23"/></name> <operator pos:line="126" pos:column="24">&lt;<pos:position pos:line="126" pos:column="28"/></operator> <name pos:line="126" pos:column="26">pathsep<pos:position pos:line="126" pos:column="33"/></name><operator pos:line="126" pos:column="33">)<pos:position pos:line="126" pos:column="34"/></operator></expr>)<pos:position pos:line="126" pos:column="35"/></condition><then pos:line="126" pos:column="35">
          <block type="pseudo"><expr_stmt><expr><name pos:line="127" pos:column="11">pathsep<pos:position pos:line="127" pos:column="18"/></name> <operator pos:line="127" pos:column="19">=<pos:position pos:line="127" pos:column="20"/></operator> <name pos:line="127" pos:column="21">sep<pos:position pos:line="127" pos:column="24"/></name></expr>;<pos:position pos:line="127" pos:column="25"/></expr_stmt></block></then></if>
        <expr_stmt><expr><operator pos:line="128" pos:column="9">*<pos:position pos:line="128" pos:column="10"/></operator><name pos:line="128" pos:column="10">pathsep<pos:position pos:line="128" pos:column="17"/></name><operator pos:line="128" pos:column="17">=<pos:position pos:line="128" pos:column="18"/></operator><literal type="number" pos:line="128" pos:column="18">0<pos:position pos:line="128" pos:column="19"/></literal></expr>;<pos:position pos:line="128" pos:column="20"/></expr_stmt>
      }<pos:position pos:line="129" pos:column="8"/></block></then>
      <else pos:line="130" pos:column="7">else <block pos:line="130" pos:column="12">{
        <comment type="block" pos:line="131" pos:column="9">/* There was no slash. Now, since we might be operating on a badly
           formatted URL, such as "http://www.url.com?id=2380" which doesn't
           use a slash separator as it is supposed to, we need to check for a
           ?-letter as well! */</comment>
        <expr_stmt><expr><name pos:line="135" pos:column="9">pathsep<pos:position pos:line="135" pos:column="16"/></name> <operator pos:line="135" pos:column="17">=<pos:position pos:line="135" pos:column="18"/></operator> <call><name pos:line="135" pos:column="19">strchr<pos:position pos:line="135" pos:column="25"/></name><argument_list pos:line="135" pos:column="25">(<argument><expr><name pos:line="135" pos:column="26">protsep<pos:position pos:line="135" pos:column="33"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="135" pos:column="35">'?'<pos:position pos:line="135" pos:column="38"/></literal></expr></argument>)<pos:position pos:line="135" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="135" pos:column="40"/></expr_stmt>
        <if pos:line="136" pos:column="9">if<condition pos:line="136" pos:column="11">(<expr><name pos:line="136" pos:column="12">pathsep<pos:position pos:line="136" pos:column="19"/></name></expr>)<pos:position pos:line="136" pos:column="20"/></condition><then pos:line="136" pos:column="20">
          <block type="pseudo"><expr_stmt><expr><operator pos:line="137" pos:column="11">*<pos:position pos:line="137" pos:column="12"/></operator><name pos:line="137" pos:column="12">pathsep<pos:position pos:line="137" pos:column="19"/></name><operator pos:line="137" pos:column="19">=<pos:position pos:line="137" pos:column="20"/></operator><literal type="number" pos:line="137" pos:column="20">0<pos:position pos:line="137" pos:column="21"/></literal></expr>;<pos:position pos:line="137" pos:column="22"/></expr_stmt></block></then></if>
      }<pos:position pos:line="138" pos:column="8"/></block></else></if>
    }<pos:position pos:line="139" pos:column="6"/></block></else></if>

    <comment type="block" pos:line="141" pos:column="5">/* If the new part contains a space, this is a mighty stupid redirect
       but we still make an effort to do "right". To the left of a '?'
       letter we replace each space with %20 while it is replaced with '+'
       on the right side of the '?' letter.
    */</comment>
    <expr_stmt><expr><name pos:line="146" pos:column="5">newlen<pos:position pos:line="146" pos:column="11"/></name> <operator pos:line="146" pos:column="12">=<pos:position pos:line="146" pos:column="13"/></operator> <call><name pos:line="146" pos:column="14">strlen_url<pos:position pos:line="146" pos:column="24"/></name><argument_list pos:line="146" pos:column="24">(<argument><expr><name pos:line="146" pos:column="25">useurl<pos:position pos:line="146" pos:column="31"/></name></expr></argument>)<pos:position pos:line="146" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="146" pos:column="33"/></expr_stmt>

    <expr_stmt><expr><name pos:line="148" pos:column="5">urllen<pos:position pos:line="148" pos:column="11"/></name> <operator pos:line="148" pos:column="12">=<pos:position pos:line="148" pos:column="13"/></operator> <call><name pos:line="148" pos:column="14">strlen<pos:position pos:line="148" pos:column="20"/></name><argument_list pos:line="148" pos:column="20">(<argument><expr><name pos:line="148" pos:column="21">url_clone<pos:position pos:line="148" pos:column="30"/></name></expr></argument>)<pos:position pos:line="148" pos:column="31"/></argument_list></call></expr>;<pos:position pos:line="148" pos:column="32"/></expr_stmt>

    <expr_stmt><expr><name pos:line="150" pos:column="5">newest<pos:position pos:line="150" pos:column="11"/></name><operator pos:line="150" pos:column="11">=<pos:position pos:line="150" pos:column="12"/></operator><operator pos:line="150" pos:column="12">(<pos:position pos:line="150" pos:column="13"/></operator><name pos:line="150" pos:column="13">char<pos:position pos:line="150" pos:column="17"/></name> <operator pos:line="150" pos:column="18">*<pos:position pos:line="150" pos:column="19"/></operator><operator pos:line="150" pos:column="19">)<pos:position pos:line="150" pos:column="20"/></operator><call><name pos:line="150" pos:column="20">malloc<pos:position pos:line="150" pos:column="26"/></name><argument_list pos:line="150" pos:column="26">( <argument><expr><name pos:line="150" pos:column="28">urllen<pos:position pos:line="150" pos:column="34"/></name> <operator pos:line="150" pos:column="35">+<pos:position pos:line="150" pos:column="36"/></operator> <literal type="number" pos:line="150" pos:column="37">1<pos:position pos:line="150" pos:column="38"/></literal> <operator pos:line="150" pos:column="39">+<pos:position pos:line="150" pos:column="40"/></operator> <comment type="block" pos:line="150" pos:column="41">/* possible slash */</comment>
                           <name pos:line="151" pos:column="28">newlen<pos:position pos:line="151" pos:column="34"/></name> <operator pos:line="151" pos:column="35">+<pos:position pos:line="151" pos:column="36"/></operator> <literal type="number" pos:line="151" pos:column="37">1<pos:position pos:line="151" pos:column="38"/></literal></expr></argument> <comment type="block" pos:line="151" pos:column="39">/* zero byte */</comment>)<pos:position pos:line="151" pos:column="55"/></argument_list></call></expr>;<pos:position pos:line="151" pos:column="56"/></expr_stmt>

    <if pos:line="153" pos:column="5">if<condition pos:line="153" pos:column="7">(<expr><operator pos:line="153" pos:column="8">!<pos:position pos:line="153" pos:column="9"/></operator><name pos:line="153" pos:column="9">newest<pos:position pos:line="153" pos:column="15"/></name></expr>)<pos:position pos:line="153" pos:column="16"/></condition><then pos:line="153" pos:column="16"> <block pos:line="153" pos:column="17">{
      <expr_stmt><expr><call><name pos:line="154" pos:column="7">free<pos:position pos:line="154" pos:column="11"/></name><argument_list pos:line="154" pos:column="11">(<argument><expr><name pos:line="154" pos:column="12">url_clone<pos:position pos:line="154" pos:column="21"/></name></expr></argument>)<pos:position pos:line="154" pos:column="22"/></argument_list></call></expr>;<pos:position pos:line="154" pos:column="23"/></expr_stmt> <comment type="block" pos:line="154" pos:column="24">/* don't leak this */</comment>
      <return pos:line="155" pos:column="7">return <expr><name pos:line="155" pos:column="14">CURLE_OUT_OF_MEMORY<pos:position pos:line="155" pos:column="33"/></name></expr>;<pos:position pos:line="155" pos:column="34"/></return> <comment type="block" pos:line="155" pos:column="35">/* go out from this */</comment>
    }<pos:position pos:line="156" pos:column="6"/></block></then></if>

    <comment type="block" pos:line="158" pos:column="5">/* copy over the root url part */</comment>
    <expr_stmt><expr><call><name pos:line="159" pos:column="5">memcpy<pos:position pos:line="159" pos:column="11"/></name><argument_list pos:line="159" pos:column="11">(<argument><expr><name pos:line="159" pos:column="12">newest<pos:position pos:line="159" pos:column="18"/></name></expr></argument>, <argument><expr><name pos:line="159" pos:column="20">url_clone<pos:position pos:line="159" pos:column="29"/></name></expr></argument>, <argument><expr><name pos:line="159" pos:column="31">urllen<pos:position pos:line="159" pos:column="37"/></name></expr></argument>)<pos:position pos:line="159" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="159" pos:column="39"/></expr_stmt>

    <comment type="block" pos:line="161" pos:column="5">/* check if we need to append a slash */</comment>
    <if pos:line="162" pos:column="5">if<condition pos:line="162" pos:column="7">(<expr><operator pos:line="162" pos:column="8">(<pos:position pos:line="162" pos:column="9"/></operator><literal type="char" pos:line="162" pos:column="9">'/'<pos:position pos:line="162" pos:column="12"/></literal> <operator pos:line="162" pos:column="13">==<pos:position pos:line="162" pos:column="15"/></operator> <name><name pos:line="162" pos:column="16">useurl<pos:position pos:line="162" pos:column="22"/></name><index pos:line="162" pos:column="22">[<expr><literal type="number" pos:line="162" pos:column="23">0<pos:position pos:line="162" pos:column="24"/></literal></expr>]<pos:position pos:line="162" pos:column="25"/></index></name><operator pos:line="162" pos:column="25">)<pos:position pos:line="162" pos:column="26"/></operator> <operator pos:line="162" pos:column="27">||<pos:position pos:line="162" pos:column="29"/></operator> <operator pos:line="162" pos:column="30">(<pos:position pos:line="162" pos:column="31"/></operator><name pos:line="162" pos:column="31">protsep<pos:position pos:line="162" pos:column="38"/></name> <operator pos:line="162" pos:column="39">&amp;&amp;<pos:position pos:line="162" pos:column="49"/></operator> <operator pos:line="162" pos:column="42">!<pos:position pos:line="162" pos:column="43"/></operator><operator pos:line="162" pos:column="43">*<pos:position pos:line="162" pos:column="44"/></operator><name pos:line="162" pos:column="44">protsep<pos:position pos:line="162" pos:column="51"/></name><operator pos:line="162" pos:column="51">)<pos:position pos:line="162" pos:column="52"/></operator></expr>)<pos:position pos:line="162" pos:column="53"/></condition><then pos:line="162" pos:column="53">
      <block type="pseudo"><empty_stmt pos:line="163" pos:column="7">;<pos:position pos:line="163" pos:column="8"/></empty_stmt></block></then>
    <else pos:line="164" pos:column="5">else
      <block type="pseudo"><expr_stmt><expr><name><name pos:line="165" pos:column="7">newest<pos:position pos:line="165" pos:column="13"/></name><index pos:line="165" pos:column="13">[<expr><name pos:line="165" pos:column="14">urllen<pos:position pos:line="165" pos:column="20"/></name><operator pos:line="165" pos:column="20">++<pos:position pos:line="165" pos:column="22"/></operator></expr>]<pos:position pos:line="165" pos:column="23"/></index></name><operator pos:line="165" pos:column="23">=<pos:position pos:line="165" pos:column="24"/></operator><literal type="char" pos:line="165" pos:column="24">'/'<pos:position pos:line="165" pos:column="27"/></literal></expr>;<pos:position pos:line="165" pos:column="28"/></expr_stmt></block></else></if>

    <comment type="block" pos:line="167" pos:column="5">/* then append the new piece on the right side */</comment>
    <expr_stmt><expr><call><name pos:line="168" pos:column="5">strcpy_url<pos:position pos:line="168" pos:column="15"/></name><argument_list pos:line="168" pos:column="15">(<argument><expr><operator pos:line="168" pos:column="16">&amp;<pos:position pos:line="168" pos:column="21"/></operator><name><name pos:line="168" pos:column="17">newest<pos:position pos:line="168" pos:column="23"/></name><index pos:line="168" pos:column="23">[<expr><name pos:line="168" pos:column="24">urllen<pos:position pos:line="168" pos:column="30"/></name></expr>]<pos:position pos:line="168" pos:column="31"/></index></name></expr></argument>, <argument><expr><name pos:line="168" pos:column="33">useurl<pos:position pos:line="168" pos:column="39"/></name></expr></argument>)<pos:position pos:line="168" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="168" pos:column="41"/></expr_stmt>

    <expr_stmt><expr><call><name pos:line="170" pos:column="5">free<pos:position pos:line="170" pos:column="9"/></name><argument_list pos:line="170" pos:column="9">(<argument><expr><name pos:line="170" pos:column="10">newurl<pos:position pos:line="170" pos:column="16"/></name></expr></argument>)<pos:position pos:line="170" pos:column="17"/></argument_list></call></expr>;<pos:position pos:line="170" pos:column="18"/></expr_stmt> <comment type="block" pos:line="170" pos:column="19">/* newurl is the allocated pointer */</comment>
    <expr_stmt><expr><call><name pos:line="171" pos:column="5">free<pos:position pos:line="171" pos:column="9"/></name><argument_list pos:line="171" pos:column="9">(<argument><expr><name pos:line="171" pos:column="10">url_clone<pos:position pos:line="171" pos:column="19"/></name></expr></argument>)<pos:position pos:line="171" pos:column="20"/></argument_list></call></expr>;<pos:position pos:line="171" pos:column="21"/></expr_stmt>
    <expr_stmt><expr><name pos:line="172" pos:column="5">newurl<pos:position pos:line="172" pos:column="11"/></name> <operator pos:line="172" pos:column="12">=<pos:position pos:line="172" pos:column="13"/></operator> <name pos:line="172" pos:column="14">newest<pos:position pos:line="172" pos:column="20"/></name></expr>;<pos:position pos:line="172" pos:column="21"/></expr_stmt>
  }<pos:position pos:line="173" pos:column="4"/></block></then>
  <else pos:line="174" pos:column="3">else <block pos:line="174" pos:column="8">{
    <comment type="block" pos:line="175" pos:column="5">/* This is an absolute URL, don't allow the custom port number */</comment>
    <expr_stmt><expr><name><name pos:line="176" pos:column="5">data<pos:position pos:line="176" pos:column="9"/></name><operator pos:line="176" pos:column="9">-&gt;<pos:position pos:line="176" pos:column="14"/></operator><name pos:line="176" pos:column="11">state<pos:position pos:line="176" pos:column="16"/></name><operator pos:line="176" pos:column="16">.<pos:position pos:line="176" pos:column="17"/></operator><name pos:line="176" pos:column="17">allow_port<pos:position pos:line="176" pos:column="27"/></name></name> <operator pos:line="176" pos:column="28">=<pos:position pos:line="176" pos:column="29"/></operator> <name pos:line="176" pos:column="30">FALSE<pos:position pos:line="176" pos:column="35"/></name></expr>;<pos:position pos:line="176" pos:column="36"/></expr_stmt>

    <if pos:line="178" pos:column="5">if<condition pos:line="178" pos:column="7">(<expr><call><name pos:line="178" pos:column="8">strchr<pos:position pos:line="178" pos:column="14"/></name><argument_list pos:line="178" pos:column="14">(<argument><expr><name pos:line="178" pos:column="15">newurl<pos:position pos:line="178" pos:column="21"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="178" pos:column="23">' '<pos:position pos:line="178" pos:column="26"/></literal></expr></argument>)<pos:position pos:line="178" pos:column="27"/></argument_list></call></expr>)<pos:position pos:line="178" pos:column="28"/></condition><then pos:line="178" pos:column="28"> <block pos:line="178" pos:column="29">{
      <comment type="block" pos:line="179" pos:column="7">/* This new URL contains at least one space, this is a mighty stupid
         redirect but we still make an effort to do "right". */</comment>
      <expr_stmt><expr><name pos:line="181" pos:column="7">newlen<pos:position pos:line="181" pos:column="13"/></name> <operator pos:line="181" pos:column="14">=<pos:position pos:line="181" pos:column="15"/></operator> <call><name pos:line="181" pos:column="16">strlen_url<pos:position pos:line="181" pos:column="26"/></name><argument_list pos:line="181" pos:column="26">(<argument><expr><name pos:line="181" pos:column="27">newurl<pos:position pos:line="181" pos:column="33"/></name></expr></argument>)<pos:position pos:line="181" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="181" pos:column="35"/></expr_stmt>

      <expr_stmt><expr><name pos:line="183" pos:column="7">newest<pos:position pos:line="183" pos:column="13"/></name> <operator pos:line="183" pos:column="14">=<pos:position pos:line="183" pos:column="15"/></operator> <call><name pos:line="183" pos:column="16">malloc<pos:position pos:line="183" pos:column="22"/></name><argument_list pos:line="183" pos:column="22">(<argument><expr><name pos:line="183" pos:column="23">newlen<pos:position pos:line="183" pos:column="29"/></name><operator pos:line="183" pos:column="29">+<pos:position pos:line="183" pos:column="30"/></operator><literal type="number" pos:line="183" pos:column="30">1<pos:position pos:line="183" pos:column="31"/></literal></expr></argument>)<pos:position pos:line="183" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="183" pos:column="33"/></expr_stmt> <comment type="block" pos:line="183" pos:column="34">/* get memory for this */</comment>
      <if pos:line="184" pos:column="7">if<condition pos:line="184" pos:column="9">(<expr><name pos:line="184" pos:column="10">newest<pos:position pos:line="184" pos:column="16"/></name></expr>)<pos:position pos:line="184" pos:column="17"/></condition><then pos:line="184" pos:column="17"> <block pos:line="184" pos:column="18">{
        <expr_stmt><expr><call><name pos:line="185" pos:column="9">strcpy_url<pos:position pos:line="185" pos:column="19"/></name><argument_list pos:line="185" pos:column="19">(<argument><expr><name pos:line="185" pos:column="20">newest<pos:position pos:line="185" pos:column="26"/></name></expr></argument>, <argument><expr><name pos:line="185" pos:column="28">newurl<pos:position pos:line="185" pos:column="34"/></name></expr></argument>)<pos:position pos:line="185" pos:column="35"/></argument_list></call></expr>;<pos:position pos:line="185" pos:column="36"/></expr_stmt> <comment type="block" pos:line="185" pos:column="37">/* create a space-free URL */</comment>

        <expr_stmt><expr><call><name pos:line="187" pos:column="9">free<pos:position pos:line="187" pos:column="13"/></name><argument_list pos:line="187" pos:column="13">(<argument><expr><name pos:line="187" pos:column="14">newurl<pos:position pos:line="187" pos:column="20"/></name></expr></argument>)<pos:position pos:line="187" pos:column="21"/></argument_list></call></expr>;<pos:position pos:line="187" pos:column="22"/></expr_stmt> <comment type="block" pos:line="187" pos:column="23">/* that was no good */</comment>
        <expr_stmt><expr><name pos:line="188" pos:column="9">newurl<pos:position pos:line="188" pos:column="15"/></name> <operator pos:line="188" pos:column="16">=<pos:position pos:line="188" pos:column="17"/></operator> <name pos:line="188" pos:column="18">newest<pos:position pos:line="188" pos:column="24"/></name></expr>;<pos:position pos:line="188" pos:column="25"/></expr_stmt> <comment type="block" pos:line="188" pos:column="26">/* use this instead now */</comment>
      }<pos:position pos:line="189" pos:column="8"/></block></then></if>
    }<pos:position pos:line="190" pos:column="6"/></block></then></if>

  }<pos:position pos:line="192" pos:column="4"/></block></else></if>

  <if pos:line="194" pos:column="3">if<condition pos:line="194" pos:column="5">(<expr><name><name pos:line="194" pos:column="6">data<pos:position pos:line="194" pos:column="10"/></name><operator pos:line="194" pos:column="10">-&gt;<pos:position pos:line="194" pos:column="15"/></operator><name pos:line="194" pos:column="12">change<pos:position pos:line="194" pos:column="18"/></name><operator pos:line="194" pos:column="18">.<pos:position pos:line="194" pos:column="19"/></operator><name pos:line="194" pos:column="19">url_alloc<pos:position pos:line="194" pos:column="28"/></name></name></expr>)<pos:position pos:line="194" pos:column="29"/></condition><then pos:line="194" pos:column="29">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="195" pos:column="5">free<pos:position pos:line="195" pos:column="9"/></name><argument_list pos:line="195" pos:column="9">(<argument><expr><name><name pos:line="195" pos:column="10">data<pos:position pos:line="195" pos:column="14"/></name><operator pos:line="195" pos:column="14">-&gt;<pos:position pos:line="195" pos:column="19"/></operator><name pos:line="195" pos:column="16">change<pos:position pos:line="195" pos:column="22"/></name><operator pos:line="195" pos:column="22">.<pos:position pos:line="195" pos:column="23"/></operator><name pos:line="195" pos:column="23">url<pos:position pos:line="195" pos:column="26"/></name></name></expr></argument>)<pos:position pos:line="195" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="195" pos:column="28"/></expr_stmt></block></then>
  <else pos:line="196" pos:column="3">else
    <block type="pseudo"><expr_stmt><expr><name><name pos:line="197" pos:column="5">data<pos:position pos:line="197" pos:column="9"/></name><operator pos:line="197" pos:column="9">-&gt;<pos:position pos:line="197" pos:column="14"/></operator><name pos:line="197" pos:column="11">change<pos:position pos:line="197" pos:column="17"/></name><operator pos:line="197" pos:column="17">.<pos:position pos:line="197" pos:column="18"/></operator><name pos:line="197" pos:column="18">url_alloc<pos:position pos:line="197" pos:column="27"/></name></name> <operator pos:line="197" pos:column="28">=<pos:position pos:line="197" pos:column="29"/></operator> <name pos:line="197" pos:column="30">TRUE<pos:position pos:line="197" pos:column="34"/></name></expr>;<pos:position pos:line="197" pos:column="35"/></expr_stmt></block></else></if> <comment type="block" pos:line="197" pos:column="36">/* the URL is allocated */</comment>

  <expr_stmt><expr><name><name pos:line="199" pos:column="3">data<pos:position pos:line="199" pos:column="7"/></name><operator pos:line="199" pos:column="7">-&gt;<pos:position pos:line="199" pos:column="12"/></operator><name pos:line="199" pos:column="9">change<pos:position pos:line="199" pos:column="15"/></name><operator pos:line="199" pos:column="15">.<pos:position pos:line="199" pos:column="16"/></operator><name pos:line="199" pos:column="16">url<pos:position pos:line="199" pos:column="19"/></name></name> <operator pos:line="199" pos:column="20">=<pos:position pos:line="199" pos:column="21"/></operator> <name pos:line="199" pos:column="22">newurl<pos:position pos:line="199" pos:column="28"/></name></expr>;<pos:position pos:line="199" pos:column="29"/></expr_stmt>
  <expr_stmt><expr><name pos:line="200" pos:column="3">newurl<pos:position pos:line="200" pos:column="9"/></name> <operator pos:line="200" pos:column="10">=<pos:position pos:line="200" pos:column="11"/></operator> <name pos:line="200" pos:column="12">NULL<pos:position pos:line="200" pos:column="16"/></name></expr>;<pos:position pos:line="200" pos:column="17"/></expr_stmt> <comment type="block" pos:line="200" pos:column="18">/* don't free! */</comment>

  <expr_stmt><expr><call><name pos:line="202" pos:column="3">infof<pos:position pos:line="202" pos:column="8"/></name><argument_list pos:line="202" pos:column="8">(<argument><expr><name pos:line="202" pos:column="9">data<pos:position pos:line="202" pos:column="13"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="202" pos:column="15">"Issue another request to this URL: '%s'\n"<pos:position pos:line="202" pos:column="58"/></literal></expr></argument>, <argument><expr><name><name pos:line="202" pos:column="60">data<pos:position pos:line="202" pos:column="64"/></name><operator pos:line="202" pos:column="64">-&gt;<pos:position pos:line="202" pos:column="69"/></operator><name pos:line="202" pos:column="66">change<pos:position pos:line="202" pos:column="72"/></name><operator pos:line="202" pos:column="72">.<pos:position pos:line="202" pos:column="73"/></operator><name pos:line="202" pos:column="73">url<pos:position pos:line="202" pos:column="76"/></name></name></expr></argument>)<pos:position pos:line="202" pos:column="77"/></argument_list></call></expr>;<pos:position pos:line="202" pos:column="78"/></expr_stmt>

  <comment type="block" pos:line="204" pos:column="3">/*
   * We get here when the HTTP code is 300-399 (and 401). We need to perform
   * differently based on exactly what return code there was.
   *
   * News from 7.10.6: we can also get here on a 401 or 407, in case we act on
   * a HTTP (proxy-) authentication scheme other than Basic.
   */</comment>
  <switch pos:line="211" pos:column="3">switch<condition pos:line="211" pos:column="9">(<expr><name><name pos:line="211" pos:column="10">data<pos:position pos:line="211" pos:column="14"/></name><operator pos:line="211" pos:column="14">-&gt;<pos:position pos:line="211" pos:column="19"/></operator><name pos:line="211" pos:column="16">info<pos:position pos:line="211" pos:column="20"/></name><operator pos:line="211" pos:column="20">.<pos:position pos:line="211" pos:column="21"/></operator><name pos:line="211" pos:column="21">httpcode<pos:position pos:line="211" pos:column="29"/></name></name></expr>)<pos:position pos:line="211" pos:column="30"/></condition> <block pos:line="211" pos:column="31">{
    <comment type="block" pos:line="212" pos:column="5">/* 401 - Act on a www-authentication, we keep on moving and do the
       Authorization: XXXX header in the HTTP request code snippet */</comment>
    <comment type="block" pos:line="214" pos:column="5">/* 407 - Act on a proxy-authentication, we keep on moving and do the
       Proxy-Authorization: XXXX header in the HTTP request code snippet */</comment>
    <comment type="block" pos:line="216" pos:column="5">/* 300 - Multiple Choices */</comment>
    <comment type="block" pos:line="217" pos:column="5">/* 306 - Not used */</comment>
    <comment type="block" pos:line="218" pos:column="5">/* 307 - Temporary Redirect */</comment>
  <default pos:line="219" pos:column="3">default:<pos:position pos:line="219" pos:column="11"/></default>  <comment type="block" pos:line="219" pos:column="13">/* for all above (and the unknown ones) */</comment>
    <comment type="block" pos:line="220" pos:column="5">/* Some codes are explicitly mentioned since I've checked RFC2616 and they
     * seem to be OK to POST to.
     */</comment>
    <break pos:line="223" pos:column="5">break;<pos:position pos:line="223" pos:column="11"/></break>
  <case pos:line="224" pos:column="3">case <expr><literal type="number" pos:line="224" pos:column="8">301<pos:position pos:line="224" pos:column="11"/></literal></expr>:<pos:position pos:line="224" pos:column="12"/></case> <comment type="block" pos:line="224" pos:column="13">/* Moved Permanently */</comment>
    <comment type="block" pos:line="225" pos:column="5">/* (quote from RFC2616, section 10.3.2):
     *
     * Note: When automatically redirecting a POST request after receiving a
     * 301 status code, some existing HTTP/1.0 user agents will erroneously
     * change it into a GET request.
     *
     * ----
     *
     * Warning: Because most of importants user agents do this obvious RFC2616
     * violation, many webservers expect this misbehavior. So these servers
     * often answers to a POST request with an error page.  To be sure that
     * libcurl gets the page that most user agents would get, libcurl has to
     * force GET:
     */</comment>
    <if pos:line="239" pos:column="5">if<condition pos:line="239" pos:column="7">( <expr><name><name pos:line="239" pos:column="9">data<pos:position pos:line="239" pos:column="13"/></name><operator pos:line="239" pos:column="13">-&gt;<pos:position pos:line="239" pos:column="18"/></operator><name pos:line="239" pos:column="15">set<pos:position pos:line="239" pos:column="18"/></name><operator pos:line="239" pos:column="18">.<pos:position pos:line="239" pos:column="19"/></operator><name pos:line="239" pos:column="19">httpreq<pos:position pos:line="239" pos:column="26"/></name></name> <operator pos:line="239" pos:column="27">==<pos:position pos:line="239" pos:column="29"/></operator> <name pos:line="239" pos:column="30">HTTPREQ_POST<pos:position pos:line="239" pos:column="42"/></name>
        <operator pos:line="240" pos:column="9">||<pos:position pos:line="240" pos:column="11"/></operator> <name><name pos:line="240" pos:column="12">data<pos:position pos:line="240" pos:column="16"/></name><operator pos:line="240" pos:column="16">-&gt;<pos:position pos:line="240" pos:column="21"/></operator><name pos:line="240" pos:column="18">set<pos:position pos:line="240" pos:column="21"/></name><operator pos:line="240" pos:column="21">.<pos:position pos:line="240" pos:column="22"/></operator><name pos:line="240" pos:column="22">httpreq<pos:position pos:line="240" pos:column="29"/></name></name> <operator pos:line="240" pos:column="30">==<pos:position pos:line="240" pos:column="32"/></operator> <name pos:line="240" pos:column="33">HTTPREQ_POST_FORM<pos:position pos:line="240" pos:column="50"/></name></expr>)<pos:position pos:line="240" pos:column="51"/></condition><then pos:line="240" pos:column="51"> <block pos:line="240" pos:column="52">{
      <expr_stmt><expr><call><name pos:line="241" pos:column="7">infof<pos:position pos:line="241" pos:column="12"/></name><argument_list pos:line="241" pos:column="12">(<argument><expr><name pos:line="241" pos:column="13">data<pos:position pos:line="241" pos:column="17"/></name></expr></argument>,
            <argument><expr><literal type="string" pos:line="242" pos:column="13">"Violate RFC 2616/10.3.2 and switch from POST to GET\n"<pos:position pos:line="242" pos:column="68"/></literal></expr></argument>)<pos:position pos:line="242" pos:column="69"/></argument_list></call></expr>;<pos:position pos:line="242" pos:column="70"/></expr_stmt>
      <expr_stmt><expr><name><name pos:line="243" pos:column="7">data<pos:position pos:line="243" pos:column="11"/></name><operator pos:line="243" pos:column="11">-&gt;<pos:position pos:line="243" pos:column="16"/></operator><name pos:line="243" pos:column="13">set<pos:position pos:line="243" pos:column="16"/></name><operator pos:line="243" pos:column="16">.<pos:position pos:line="243" pos:column="17"/></operator><name pos:line="243" pos:column="17">httpreq<pos:position pos:line="243" pos:column="24"/></name></name> <operator pos:line="243" pos:column="25">=<pos:position pos:line="243" pos:column="26"/></operator> <name pos:line="243" pos:column="27">HTTPREQ_GET<pos:position pos:line="243" pos:column="38"/></name></expr>;<pos:position pos:line="243" pos:column="39"/></expr_stmt>
    }<pos:position pos:line="244" pos:column="6"/></block></then></if>
    <break pos:line="245" pos:column="5">break;<pos:position pos:line="245" pos:column="11"/></break>
  <case pos:line="246" pos:column="3">case <expr><literal type="number" pos:line="246" pos:column="8">302<pos:position pos:line="246" pos:column="11"/></literal></expr>:<pos:position pos:line="246" pos:column="12"/></case> <comment type="block" pos:line="246" pos:column="13">/* Found */</comment>
    <comment type="block" pos:line="247" pos:column="5">/* (From 10.3.3)

    Note: RFC 1945 and RFC 2068 specify that the client is not allowed
    to change the method on the redirected request.  However, most
    existing user agent implementations treat 302 as if it were a 303
    response, performing a GET on the Location field-value regardless
    of the original request method. The status codes 303 and 307 have
    been added for servers that wish to make unambiguously clear which
    kind of reaction is expected of the client.

    (From 10.3.4)

    Note: Many pre-HTTP/1.1 user agents do not understand the 303
    status. When interoperability with such clients is a concern, the
    302 status code may be used instead, since most user agents react
    to a 302 response as described here for 303.
    */</comment>
  <case pos:line="264" pos:column="3">case <expr><literal type="number" pos:line="264" pos:column="8">303<pos:position pos:line="264" pos:column="11"/></literal></expr>:<pos:position pos:line="264" pos:column="12"/></case> <comment type="block" pos:line="264" pos:column="13">/* See Other */</comment>
    <comment type="block" pos:line="265" pos:column="5">/* Disable both types of POSTs, since doing a second POST when
     * following isn't what anyone would want! */</comment>
    <if pos:line="267" pos:column="5">if<condition pos:line="267" pos:column="7">(<expr><name><name pos:line="267" pos:column="8">data<pos:position pos:line="267" pos:column="12"/></name><operator pos:line="267" pos:column="12">-&gt;<pos:position pos:line="267" pos:column="17"/></operator><name pos:line="267" pos:column="14">set<pos:position pos:line="267" pos:column="17"/></name><operator pos:line="267" pos:column="17">.<pos:position pos:line="267" pos:column="18"/></operator><name pos:line="267" pos:column="18">httpreq<pos:position pos:line="267" pos:column="25"/></name></name> <operator pos:line="267" pos:column="26">!=<pos:position pos:line="267" pos:column="28"/></operator> <name pos:line="267" pos:column="29">HTTPREQ_GET<pos:position pos:line="267" pos:column="40"/></name></expr>)<pos:position pos:line="267" pos:column="41"/></condition><then pos:line="267" pos:column="41"> <block pos:line="267" pos:column="42">{
      <expr_stmt><expr><name><name pos:line="268" pos:column="7">data<pos:position pos:line="268" pos:column="11"/></name><operator pos:line="268" pos:column="11">-&gt;<pos:position pos:line="268" pos:column="16"/></operator><name pos:line="268" pos:column="13">set<pos:position pos:line="268" pos:column="16"/></name><operator pos:line="268" pos:column="16">.<pos:position pos:line="268" pos:column="17"/></operator><name pos:line="268" pos:column="17">httpreq<pos:position pos:line="268" pos:column="24"/></name></name> <operator pos:line="268" pos:column="25">=<pos:position pos:line="268" pos:column="26"/></operator> <name pos:line="268" pos:column="27">HTTPREQ_GET<pos:position pos:line="268" pos:column="38"/></name></expr>;<pos:position pos:line="268" pos:column="39"/></expr_stmt> <comment type="block" pos:line="268" pos:column="40">/* enforce GET request */</comment>
      <expr_stmt><expr><call><name pos:line="269" pos:column="7">infof<pos:position pos:line="269" pos:column="12"/></name><argument_list pos:line="269" pos:column="12">(<argument><expr><name pos:line="269" pos:column="13">data<pos:position pos:line="269" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="269" pos:column="19">"Disables POST, goes with %s\n"<pos:position pos:line="269" pos:column="50"/></literal></expr></argument>,
            <argument><expr><ternary><condition><expr><name><name pos:line="270" pos:column="13">data<pos:position pos:line="270" pos:column="17"/></name><operator pos:line="270" pos:column="17">-&gt;<pos:position pos:line="270" pos:column="22"/></operator><name pos:line="270" pos:column="19">set<pos:position pos:line="270" pos:column="22"/></name><operator pos:line="270" pos:column="22">.<pos:position pos:line="270" pos:column="23"/></operator><name pos:line="270" pos:column="23">opt_no_body<pos:position pos:line="270" pos:column="34"/></name></name></expr>?<pos:position pos:line="270" pos:column="35"/></condition><then><expr><literal type="string" pos:line="270" pos:column="35">"HEAD"<pos:position pos:line="270" pos:column="41"/></literal></expr></then><else pos:line="270" pos:column="41">:<expr><literal type="string" pos:line="270" pos:column="42">"GET"<pos:position pos:line="270" pos:column="47"/></literal></expr></else></ternary></expr></argument>)<pos:position pos:line="270" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="270" pos:column="49"/></expr_stmt>
    }<pos:position pos:line="271" pos:column="6"/></block></then></if>
    <break pos:line="272" pos:column="5">break;<pos:position pos:line="272" pos:column="11"/></break>
  <case pos:line="273" pos:column="3">case <expr><literal type="number" pos:line="273" pos:column="8">304<pos:position pos:line="273" pos:column="11"/></literal></expr>:<pos:position pos:line="273" pos:column="12"/></case> <comment type="block" pos:line="273" pos:column="13">/* Not Modified */</comment>
    <comment type="block" pos:line="274" pos:column="5">/* 304 means we did a conditional request and it was "Not modified".
     * We shouldn't get any Location: header in this response!
     */</comment>
    <break pos:line="277" pos:column="5">break;<pos:position pos:line="277" pos:column="11"/></break>
  <case pos:line="278" pos:column="3">case <expr><literal type="number" pos:line="278" pos:column="8">305<pos:position pos:line="278" pos:column="11"/></literal></expr>:<pos:position pos:line="278" pos:column="12"/></case> <comment type="block" pos:line="278" pos:column="13">/* Use Proxy */</comment>
    <comment type="block" pos:line="279" pos:column="5">/* (quote from RFC2616, section 10.3.6):
     * "The requested resource MUST be accessed through the proxy given
     * by the Location field. The Location field gives the URI of the
     * proxy.  The recipient is expected to repeat this single request
     * via the proxy. 305 responses MUST only be generated by origin
     * servers."
     */</comment>
    <break pos:line="286" pos:column="5">break;<pos:position pos:line="286" pos:column="11"/></break>
  }<pos:position pos:line="287" pos:column="4"/></block></switch>
  <expr_stmt><expr><call><name pos:line="288" pos:column="3">Curl_pgrsTime<pos:position pos:line="288" pos:column="16"/></name><argument_list pos:line="288" pos:column="16">(<argument><expr><name pos:line="288" pos:column="17">data<pos:position pos:line="288" pos:column="21"/></name></expr></argument>, <argument><expr><name pos:line="288" pos:column="23">TIMER_REDIRECT<pos:position pos:line="288" pos:column="37"/></name></expr></argument>)<pos:position pos:line="288" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="288" pos:column="39"/></expr_stmt>
  <expr_stmt><expr><call><name pos:line="289" pos:column="3">Curl_pgrsResetTimes<pos:position pos:line="289" pos:column="22"/></name><argument_list pos:line="289" pos:column="22">(<argument><expr><name pos:line="289" pos:column="23">data<pos:position pos:line="289" pos:column="27"/></name></expr></argument>)<pos:position pos:line="289" pos:column="28"/></argument_list></call></expr>;<pos:position pos:line="289" pos:column="29"/></expr_stmt>

  <return pos:line="291" pos:column="3">return <expr><name pos:line="291" pos:column="10">CURLE_OK<pos:position pos:line="291" pos:column="18"/></name></expr>;<pos:position pos:line="291" pos:column="19"/></return>
}<pos:position pos:line="292" pos:column="2"/></block></function></unit>
