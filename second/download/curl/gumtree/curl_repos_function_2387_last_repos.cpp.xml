<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/curl/gumtree/curl_repos_function_2387_last_repos.cpp" pos:tabs="8"><function><specifier pos:line="1" pos:column="1">static<pos:position pos:line="1" pos:column="7"/></specifier> <type><name pos:line="1" pos:column="8">CURLcode<pos:position pos:line="1" pos:column="16"/></name></type> <name pos:line="1" pos:column="17">ossl_connect_step1<pos:position pos:line="1" pos:column="35"/></name><parameter_list pos:line="1" pos:column="35">(<parameter><decl><type><name><name pos:line="1" pos:column="36">struct<pos:position pos:line="1" pos:column="42"/></name> <name pos:line="1" pos:column="43">connectdata<pos:position pos:line="1" pos:column="54"/></name></name> <modifier pos:line="1" pos:column="55">*<pos:position pos:line="1" pos:column="56"/></modifier></type><name pos:line="1" pos:column="56">conn<pos:position pos:line="1" pos:column="60"/></name></decl></parameter>, <parameter><decl><type><name pos:line="1" pos:column="62">int<pos:position pos:line="1" pos:column="65"/></name></type> <name pos:line="1" pos:column="66">sockindex<pos:position pos:line="1" pos:column="75"/></name></decl></parameter>)<pos:position pos:line="1" pos:column="76"/></parameter_list>
<block pos:line="2" pos:column="1">{
  <decl_stmt><decl><type><name pos:line="3" pos:column="3">CURLcode<pos:position pos:line="3" pos:column="11"/></name></type> <name pos:line="3" pos:column="12">result<pos:position pos:line="3" pos:column="18"/></name> <init pos:line="3" pos:column="19">= <expr><name pos:line="3" pos:column="21">CURLE_OK<pos:position pos:line="3" pos:column="29"/></name></expr></init></decl>;<pos:position pos:line="3" pos:column="30"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="4" pos:column="3">char<pos:position pos:line="4" pos:column="7"/></name> <modifier pos:line="4" pos:column="8">*<pos:position pos:line="4" pos:column="9"/></modifier></type><name pos:line="4" pos:column="9">ciphers<pos:position pos:line="4" pos:column="16"/></name></decl>;<pos:position pos:line="4" pos:column="17"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="5" pos:column="3">struct<pos:position pos:line="5" pos:column="9"/></name> <name pos:line="5" pos:column="10">Curl_easy<pos:position pos:line="5" pos:column="19"/></name></name> <modifier pos:line="5" pos:column="20">*<pos:position pos:line="5" pos:column="21"/></modifier></type><name pos:line="5" pos:column="21">data<pos:position pos:line="5" pos:column="25"/></name> <init pos:line="5" pos:column="26">= <expr><name><name pos:line="5" pos:column="28">conn<pos:position pos:line="5" pos:column="32"/></name><operator pos:line="5" pos:column="32">-&gt;<pos:position pos:line="5" pos:column="37"/></operator><name pos:line="5" pos:column="34">data<pos:position pos:line="5" pos:column="38"/></name></name></expr></init></decl>;<pos:position pos:line="5" pos:column="39"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="6" pos:column="3">SSL_METHOD_QUAL<pos:position pos:line="6" pos:column="18"/></name> <name pos:line="6" pos:column="19">SSL_METHOD<pos:position pos:line="6" pos:column="29"/></name> <modifier pos:line="6" pos:column="30">*<pos:position pos:line="6" pos:column="31"/></modifier></type><name pos:line="6" pos:column="31">req_method<pos:position pos:line="6" pos:column="41"/></name> <init pos:line="6" pos:column="42">= <expr><name pos:line="6" pos:column="44">NULL<pos:position pos:line="6" pos:column="48"/></name></expr></init></decl>;<pos:position pos:line="6" pos:column="49"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="7" pos:column="3">X509_LOOKUP<pos:position pos:line="7" pos:column="14"/></name> <modifier pos:line="7" pos:column="15">*<pos:position pos:line="7" pos:column="16"/></modifier></type><name pos:line="7" pos:column="16">lookup<pos:position pos:line="7" pos:column="22"/></name> <init pos:line="7" pos:column="23">= <expr><name pos:line="7" pos:column="25">NULL<pos:position pos:line="7" pos:column="29"/></name></expr></init></decl>;<pos:position pos:line="7" pos:column="30"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="8" pos:column="3">curl_socket_t<pos:position pos:line="8" pos:column="16"/></name></type> <name pos:line="8" pos:column="17">sockfd<pos:position pos:line="8" pos:column="23"/></name> <init pos:line="8" pos:column="24">= <expr><name><name pos:line="8" pos:column="26">conn<pos:position pos:line="8" pos:column="30"/></name><operator pos:line="8" pos:column="30">-&gt;<pos:position pos:line="8" pos:column="35"/></operator><name pos:line="8" pos:column="32">sock<pos:position pos:line="8" pos:column="36"/></name><index pos:line="8" pos:column="36">[<expr><name pos:line="8" pos:column="37">sockindex<pos:position pos:line="8" pos:column="46"/></name></expr>]<pos:position pos:line="8" pos:column="47"/></index></name></expr></init></decl>;<pos:position pos:line="8" pos:column="48"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="9" pos:column="3">struct<pos:position pos:line="9" pos:column="9"/></name> <name pos:line="9" pos:column="10">ssl_connect_data<pos:position pos:line="9" pos:column="26"/></name></name> <modifier pos:line="9" pos:column="27">*<pos:position pos:line="9" pos:column="28"/></modifier></type><name pos:line="9" pos:column="28">connssl<pos:position pos:line="9" pos:column="35"/></name> <init pos:line="9" pos:column="36">= <expr><operator pos:line="9" pos:column="38">&amp;<pos:position pos:line="9" pos:column="43"/></operator><name><name pos:line="9" pos:column="39">conn<pos:position pos:line="9" pos:column="43"/></name><operator pos:line="9" pos:column="43">-&gt;<pos:position pos:line="9" pos:column="48"/></operator><name pos:line="9" pos:column="45">ssl<pos:position pos:line="9" pos:column="48"/></name><index pos:line="9" pos:column="48">[<expr><name pos:line="9" pos:column="49">sockindex<pos:position pos:line="9" pos:column="58"/></name></expr>]<pos:position pos:line="9" pos:column="59"/></index></name></expr></init></decl>;<pos:position pos:line="9" pos:column="60"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="10" pos:column="3">long<pos:position pos:line="10" pos:column="7"/></name></type> <name pos:line="10" pos:column="8">ctx_options<pos:position pos:line="10" pos:column="19"/></name> <init pos:line="10" pos:column="20">= <expr><literal type="number" pos:line="10" pos:column="22">0<pos:position pos:line="10" pos:column="23"/></literal></expr></init></decl>;<pos:position pos:line="10" pos:column="24"/></decl_stmt>
<cpp:ifdef pos:line="11" pos:column="1">#<cpp:directive pos:line="11" pos:column="2">ifdef<pos:position pos:line="11" pos:column="7"/></cpp:directive> <name pos:line="11" pos:column="8">SSL_CTRL_SET_TLSEXT_HOSTNAME<pos:position pos:line="11" pos:column="36"/></name></cpp:ifdef>
  <decl_stmt><decl><type><name pos:line="12" pos:column="3">bool<pos:position pos:line="12" pos:column="7"/></name></type> <name pos:line="12" pos:column="8">sni<pos:position pos:line="12" pos:column="11"/></name></decl>;<pos:position pos:line="12" pos:column="12"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="13" pos:column="3">const<pos:position pos:line="13" pos:column="8"/></specifier> <name pos:line="13" pos:column="9">char<pos:position pos:line="13" pos:column="13"/></name> <modifier pos:line="13" pos:column="14">*<pos:position pos:line="13" pos:column="15"/></modifier> <specifier pos:line="13" pos:column="16">const<pos:position pos:line="13" pos:column="21"/></specifier></type> <name pos:line="13" pos:column="22">hostname<pos:position pos:line="13" pos:column="30"/></name> <init pos:line="13" pos:column="31">= <expr><ternary><condition><expr><call><name pos:line="13" pos:column="33">SSL_IS_PROXY<pos:position pos:line="13" pos:column="45"/></name><argument_list pos:line="13" pos:column="45">()<pos:position pos:line="13" pos:column="47"/></argument_list></call></expr> ?<pos:position pos:line="13" pos:column="49"/></condition><then pos:line="13" pos:column="49"> <expr><name><name pos:line="13" pos:column="50">conn<pos:position pos:line="13" pos:column="54"/></name><operator pos:line="13" pos:column="54">-&gt;<pos:position pos:line="13" pos:column="59"/></operator><name pos:line="13" pos:column="56">http_proxy<pos:position pos:line="13" pos:column="66"/></name><operator pos:line="13" pos:column="66">.<pos:position pos:line="13" pos:column="67"/></operator><name pos:line="13" pos:column="67">host<pos:position pos:line="13" pos:column="71"/></name><operator pos:line="13" pos:column="71">.<pos:position pos:line="13" pos:column="72"/></operator><name pos:line="13" pos:column="72">name<pos:position pos:line="13" pos:column="76"/></name></name></expr> <pos:position pos:line="13" pos:column="77"/></then><else pos:line="13" pos:column="77">:
    <expr><name><name pos:line="14" pos:column="5">conn<pos:position pos:line="14" pos:column="9"/></name><operator pos:line="14" pos:column="9">-&gt;<pos:position pos:line="14" pos:column="14"/></operator><name pos:line="14" pos:column="11">host<pos:position pos:line="14" pos:column="15"/></name><operator pos:line="14" pos:column="15">.<pos:position pos:line="14" pos:column="16"/></operator><name pos:line="14" pos:column="16">name<pos:position pos:line="14" pos:column="20"/></name></name></expr></else></ternary></expr></init></decl>;<pos:position pos:line="14" pos:column="21"/></decl_stmt>
<cpp:ifdef pos:line="15" pos:column="1">#<cpp:directive pos:line="15" pos:column="2">ifdef<pos:position pos:line="15" pos:column="7"/></cpp:directive> <name pos:line="15" pos:column="8">ENABLE_IPV6<pos:position pos:line="15" pos:column="19"/></name></cpp:ifdef>
  <decl_stmt><decl><type><name><name pos:line="16" pos:column="3">struct<pos:position pos:line="16" pos:column="9"/></name> <name pos:line="16" pos:column="10">in6_addr<pos:position pos:line="16" pos:column="18"/></name></name></type> <name pos:line="16" pos:column="19">addr<pos:position pos:line="16" pos:column="23"/></name></decl>;<pos:position pos:line="16" pos:column="24"/></decl_stmt>
<cpp:else pos:line="17" pos:column="1">#<cpp:directive pos:line="17" pos:column="2">else<pos:position pos:line="17" pos:column="6"/></cpp:directive></cpp:else>
  <decl_stmt><decl><type><name><name pos:line="18" pos:column="3">struct<pos:position pos:line="18" pos:column="9"/></name> <name pos:line="18" pos:column="10">in_addr<pos:position pos:line="18" pos:column="17"/></name></name></type> <name pos:line="18" pos:column="18">addr<pos:position pos:line="18" pos:column="22"/></name></decl>;<pos:position pos:line="18" pos:column="23"/></decl_stmt>
<cpp:endif pos:line="19" pos:column="1">#<cpp:directive pos:line="19" pos:column="2">endif<pos:position pos:line="19" pos:column="7"/></cpp:directive></cpp:endif>
<cpp:endif pos:line="20" pos:column="1">#<cpp:directive pos:line="20" pos:column="2">endif<pos:position pos:line="20" pos:column="7"/></cpp:directive></cpp:endif>
  <decl_stmt><decl><type><name pos:line="21" pos:column="3">long<pos:position pos:line="21" pos:column="7"/></name> <modifier pos:line="21" pos:column="8">*<pos:position pos:line="21" pos:column="9"/></modifier> <specifier pos:line="21" pos:column="10">const<pos:position pos:line="21" pos:column="15"/></specifier></type> <name pos:line="21" pos:column="16">certverifyresult<pos:position pos:line="21" pos:column="32"/></name> <init pos:line="21" pos:column="33">= <expr><ternary><condition><expr><call><name pos:line="21" pos:column="35">SSL_IS_PROXY<pos:position pos:line="21" pos:column="47"/></name><argument_list pos:line="21" pos:column="47">()<pos:position pos:line="21" pos:column="49"/></argument_list></call></expr> ?<pos:position pos:line="21" pos:column="51"/></condition><then pos:line="21" pos:column="51">
    <expr><operator pos:line="22" pos:column="5">&amp;<pos:position pos:line="22" pos:column="10"/></operator><name><name pos:line="22" pos:column="6">data<pos:position pos:line="22" pos:column="10"/></name><operator pos:line="22" pos:column="10">-&gt;<pos:position pos:line="22" pos:column="15"/></operator><name pos:line="22" pos:column="12">set<pos:position pos:line="22" pos:column="15"/></name><operator pos:line="22" pos:column="15">.<pos:position pos:line="22" pos:column="16"/></operator><name pos:line="22" pos:column="16">proxy_ssl<pos:position pos:line="22" pos:column="25"/></name><operator pos:line="22" pos:column="25">.<pos:position pos:line="22" pos:column="26"/></operator><name pos:line="22" pos:column="26">certverifyresult<pos:position pos:line="22" pos:column="42"/></name></name></expr> <pos:position pos:line="22" pos:column="43"/></then><else pos:line="22" pos:column="43">: <expr><operator pos:line="22" pos:column="45">&amp;<pos:position pos:line="22" pos:column="50"/></operator><name><name pos:line="22" pos:column="46">data<pos:position pos:line="22" pos:column="50"/></name><operator pos:line="22" pos:column="50">-&gt;<pos:position pos:line="22" pos:column="55"/></operator><name pos:line="22" pos:column="52">set<pos:position pos:line="22" pos:column="55"/></name><operator pos:line="22" pos:column="55">.<pos:position pos:line="22" pos:column="56"/></operator><name pos:line="22" pos:column="56">ssl<pos:position pos:line="22" pos:column="59"/></name><operator pos:line="22" pos:column="59">.<pos:position pos:line="22" pos:column="60"/></operator><name pos:line="22" pos:column="60">certverifyresult<pos:position pos:line="22" pos:column="76"/></name></name></expr></else></ternary></expr></init></decl>;<pos:position pos:line="22" pos:column="77"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="23" pos:column="3">const<pos:position pos:line="23" pos:column="8"/></specifier> <name pos:line="23" pos:column="9">long<pos:position pos:line="23" pos:column="13"/></name> <name pos:line="23" pos:column="14">int<pos:position pos:line="23" pos:column="17"/></name></type> <name pos:line="23" pos:column="18">ssl_version<pos:position pos:line="23" pos:column="29"/></name> <init pos:line="23" pos:column="30">= <expr><call><name pos:line="23" pos:column="32">SSL_CONN_CONFIG<pos:position pos:line="23" pos:column="47"/></name><argument_list pos:line="23" pos:column="47">(<argument><expr><name pos:line="23" pos:column="48">version<pos:position pos:line="23" pos:column="55"/></name></expr></argument>)<pos:position pos:line="23" pos:column="56"/></argument_list></call></expr></init></decl>;<pos:position pos:line="23" pos:column="57"/></decl_stmt>
<cpp:ifdef pos:line="24" pos:column="1">#<cpp:directive pos:line="24" pos:column="2">ifdef<pos:position pos:line="24" pos:column="7"/></cpp:directive> <name pos:line="24" pos:column="8">USE_TLS_SRP<pos:position pos:line="24" pos:column="19"/></name></cpp:ifdef>
  <decl_stmt><decl><type><specifier pos:line="25" pos:column="3">const<pos:position pos:line="25" pos:column="8"/></specifier> <name><name pos:line="25" pos:column="9">enum<pos:position pos:line="25" pos:column="13"/></name> <name pos:line="25" pos:column="14">CURL_TLSAUTH<pos:position pos:line="25" pos:column="26"/></name></name></type> <name pos:line="25" pos:column="27">ssl_authtype<pos:position pos:line="25" pos:column="39"/></name> <init pos:line="25" pos:column="40">= <expr><call><name pos:line="25" pos:column="42">SSL_SET_OPTION<pos:position pos:line="25" pos:column="56"/></name><argument_list pos:line="25" pos:column="56">(<argument><expr><name pos:line="25" pos:column="57">authtype<pos:position pos:line="25" pos:column="65"/></name></expr></argument>)<pos:position pos:line="25" pos:column="66"/></argument_list></call></expr></init></decl>;<pos:position pos:line="25" pos:column="67"/></decl_stmt>
<cpp:endif pos:line="26" pos:column="1">#<cpp:directive pos:line="26" pos:column="2">endif<pos:position pos:line="26" pos:column="7"/></cpp:directive></cpp:endif>
  <decl_stmt><decl><type><name pos:line="27" pos:column="3">char<pos:position pos:line="27" pos:column="7"/></name> <modifier pos:line="27" pos:column="8">*<pos:position pos:line="27" pos:column="9"/></modifier> <specifier pos:line="27" pos:column="10">const<pos:position pos:line="27" pos:column="15"/></specifier></type> <name pos:line="27" pos:column="16">ssl_cert<pos:position pos:line="27" pos:column="24"/></name> <init pos:line="27" pos:column="25">= <expr><call><name pos:line="27" pos:column="27">SSL_SET_OPTION<pos:position pos:line="27" pos:column="41"/></name><argument_list pos:line="27" pos:column="41">(<argument><expr><name pos:line="27" pos:column="42">cert<pos:position pos:line="27" pos:column="46"/></name></expr></argument>)<pos:position pos:line="27" pos:column="47"/></argument_list></call></expr></init></decl>;<pos:position pos:line="27" pos:column="48"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="28" pos:column="3">const<pos:position pos:line="28" pos:column="8"/></specifier> <name pos:line="28" pos:column="9">char<pos:position pos:line="28" pos:column="13"/></name> <modifier pos:line="28" pos:column="14">*<pos:position pos:line="28" pos:column="15"/></modifier> <specifier pos:line="28" pos:column="16">const<pos:position pos:line="28" pos:column="21"/></specifier></type> <name pos:line="28" pos:column="22">ssl_cert_type<pos:position pos:line="28" pos:column="35"/></name> <init pos:line="28" pos:column="36">= <expr><call><name pos:line="28" pos:column="38">SSL_SET_OPTION<pos:position pos:line="28" pos:column="52"/></name><argument_list pos:line="28" pos:column="52">(<argument><expr><name pos:line="28" pos:column="53">cert_type<pos:position pos:line="28" pos:column="62"/></name></expr></argument>)<pos:position pos:line="28" pos:column="63"/></argument_list></call></expr></init></decl>;<pos:position pos:line="28" pos:column="64"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="29" pos:column="3">const<pos:position pos:line="29" pos:column="8"/></specifier> <name pos:line="29" pos:column="9">char<pos:position pos:line="29" pos:column="13"/></name> <modifier pos:line="29" pos:column="14">*<pos:position pos:line="29" pos:column="15"/></modifier> <specifier pos:line="29" pos:column="16">const<pos:position pos:line="29" pos:column="21"/></specifier></type> <name pos:line="29" pos:column="22">ssl_cafile<pos:position pos:line="29" pos:column="32"/></name> <init pos:line="29" pos:column="33">= <expr><call><name pos:line="29" pos:column="35">SSL_CONN_CONFIG<pos:position pos:line="29" pos:column="50"/></name><argument_list pos:line="29" pos:column="50">(<argument><expr><name pos:line="29" pos:column="51">CAfile<pos:position pos:line="29" pos:column="57"/></name></expr></argument>)<pos:position pos:line="29" pos:column="58"/></argument_list></call></expr></init></decl>;<pos:position pos:line="29" pos:column="59"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="30" pos:column="3">const<pos:position pos:line="30" pos:column="8"/></specifier> <name pos:line="30" pos:column="9">char<pos:position pos:line="30" pos:column="13"/></name> <modifier pos:line="30" pos:column="14">*<pos:position pos:line="30" pos:column="15"/></modifier> <specifier pos:line="30" pos:column="16">const<pos:position pos:line="30" pos:column="21"/></specifier></type> <name pos:line="30" pos:column="22">ssl_capath<pos:position pos:line="30" pos:column="32"/></name> <init pos:line="30" pos:column="33">= <expr><call><name pos:line="30" pos:column="35">SSL_CONN_CONFIG<pos:position pos:line="30" pos:column="50"/></name><argument_list pos:line="30" pos:column="50">(<argument><expr><name pos:line="30" pos:column="51">CApath<pos:position pos:line="30" pos:column="57"/></name></expr></argument>)<pos:position pos:line="30" pos:column="58"/></argument_list></call></expr></init></decl>;<pos:position pos:line="30" pos:column="59"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="31" pos:column="3">const<pos:position pos:line="31" pos:column="8"/></specifier> <name pos:line="31" pos:column="9">bool<pos:position pos:line="31" pos:column="13"/></name></type> <name pos:line="31" pos:column="14">verifypeer<pos:position pos:line="31" pos:column="24"/></name> <init pos:line="31" pos:column="25">= <expr><call><name pos:line="31" pos:column="27">SSL_CONN_CONFIG<pos:position pos:line="31" pos:column="42"/></name><argument_list pos:line="31" pos:column="42">(<argument><expr><name pos:line="31" pos:column="43">verifypeer<pos:position pos:line="31" pos:column="53"/></name></expr></argument>)<pos:position pos:line="31" pos:column="54"/></argument_list></call></expr></init></decl>;<pos:position pos:line="31" pos:column="55"/></decl_stmt>
  <decl_stmt><decl><type><specifier pos:line="32" pos:column="3">const<pos:position pos:line="32" pos:column="8"/></specifier> <name pos:line="32" pos:column="9">char<pos:position pos:line="32" pos:column="13"/></name> <modifier pos:line="32" pos:column="14">*<pos:position pos:line="32" pos:column="15"/></modifier> <specifier pos:line="32" pos:column="16">const<pos:position pos:line="32" pos:column="21"/></specifier></type> <name pos:line="32" pos:column="22">ssl_crlfile<pos:position pos:line="32" pos:column="33"/></name> <init pos:line="32" pos:column="34">= <expr><call><name pos:line="32" pos:column="36">SSL_SET_OPTION<pos:position pos:line="32" pos:column="50"/></name><argument_list pos:line="32" pos:column="50">(<argument><expr><name pos:line="32" pos:column="51">CRLfile<pos:position pos:line="32" pos:column="58"/></name></expr></argument>)<pos:position pos:line="32" pos:column="59"/></argument_list></call></expr></init></decl>;<pos:position pos:line="32" pos:column="60"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="33" pos:column="3">char<pos:position pos:line="33" pos:column="7"/></name></type> <name><name pos:line="33" pos:column="8">error_buffer<pos:position pos:line="33" pos:column="20"/></name><index pos:line="33" pos:column="20">[<expr><literal type="number" pos:line="33" pos:column="21">256<pos:position pos:line="33" pos:column="24"/></literal></expr>]<pos:position pos:line="33" pos:column="25"/></index></name></decl>;<pos:position pos:line="33" pos:column="26"/></decl_stmt>

  <expr_stmt><expr><call><name pos:line="35" pos:column="3">DEBUGASSERT<pos:position pos:line="35" pos:column="14"/></name><argument_list pos:line="35" pos:column="14">(<argument><expr><name pos:line="35" pos:column="15">ssl_connect_1<pos:position pos:line="35" pos:column="28"/></name> <operator pos:line="35" pos:column="29">==<pos:position pos:line="35" pos:column="31"/></operator> <name><name pos:line="35" pos:column="32">connssl<pos:position pos:line="35" pos:column="39"/></name><operator pos:line="35" pos:column="39">-&gt;<pos:position pos:line="35" pos:column="44"/></operator><name pos:line="35" pos:column="41">connecting_state<pos:position pos:line="35" pos:column="57"/></name></name></expr></argument>)<pos:position pos:line="35" pos:column="58"/></argument_list></call></expr>;<pos:position pos:line="35" pos:column="59"/></expr_stmt>

  <comment type="block" pos:line="37" pos:column="3">/* Make funny stuff to get random input */</comment>
  <expr_stmt><expr><name pos:line="38" pos:column="3">result<pos:position pos:line="38" pos:column="9"/></name> <operator pos:line="38" pos:column="10">=<pos:position pos:line="38" pos:column="11"/></operator> <call><name pos:line="38" pos:column="12">Curl_ossl_seed<pos:position pos:line="38" pos:column="26"/></name><argument_list pos:line="38" pos:column="26">(<argument><expr><name pos:line="38" pos:column="27">data<pos:position pos:line="38" pos:column="31"/></name></expr></argument>)<pos:position pos:line="38" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="38" pos:column="33"/></expr_stmt>
  <if pos:line="39" pos:column="3">if<condition pos:line="39" pos:column="5">(<expr><name pos:line="39" pos:column="6">result<pos:position pos:line="39" pos:column="12"/></name></expr>)<pos:position pos:line="39" pos:column="13"/></condition><then pos:line="39" pos:column="13">
    <block type="pseudo"><return pos:line="40" pos:column="5">return <expr><name pos:line="40" pos:column="12">result<pos:position pos:line="40" pos:column="18"/></name></expr>;<pos:position pos:line="40" pos:column="19"/></return></block></then></if>

  <expr_stmt><expr><operator pos:line="42" pos:column="3">*<pos:position pos:line="42" pos:column="4"/></operator><name pos:line="42" pos:column="4">certverifyresult<pos:position pos:line="42" pos:column="20"/></name> <operator pos:line="42" pos:column="21">=<pos:position pos:line="42" pos:column="22"/></operator> <operator pos:line="42" pos:column="23">!<pos:position pos:line="42" pos:column="24"/></operator><name pos:line="42" pos:column="24">X509_V_OK<pos:position pos:line="42" pos:column="33"/></name></expr>;<pos:position pos:line="42" pos:column="34"/></expr_stmt>

  <comment type="block" pos:line="44" pos:column="3">/* check to see if we've been told to use an explicit SSL/TLS version */</comment>

  <switch pos:line="46" pos:column="3">switch<condition pos:line="46" pos:column="9">(<expr><name pos:line="46" pos:column="10">ssl_version<pos:position pos:line="46" pos:column="21"/></name></expr>)<pos:position pos:line="46" pos:column="22"/></condition> <block pos:line="46" pos:column="23">{
  <case pos:line="47" pos:column="3">case <expr><name pos:line="47" pos:column="8">CURL_SSLVERSION_DEFAULT<pos:position pos:line="47" pos:column="31"/></name></expr>:<pos:position pos:line="47" pos:column="32"/></case>
  <case pos:line="48" pos:column="3">case <expr><name pos:line="48" pos:column="8">CURL_SSLVERSION_TLSv1<pos:position pos:line="48" pos:column="29"/></name></expr>:<pos:position pos:line="48" pos:column="30"/></case>
  <case pos:line="49" pos:column="3">case <expr><name pos:line="49" pos:column="8">CURL_SSLVERSION_TLSv1_0<pos:position pos:line="49" pos:column="31"/></name></expr>:<pos:position pos:line="49" pos:column="32"/></case>
  <case pos:line="50" pos:column="3">case <expr><name pos:line="50" pos:column="8">CURL_SSLVERSION_TLSv1_1<pos:position pos:line="50" pos:column="31"/></name></expr>:<pos:position pos:line="50" pos:column="32"/></case>
  <case pos:line="51" pos:column="3">case <expr><name pos:line="51" pos:column="8">CURL_SSLVERSION_TLSv1_2<pos:position pos:line="51" pos:column="31"/></name></expr>:<pos:position pos:line="51" pos:column="32"/></case>
  <case pos:line="52" pos:column="3">case <expr><name pos:line="52" pos:column="8">CURL_SSLVERSION_TLSv1_3<pos:position pos:line="52" pos:column="31"/></name></expr>:<pos:position pos:line="52" pos:column="32"/></case>
    <comment type="block" pos:line="53" pos:column="5">/* it will be handled later with the context options */</comment>
<cpp:if pos:line="54" pos:column="1">#<cpp:directive pos:line="54" pos:column="2">if<pos:position pos:line="54" pos:column="4"/></cpp:directive> <expr><operator pos:line="54" pos:column="5">(<pos:position pos:line="54" pos:column="6"/></operator><name pos:line="54" pos:column="6">OPENSSL_VERSION_NUMBER<pos:position pos:line="54" pos:column="28"/></name> <operator pos:line="54" pos:column="29">&gt;=<pos:position pos:line="54" pos:column="34"/></operator> <literal type="number" pos:line="54" pos:column="32">0x10100000L<pos:position pos:line="54" pos:column="43"/></literal><operator pos:line="54" pos:column="43">)<pos:position pos:line="54" pos:column="44"/></operator> <operator pos:line="54" pos:column="45">&amp;&amp;<pos:position pos:line="54" pos:column="55"/></operator> \
    <operator pos:line="55" pos:column="5">!<pos:position pos:line="55" pos:column="6"/></operator><call><name pos:line="55" pos:column="6">defined<pos:position pos:line="55" pos:column="13"/></name><argument_list pos:line="55" pos:column="13">(<argument><expr><name pos:line="55" pos:column="14">LIBRESSL_VERSION_NUMBER<pos:position pos:line="55" pos:column="37"/></name></expr></argument>)<pos:position pos:line="55" pos:column="38"/></argument_list></call></expr></cpp:if>
    <expr_stmt><expr><name pos:line="56" pos:column="5">req_method<pos:position pos:line="56" pos:column="15"/></name> <operator pos:line="56" pos:column="16">=<pos:position pos:line="56" pos:column="17"/></operator> <call><name pos:line="56" pos:column="18">TLS_client_method<pos:position pos:line="56" pos:column="35"/></name><argument_list pos:line="56" pos:column="35">()<pos:position pos:line="56" pos:column="37"/></argument_list></call></expr>;<pos:position pos:line="56" pos:column="38"/></expr_stmt>
<cpp:else pos:line="57" pos:column="1">#<cpp:directive pos:line="57" pos:column="2">else<pos:position pos:line="57" pos:column="6"/></cpp:directive></cpp:else>
    <expr_stmt><expr><name pos:line="58" pos:column="5">req_method<pos:position pos:line="58" pos:column="15"/></name> <operator pos:line="58" pos:column="16">=<pos:position pos:line="58" pos:column="17"/></operator> <call><name pos:line="58" pos:column="18">SSLv23_client_method<pos:position pos:line="58" pos:column="38"/></name><argument_list pos:line="58" pos:column="38">()<pos:position pos:line="58" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="58" pos:column="41"/></expr_stmt>
<cpp:endif pos:line="59" pos:column="1">#<cpp:directive pos:line="59" pos:column="2">endif<pos:position pos:line="59" pos:column="7"/></cpp:directive></cpp:endif>
    <expr_stmt><expr><call><name pos:line="60" pos:column="5">use_sni<pos:position pos:line="60" pos:column="12"/></name><argument_list pos:line="60" pos:column="12">(<argument><expr><name pos:line="60" pos:column="13">TRUE<pos:position pos:line="60" pos:column="17"/></name></expr></argument>)<pos:position pos:line="60" pos:column="18"/></argument_list></call></expr>;<pos:position pos:line="60" pos:column="19"/></expr_stmt>
    <break pos:line="61" pos:column="5">break;<pos:position pos:line="61" pos:column="11"/></break>
  <case pos:line="62" pos:column="3">case <expr><name pos:line="62" pos:column="8">CURL_SSLVERSION_SSLv2<pos:position pos:line="62" pos:column="29"/></name></expr>:<pos:position pos:line="62" pos:column="30"/></case>
<cpp:ifdef pos:line="63" pos:column="1">#<cpp:directive pos:line="63" pos:column="2">ifdef<pos:position pos:line="63" pos:column="7"/></cpp:directive> <name pos:line="63" pos:column="8">OPENSSL_NO_SSL2<pos:position pos:line="63" pos:column="23"/></name></cpp:ifdef>
    <expr_stmt><expr><call><name pos:line="64" pos:column="5">failf<pos:position pos:line="64" pos:column="10"/></name><argument_list pos:line="64" pos:column="10">(<argument><expr><name pos:line="64" pos:column="11">data<pos:position pos:line="64" pos:column="15"/></name></expr></argument>, <argument><expr><name pos:line="64" pos:column="17">OSSL_PACKAGE<pos:position pos:line="64" pos:column="29"/></name> <literal type="string" pos:line="64" pos:column="30">" was built without SSLv2 support"<pos:position pos:line="64" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="64" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="64" pos:column="66"/></expr_stmt>
    <return pos:line="65" pos:column="5">return <expr><name pos:line="65" pos:column="12">CURLE_NOT_BUILT_IN<pos:position pos:line="65" pos:column="30"/></name></expr>;<pos:position pos:line="65" pos:column="31"/></return>
<cpp:else pos:line="66" pos:column="1">#<cpp:directive pos:line="66" pos:column="2">else<pos:position pos:line="66" pos:column="6"/></cpp:directive></cpp:else>
<cpp:ifdef pos:line="67" pos:column="1">#<cpp:directive pos:line="67" pos:column="2">ifdef<pos:position pos:line="67" pos:column="7"/></cpp:directive> <name pos:line="67" pos:column="8">USE_TLS_SRP<pos:position pos:line="67" pos:column="19"/></name></cpp:ifdef>
    <if pos:line="68" pos:column="5">if<condition pos:line="68" pos:column="7">(<expr><name pos:line="68" pos:column="8">ssl_authtype<pos:position pos:line="68" pos:column="20"/></name> <operator pos:line="68" pos:column="21">==<pos:position pos:line="68" pos:column="23"/></operator> <name pos:line="68" pos:column="24">CURL_TLSAUTH_SRP<pos:position pos:line="68" pos:column="40"/></name></expr>)<pos:position pos:line="68" pos:column="41"/></condition><then pos:line="68" pos:column="41">
      <block type="pseudo"><return pos:line="69" pos:column="7">return <expr><name pos:line="69" pos:column="14">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="69" pos:column="37"/></name></expr>;<pos:position pos:line="69" pos:column="38"/></return></block></then></if>
<cpp:endif pos:line="70" pos:column="1">#<cpp:directive pos:line="70" pos:column="2">endif<pos:position pos:line="70" pos:column="7"/></cpp:directive></cpp:endif>
    <expr_stmt><expr><name pos:line="71" pos:column="5">req_method<pos:position pos:line="71" pos:column="15"/></name> <operator pos:line="71" pos:column="16">=<pos:position pos:line="71" pos:column="17"/></operator> <call><name pos:line="71" pos:column="18">SSLv2_client_method<pos:position pos:line="71" pos:column="37"/></name><argument_list pos:line="71" pos:column="37">()<pos:position pos:line="71" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="71" pos:column="40"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="72" pos:column="5">use_sni<pos:position pos:line="72" pos:column="12"/></name><argument_list pos:line="72" pos:column="12">(<argument><expr><name pos:line="72" pos:column="13">FALSE<pos:position pos:line="72" pos:column="18"/></name></expr></argument>)<pos:position pos:line="72" pos:column="19"/></argument_list></call></expr>;<pos:position pos:line="72" pos:column="20"/></expr_stmt>
    <break pos:line="73" pos:column="5">break;<pos:position pos:line="73" pos:column="11"/></break>
<cpp:endif pos:line="74" pos:column="1">#<cpp:directive pos:line="74" pos:column="2">endif<pos:position pos:line="74" pos:column="7"/></cpp:directive></cpp:endif>
  <case pos:line="75" pos:column="3">case <expr><name pos:line="75" pos:column="8">CURL_SSLVERSION_SSLv3<pos:position pos:line="75" pos:column="29"/></name></expr>:<pos:position pos:line="75" pos:column="30"/></case>
<cpp:ifdef pos:line="76" pos:column="1">#<cpp:directive pos:line="76" pos:column="2">ifdef<pos:position pos:line="76" pos:column="7"/></cpp:directive> <name pos:line="76" pos:column="8">OPENSSL_NO_SSL3_METHOD<pos:position pos:line="76" pos:column="30"/></name></cpp:ifdef>
    <expr_stmt><expr><call><name pos:line="77" pos:column="5">failf<pos:position pos:line="77" pos:column="10"/></name><argument_list pos:line="77" pos:column="10">(<argument><expr><name pos:line="77" pos:column="11">data<pos:position pos:line="77" pos:column="15"/></name></expr></argument>, <argument><expr><name pos:line="77" pos:column="17">OSSL_PACKAGE<pos:position pos:line="77" pos:column="29"/></name> <literal type="string" pos:line="77" pos:column="30">" was built without SSLv3 support"<pos:position pos:line="77" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="77" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="77" pos:column="66"/></expr_stmt>
    <return pos:line="78" pos:column="5">return <expr><name pos:line="78" pos:column="12">CURLE_NOT_BUILT_IN<pos:position pos:line="78" pos:column="30"/></name></expr>;<pos:position pos:line="78" pos:column="31"/></return>
<cpp:else pos:line="79" pos:column="1">#<cpp:directive pos:line="79" pos:column="2">else<pos:position pos:line="79" pos:column="6"/></cpp:directive></cpp:else>
<cpp:ifdef pos:line="80" pos:column="1">#<cpp:directive pos:line="80" pos:column="2">ifdef<pos:position pos:line="80" pos:column="7"/></cpp:directive> <name pos:line="80" pos:column="8">USE_TLS_SRP<pos:position pos:line="80" pos:column="19"/></name></cpp:ifdef>
    <if pos:line="81" pos:column="5">if<condition pos:line="81" pos:column="7">(<expr><name pos:line="81" pos:column="8">ssl_authtype<pos:position pos:line="81" pos:column="20"/></name> <operator pos:line="81" pos:column="21">==<pos:position pos:line="81" pos:column="23"/></operator> <name pos:line="81" pos:column="24">CURL_TLSAUTH_SRP<pos:position pos:line="81" pos:column="40"/></name></expr>)<pos:position pos:line="81" pos:column="41"/></condition><then pos:line="81" pos:column="41">
      <block type="pseudo"><return pos:line="82" pos:column="7">return <expr><name pos:line="82" pos:column="14">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="82" pos:column="37"/></name></expr>;<pos:position pos:line="82" pos:column="38"/></return></block></then></if>
<cpp:endif pos:line="83" pos:column="1">#<cpp:directive pos:line="83" pos:column="2">endif<pos:position pos:line="83" pos:column="7"/></cpp:directive></cpp:endif>
    <expr_stmt><expr><name pos:line="84" pos:column="5">req_method<pos:position pos:line="84" pos:column="15"/></name> <operator pos:line="84" pos:column="16">=<pos:position pos:line="84" pos:column="17"/></operator> <call><name pos:line="84" pos:column="18">SSLv3_client_method<pos:position pos:line="84" pos:column="37"/></name><argument_list pos:line="84" pos:column="37">()<pos:position pos:line="84" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="84" pos:column="40"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="85" pos:column="5">use_sni<pos:position pos:line="85" pos:column="12"/></name><argument_list pos:line="85" pos:column="12">(<argument><expr><name pos:line="85" pos:column="13">FALSE<pos:position pos:line="85" pos:column="18"/></name></expr></argument>)<pos:position pos:line="85" pos:column="19"/></argument_list></call></expr>;<pos:position pos:line="85" pos:column="20"/></expr_stmt>
    <break pos:line="86" pos:column="5">break;<pos:position pos:line="86" pos:column="11"/></break>
<cpp:endif pos:line="87" pos:column="1">#<cpp:directive pos:line="87" pos:column="2">endif<pos:position pos:line="87" pos:column="7"/></cpp:directive></cpp:endif>
  <default pos:line="88" pos:column="3">default:<pos:position pos:line="88" pos:column="11"/></default>
    <expr_stmt><expr><call><name pos:line="89" pos:column="5">failf<pos:position pos:line="89" pos:column="10"/></name><argument_list pos:line="89" pos:column="10">(<argument><expr><name pos:line="89" pos:column="11">data<pos:position pos:line="89" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="89" pos:column="17">"Unrecognized parameter passed via CURLOPT_SSLVERSION"<pos:position pos:line="89" pos:column="71"/></literal></expr></argument>)<pos:position pos:line="89" pos:column="72"/></argument_list></call></expr>;<pos:position pos:line="89" pos:column="73"/></expr_stmt>
    <return pos:line="90" pos:column="5">return <expr><name pos:line="90" pos:column="12">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="90" pos:column="35"/></name></expr>;<pos:position pos:line="90" pos:column="36"/></return>
  }<pos:position pos:line="91" pos:column="4"/></block></switch>

  <if pos:line="93" pos:column="3">if<condition pos:line="93" pos:column="5">(<expr><name><name pos:line="93" pos:column="6">BACKEND<pos:position pos:line="93" pos:column="13"/></name><operator pos:line="93" pos:column="13">-&gt;<pos:position pos:line="93" pos:column="18"/></operator><name pos:line="93" pos:column="15">ctx<pos:position pos:line="93" pos:column="18"/></name></name></expr>)<pos:position pos:line="93" pos:column="19"/></condition><then pos:line="93" pos:column="19">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="94" pos:column="5">SSL_CTX_free<pos:position pos:line="94" pos:column="17"/></name><argument_list pos:line="94" pos:column="17">(<argument><expr><name><name pos:line="94" pos:column="18">BACKEND<pos:position pos:line="94" pos:column="25"/></name><operator pos:line="94" pos:column="25">-&gt;<pos:position pos:line="94" pos:column="30"/></operator><name pos:line="94" pos:column="27">ctx<pos:position pos:line="94" pos:column="30"/></name></name></expr></argument>)<pos:position pos:line="94" pos:column="31"/></argument_list></call></expr>;<pos:position pos:line="94" pos:column="32"/></expr_stmt></block></then></if>
  <expr_stmt><expr><name><name pos:line="95" pos:column="3">BACKEND<pos:position pos:line="95" pos:column="10"/></name><operator pos:line="95" pos:column="10">-&gt;<pos:position pos:line="95" pos:column="15"/></operator><name pos:line="95" pos:column="12">ctx<pos:position pos:line="95" pos:column="15"/></name></name> <operator pos:line="95" pos:column="16">=<pos:position pos:line="95" pos:column="17"/></operator> <call><name pos:line="95" pos:column="18">SSL_CTX_new<pos:position pos:line="95" pos:column="29"/></name><argument_list pos:line="95" pos:column="29">(<argument><expr><name pos:line="95" pos:column="30">req_method<pos:position pos:line="95" pos:column="40"/></name></expr></argument>)<pos:position pos:line="95" pos:column="41"/></argument_list></call></expr>;<pos:position pos:line="95" pos:column="42"/></expr_stmt>

  <if pos:line="97" pos:column="3">if<condition pos:line="97" pos:column="5">(<expr><operator pos:line="97" pos:column="6">!<pos:position pos:line="97" pos:column="7"/></operator><name><name pos:line="97" pos:column="7">BACKEND<pos:position pos:line="97" pos:column="14"/></name><operator pos:line="97" pos:column="14">-&gt;<pos:position pos:line="97" pos:column="19"/></operator><name pos:line="97" pos:column="16">ctx<pos:position pos:line="97" pos:column="19"/></name></name></expr>)<pos:position pos:line="97" pos:column="20"/></condition><then pos:line="97" pos:column="20"> <block pos:line="97" pos:column="21">{
    <expr_stmt><expr><call><name pos:line="98" pos:column="5">failf<pos:position pos:line="98" pos:column="10"/></name><argument_list pos:line="98" pos:column="10">(<argument><expr><name pos:line="98" pos:column="11">data<pos:position pos:line="98" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="98" pos:column="17">"SSL: couldn't create a context: %s"<pos:position pos:line="98" pos:column="53"/></literal></expr></argument>,
          <argument><expr><call><name pos:line="99" pos:column="11">ossl_strerror<pos:position pos:line="99" pos:column="24"/></name><argument_list pos:line="99" pos:column="24">(<argument><expr><call><name pos:line="99" pos:column="25">ERR_peek_error<pos:position pos:line="99" pos:column="39"/></name><argument_list pos:line="99" pos:column="39">()<pos:position pos:line="99" pos:column="41"/></argument_list></call></expr></argument>, <argument><expr><name pos:line="99" pos:column="43">error_buffer<pos:position pos:line="99" pos:column="55"/></name></expr></argument>, <argument><expr><sizeof pos:line="99" pos:column="57">sizeof<argument_list pos:line="99" pos:column="63">(<argument><expr><name pos:line="99" pos:column="64">error_buffer<pos:position pos:line="99" pos:column="76"/></name></expr></argument>)<pos:position pos:line="99" pos:column="77"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="99" pos:column="78"/></argument_list></call></expr></argument>)<pos:position pos:line="99" pos:column="79"/></argument_list></call></expr>;<pos:position pos:line="99" pos:column="80"/></expr_stmt>
    <return pos:line="100" pos:column="5">return <expr><name pos:line="100" pos:column="12">CURLE_OUT_OF_MEMORY<pos:position pos:line="100" pos:column="31"/></name></expr>;<pos:position pos:line="100" pos:column="32"/></return>
  }<pos:position pos:line="101" pos:column="4"/></block></then></if>

<cpp:ifdef pos:line="103" pos:column="1">#<cpp:directive pos:line="103" pos:column="2">ifdef<pos:position pos:line="103" pos:column="7"/></cpp:directive> <name pos:line="103" pos:column="8">SSL_MODE_RELEASE_BUFFERS<pos:position pos:line="103" pos:column="32"/></name></cpp:ifdef>
  <expr_stmt><expr><call><name pos:line="104" pos:column="3">SSL_CTX_set_mode<pos:position pos:line="104" pos:column="19"/></name><argument_list pos:line="104" pos:column="19">(<argument><expr><name><name pos:line="104" pos:column="20">BACKEND<pos:position pos:line="104" pos:column="27"/></name><operator pos:line="104" pos:column="27">-&gt;<pos:position pos:line="104" pos:column="32"/></operator><name pos:line="104" pos:column="29">ctx<pos:position pos:line="104" pos:column="32"/></name></name></expr></argument>, <argument><expr><name pos:line="104" pos:column="34">SSL_MODE_RELEASE_BUFFERS<pos:position pos:line="104" pos:column="58"/></name></expr></argument>)<pos:position pos:line="104" pos:column="59"/></argument_list></call></expr>;<pos:position pos:line="104" pos:column="60"/></expr_stmt>
<cpp:endif pos:line="105" pos:column="1">#<cpp:directive pos:line="105" pos:column="2">endif<pos:position pos:line="105" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="107" pos:column="1">#<cpp:directive pos:line="107" pos:column="2">ifdef<pos:position pos:line="107" pos:column="7"/></cpp:directive> <name pos:line="107" pos:column="8">SSL_CTRL_SET_MSG_CALLBACK<pos:position pos:line="107" pos:column="33"/></name></cpp:ifdef>
  <if pos:line="108" pos:column="3">if<condition pos:line="108" pos:column="5">(<expr><name><name pos:line="108" pos:column="6">data<pos:position pos:line="108" pos:column="10"/></name><operator pos:line="108" pos:column="10">-&gt;<pos:position pos:line="108" pos:column="15"/></operator><name pos:line="108" pos:column="12">set<pos:position pos:line="108" pos:column="15"/></name><operator pos:line="108" pos:column="15">.<pos:position pos:line="108" pos:column="16"/></operator><name pos:line="108" pos:column="16">fdebug<pos:position pos:line="108" pos:column="22"/></name></name> <operator pos:line="108" pos:column="23">&amp;&amp;<pos:position pos:line="108" pos:column="33"/></operator> <name><name pos:line="108" pos:column="26">data<pos:position pos:line="108" pos:column="30"/></name><operator pos:line="108" pos:column="30">-&gt;<pos:position pos:line="108" pos:column="35"/></operator><name pos:line="108" pos:column="32">set<pos:position pos:line="108" pos:column="35"/></name><operator pos:line="108" pos:column="35">.<pos:position pos:line="108" pos:column="36"/></operator><name pos:line="108" pos:column="36">verbose<pos:position pos:line="108" pos:column="43"/></name></name></expr>)<pos:position pos:line="108" pos:column="44"/></condition><then pos:line="108" pos:column="44"> <block pos:line="108" pos:column="45">{
    <comment type="block" pos:line="109" pos:column="5">/* the SSL trace callback is only used for verbose logging */</comment>
    <expr_stmt><expr><call><name pos:line="110" pos:column="5">SSL_CTX_set_msg_callback<pos:position pos:line="110" pos:column="29"/></name><argument_list pos:line="110" pos:column="29">(<argument><expr><name><name pos:line="110" pos:column="30">BACKEND<pos:position pos:line="110" pos:column="37"/></name><operator pos:line="110" pos:column="37">-&gt;<pos:position pos:line="110" pos:column="42"/></operator><name pos:line="110" pos:column="39">ctx<pos:position pos:line="110" pos:column="42"/></name></name></expr></argument>, <argument><expr><name pos:line="110" pos:column="44">ssl_tls_trace<pos:position pos:line="110" pos:column="57"/></name></expr></argument>)<pos:position pos:line="110" pos:column="58"/></argument_list></call></expr>;<pos:position pos:line="110" pos:column="59"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="111" pos:column="5">SSL_CTX_set_msg_callback_arg<pos:position pos:line="111" pos:column="33"/></name><argument_list pos:line="111" pos:column="33">(<argument><expr><name><name pos:line="111" pos:column="34">BACKEND<pos:position pos:line="111" pos:column="41"/></name><operator pos:line="111" pos:column="41">-&gt;<pos:position pos:line="111" pos:column="46"/></operator><name pos:line="111" pos:column="43">ctx<pos:position pos:line="111" pos:column="46"/></name></name></expr></argument>, <argument><expr><name pos:line="111" pos:column="48">conn<pos:position pos:line="111" pos:column="52"/></name></expr></argument>)<pos:position pos:line="111" pos:column="53"/></argument_list></call></expr>;<pos:position pos:line="111" pos:column="54"/></expr_stmt>
  }<pos:position pos:line="112" pos:column="4"/></block></then></if>
<cpp:endif pos:line="113" pos:column="1">#<cpp:directive pos:line="113" pos:column="2">endif<pos:position pos:line="113" pos:column="7"/></cpp:directive></cpp:endif>

  <comment type="block" pos:line="115" pos:column="3">/* OpenSSL contains code to work-around lots of bugs and flaws in various
     SSL-implementations. SSL_CTX_set_options() is used to enabled those
     work-arounds. The man page for this option states that SSL_OP_ALL enables
     all the work-arounds and that "It is usually safe to use SSL_OP_ALL to
     enable the bug workaround options if compatibility with somewhat broken
     implementations is desired."

     The "-no_ticket" option was introduced in Openssl0.9.8j. It's a flag to
     disable "rfc4507bis session ticket support".  rfc4507bis was later turned
     into the proper RFC5077 it seems: https://tools.ietf.org/html/rfc5077

     The enabled extension concerns the session management. I wonder how often
     libcurl stops a connection and then resumes a TLS session. also, sending
     the session data is some overhead. .I suggest that you just use your
     proposed patch (which explicitly disables TICKET).

     If someone writes an application with libcurl and openssl who wants to
     enable the feature, one can do this in the SSL callback.

     SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG option enabling allowed proper
     interoperability with web server Netscape Enterprise Server 2.0.1 which
     was released back in 1996.

     Due to CVE-2010-4180, option SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG has
     become ineffective as of OpenSSL 0.9.8q and 1.0.0c. In order to mitigate
     CVE-2010-4180 when using previous OpenSSL versions we no longer enable
     this option regardless of OpenSSL version and SSL_OP_ALL definition.

     OpenSSL added a work-around for a SSL 3.0/TLS 1.0 CBC vulnerability
     (https://www.openssl.org/~bodo/tls-cbc.txt). In 0.9.6e they added a bit to
     SSL_OP_ALL that _disables_ that work-around despite the fact that
     SSL_OP_ALL is documented to do "rather harmless" workarounds. In order to
     keep the secure work-around, the SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS bit
     must not be set.
  */</comment>

  <expr_stmt><expr><name pos:line="151" pos:column="3">ctx_options<pos:position pos:line="151" pos:column="14"/></name> <operator pos:line="151" pos:column="15">=<pos:position pos:line="151" pos:column="16"/></operator> <name pos:line="151" pos:column="17">SSL_OP_ALL<pos:position pos:line="151" pos:column="27"/></name></expr>;<pos:position pos:line="151" pos:column="28"/></expr_stmt>

<cpp:ifdef pos:line="153" pos:column="1">#<cpp:directive pos:line="153" pos:column="2">ifdef<pos:position pos:line="153" pos:column="7"/></cpp:directive> <name pos:line="153" pos:column="8">SSL_OP_NO_TICKET<pos:position pos:line="153" pos:column="24"/></name></cpp:ifdef>
  <expr_stmt><expr><name pos:line="154" pos:column="3">ctx_options<pos:position pos:line="154" pos:column="14"/></name> <operator pos:line="154" pos:column="15">|=<pos:position pos:line="154" pos:column="17"/></operator> <name pos:line="154" pos:column="18">SSL_OP_NO_TICKET<pos:position pos:line="154" pos:column="34"/></name></expr>;<pos:position pos:line="154" pos:column="35"/></expr_stmt>
<cpp:endif pos:line="155" pos:column="1">#<cpp:directive pos:line="155" pos:column="2">endif<pos:position pos:line="155" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="157" pos:column="1">#<cpp:directive pos:line="157" pos:column="2">ifdef<pos:position pos:line="157" pos:column="7"/></cpp:directive> <name pos:line="157" pos:column="8">SSL_OP_NO_COMPRESSION<pos:position pos:line="157" pos:column="29"/></name></cpp:ifdef>
  <expr_stmt><expr><name pos:line="158" pos:column="3">ctx_options<pos:position pos:line="158" pos:column="14"/></name> <operator pos:line="158" pos:column="15">|=<pos:position pos:line="158" pos:column="17"/></operator> <name pos:line="158" pos:column="18">SSL_OP_NO_COMPRESSION<pos:position pos:line="158" pos:column="39"/></name></expr>;<pos:position pos:line="158" pos:column="40"/></expr_stmt>
<cpp:endif pos:line="159" pos:column="1">#<cpp:directive pos:line="159" pos:column="2">endif<pos:position pos:line="159" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="161" pos:column="1">#<cpp:directive pos:line="161" pos:column="2">ifdef<pos:position pos:line="161" pos:column="7"/></cpp:directive> <name pos:line="161" pos:column="8">SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG<pos:position pos:line="161" pos:column="47"/></name></cpp:ifdef>
  <comment type="block" pos:line="162" pos:column="3">/* mitigate CVE-2010-4180 */</comment>
  <expr_stmt><expr><name pos:line="163" pos:column="3">ctx_options<pos:position pos:line="163" pos:column="14"/></name> <operator pos:line="163" pos:column="15">&amp;=<pos:position pos:line="163" pos:column="21"/></operator> <operator pos:line="163" pos:column="18">~<pos:position pos:line="163" pos:column="19"/></operator><name pos:line="163" pos:column="19">SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG<pos:position pos:line="163" pos:column="58"/></name></expr>;<pos:position pos:line="163" pos:column="59"/></expr_stmt>
<cpp:endif pos:line="164" pos:column="1">#<cpp:directive pos:line="164" pos:column="2">endif<pos:position pos:line="164" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="166" pos:column="1">#<cpp:directive pos:line="166" pos:column="2">ifdef<pos:position pos:line="166" pos:column="7"/></cpp:directive> <name pos:line="166" pos:column="8">SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS<pos:position pos:line="166" pos:column="42"/></name></cpp:ifdef>
  <comment type="block" pos:line="167" pos:column="3">/* unless the user explicitly ask to allow the protocol vulnerability we
     use the work-around */</comment>
  <if pos:line="169" pos:column="3">if<condition pos:line="169" pos:column="5">(<expr><operator pos:line="169" pos:column="6">!<pos:position pos:line="169" pos:column="7"/></operator><call><name pos:line="169" pos:column="7">SSL_SET_OPTION<pos:position pos:line="169" pos:column="21"/></name><argument_list pos:line="169" pos:column="21">(<argument><expr><name pos:line="169" pos:column="22">enable_beast<pos:position pos:line="169" pos:column="34"/></name></expr></argument>)<pos:position pos:line="169" pos:column="35"/></argument_list></call></expr>)<pos:position pos:line="169" pos:column="36"/></condition><then pos:line="169" pos:column="36">
    <block type="pseudo"><expr_stmt><expr><name pos:line="170" pos:column="5">ctx_options<pos:position pos:line="170" pos:column="16"/></name> <operator pos:line="170" pos:column="17">&amp;=<pos:position pos:line="170" pos:column="23"/></operator> <operator pos:line="170" pos:column="20">~<pos:position pos:line="170" pos:column="21"/></operator><name pos:line="170" pos:column="21">SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS<pos:position pos:line="170" pos:column="55"/></name></expr>;<pos:position pos:line="170" pos:column="56"/></expr_stmt></block></then></if>
<cpp:endif pos:line="171" pos:column="1">#<cpp:directive pos:line="171" pos:column="2">endif<pos:position pos:line="171" pos:column="7"/></cpp:directive></cpp:endif>

  <switch pos:line="173" pos:column="3">switch<condition pos:line="173" pos:column="9">(<expr><name pos:line="173" pos:column="10">ssl_version<pos:position pos:line="173" pos:column="21"/></name></expr>)<pos:position pos:line="173" pos:column="22"/></condition> <block pos:line="173" pos:column="23">{
  <case pos:line="174" pos:column="3">case <expr><name pos:line="174" pos:column="8">CURL_SSLVERSION_SSLv3<pos:position pos:line="174" pos:column="29"/></name></expr>:<pos:position pos:line="174" pos:column="30"/></case>
<cpp:ifdef pos:line="175" pos:column="1">#<cpp:directive pos:line="175" pos:column="2">ifdef<pos:position pos:line="175" pos:column="7"/></cpp:directive> <name pos:line="175" pos:column="8">USE_TLS_SRP<pos:position pos:line="175" pos:column="19"/></name></cpp:ifdef>
    <if pos:line="176" pos:column="5">if<condition pos:line="176" pos:column="7">(<expr><name pos:line="176" pos:column="8">ssl_authtype<pos:position pos:line="176" pos:column="20"/></name> <operator pos:line="176" pos:column="21">==<pos:position pos:line="176" pos:column="23"/></operator> <name pos:line="176" pos:column="24">CURL_TLSAUTH_SRP<pos:position pos:line="176" pos:column="40"/></name></expr>)<pos:position pos:line="176" pos:column="41"/></condition><then pos:line="176" pos:column="41"> <block pos:line="176" pos:column="42">{
      <expr_stmt><expr><call><name pos:line="177" pos:column="7">infof<pos:position pos:line="177" pos:column="12"/></name><argument_list pos:line="177" pos:column="12">(<argument><expr><name pos:line="177" pos:column="13">data<pos:position pos:line="177" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="177" pos:column="19">"Set version TLSv1.x for SRP authorisation\n"<pos:position pos:line="177" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="177" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="177" pos:column="66"/></expr_stmt>
    }<pos:position pos:line="178" pos:column="6"/></block></then></if>
<cpp:endif pos:line="179" pos:column="1">#<cpp:directive pos:line="179" pos:column="2">endif<pos:position pos:line="179" pos:column="7"/></cpp:directive></cpp:endif>
    <expr_stmt><expr><name pos:line="180" pos:column="5">ctx_options<pos:position pos:line="180" pos:column="16"/></name> <operator pos:line="180" pos:column="17">|=<pos:position pos:line="180" pos:column="19"/></operator> <name pos:line="180" pos:column="20">SSL_OP_NO_SSLv2<pos:position pos:line="180" pos:column="35"/></name></expr>;<pos:position pos:line="180" pos:column="36"/></expr_stmt>
    <expr_stmt><expr><name pos:line="181" pos:column="5">ctx_options<pos:position pos:line="181" pos:column="16"/></name> <operator pos:line="181" pos:column="17">|=<pos:position pos:line="181" pos:column="19"/></operator> <name pos:line="181" pos:column="20">SSL_OP_NO_TLSv1<pos:position pos:line="181" pos:column="35"/></name></expr>;<pos:position pos:line="181" pos:column="36"/></expr_stmt>
<cpp:if pos:line="182" pos:column="1">#<cpp:directive pos:line="182" pos:column="2">if<pos:position pos:line="182" pos:column="4"/></cpp:directive> <expr><name pos:line="182" pos:column="5">OPENSSL_VERSION_NUMBER<pos:position pos:line="182" pos:column="27"/></name> <operator pos:line="182" pos:column="28">&gt;=<pos:position pos:line="182" pos:column="33"/></operator> <literal type="number" pos:line="182" pos:column="31">0x1000100FL<pos:position pos:line="182" pos:column="42"/></literal></expr></cpp:if>
    <expr_stmt><expr><name pos:line="183" pos:column="5">ctx_options<pos:position pos:line="183" pos:column="16"/></name> <operator pos:line="183" pos:column="17">|=<pos:position pos:line="183" pos:column="19"/></operator> <name pos:line="183" pos:column="20">SSL_OP_NO_TLSv1_1<pos:position pos:line="183" pos:column="37"/></name></expr>;<pos:position pos:line="183" pos:column="38"/></expr_stmt>
    <expr_stmt><expr><name pos:line="184" pos:column="5">ctx_options<pos:position pos:line="184" pos:column="16"/></name> <operator pos:line="184" pos:column="17">|=<pos:position pos:line="184" pos:column="19"/></operator> <name pos:line="184" pos:column="20">SSL_OP_NO_TLSv1_2<pos:position pos:line="184" pos:column="37"/></name></expr>;<pos:position pos:line="184" pos:column="38"/></expr_stmt>
<cpp:ifdef pos:line="185" pos:column="1">#<cpp:directive pos:line="185" pos:column="2">ifdef<pos:position pos:line="185" pos:column="7"/></cpp:directive> <name pos:line="185" pos:column="8">TLS1_3_VERSION<pos:position pos:line="185" pos:column="22"/></name></cpp:ifdef>
    <expr_stmt><expr><name pos:line="186" pos:column="5">ctx_options<pos:position pos:line="186" pos:column="16"/></name> <operator pos:line="186" pos:column="17">|=<pos:position pos:line="186" pos:column="19"/></operator> <name pos:line="186" pos:column="20">SSL_OP_NO_TLSv1_3<pos:position pos:line="186" pos:column="37"/></name></expr>;<pos:position pos:line="186" pos:column="38"/></expr_stmt>
<cpp:endif pos:line="187" pos:column="1">#<cpp:directive pos:line="187" pos:column="2">endif<pos:position pos:line="187" pos:column="7"/></cpp:directive></cpp:endif>
<cpp:endif pos:line="188" pos:column="1">#<cpp:directive pos:line="188" pos:column="2">endif<pos:position pos:line="188" pos:column="7"/></cpp:directive></cpp:endif>
    <break pos:line="189" pos:column="5">break;<pos:position pos:line="189" pos:column="11"/></break>

  <case pos:line="191" pos:column="3">case <expr><name pos:line="191" pos:column="8">CURL_SSLVERSION_DEFAULT<pos:position pos:line="191" pos:column="31"/></name></expr>:<pos:position pos:line="191" pos:column="32"/></case>
  <case pos:line="192" pos:column="3">case <expr><name pos:line="192" pos:column="8">CURL_SSLVERSION_TLSv1<pos:position pos:line="192" pos:column="29"/></name></expr>:<pos:position pos:line="192" pos:column="30"/></case>
    <expr_stmt><expr><name pos:line="193" pos:column="5">ctx_options<pos:position pos:line="193" pos:column="16"/></name> <operator pos:line="193" pos:column="17">|=<pos:position pos:line="193" pos:column="19"/></operator> <name pos:line="193" pos:column="20">SSL_OP_NO_SSLv2<pos:position pos:line="193" pos:column="35"/></name></expr>;<pos:position pos:line="193" pos:column="36"/></expr_stmt>
    <expr_stmt><expr><name pos:line="194" pos:column="5">ctx_options<pos:position pos:line="194" pos:column="16"/></name> <operator pos:line="194" pos:column="17">|=<pos:position pos:line="194" pos:column="19"/></operator> <name pos:line="194" pos:column="20">SSL_OP_NO_SSLv3<pos:position pos:line="194" pos:column="35"/></name></expr>;<pos:position pos:line="194" pos:column="36"/></expr_stmt>
    <break pos:line="195" pos:column="5">break;<pos:position pos:line="195" pos:column="11"/></break>

  <case pos:line="197" pos:column="3">case <expr><name pos:line="197" pos:column="8">CURL_SSLVERSION_TLSv1_0<pos:position pos:line="197" pos:column="31"/></name></expr>:<pos:position pos:line="197" pos:column="32"/></case>
  <case pos:line="198" pos:column="3">case <expr><name pos:line="198" pos:column="8">CURL_SSLVERSION_TLSv1_1<pos:position pos:line="198" pos:column="31"/></name></expr>:<pos:position pos:line="198" pos:column="32"/></case>
  <case pos:line="199" pos:column="3">case <expr><name pos:line="199" pos:column="8">CURL_SSLVERSION_TLSv1_2<pos:position pos:line="199" pos:column="31"/></name></expr>:<pos:position pos:line="199" pos:column="32"/></case>
  <case pos:line="200" pos:column="3">case <expr><name pos:line="200" pos:column="8">CURL_SSLVERSION_TLSv1_3<pos:position pos:line="200" pos:column="31"/></name></expr>:<pos:position pos:line="200" pos:column="32"/></case>
    <expr_stmt><expr><name pos:line="201" pos:column="5">result<pos:position pos:line="201" pos:column="11"/></name> <operator pos:line="201" pos:column="12">=<pos:position pos:line="201" pos:column="13"/></operator> <call><name pos:line="201" pos:column="14">set_ssl_version_min_max<pos:position pos:line="201" pos:column="37"/></name><argument_list pos:line="201" pos:column="37">(<argument><expr><operator pos:line="201" pos:column="38">&amp;<pos:position pos:line="201" pos:column="43"/></operator><name pos:line="201" pos:column="39">ctx_options<pos:position pos:line="201" pos:column="50"/></name></expr></argument>, <argument><expr><name pos:line="201" pos:column="52">conn<pos:position pos:line="201" pos:column="56"/></name></expr></argument>, <argument><expr><name pos:line="201" pos:column="58">sockindex<pos:position pos:line="201" pos:column="67"/></name></expr></argument>)<pos:position pos:line="201" pos:column="68"/></argument_list></call></expr>;<pos:position pos:line="201" pos:column="69"/></expr_stmt>
    <if pos:line="202" pos:column="5">if<condition pos:line="202" pos:column="7">(<expr><name pos:line="202" pos:column="8">result<pos:position pos:line="202" pos:column="14"/></name> <operator pos:line="202" pos:column="15">!=<pos:position pos:line="202" pos:column="17"/></operator> <name pos:line="202" pos:column="18">CURLE_OK<pos:position pos:line="202" pos:column="26"/></name></expr>)<pos:position pos:line="202" pos:column="27"/></condition><then pos:line="202" pos:column="27">
       <block type="pseudo"><return pos:line="203" pos:column="8">return <expr><name pos:line="203" pos:column="15">result<pos:position pos:line="203" pos:column="21"/></name></expr>;<pos:position pos:line="203" pos:column="22"/></return></block></then></if>
    <break pos:line="204" pos:column="5">break;<pos:position pos:line="204" pos:column="11"/></break>

  <case pos:line="206" pos:column="3">case <expr><name pos:line="206" pos:column="8">CURL_SSLVERSION_SSLv2<pos:position pos:line="206" pos:column="29"/></name></expr>:<pos:position pos:line="206" pos:column="30"/></case>
<cpp:ifndef pos:line="207" pos:column="1">#<cpp:directive pos:line="207" pos:column="2">ifndef<pos:position pos:line="207" pos:column="8"/></cpp:directive> <name pos:line="207" pos:column="9">OPENSSL_NO_SSL2<pos:position pos:line="207" pos:column="24"/></name></cpp:ifndef>
    <expr_stmt><expr><name pos:line="208" pos:column="5">ctx_options<pos:position pos:line="208" pos:column="16"/></name> <operator pos:line="208" pos:column="17">|=<pos:position pos:line="208" pos:column="19"/></operator> <name pos:line="208" pos:column="20">SSL_OP_NO_SSLv3<pos:position pos:line="208" pos:column="35"/></name></expr>;<pos:position pos:line="208" pos:column="36"/></expr_stmt>
    <expr_stmt><expr><name pos:line="209" pos:column="5">ctx_options<pos:position pos:line="209" pos:column="16"/></name> <operator pos:line="209" pos:column="17">|=<pos:position pos:line="209" pos:column="19"/></operator> <name pos:line="209" pos:column="20">SSL_OP_NO_TLSv1<pos:position pos:line="209" pos:column="35"/></name></expr>;<pos:position pos:line="209" pos:column="36"/></expr_stmt>
<cpp:if pos:line="210" pos:column="1">#<cpp:directive pos:line="210" pos:column="2">if<pos:position pos:line="210" pos:column="4"/></cpp:directive> <expr><name pos:line="210" pos:column="5">OPENSSL_VERSION_NUMBER<pos:position pos:line="210" pos:column="27"/></name> <operator pos:line="210" pos:column="28">&gt;=<pos:position pos:line="210" pos:column="33"/></operator> <literal type="number" pos:line="210" pos:column="31">0x1000100FL<pos:position pos:line="210" pos:column="42"/></literal></expr></cpp:if>
    <expr_stmt><expr><name pos:line="211" pos:column="5">ctx_options<pos:position pos:line="211" pos:column="16"/></name> <operator pos:line="211" pos:column="17">|=<pos:position pos:line="211" pos:column="19"/></operator> <name pos:line="211" pos:column="20">SSL_OP_NO_TLSv1_1<pos:position pos:line="211" pos:column="37"/></name></expr>;<pos:position pos:line="211" pos:column="38"/></expr_stmt>
    <expr_stmt><expr><name pos:line="212" pos:column="5">ctx_options<pos:position pos:line="212" pos:column="16"/></name> <operator pos:line="212" pos:column="17">|=<pos:position pos:line="212" pos:column="19"/></operator> <name pos:line="212" pos:column="20">SSL_OP_NO_TLSv1_2<pos:position pos:line="212" pos:column="37"/></name></expr>;<pos:position pos:line="212" pos:column="38"/></expr_stmt>
<cpp:ifdef pos:line="213" pos:column="1">#<cpp:directive pos:line="213" pos:column="2">ifdef<pos:position pos:line="213" pos:column="7"/></cpp:directive> <name pos:line="213" pos:column="8">TLS1_3_VERSION<pos:position pos:line="213" pos:column="22"/></name></cpp:ifdef>
    <expr_stmt><expr><name pos:line="214" pos:column="5">ctx_options<pos:position pos:line="214" pos:column="16"/></name> <operator pos:line="214" pos:column="17">|=<pos:position pos:line="214" pos:column="19"/></operator> <name pos:line="214" pos:column="20">SSL_OP_NO_TLSv1_3<pos:position pos:line="214" pos:column="37"/></name></expr>;<pos:position pos:line="214" pos:column="38"/></expr_stmt>
<cpp:endif pos:line="215" pos:column="1">#<cpp:directive pos:line="215" pos:column="2">endif<pos:position pos:line="215" pos:column="7"/></cpp:directive></cpp:endif>
<cpp:endif pos:line="216" pos:column="1">#<cpp:directive pos:line="216" pos:column="2">endif<pos:position pos:line="216" pos:column="7"/></cpp:directive></cpp:endif>
    <break pos:line="217" pos:column="5">break;<pos:position pos:line="217" pos:column="11"/></break>
<cpp:else pos:line="218" pos:column="1">#<cpp:directive pos:line="218" pos:column="2">else<pos:position pos:line="218" pos:column="6"/></cpp:directive></cpp:else>
    <expr_stmt><expr><call><name pos:line="219" pos:column="5">failf<pos:position pos:line="219" pos:column="10"/></name><argument_list pos:line="219" pos:column="10">(<argument><expr><name pos:line="219" pos:column="11">data<pos:position pos:line="219" pos:column="15"/></name></expr></argument>, <argument><expr><name pos:line="219" pos:column="17">OSSL_PACKAGE<pos:position pos:line="219" pos:column="29"/></name> <literal type="string" pos:line="219" pos:column="30">" was built without SSLv2 support"<pos:position pos:line="219" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="219" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="219" pos:column="66"/></expr_stmt>
    <return pos:line="220" pos:column="5">return <expr><name pos:line="220" pos:column="12">CURLE_NOT_BUILT_IN<pos:position pos:line="220" pos:column="30"/></name></expr>;<pos:position pos:line="220" pos:column="31"/></return>
<cpp:endif pos:line="221" pos:column="1">#<cpp:directive pos:line="221" pos:column="2">endif<pos:position pos:line="221" pos:column="7"/></cpp:directive></cpp:endif>

  <default pos:line="223" pos:column="3">default:<pos:position pos:line="223" pos:column="11"/></default>
    <expr_stmt><expr><call><name pos:line="224" pos:column="5">failf<pos:position pos:line="224" pos:column="10"/></name><argument_list pos:line="224" pos:column="10">(<argument><expr><name pos:line="224" pos:column="11">data<pos:position pos:line="224" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="224" pos:column="17">"Unrecognized parameter passed via CURLOPT_SSLVERSION"<pos:position pos:line="224" pos:column="71"/></literal></expr></argument>)<pos:position pos:line="224" pos:column="72"/></argument_list></call></expr>;<pos:position pos:line="224" pos:column="73"/></expr_stmt>
    <return pos:line="225" pos:column="5">return <expr><name pos:line="225" pos:column="12">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="225" pos:column="35"/></name></expr>;<pos:position pos:line="225" pos:column="36"/></return>
  }<pos:position pos:line="226" pos:column="4"/></block></switch>

  <expr_stmt><expr><call><name pos:line="228" pos:column="3">SSL_CTX_set_options<pos:position pos:line="228" pos:column="22"/></name><argument_list pos:line="228" pos:column="22">(<argument><expr><name><name pos:line="228" pos:column="23">BACKEND<pos:position pos:line="228" pos:column="30"/></name><operator pos:line="228" pos:column="30">-&gt;<pos:position pos:line="228" pos:column="35"/></operator><name pos:line="228" pos:column="32">ctx<pos:position pos:line="228" pos:column="35"/></name></name></expr></argument>, <argument><expr><name pos:line="228" pos:column="37">ctx_options<pos:position pos:line="228" pos:column="48"/></name></expr></argument>)<pos:position pos:line="228" pos:column="49"/></argument_list></call></expr>;<pos:position pos:line="228" pos:column="50"/></expr_stmt>

<cpp:ifdef pos:line="230" pos:column="1">#<cpp:directive pos:line="230" pos:column="2">ifdef<pos:position pos:line="230" pos:column="7"/></cpp:directive> <name pos:line="230" pos:column="8">HAS_NPN<pos:position pos:line="230" pos:column="15"/></name></cpp:ifdef>
  <if pos:line="231" pos:column="3">if<condition pos:line="231" pos:column="5">(<expr><name><name pos:line="231" pos:column="6">conn<pos:position pos:line="231" pos:column="10"/></name><operator pos:line="231" pos:column="10">-&gt;<pos:position pos:line="231" pos:column="15"/></operator><name pos:line="231" pos:column="12">bits<pos:position pos:line="231" pos:column="16"/></name><operator pos:line="231" pos:column="16">.<pos:position pos:line="231" pos:column="17"/></operator><name pos:line="231" pos:column="17">tls_enable_npn<pos:position pos:line="231" pos:column="31"/></name></name></expr>)<pos:position pos:line="231" pos:column="32"/></condition><then pos:line="231" pos:column="32">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="232" pos:column="5">SSL_CTX_set_next_proto_select_cb<pos:position pos:line="232" pos:column="37"/></name><argument_list pos:line="232" pos:column="37">(<argument><expr><name><name pos:line="232" pos:column="38">BACKEND<pos:position pos:line="232" pos:column="45"/></name><operator pos:line="232" pos:column="45">-&gt;<pos:position pos:line="232" pos:column="50"/></operator><name pos:line="232" pos:column="47">ctx<pos:position pos:line="232" pos:column="50"/></name></name></expr></argument>, <argument><expr><name pos:line="232" pos:column="52">select_next_proto_cb<pos:position pos:line="232" pos:column="72"/></name></expr></argument>, <argument><expr><name pos:line="232" pos:column="74">conn<pos:position pos:line="232" pos:column="78"/></name></expr></argument>)<pos:position pos:line="232" pos:column="79"/></argument_list></call></expr>;<pos:position pos:line="232" pos:column="80"/></expr_stmt></block></then></if>
<cpp:endif pos:line="233" pos:column="1">#<cpp:directive pos:line="233" pos:column="2">endif<pos:position pos:line="233" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="235" pos:column="1">#<cpp:directive pos:line="235" pos:column="2">ifdef<pos:position pos:line="235" pos:column="7"/></cpp:directive> <name pos:line="235" pos:column="8">HAS_ALPN<pos:position pos:line="235" pos:column="16"/></name></cpp:ifdef>
  <if pos:line="236" pos:column="3">if<condition pos:line="236" pos:column="5">(<expr><name><name pos:line="236" pos:column="6">conn<pos:position pos:line="236" pos:column="10"/></name><operator pos:line="236" pos:column="10">-&gt;<pos:position pos:line="236" pos:column="15"/></operator><name pos:line="236" pos:column="12">bits<pos:position pos:line="236" pos:column="16"/></name><operator pos:line="236" pos:column="16">.<pos:position pos:line="236" pos:column="17"/></operator><name pos:line="236" pos:column="17">tls_enable_alpn<pos:position pos:line="236" pos:column="32"/></name></name></expr>)<pos:position pos:line="236" pos:column="33"/></condition><then pos:line="236" pos:column="33"> <block pos:line="236" pos:column="34">{
    <decl_stmt><decl><type><name pos:line="237" pos:column="5">int<pos:position pos:line="237" pos:column="8"/></name></type> <name pos:line="237" pos:column="9">cur<pos:position pos:line="237" pos:column="12"/></name> <init pos:line="237" pos:column="13">= <expr><literal type="number" pos:line="237" pos:column="15">0<pos:position pos:line="237" pos:column="16"/></literal></expr></init></decl>;<pos:position pos:line="237" pos:column="17"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="238" pos:column="5">unsigned<pos:position pos:line="238" pos:column="13"/></name> <name pos:line="238" pos:column="14">char<pos:position pos:line="238" pos:column="18"/></name></type> <name><name pos:line="238" pos:column="19">protocols<pos:position pos:line="238" pos:column="28"/></name><index pos:line="238" pos:column="28">[<expr><literal type="number" pos:line="238" pos:column="29">128<pos:position pos:line="238" pos:column="32"/></literal></expr>]<pos:position pos:line="238" pos:column="33"/></index></name></decl>;<pos:position pos:line="238" pos:column="34"/></decl_stmt>

<cpp:ifdef pos:line="240" pos:column="1">#<cpp:directive pos:line="240" pos:column="2">ifdef<pos:position pos:line="240" pos:column="7"/></cpp:directive> <name pos:line="240" pos:column="8">USE_NGHTTP2<pos:position pos:line="240" pos:column="19"/></name></cpp:ifdef>
    <if pos:line="241" pos:column="5">if<condition pos:line="241" pos:column="7">(<expr><name><name pos:line="241" pos:column="8">data<pos:position pos:line="241" pos:column="12"/></name><operator pos:line="241" pos:column="12">-&gt;<pos:position pos:line="241" pos:column="17"/></operator><name pos:line="241" pos:column="14">set<pos:position pos:line="241" pos:column="17"/></name><operator pos:line="241" pos:column="17">.<pos:position pos:line="241" pos:column="18"/></operator><name pos:line="241" pos:column="18">httpversion<pos:position pos:line="241" pos:column="29"/></name></name> <operator pos:line="241" pos:column="30">&gt;=<pos:position pos:line="241" pos:column="35"/></operator> <name pos:line="241" pos:column="33">CURL_HTTP_VERSION_2<pos:position pos:line="241" pos:column="52"/></name> <operator pos:line="241" pos:column="53">&amp;&amp;<pos:position pos:line="241" pos:column="63"/></operator>
       <operator pos:line="242" pos:column="8">(<pos:position pos:line="242" pos:column="9"/></operator><operator pos:line="242" pos:column="9">!<pos:position pos:line="242" pos:column="10"/></operator><call><name pos:line="242" pos:column="10">SSL_IS_PROXY<pos:position pos:line="242" pos:column="22"/></name><argument_list pos:line="242" pos:column="22">()<pos:position pos:line="242" pos:column="24"/></argument_list></call> <operator pos:line="242" pos:column="25">||<pos:position pos:line="242" pos:column="27"/></operator> <operator pos:line="242" pos:column="28">!<pos:position pos:line="242" pos:column="29"/></operator><name><name pos:line="242" pos:column="29">conn<pos:position pos:line="242" pos:column="33"/></name><operator pos:line="242" pos:column="33">-&gt;<pos:position pos:line="242" pos:column="38"/></operator><name pos:line="242" pos:column="35">bits<pos:position pos:line="242" pos:column="39"/></name><operator pos:line="242" pos:column="39">.<pos:position pos:line="242" pos:column="40"/></operator><name pos:line="242" pos:column="40">tunnel_proxy<pos:position pos:line="242" pos:column="52"/></name></name><operator pos:line="242" pos:column="52">)<pos:position pos:line="242" pos:column="53"/></operator></expr>)<pos:position pos:line="242" pos:column="54"/></condition><then pos:line="242" pos:column="54"> <block pos:line="242" pos:column="55">{
      <expr_stmt><expr><name><name pos:line="243" pos:column="7">protocols<pos:position pos:line="243" pos:column="16"/></name><index pos:line="243" pos:column="16">[<expr><name pos:line="243" pos:column="17">cur<pos:position pos:line="243" pos:column="20"/></name><operator pos:line="243" pos:column="20">++<pos:position pos:line="243" pos:column="22"/></operator></expr>]<pos:position pos:line="243" pos:column="23"/></index></name> <operator pos:line="243" pos:column="24">=<pos:position pos:line="243" pos:column="25"/></operator> <name pos:line="243" pos:column="26">NGHTTP2_PROTO_VERSION_ID_LEN<pos:position pos:line="243" pos:column="54"/></name></expr>;<pos:position pos:line="243" pos:column="55"/></expr_stmt>

      <expr_stmt><expr><call><name pos:line="245" pos:column="7">memcpy<pos:position pos:line="245" pos:column="13"/></name><argument_list pos:line="245" pos:column="13">(<argument><expr><operator pos:line="245" pos:column="14">&amp;<pos:position pos:line="245" pos:column="19"/></operator><name><name pos:line="245" pos:column="15">protocols<pos:position pos:line="245" pos:column="24"/></name><index pos:line="245" pos:column="24">[<expr><name pos:line="245" pos:column="25">cur<pos:position pos:line="245" pos:column="28"/></name></expr>]<pos:position pos:line="245" pos:column="29"/></index></name></expr></argument>, <argument><expr><name pos:line="245" pos:column="31">NGHTTP2_PROTO_VERSION_ID<pos:position pos:line="245" pos:column="55"/></name></expr></argument>,
          <argument><expr><name pos:line="246" pos:column="11">NGHTTP2_PROTO_VERSION_ID_LEN<pos:position pos:line="246" pos:column="39"/></name></expr></argument>)<pos:position pos:line="246" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="246" pos:column="41"/></expr_stmt>
      <expr_stmt><expr><name pos:line="247" pos:column="7">cur<pos:position pos:line="247" pos:column="10"/></name> <operator pos:line="247" pos:column="11">+=<pos:position pos:line="247" pos:column="13"/></operator> <name pos:line="247" pos:column="14">NGHTTP2_PROTO_VERSION_ID_LEN<pos:position pos:line="247" pos:column="42"/></name></expr>;<pos:position pos:line="247" pos:column="43"/></expr_stmt>
      <expr_stmt><expr><call><name pos:line="248" pos:column="7">infof<pos:position pos:line="248" pos:column="12"/></name><argument_list pos:line="248" pos:column="12">(<argument><expr><name pos:line="248" pos:column="13">data<pos:position pos:line="248" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="248" pos:column="19">"ALPN, offering %s\n"<pos:position pos:line="248" pos:column="40"/></literal></expr></argument>, <argument><expr><name pos:line="248" pos:column="42">NGHTTP2_PROTO_VERSION_ID<pos:position pos:line="248" pos:column="66"/></name></expr></argument>)<pos:position pos:line="248" pos:column="67"/></argument_list></call></expr>;<pos:position pos:line="248" pos:column="68"/></expr_stmt>
    }<pos:position pos:line="249" pos:column="6"/></block></then></if>
<cpp:endif pos:line="250" pos:column="1">#<cpp:directive pos:line="250" pos:column="2">endif<pos:position pos:line="250" pos:column="7"/></cpp:directive></cpp:endif>

    <expr_stmt><expr><name><name pos:line="252" pos:column="5">protocols<pos:position pos:line="252" pos:column="14"/></name><index pos:line="252" pos:column="14">[<expr><name pos:line="252" pos:column="15">cur<pos:position pos:line="252" pos:column="18"/></name><operator pos:line="252" pos:column="18">++<pos:position pos:line="252" pos:column="20"/></operator></expr>]<pos:position pos:line="252" pos:column="21"/></index></name> <operator pos:line="252" pos:column="22">=<pos:position pos:line="252" pos:column="23"/></operator> <name pos:line="252" pos:column="24">ALPN_HTTP_1_1_LENGTH<pos:position pos:line="252" pos:column="44"/></name></expr>;<pos:position pos:line="252" pos:column="45"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="253" pos:column="5">memcpy<pos:position pos:line="253" pos:column="11"/></name><argument_list pos:line="253" pos:column="11">(<argument><expr><operator pos:line="253" pos:column="12">&amp;<pos:position pos:line="253" pos:column="17"/></operator><name><name pos:line="253" pos:column="13">protocols<pos:position pos:line="253" pos:column="22"/></name><index pos:line="253" pos:column="22">[<expr><name pos:line="253" pos:column="23">cur<pos:position pos:line="253" pos:column="26"/></name></expr>]<pos:position pos:line="253" pos:column="27"/></index></name></expr></argument>, <argument><expr><name pos:line="253" pos:column="29">ALPN_HTTP_1_1<pos:position pos:line="253" pos:column="42"/></name></expr></argument>, <argument><expr><name pos:line="253" pos:column="44">ALPN_HTTP_1_1_LENGTH<pos:position pos:line="253" pos:column="64"/></name></expr></argument>)<pos:position pos:line="253" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="253" pos:column="66"/></expr_stmt>
    <expr_stmt><expr><name pos:line="254" pos:column="5">cur<pos:position pos:line="254" pos:column="8"/></name> <operator pos:line="254" pos:column="9">+=<pos:position pos:line="254" pos:column="11"/></operator> <name pos:line="254" pos:column="12">ALPN_HTTP_1_1_LENGTH<pos:position pos:line="254" pos:column="32"/></name></expr>;<pos:position pos:line="254" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="255" pos:column="5">infof<pos:position pos:line="255" pos:column="10"/></name><argument_list pos:line="255" pos:column="10">(<argument><expr><name pos:line="255" pos:column="11">data<pos:position pos:line="255" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="255" pos:column="17">"ALPN, offering %s\n"<pos:position pos:line="255" pos:column="38"/></literal></expr></argument>, <argument><expr><name pos:line="255" pos:column="40">ALPN_HTTP_1_1<pos:position pos:line="255" pos:column="53"/></name></expr></argument>)<pos:position pos:line="255" pos:column="54"/></argument_list></call></expr>;<pos:position pos:line="255" pos:column="55"/></expr_stmt>

    <comment type="block" pos:line="257" pos:column="5">/* expects length prefixed preference ordered list of protocols in wire
     * format
     */</comment>
    <expr_stmt><expr><call><name pos:line="260" pos:column="5">SSL_CTX_set_alpn_protos<pos:position pos:line="260" pos:column="28"/></name><argument_list pos:line="260" pos:column="28">(<argument><expr><name><name pos:line="260" pos:column="29">BACKEND<pos:position pos:line="260" pos:column="36"/></name><operator pos:line="260" pos:column="36">-&gt;<pos:position pos:line="260" pos:column="41"/></operator><name pos:line="260" pos:column="38">ctx<pos:position pos:line="260" pos:column="41"/></name></name></expr></argument>, <argument><expr><name pos:line="260" pos:column="43">protocols<pos:position pos:line="260" pos:column="52"/></name></expr></argument>, <argument><expr><name pos:line="260" pos:column="54">cur<pos:position pos:line="260" pos:column="57"/></name></expr></argument>)<pos:position pos:line="260" pos:column="58"/></argument_list></call></expr>;<pos:position pos:line="260" pos:column="59"/></expr_stmt>
  }<pos:position pos:line="261" pos:column="4"/></block></then></if>
<cpp:endif pos:line="262" pos:column="1">#<cpp:directive pos:line="262" pos:column="2">endif<pos:position pos:line="262" pos:column="7"/></cpp:directive></cpp:endif>

  <if pos:line="264" pos:column="3">if<condition pos:line="264" pos:column="5">(<expr><name pos:line="264" pos:column="6">ssl_cert<pos:position pos:line="264" pos:column="14"/></name> <operator pos:line="264" pos:column="15">||<pos:position pos:line="264" pos:column="17"/></operator> <name pos:line="264" pos:column="18">ssl_cert_type<pos:position pos:line="264" pos:column="31"/></name></expr>)<pos:position pos:line="264" pos:column="32"/></condition><then pos:line="264" pos:column="32"> <block pos:line="264" pos:column="33">{
    <if pos:line="265" pos:column="5">if<condition pos:line="265" pos:column="7">(<expr><operator pos:line="265" pos:column="8">!<pos:position pos:line="265" pos:column="9"/></operator><call><name pos:line="265" pos:column="9">cert_stuff<pos:position pos:line="265" pos:column="19"/></name><argument_list pos:line="265" pos:column="19">(<argument><expr><name pos:line="265" pos:column="20">conn<pos:position pos:line="265" pos:column="24"/></name></expr></argument>, <argument><expr><name><name pos:line="265" pos:column="26">BACKEND<pos:position pos:line="265" pos:column="33"/></name><operator pos:line="265" pos:column="33">-&gt;<pos:position pos:line="265" pos:column="38"/></operator><name pos:line="265" pos:column="35">ctx<pos:position pos:line="265" pos:column="38"/></name></name></expr></argument>, <argument><expr><name pos:line="265" pos:column="40">ssl_cert<pos:position pos:line="265" pos:column="48"/></name></expr></argument>, <argument><expr><name pos:line="265" pos:column="50">ssl_cert_type<pos:position pos:line="265" pos:column="63"/></name></expr></argument>,
                   <argument><expr><call><name pos:line="266" pos:column="20">SSL_SET_OPTION<pos:position pos:line="266" pos:column="34"/></name><argument_list pos:line="266" pos:column="34">(<argument><expr><name pos:line="266" pos:column="35">key<pos:position pos:line="266" pos:column="38"/></name></expr></argument>)<pos:position pos:line="266" pos:column="39"/></argument_list></call></expr></argument>, <argument><expr><call><name pos:line="266" pos:column="41">SSL_SET_OPTION<pos:position pos:line="266" pos:column="55"/></name><argument_list pos:line="266" pos:column="55">(<argument><expr><name pos:line="266" pos:column="56">key_type<pos:position pos:line="266" pos:column="64"/></name></expr></argument>)<pos:position pos:line="266" pos:column="65"/></argument_list></call></expr></argument>,
                   <argument><expr><call><name pos:line="267" pos:column="20">SSL_SET_OPTION<pos:position pos:line="267" pos:column="34"/></name><argument_list pos:line="267" pos:column="34">(<argument><expr><name pos:line="267" pos:column="35">key_passwd<pos:position pos:line="267" pos:column="45"/></name></expr></argument>)<pos:position pos:line="267" pos:column="46"/></argument_list></call></expr></argument>)<pos:position pos:line="267" pos:column="47"/></argument_list></call></expr>)<pos:position pos:line="267" pos:column="48"/></condition><then pos:line="267" pos:column="48"> <block pos:line="267" pos:column="49">{
      <comment type="block" pos:line="268" pos:column="7">/* failf() is already done in cert_stuff() */</comment>
      <return pos:line="269" pos:column="7">return <expr><name pos:line="269" pos:column="14">CURLE_SSL_CERTPROBLEM<pos:position pos:line="269" pos:column="35"/></name></expr>;<pos:position pos:line="269" pos:column="36"/></return>
    }<pos:position pos:line="270" pos:column="6"/></block></then></if>
  }<pos:position pos:line="271" pos:column="4"/></block></then></if>

  <expr_stmt><expr><name pos:line="273" pos:column="3">ciphers<pos:position pos:line="273" pos:column="10"/></name> <operator pos:line="273" pos:column="11">=<pos:position pos:line="273" pos:column="12"/></operator> <call><name pos:line="273" pos:column="13">SSL_CONN_CONFIG<pos:position pos:line="273" pos:column="28"/></name><argument_list pos:line="273" pos:column="28">(<argument><expr><name pos:line="273" pos:column="29">cipher_list<pos:position pos:line="273" pos:column="40"/></name></expr></argument>)<pos:position pos:line="273" pos:column="41"/></argument_list></call></expr>;<pos:position pos:line="273" pos:column="42"/></expr_stmt>
  <if pos:line="274" pos:column="3">if<condition pos:line="274" pos:column="5">(<expr><operator pos:line="274" pos:column="6">!<pos:position pos:line="274" pos:column="7"/></operator><name pos:line="274" pos:column="7">ciphers<pos:position pos:line="274" pos:column="14"/></name></expr>)<pos:position pos:line="274" pos:column="15"/></condition><then pos:line="274" pos:column="15">
    <block type="pseudo"><expr_stmt><expr><name pos:line="275" pos:column="5">ciphers<pos:position pos:line="275" pos:column="12"/></name> <operator pos:line="275" pos:column="13">=<pos:position pos:line="275" pos:column="14"/></operator> <operator pos:line="275" pos:column="15">(<pos:position pos:line="275" pos:column="16"/></operator><name pos:line="275" pos:column="16">char<pos:position pos:line="275" pos:column="20"/></name> <operator pos:line="275" pos:column="21">*<pos:position pos:line="275" pos:column="22"/></operator><operator pos:line="275" pos:column="22">)<pos:position pos:line="275" pos:column="23"/></operator><name pos:line="275" pos:column="23">DEFAULT_CIPHER_SELECTION<pos:position pos:line="275" pos:column="47"/></name></expr>;<pos:position pos:line="275" pos:column="48"/></expr_stmt></block></then></if>
  <if pos:line="276" pos:column="3">if<condition pos:line="276" pos:column="5">(<expr><name pos:line="276" pos:column="6">ciphers<pos:position pos:line="276" pos:column="13"/></name></expr>)<pos:position pos:line="276" pos:column="14"/></condition><then pos:line="276" pos:column="14"> <block pos:line="276" pos:column="15">{
    <if pos:line="277" pos:column="5">if<condition pos:line="277" pos:column="7">(<expr><operator pos:line="277" pos:column="8">!<pos:position pos:line="277" pos:column="9"/></operator><call><name pos:line="277" pos:column="9">SSL_CTX_set_cipher_list<pos:position pos:line="277" pos:column="32"/></name><argument_list pos:line="277" pos:column="32">(<argument><expr><name><name pos:line="277" pos:column="33">BACKEND<pos:position pos:line="277" pos:column="40"/></name><operator pos:line="277" pos:column="40">-&gt;<pos:position pos:line="277" pos:column="45"/></operator><name pos:line="277" pos:column="42">ctx<pos:position pos:line="277" pos:column="45"/></name></name></expr></argument>, <argument><expr><name pos:line="277" pos:column="47">ciphers<pos:position pos:line="277" pos:column="54"/></name></expr></argument>)<pos:position pos:line="277" pos:column="55"/></argument_list></call></expr>)<pos:position pos:line="277" pos:column="56"/></condition><then pos:line="277" pos:column="56"> <block pos:line="277" pos:column="57">{
      <expr_stmt><expr><call><name pos:line="278" pos:column="7">failf<pos:position pos:line="278" pos:column="12"/></name><argument_list pos:line="278" pos:column="12">(<argument><expr><name pos:line="278" pos:column="13">data<pos:position pos:line="278" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="278" pos:column="19">"failed setting cipher list: %s"<pos:position pos:line="278" pos:column="51"/></literal></expr></argument>, <argument><expr><name pos:line="278" pos:column="53">ciphers<pos:position pos:line="278" pos:column="60"/></name></expr></argument>)<pos:position pos:line="278" pos:column="61"/></argument_list></call></expr>;<pos:position pos:line="278" pos:column="62"/></expr_stmt>
      <return pos:line="279" pos:column="7">return <expr><name pos:line="279" pos:column="14">CURLE_SSL_CIPHER<pos:position pos:line="279" pos:column="30"/></name></expr>;<pos:position pos:line="279" pos:column="31"/></return>
    }<pos:position pos:line="280" pos:column="6"/></block></then></if>
    <expr_stmt><expr><call><name pos:line="281" pos:column="5">infof<pos:position pos:line="281" pos:column="10"/></name><argument_list pos:line="281" pos:column="10">(<argument><expr><name pos:line="281" pos:column="11">data<pos:position pos:line="281" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="281" pos:column="17">"Cipher selection: %s\n"<pos:position pos:line="281" pos:column="41"/></literal></expr></argument>, <argument><expr><name pos:line="281" pos:column="43">ciphers<pos:position pos:line="281" pos:column="50"/></name></expr></argument>)<pos:position pos:line="281" pos:column="51"/></argument_list></call></expr>;<pos:position pos:line="281" pos:column="52"/></expr_stmt>
  }<pos:position pos:line="282" pos:column="4"/></block></then></if>

<cpp:ifdef pos:line="284" pos:column="1">#<cpp:directive pos:line="284" pos:column="2">ifdef<pos:position pos:line="284" pos:column="7"/></cpp:directive> <name pos:line="284" pos:column="8">USE_TLS_SRP<pos:position pos:line="284" pos:column="19"/></name></cpp:ifdef>
  <if pos:line="285" pos:column="3">if<condition pos:line="285" pos:column="5">(<expr><name pos:line="285" pos:column="6">ssl_authtype<pos:position pos:line="285" pos:column="18"/></name> <operator pos:line="285" pos:column="19">==<pos:position pos:line="285" pos:column="21"/></operator> <name pos:line="285" pos:column="22">CURL_TLSAUTH_SRP<pos:position pos:line="285" pos:column="38"/></name></expr>)<pos:position pos:line="285" pos:column="39"/></condition><then pos:line="285" pos:column="39"> <block pos:line="285" pos:column="40">{
    <decl_stmt><decl><type><name pos:line="286" pos:column="5">char<pos:position pos:line="286" pos:column="9"/></name> <modifier pos:line="286" pos:column="10">*<pos:position pos:line="286" pos:column="11"/></modifier> <specifier pos:line="286" pos:column="12">const<pos:position pos:line="286" pos:column="17"/></specifier></type> <name pos:line="286" pos:column="18">ssl_username<pos:position pos:line="286" pos:column="30"/></name> <init pos:line="286" pos:column="31">= <expr><call><name pos:line="286" pos:column="33">SSL_SET_OPTION<pos:position pos:line="286" pos:column="47"/></name><argument_list pos:line="286" pos:column="47">(<argument><expr><name pos:line="286" pos:column="48">username<pos:position pos:line="286" pos:column="56"/></name></expr></argument>)<pos:position pos:line="286" pos:column="57"/></argument_list></call></expr></init></decl>;<pos:position pos:line="286" pos:column="58"/></decl_stmt>

    <expr_stmt><expr><call><name pos:line="288" pos:column="5">infof<pos:position pos:line="288" pos:column="10"/></name><argument_list pos:line="288" pos:column="10">(<argument><expr><name pos:line="288" pos:column="11">data<pos:position pos:line="288" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="288" pos:column="17">"Using TLS-SRP username: %s\n"<pos:position pos:line="288" pos:column="47"/></literal></expr></argument>, <argument><expr><name pos:line="288" pos:column="49">ssl_username<pos:position pos:line="288" pos:column="61"/></name></expr></argument>)<pos:position pos:line="288" pos:column="62"/></argument_list></call></expr>;<pos:position pos:line="288" pos:column="63"/></expr_stmt>

    <if pos:line="290" pos:column="5">if<condition pos:line="290" pos:column="7">(<expr><operator pos:line="290" pos:column="8">!<pos:position pos:line="290" pos:column="9"/></operator><call><name pos:line="290" pos:column="9">SSL_CTX_set_srp_username<pos:position pos:line="290" pos:column="33"/></name><argument_list pos:line="290" pos:column="33">(<argument><expr><name><name pos:line="290" pos:column="34">BACKEND<pos:position pos:line="290" pos:column="41"/></name><operator pos:line="290" pos:column="41">-&gt;<pos:position pos:line="290" pos:column="46"/></operator><name pos:line="290" pos:column="43">ctx<pos:position pos:line="290" pos:column="46"/></name></name></expr></argument>, <argument><expr><name pos:line="290" pos:column="48">ssl_username<pos:position pos:line="290" pos:column="60"/></name></expr></argument>)<pos:position pos:line="290" pos:column="61"/></argument_list></call></expr>)<pos:position pos:line="290" pos:column="62"/></condition><then pos:line="290" pos:column="62"> <block pos:line="290" pos:column="63">{
      <expr_stmt><expr><call><name pos:line="291" pos:column="7">failf<pos:position pos:line="291" pos:column="12"/></name><argument_list pos:line="291" pos:column="12">(<argument><expr><name pos:line="291" pos:column="13">data<pos:position pos:line="291" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="291" pos:column="19">"Unable to set SRP user name"<pos:position pos:line="291" pos:column="48"/></literal></expr></argument>)<pos:position pos:line="291" pos:column="49"/></argument_list></call></expr>;<pos:position pos:line="291" pos:column="50"/></expr_stmt>
      <return pos:line="292" pos:column="7">return <expr><name pos:line="292" pos:column="14">CURLE_BAD_FUNCTION_ARGUMENT<pos:position pos:line="292" pos:column="41"/></name></expr>;<pos:position pos:line="292" pos:column="42"/></return>
    }<pos:position pos:line="293" pos:column="6"/></block></then></if>
    <if pos:line="294" pos:column="5">if<condition pos:line="294" pos:column="7">(<expr><operator pos:line="294" pos:column="8">!<pos:position pos:line="294" pos:column="9"/></operator><call><name pos:line="294" pos:column="9">SSL_CTX_set_srp_password<pos:position pos:line="294" pos:column="33"/></name><argument_list pos:line="294" pos:column="33">(<argument><expr><name><name pos:line="294" pos:column="34">BACKEND<pos:position pos:line="294" pos:column="41"/></name><operator pos:line="294" pos:column="41">-&gt;<pos:position pos:line="294" pos:column="46"/></operator><name pos:line="294" pos:column="43">ctx<pos:position pos:line="294" pos:column="46"/></name></name></expr></argument>, <argument><expr><call><name pos:line="294" pos:column="48">SSL_SET_OPTION<pos:position pos:line="294" pos:column="62"/></name><argument_list pos:line="294" pos:column="62">(<argument><expr><name pos:line="294" pos:column="63">password<pos:position pos:line="294" pos:column="71"/></name></expr></argument>)<pos:position pos:line="294" pos:column="72"/></argument_list></call></expr></argument>)<pos:position pos:line="294" pos:column="73"/></argument_list></call></expr>)<pos:position pos:line="294" pos:column="74"/></condition><then pos:line="294" pos:column="74"> <block pos:line="294" pos:column="75">{
      <expr_stmt><expr><call><name pos:line="295" pos:column="7">failf<pos:position pos:line="295" pos:column="12"/></name><argument_list pos:line="295" pos:column="12">(<argument><expr><name pos:line="295" pos:column="13">data<pos:position pos:line="295" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="295" pos:column="19">"failed setting SRP password"<pos:position pos:line="295" pos:column="48"/></literal></expr></argument>)<pos:position pos:line="295" pos:column="49"/></argument_list></call></expr>;<pos:position pos:line="295" pos:column="50"/></expr_stmt>
      <return pos:line="296" pos:column="7">return <expr><name pos:line="296" pos:column="14">CURLE_BAD_FUNCTION_ARGUMENT<pos:position pos:line="296" pos:column="41"/></name></expr>;<pos:position pos:line="296" pos:column="42"/></return>
    }<pos:position pos:line="297" pos:column="6"/></block></then></if>
    <if pos:line="298" pos:column="5">if<condition pos:line="298" pos:column="7">(<expr><operator pos:line="298" pos:column="8">!<pos:position pos:line="298" pos:column="9"/></operator><call><name pos:line="298" pos:column="9">SSL_CONN_CONFIG<pos:position pos:line="298" pos:column="24"/></name><argument_list pos:line="298" pos:column="24">(<argument><expr><name pos:line="298" pos:column="25">cipher_list<pos:position pos:line="298" pos:column="36"/></name></expr></argument>)<pos:position pos:line="298" pos:column="37"/></argument_list></call></expr>)<pos:position pos:line="298" pos:column="38"/></condition><then pos:line="298" pos:column="38"> <block pos:line="298" pos:column="39">{
      <expr_stmt><expr><call><name pos:line="299" pos:column="7">infof<pos:position pos:line="299" pos:column="12"/></name><argument_list pos:line="299" pos:column="12">(<argument><expr><name pos:line="299" pos:column="13">data<pos:position pos:line="299" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="299" pos:column="19">"Setting cipher list SRP\n"<pos:position pos:line="299" pos:column="46"/></literal></expr></argument>)<pos:position pos:line="299" pos:column="47"/></argument_list></call></expr>;<pos:position pos:line="299" pos:column="48"/></expr_stmt>

      <if pos:line="301" pos:column="7">if<condition pos:line="301" pos:column="9">(<expr><operator pos:line="301" pos:column="10">!<pos:position pos:line="301" pos:column="11"/></operator><call><name pos:line="301" pos:column="11">SSL_CTX_set_cipher_list<pos:position pos:line="301" pos:column="34"/></name><argument_list pos:line="301" pos:column="34">(<argument><expr><name><name pos:line="301" pos:column="35">BACKEND<pos:position pos:line="301" pos:column="42"/></name><operator pos:line="301" pos:column="42">-&gt;<pos:position pos:line="301" pos:column="47"/></operator><name pos:line="301" pos:column="44">ctx<pos:position pos:line="301" pos:column="47"/></name></name></expr></argument>, <argument><expr><literal type="string" pos:line="301" pos:column="49">"SRP"<pos:position pos:line="301" pos:column="54"/></literal></expr></argument>)<pos:position pos:line="301" pos:column="55"/></argument_list></call></expr>)<pos:position pos:line="301" pos:column="56"/></condition><then pos:line="301" pos:column="56"> <block pos:line="301" pos:column="57">{
        <expr_stmt><expr><call><name pos:line="302" pos:column="9">failf<pos:position pos:line="302" pos:column="14"/></name><argument_list pos:line="302" pos:column="14">(<argument><expr><name pos:line="302" pos:column="15">data<pos:position pos:line="302" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="302" pos:column="21">"failed setting SRP cipher list"<pos:position pos:line="302" pos:column="53"/></literal></expr></argument>)<pos:position pos:line="302" pos:column="54"/></argument_list></call></expr>;<pos:position pos:line="302" pos:column="55"/></expr_stmt>
        <return pos:line="303" pos:column="9">return <expr><name pos:line="303" pos:column="16">CURLE_SSL_CIPHER<pos:position pos:line="303" pos:column="32"/></name></expr>;<pos:position pos:line="303" pos:column="33"/></return>
      }<pos:position pos:line="304" pos:column="8"/></block></then></if>
    }<pos:position pos:line="305" pos:column="6"/></block></then></if>
  }<pos:position pos:line="306" pos:column="4"/></block></then></if>
<cpp:endif pos:line="307" pos:column="1">#<cpp:directive pos:line="307" pos:column="2">endif<pos:position pos:line="307" pos:column="7"/></cpp:directive></cpp:endif>

  <if pos:line="309" pos:column="3">if<condition pos:line="309" pos:column="5">(<expr><name pos:line="309" pos:column="6">ssl_cafile<pos:position pos:line="309" pos:column="16"/></name> <operator pos:line="309" pos:column="17">||<pos:position pos:line="309" pos:column="19"/></operator> <name pos:line="309" pos:column="20">ssl_capath<pos:position pos:line="309" pos:column="30"/></name></expr>)<pos:position pos:line="309" pos:column="31"/></condition><then pos:line="309" pos:column="31"> <block pos:line="309" pos:column="32">{
    <comment type="block" pos:line="310" pos:column="5">/* tell SSL where to find CA certificates that are used to verify
       the servers certificate. */</comment>
    <if pos:line="312" pos:column="5">if<condition pos:line="312" pos:column="7">(<expr><operator pos:line="312" pos:column="8">!<pos:position pos:line="312" pos:column="9"/></operator><call><name pos:line="312" pos:column="9">SSL_CTX_load_verify_locations<pos:position pos:line="312" pos:column="38"/></name><argument_list pos:line="312" pos:column="38">(<argument><expr><name><name pos:line="312" pos:column="39">BACKEND<pos:position pos:line="312" pos:column="46"/></name><operator pos:line="312" pos:column="46">-&gt;<pos:position pos:line="312" pos:column="51"/></operator><name pos:line="312" pos:column="48">ctx<pos:position pos:line="312" pos:column="51"/></name></name></expr></argument>, <argument><expr><name pos:line="312" pos:column="53">ssl_cafile<pos:position pos:line="312" pos:column="63"/></name></expr></argument>, <argument><expr><name pos:line="312" pos:column="65">ssl_capath<pos:position pos:line="312" pos:column="75"/></name></expr></argument>)<pos:position pos:line="312" pos:column="76"/></argument_list></call></expr>)<pos:position pos:line="312" pos:column="77"/></condition><then pos:line="312" pos:column="77"> <block pos:line="312" pos:column="78">{
      <if pos:line="313" pos:column="7">if<condition pos:line="313" pos:column="9">(<expr><name pos:line="313" pos:column="10">verifypeer<pos:position pos:line="313" pos:column="20"/></name></expr>)<pos:position pos:line="313" pos:column="21"/></condition><then pos:line="313" pos:column="21"> <block pos:line="313" pos:column="22">{
        <comment type="block" pos:line="314" pos:column="9">/* Fail if we insist on successfully verifying the server. */</comment>
        <expr_stmt><expr><call><name pos:line="315" pos:column="9">failf<pos:position pos:line="315" pos:column="14"/></name><argument_list pos:line="315" pos:column="14">(<argument><expr><name pos:line="315" pos:column="15">data<pos:position pos:line="315" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="315" pos:column="21">"error setting certificate verify locations:\n"<pos:position pos:line="315" pos:column="68"/></literal>
              <literal type="string" pos:line="316" pos:column="15">"  CAfile: %s\n  CApath: %s"<pos:position pos:line="316" pos:column="43"/></literal></expr></argument>,
              <argument><expr><ternary><condition><expr><name pos:line="317" pos:column="15">ssl_cafile<pos:position pos:line="317" pos:column="25"/></name></expr> ?<pos:position pos:line="317" pos:column="27"/></condition><then pos:line="317" pos:column="27"> <expr><name pos:line="317" pos:column="28">ssl_cafile<pos:position pos:line="317" pos:column="38"/></name></expr> <pos:position pos:line="317" pos:column="39"/></then><else pos:line="317" pos:column="39">: <expr><literal type="string" pos:line="317" pos:column="41">"none"<pos:position pos:line="317" pos:column="47"/></literal></expr></else></ternary></expr></argument>,
              <argument><expr><ternary><condition><expr><name pos:line="318" pos:column="15">ssl_capath<pos:position pos:line="318" pos:column="25"/></name></expr> ?<pos:position pos:line="318" pos:column="27"/></condition><then pos:line="318" pos:column="27"> <expr><name pos:line="318" pos:column="28">ssl_capath<pos:position pos:line="318" pos:column="38"/></name></expr> <pos:position pos:line="318" pos:column="39"/></then><else pos:line="318" pos:column="39">: <expr><literal type="string" pos:line="318" pos:column="41">"none"<pos:position pos:line="318" pos:column="47"/></literal></expr></else></ternary></expr></argument>)<pos:position pos:line="318" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="318" pos:column="49"/></expr_stmt>
        <return pos:line="319" pos:column="9">return <expr><name pos:line="319" pos:column="16">CURLE_SSL_CACERT_BADFILE<pos:position pos:line="319" pos:column="40"/></name></expr>;<pos:position pos:line="319" pos:column="41"/></return>
      }<pos:position pos:line="320" pos:column="8"/></block></then></if>
      <comment type="block" pos:line="321" pos:column="7">/* Just continue with a warning if no strict  certificate verification
         is required. */</comment>
      <expr_stmt><expr><call><name pos:line="323" pos:column="7">infof<pos:position pos:line="323" pos:column="12"/></name><argument_list pos:line="323" pos:column="12">(<argument><expr><name pos:line="323" pos:column="13">data<pos:position pos:line="323" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="323" pos:column="19">"error setting certificate verify locations,"<pos:position pos:line="323" pos:column="64"/></literal>
            <literal type="string" pos:line="324" pos:column="13">" continuing anyway:\n"<pos:position pos:line="324" pos:column="36"/></literal></expr></argument>)<pos:position pos:line="324" pos:column="37"/></argument_list></call></expr>;<pos:position pos:line="324" pos:column="38"/></expr_stmt>
    }<pos:position pos:line="325" pos:column="6"/></block></then>
    <else pos:line="326" pos:column="5">else <block pos:line="326" pos:column="10">{
      <comment type="block" pos:line="327" pos:column="7">/* Everything is fine. */</comment>
      <expr_stmt><expr><call><name pos:line="328" pos:column="7">infof<pos:position pos:line="328" pos:column="12"/></name><argument_list pos:line="328" pos:column="12">(<argument><expr><name pos:line="328" pos:column="13">data<pos:position pos:line="328" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="328" pos:column="19">"successfully set certificate verify locations:\n"<pos:position pos:line="328" pos:column="69"/></literal></expr></argument>)<pos:position pos:line="328" pos:column="70"/></argument_list></call></expr>;<pos:position pos:line="328" pos:column="71"/></expr_stmt>
    }<pos:position pos:line="329" pos:column="6"/></block></else></if>
    <expr_stmt><expr><call><name pos:line="330" pos:column="5">infof<pos:position pos:line="330" pos:column="10"/></name><argument_list pos:line="330" pos:column="10">(<argument><expr><name pos:line="330" pos:column="11">data<pos:position pos:line="330" pos:column="15"/></name></expr></argument>,
          <argument><expr><literal type="string" pos:line="331" pos:column="11">"  CAfile: %s\n"<pos:position pos:line="331" pos:column="27"/></literal>
          <literal type="string" pos:line="332" pos:column="11">"  CApath: %s\n"<pos:position pos:line="332" pos:column="27"/></literal></expr></argument>,
          <argument><expr><ternary><condition><expr><name pos:line="333" pos:column="11">ssl_cafile<pos:position pos:line="333" pos:column="21"/></name></expr> ?<pos:position pos:line="333" pos:column="23"/></condition><then pos:line="333" pos:column="23"> <expr><name pos:line="333" pos:column="24">ssl_cafile<pos:position pos:line="333" pos:column="34"/></name></expr> <pos:position pos:line="333" pos:column="35"/></then><else pos:line="333" pos:column="35">: <expr><literal type="string" pos:line="333" pos:column="37">"none"<pos:position pos:line="333" pos:column="43"/></literal></expr></else></ternary></expr></argument>,
          <argument><expr><ternary><condition><expr><name pos:line="334" pos:column="11">ssl_capath<pos:position pos:line="334" pos:column="21"/></name></expr> ?<pos:position pos:line="334" pos:column="23"/></condition><then pos:line="334" pos:column="23"> <expr><name pos:line="334" pos:column="24">ssl_capath<pos:position pos:line="334" pos:column="34"/></name></expr> <pos:position pos:line="334" pos:column="35"/></then><else pos:line="334" pos:column="35">: <expr><literal type="string" pos:line="334" pos:column="37">"none"<pos:position pos:line="334" pos:column="43"/></literal></expr></else></ternary></expr></argument>)<pos:position pos:line="334" pos:column="44"/></argument_list></call></expr>;<pos:position pos:line="334" pos:column="45"/></expr_stmt>
  }<pos:position pos:line="335" pos:column="4"/></block></then>
<cpp:ifdef pos:line="336" pos:column="1">#<cpp:directive pos:line="336" pos:column="2">ifdef<pos:position pos:line="336" pos:column="7"/></cpp:directive> <name pos:line="336" pos:column="8">CURL_CA_FALLBACK<pos:position pos:line="336" pos:column="24"/></name></cpp:ifdef>
  <elseif pos:line="337" pos:column="3">else <if pos:line="337" pos:column="8">if<condition pos:line="337" pos:column="10">(<expr><name pos:line="337" pos:column="11">verifypeer<pos:position pos:line="337" pos:column="21"/></name></expr>)<pos:position pos:line="337" pos:column="22"/></condition><then pos:line="337" pos:column="22"> <block pos:line="337" pos:column="23">{
    <comment type="block" pos:line="338" pos:column="5">/* verfying the peer without any CA certificates won't
       work so use openssl's built in default as fallback */</comment>
    <expr_stmt><expr><call><name pos:line="340" pos:column="5">SSL_CTX_set_default_verify_paths<pos:position pos:line="340" pos:column="37"/></name><argument_list pos:line="340" pos:column="37">(<argument><expr><name><name pos:line="340" pos:column="38">BACKEND<pos:position pos:line="340" pos:column="45"/></name><operator pos:line="340" pos:column="45">-&gt;<pos:position pos:line="340" pos:column="50"/></operator><name pos:line="340" pos:column="47">ctx<pos:position pos:line="340" pos:column="50"/></name></name></expr></argument>)<pos:position pos:line="340" pos:column="51"/></argument_list></call></expr>;<pos:position pos:line="340" pos:column="52"/></expr_stmt>
  }<pos:position pos:line="341" pos:column="4"/></block></then></if></elseif></if>
<cpp:endif pos:line="342" pos:column="1">#<cpp:directive pos:line="342" pos:column="2">endif<pos:position pos:line="342" pos:column="7"/></cpp:directive></cpp:endif>

  <if pos:line="344" pos:column="3">if<condition pos:line="344" pos:column="5">(<expr><name pos:line="344" pos:column="6">ssl_crlfile<pos:position pos:line="344" pos:column="17"/></name></expr>)<pos:position pos:line="344" pos:column="18"/></condition><then pos:line="344" pos:column="18"> <block pos:line="344" pos:column="19">{
    <comment type="block" pos:line="345" pos:column="5">/* tell SSL where to find CRL file that is used to check certificate
     * revocation */</comment>
    <expr_stmt><expr><name pos:line="347" pos:column="5">lookup<pos:position pos:line="347" pos:column="11"/></name> <operator pos:line="347" pos:column="12">=<pos:position pos:line="347" pos:column="13"/></operator> <call><name pos:line="347" pos:column="14">X509_STORE_add_lookup<pos:position pos:line="347" pos:column="35"/></name><argument_list pos:line="347" pos:column="35">(<argument><expr><call><name pos:line="347" pos:column="36">SSL_CTX_get_cert_store<pos:position pos:line="347" pos:column="58"/></name><argument_list pos:line="347" pos:column="58">(<argument><expr><name><name pos:line="347" pos:column="59">BACKEND<pos:position pos:line="347" pos:column="66"/></name><operator pos:line="347" pos:column="66">-&gt;<pos:position pos:line="347" pos:column="71"/></operator><name pos:line="347" pos:column="68">ctx<pos:position pos:line="347" pos:column="71"/></name></name></expr></argument>)<pos:position pos:line="347" pos:column="72"/></argument_list></call></expr></argument>,
                                 <argument><expr><call><name pos:line="348" pos:column="34">X509_LOOKUP_file<pos:position pos:line="348" pos:column="50"/></name><argument_list pos:line="348" pos:column="50">()<pos:position pos:line="348" pos:column="52"/></argument_list></call></expr></argument>)<pos:position pos:line="348" pos:column="53"/></argument_list></call></expr>;<pos:position pos:line="348" pos:column="54"/></expr_stmt>
    <if pos:line="349" pos:column="5">if<condition pos:line="349" pos:column="7">(<expr><operator pos:line="349" pos:column="8">!<pos:position pos:line="349" pos:column="9"/></operator><name pos:line="349" pos:column="9">lookup<pos:position pos:line="349" pos:column="15"/></name> <operator pos:line="349" pos:column="16">||<pos:position pos:line="349" pos:column="18"/></operator>
       <operator pos:line="350" pos:column="8">(<pos:position pos:line="350" pos:column="9"/></operator><operator pos:line="350" pos:column="9">!<pos:position pos:line="350" pos:column="10"/></operator><call><name pos:line="350" pos:column="10">X509_load_crl_file<pos:position pos:line="350" pos:column="28"/></name><argument_list pos:line="350" pos:column="28">(<argument><expr><name pos:line="350" pos:column="29">lookup<pos:position pos:line="350" pos:column="35"/></name></expr></argument>, <argument><expr><name pos:line="350" pos:column="37">ssl_crlfile<pos:position pos:line="350" pos:column="48"/></name></expr></argument>, <argument><expr><name pos:line="350" pos:column="50">X509_FILETYPE_PEM<pos:position pos:line="350" pos:column="67"/></name></expr></argument>)<pos:position pos:line="350" pos:column="68"/></argument_list></call><operator pos:line="350" pos:column="68">)<pos:position pos:line="350" pos:column="69"/></operator></expr> )<pos:position pos:line="350" pos:column="71"/></condition><then pos:line="350" pos:column="71"> <block pos:line="350" pos:column="72">{
      <expr_stmt><expr><call><name pos:line="351" pos:column="7">failf<pos:position pos:line="351" pos:column="12"/></name><argument_list pos:line="351" pos:column="12">(<argument><expr><name pos:line="351" pos:column="13">data<pos:position pos:line="351" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="351" pos:column="19">"error loading CRL file: %s"<pos:position pos:line="351" pos:column="47"/></literal></expr></argument>, <argument><expr><name pos:line="351" pos:column="49">ssl_crlfile<pos:position pos:line="351" pos:column="60"/></name></expr></argument>)<pos:position pos:line="351" pos:column="61"/></argument_list></call></expr>;<pos:position pos:line="351" pos:column="62"/></expr_stmt>
      <return pos:line="352" pos:column="7">return <expr><name pos:line="352" pos:column="14">CURLE_SSL_CRL_BADFILE<pos:position pos:line="352" pos:column="35"/></name></expr>;<pos:position pos:line="352" pos:column="36"/></return>
    }<pos:position pos:line="353" pos:column="6"/></block></then></if>
    <comment type="block" pos:line="354" pos:column="5">/* Everything is fine. */</comment>
    <expr_stmt><expr><call><name pos:line="355" pos:column="5">infof<pos:position pos:line="355" pos:column="10"/></name><argument_list pos:line="355" pos:column="10">(<argument><expr><name pos:line="355" pos:column="11">data<pos:position pos:line="355" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="355" pos:column="17">"successfully load CRL file:\n"<pos:position pos:line="355" pos:column="48"/></literal></expr></argument>)<pos:position pos:line="355" pos:column="49"/></argument_list></call></expr>;<pos:position pos:line="355" pos:column="50"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="356" pos:column="5">X509_STORE_set_flags<pos:position pos:line="356" pos:column="25"/></name><argument_list pos:line="356" pos:column="25">(<argument><expr><call><name pos:line="356" pos:column="26">SSL_CTX_get_cert_store<pos:position pos:line="356" pos:column="48"/></name><argument_list pos:line="356" pos:column="48">(<argument><expr><name><name pos:line="356" pos:column="49">BACKEND<pos:position pos:line="356" pos:column="56"/></name><operator pos:line="356" pos:column="56">-&gt;<pos:position pos:line="356" pos:column="61"/></operator><name pos:line="356" pos:column="58">ctx<pos:position pos:line="356" pos:column="61"/></name></name></expr></argument>)<pos:position pos:line="356" pos:column="62"/></argument_list></call></expr></argument>,
                         <argument><expr><name pos:line="357" pos:column="26">X509_V_FLAG_CRL_CHECK<pos:position pos:line="357" pos:column="47"/></name><operator pos:line="357" pos:column="47">|<pos:position pos:line="357" pos:column="48"/></operator><name pos:line="357" pos:column="48">X509_V_FLAG_CRL_CHECK_ALL<pos:position pos:line="357" pos:column="73"/></name></expr></argument>)<pos:position pos:line="357" pos:column="74"/></argument_list></call></expr>;<pos:position pos:line="357" pos:column="75"/></expr_stmt>

    <expr_stmt><expr><call><name pos:line="359" pos:column="5">infof<pos:position pos:line="359" pos:column="10"/></name><argument_list pos:line="359" pos:column="10">(<argument><expr><name pos:line="359" pos:column="11">data<pos:position pos:line="359" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="359" pos:column="17">"  CRLfile: %s\n"<pos:position pos:line="359" pos:column="34"/></literal></expr></argument>, <argument><expr><name pos:line="359" pos:column="36">ssl_crlfile<pos:position pos:line="359" pos:column="47"/></name></expr></argument>)<pos:position pos:line="359" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="359" pos:column="49"/></expr_stmt>
  }<pos:position pos:line="360" pos:column="4"/></block></then></if>

  <comment type="block" pos:line="362" pos:column="3">/* Try building a chain using issuers in the trusted store first to avoid
  problems with server-sent legacy intermediates.
  Newer versions of OpenSSL do alternate chain checking by default which
  gives us the same fix without as much of a performance hit (slight), so we
  prefer that if available.
  https://rt.openssl.org/Ticket/Display.html?id=3621&amp;user=guest&amp;pass=guest
  */</comment>
<cpp:if pos:line="369" pos:column="1">#<cpp:directive pos:line="369" pos:column="2">if<pos:position pos:line="369" pos:column="4"/></cpp:directive> <expr><call><name pos:line="369" pos:column="5">defined<pos:position pos:line="369" pos:column="12"/></name><argument_list pos:line="369" pos:column="12">(<argument><expr><name pos:line="369" pos:column="13">X509_V_FLAG_TRUSTED_FIRST<pos:position pos:line="369" pos:column="38"/></name></expr></argument>)<pos:position pos:line="369" pos:column="39"/></argument_list></call> <operator pos:line="369" pos:column="40">&amp;&amp;<pos:position pos:line="369" pos:column="50"/></operator> <operator pos:line="369" pos:column="43">!<pos:position pos:line="369" pos:column="44"/></operator><call><name pos:line="369" pos:column="44">defined<pos:position pos:line="369" pos:column="51"/></name><argument_list pos:line="369" pos:column="51">(<argument><expr><name pos:line="369" pos:column="52">X509_V_FLAG_NO_ALT_CHAINS<pos:position pos:line="369" pos:column="77"/></name></expr></argument>)<pos:position pos:line="369" pos:column="78"/></argument_list></call></expr></cpp:if>
  <if pos:line="370" pos:column="3">if<condition pos:line="370" pos:column="5">(<expr><name pos:line="370" pos:column="6">verifypeer<pos:position pos:line="370" pos:column="16"/></name></expr>)<pos:position pos:line="370" pos:column="17"/></condition><then pos:line="370" pos:column="17"> <block pos:line="370" pos:column="18">{
    <expr_stmt><expr><call><name pos:line="371" pos:column="5">X509_STORE_set_flags<pos:position pos:line="371" pos:column="25"/></name><argument_list pos:line="371" pos:column="25">(<argument><expr><call><name pos:line="371" pos:column="26">SSL_CTX_get_cert_store<pos:position pos:line="371" pos:column="48"/></name><argument_list pos:line="371" pos:column="48">(<argument><expr><name><name pos:line="371" pos:column="49">BACKEND<pos:position pos:line="371" pos:column="56"/></name><operator pos:line="371" pos:column="56">-&gt;<pos:position pos:line="371" pos:column="61"/></operator><name pos:line="371" pos:column="58">ctx<pos:position pos:line="371" pos:column="61"/></name></name></expr></argument>)<pos:position pos:line="371" pos:column="62"/></argument_list></call></expr></argument>,
                         <argument><expr><name pos:line="372" pos:column="26">X509_V_FLAG_TRUSTED_FIRST<pos:position pos:line="372" pos:column="51"/></name></expr></argument>)<pos:position pos:line="372" pos:column="52"/></argument_list></call></expr>;<pos:position pos:line="372" pos:column="53"/></expr_stmt>
  }<pos:position pos:line="373" pos:column="4"/></block></then></if>
<cpp:endif pos:line="374" pos:column="1">#<cpp:directive pos:line="374" pos:column="2">endif<pos:position pos:line="374" pos:column="7"/></cpp:directive></cpp:endif>

  <comment type="block" pos:line="376" pos:column="3">/* SSL always tries to verify the peer, this only says whether it should
   * fail to connect if the verification fails, or if it should continue
   * anyway. In the latter case the result of the verification is checked with
   * SSL_get_verify_result() below. */</comment>
  <expr_stmt><expr><call><name pos:line="380" pos:column="3">SSL_CTX_set_verify<pos:position pos:line="380" pos:column="21"/></name><argument_list pos:line="380" pos:column="21">(<argument><expr><name><name pos:line="380" pos:column="22">BACKEND<pos:position pos:line="380" pos:column="29"/></name><operator pos:line="380" pos:column="29">-&gt;<pos:position pos:line="380" pos:column="34"/></operator><name pos:line="380" pos:column="31">ctx<pos:position pos:line="380" pos:column="34"/></name></name></expr></argument>,
                     <argument><expr><ternary><condition><expr><name pos:line="381" pos:column="22">verifypeer<pos:position pos:line="381" pos:column="32"/></name></expr> ?<pos:position pos:line="381" pos:column="34"/></condition><then pos:line="381" pos:column="34"> <expr><name pos:line="381" pos:column="35">SSL_VERIFY_PEER<pos:position pos:line="381" pos:column="50"/></name></expr> <pos:position pos:line="381" pos:column="51"/></then><else pos:line="381" pos:column="51">: <expr><name pos:line="381" pos:column="53">SSL_VERIFY_NONE<pos:position pos:line="381" pos:column="68"/></name></expr></else></ternary></expr></argument>, <argument><expr><name pos:line="381" pos:column="70">NULL<pos:position pos:line="381" pos:column="74"/></name></expr></argument>)<pos:position pos:line="381" pos:column="75"/></argument_list></call></expr>;<pos:position pos:line="381" pos:column="76"/></expr_stmt>

  <comment type="block" pos:line="383" pos:column="3">/* Enable logging of secrets to the file specified in env SSLKEYLOGFILE. */</comment>
<cpp:if pos:line="384" pos:column="1">#<cpp:directive pos:line="384" pos:column="2">if<pos:position pos:line="384" pos:column="4"/></cpp:directive> <expr><call><name pos:line="384" pos:column="5">defined<pos:position pos:line="384" pos:column="12"/></name><argument_list pos:line="384" pos:column="12">(<argument><expr><name pos:line="384" pos:column="13">ENABLE_SSLKEYLOGFILE<pos:position pos:line="384" pos:column="33"/></name></expr></argument>)<pos:position pos:line="384" pos:column="34"/></argument_list></call> <operator pos:line="384" pos:column="35">&amp;&amp;<pos:position pos:line="384" pos:column="45"/></operator> <call><name pos:line="384" pos:column="38">defined<pos:position pos:line="384" pos:column="45"/></name><argument_list pos:line="384" pos:column="45">(<argument><expr><name pos:line="384" pos:column="46">HAVE_KEYLOG_CALLBACK<pos:position pos:line="384" pos:column="66"/></name></expr></argument>)<pos:position pos:line="384" pos:column="67"/></argument_list></call></expr></cpp:if>
  <if pos:line="385" pos:column="3">if<condition pos:line="385" pos:column="5">(<expr><name pos:line="385" pos:column="6">keylog_file<pos:position pos:line="385" pos:column="17"/></name></expr>)<pos:position pos:line="385" pos:column="18"/></condition><then pos:line="385" pos:column="18"> <block pos:line="385" pos:column="19">{
    <expr_stmt><expr><call><name pos:line="386" pos:column="5">SSL_CTX_set_keylog_callback<pos:position pos:line="386" pos:column="32"/></name><argument_list pos:line="386" pos:column="32">(<argument><expr><name><name pos:line="386" pos:column="33">connssl<pos:position pos:line="386" pos:column="40"/></name><operator pos:line="386" pos:column="40">-&gt;<pos:position pos:line="386" pos:column="45"/></operator><name pos:line="386" pos:column="42">ctx<pos:position pos:line="386" pos:column="45"/></name></name></expr></argument>, <argument><expr><name pos:line="386" pos:column="47">ossl_keylog_callback<pos:position pos:line="386" pos:column="67"/></name></expr></argument>)<pos:position pos:line="386" pos:column="68"/></argument_list></call></expr>;<pos:position pos:line="386" pos:column="69"/></expr_stmt>
  }<pos:position pos:line="387" pos:column="4"/></block></then></if>
<cpp:endif pos:line="388" pos:column="1">#<cpp:directive pos:line="388" pos:column="2">endif<pos:position pos:line="388" pos:column="7"/></cpp:directive></cpp:endif>

  <comment type="block" pos:line="390" pos:column="3">/* give application a chance to interfere with SSL set up. */</comment>
  <if pos:line="391" pos:column="3">if<condition pos:line="391" pos:column="5">(<expr><name><name pos:line="391" pos:column="6">data<pos:position pos:line="391" pos:column="10"/></name><operator pos:line="391" pos:column="10">-&gt;<pos:position pos:line="391" pos:column="15"/></operator><name pos:line="391" pos:column="12">set<pos:position pos:line="391" pos:column="15"/></name><operator pos:line="391" pos:column="15">.<pos:position pos:line="391" pos:column="16"/></operator><name pos:line="391" pos:column="16">ssl<pos:position pos:line="391" pos:column="19"/></name><operator pos:line="391" pos:column="19">.<pos:position pos:line="391" pos:column="20"/></operator><name pos:line="391" pos:column="20">fsslctx<pos:position pos:line="391" pos:column="27"/></name></name></expr>)<pos:position pos:line="391" pos:column="28"/></condition><then pos:line="391" pos:column="28"> <block pos:line="391" pos:column="29">{
    <expr_stmt><expr><name pos:line="392" pos:column="5">result<pos:position pos:line="392" pos:column="11"/></name> <operator pos:line="392" pos:column="12">=<pos:position pos:line="392" pos:column="13"/></operator> <call pos:line="392" pos:column="14">(<modifier pos:line="392" pos:column="15">*<pos:position pos:line="392" pos:column="16"/></modifier><name><name pos:line="392" pos:column="16">data<pos:position pos:line="392" pos:column="20"/></name><operator pos:line="392" pos:column="20">-&gt;<pos:position pos:line="392" pos:column="25"/></operator><name pos:line="392" pos:column="22">set<pos:position pos:line="392" pos:column="25"/></name><operator pos:line="392" pos:column="25">.<pos:position pos:line="392" pos:column="26"/></operator><name pos:line="392" pos:column="26">ssl<pos:position pos:line="392" pos:column="29"/></name><operator pos:line="392" pos:column="29">.<pos:position pos:line="392" pos:column="30"/></operator><name pos:line="392" pos:column="30">fsslctx<pos:position pos:line="392" pos:column="37"/></name></name>)<argument_list pos:line="392" pos:column="38">(<argument><expr><name pos:line="392" pos:column="39">data<pos:position pos:line="392" pos:column="43"/></name></expr></argument>, <argument><expr><name><name pos:line="392" pos:column="45">BACKEND<pos:position pos:line="392" pos:column="52"/></name><operator pos:line="392" pos:column="52">-&gt;<pos:position pos:line="392" pos:column="57"/></operator><name pos:line="392" pos:column="54">ctx<pos:position pos:line="392" pos:column="57"/></name></name></expr></argument>,
                                      <argument><expr><name><name pos:line="393" pos:column="39">data<pos:position pos:line="393" pos:column="43"/></name><operator pos:line="393" pos:column="43">-&gt;<pos:position pos:line="393" pos:column="48"/></operator><name pos:line="393" pos:column="45">set<pos:position pos:line="393" pos:column="48"/></name><operator pos:line="393" pos:column="48">.<pos:position pos:line="393" pos:column="49"/></operator><name pos:line="393" pos:column="49">ssl<pos:position pos:line="393" pos:column="52"/></name><operator pos:line="393" pos:column="52">.<pos:position pos:line="393" pos:column="53"/></operator><name pos:line="393" pos:column="53">fsslctxp<pos:position pos:line="393" pos:column="61"/></name></name></expr></argument>)<pos:position pos:line="393" pos:column="62"/></argument_list></call></expr>;<pos:position pos:line="393" pos:column="63"/></expr_stmt>
    <if pos:line="394" pos:column="5">if<condition pos:line="394" pos:column="7">(<expr><name pos:line="394" pos:column="8">result<pos:position pos:line="394" pos:column="14"/></name></expr>)<pos:position pos:line="394" pos:column="15"/></condition><then pos:line="394" pos:column="15"> <block pos:line="394" pos:column="16">{
      <expr_stmt><expr><call><name pos:line="395" pos:column="7">failf<pos:position pos:line="395" pos:column="12"/></name><argument_list pos:line="395" pos:column="12">(<argument><expr><name pos:line="395" pos:column="13">data<pos:position pos:line="395" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="395" pos:column="19">"error signaled by ssl ctx callback"<pos:position pos:line="395" pos:column="55"/></literal></expr></argument>)<pos:position pos:line="395" pos:column="56"/></argument_list></call></expr>;<pos:position pos:line="395" pos:column="57"/></expr_stmt>
      <return pos:line="396" pos:column="7">return <expr><name pos:line="396" pos:column="14">result<pos:position pos:line="396" pos:column="20"/></name></expr>;<pos:position pos:line="396" pos:column="21"/></return>
    }<pos:position pos:line="397" pos:column="6"/></block></then></if>
  }<pos:position pos:line="398" pos:column="4"/></block></then></if>

  <comment type="block" pos:line="400" pos:column="3">/* Lets make an SSL structure */</comment>
  <if pos:line="401" pos:column="3">if<condition pos:line="401" pos:column="5">(<expr><name><name pos:line="401" pos:column="6">BACKEND<pos:position pos:line="401" pos:column="13"/></name><operator pos:line="401" pos:column="13">-&gt;<pos:position pos:line="401" pos:column="18"/></operator><name pos:line="401" pos:column="15">handle<pos:position pos:line="401" pos:column="21"/></name></name></expr>)<pos:position pos:line="401" pos:column="22"/></condition><then pos:line="401" pos:column="22">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="402" pos:column="5">SSL_free<pos:position pos:line="402" pos:column="13"/></name><argument_list pos:line="402" pos:column="13">(<argument><expr><name><name pos:line="402" pos:column="14">BACKEND<pos:position pos:line="402" pos:column="21"/></name><operator pos:line="402" pos:column="21">-&gt;<pos:position pos:line="402" pos:column="26"/></operator><name pos:line="402" pos:column="23">handle<pos:position pos:line="402" pos:column="29"/></name></name></expr></argument>)<pos:position pos:line="402" pos:column="30"/></argument_list></call></expr>;<pos:position pos:line="402" pos:column="31"/></expr_stmt></block></then></if>
  <expr_stmt><expr><name><name pos:line="403" pos:column="3">BACKEND<pos:position pos:line="403" pos:column="10"/></name><operator pos:line="403" pos:column="10">-&gt;<pos:position pos:line="403" pos:column="15"/></operator><name pos:line="403" pos:column="12">handle<pos:position pos:line="403" pos:column="18"/></name></name> <operator pos:line="403" pos:column="19">=<pos:position pos:line="403" pos:column="20"/></operator> <call><name pos:line="403" pos:column="21">SSL_new<pos:position pos:line="403" pos:column="28"/></name><argument_list pos:line="403" pos:column="28">(<argument><expr><name><name pos:line="403" pos:column="29">BACKEND<pos:position pos:line="403" pos:column="36"/></name><operator pos:line="403" pos:column="36">-&gt;<pos:position pos:line="403" pos:column="41"/></operator><name pos:line="403" pos:column="38">ctx<pos:position pos:line="403" pos:column="41"/></name></name></expr></argument>)<pos:position pos:line="403" pos:column="42"/></argument_list></call></expr>;<pos:position pos:line="403" pos:column="43"/></expr_stmt>
  <if pos:line="404" pos:column="3">if<condition pos:line="404" pos:column="5">(<expr><operator pos:line="404" pos:column="6">!<pos:position pos:line="404" pos:column="7"/></operator><name><name pos:line="404" pos:column="7">BACKEND<pos:position pos:line="404" pos:column="14"/></name><operator pos:line="404" pos:column="14">-&gt;<pos:position pos:line="404" pos:column="19"/></operator><name pos:line="404" pos:column="16">handle<pos:position pos:line="404" pos:column="22"/></name></name></expr>)<pos:position pos:line="404" pos:column="23"/></condition><then pos:line="404" pos:column="23"> <block pos:line="404" pos:column="24">{
    <expr_stmt><expr><call><name pos:line="405" pos:column="5">failf<pos:position pos:line="405" pos:column="10"/></name><argument_list pos:line="405" pos:column="10">(<argument><expr><name pos:line="405" pos:column="11">data<pos:position pos:line="405" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="405" pos:column="17">"SSL: couldn't create a context (handle)!"<pos:position pos:line="405" pos:column="59"/></literal></expr></argument>)<pos:position pos:line="405" pos:column="60"/></argument_list></call></expr>;<pos:position pos:line="405" pos:column="61"/></expr_stmt>
    <return pos:line="406" pos:column="5">return <expr><name pos:line="406" pos:column="12">CURLE_OUT_OF_MEMORY<pos:position pos:line="406" pos:column="31"/></name></expr>;<pos:position pos:line="406" pos:column="32"/></return>
  }<pos:position pos:line="407" pos:column="4"/></block></then></if>

<cpp:if pos:line="409" pos:column="1">#<cpp:directive pos:line="409" pos:column="2">if<pos:position pos:line="409" pos:column="4"/></cpp:directive> <expr><operator pos:line="409" pos:column="5">(<pos:position pos:line="409" pos:column="6"/></operator><name pos:line="409" pos:column="6">OPENSSL_VERSION_NUMBER<pos:position pos:line="409" pos:column="28"/></name> <operator pos:line="409" pos:column="29">&gt;=<pos:position pos:line="409" pos:column="34"/></operator> <literal type="number" pos:line="409" pos:column="32">0x0090808fL<pos:position pos:line="409" pos:column="43"/></literal><operator pos:line="409" pos:column="43">)<pos:position pos:line="409" pos:column="44"/></operator> <operator pos:line="409" pos:column="45">&amp;&amp;<pos:position pos:line="409" pos:column="55"/></operator> <operator pos:line="409" pos:column="48">!<pos:position pos:line="409" pos:column="49"/></operator><call><name pos:line="409" pos:column="49">defined<pos:position pos:line="409" pos:column="56"/></name><argument_list pos:line="409" pos:column="56">(<argument><expr><name pos:line="409" pos:column="57">OPENSSL_NO_TLSEXT<pos:position pos:line="409" pos:column="74"/></name></expr></argument>)<pos:position pos:line="409" pos:column="75"/></argument_list></call> <operator pos:line="409" pos:column="76">&amp;&amp;<pos:position pos:line="409" pos:column="86"/></operator> \
    <operator pos:line="410" pos:column="5">!<pos:position pos:line="410" pos:column="6"/></operator><call><name pos:line="410" pos:column="6">defined<pos:position pos:line="410" pos:column="13"/></name><argument_list pos:line="410" pos:column="13">(<argument><expr><name pos:line="410" pos:column="14">OPENSSL_NO_OCSP<pos:position pos:line="410" pos:column="29"/></name></expr></argument>)<pos:position pos:line="410" pos:column="30"/></argument_list></call></expr></cpp:if>
  <if pos:line="411" pos:column="3">if<condition pos:line="411" pos:column="5">(<expr><call><name pos:line="411" pos:column="6">SSL_CONN_CONFIG<pos:position pos:line="411" pos:column="21"/></name><argument_list pos:line="411" pos:column="21">(<argument><expr><name pos:line="411" pos:column="22">verifystatus<pos:position pos:line="411" pos:column="34"/></name></expr></argument>)<pos:position pos:line="411" pos:column="35"/></argument_list></call></expr>)<pos:position pos:line="411" pos:column="36"/></condition><then pos:line="411" pos:column="36">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="412" pos:column="5">SSL_set_tlsext_status_type<pos:position pos:line="412" pos:column="31"/></name><argument_list pos:line="412" pos:column="31">(<argument><expr><name><name pos:line="412" pos:column="32">BACKEND<pos:position pos:line="412" pos:column="39"/></name><operator pos:line="412" pos:column="39">-&gt;<pos:position pos:line="412" pos:column="44"/></operator><name pos:line="412" pos:column="41">handle<pos:position pos:line="412" pos:column="47"/></name></name></expr></argument>, <argument><expr><name pos:line="412" pos:column="49">TLSEXT_STATUSTYPE_ocsp<pos:position pos:line="412" pos:column="71"/></name></expr></argument>)<pos:position pos:line="412" pos:column="72"/></argument_list></call></expr>;<pos:position pos:line="412" pos:column="73"/></expr_stmt></block></then></if>
<cpp:endif pos:line="413" pos:column="1">#<cpp:directive pos:line="413" pos:column="2">endif<pos:position pos:line="413" pos:column="7"/></cpp:directive></cpp:endif>

  <expr_stmt><expr><call><name pos:line="415" pos:column="3">SSL_set_connect_state<pos:position pos:line="415" pos:column="24"/></name><argument_list pos:line="415" pos:column="24">(<argument><expr><name><name pos:line="415" pos:column="25">BACKEND<pos:position pos:line="415" pos:column="32"/></name><operator pos:line="415" pos:column="32">-&gt;<pos:position pos:line="415" pos:column="37"/></operator><name pos:line="415" pos:column="34">handle<pos:position pos:line="415" pos:column="40"/></name></name></expr></argument>)<pos:position pos:line="415" pos:column="41"/></argument_list></call></expr>;<pos:position pos:line="415" pos:column="42"/></expr_stmt>

  <expr_stmt><expr><name><name pos:line="417" pos:column="3">BACKEND<pos:position pos:line="417" pos:column="10"/></name><operator pos:line="417" pos:column="10">-&gt;<pos:position pos:line="417" pos:column="15"/></operator><name pos:line="417" pos:column="12">server_cert<pos:position pos:line="417" pos:column="23"/></name></name> <operator pos:line="417" pos:column="24">=<pos:position pos:line="417" pos:column="25"/></operator> <literal type="number" pos:line="417" pos:column="26">0x0<pos:position pos:line="417" pos:column="29"/></literal></expr>;<pos:position pos:line="417" pos:column="30"/></expr_stmt>
<cpp:ifdef pos:line="418" pos:column="1">#<cpp:directive pos:line="418" pos:column="2">ifdef<pos:position pos:line="418" pos:column="7"/></cpp:directive> <name pos:line="418" pos:column="8">SSL_CTRL_SET_TLSEXT_HOSTNAME<pos:position pos:line="418" pos:column="36"/></name></cpp:ifdef>
  <if pos:line="419" pos:column="3">if<condition pos:line="419" pos:column="5">(<expr><operator pos:line="419" pos:column="6">(<pos:position pos:line="419" pos:column="7"/></operator><literal type="number" pos:line="419" pos:column="7">0<pos:position pos:line="419" pos:column="8"/></literal> <operator pos:line="419" pos:column="9">==<pos:position pos:line="419" pos:column="11"/></operator> <call><name pos:line="419" pos:column="12">Curl_inet_pton<pos:position pos:line="419" pos:column="26"/></name><argument_list pos:line="419" pos:column="26">(<argument><expr><name pos:line="419" pos:column="27">AF_INET<pos:position pos:line="419" pos:column="34"/></name></expr></argument>, <argument><expr><name pos:line="419" pos:column="36">hostname<pos:position pos:line="419" pos:column="44"/></name></expr></argument>, <argument><expr><operator pos:line="419" pos:column="46">&amp;<pos:position pos:line="419" pos:column="51"/></operator><name pos:line="419" pos:column="47">addr<pos:position pos:line="419" pos:column="51"/></name></expr></argument>)<pos:position pos:line="419" pos:column="52"/></argument_list></call><operator pos:line="419" pos:column="52">)<pos:position pos:line="419" pos:column="53"/></operator> <operator pos:line="419" pos:column="54">&amp;&amp;<pos:position pos:line="419" pos:column="64"/></operator>
<cpp:ifdef pos:line="420" pos:column="1">#<cpp:directive pos:line="420" pos:column="2">ifdef<pos:position pos:line="420" pos:column="7"/></cpp:directive> <name pos:line="420" pos:column="8">ENABLE_IPV6<pos:position pos:line="420" pos:column="19"/></name></cpp:ifdef>
     <operator pos:line="421" pos:column="6">(<pos:position pos:line="421" pos:column="7"/></operator><literal type="number" pos:line="421" pos:column="7">0<pos:position pos:line="421" pos:column="8"/></literal> <operator pos:line="421" pos:column="9">==<pos:position pos:line="421" pos:column="11"/></operator> <call><name pos:line="421" pos:column="12">Curl_inet_pton<pos:position pos:line="421" pos:column="26"/></name><argument_list pos:line="421" pos:column="26">(<argument><expr><name pos:line="421" pos:column="27">AF_INET6<pos:position pos:line="421" pos:column="35"/></name></expr></argument>, <argument><expr><name pos:line="421" pos:column="37">hostname<pos:position pos:line="421" pos:column="45"/></name></expr></argument>, <argument><expr><operator pos:line="421" pos:column="47">&amp;<pos:position pos:line="421" pos:column="52"/></operator><name pos:line="421" pos:column="48">addr<pos:position pos:line="421" pos:column="52"/></name></expr></argument>)<pos:position pos:line="421" pos:column="53"/></argument_list></call><operator pos:line="421" pos:column="53">)<pos:position pos:line="421" pos:column="54"/></operator> <operator pos:line="421" pos:column="55">&amp;&amp;<pos:position pos:line="421" pos:column="65"/></operator>
<cpp:endif pos:line="422" pos:column="1">#<cpp:directive pos:line="422" pos:column="2">endif<pos:position pos:line="422" pos:column="7"/></cpp:directive></cpp:endif>
     <name pos:line="423" pos:column="6">sni<pos:position pos:line="423" pos:column="9"/></name> <operator pos:line="423" pos:column="10">&amp;&amp;<pos:position pos:line="423" pos:column="20"/></operator>
     <operator pos:line="424" pos:column="6">!<pos:position pos:line="424" pos:column="7"/></operator><call><name pos:line="424" pos:column="7">SSL_set_tlsext_host_name<pos:position pos:line="424" pos:column="31"/></name><argument_list pos:line="424" pos:column="31">(<argument><expr><name><name pos:line="424" pos:column="32">BACKEND<pos:position pos:line="424" pos:column="39"/></name><operator pos:line="424" pos:column="39">-&gt;<pos:position pos:line="424" pos:column="44"/></operator><name pos:line="424" pos:column="41">handle<pos:position pos:line="424" pos:column="47"/></name></name></expr></argument>, <argument><expr><name pos:line="424" pos:column="49">hostname<pos:position pos:line="424" pos:column="57"/></name></expr></argument>)<pos:position pos:line="424" pos:column="58"/></argument_list></call></expr>)<pos:position pos:line="424" pos:column="59"/></condition><then pos:line="424" pos:column="59">
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="425" pos:column="5">infof<pos:position pos:line="425" pos:column="10"/></name><argument_list pos:line="425" pos:column="10">(<argument><expr><name pos:line="425" pos:column="11">data<pos:position pos:line="425" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="425" pos:column="17">"WARNING: failed to configure server name indication (SNI) "<pos:position pos:line="425" pos:column="77"/></literal>
          <literal type="string" pos:line="426" pos:column="11">"TLS extension\n"<pos:position pos:line="426" pos:column="28"/></literal></expr></argument>)<pos:position pos:line="426" pos:column="29"/></argument_list></call></expr>;<pos:position pos:line="426" pos:column="30"/></expr_stmt></block></then></if>
<cpp:endif pos:line="427" pos:column="1">#<cpp:directive pos:line="427" pos:column="2">endif<pos:position pos:line="427" pos:column="7"/></cpp:directive></cpp:endif>

  <comment type="block" pos:line="429" pos:column="3">/* Check if there's a cached ID we can/should use here! */</comment>
  <if pos:line="430" pos:column="3">if<condition pos:line="430" pos:column="5">(<expr><call><name pos:line="430" pos:column="6">SSL_SET_OPTION<pos:position pos:line="430" pos:column="20"/></name><argument_list pos:line="430" pos:column="20">(<argument><expr><name><name pos:line="430" pos:column="21">primary<pos:position pos:line="430" pos:column="28"/></name><operator pos:line="430" pos:column="28">.<pos:position pos:line="430" pos:column="29"/></operator><name pos:line="430" pos:column="29">sessionid<pos:position pos:line="430" pos:column="38"/></name></name></expr></argument>)<pos:position pos:line="430" pos:column="39"/></argument_list></call></expr>)<pos:position pos:line="430" pos:column="40"/></condition><then pos:line="430" pos:column="40"> <block pos:line="430" pos:column="41">{
    <decl_stmt><decl><type><name pos:line="431" pos:column="5">void<pos:position pos:line="431" pos:column="9"/></name> <modifier pos:line="431" pos:column="10">*<pos:position pos:line="431" pos:column="11"/></modifier></type><name pos:line="431" pos:column="11">ssl_sessionid<pos:position pos:line="431" pos:column="24"/></name> <init pos:line="431" pos:column="25">= <expr><name pos:line="431" pos:column="27">NULL<pos:position pos:line="431" pos:column="31"/></name></expr></init></decl>;<pos:position pos:line="431" pos:column="32"/></decl_stmt>

    <expr_stmt><expr><call><name pos:line="433" pos:column="5">Curl_ssl_sessionid_lock<pos:position pos:line="433" pos:column="28"/></name><argument_list pos:line="433" pos:column="28">(<argument><expr><name pos:line="433" pos:column="29">conn<pos:position pos:line="433" pos:column="33"/></name></expr></argument>)<pos:position pos:line="433" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="433" pos:column="35"/></expr_stmt>
    <if pos:line="434" pos:column="5">if<condition pos:line="434" pos:column="7">(<expr><operator pos:line="434" pos:column="8">!<pos:position pos:line="434" pos:column="9"/></operator><call><name pos:line="434" pos:column="9">Curl_ssl_getsessionid<pos:position pos:line="434" pos:column="30"/></name><argument_list pos:line="434" pos:column="30">(<argument><expr><name pos:line="434" pos:column="31">conn<pos:position pos:line="434" pos:column="35"/></name></expr></argument>, <argument><expr><operator pos:line="434" pos:column="37">&amp;<pos:position pos:line="434" pos:column="42"/></operator><name pos:line="434" pos:column="38">ssl_sessionid<pos:position pos:line="434" pos:column="51"/></name></expr></argument>, <argument><expr><name pos:line="434" pos:column="53">NULL<pos:position pos:line="434" pos:column="57"/></name></expr></argument>, <argument><expr><name pos:line="434" pos:column="59">sockindex<pos:position pos:line="434" pos:column="68"/></name></expr></argument>)<pos:position pos:line="434" pos:column="69"/></argument_list></call></expr>)<pos:position pos:line="434" pos:column="70"/></condition><then pos:line="434" pos:column="70"> <block pos:line="434" pos:column="71">{
      <comment type="block" pos:line="435" pos:column="7">/* we got a session id, use it! */</comment>
      <if pos:line="436" pos:column="7">if<condition pos:line="436" pos:column="9">(<expr><operator pos:line="436" pos:column="10">!<pos:position pos:line="436" pos:column="11"/></operator><call><name pos:line="436" pos:column="11">SSL_set_session<pos:position pos:line="436" pos:column="26"/></name><argument_list pos:line="436" pos:column="26">(<argument><expr><name><name pos:line="436" pos:column="27">BACKEND<pos:position pos:line="436" pos:column="34"/></name><operator pos:line="436" pos:column="34">-&gt;<pos:position pos:line="436" pos:column="39"/></operator><name pos:line="436" pos:column="36">handle<pos:position pos:line="436" pos:column="42"/></name></name></expr></argument>, <argument><expr><name pos:line="436" pos:column="44">ssl_sessionid<pos:position pos:line="436" pos:column="57"/></name></expr></argument>)<pos:position pos:line="436" pos:column="58"/></argument_list></call></expr>)<pos:position pos:line="436" pos:column="59"/></condition><then pos:line="436" pos:column="59"> <block pos:line="436" pos:column="60">{
        <expr_stmt><expr><call><name pos:line="437" pos:column="9">Curl_ssl_sessionid_unlock<pos:position pos:line="437" pos:column="34"/></name><argument_list pos:line="437" pos:column="34">(<argument><expr><name pos:line="437" pos:column="35">conn<pos:position pos:line="437" pos:column="39"/></name></expr></argument>)<pos:position pos:line="437" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="437" pos:column="41"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="438" pos:column="9">failf<pos:position pos:line="438" pos:column="14"/></name><argument_list pos:line="438" pos:column="14">(<argument><expr><name pos:line="438" pos:column="15">data<pos:position pos:line="438" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="438" pos:column="21">"SSL: SSL_set_session failed: %s"<pos:position pos:line="438" pos:column="54"/></literal></expr></argument>,
              <argument><expr><call><name pos:line="439" pos:column="15">ossl_strerror<pos:position pos:line="439" pos:column="28"/></name><argument_list pos:line="439" pos:column="28">(<argument><expr><call><name pos:line="439" pos:column="29">ERR_get_error<pos:position pos:line="439" pos:column="42"/></name><argument_list pos:line="439" pos:column="42">()<pos:position pos:line="439" pos:column="44"/></argument_list></call></expr></argument>, <argument><expr><name pos:line="439" pos:column="46">error_buffer<pos:position pos:line="439" pos:column="58"/></name></expr></argument>,
                            <argument><expr><sizeof pos:line="440" pos:column="29">sizeof<argument_list pos:line="440" pos:column="35">(<argument><expr><name pos:line="440" pos:column="36">error_buffer<pos:position pos:line="440" pos:column="48"/></name></expr></argument>)<pos:position pos:line="440" pos:column="49"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="440" pos:column="50"/></argument_list></call></expr></argument>)<pos:position pos:line="440" pos:column="51"/></argument_list></call></expr>;<pos:position pos:line="440" pos:column="52"/></expr_stmt>
        <return pos:line="441" pos:column="9">return <expr><name pos:line="441" pos:column="16">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="441" pos:column="39"/></name></expr>;<pos:position pos:line="441" pos:column="40"/></return>
      }<pos:position pos:line="442" pos:column="8"/></block></then></if>
      <comment type="block" pos:line="443" pos:column="7">/* Informational message */</comment>
      <expr_stmt><expr><call><name pos:line="444" pos:column="7">infof<pos:position pos:line="444" pos:column="12"/></name><argument_list pos:line="444" pos:column="12">(<argument><expr><name pos:line="444" pos:column="13">data<pos:position pos:line="444" pos:column="17"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="444" pos:column="19">"SSL re-using session ID\n"<pos:position pos:line="444" pos:column="46"/></literal></expr></argument>)<pos:position pos:line="444" pos:column="47"/></argument_list></call></expr>;<pos:position pos:line="444" pos:column="48"/></expr_stmt>
    }<pos:position pos:line="445" pos:column="6"/></block></then></if>
    <expr_stmt><expr><call><name pos:line="446" pos:column="5">Curl_ssl_sessionid_unlock<pos:position pos:line="446" pos:column="30"/></name><argument_list pos:line="446" pos:column="30">(<argument><expr><name pos:line="446" pos:column="31">conn<pos:position pos:line="446" pos:column="35"/></name></expr></argument>)<pos:position pos:line="446" pos:column="36"/></argument_list></call></expr>;<pos:position pos:line="446" pos:column="37"/></expr_stmt>
  }<pos:position pos:line="447" pos:column="4"/></block></then></if>

  <if pos:line="449" pos:column="3">if<condition pos:line="449" pos:column="5">(<expr><name><name pos:line="449" pos:column="6">conn<pos:position pos:line="449" pos:column="10"/></name><operator pos:line="449" pos:column="10">-&gt;<pos:position pos:line="449" pos:column="15"/></operator><name pos:line="449" pos:column="12">proxy_ssl<pos:position pos:line="449" pos:column="21"/></name><index pos:line="449" pos:column="21">[<expr><name pos:line="449" pos:column="22">sockindex<pos:position pos:line="449" pos:column="31"/></name></expr>]<pos:position pos:line="449" pos:column="32"/></index></name><operator pos:line="449" pos:column="32">.<pos:position pos:line="449" pos:column="33"/></operator><name pos:line="449" pos:column="33">use<pos:position pos:line="449" pos:column="36"/></name></expr>)<pos:position pos:line="449" pos:column="37"/></condition><then pos:line="449" pos:column="37"> <block pos:line="449" pos:column="38">{
    <decl_stmt><decl><type><name pos:line="450" pos:column="5">BIO<pos:position pos:line="450" pos:column="8"/></name> <modifier pos:line="450" pos:column="9">*<pos:position pos:line="450" pos:column="10"/></modifier><specifier pos:line="450" pos:column="10">const<pos:position pos:line="450" pos:column="15"/></specifier></type> <name pos:line="450" pos:column="16">bio<pos:position pos:line="450" pos:column="19"/></name> <init pos:line="450" pos:column="20">= <expr><call><name pos:line="450" pos:column="22">BIO_new<pos:position pos:line="450" pos:column="29"/></name><argument_list pos:line="450" pos:column="29">(<argument><expr><call><name pos:line="450" pos:column="30">BIO_f_ssl<pos:position pos:line="450" pos:column="39"/></name><argument_list pos:line="450" pos:column="39">()<pos:position pos:line="450" pos:column="41"/></argument_list></call></expr></argument>)<pos:position pos:line="450" pos:column="42"/></argument_list></call></expr></init></decl>;<pos:position pos:line="450" pos:column="43"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="451" pos:column="5">SSL<pos:position pos:line="451" pos:column="8"/></name> <modifier pos:line="451" pos:column="9">*<pos:position pos:line="451" pos:column="10"/></modifier></type><name pos:line="451" pos:column="10">handle<pos:position pos:line="451" pos:column="16"/></name> <init pos:line="451" pos:column="17">= <expr><name><name pos:line="451" pos:column="19">conn<pos:position pos:line="451" pos:column="23"/></name><operator pos:line="451" pos:column="23">-&gt;<pos:position pos:line="451" pos:column="28"/></operator><name pos:line="451" pos:column="25">proxy_ssl<pos:position pos:line="451" pos:column="34"/></name><index pos:line="451" pos:column="34">[<expr><name pos:line="451" pos:column="35">sockindex<pos:position pos:line="451" pos:column="44"/></name></expr>]<pos:position pos:line="451" pos:column="45"/></index></name><operator pos:line="451" pos:column="45">.<pos:position pos:line="451" pos:column="46"/></operator><name><name pos:line="451" pos:column="46">backend<pos:position pos:line="451" pos:column="53"/></name><operator pos:line="451" pos:column="53">-&gt;<pos:position pos:line="451" pos:column="58"/></operator><name pos:line="451" pos:column="55">handle<pos:position pos:line="451" pos:column="61"/></name></name></expr></init></decl>;<pos:position pos:line="451" pos:column="62"/></decl_stmt>
    <expr_stmt><expr><call><name pos:line="452" pos:column="5">DEBUGASSERT<pos:position pos:line="452" pos:column="16"/></name><argument_list pos:line="452" pos:column="16">(<argument><expr><name pos:line="452" pos:column="17">ssl_connection_complete<pos:position pos:line="452" pos:column="40"/></name> <operator pos:line="452" pos:column="41">==<pos:position pos:line="452" pos:column="43"/></operator> <name><name pos:line="452" pos:column="44">conn<pos:position pos:line="452" pos:column="48"/></name><operator pos:line="452" pos:column="48">-&gt;<pos:position pos:line="452" pos:column="53"/></operator><name pos:line="452" pos:column="50">proxy_ssl<pos:position pos:line="452" pos:column="59"/></name><index pos:line="452" pos:column="59">[<expr><name pos:line="452" pos:column="60">sockindex<pos:position pos:line="452" pos:column="69"/></name></expr>]<pos:position pos:line="452" pos:column="70"/></index></name><operator pos:line="452" pos:column="70">.<pos:position pos:line="452" pos:column="71"/></operator><name pos:line="452" pos:column="71">state<pos:position pos:line="452" pos:column="76"/></name></expr></argument>)<pos:position pos:line="452" pos:column="77"/></argument_list></call></expr>;<pos:position pos:line="452" pos:column="78"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="453" pos:column="5">DEBUGASSERT<pos:position pos:line="453" pos:column="16"/></name><argument_list pos:line="453" pos:column="16">(<argument><expr><name pos:line="453" pos:column="17">handle<pos:position pos:line="453" pos:column="23"/></name> <operator pos:line="453" pos:column="24">!=<pos:position pos:line="453" pos:column="26"/></operator> <name pos:line="453" pos:column="27">NULL<pos:position pos:line="453" pos:column="31"/></name></expr></argument>)<pos:position pos:line="453" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="453" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="454" pos:column="5">DEBUGASSERT<pos:position pos:line="454" pos:column="16"/></name><argument_list pos:line="454" pos:column="16">(<argument><expr><name pos:line="454" pos:column="17">bio<pos:position pos:line="454" pos:column="20"/></name> <operator pos:line="454" pos:column="21">!=<pos:position pos:line="454" pos:column="23"/></operator> <name pos:line="454" pos:column="24">NULL<pos:position pos:line="454" pos:column="28"/></name></expr></argument>)<pos:position pos:line="454" pos:column="29"/></argument_list></call></expr>;<pos:position pos:line="454" pos:column="30"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="455" pos:column="5">BIO_set_ssl<pos:position pos:line="455" pos:column="16"/></name><argument_list pos:line="455" pos:column="16">(<argument><expr><name pos:line="455" pos:column="17">bio<pos:position pos:line="455" pos:column="20"/></name></expr></argument>, <argument><expr><name pos:line="455" pos:column="22">handle<pos:position pos:line="455" pos:column="28"/></name></expr></argument>, <argument><expr><name pos:line="455" pos:column="30">FALSE<pos:position pos:line="455" pos:column="35"/></name></expr></argument>)<pos:position pos:line="455" pos:column="36"/></argument_list></call></expr>;<pos:position pos:line="455" pos:column="37"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="456" pos:column="5">SSL_set_bio<pos:position pos:line="456" pos:column="16"/></name><argument_list pos:line="456" pos:column="16">(<argument><expr><name><name pos:line="456" pos:column="17">BACKEND<pos:position pos:line="456" pos:column="24"/></name><operator pos:line="456" pos:column="24">-&gt;<pos:position pos:line="456" pos:column="29"/></operator><name pos:line="456" pos:column="26">handle<pos:position pos:line="456" pos:column="32"/></name></name></expr></argument>, <argument><expr><name pos:line="456" pos:column="34">bio<pos:position pos:line="456" pos:column="37"/></name></expr></argument>, <argument><expr><name pos:line="456" pos:column="39">bio<pos:position pos:line="456" pos:column="42"/></name></expr></argument>)<pos:position pos:line="456" pos:column="43"/></argument_list></call></expr>;<pos:position pos:line="456" pos:column="44"/></expr_stmt>
  }<pos:position pos:line="457" pos:column="4"/></block></then>
  <elseif pos:line="458" pos:column="3">else <if pos:line="458" pos:column="8">if<condition pos:line="458" pos:column="10">(<expr><operator pos:line="458" pos:column="11">!<pos:position pos:line="458" pos:column="12"/></operator><call><name pos:line="458" pos:column="12">SSL_set_fd<pos:position pos:line="458" pos:column="22"/></name><argument_list pos:line="458" pos:column="22">(<argument><expr><name><name pos:line="458" pos:column="23">BACKEND<pos:position pos:line="458" pos:column="30"/></name><operator pos:line="458" pos:column="30">-&gt;<pos:position pos:line="458" pos:column="35"/></operator><name pos:line="458" pos:column="32">handle<pos:position pos:line="458" pos:column="38"/></name></name></expr></argument>, <argument><expr><operator pos:line="458" pos:column="40">(<pos:position pos:line="458" pos:column="41"/></operator><name pos:line="458" pos:column="41">int<pos:position pos:line="458" pos:column="44"/></name><operator pos:line="458" pos:column="44">)<pos:position pos:line="458" pos:column="45"/></operator><name pos:line="458" pos:column="45">sockfd<pos:position pos:line="458" pos:column="51"/></name></expr></argument>)<pos:position pos:line="458" pos:column="52"/></argument_list></call></expr>)<pos:position pos:line="458" pos:column="53"/></condition><then pos:line="458" pos:column="53"> <block pos:line="458" pos:column="54">{
    <comment type="block" pos:line="459" pos:column="5">/* pass the raw socket into the SSL layers */</comment>
    <expr_stmt><expr><call><name pos:line="460" pos:column="5">failf<pos:position pos:line="460" pos:column="10"/></name><argument_list pos:line="460" pos:column="10">(<argument><expr><name pos:line="460" pos:column="11">data<pos:position pos:line="460" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="460" pos:column="17">"SSL: SSL_set_fd failed: %s"<pos:position pos:line="460" pos:column="45"/></literal></expr></argument>,
          <argument><expr><call><name pos:line="461" pos:column="11">ossl_strerror<pos:position pos:line="461" pos:column="24"/></name><argument_list pos:line="461" pos:column="24">(<argument><expr><call><name pos:line="461" pos:column="25">ERR_get_error<pos:position pos:line="461" pos:column="38"/></name><argument_list pos:line="461" pos:column="38">()<pos:position pos:line="461" pos:column="40"/></argument_list></call></expr></argument>, <argument><expr><name pos:line="461" pos:column="42">error_buffer<pos:position pos:line="461" pos:column="54"/></name></expr></argument>, <argument><expr><sizeof pos:line="461" pos:column="56">sizeof<argument_list pos:line="461" pos:column="62">(<argument><expr><name pos:line="461" pos:column="63">error_buffer<pos:position pos:line="461" pos:column="75"/></name></expr></argument>)<pos:position pos:line="461" pos:column="76"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="461" pos:column="77"/></argument_list></call></expr></argument>)<pos:position pos:line="461" pos:column="78"/></argument_list></call></expr>;<pos:position pos:line="461" pos:column="79"/></expr_stmt>
    <return pos:line="462" pos:column="5">return <expr><name pos:line="462" pos:column="12">CURLE_SSL_CONNECT_ERROR<pos:position pos:line="462" pos:column="35"/></name></expr>;<pos:position pos:line="462" pos:column="36"/></return>
  }<pos:position pos:line="463" pos:column="4"/></block></then></if></elseif></if>

  <expr_stmt><expr><name><name pos:line="465" pos:column="3">connssl<pos:position pos:line="465" pos:column="10"/></name><operator pos:line="465" pos:column="10">-&gt;<pos:position pos:line="465" pos:column="15"/></operator><name pos:line="465" pos:column="12">connecting_state<pos:position pos:line="465" pos:column="28"/></name></name> <operator pos:line="465" pos:column="29">=<pos:position pos:line="465" pos:column="30"/></operator> <name pos:line="465" pos:column="31">ssl_connect_2<pos:position pos:line="465" pos:column="44"/></name></expr>;<pos:position pos:line="465" pos:column="45"/></expr_stmt>

  <return pos:line="467" pos:column="3">return <expr><name pos:line="467" pos:column="10">CURLE_OK<pos:position pos:line="467" pos:column="18"/></name></expr>;<pos:position pos:line="467" pos:column="19"/></return>
}<pos:position pos:line="468" pos:column="2"/></block></function></unit>
