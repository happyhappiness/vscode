<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/curl/gumtree/curl_repos_function_723_curl-7.18.1.cpp" pos:tabs="8"><function><type><name pos:line="1" pos:column="1">CURLcode<pos:position pos:line="1" pos:column="9"/></name></type> <name pos:line="1" pos:column="10">Curl_done<pos:position pos:line="1" pos:column="19"/></name><parameter_list pos:line="1" pos:column="19">(<parameter><decl><type><name><name pos:line="1" pos:column="20">struct<pos:position pos:line="1" pos:column="26"/></name> <name pos:line="1" pos:column="27">connectdata<pos:position pos:line="1" pos:column="38"/></name></name> <modifier pos:line="1" pos:column="39">*<pos:position pos:line="1" pos:column="40"/></modifier><modifier pos:line="1" pos:column="40">*<pos:position pos:line="1" pos:column="41"/></modifier></type><name pos:line="1" pos:column="41">connp<pos:position pos:line="1" pos:column="46"/></name></decl></parameter>,
                   <parameter><decl><type><name pos:line="2" pos:column="20">CURLcode<pos:position pos:line="2" pos:column="28"/></name></type> <name pos:line="2" pos:column="29">status<pos:position pos:line="2" pos:column="35"/></name></decl></parameter>,  <comment type="block" pos:line="2" pos:column="38">/* an error if this is called after an
                                        error was detected */</comment>
                   <parameter><decl><type><name pos:line="4" pos:column="20">bool<pos:position pos:line="4" pos:column="24"/></name></type> <name pos:line="4" pos:column="25">premature<pos:position pos:line="4" pos:column="34"/></name></decl></parameter>)<pos:position pos:line="4" pos:column="35"/></parameter_list>
<block pos:line="5" pos:column="1">{
  <decl_stmt><decl><type><name pos:line="6" pos:column="3">CURLcode<pos:position pos:line="6" pos:column="11"/></name></type> <name pos:line="6" pos:column="12">result<pos:position pos:line="6" pos:column="18"/></name></decl>;<pos:position pos:line="6" pos:column="19"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="7" pos:column="3">struct<pos:position pos:line="7" pos:column="9"/></name> <name pos:line="7" pos:column="10">connectdata<pos:position pos:line="7" pos:column="21"/></name></name> <modifier pos:line="7" pos:column="22">*<pos:position pos:line="7" pos:column="23"/></modifier></type><name pos:line="7" pos:column="23">conn<pos:position pos:line="7" pos:column="27"/></name></decl>;<pos:position pos:line="7" pos:column="28"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="8" pos:column="3">struct<pos:position pos:line="8" pos:column="9"/></name> <name pos:line="8" pos:column="10">SessionHandle<pos:position pos:line="8" pos:column="23"/></name></name> <modifier pos:line="8" pos:column="24">*<pos:position pos:line="8" pos:column="25"/></modifier></type><name pos:line="8" pos:column="25">data<pos:position pos:line="8" pos:column="29"/></name></decl>;<pos:position pos:line="8" pos:column="30"/></decl_stmt>

  <expr_stmt><expr><call><name pos:line="10" pos:column="3">DEBUGASSERT<pos:position pos:line="10" pos:column="14"/></name><argument_list pos:line="10" pos:column="14">(<argument><expr><operator pos:line="10" pos:column="15">*<pos:position pos:line="10" pos:column="16"/></operator><name pos:line="10" pos:column="16">connp<pos:position pos:line="10" pos:column="21"/></name></expr></argument>)<pos:position pos:line="10" pos:column="22"/></argument_list></call></expr>;<pos:position pos:line="10" pos:column="23"/></expr_stmt>

  <expr_stmt><expr><name pos:line="12" pos:column="3">conn<pos:position pos:line="12" pos:column="7"/></name> <operator pos:line="12" pos:column="8">=<pos:position pos:line="12" pos:column="9"/></operator> <operator pos:line="12" pos:column="10">*<pos:position pos:line="12" pos:column="11"/></operator><name pos:line="12" pos:column="11">connp<pos:position pos:line="12" pos:column="16"/></name></expr>;<pos:position pos:line="12" pos:column="17"/></expr_stmt>
  <expr_stmt><expr><name pos:line="13" pos:column="3">data<pos:position pos:line="13" pos:column="7"/></name> <operator pos:line="13" pos:column="8">=<pos:position pos:line="13" pos:column="9"/></operator> <name><name pos:line="13" pos:column="10">conn<pos:position pos:line="13" pos:column="14"/></name><operator pos:line="13" pos:column="14">-&gt;<pos:position pos:line="13" pos:column="19"/></operator><name pos:line="13" pos:column="16">data<pos:position pos:line="13" pos:column="20"/></name></name></expr>;<pos:position pos:line="13" pos:column="21"/></expr_stmt>

  <expr_stmt><expr><call><name pos:line="15" pos:column="3">Curl_expire<pos:position pos:line="15" pos:column="14"/></name><argument_list pos:line="15" pos:column="14">(<argument><expr><name pos:line="15" pos:column="15">data<pos:position pos:line="15" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="number" pos:line="15" pos:column="21">0<pos:position pos:line="15" pos:column="22"/></literal></expr></argument>)<pos:position pos:line="15" pos:column="23"/></argument_list></call></expr>;<pos:position pos:line="15" pos:column="24"/></expr_stmt> <comment type="block" pos:line="15" pos:column="25">/* stop timer */</comment>

  <if pos:line="17" pos:column="3">if<condition pos:line="17" pos:column="5">(<expr><call><name pos:line="17" pos:column="6">Curl_removeHandleFromPipeline<pos:position pos:line="17" pos:column="35"/></name><argument_list pos:line="17" pos:column="35">(<argument><expr><name pos:line="17" pos:column="36">data<pos:position pos:line="17" pos:column="40"/></name></expr></argument>, <argument><expr><name><name pos:line="17" pos:column="42">conn<pos:position pos:line="17" pos:column="46"/></name><operator pos:line="17" pos:column="46">-&gt;<pos:position pos:line="17" pos:column="51"/></operator><name pos:line="17" pos:column="48">recv_pipe<pos:position pos:line="17" pos:column="57"/></name></name></expr></argument>)<pos:position pos:line="17" pos:column="58"/></argument_list></call> <operator pos:line="17" pos:column="59">&amp;&amp;<pos:position pos:line="17" pos:column="69"/></operator>
     <name><name pos:line="18" pos:column="6">conn<pos:position pos:line="18" pos:column="10"/></name><operator pos:line="18" pos:column="10">-&gt;<pos:position pos:line="18" pos:column="15"/></operator><name pos:line="18" pos:column="12">readchannel_inuse<pos:position pos:line="18" pos:column="29"/></name></name></expr>)<pos:position pos:line="18" pos:column="30"/></condition><then pos:line="18" pos:column="30">
    <block type="pseudo"><expr_stmt><expr><name><name pos:line="19" pos:column="5">conn<pos:position pos:line="19" pos:column="9"/></name><operator pos:line="19" pos:column="9">-&gt;<pos:position pos:line="19" pos:column="14"/></operator><name pos:line="19" pos:column="11">readchannel_inuse<pos:position pos:line="19" pos:column="28"/></name></name> <operator pos:line="19" pos:column="29">=<pos:position pos:line="19" pos:column="30"/></operator> <name pos:line="19" pos:column="31">FALSE<pos:position pos:line="19" pos:column="36"/></name></expr>;<pos:position pos:line="19" pos:column="37"/></expr_stmt></block></then></if>
  <if pos:line="20" pos:column="3">if<condition pos:line="20" pos:column="5">(<expr><call><name pos:line="20" pos:column="6">Curl_removeHandleFromPipeline<pos:position pos:line="20" pos:column="35"/></name><argument_list pos:line="20" pos:column="35">(<argument><expr><name pos:line="20" pos:column="36">data<pos:position pos:line="20" pos:column="40"/></name></expr></argument>, <argument><expr><name><name pos:line="20" pos:column="42">conn<pos:position pos:line="20" pos:column="46"/></name><operator pos:line="20" pos:column="46">-&gt;<pos:position pos:line="20" pos:column="51"/></operator><name pos:line="20" pos:column="48">send_pipe<pos:position pos:line="20" pos:column="57"/></name></name></expr></argument>)<pos:position pos:line="20" pos:column="58"/></argument_list></call> <operator pos:line="20" pos:column="59">&amp;&amp;<pos:position pos:line="20" pos:column="69"/></operator>
     <name><name pos:line="21" pos:column="6">conn<pos:position pos:line="21" pos:column="10"/></name><operator pos:line="21" pos:column="10">-&gt;<pos:position pos:line="21" pos:column="15"/></operator><name pos:line="21" pos:column="12">writechannel_inuse<pos:position pos:line="21" pos:column="30"/></name></name></expr>)<pos:position pos:line="21" pos:column="31"/></condition><then pos:line="21" pos:column="31">
    <block type="pseudo"><expr_stmt><expr><name><name pos:line="22" pos:column="5">conn<pos:position pos:line="22" pos:column="9"/></name><operator pos:line="22" pos:column="9">-&gt;<pos:position pos:line="22" pos:column="14"/></operator><name pos:line="22" pos:column="11">writechannel_inuse<pos:position pos:line="22" pos:column="29"/></name></name> <operator pos:line="22" pos:column="30">=<pos:position pos:line="22" pos:column="31"/></operator> <name pos:line="22" pos:column="32">FALSE<pos:position pos:line="22" pos:column="37"/></name></expr>;<pos:position pos:line="22" pos:column="38"/></expr_stmt></block></then></if>
  <expr_stmt><expr><call><name pos:line="23" pos:column="3">Curl_removeHandleFromPipeline<pos:position pos:line="23" pos:column="32"/></name><argument_list pos:line="23" pos:column="32">(<argument><expr><name pos:line="23" pos:column="33">data<pos:position pos:line="23" pos:column="37"/></name></expr></argument>, <argument><expr><name><name pos:line="23" pos:column="39">conn<pos:position pos:line="23" pos:column="43"/></name><operator pos:line="23" pos:column="43">-&gt;<pos:position pos:line="23" pos:column="48"/></operator><name pos:line="23" pos:column="45">pend_pipe<pos:position pos:line="23" pos:column="54"/></name></name></expr></argument>)<pos:position pos:line="23" pos:column="55"/></argument_list></call></expr>;<pos:position pos:line="23" pos:column="56"/></expr_stmt>

  <if pos:line="25" pos:column="3">if<condition pos:line="25" pos:column="5">(<expr><name><name pos:line="25" pos:column="6">conn<pos:position pos:line="25" pos:column="10"/></name><operator pos:line="25" pos:column="10">-&gt;<pos:position pos:line="25" pos:column="15"/></operator><name pos:line="25" pos:column="12">bits<pos:position pos:line="25" pos:column="16"/></name><operator pos:line="25" pos:column="16">.<pos:position pos:line="25" pos:column="17"/></operator><name pos:line="25" pos:column="17">done<pos:position pos:line="25" pos:column="21"/></name></name> <operator pos:line="25" pos:column="22">||<pos:position pos:line="25" pos:column="24"/></operator>
     <operator pos:line="26" pos:column="6">(<pos:position pos:line="26" pos:column="7"/></operator><name><name pos:line="26" pos:column="7">conn<pos:position pos:line="26" pos:column="11"/></name><operator pos:line="26" pos:column="11">-&gt;<pos:position pos:line="26" pos:column="16"/></operator><name pos:line="26" pos:column="13">send_pipe<pos:position pos:line="26" pos:column="22"/></name><operator pos:line="26" pos:column="22">-&gt;<pos:position pos:line="26" pos:column="27"/></operator><name pos:line="26" pos:column="24">size<pos:position pos:line="26" pos:column="28"/></name></name> <operator pos:line="26" pos:column="29">+<pos:position pos:line="26" pos:column="30"/></operator> <name><name pos:line="26" pos:column="31">conn<pos:position pos:line="26" pos:column="35"/></name><operator pos:line="26" pos:column="35">-&gt;<pos:position pos:line="26" pos:column="40"/></operator><name pos:line="26" pos:column="37">recv_pipe<pos:position pos:line="26" pos:column="46"/></name><operator pos:line="26" pos:column="46">-&gt;<pos:position pos:line="26" pos:column="51"/></operator><name pos:line="26" pos:column="48">size<pos:position pos:line="26" pos:column="52"/></name></name> <operator pos:line="26" pos:column="53">!=<pos:position pos:line="26" pos:column="55"/></operator> <literal type="number" pos:line="26" pos:column="56">0<pos:position pos:line="26" pos:column="57"/></literal> <operator pos:line="26" pos:column="58">&amp;&amp;<pos:position pos:line="26" pos:column="68"/></operator>
      <operator pos:line="27" pos:column="7">!<pos:position pos:line="27" pos:column="8"/></operator><name><name pos:line="27" pos:column="8">data<pos:position pos:line="27" pos:column="12"/></name><operator pos:line="27" pos:column="12">-&gt;<pos:position pos:line="27" pos:column="17"/></operator><name pos:line="27" pos:column="14">set<pos:position pos:line="27" pos:column="17"/></name><operator pos:line="27" pos:column="17">.<pos:position pos:line="27" pos:column="18"/></operator><name pos:line="27" pos:column="18">reuse_forbid<pos:position pos:line="27" pos:column="30"/></name></name> <operator pos:line="27" pos:column="31">&amp;&amp;<pos:position pos:line="27" pos:column="41"/></operator>
      <operator pos:line="28" pos:column="7">!<pos:position pos:line="28" pos:column="8"/></operator><name><name pos:line="28" pos:column="8">conn<pos:position pos:line="28" pos:column="12"/></name><operator pos:line="28" pos:column="12">-&gt;<pos:position pos:line="28" pos:column="17"/></operator><name pos:line="28" pos:column="14">bits<pos:position pos:line="28" pos:column="18"/></name><operator pos:line="28" pos:column="18">.<pos:position pos:line="28" pos:column="19"/></operator><name pos:line="28" pos:column="19">close<pos:position pos:line="28" pos:column="24"/></name></name><operator pos:line="28" pos:column="24">)<pos:position pos:line="28" pos:column="25"/></operator></expr>)<pos:position pos:line="28" pos:column="26"/></condition><then pos:line="28" pos:column="26">
    <comment type="block" pos:line="29" pos:column="5">/* Stop if Curl_done() has already been called or pipeline
       is not empty and we do not have to close connection. */</comment>
    <block type="pseudo"><return pos:line="31" pos:column="5">return <expr><name pos:line="31" pos:column="12">CURLE_OK<pos:position pos:line="31" pos:column="20"/></name></expr>;<pos:position pos:line="31" pos:column="21"/></return></block></then></if>

  <expr_stmt><expr><name><name pos:line="33" pos:column="3">conn<pos:position pos:line="33" pos:column="7"/></name><operator pos:line="33" pos:column="7">-&gt;<pos:position pos:line="33" pos:column="12"/></operator><name pos:line="33" pos:column="9">bits<pos:position pos:line="33" pos:column="13"/></name><operator pos:line="33" pos:column="13">.<pos:position pos:line="33" pos:column="14"/></operator><name pos:line="33" pos:column="14">done<pos:position pos:line="33" pos:column="18"/></name></name> <operator pos:line="33" pos:column="19">=<pos:position pos:line="33" pos:column="20"/></operator> <name pos:line="33" pos:column="21">TRUE<pos:position pos:line="33" pos:column="25"/></name></expr>;<pos:position pos:line="33" pos:column="26"/></expr_stmt> <comment type="block" pos:line="33" pos:column="27">/* called just now! */</comment>

  <comment type="block" pos:line="35" pos:column="3">/* Cleanup possible redirect junk */</comment>
  <if pos:line="36" pos:column="3">if<condition pos:line="36" pos:column="5">(<expr><name><name pos:line="36" pos:column="6">data<pos:position pos:line="36" pos:column="10"/></name><operator pos:line="36" pos:column="10">-&gt;<pos:position pos:line="36" pos:column="15"/></operator><name pos:line="36" pos:column="12">req<pos:position pos:line="36" pos:column="15"/></name><operator pos:line="36" pos:column="15">.<pos:position pos:line="36" pos:column="16"/></operator><name pos:line="36" pos:column="16">newurl<pos:position pos:line="36" pos:column="22"/></name></name></expr>)<pos:position pos:line="36" pos:column="23"/></condition><then pos:line="36" pos:column="23"> <block pos:line="36" pos:column="24">{
    <expr_stmt><expr><call><name pos:line="37" pos:column="5">free<pos:position pos:line="37" pos:column="9"/></name><argument_list pos:line="37" pos:column="9">(<argument><expr><name><name pos:line="37" pos:column="10">data<pos:position pos:line="37" pos:column="14"/></name><operator pos:line="37" pos:column="14">-&gt;<pos:position pos:line="37" pos:column="19"/></operator><name pos:line="37" pos:column="16">req<pos:position pos:line="37" pos:column="19"/></name><operator pos:line="37" pos:column="19">.<pos:position pos:line="37" pos:column="20"/></operator><name pos:line="37" pos:column="20">newurl<pos:position pos:line="37" pos:column="26"/></name></name></expr></argument>)<pos:position pos:line="37" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="37" pos:column="28"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="38" pos:column="5">data<pos:position pos:line="38" pos:column="9"/></name><operator pos:line="38" pos:column="9">-&gt;<pos:position pos:line="38" pos:column="14"/></operator><name pos:line="38" pos:column="11">req<pos:position pos:line="38" pos:column="14"/></name><operator pos:line="38" pos:column="14">.<pos:position pos:line="38" pos:column="15"/></operator><name pos:line="38" pos:column="15">newurl<pos:position pos:line="38" pos:column="21"/></name></name> <operator pos:line="38" pos:column="22">=<pos:position pos:line="38" pos:column="23"/></operator> <name pos:line="38" pos:column="24">NULL<pos:position pos:line="38" pos:column="28"/></name></expr>;<pos:position pos:line="38" pos:column="29"/></expr_stmt>
  }<pos:position pos:line="39" pos:column="4"/></block></then></if>

  <if pos:line="41" pos:column="3">if<condition pos:line="41" pos:column="5">(<expr><name><name pos:line="41" pos:column="6">conn<pos:position pos:line="41" pos:column="10"/></name><operator pos:line="41" pos:column="10">-&gt;<pos:position pos:line="41" pos:column="15"/></operator><name pos:line="41" pos:column="12">dns_entry<pos:position pos:line="41" pos:column="21"/></name></name></expr>)<pos:position pos:line="41" pos:column="22"/></condition><then pos:line="41" pos:column="22"> <block pos:line="41" pos:column="23">{
    <expr_stmt><expr><call><name pos:line="42" pos:column="5">Curl_resolv_unlock<pos:position pos:line="42" pos:column="23"/></name><argument_list pos:line="42" pos:column="23">(<argument><expr><name pos:line="42" pos:column="24">data<pos:position pos:line="42" pos:column="28"/></name></expr></argument>, <argument><expr><name><name pos:line="42" pos:column="30">conn<pos:position pos:line="42" pos:column="34"/></name><operator pos:line="42" pos:column="34">-&gt;<pos:position pos:line="42" pos:column="39"/></operator><name pos:line="42" pos:column="36">dns_entry<pos:position pos:line="42" pos:column="45"/></name></name></expr></argument>)<pos:position pos:line="42" pos:column="46"/></argument_list></call></expr>;<pos:position pos:line="42" pos:column="47"/></expr_stmt> <comment type="block" pos:line="42" pos:column="48">/* done with this */</comment>
    <expr_stmt><expr><name><name pos:line="43" pos:column="5">conn<pos:position pos:line="43" pos:column="9"/></name><operator pos:line="43" pos:column="9">-&gt;<pos:position pos:line="43" pos:column="14"/></operator><name pos:line="43" pos:column="11">dns_entry<pos:position pos:line="43" pos:column="20"/></name></name> <operator pos:line="43" pos:column="21">=<pos:position pos:line="43" pos:column="22"/></operator> <name pos:line="43" pos:column="23">NULL<pos:position pos:line="43" pos:column="27"/></name></expr>;<pos:position pos:line="43" pos:column="28"/></expr_stmt>
  }<pos:position pos:line="44" pos:column="4"/></block></then></if>

  <comment type="block" pos:line="46" pos:column="3">/* this calls the protocol-specific function pointer previously set */</comment>
  <if pos:line="47" pos:column="3">if<condition pos:line="47" pos:column="5">(<expr><name><name pos:line="47" pos:column="6">conn<pos:position pos:line="47" pos:column="10"/></name><operator pos:line="47" pos:column="10">-&gt;<pos:position pos:line="47" pos:column="15"/></operator><name pos:line="47" pos:column="12">handler<pos:position pos:line="47" pos:column="19"/></name><operator pos:line="47" pos:column="19">-&gt;<pos:position pos:line="47" pos:column="24"/></operator><name pos:line="47" pos:column="21">done<pos:position pos:line="47" pos:column="25"/></name></name></expr>)<pos:position pos:line="47" pos:column="26"/></condition><then pos:line="47" pos:column="26">
    <block type="pseudo"><expr_stmt><expr><name pos:line="48" pos:column="5">result<pos:position pos:line="48" pos:column="11"/></name> <operator pos:line="48" pos:column="12">=<pos:position pos:line="48" pos:column="13"/></operator> <call><name><name pos:line="48" pos:column="14">conn<pos:position pos:line="48" pos:column="18"/></name><operator pos:line="48" pos:column="18">-&gt;<pos:position pos:line="48" pos:column="23"/></operator><name pos:line="48" pos:column="20">handler<pos:position pos:line="48" pos:column="27"/></name><operator pos:line="48" pos:column="27">-&gt;<pos:position pos:line="48" pos:column="32"/></operator><name pos:line="48" pos:column="29">done<pos:position pos:line="48" pos:column="33"/></name></name><argument_list pos:line="48" pos:column="33">(<argument><expr><name pos:line="48" pos:column="34">conn<pos:position pos:line="48" pos:column="38"/></name></expr></argument>, <argument><expr><name pos:line="48" pos:column="40">status<pos:position pos:line="48" pos:column="46"/></name></expr></argument>, <argument><expr><name pos:line="48" pos:column="48">premature<pos:position pos:line="48" pos:column="57"/></name></expr></argument>)<pos:position pos:line="48" pos:column="58"/></argument_list></call></expr>;<pos:position pos:line="48" pos:column="59"/></expr_stmt></block></then>
  <else pos:line="49" pos:column="3">else
    <block type="pseudo"><expr_stmt><expr><name pos:line="50" pos:column="5">result<pos:position pos:line="50" pos:column="11"/></name> <operator pos:line="50" pos:column="12">=<pos:position pos:line="50" pos:column="13"/></operator> <name pos:line="50" pos:column="14">CURLE_OK<pos:position pos:line="50" pos:column="22"/></name></expr>;<pos:position pos:line="50" pos:column="23"/></expr_stmt></block></else></if>

  <expr_stmt><expr><call><name pos:line="52" pos:column="3">Curl_pgrsDone<pos:position pos:line="52" pos:column="16"/></name><argument_list pos:line="52" pos:column="16">(<argument><expr><name pos:line="52" pos:column="17">conn<pos:position pos:line="52" pos:column="21"/></name></expr></argument>)<pos:position pos:line="52" pos:column="22"/></argument_list></call></expr>;<pos:position pos:line="52" pos:column="23"/></expr_stmt> <comment type="block" pos:line="52" pos:column="24">/* done with the operation */</comment>

  <comment type="block" pos:line="54" pos:column="3">/* if the transfer was completed in a paused state there can be buffered
     data left to write and then kill */</comment>
  <if pos:line="56" pos:column="3">if<condition pos:line="56" pos:column="5">(<expr><name><name pos:line="56" pos:column="6">data<pos:position pos:line="56" pos:column="10"/></name><operator pos:line="56" pos:column="10">-&gt;<pos:position pos:line="56" pos:column="15"/></operator><name pos:line="56" pos:column="12">state<pos:position pos:line="56" pos:column="17"/></name><operator pos:line="56" pos:column="17">.<pos:position pos:line="56" pos:column="18"/></operator><name pos:line="56" pos:column="18">tempwrite<pos:position pos:line="56" pos:column="27"/></name></name></expr>)<pos:position pos:line="56" pos:column="28"/></condition><then pos:line="56" pos:column="28"> <block pos:line="56" pos:column="29">{
    <expr_stmt><expr><call><name pos:line="57" pos:column="5">free<pos:position pos:line="57" pos:column="9"/></name><argument_list pos:line="57" pos:column="9">(<argument><expr><name><name pos:line="57" pos:column="10">data<pos:position pos:line="57" pos:column="14"/></name><operator pos:line="57" pos:column="14">-&gt;<pos:position pos:line="57" pos:column="19"/></operator><name pos:line="57" pos:column="16">state<pos:position pos:line="57" pos:column="21"/></name><operator pos:line="57" pos:column="21">.<pos:position pos:line="57" pos:column="22"/></operator><name pos:line="57" pos:column="22">tempwrite<pos:position pos:line="57" pos:column="31"/></name></name></expr></argument>)<pos:position pos:line="57" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="57" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="58" pos:column="5">data<pos:position pos:line="58" pos:column="9"/></name><operator pos:line="58" pos:column="9">-&gt;<pos:position pos:line="58" pos:column="14"/></operator><name pos:line="58" pos:column="11">state<pos:position pos:line="58" pos:column="16"/></name><operator pos:line="58" pos:column="16">.<pos:position pos:line="58" pos:column="17"/></operator><name pos:line="58" pos:column="17">tempwrite<pos:position pos:line="58" pos:column="26"/></name></name> <operator pos:line="58" pos:column="27">=<pos:position pos:line="58" pos:column="28"/></operator> <name pos:line="58" pos:column="29">NULL<pos:position pos:line="58" pos:column="33"/></name></expr>;<pos:position pos:line="58" pos:column="34"/></expr_stmt>
  }<pos:position pos:line="59" pos:column="4"/></block></then></if>

  <comment type="block" pos:line="61" pos:column="3">/* for ares-using, make sure all possible outstanding requests are properly
     cancelled before we proceed */</comment>
  <expr_stmt><expr><call><name pos:line="63" pos:column="3">ares_cancel<pos:position pos:line="63" pos:column="14"/></name><argument_list pos:line="63" pos:column="14">(<argument><expr><name><name pos:line="63" pos:column="15">data<pos:position pos:line="63" pos:column="19"/></name><operator pos:line="63" pos:column="19">-&gt;<pos:position pos:line="63" pos:column="24"/></operator><name pos:line="63" pos:column="21">state<pos:position pos:line="63" pos:column="26"/></name><operator pos:line="63" pos:column="26">.<pos:position pos:line="63" pos:column="27"/></operator><name pos:line="63" pos:column="27">areschannel<pos:position pos:line="63" pos:column="38"/></name></name></expr></argument>)<pos:position pos:line="63" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="63" pos:column="40"/></expr_stmt>

  <comment type="block" pos:line="65" pos:column="3">/* if data-&gt;set.reuse_forbid is TRUE, it means the libcurl client has
     forced us to close this no matter what we think.

     if conn-&gt;bits.close is TRUE, it means that the connection should be
     closed in spite of all our efforts to be nice, due to protocol
     restrictions in our or the server's end

     if premature is TRUE, it means this connection was said to be DONE before
     the entire request operation is complete and thus we can't know in what
     state it is for re-using, so we're forced to close it. In a perfect world
     we can add code that keep track of if we really must close it here or not,
     but currently we have no such detail knowledge.
  */</comment>
  <if pos:line="78" pos:column="3">if<condition pos:line="78" pos:column="5">(<expr><name><name pos:line="78" pos:column="6">data<pos:position pos:line="78" pos:column="10"/></name><operator pos:line="78" pos:column="10">-&gt;<pos:position pos:line="78" pos:column="15"/></operator><name pos:line="78" pos:column="12">set<pos:position pos:line="78" pos:column="15"/></name><operator pos:line="78" pos:column="15">.<pos:position pos:line="78" pos:column="16"/></operator><name pos:line="78" pos:column="16">reuse_forbid<pos:position pos:line="78" pos:column="28"/></name></name> <operator pos:line="78" pos:column="29">||<pos:position pos:line="78" pos:column="31"/></operator> <name><name pos:line="78" pos:column="32">conn<pos:position pos:line="78" pos:column="36"/></name><operator pos:line="78" pos:column="36">-&gt;<pos:position pos:line="78" pos:column="41"/></operator><name pos:line="78" pos:column="38">bits<pos:position pos:line="78" pos:column="42"/></name><operator pos:line="78" pos:column="42">.<pos:position pos:line="78" pos:column="43"/></operator><name pos:line="78" pos:column="43">close<pos:position pos:line="78" pos:column="48"/></name></name> <operator pos:line="78" pos:column="49">||<pos:position pos:line="78" pos:column="51"/></operator> <name pos:line="78" pos:column="52">premature<pos:position pos:line="78" pos:column="61"/></name></expr>)<pos:position pos:line="78" pos:column="62"/></condition><then pos:line="78" pos:column="62"> <block pos:line="78" pos:column="63">{
    <decl_stmt><decl><type><name pos:line="79" pos:column="5">CURLcode<pos:position pos:line="79" pos:column="13"/></name></type> <name pos:line="79" pos:column="14">res2<pos:position pos:line="79" pos:column="18"/></name> <init pos:line="79" pos:column="19">= <expr><call><name pos:line="79" pos:column="21">Curl_disconnect<pos:position pos:line="79" pos:column="36"/></name><argument_list pos:line="79" pos:column="36">(<argument><expr><name pos:line="79" pos:column="37">conn<pos:position pos:line="79" pos:column="41"/></name></expr></argument>)<pos:position pos:line="79" pos:column="42"/></argument_list></call></expr></init></decl>;<pos:position pos:line="79" pos:column="43"/></decl_stmt> <comment type="block" pos:line="79" pos:column="44">/* close the connection */</comment>

    <comment type="block" pos:line="81" pos:column="5">/* If we had an error already, make sure we return that one. But
       if we got a new error, return that. */</comment>
    <if pos:line="83" pos:column="5">if<condition pos:line="83" pos:column="7">(<expr><operator pos:line="83" pos:column="8">!<pos:position pos:line="83" pos:column="9"/></operator><name pos:line="83" pos:column="9">result<pos:position pos:line="83" pos:column="15"/></name> <operator pos:line="83" pos:column="16">&amp;&amp;<pos:position pos:line="83" pos:column="26"/></operator> <name pos:line="83" pos:column="19">res2<pos:position pos:line="83" pos:column="23"/></name></expr>)<pos:position pos:line="83" pos:column="24"/></condition><then pos:line="83" pos:column="24">
      <block type="pseudo"><expr_stmt><expr><name pos:line="84" pos:column="7">result<pos:position pos:line="84" pos:column="13"/></name> <operator pos:line="84" pos:column="14">=<pos:position pos:line="84" pos:column="15"/></operator> <name pos:line="84" pos:column="16">res2<pos:position pos:line="84" pos:column="20"/></name></expr>;<pos:position pos:line="84" pos:column="21"/></expr_stmt></block></then></if>
  }<pos:position pos:line="85" pos:column="4"/></block></then>
  <else pos:line="86" pos:column="3">else <block pos:line="86" pos:column="8">{
    <expr_stmt><expr><call><name pos:line="87" pos:column="5">ConnectionDone<pos:position pos:line="87" pos:column="19"/></name><argument_list pos:line="87" pos:column="19">(<argument><expr><name pos:line="87" pos:column="20">conn<pos:position pos:line="87" pos:column="24"/></name></expr></argument>)<pos:position pos:line="87" pos:column="25"/></argument_list></call></expr>;<pos:position pos:line="87" pos:column="26"/></expr_stmt> <comment type="block" pos:line="87" pos:column="27">/* the connection is no longer in use */</comment>

    <comment type="block" pos:line="89" pos:column="5">/* remember the most recently used connection */</comment>
    <expr_stmt><expr><name><name pos:line="90" pos:column="5">data<pos:position pos:line="90" pos:column="9"/></name><operator pos:line="90" pos:column="9">-&gt;<pos:position pos:line="90" pos:column="14"/></operator><name pos:line="90" pos:column="11">state<pos:position pos:line="90" pos:column="16"/></name><operator pos:line="90" pos:column="16">.<pos:position pos:line="90" pos:column="17"/></operator><name pos:line="90" pos:column="17">lastconnect<pos:position pos:line="90" pos:column="28"/></name></name> <operator pos:line="90" pos:column="29">=<pos:position pos:line="90" pos:column="30"/></operator> <name><name pos:line="90" pos:column="31">conn<pos:position pos:line="90" pos:column="35"/></name><operator pos:line="90" pos:column="35">-&gt;<pos:position pos:line="90" pos:column="40"/></operator><name pos:line="90" pos:column="37">connectindex<pos:position pos:line="90" pos:column="49"/></name></name></expr>;<pos:position pos:line="90" pos:column="50"/></expr_stmt>

    <expr_stmt><expr><call><name pos:line="92" pos:column="5">infof<pos:position pos:line="92" pos:column="10"/></name><argument_list pos:line="92" pos:column="10">(<argument><expr><name pos:line="92" pos:column="11">data<pos:position pos:line="92" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="92" pos:column="17">"Connection #%ld to host %s left intact\n"<pos:position pos:line="92" pos:column="59"/></literal></expr></argument>,
          <argument><expr><name><name pos:line="93" pos:column="11">conn<pos:position pos:line="93" pos:column="15"/></name><operator pos:line="93" pos:column="15">-&gt;<pos:position pos:line="93" pos:column="20"/></operator><name pos:line="93" pos:column="17">connectindex<pos:position pos:line="93" pos:column="29"/></name></name></expr></argument>,
          <argument><expr><ternary><condition><expr><name><name pos:line="94" pos:column="11">conn<pos:position pos:line="94" pos:column="15"/></name><operator pos:line="94" pos:column="15">-&gt;<pos:position pos:line="94" pos:column="20"/></operator><name pos:line="94" pos:column="17">bits<pos:position pos:line="94" pos:column="21"/></name><operator pos:line="94" pos:column="21">.<pos:position pos:line="94" pos:column="22"/></operator><name pos:line="94" pos:column="22">httpproxy<pos:position pos:line="94" pos:column="31"/></name></name></expr>?<pos:position pos:line="94" pos:column="32"/></condition><then><expr><name><name pos:line="94" pos:column="32">conn<pos:position pos:line="94" pos:column="36"/></name><operator pos:line="94" pos:column="36">-&gt;<pos:position pos:line="94" pos:column="41"/></operator><name pos:line="94" pos:column="38">proxy<pos:position pos:line="94" pos:column="43"/></name><operator pos:line="94" pos:column="43">.<pos:position pos:line="94" pos:column="44"/></operator><name pos:line="94" pos:column="44">dispname<pos:position pos:line="94" pos:column="52"/></name></name></expr></then><else pos:line="94" pos:column="52">:<expr><name><name pos:line="94" pos:column="53">conn<pos:position pos:line="94" pos:column="57"/></name><operator pos:line="94" pos:column="57">-&gt;<pos:position pos:line="94" pos:column="62"/></operator><name pos:line="94" pos:column="59">host<pos:position pos:line="94" pos:column="63"/></name><operator pos:line="94" pos:column="63">.<pos:position pos:line="94" pos:column="64"/></operator><name pos:line="94" pos:column="64">dispname<pos:position pos:line="94" pos:column="72"/></name></name></expr></else></ternary></expr></argument>)<pos:position pos:line="94" pos:column="73"/></argument_list></call></expr>;<pos:position pos:line="94" pos:column="74"/></expr_stmt>
  }<pos:position pos:line="95" pos:column="4"/></block></else></if>

  <expr_stmt><expr><operator pos:line="97" pos:column="3">*<pos:position pos:line="97" pos:column="4"/></operator><name pos:line="97" pos:column="4">connp<pos:position pos:line="97" pos:column="9"/></name> <operator pos:line="97" pos:column="10">=<pos:position pos:line="97" pos:column="11"/></operator> <name pos:line="97" pos:column="12">NULL<pos:position pos:line="97" pos:column="16"/></name></expr>;<pos:position pos:line="97" pos:column="17"/></expr_stmt> <comment type="block" pos:line="97" pos:column="18">/* to make the caller of this function better detect that
                    this was either closed or handed over to the connection
                    cache here, and therefore cannot be used from this point on
                 */</comment>

  <return pos:line="102" pos:column="3">return <expr><name pos:line="102" pos:column="10">result<pos:position pos:line="102" pos:column="16"/></name></expr>;<pos:position pos:line="102" pos:column="17"/></return>
}<pos:position pos:line="103" pos:column="2"/></block></function></unit>
