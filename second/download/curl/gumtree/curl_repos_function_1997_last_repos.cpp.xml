<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/curl/gumtree/curl_repos_function_1997_last_repos.cpp" pos:tabs="8"><function><type><name><name pos:line="1" pos:column="1">struct<pos:position pos:line="1" pos:column="7"/></name> <name pos:line="1" pos:column="8">Cookie<pos:position pos:line="1" pos:column="14"/></name></name> <modifier pos:line="1" pos:column="15">*<pos:position pos:line="1" pos:column="16"/></modifier></type>
<name pos:line="2" pos:column="1">Curl_cookie_add<pos:position pos:line="2" pos:column="16"/></name><parameter_list pos:line="2" pos:column="16">(<parameter><decl><type><name><name pos:line="2" pos:column="17">struct<pos:position pos:line="2" pos:column="23"/></name> <name pos:line="2" pos:column="24">Curl_easy<pos:position pos:line="2" pos:column="33"/></name></name> <modifier pos:line="2" pos:column="34">*<pos:position pos:line="2" pos:column="35"/></modifier></type><name pos:line="2" pos:column="35">data<pos:position pos:line="2" pos:column="39"/></name></decl></parameter>,
                <comment type="block" pos:line="3" pos:column="17">/* The 'data' pointer here may be NULL at times, and thus
                   must only be used very carefully for things that can deal
                   with data being NULL. Such as infof() and similar */</comment>

                <parameter><decl><type><name><name pos:line="7" pos:column="17">struct<pos:position pos:line="7" pos:column="23"/></name> <name pos:line="7" pos:column="24">CookieInfo<pos:position pos:line="7" pos:column="34"/></name></name> <modifier pos:line="7" pos:column="35">*<pos:position pos:line="7" pos:column="36"/></modifier></type><name pos:line="7" pos:column="36">c<pos:position pos:line="7" pos:column="37"/></name></decl></parameter>,
                <parameter><decl><type><name pos:line="8" pos:column="17">bool<pos:position pos:line="8" pos:column="21"/></name></type> <name pos:line="8" pos:column="22">httpheader<pos:position pos:line="8" pos:column="32"/></name></decl></parameter>, <comment type="block" pos:line="8" pos:column="34">/* TRUE if HTTP header-style line */</comment>
                <parameter><decl><type><name pos:line="9" pos:column="17">char<pos:position pos:line="9" pos:column="21"/></name> <modifier pos:line="9" pos:column="22">*<pos:position pos:line="9" pos:column="23"/></modifier></type><name pos:line="9" pos:column="23">lineptr<pos:position pos:line="9" pos:column="30"/></name></decl></parameter>,   <comment type="block" pos:line="9" pos:column="34">/* first character of the line */</comment>
                <parameter><decl><type><specifier pos:line="10" pos:column="17">const<pos:position pos:line="10" pos:column="22"/></specifier> <name pos:line="10" pos:column="23">char<pos:position pos:line="10" pos:column="27"/></name> <modifier pos:line="10" pos:column="28">*<pos:position pos:line="10" pos:column="29"/></modifier></type><name pos:line="10" pos:column="29">domain<pos:position pos:line="10" pos:column="35"/></name></decl></parameter>, <comment type="block" pos:line="10" pos:column="37">/* default domain */</comment>
                <parameter><decl><type><specifier pos:line="11" pos:column="17">const<pos:position pos:line="11" pos:column="22"/></specifier> <name pos:line="11" pos:column="23">char<pos:position pos:line="11" pos:column="27"/></name> <modifier pos:line="11" pos:column="28">*<pos:position pos:line="11" pos:column="29"/></modifier></type><name pos:line="11" pos:column="29">path<pos:position pos:line="11" pos:column="33"/></name></decl></parameter>)<pos:position pos:line="11" pos:column="34"/></parameter_list>   <comment type="block" pos:line="11" pos:column="37">/* full path used when this cookie is set,
                                       used to get default path for the cookie
                                       unless set */</comment>
<block pos:line="14" pos:column="1">{
  <decl_stmt><decl><type><name><name pos:line="15" pos:column="3">struct<pos:position pos:line="15" pos:column="9"/></name> <name pos:line="15" pos:column="10">Cookie<pos:position pos:line="15" pos:column="16"/></name></name> <modifier pos:line="15" pos:column="17">*<pos:position pos:line="15" pos:column="18"/></modifier></type><name pos:line="15" pos:column="18">clist<pos:position pos:line="15" pos:column="23"/></name></decl>;<pos:position pos:line="15" pos:column="24"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="16" pos:column="3">struct<pos:position pos:line="16" pos:column="9"/></name> <name pos:line="16" pos:column="10">Cookie<pos:position pos:line="16" pos:column="16"/></name></name> <modifier pos:line="16" pos:column="17">*<pos:position pos:line="16" pos:column="18"/></modifier></type><name pos:line="16" pos:column="18">co<pos:position pos:line="16" pos:column="20"/></name></decl>;<pos:position pos:line="16" pos:column="21"/></decl_stmt>
  <decl_stmt><decl><type><name><name pos:line="17" pos:column="3">struct<pos:position pos:line="17" pos:column="9"/></name> <name pos:line="17" pos:column="10">Cookie<pos:position pos:line="17" pos:column="16"/></name></name> <modifier pos:line="17" pos:column="17">*<pos:position pos:line="17" pos:column="18"/></modifier></type><name pos:line="17" pos:column="18">lastc<pos:position pos:line="17" pos:column="23"/></name> <init pos:line="17" pos:column="24">= <expr><name pos:line="17" pos:column="26">NULL<pos:position pos:line="17" pos:column="30"/></name></expr></init></decl>;<pos:position pos:line="17" pos:column="31"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="18" pos:column="3">time_t<pos:position pos:line="18" pos:column="9"/></name></type> <name pos:line="18" pos:column="10">now<pos:position pos:line="18" pos:column="13"/></name> <init pos:line="18" pos:column="14">= <expr><call><name pos:line="18" pos:column="16">time<pos:position pos:line="18" pos:column="20"/></name><argument_list pos:line="18" pos:column="20">(<argument><expr><name pos:line="18" pos:column="21">NULL<pos:position pos:line="18" pos:column="25"/></name></expr></argument>)<pos:position pos:line="18" pos:column="26"/></argument_list></call></expr></init></decl>;<pos:position pos:line="18" pos:column="27"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="19" pos:column="3">bool<pos:position pos:line="19" pos:column="7"/></name></type> <name pos:line="19" pos:column="8">replace_old<pos:position pos:line="19" pos:column="19"/></name> <init pos:line="19" pos:column="20">= <expr><name pos:line="19" pos:column="22">FALSE<pos:position pos:line="19" pos:column="27"/></name></expr></init></decl>;<pos:position pos:line="19" pos:column="28"/></decl_stmt>
  <decl_stmt><decl><type><name pos:line="20" pos:column="3">bool<pos:position pos:line="20" pos:column="7"/></name></type> <name pos:line="20" pos:column="8">badcookie<pos:position pos:line="20" pos:column="17"/></name> <init pos:line="20" pos:column="18">= <expr><name pos:line="20" pos:column="20">FALSE<pos:position pos:line="20" pos:column="25"/></name></expr></init></decl>;<pos:position pos:line="20" pos:column="26"/></decl_stmt> <comment type="block" pos:line="20" pos:column="27">/* cookies are good by default. mmmmm yummy */</comment>

<cpp:ifdef pos:line="22" pos:column="1">#<cpp:directive pos:line="22" pos:column="2">ifdef<pos:position pos:line="22" pos:column="7"/></cpp:directive> <name pos:line="22" pos:column="8">USE_LIBPSL<pos:position pos:line="22" pos:column="18"/></name></cpp:ifdef>
  <decl_stmt><decl><type><specifier pos:line="23" pos:column="3">const<pos:position pos:line="23" pos:column="8"/></specifier> <name pos:line="23" pos:column="9">psl_ctx_t<pos:position pos:line="23" pos:column="18"/></name> <modifier pos:line="23" pos:column="19">*<pos:position pos:line="23" pos:column="20"/></modifier></type><name pos:line="23" pos:column="20">psl<pos:position pos:line="23" pos:column="23"/></name></decl>;<pos:position pos:line="23" pos:column="24"/></decl_stmt>
<cpp:endif pos:line="24" pos:column="1">#<cpp:directive pos:line="24" pos:column="2">endif<pos:position pos:line="24" pos:column="7"/></cpp:directive></cpp:endif>

<cpp:ifdef pos:line="26" pos:column="1">#<cpp:directive pos:line="26" pos:column="2">ifdef<pos:position pos:line="26" pos:column="7"/></cpp:directive> <name pos:line="26" pos:column="8">CURL_DISABLE_VERBOSE_STRINGS<pos:position pos:line="26" pos:column="36"/></name></cpp:ifdef>
  <expr_stmt><expr><operator pos:line="27" pos:column="3">(<pos:position pos:line="27" pos:column="4"/></operator><name pos:line="27" pos:column="4">void<pos:position pos:line="27" pos:column="8"/></name><operator pos:line="27" pos:column="8">)<pos:position pos:line="27" pos:column="9"/></operator><name pos:line="27" pos:column="9">data<pos:position pos:line="27" pos:column="13"/></name></expr>;<pos:position pos:line="27" pos:column="14"/></expr_stmt>
<cpp:endif pos:line="28" pos:column="1">#<cpp:directive pos:line="28" pos:column="2">endif<pos:position pos:line="28" pos:column="7"/></cpp:directive></cpp:endif>

  <comment type="block" pos:line="30" pos:column="3">/* First, alloc and init a new struct for it */</comment>
  <expr_stmt><expr><name pos:line="31" pos:column="3">co<pos:position pos:line="31" pos:column="5"/></name> <operator pos:line="31" pos:column="6">=<pos:position pos:line="31" pos:column="7"/></operator> <call><name pos:line="31" pos:column="8">calloc<pos:position pos:line="31" pos:column="14"/></name><argument_list pos:line="31" pos:column="14">(<argument><expr><literal type="number" pos:line="31" pos:column="15">1<pos:position pos:line="31" pos:column="16"/></literal></expr></argument>, <argument><expr><sizeof pos:line="31" pos:column="18">sizeof<argument_list pos:line="31" pos:column="24">(<argument><expr pos:line="31" pos:column="25">struct <name pos:line="31" pos:column="32">Cookie<pos:position pos:line="31" pos:column="38"/></name></expr></argument>)<pos:position pos:line="31" pos:column="39"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="31" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="31" pos:column="41"/></expr_stmt>
  <if pos:line="32" pos:column="3">if<condition pos:line="32" pos:column="5">(<expr><operator pos:line="32" pos:column="6">!<pos:position pos:line="32" pos:column="7"/></operator><name pos:line="32" pos:column="7">co<pos:position pos:line="32" pos:column="9"/></name></expr>)<pos:position pos:line="32" pos:column="10"/></condition><then pos:line="32" pos:column="10">
    <block type="pseudo"><return pos:line="33" pos:column="5">return <expr><name pos:line="33" pos:column="12">NULL<pos:position pos:line="33" pos:column="16"/></name></expr>;<pos:position pos:line="33" pos:column="17"/></return></block></then></if> <comment type="block" pos:line="33" pos:column="18">/* bail out if we're this low on memory */</comment>

  <if pos:line="35" pos:column="3">if<condition pos:line="35" pos:column="5">(<expr><name pos:line="35" pos:column="6">httpheader<pos:position pos:line="35" pos:column="16"/></name></expr>)<pos:position pos:line="35" pos:column="17"/></condition><then pos:line="35" pos:column="17"> <block pos:line="35" pos:column="18">{
    <comment type="block" pos:line="36" pos:column="5">/* This line was read off a HTTP-header */</comment>
    <decl_stmt><decl><type><name pos:line="37" pos:column="5">char<pos:position pos:line="37" pos:column="9"/></name></type> <name><name pos:line="37" pos:column="10">name<pos:position pos:line="37" pos:column="14"/></name><index pos:line="37" pos:column="14">[<expr><name pos:line="37" pos:column="15">MAX_NAME<pos:position pos:line="37" pos:column="23"/></name></expr>]<pos:position pos:line="37" pos:column="24"/></index></name></decl>;<pos:position pos:line="37" pos:column="25"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="38" pos:column="5">char<pos:position pos:line="38" pos:column="9"/></name></type> <name><name pos:line="38" pos:column="10">what<pos:position pos:line="38" pos:column="14"/></name><index pos:line="38" pos:column="14">[<expr><name pos:line="38" pos:column="15">MAX_NAME<pos:position pos:line="38" pos:column="23"/></name></expr>]<pos:position pos:line="38" pos:column="24"/></index></name></decl>;<pos:position pos:line="38" pos:column="25"/></decl_stmt>
    <decl_stmt><decl><type><specifier pos:line="39" pos:column="5">const<pos:position pos:line="39" pos:column="10"/></specifier> <name pos:line="39" pos:column="11">char<pos:position pos:line="39" pos:column="15"/></name> <modifier pos:line="39" pos:column="16">*<pos:position pos:line="39" pos:column="17"/></modifier></type><name pos:line="39" pos:column="17">ptr<pos:position pos:line="39" pos:column="20"/></name></decl>;<pos:position pos:line="39" pos:column="21"/></decl_stmt>
    <decl_stmt><decl><type><specifier pos:line="40" pos:column="5">const<pos:position pos:line="40" pos:column="10"/></specifier> <name pos:line="40" pos:column="11">char<pos:position pos:line="40" pos:column="15"/></name> <modifier pos:line="40" pos:column="16">*<pos:position pos:line="40" pos:column="17"/></modifier></type><name pos:line="40" pos:column="17">semiptr<pos:position pos:line="40" pos:column="24"/></name></decl>;<pos:position pos:line="40" pos:column="25"/></decl_stmt>

    <decl_stmt><decl><type><name pos:line="42" pos:column="5">size_t<pos:position pos:line="42" pos:column="11"/></name></type> <name pos:line="42" pos:column="12">linelength<pos:position pos:line="42" pos:column="22"/></name> <init pos:line="42" pos:column="23">= <expr><call><name pos:line="42" pos:column="25">strlen<pos:position pos:line="42" pos:column="31"/></name><argument_list pos:line="42" pos:column="31">(<argument><expr><name pos:line="42" pos:column="32">lineptr<pos:position pos:line="42" pos:column="39"/></name></expr></argument>)<pos:position pos:line="42" pos:column="40"/></argument_list></call></expr></init></decl>;<pos:position pos:line="42" pos:column="41"/></decl_stmt>
    <if pos:line="43" pos:column="5">if<condition pos:line="43" pos:column="7">(<expr><name pos:line="43" pos:column="8">linelength<pos:position pos:line="43" pos:column="18"/></name> <operator pos:line="43" pos:column="19">&gt;<pos:position pos:line="43" pos:column="23"/></operator> <name pos:line="43" pos:column="21">MAX_COOKIE_LINE<pos:position pos:line="43" pos:column="36"/></name></expr>)<pos:position pos:line="43" pos:column="37"/></condition><then pos:line="43" pos:column="37"> <block pos:line="43" pos:column="38">{
      <comment type="block" pos:line="44" pos:column="7">/* discard overly long lines at once */</comment>
      <expr_stmt><expr><call><name pos:line="45" pos:column="7">free<pos:position pos:line="45" pos:column="11"/></name><argument_list pos:line="45" pos:column="11">(<argument><expr><name pos:line="45" pos:column="12">co<pos:position pos:line="45" pos:column="14"/></name></expr></argument>)<pos:position pos:line="45" pos:column="15"/></argument_list></call></expr>;<pos:position pos:line="45" pos:column="16"/></expr_stmt>
      <return pos:line="46" pos:column="7">return <expr><name pos:line="46" pos:column="14">NULL<pos:position pos:line="46" pos:column="18"/></name></expr>;<pos:position pos:line="46" pos:column="19"/></return>
    }<pos:position pos:line="47" pos:column="6"/></block></then></if>

    <expr_stmt><expr><name pos:line="49" pos:column="5">semiptr<pos:position pos:line="49" pos:column="12"/></name> <operator pos:line="49" pos:column="13">=<pos:position pos:line="49" pos:column="14"/></operator> <call><name pos:line="49" pos:column="15">strchr<pos:position pos:line="49" pos:column="21"/></name><argument_list pos:line="49" pos:column="21">(<argument><expr><name pos:line="49" pos:column="22">lineptr<pos:position pos:line="49" pos:column="29"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="49" pos:column="31">';'<pos:position pos:line="49" pos:column="34"/></literal></expr></argument>)<pos:position pos:line="49" pos:column="35"/></argument_list></call></expr>;<pos:position pos:line="49" pos:column="36"/></expr_stmt> <comment type="block" pos:line="49" pos:column="37">/* first, find a semicolon */</comment>

    <while pos:line="51" pos:column="5">while<condition pos:line="51" pos:column="10">(<expr><operator pos:line="51" pos:column="11">*<pos:position pos:line="51" pos:column="12"/></operator><name pos:line="51" pos:column="12">lineptr<pos:position pos:line="51" pos:column="19"/></name> <operator pos:line="51" pos:column="20">&amp;&amp;<pos:position pos:line="51" pos:column="30"/></operator> <call><name pos:line="51" pos:column="23">ISBLANK<pos:position pos:line="51" pos:column="30"/></name><argument_list pos:line="51" pos:column="30">(<argument><expr><operator pos:line="51" pos:column="31">*<pos:position pos:line="51" pos:column="32"/></operator><name pos:line="51" pos:column="32">lineptr<pos:position pos:line="51" pos:column="39"/></name></expr></argument>)<pos:position pos:line="51" pos:column="40"/></argument_list></call></expr>)<pos:position pos:line="51" pos:column="41"/></condition>
      <block type="pseudo"><expr_stmt><expr><name pos:line="52" pos:column="7">lineptr<pos:position pos:line="52" pos:column="14"/></name><operator pos:line="52" pos:column="14">++<pos:position pos:line="52" pos:column="16"/></operator></expr>;<pos:position pos:line="52" pos:column="17"/></expr_stmt></block></while>

    <expr_stmt><expr><name pos:line="54" pos:column="5">ptr<pos:position pos:line="54" pos:column="8"/></name> <operator pos:line="54" pos:column="9">=<pos:position pos:line="54" pos:column="10"/></operator> <name pos:line="54" pos:column="11">lineptr<pos:position pos:line="54" pos:column="18"/></name></expr>;<pos:position pos:line="54" pos:column="19"/></expr_stmt>
    <do pos:line="55" pos:column="5">do <block pos:line="55" pos:column="8">{
      <comment type="block" pos:line="56" pos:column="7">/* we have a &lt;what&gt;=&lt;this&gt; pair or a stand-alone word here */</comment>
      <expr_stmt><expr><name><name pos:line="57" pos:column="7">name<pos:position pos:line="57" pos:column="11"/></name><index pos:line="57" pos:column="11">[<expr><literal type="number" pos:line="57" pos:column="12">0<pos:position pos:line="57" pos:column="13"/></literal></expr>]<pos:position pos:line="57" pos:column="14"/></index></name> <operator pos:line="57" pos:column="15">=<pos:position pos:line="57" pos:column="16"/></operator> <name><name pos:line="57" pos:column="17">what<pos:position pos:line="57" pos:column="21"/></name><index pos:line="57" pos:column="21">[<expr><literal type="number" pos:line="57" pos:column="22">0<pos:position pos:line="57" pos:column="23"/></literal></expr>]<pos:position pos:line="57" pos:column="24"/></index></name> <operator pos:line="57" pos:column="25">=<pos:position pos:line="57" pos:column="26"/></operator> <literal type="number" pos:line="57" pos:column="27">0<pos:position pos:line="57" pos:column="28"/></literal></expr>;<pos:position pos:line="57" pos:column="29"/></expr_stmt> <comment type="block" pos:line="57" pos:column="30">/* init the buffers */</comment>
      <if pos:line="58" pos:column="7">if<condition pos:line="58" pos:column="9">(<expr><literal type="number" pos:line="58" pos:column="10">1<pos:position pos:line="58" pos:column="11"/></literal> <operator pos:line="58" pos:column="12">&lt;=<pos:position pos:line="58" pos:column="17"/></operator> <call><name pos:line="58" pos:column="15">sscanf<pos:position pos:line="58" pos:column="21"/></name><argument_list pos:line="58" pos:column="21">(<argument><expr><name pos:line="58" pos:column="22">ptr<pos:position pos:line="58" pos:column="25"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="58" pos:column="27">"%"<pos:position pos:line="58" pos:column="30"/></literal> <name pos:line="58" pos:column="31">MAX_NAME_TXT<pos:position pos:line="58" pos:column="43"/></name> <literal type="string" pos:line="58" pos:column="44">"[^;\r\n=] =%"<pos:position pos:line="58" pos:column="58"/></literal>
                     <name pos:line="59" pos:column="22">MAX_NAME_TXT<pos:position pos:line="59" pos:column="34"/></name> <literal type="string" pos:line="59" pos:column="35">"[^;\r\n]"<pos:position pos:line="59" pos:column="45"/></literal></expr></argument>,
                     <argument><expr><name pos:line="60" pos:column="22">name<pos:position pos:line="60" pos:column="26"/></name></expr></argument>, <argument><expr><name pos:line="60" pos:column="28">what<pos:position pos:line="60" pos:column="32"/></name></expr></argument>)<pos:position pos:line="60" pos:column="33"/></argument_list></call></expr>)<pos:position pos:line="60" pos:column="34"/></condition><then pos:line="60" pos:column="34"> <block pos:line="60" pos:column="35">{
        <comment type="block" pos:line="61" pos:column="9">/* Use strstore() below to properly deal with received cookie
           headers that have the same string property set more than once,
           and then we use the last one. */</comment>
        <decl_stmt><decl><type><specifier pos:line="64" pos:column="9">const<pos:position pos:line="64" pos:column="14"/></specifier> <name pos:line="64" pos:column="15">char<pos:position pos:line="64" pos:column="19"/></name> <modifier pos:line="64" pos:column="20">*<pos:position pos:line="64" pos:column="21"/></modifier></type><name pos:line="64" pos:column="21">whatptr<pos:position pos:line="64" pos:column="28"/></name></decl>;<pos:position pos:line="64" pos:column="29"/></decl_stmt>
        <decl_stmt><decl><type><name pos:line="65" pos:column="9">bool<pos:position pos:line="65" pos:column="13"/></name></type> <name pos:line="65" pos:column="14">done<pos:position pos:line="65" pos:column="18"/></name> <init pos:line="65" pos:column="19">= <expr><name pos:line="65" pos:column="21">FALSE<pos:position pos:line="65" pos:column="26"/></name></expr></init></decl>;<pos:position pos:line="65" pos:column="27"/></decl_stmt>
        <decl_stmt><decl><type><name pos:line="66" pos:column="9">bool<pos:position pos:line="66" pos:column="13"/></name></type> <name pos:line="66" pos:column="14">sep<pos:position pos:line="66" pos:column="17"/></name></decl>;<pos:position pos:line="66" pos:column="18"/></decl_stmt>
        <decl_stmt><decl><type><name pos:line="67" pos:column="9">size_t<pos:position pos:line="67" pos:column="15"/></name></type> <name pos:line="67" pos:column="16">len<pos:position pos:line="67" pos:column="19"/></name> <init pos:line="67" pos:column="20">= <expr><call><name pos:line="67" pos:column="22">strlen<pos:position pos:line="67" pos:column="28"/></name><argument_list pos:line="67" pos:column="28">(<argument><expr><name pos:line="67" pos:column="29">what<pos:position pos:line="67" pos:column="33"/></name></expr></argument>)<pos:position pos:line="67" pos:column="34"/></argument_list></call></expr></init></decl>;<pos:position pos:line="67" pos:column="35"/></decl_stmt>
        <decl_stmt><decl><type><name pos:line="68" pos:column="9">size_t<pos:position pos:line="68" pos:column="15"/></name></type> <name pos:line="68" pos:column="16">nlen<pos:position pos:line="68" pos:column="20"/></name> <init pos:line="68" pos:column="21">= <expr><call><name pos:line="68" pos:column="23">strlen<pos:position pos:line="68" pos:column="29"/></name><argument_list pos:line="68" pos:column="29">(<argument><expr><name pos:line="68" pos:column="30">name<pos:position pos:line="68" pos:column="34"/></name></expr></argument>)<pos:position pos:line="68" pos:column="35"/></argument_list></call></expr></init></decl>;<pos:position pos:line="68" pos:column="36"/></decl_stmt>
        <decl_stmt><decl><type><specifier pos:line="69" pos:column="9">const<pos:position pos:line="69" pos:column="14"/></specifier> <name pos:line="69" pos:column="15">char<pos:position pos:line="69" pos:column="19"/></name> <modifier pos:line="69" pos:column="20">*<pos:position pos:line="69" pos:column="21"/></modifier></type><name pos:line="69" pos:column="21">endofn<pos:position pos:line="69" pos:column="27"/></name> <init pos:line="69" pos:column="28">= <expr><operator pos:line="69" pos:column="30">&amp;<pos:position pos:line="69" pos:column="35"/></operator><name><name pos:line="69" pos:column="31">ptr<pos:position pos:line="69" pos:column="34"/></name><index pos:line="69" pos:column="34">[ <expr><name pos:line="69" pos:column="36">nlen<pos:position pos:line="69" pos:column="40"/></name></expr> ]<pos:position pos:line="69" pos:column="42"/></index></name></expr></init></decl>;<pos:position pos:line="69" pos:column="43"/></decl_stmt>

        <expr_stmt><expr><call><name pos:line="71" pos:column="9">infof<pos:position pos:line="71" pos:column="14"/></name><argument_list pos:line="71" pos:column="14">(<argument><expr><name pos:line="71" pos:column="15">data<pos:position pos:line="71" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="71" pos:column="21">"cookie size: name/val %d + %d bytes\n"<pos:position pos:line="71" pos:column="60"/></literal></expr></argument>,
              <argument><expr><name pos:line="72" pos:column="15">nlen<pos:position pos:line="72" pos:column="19"/></name></expr></argument>, <argument><expr><name pos:line="72" pos:column="21">len<pos:position pos:line="72" pos:column="24"/></name></expr></argument>)<pos:position pos:line="72" pos:column="25"/></argument_list></call></expr>;<pos:position pos:line="72" pos:column="26"/></expr_stmt>

        <if pos:line="74" pos:column="9">if<condition pos:line="74" pos:column="11">(<expr><name pos:line="74" pos:column="12">nlen<pos:position pos:line="74" pos:column="16"/></name> <operator pos:line="74" pos:column="17">&gt;=<pos:position pos:line="74" pos:column="22"/></operator> <operator pos:line="74" pos:column="20">(<pos:position pos:line="74" pos:column="21"/></operator><name pos:line="74" pos:column="21">MAX_NAME<pos:position pos:line="74" pos:column="29"/></name><operator pos:line="74" pos:column="29">-<pos:position pos:line="74" pos:column="30"/></operator><literal type="number" pos:line="74" pos:column="30">1<pos:position pos:line="74" pos:column="31"/></literal><operator pos:line="74" pos:column="31">)<pos:position pos:line="74" pos:column="32"/></operator> <operator pos:line="74" pos:column="33">||<pos:position pos:line="74" pos:column="35"/></operator> <name pos:line="74" pos:column="36">len<pos:position pos:line="74" pos:column="39"/></name> <operator pos:line="74" pos:column="40">&gt;=<pos:position pos:line="74" pos:column="45"/></operator> <operator pos:line="74" pos:column="43">(<pos:position pos:line="74" pos:column="44"/></operator><name pos:line="74" pos:column="44">MAX_NAME<pos:position pos:line="74" pos:column="52"/></name><operator pos:line="74" pos:column="52">-<pos:position pos:line="74" pos:column="53"/></operator><literal type="number" pos:line="74" pos:column="53">1<pos:position pos:line="74" pos:column="54"/></literal><operator pos:line="74" pos:column="54">)<pos:position pos:line="74" pos:column="55"/></operator> <operator pos:line="74" pos:column="56">||<pos:position pos:line="74" pos:column="58"/></operator>
           <operator pos:line="75" pos:column="12">(<pos:position pos:line="75" pos:column="13"/></operator><operator pos:line="75" pos:column="13">(<pos:position pos:line="75" pos:column="14"/></operator><name pos:line="75" pos:column="14">nlen<pos:position pos:line="75" pos:column="18"/></name> <operator pos:line="75" pos:column="19">+<pos:position pos:line="75" pos:column="20"/></operator> <name pos:line="75" pos:column="21">len<pos:position pos:line="75" pos:column="24"/></name><operator pos:line="75" pos:column="24">)<pos:position pos:line="75" pos:column="25"/></operator> <operator pos:line="75" pos:column="26">&gt;<pos:position pos:line="75" pos:column="30"/></operator> <name pos:line="75" pos:column="28">MAX_NAME<pos:position pos:line="75" pos:column="36"/></name><operator pos:line="75" pos:column="36">)<pos:position pos:line="75" pos:column="37"/></operator></expr>)<pos:position pos:line="75" pos:column="38"/></condition><then pos:line="75" pos:column="38"> <block pos:line="75" pos:column="39">{
          <comment type="block" pos:line="76" pos:column="11">/* too long individual name or contents, or too long combination of
             name + contents. Chrome and Firefox support 4095 or 4096 bytes
             combo. */</comment>
          <expr_stmt><expr><call><name pos:line="79" pos:column="11">freecookie<pos:position pos:line="79" pos:column="21"/></name><argument_list pos:line="79" pos:column="21">(<argument><expr><name pos:line="79" pos:column="22">co<pos:position pos:line="79" pos:column="24"/></name></expr></argument>)<pos:position pos:line="79" pos:column="25"/></argument_list></call></expr>;<pos:position pos:line="79" pos:column="26"/></expr_stmt>
          <expr_stmt><expr><call><name pos:line="80" pos:column="11">infof<pos:position pos:line="80" pos:column="16"/></name><argument_list pos:line="80" pos:column="16">(<argument><expr><name pos:line="80" pos:column="17">data<pos:position pos:line="80" pos:column="21"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="80" pos:column="23">"oversized cookie dropped, name/val %d + %d bytes\n"<pos:position pos:line="80" pos:column="75"/></literal></expr></argument>,
                <argument><expr><name pos:line="81" pos:column="17">nlen<pos:position pos:line="81" pos:column="21"/></name></expr></argument>, <argument><expr><name pos:line="81" pos:column="23">len<pos:position pos:line="81" pos:column="26"/></name></expr></argument>)<pos:position pos:line="81" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="81" pos:column="28"/></expr_stmt>
          <return pos:line="82" pos:column="11">return <expr><name pos:line="82" pos:column="18">NULL<pos:position pos:line="82" pos:column="22"/></name></expr>;<pos:position pos:line="82" pos:column="23"/></return>
        }<pos:position pos:line="83" pos:column="10"/></block></then></if>

        <comment type="block" pos:line="85" pos:column="9">/* name ends with a '=' ? */</comment>
        <expr_stmt><expr><name pos:line="86" pos:column="9">sep<pos:position pos:line="86" pos:column="12"/></name> <operator pos:line="86" pos:column="13">=<pos:position pos:line="86" pos:column="14"/></operator> <ternary><condition><expr><operator pos:line="86" pos:column="15">(<pos:position pos:line="86" pos:column="16"/></operator><operator pos:line="86" pos:column="16">*<pos:position pos:line="86" pos:column="17"/></operator><name pos:line="86" pos:column="17">endofn<pos:position pos:line="86" pos:column="23"/></name> <operator pos:line="86" pos:column="24">==<pos:position pos:line="86" pos:column="26"/></operator> <literal type="char" pos:line="86" pos:column="27">'='<pos:position pos:line="86" pos:column="30"/></literal><operator pos:line="86" pos:column="30">)<pos:position pos:line="86" pos:column="31"/></operator></expr>?<pos:position pos:line="86" pos:column="32"/></condition><then><expr><name pos:line="86" pos:column="32">TRUE<pos:position pos:line="86" pos:column="36"/></name></expr></then><else pos:line="86" pos:column="36">:<expr><name pos:line="86" pos:column="37">FALSE<pos:position pos:line="86" pos:column="42"/></name></expr></else></ternary></expr>;<pos:position pos:line="86" pos:column="43"/></expr_stmt>

        <if pos:line="88" pos:column="9">if<condition pos:line="88" pos:column="11">(<expr><name pos:line="88" pos:column="12">nlen<pos:position pos:line="88" pos:column="16"/></name></expr>)<pos:position pos:line="88" pos:column="17"/></condition><then pos:line="88" pos:column="17"> <block pos:line="88" pos:column="18">{
          <expr_stmt><expr><name pos:line="89" pos:column="11">endofn<pos:position pos:line="89" pos:column="17"/></name><operator pos:line="89" pos:column="17">--<pos:position pos:line="89" pos:column="19"/></operator></expr>;<pos:position pos:line="89" pos:column="20"/></expr_stmt> <comment type="block" pos:line="89" pos:column="21">/* move to the last character */</comment>
          <if pos:line="90" pos:column="11">if<condition pos:line="90" pos:column="13">(<expr><call><name pos:line="90" pos:column="14">ISBLANK<pos:position pos:line="90" pos:column="21"/></name><argument_list pos:line="90" pos:column="21">(<argument><expr><operator pos:line="90" pos:column="22">*<pos:position pos:line="90" pos:column="23"/></operator><name pos:line="90" pos:column="23">endofn<pos:position pos:line="90" pos:column="29"/></name></expr></argument>)<pos:position pos:line="90" pos:column="30"/></argument_list></call></expr>)<pos:position pos:line="90" pos:column="31"/></condition><then pos:line="90" pos:column="31"> <block pos:line="90" pos:column="32">{
            <comment type="block" pos:line="91" pos:column="13">/* skip trailing spaces in name */</comment>
            <while pos:line="92" pos:column="13">while<condition pos:line="92" pos:column="18">(<expr><operator pos:line="92" pos:column="19">*<pos:position pos:line="92" pos:column="20"/></operator><name pos:line="92" pos:column="20">endofn<pos:position pos:line="92" pos:column="26"/></name> <operator pos:line="92" pos:column="27">&amp;&amp;<pos:position pos:line="92" pos:column="37"/></operator> <call><name pos:line="92" pos:column="30">ISBLANK<pos:position pos:line="92" pos:column="37"/></name><argument_list pos:line="92" pos:column="37">(<argument><expr><operator pos:line="92" pos:column="38">*<pos:position pos:line="92" pos:column="39"/></operator><name pos:line="92" pos:column="39">endofn<pos:position pos:line="92" pos:column="45"/></name></expr></argument>)<pos:position pos:line="92" pos:column="46"/></argument_list></call> <operator pos:line="92" pos:column="47">&amp;&amp;<pos:position pos:line="92" pos:column="57"/></operator> <name pos:line="92" pos:column="50">nlen<pos:position pos:line="92" pos:column="54"/></name></expr>)<pos:position pos:line="92" pos:column="55"/></condition> <block pos:line="92" pos:column="56">{
              <expr_stmt><expr><name pos:line="93" pos:column="15">endofn<pos:position pos:line="93" pos:column="21"/></name><operator pos:line="93" pos:column="21">--<pos:position pos:line="93" pos:column="23"/></operator></expr>;<pos:position pos:line="93" pos:column="24"/></expr_stmt>
              <expr_stmt><expr><name pos:line="94" pos:column="15">nlen<pos:position pos:line="94" pos:column="19"/></name><operator pos:line="94" pos:column="19">--<pos:position pos:line="94" pos:column="21"/></operator></expr>;<pos:position pos:line="94" pos:column="22"/></expr_stmt>
            }<pos:position pos:line="95" pos:column="14"/></block></while>
            <expr_stmt><expr><name><name pos:line="96" pos:column="13">name<pos:position pos:line="96" pos:column="17"/></name><index pos:line="96" pos:column="17">[<expr><name pos:line="96" pos:column="18">nlen<pos:position pos:line="96" pos:column="22"/></name></expr>]<pos:position pos:line="96" pos:column="23"/></index></name> <operator pos:line="96" pos:column="24">=<pos:position pos:line="96" pos:column="25"/></operator> <literal type="number" pos:line="96" pos:column="26">0<pos:position pos:line="96" pos:column="27"/></literal></expr>;<pos:position pos:line="96" pos:column="28"/></expr_stmt> <comment type="block" pos:line="96" pos:column="29">/* new end of name */</comment>
          }<pos:position pos:line="97" pos:column="12"/></block></then></if>
        }<pos:position pos:line="98" pos:column="10"/></block></then></if>

        <comment type="block" pos:line="100" pos:column="9">/* Strip off trailing whitespace from the 'what' */</comment>
        <while pos:line="101" pos:column="9">while<condition pos:line="101" pos:column="14">(<expr><name pos:line="101" pos:column="15">len<pos:position pos:line="101" pos:column="18"/></name> <operator pos:line="101" pos:column="19">&amp;&amp;<pos:position pos:line="101" pos:column="29"/></operator> <call><name pos:line="101" pos:column="22">ISBLANK<pos:position pos:line="101" pos:column="29"/></name><argument_list pos:line="101" pos:column="29">(<argument><expr><name><name pos:line="101" pos:column="30">what<pos:position pos:line="101" pos:column="34"/></name><index pos:line="101" pos:column="34">[<expr><name pos:line="101" pos:column="35">len<pos:position pos:line="101" pos:column="38"/></name><operator pos:line="101" pos:column="38">-<pos:position pos:line="101" pos:column="39"/></operator><literal type="number" pos:line="101" pos:column="39">1<pos:position pos:line="101" pos:column="40"/></literal></expr>]<pos:position pos:line="101" pos:column="41"/></index></name></expr></argument>)<pos:position pos:line="101" pos:column="42"/></argument_list></call></expr>)<pos:position pos:line="101" pos:column="43"/></condition> <block pos:line="101" pos:column="44">{
          <expr_stmt><expr><name><name pos:line="102" pos:column="11">what<pos:position pos:line="102" pos:column="15"/></name><index pos:line="102" pos:column="15">[<expr><name pos:line="102" pos:column="16">len<pos:position pos:line="102" pos:column="19"/></name><operator pos:line="102" pos:column="19">-<pos:position pos:line="102" pos:column="20"/></operator><literal type="number" pos:line="102" pos:column="20">1<pos:position pos:line="102" pos:column="21"/></literal></expr>]<pos:position pos:line="102" pos:column="22"/></index></name> <operator pos:line="102" pos:column="23">=<pos:position pos:line="102" pos:column="24"/></operator> <literal type="number" pos:line="102" pos:column="25">0<pos:position pos:line="102" pos:column="26"/></literal></expr>;<pos:position pos:line="102" pos:column="27"/></expr_stmt>
          <expr_stmt><expr><name pos:line="103" pos:column="11">len<pos:position pos:line="103" pos:column="14"/></name><operator pos:line="103" pos:column="14">--<pos:position pos:line="103" pos:column="16"/></operator></expr>;<pos:position pos:line="103" pos:column="17"/></expr_stmt>
        }<pos:position pos:line="104" pos:column="10"/></block></while>

        <comment type="block" pos:line="106" pos:column="9">/* Skip leading whitespace from the 'what' */</comment>
        <expr_stmt><expr><name pos:line="107" pos:column="9">whatptr<pos:position pos:line="107" pos:column="16"/></name> <operator pos:line="107" pos:column="17">=<pos:position pos:line="107" pos:column="18"/></operator> <name pos:line="107" pos:column="19">what<pos:position pos:line="107" pos:column="23"/></name></expr>;<pos:position pos:line="107" pos:column="24"/></expr_stmt>
        <while pos:line="108" pos:column="9">while<condition pos:line="108" pos:column="14">(<expr><operator pos:line="108" pos:column="15">*<pos:position pos:line="108" pos:column="16"/></operator><name pos:line="108" pos:column="16">whatptr<pos:position pos:line="108" pos:column="23"/></name> <operator pos:line="108" pos:column="24">&amp;&amp;<pos:position pos:line="108" pos:column="34"/></operator> <call><name pos:line="108" pos:column="27">ISBLANK<pos:position pos:line="108" pos:column="34"/></name><argument_list pos:line="108" pos:column="34">(<argument><expr><operator pos:line="108" pos:column="35">*<pos:position pos:line="108" pos:column="36"/></operator><name pos:line="108" pos:column="36">whatptr<pos:position pos:line="108" pos:column="43"/></name></expr></argument>)<pos:position pos:line="108" pos:column="44"/></argument_list></call></expr>)<pos:position pos:line="108" pos:column="45"/></condition>
          <block type="pseudo"><expr_stmt><expr><name pos:line="109" pos:column="11">whatptr<pos:position pos:line="109" pos:column="18"/></name><operator pos:line="109" pos:column="18">++<pos:position pos:line="109" pos:column="20"/></operator></expr>;<pos:position pos:line="109" pos:column="21"/></expr_stmt></block></while>

        <if pos:line="111" pos:column="9">if<condition pos:line="111" pos:column="11">(<expr><operator pos:line="111" pos:column="12">!<pos:position pos:line="111" pos:column="13"/></operator><name><name pos:line="111" pos:column="13">co<pos:position pos:line="111" pos:column="15"/></name><operator pos:line="111" pos:column="15">-&gt;<pos:position pos:line="111" pos:column="20"/></operator><name pos:line="111" pos:column="17">name<pos:position pos:line="111" pos:column="21"/></name></name> <operator pos:line="111" pos:column="22">&amp;&amp;<pos:position pos:line="111" pos:column="32"/></operator> <name pos:line="111" pos:column="25">sep<pos:position pos:line="111" pos:column="28"/></name></expr>)<pos:position pos:line="111" pos:column="29"/></condition><then pos:line="111" pos:column="29"> <block pos:line="111" pos:column="30">{
          <comment type="block" pos:line="112" pos:column="11">/* The very first name/value pair is the actual cookie name */</comment>
          <expr_stmt><expr><name><name pos:line="113" pos:column="11">co<pos:position pos:line="113" pos:column="13"/></name><operator pos:line="113" pos:column="13">-&gt;<pos:position pos:line="113" pos:column="18"/></operator><name pos:line="113" pos:column="15">name<pos:position pos:line="113" pos:column="19"/></name></name> <operator pos:line="113" pos:column="20">=<pos:position pos:line="113" pos:column="21"/></operator> <call><name pos:line="113" pos:column="22">strdup<pos:position pos:line="113" pos:column="28"/></name><argument_list pos:line="113" pos:column="28">(<argument><expr><name pos:line="113" pos:column="29">name<pos:position pos:line="113" pos:column="33"/></name></expr></argument>)<pos:position pos:line="113" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="113" pos:column="35"/></expr_stmt>
          <expr_stmt><expr><name><name pos:line="114" pos:column="11">co<pos:position pos:line="114" pos:column="13"/></name><operator pos:line="114" pos:column="13">-&gt;<pos:position pos:line="114" pos:column="18"/></operator><name pos:line="114" pos:column="15">value<pos:position pos:line="114" pos:column="20"/></name></name> <operator pos:line="114" pos:column="21">=<pos:position pos:line="114" pos:column="22"/></operator> <call><name pos:line="114" pos:column="23">strdup<pos:position pos:line="114" pos:column="29"/></name><argument_list pos:line="114" pos:column="29">(<argument><expr><name pos:line="114" pos:column="30">whatptr<pos:position pos:line="114" pos:column="37"/></name></expr></argument>)<pos:position pos:line="114" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="114" pos:column="39"/></expr_stmt>
          <if pos:line="115" pos:column="11">if<condition pos:line="115" pos:column="13">(<expr><operator pos:line="115" pos:column="14">!<pos:position pos:line="115" pos:column="15"/></operator><name><name pos:line="115" pos:column="15">co<pos:position pos:line="115" pos:column="17"/></name><operator pos:line="115" pos:column="17">-&gt;<pos:position pos:line="115" pos:column="22"/></operator><name pos:line="115" pos:column="19">name<pos:position pos:line="115" pos:column="23"/></name></name> <operator pos:line="115" pos:column="24">||<pos:position pos:line="115" pos:column="26"/></operator> <operator pos:line="115" pos:column="27">!<pos:position pos:line="115" pos:column="28"/></operator><name><name pos:line="115" pos:column="28">co<pos:position pos:line="115" pos:column="30"/></name><operator pos:line="115" pos:column="30">-&gt;<pos:position pos:line="115" pos:column="35"/></operator><name pos:line="115" pos:column="32">value<pos:position pos:line="115" pos:column="37"/></name></name></expr>)<pos:position pos:line="115" pos:column="38"/></condition><then pos:line="115" pos:column="38"> <block pos:line="115" pos:column="39">{
            <expr_stmt><expr><name pos:line="116" pos:column="13">badcookie<pos:position pos:line="116" pos:column="22"/></name> <operator pos:line="116" pos:column="23">=<pos:position pos:line="116" pos:column="24"/></operator> <name pos:line="116" pos:column="25">TRUE<pos:position pos:line="116" pos:column="29"/></name></expr>;<pos:position pos:line="116" pos:column="30"/></expr_stmt>
            <break pos:line="117" pos:column="13">break;<pos:position pos:line="117" pos:column="19"/></break>
          }<pos:position pos:line="118" pos:column="12"/></block></then></if>
        }<pos:position pos:line="119" pos:column="10"/></block></then>
        <elseif pos:line="120" pos:column="9">else <if pos:line="120" pos:column="14">if<condition pos:line="120" pos:column="16">(<expr><operator pos:line="120" pos:column="17">!<pos:position pos:line="120" pos:column="18"/></operator><name pos:line="120" pos:column="18">len<pos:position pos:line="120" pos:column="21"/></name></expr>)<pos:position pos:line="120" pos:column="22"/></condition><then pos:line="120" pos:column="22"> <block pos:line="120" pos:column="23">{
          <comment type="block" pos:line="121" pos:column="11">/* this was a "&lt;name&gt;=" with no content, and we must allow
             'secure' and 'httponly' specified this weirdly */</comment>
          <expr_stmt><expr><name pos:line="123" pos:column="11">done<pos:position pos:line="123" pos:column="15"/></name> <operator pos:line="123" pos:column="16">=<pos:position pos:line="123" pos:column="17"/></operator> <name pos:line="123" pos:column="18">TRUE<pos:position pos:line="123" pos:column="22"/></name></expr>;<pos:position pos:line="123" pos:column="23"/></expr_stmt>
          <if pos:line="124" pos:column="11">if<condition pos:line="124" pos:column="13">(<expr><call><name pos:line="124" pos:column="14">strcasecompare<pos:position pos:line="124" pos:column="28"/></name><argument_list pos:line="124" pos:column="28">(<argument><expr><literal type="string" pos:line="124" pos:column="29">"secure"<pos:position pos:line="124" pos:column="37"/></literal></expr></argument>, <argument><expr><name pos:line="124" pos:column="39">name<pos:position pos:line="124" pos:column="43"/></name></expr></argument>)<pos:position pos:line="124" pos:column="44"/></argument_list></call></expr>)<pos:position pos:line="124" pos:column="45"/></condition><then pos:line="124" pos:column="45">
            <block type="pseudo"><expr_stmt><expr><name><name pos:line="125" pos:column="13">co<pos:position pos:line="125" pos:column="15"/></name><operator pos:line="125" pos:column="15">-&gt;<pos:position pos:line="125" pos:column="20"/></operator><name pos:line="125" pos:column="17">secure<pos:position pos:line="125" pos:column="23"/></name></name> <operator pos:line="125" pos:column="24">=<pos:position pos:line="125" pos:column="25"/></operator> <name pos:line="125" pos:column="26">TRUE<pos:position pos:line="125" pos:column="30"/></name></expr>;<pos:position pos:line="125" pos:column="31"/></expr_stmt></block></then>
          <elseif pos:line="126" pos:column="11">else <if pos:line="126" pos:column="16">if<condition pos:line="126" pos:column="18">(<expr><call><name pos:line="126" pos:column="19">strcasecompare<pos:position pos:line="126" pos:column="33"/></name><argument_list pos:line="126" pos:column="33">(<argument><expr><literal type="string" pos:line="126" pos:column="34">"httponly"<pos:position pos:line="126" pos:column="44"/></literal></expr></argument>, <argument><expr><name pos:line="126" pos:column="46">name<pos:position pos:line="126" pos:column="50"/></name></expr></argument>)<pos:position pos:line="126" pos:column="51"/></argument_list></call></expr>)<pos:position pos:line="126" pos:column="52"/></condition><then pos:line="126" pos:column="52">
            <block type="pseudo"><expr_stmt><expr><name><name pos:line="127" pos:column="13">co<pos:position pos:line="127" pos:column="15"/></name><operator pos:line="127" pos:column="15">-&gt;<pos:position pos:line="127" pos:column="20"/></operator><name pos:line="127" pos:column="17">httponly<pos:position pos:line="127" pos:column="25"/></name></name> <operator pos:line="127" pos:column="26">=<pos:position pos:line="127" pos:column="27"/></operator> <name pos:line="127" pos:column="28">TRUE<pos:position pos:line="127" pos:column="32"/></name></expr>;<pos:position pos:line="127" pos:column="33"/></expr_stmt></block></then></if></elseif>
          <elseif pos:line="128" pos:column="11">else <if pos:line="128" pos:column="16">if<condition pos:line="128" pos:column="18">(<expr><name pos:line="128" pos:column="19">sep<pos:position pos:line="128" pos:column="22"/></name></expr>)<pos:position pos:line="128" pos:column="23"/></condition><then pos:line="128" pos:column="23">
            <comment type="block" pos:line="129" pos:column="13">/* there was a '=' so we're not done parsing this field */</comment>
            <block type="pseudo"><expr_stmt><expr><name pos:line="130" pos:column="13">done<pos:position pos:line="130" pos:column="17"/></name> <operator pos:line="130" pos:column="18">=<pos:position pos:line="130" pos:column="19"/></operator> <name pos:line="130" pos:column="20">FALSE<pos:position pos:line="130" pos:column="25"/></name></expr>;<pos:position pos:line="130" pos:column="26"/></expr_stmt></block></then></if></elseif></if>
        }<pos:position pos:line="131" pos:column="10"/></block></then></if></elseif></if>
        <if pos:line="132" pos:column="9">if<condition pos:line="132" pos:column="11">(<expr><name pos:line="132" pos:column="12">done<pos:position pos:line="132" pos:column="16"/></name></expr>)<pos:position pos:line="132" pos:column="17"/></condition><then pos:line="132" pos:column="17">
          <block type="pseudo"><empty_stmt pos:line="133" pos:column="11">;<pos:position pos:line="133" pos:column="12"/></empty_stmt></block></then>
        <elseif pos:line="134" pos:column="9">else <if pos:line="134" pos:column="14">if<condition pos:line="134" pos:column="16">(<expr><call><name pos:line="134" pos:column="17">strcasecompare<pos:position pos:line="134" pos:column="31"/></name><argument_list pos:line="134" pos:column="31">(<argument><expr><literal type="string" pos:line="134" pos:column="32">"path"<pos:position pos:line="134" pos:column="38"/></literal></expr></argument>, <argument><expr><name pos:line="134" pos:column="40">name<pos:position pos:line="134" pos:column="44"/></name></expr></argument>)<pos:position pos:line="134" pos:column="45"/></argument_list></call></expr>)<pos:position pos:line="134" pos:column="46"/></condition><then pos:line="134" pos:column="46"> <block pos:line="134" pos:column="47">{
          <expr_stmt><expr><call><name pos:line="135" pos:column="11">strstore<pos:position pos:line="135" pos:column="19"/></name><argument_list pos:line="135" pos:column="19">(<argument><expr><operator pos:line="135" pos:column="20">&amp;<pos:position pos:line="135" pos:column="25"/></operator><name><name pos:line="135" pos:column="21">co<pos:position pos:line="135" pos:column="23"/></name><operator pos:line="135" pos:column="23">-&gt;<pos:position pos:line="135" pos:column="28"/></operator><name pos:line="135" pos:column="25">path<pos:position pos:line="135" pos:column="29"/></name></name></expr></argument>, <argument><expr><name pos:line="135" pos:column="31">whatptr<pos:position pos:line="135" pos:column="38"/></name></expr></argument>)<pos:position pos:line="135" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="135" pos:column="40"/></expr_stmt>
          <if pos:line="136" pos:column="11">if<condition pos:line="136" pos:column="13">(<expr><operator pos:line="136" pos:column="14">!<pos:position pos:line="136" pos:column="15"/></operator><name><name pos:line="136" pos:column="15">co<pos:position pos:line="136" pos:column="17"/></name><operator pos:line="136" pos:column="17">-&gt;<pos:position pos:line="136" pos:column="22"/></operator><name pos:line="136" pos:column="19">path<pos:position pos:line="136" pos:column="23"/></name></name></expr>)<pos:position pos:line="136" pos:column="24"/></condition><then pos:line="136" pos:column="24"> <block pos:line="136" pos:column="25">{
            <expr_stmt><expr><name pos:line="137" pos:column="13">badcookie<pos:position pos:line="137" pos:column="22"/></name> <operator pos:line="137" pos:column="23">=<pos:position pos:line="137" pos:column="24"/></operator> <name pos:line="137" pos:column="25">TRUE<pos:position pos:line="137" pos:column="29"/></name></expr>;<pos:position pos:line="137" pos:column="30"/></expr_stmt> <comment type="block" pos:line="137" pos:column="31">/* out of memory bad */</comment>
            <break pos:line="138" pos:column="13">break;<pos:position pos:line="138" pos:column="19"/></break>
          }<pos:position pos:line="139" pos:column="12"/></block></then></if>
          <expr_stmt><expr><call><name pos:line="140" pos:column="11">free<pos:position pos:line="140" pos:column="15"/></name><argument_list pos:line="140" pos:column="15">(<argument><expr><name><name pos:line="140" pos:column="16">co<pos:position pos:line="140" pos:column="18"/></name><operator pos:line="140" pos:column="18">-&gt;<pos:position pos:line="140" pos:column="23"/></operator><name pos:line="140" pos:column="20">spath<pos:position pos:line="140" pos:column="25"/></name></name></expr></argument>)<pos:position pos:line="140" pos:column="26"/></argument_list></call></expr>;<pos:position pos:line="140" pos:column="27"/></expr_stmt> <comment type="block" pos:line="140" pos:column="28">/* if this is set again */</comment>
          <expr_stmt><expr><name><name pos:line="141" pos:column="11">co<pos:position pos:line="141" pos:column="13"/></name><operator pos:line="141" pos:column="13">-&gt;<pos:position pos:line="141" pos:column="18"/></operator><name pos:line="141" pos:column="15">spath<pos:position pos:line="141" pos:column="20"/></name></name> <operator pos:line="141" pos:column="21">=<pos:position pos:line="141" pos:column="22"/></operator> <call><name pos:line="141" pos:column="23">sanitize_cookie_path<pos:position pos:line="141" pos:column="43"/></name><argument_list pos:line="141" pos:column="43">(<argument><expr><name><name pos:line="141" pos:column="44">co<pos:position pos:line="141" pos:column="46"/></name><operator pos:line="141" pos:column="46">-&gt;<pos:position pos:line="141" pos:column="51"/></operator><name pos:line="141" pos:column="48">path<pos:position pos:line="141" pos:column="52"/></name></name></expr></argument>)<pos:position pos:line="141" pos:column="53"/></argument_list></call></expr>;<pos:position pos:line="141" pos:column="54"/></expr_stmt>
          <if pos:line="142" pos:column="11">if<condition pos:line="142" pos:column="13">(<expr><operator pos:line="142" pos:column="14">!<pos:position pos:line="142" pos:column="15"/></operator><name><name pos:line="142" pos:column="15">co<pos:position pos:line="142" pos:column="17"/></name><operator pos:line="142" pos:column="17">-&gt;<pos:position pos:line="142" pos:column="22"/></operator><name pos:line="142" pos:column="19">spath<pos:position pos:line="142" pos:column="24"/></name></name></expr>)<pos:position pos:line="142" pos:column="25"/></condition><then pos:line="142" pos:column="25"> <block pos:line="142" pos:column="26">{
            <expr_stmt><expr><name pos:line="143" pos:column="13">badcookie<pos:position pos:line="143" pos:column="22"/></name> <operator pos:line="143" pos:column="23">=<pos:position pos:line="143" pos:column="24"/></operator> <name pos:line="143" pos:column="25">TRUE<pos:position pos:line="143" pos:column="29"/></name></expr>;<pos:position pos:line="143" pos:column="30"/></expr_stmt> <comment type="block" pos:line="143" pos:column="31">/* out of memory bad */</comment>
            <break pos:line="144" pos:column="13">break;<pos:position pos:line="144" pos:column="19"/></break>
          }<pos:position pos:line="145" pos:column="12"/></block></then></if>
        }<pos:position pos:line="146" pos:column="10"/></block></then></if></elseif>
        <elseif pos:line="147" pos:column="9">else <if pos:line="147" pos:column="14">if<condition pos:line="147" pos:column="16">(<expr><call><name pos:line="147" pos:column="17">strcasecompare<pos:position pos:line="147" pos:column="31"/></name><argument_list pos:line="147" pos:column="31">(<argument><expr><literal type="string" pos:line="147" pos:column="32">"domain"<pos:position pos:line="147" pos:column="40"/></literal></expr></argument>, <argument><expr><name pos:line="147" pos:column="42">name<pos:position pos:line="147" pos:column="46"/></name></expr></argument>)<pos:position pos:line="147" pos:column="47"/></argument_list></call></expr>)<pos:position pos:line="147" pos:column="48"/></condition><then pos:line="147" pos:column="48"> <block pos:line="147" pos:column="49">{
          <decl_stmt><decl><type><name pos:line="148" pos:column="11">bool<pos:position pos:line="148" pos:column="15"/></name></type> <name pos:line="148" pos:column="16">is_ip<pos:position pos:line="148" pos:column="21"/></name></decl>;<pos:position pos:line="148" pos:column="22"/></decl_stmt>

          <comment type="block" pos:line="150" pos:column="11">/* Now, we make sure that our host is within the given domain,
             or the given domain is not valid and thus cannot be set. */</comment>

          <if pos:line="153" pos:column="11">if<condition pos:line="153" pos:column="13">(<expr><literal type="char" pos:line="153" pos:column="14">'.'<pos:position pos:line="153" pos:column="17"/></literal> <operator pos:line="153" pos:column="18">==<pos:position pos:line="153" pos:column="20"/></operator> <name><name pos:line="153" pos:column="21">whatptr<pos:position pos:line="153" pos:column="28"/></name><index pos:line="153" pos:column="28">[<expr><literal type="number" pos:line="153" pos:column="29">0<pos:position pos:line="153" pos:column="30"/></literal></expr>]<pos:position pos:line="153" pos:column="31"/></index></name></expr>)<pos:position pos:line="153" pos:column="32"/></condition><then pos:line="153" pos:column="32">
            <block type="pseudo"><expr_stmt><expr><name pos:line="154" pos:column="13">whatptr<pos:position pos:line="154" pos:column="20"/></name><operator pos:line="154" pos:column="20">++<pos:position pos:line="154" pos:column="22"/></operator></expr>;<pos:position pos:line="154" pos:column="23"/></expr_stmt></block></then></if> <comment type="block" pos:line="154" pos:column="24">/* ignore preceding dot */</comment>

<cpp:ifndef pos:line="156" pos:column="1">#<cpp:directive pos:line="156" pos:column="2">ifndef<pos:position pos:line="156" pos:column="8"/></cpp:directive> <name pos:line="156" pos:column="9">USE_LIBPSL<pos:position pos:line="156" pos:column="19"/></name></cpp:ifndef>
          <comment type="block" pos:line="157" pos:column="11">/*
           * Without PSL we don't know when the incoming cookie is set on a
           * TLD or otherwise "protected" suffix. To reduce risk, we require a
           * dot OR the exact host name being "localhost".
           */</comment>
          <block pos:line="162" pos:column="11">{
            <decl_stmt><decl><type><specifier pos:line="163" pos:column="13">const<pos:position pos:line="163" pos:column="18"/></specifier> <name pos:line="163" pos:column="19">char<pos:position pos:line="163" pos:column="23"/></name> <modifier pos:line="163" pos:column="24">*<pos:position pos:line="163" pos:column="25"/></modifier></type><name pos:line="163" pos:column="25">dotp<pos:position pos:line="163" pos:column="29"/></name></decl>;<pos:position pos:line="163" pos:column="30"/></decl_stmt>
            <comment type="block" pos:line="164" pos:column="13">/* check for more dots */</comment>
            <expr_stmt><expr><name pos:line="165" pos:column="13">dotp<pos:position pos:line="165" pos:column="17"/></name> <operator pos:line="165" pos:column="18">=<pos:position pos:line="165" pos:column="19"/></operator> <call><name pos:line="165" pos:column="20">strchr<pos:position pos:line="165" pos:column="26"/></name><argument_list pos:line="165" pos:column="26">(<argument><expr><name pos:line="165" pos:column="27">whatptr<pos:position pos:line="165" pos:column="34"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="165" pos:column="36">'.'<pos:position pos:line="165" pos:column="39"/></literal></expr></argument>)<pos:position pos:line="165" pos:column="40"/></argument_list></call></expr>;<pos:position pos:line="165" pos:column="41"/></expr_stmt>
            <if pos:line="166" pos:column="13">if<condition pos:line="166" pos:column="15">(<expr><operator pos:line="166" pos:column="16">!<pos:position pos:line="166" pos:column="17"/></operator><name pos:line="166" pos:column="17">dotp<pos:position pos:line="166" pos:column="21"/></name> <operator pos:line="166" pos:column="22">&amp;&amp;<pos:position pos:line="166" pos:column="32"/></operator> <operator pos:line="166" pos:column="25">!<pos:position pos:line="166" pos:column="26"/></operator><call><name pos:line="166" pos:column="26">strcasecompare<pos:position pos:line="166" pos:column="40"/></name><argument_list pos:line="166" pos:column="40">(<argument><expr><literal type="string" pos:line="166" pos:column="41">"localhost"<pos:position pos:line="166" pos:column="52"/></literal></expr></argument>, <argument><expr><name pos:line="166" pos:column="54">whatptr<pos:position pos:line="166" pos:column="61"/></name></expr></argument>)<pos:position pos:line="166" pos:column="62"/></argument_list></call></expr>)<pos:position pos:line="166" pos:column="63"/></condition><then pos:line="166" pos:column="63">
              <block type="pseudo"><expr_stmt><expr><name pos:line="167" pos:column="15">domain<pos:position pos:line="167" pos:column="21"/></name> <operator pos:line="167" pos:column="22">=<pos:position pos:line="167" pos:column="23"/></operator> <literal type="string" pos:line="167" pos:column="24">":"<pos:position pos:line="167" pos:column="27"/></literal></expr>;<pos:position pos:line="167" pos:column="28"/></expr_stmt></block></then></if>
          }<pos:position pos:line="168" pos:column="12"/></block>
<cpp:endif pos:line="169" pos:column="1">#<cpp:directive pos:line="169" pos:column="2">endif<pos:position pos:line="169" pos:column="7"/></cpp:directive></cpp:endif>

          <expr_stmt><expr><name pos:line="171" pos:column="11">is_ip<pos:position pos:line="171" pos:column="16"/></name> <operator pos:line="171" pos:column="17">=<pos:position pos:line="171" pos:column="18"/></operator> <call><name pos:line="171" pos:column="19">isip<pos:position pos:line="171" pos:column="23"/></name><argument_list pos:line="171" pos:column="23">(<argument><expr><ternary><condition><expr><name pos:line="171" pos:column="24">domain<pos:position pos:line="171" pos:column="30"/></name></expr> ?<pos:position pos:line="171" pos:column="32"/></condition><then pos:line="171" pos:column="32"> <expr><name pos:line="171" pos:column="33">domain<pos:position pos:line="171" pos:column="39"/></name></expr> <pos:position pos:line="171" pos:column="40"/></then><else pos:line="171" pos:column="40">: <expr><name pos:line="171" pos:column="42">whatptr<pos:position pos:line="171" pos:column="49"/></name></expr></else></ternary></expr></argument>)<pos:position pos:line="171" pos:column="50"/></argument_list></call></expr>;<pos:position pos:line="171" pos:column="51"/></expr_stmt>

          <if pos:line="173" pos:column="11">if<condition pos:line="173" pos:column="13">(<expr><operator pos:line="173" pos:column="14">!<pos:position pos:line="173" pos:column="15"/></operator><name pos:line="173" pos:column="15">domain<pos:position pos:line="173" pos:column="21"/></name>
             <operator pos:line="174" pos:column="14">||<pos:position pos:line="174" pos:column="16"/></operator> <operator pos:line="174" pos:column="17">(<pos:position pos:line="174" pos:column="18"/></operator><name pos:line="174" pos:column="18">is_ip<pos:position pos:line="174" pos:column="23"/></name> <operator pos:line="174" pos:column="24">&amp;&amp;<pos:position pos:line="174" pos:column="34"/></operator> <operator pos:line="174" pos:column="27">!<pos:position pos:line="174" pos:column="28"/></operator><call><name pos:line="174" pos:column="28">strcmp<pos:position pos:line="174" pos:column="34"/></name><argument_list pos:line="174" pos:column="34">(<argument><expr><name pos:line="174" pos:column="35">whatptr<pos:position pos:line="174" pos:column="42"/></name></expr></argument>, <argument><expr><name pos:line="174" pos:column="44">domain<pos:position pos:line="174" pos:column="50"/></name></expr></argument>)<pos:position pos:line="174" pos:column="51"/></argument_list></call><operator pos:line="174" pos:column="51">)<pos:position pos:line="174" pos:column="52"/></operator>
             <operator pos:line="175" pos:column="14">||<pos:position pos:line="175" pos:column="16"/></operator> <operator pos:line="175" pos:column="17">(<pos:position pos:line="175" pos:column="18"/></operator><operator pos:line="175" pos:column="18">!<pos:position pos:line="175" pos:column="19"/></operator><name pos:line="175" pos:column="19">is_ip<pos:position pos:line="175" pos:column="24"/></name> <operator pos:line="175" pos:column="25">&amp;&amp;<pos:position pos:line="175" pos:column="35"/></operator> <call><name pos:line="175" pos:column="28">tailmatch<pos:position pos:line="175" pos:column="37"/></name><argument_list pos:line="175" pos:column="37">(<argument><expr><name pos:line="175" pos:column="38">whatptr<pos:position pos:line="175" pos:column="45"/></name></expr></argument>, <argument><expr><name pos:line="175" pos:column="47">domain<pos:position pos:line="175" pos:column="53"/></name></expr></argument>)<pos:position pos:line="175" pos:column="54"/></argument_list></call><operator pos:line="175" pos:column="54">)<pos:position pos:line="175" pos:column="55"/></operator></expr>)<pos:position pos:line="175" pos:column="56"/></condition><then pos:line="175" pos:column="56"> <block pos:line="175" pos:column="57">{
            <expr_stmt><expr><call><name pos:line="176" pos:column="13">strstore<pos:position pos:line="176" pos:column="21"/></name><argument_list pos:line="176" pos:column="21">(<argument><expr><operator pos:line="176" pos:column="22">&amp;<pos:position pos:line="176" pos:column="27"/></operator><name><name pos:line="176" pos:column="23">co<pos:position pos:line="176" pos:column="25"/></name><operator pos:line="176" pos:column="25">-&gt;<pos:position pos:line="176" pos:column="30"/></operator><name pos:line="176" pos:column="27">domain<pos:position pos:line="176" pos:column="33"/></name></name></expr></argument>, <argument><expr><name pos:line="176" pos:column="35">whatptr<pos:position pos:line="176" pos:column="42"/></name></expr></argument>)<pos:position pos:line="176" pos:column="43"/></argument_list></call></expr>;<pos:position pos:line="176" pos:column="44"/></expr_stmt>
            <if pos:line="177" pos:column="13">if<condition pos:line="177" pos:column="15">(<expr><operator pos:line="177" pos:column="16">!<pos:position pos:line="177" pos:column="17"/></operator><name><name pos:line="177" pos:column="17">co<pos:position pos:line="177" pos:column="19"/></name><operator pos:line="177" pos:column="19">-&gt;<pos:position pos:line="177" pos:column="24"/></operator><name pos:line="177" pos:column="21">domain<pos:position pos:line="177" pos:column="27"/></name></name></expr>)<pos:position pos:line="177" pos:column="28"/></condition><then pos:line="177" pos:column="28"> <block pos:line="177" pos:column="29">{
              <expr_stmt><expr><name pos:line="178" pos:column="15">badcookie<pos:position pos:line="178" pos:column="24"/></name> <operator pos:line="178" pos:column="25">=<pos:position pos:line="178" pos:column="26"/></operator> <name pos:line="178" pos:column="27">TRUE<pos:position pos:line="178" pos:column="31"/></name></expr>;<pos:position pos:line="178" pos:column="32"/></expr_stmt>
              <break pos:line="179" pos:column="15">break;<pos:position pos:line="179" pos:column="21"/></break>
            }<pos:position pos:line="180" pos:column="14"/></block></then></if>
            <if pos:line="181" pos:column="13">if<condition pos:line="181" pos:column="15">(<expr><operator pos:line="181" pos:column="16">!<pos:position pos:line="181" pos:column="17"/></operator><name pos:line="181" pos:column="17">is_ip<pos:position pos:line="181" pos:column="22"/></name></expr>)<pos:position pos:line="181" pos:column="23"/></condition><then pos:line="181" pos:column="23">
              <block type="pseudo"><expr_stmt><expr><name><name pos:line="182" pos:column="15">co<pos:position pos:line="182" pos:column="17"/></name><operator pos:line="182" pos:column="17">-&gt;<pos:position pos:line="182" pos:column="22"/></operator><name pos:line="182" pos:column="19">tailmatch<pos:position pos:line="182" pos:column="28"/></name></name> <operator pos:line="182" pos:column="29">=<pos:position pos:line="182" pos:column="30"/></operator> <name pos:line="182" pos:column="31">TRUE<pos:position pos:line="182" pos:column="35"/></name></expr>;<pos:position pos:line="182" pos:column="36"/></expr_stmt></block></then></if> <comment type="block" pos:line="182" pos:column="37">/* we always do that if the domain name was
                                       given */</comment>
          }<pos:position pos:line="184" pos:column="12"/></block></then>
          <else pos:line="185" pos:column="11">else <block pos:line="185" pos:column="16">{
            <comment type="block" pos:line="186" pos:column="13">/* we did not get a tailmatch and then the attempted set domain
               is not a domain to which the current host belongs. Mark as
               bad. */</comment>
            <expr_stmt><expr><name pos:line="189" pos:column="13">badcookie<pos:position pos:line="189" pos:column="22"/></name> <operator pos:line="189" pos:column="23">=<pos:position pos:line="189" pos:column="24"/></operator> <name pos:line="189" pos:column="25">TRUE<pos:position pos:line="189" pos:column="29"/></name></expr>;<pos:position pos:line="189" pos:column="30"/></expr_stmt>
            <expr_stmt><expr><call><name pos:line="190" pos:column="13">infof<pos:position pos:line="190" pos:column="18"/></name><argument_list pos:line="190" pos:column="18">(<argument><expr><name pos:line="190" pos:column="19">data<pos:position pos:line="190" pos:column="23"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="190" pos:column="25">"skipped cookie with bad tailmatch domain: %s\n"<pos:position pos:line="190" pos:column="73"/></literal></expr></argument>,
                  <argument><expr><name pos:line="191" pos:column="19">whatptr<pos:position pos:line="191" pos:column="26"/></name></expr></argument>)<pos:position pos:line="191" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="191" pos:column="28"/></expr_stmt>
          }<pos:position pos:line="192" pos:column="12"/></block></else></if>
        }<pos:position pos:line="193" pos:column="10"/></block></then></if></elseif>
        <elseif pos:line="194" pos:column="9">else <if pos:line="194" pos:column="14">if<condition pos:line="194" pos:column="16">(<expr><call><name pos:line="194" pos:column="17">strcasecompare<pos:position pos:line="194" pos:column="31"/></name><argument_list pos:line="194" pos:column="31">(<argument><expr><literal type="string" pos:line="194" pos:column="32">"version"<pos:position pos:line="194" pos:column="41"/></literal></expr></argument>, <argument><expr><name pos:line="194" pos:column="43">name<pos:position pos:line="194" pos:column="47"/></name></expr></argument>)<pos:position pos:line="194" pos:column="48"/></argument_list></call></expr>)<pos:position pos:line="194" pos:column="49"/></condition><then pos:line="194" pos:column="49"> <block pos:line="194" pos:column="50">{
          <expr_stmt><expr><call><name pos:line="195" pos:column="11">strstore<pos:position pos:line="195" pos:column="19"/></name><argument_list pos:line="195" pos:column="19">(<argument><expr><operator pos:line="195" pos:column="20">&amp;<pos:position pos:line="195" pos:column="25"/></operator><name><name pos:line="195" pos:column="21">co<pos:position pos:line="195" pos:column="23"/></name><operator pos:line="195" pos:column="23">-&gt;<pos:position pos:line="195" pos:column="28"/></operator><name pos:line="195" pos:column="25">version<pos:position pos:line="195" pos:column="32"/></name></name></expr></argument>, <argument><expr><name pos:line="195" pos:column="34">whatptr<pos:position pos:line="195" pos:column="41"/></name></expr></argument>)<pos:position pos:line="195" pos:column="42"/></argument_list></call></expr>;<pos:position pos:line="195" pos:column="43"/></expr_stmt>
          <if pos:line="196" pos:column="11">if<condition pos:line="196" pos:column="13">(<expr><operator pos:line="196" pos:column="14">!<pos:position pos:line="196" pos:column="15"/></operator><name><name pos:line="196" pos:column="15">co<pos:position pos:line="196" pos:column="17"/></name><operator pos:line="196" pos:column="17">-&gt;<pos:position pos:line="196" pos:column="22"/></operator><name pos:line="196" pos:column="19">version<pos:position pos:line="196" pos:column="26"/></name></name></expr>)<pos:position pos:line="196" pos:column="27"/></condition><then pos:line="196" pos:column="27"> <block pos:line="196" pos:column="28">{
            <expr_stmt><expr><name pos:line="197" pos:column="13">badcookie<pos:position pos:line="197" pos:column="22"/></name> <operator pos:line="197" pos:column="23">=<pos:position pos:line="197" pos:column="24"/></operator> <name pos:line="197" pos:column="25">TRUE<pos:position pos:line="197" pos:column="29"/></name></expr>;<pos:position pos:line="197" pos:column="30"/></expr_stmt>
            <break pos:line="198" pos:column="13">break;<pos:position pos:line="198" pos:column="19"/></break>
          }<pos:position pos:line="199" pos:column="12"/></block></then></if>
        }<pos:position pos:line="200" pos:column="10"/></block></then></if></elseif>
        <elseif pos:line="201" pos:column="9">else <if pos:line="201" pos:column="14">if<condition pos:line="201" pos:column="16">(<expr><call><name pos:line="201" pos:column="17">strcasecompare<pos:position pos:line="201" pos:column="31"/></name><argument_list pos:line="201" pos:column="31">(<argument><expr><literal type="string" pos:line="201" pos:column="32">"max-age"<pos:position pos:line="201" pos:column="41"/></literal></expr></argument>, <argument><expr><name pos:line="201" pos:column="43">name<pos:position pos:line="201" pos:column="47"/></name></expr></argument>)<pos:position pos:line="201" pos:column="48"/></argument_list></call></expr>)<pos:position pos:line="201" pos:column="49"/></condition><then pos:line="201" pos:column="49"> <block pos:line="201" pos:column="50">{
          <comment type="block" pos:line="202" pos:column="11">/* Defined in RFC2109:

             Optional.  The Max-Age attribute defines the lifetime of the
             cookie, in seconds.  The delta-seconds value is a decimal non-
             negative integer.  After delta-seconds seconds elapse, the
             client should discard the cookie.  A value of zero means the
             cookie should be discarded immediately.

          */</comment>
          <expr_stmt><expr><call><name pos:line="211" pos:column="11">strstore<pos:position pos:line="211" pos:column="19"/></name><argument_list pos:line="211" pos:column="19">(<argument><expr><operator pos:line="211" pos:column="20">&amp;<pos:position pos:line="211" pos:column="25"/></operator><name><name pos:line="211" pos:column="21">co<pos:position pos:line="211" pos:column="23"/></name><operator pos:line="211" pos:column="23">-&gt;<pos:position pos:line="211" pos:column="28"/></operator><name pos:line="211" pos:column="25">maxage<pos:position pos:line="211" pos:column="31"/></name></name></expr></argument>, <argument><expr><name pos:line="211" pos:column="33">whatptr<pos:position pos:line="211" pos:column="40"/></name></expr></argument>)<pos:position pos:line="211" pos:column="41"/></argument_list></call></expr>;<pos:position pos:line="211" pos:column="42"/></expr_stmt>
          <if pos:line="212" pos:column="11">if<condition pos:line="212" pos:column="13">(<expr><operator pos:line="212" pos:column="14">!<pos:position pos:line="212" pos:column="15"/></operator><name><name pos:line="212" pos:column="15">co<pos:position pos:line="212" pos:column="17"/></name><operator pos:line="212" pos:column="17">-&gt;<pos:position pos:line="212" pos:column="22"/></operator><name pos:line="212" pos:column="19">maxage<pos:position pos:line="212" pos:column="25"/></name></name></expr>)<pos:position pos:line="212" pos:column="26"/></condition><then pos:line="212" pos:column="26"> <block pos:line="212" pos:column="27">{
            <expr_stmt><expr><name pos:line="213" pos:column="13">badcookie<pos:position pos:line="213" pos:column="22"/></name> <operator pos:line="213" pos:column="23">=<pos:position pos:line="213" pos:column="24"/></operator> <name pos:line="213" pos:column="25">TRUE<pos:position pos:line="213" pos:column="29"/></name></expr>;<pos:position pos:line="213" pos:column="30"/></expr_stmt>
            <break pos:line="214" pos:column="13">break;<pos:position pos:line="214" pos:column="19"/></break>
          }<pos:position pos:line="215" pos:column="12"/></block></then></if>
        }<pos:position pos:line="216" pos:column="10"/></block></then></if></elseif>
        <elseif pos:line="217" pos:column="9">else <if pos:line="217" pos:column="14">if<condition pos:line="217" pos:column="16">(<expr><call><name pos:line="217" pos:column="17">strcasecompare<pos:position pos:line="217" pos:column="31"/></name><argument_list pos:line="217" pos:column="31">(<argument><expr><literal type="string" pos:line="217" pos:column="32">"expires"<pos:position pos:line="217" pos:column="41"/></literal></expr></argument>, <argument><expr><name pos:line="217" pos:column="43">name<pos:position pos:line="217" pos:column="47"/></name></expr></argument>)<pos:position pos:line="217" pos:column="48"/></argument_list></call></expr>)<pos:position pos:line="217" pos:column="49"/></condition><then pos:line="217" pos:column="49"> <block pos:line="217" pos:column="50">{
          <expr_stmt><expr><call><name pos:line="218" pos:column="11">strstore<pos:position pos:line="218" pos:column="19"/></name><argument_list pos:line="218" pos:column="19">(<argument><expr><operator pos:line="218" pos:column="20">&amp;<pos:position pos:line="218" pos:column="25"/></operator><name><name pos:line="218" pos:column="21">co<pos:position pos:line="218" pos:column="23"/></name><operator pos:line="218" pos:column="23">-&gt;<pos:position pos:line="218" pos:column="28"/></operator><name pos:line="218" pos:column="25">expirestr<pos:position pos:line="218" pos:column="34"/></name></name></expr></argument>, <argument><expr><name pos:line="218" pos:column="36">whatptr<pos:position pos:line="218" pos:column="43"/></name></expr></argument>)<pos:position pos:line="218" pos:column="44"/></argument_list></call></expr>;<pos:position pos:line="218" pos:column="45"/></expr_stmt>
          <if pos:line="219" pos:column="11">if<condition pos:line="219" pos:column="13">(<expr><operator pos:line="219" pos:column="14">!<pos:position pos:line="219" pos:column="15"/></operator><name><name pos:line="219" pos:column="15">co<pos:position pos:line="219" pos:column="17"/></name><operator pos:line="219" pos:column="17">-&gt;<pos:position pos:line="219" pos:column="22"/></operator><name pos:line="219" pos:column="19">expirestr<pos:position pos:line="219" pos:column="28"/></name></name></expr>)<pos:position pos:line="219" pos:column="29"/></condition><then pos:line="219" pos:column="29"> <block pos:line="219" pos:column="30">{
            <expr_stmt><expr><name pos:line="220" pos:column="13">badcookie<pos:position pos:line="220" pos:column="22"/></name> <operator pos:line="220" pos:column="23">=<pos:position pos:line="220" pos:column="24"/></operator> <name pos:line="220" pos:column="25">TRUE<pos:position pos:line="220" pos:column="29"/></name></expr>;<pos:position pos:line="220" pos:column="30"/></expr_stmt>
            <break pos:line="221" pos:column="13">break;<pos:position pos:line="221" pos:column="19"/></break>
          }<pos:position pos:line="222" pos:column="12"/></block></then></if>
        }<pos:position pos:line="223" pos:column="10"/></block></then></if></elseif></if>
        <comment type="block" pos:line="224" pos:column="9">/*
          else this is the second (or more) name we don't know
          about! */</comment>
      }<pos:position pos:line="227" pos:column="8"/></block></then>
      <else pos:line="228" pos:column="7">else <block pos:line="228" pos:column="12">{
        <comment type="block" pos:line="229" pos:column="9">/* this is an "illegal" &lt;what&gt;=&lt;this&gt; pair */</comment>
      }<pos:position pos:line="230" pos:column="8"/></block></else></if>

      <if pos:line="232" pos:column="7">if<condition pos:line="232" pos:column="9">(<expr><operator pos:line="232" pos:column="10">!<pos:position pos:line="232" pos:column="11"/></operator><name pos:line="232" pos:column="11">semiptr<pos:position pos:line="232" pos:column="18"/></name> <operator pos:line="232" pos:column="19">||<pos:position pos:line="232" pos:column="21"/></operator> <operator pos:line="232" pos:column="22">!<pos:position pos:line="232" pos:column="23"/></operator><operator pos:line="232" pos:column="23">*<pos:position pos:line="232" pos:column="24"/></operator><name pos:line="232" pos:column="24">semiptr<pos:position pos:line="232" pos:column="31"/></name></expr>)<pos:position pos:line="232" pos:column="32"/></condition><then pos:line="232" pos:column="32"> <block pos:line="232" pos:column="33">{
        <comment type="block" pos:line="233" pos:column="9">/* we already know there are no more cookies */</comment>
        <expr_stmt><expr><name pos:line="234" pos:column="9">semiptr<pos:position pos:line="234" pos:column="16"/></name> <operator pos:line="234" pos:column="17">=<pos:position pos:line="234" pos:column="18"/></operator> <name pos:line="234" pos:column="19">NULL<pos:position pos:line="234" pos:column="23"/></name></expr>;<pos:position pos:line="234" pos:column="24"/></expr_stmt>
        <continue pos:line="235" pos:column="9">continue;<pos:position pos:line="235" pos:column="18"/></continue>
      }<pos:position pos:line="236" pos:column="8"/></block></then></if>

      <expr_stmt><expr><name pos:line="238" pos:column="7">ptr<pos:position pos:line="238" pos:column="10"/></name> <operator pos:line="238" pos:column="11">=<pos:position pos:line="238" pos:column="12"/></operator> <name pos:line="238" pos:column="13">semiptr<pos:position pos:line="238" pos:column="20"/></name> <operator pos:line="238" pos:column="21">+<pos:position pos:line="238" pos:column="22"/></operator> <literal type="number" pos:line="238" pos:column="23">1<pos:position pos:line="238" pos:column="24"/></literal></expr>;<pos:position pos:line="238" pos:column="25"/></expr_stmt>
      <while pos:line="239" pos:column="7">while<condition pos:line="239" pos:column="12">(<expr><operator pos:line="239" pos:column="13">*<pos:position pos:line="239" pos:column="14"/></operator><name pos:line="239" pos:column="14">ptr<pos:position pos:line="239" pos:column="17"/></name> <operator pos:line="239" pos:column="18">&amp;&amp;<pos:position pos:line="239" pos:column="28"/></operator> <call><name pos:line="239" pos:column="21">ISBLANK<pos:position pos:line="239" pos:column="28"/></name><argument_list pos:line="239" pos:column="28">(<argument><expr><operator pos:line="239" pos:column="29">*<pos:position pos:line="239" pos:column="30"/></operator><name pos:line="239" pos:column="30">ptr<pos:position pos:line="239" pos:column="33"/></name></expr></argument>)<pos:position pos:line="239" pos:column="34"/></argument_list></call></expr>)<pos:position pos:line="239" pos:column="35"/></condition>
        <block type="pseudo"><expr_stmt><expr><name pos:line="240" pos:column="9">ptr<pos:position pos:line="240" pos:column="12"/></name><operator pos:line="240" pos:column="12">++<pos:position pos:line="240" pos:column="14"/></operator></expr>;<pos:position pos:line="240" pos:column="15"/></expr_stmt></block></while>
      <expr_stmt><expr><name pos:line="241" pos:column="7">semiptr<pos:position pos:line="241" pos:column="14"/></name> <operator pos:line="241" pos:column="15">=<pos:position pos:line="241" pos:column="16"/></operator> <call><name pos:line="241" pos:column="17">strchr<pos:position pos:line="241" pos:column="23"/></name><argument_list pos:line="241" pos:column="23">(<argument><expr><name pos:line="241" pos:column="24">ptr<pos:position pos:line="241" pos:column="27"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="241" pos:column="29">';'<pos:position pos:line="241" pos:column="32"/></literal></expr></argument>)<pos:position pos:line="241" pos:column="33"/></argument_list></call></expr>;<pos:position pos:line="241" pos:column="34"/></expr_stmt> <comment type="block" pos:line="241" pos:column="35">/* now, find the next semicolon */</comment>

      <if pos:line="243" pos:column="7">if<condition pos:line="243" pos:column="9">(<expr><operator pos:line="243" pos:column="10">!<pos:position pos:line="243" pos:column="11"/></operator><name pos:line="243" pos:column="11">semiptr<pos:position pos:line="243" pos:column="18"/></name> <operator pos:line="243" pos:column="19">&amp;&amp;<pos:position pos:line="243" pos:column="29"/></operator> <operator pos:line="243" pos:column="22">*<pos:position pos:line="243" pos:column="23"/></operator><name pos:line="243" pos:column="23">ptr<pos:position pos:line="243" pos:column="26"/></name></expr>)<pos:position pos:line="243" pos:column="27"/></condition><then pos:line="243" pos:column="27">
        <comment type="block" pos:line="244" pos:column="9">/* There are no more semicolons, but there's a final name=value pair
           coming up */</comment>
        <block type="pseudo"><expr_stmt><expr><name pos:line="246" pos:column="9">semiptr<pos:position pos:line="246" pos:column="16"/></name> <operator pos:line="246" pos:column="17">=<pos:position pos:line="246" pos:column="18"/></operator> <call><name pos:line="246" pos:column="19">strchr<pos:position pos:line="246" pos:column="25"/></name><argument_list pos:line="246" pos:column="25">(<argument><expr><name pos:line="246" pos:column="26">ptr<pos:position pos:line="246" pos:column="29"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="246" pos:column="31">'\0'<pos:position pos:line="246" pos:column="35"/></literal></expr></argument>)<pos:position pos:line="246" pos:column="36"/></argument_list></call></expr>;<pos:position pos:line="246" pos:column="37"/></expr_stmt></block></then></if>
    }<pos:position pos:line="247" pos:column="6"/></block> while<condition pos:line="247" pos:column="12">(<expr><name pos:line="247" pos:column="13">semiptr<pos:position pos:line="247" pos:column="20"/></name></expr>)<pos:position pos:line="247" pos:column="21"/></condition>;<pos:position pos:line="247" pos:column="22"/></do>

    <if pos:line="249" pos:column="5">if<condition pos:line="249" pos:column="7">(<expr><name><name pos:line="249" pos:column="8">co<pos:position pos:line="249" pos:column="10"/></name><operator pos:line="249" pos:column="10">-&gt;<pos:position pos:line="249" pos:column="15"/></operator><name pos:line="249" pos:column="12">maxage<pos:position pos:line="249" pos:column="18"/></name></name></expr>)<pos:position pos:line="249" pos:column="19"/></condition><then pos:line="249" pos:column="19"> <block pos:line="249" pos:column="20">{
      <decl_stmt><decl><type><name pos:line="250" pos:column="7">CURLofft<pos:position pos:line="250" pos:column="15"/></name></type> <name pos:line="250" pos:column="16">offt<pos:position pos:line="250" pos:column="20"/></name></decl>;<pos:position pos:line="250" pos:column="21"/></decl_stmt>
      <expr_stmt><expr><name pos:line="251" pos:column="7">offt<pos:position pos:line="251" pos:column="11"/></name> <operator pos:line="251" pos:column="12">=<pos:position pos:line="251" pos:column="13"/></operator> <call><name pos:line="251" pos:column="14">curlx_strtoofft<pos:position pos:line="251" pos:column="29"/></name><argument_list pos:line="251" pos:column="29">(<argument><expr><ternary><condition><expr><operator pos:line="251" pos:column="30">(<pos:position pos:line="251" pos:column="31"/></operator><operator pos:line="251" pos:column="31">*<pos:position pos:line="251" pos:column="32"/></operator><name><name pos:line="251" pos:column="32">co<pos:position pos:line="251" pos:column="34"/></name><operator pos:line="251" pos:column="34">-&gt;<pos:position pos:line="251" pos:column="39"/></operator><name pos:line="251" pos:column="36">maxage<pos:position pos:line="251" pos:column="42"/></name></name> <operator pos:line="251" pos:column="43">==<pos:position pos:line="251" pos:column="45"/></operator> <literal type="char" pos:line="251" pos:column="46">'\"'<pos:position pos:line="251" pos:column="50"/></literal><operator pos:line="251" pos:column="50">)<pos:position pos:line="251" pos:column="51"/></operator></expr>?<pos:position pos:line="251" pos:column="52"/></condition><then pos:line="251" pos:column="52">
                             <expr><operator pos:line="252" pos:column="30">&amp;<pos:position pos:line="252" pos:column="35"/></operator><name><name pos:line="252" pos:column="31">co<pos:position pos:line="252" pos:column="33"/></name><operator pos:line="252" pos:column="33">-&gt;<pos:position pos:line="252" pos:column="38"/></operator><name pos:line="252" pos:column="35">maxage<pos:position pos:line="252" pos:column="41"/></name><index pos:line="252" pos:column="41">[<expr><literal type="number" pos:line="252" pos:column="42">1<pos:position pos:line="252" pos:column="43"/></literal></expr>]<pos:position pos:line="252" pos:column="44"/></index></name></expr></then><else pos:line="252" pos:column="44">:<expr><operator pos:line="252" pos:column="45">&amp;<pos:position pos:line="252" pos:column="50"/></operator><name><name pos:line="252" pos:column="46">co<pos:position pos:line="252" pos:column="48"/></name><operator pos:line="252" pos:column="48">-&gt;<pos:position pos:line="252" pos:column="53"/></operator><name pos:line="252" pos:column="50">maxage<pos:position pos:line="252" pos:column="56"/></name><index pos:line="252" pos:column="56">[<expr><literal type="number" pos:line="252" pos:column="57">0<pos:position pos:line="252" pos:column="58"/></literal></expr>]<pos:position pos:line="252" pos:column="59"/></index></name></expr></else></ternary></expr></argument>, <argument><expr><name pos:line="252" pos:column="61">NULL<pos:position pos:line="252" pos:column="65"/></name></expr></argument>, <argument><expr><literal type="number" pos:line="252" pos:column="67">10<pos:position pos:line="252" pos:column="69"/></literal></expr></argument>,
                             <argument><expr><operator pos:line="253" pos:column="30">&amp;<pos:position pos:line="253" pos:column="35"/></operator><name><name pos:line="253" pos:column="31">co<pos:position pos:line="253" pos:column="33"/></name><operator pos:line="253" pos:column="33">-&gt;<pos:position pos:line="253" pos:column="38"/></operator><name pos:line="253" pos:column="35">expires<pos:position pos:line="253" pos:column="42"/></name></name></expr></argument>)<pos:position pos:line="253" pos:column="43"/></argument_list></call></expr>;<pos:position pos:line="253" pos:column="44"/></expr_stmt>
      <if pos:line="254" pos:column="7">if<condition pos:line="254" pos:column="9">(<expr><name pos:line="254" pos:column="10">offt<pos:position pos:line="254" pos:column="14"/></name> <operator pos:line="254" pos:column="15">==<pos:position pos:line="254" pos:column="17"/></operator> <name pos:line="254" pos:column="18">CURL_OFFT_FLOW<pos:position pos:line="254" pos:column="32"/></name></expr>)<pos:position pos:line="254" pos:column="33"/></condition><then pos:line="254" pos:column="33">
        <comment type="block" pos:line="255" pos:column="9">/* overflow, used max value */</comment>
        <block type="pseudo"><expr_stmt><expr><name><name pos:line="256" pos:column="9">co<pos:position pos:line="256" pos:column="11"/></name><operator pos:line="256" pos:column="11">-&gt;<pos:position pos:line="256" pos:column="16"/></operator><name pos:line="256" pos:column="13">expires<pos:position pos:line="256" pos:column="20"/></name></name> <operator pos:line="256" pos:column="21">=<pos:position pos:line="256" pos:column="22"/></operator> <name pos:line="256" pos:column="23">CURL_OFF_T_MAX<pos:position pos:line="256" pos:column="37"/></name></expr>;<pos:position pos:line="256" pos:column="38"/></expr_stmt></block></then>
      <elseif pos:line="257" pos:column="7">else <if pos:line="257" pos:column="12">if<condition pos:line="257" pos:column="14">(<expr><operator pos:line="257" pos:column="15">!<pos:position pos:line="257" pos:column="16"/></operator><name pos:line="257" pos:column="16">offt<pos:position pos:line="257" pos:column="20"/></name></expr>)<pos:position pos:line="257" pos:column="21"/></condition><then pos:line="257" pos:column="21"> <block pos:line="257" pos:column="22">{
        <if pos:line="258" pos:column="9">if<condition pos:line="258" pos:column="11">(<expr><name pos:line="258" pos:column="12">CURL_OFF_T_MAX<pos:position pos:line="258" pos:column="26"/></name> <operator pos:line="258" pos:column="27">-<pos:position pos:line="258" pos:column="28"/></operator> <name pos:line="258" pos:column="29">now<pos:position pos:line="258" pos:column="32"/></name> <operator pos:line="258" pos:column="33">&lt;<pos:position pos:line="258" pos:column="37"/></operator> <name><name pos:line="258" pos:column="35">co<pos:position pos:line="258" pos:column="37"/></name><operator pos:line="258" pos:column="37">-&gt;<pos:position pos:line="258" pos:column="42"/></operator><name pos:line="258" pos:column="39">expires<pos:position pos:line="258" pos:column="46"/></name></name></expr>)<pos:position pos:line="258" pos:column="47"/></condition><then pos:line="258" pos:column="47">
          <comment type="block" pos:line="259" pos:column="11">/* would overflow */</comment>
          <block type="pseudo"><expr_stmt><expr><name><name pos:line="260" pos:column="11">co<pos:position pos:line="260" pos:column="13"/></name><operator pos:line="260" pos:column="13">-&gt;<pos:position pos:line="260" pos:column="18"/></operator><name pos:line="260" pos:column="15">expires<pos:position pos:line="260" pos:column="22"/></name></name> <operator pos:line="260" pos:column="23">=<pos:position pos:line="260" pos:column="24"/></operator> <name pos:line="260" pos:column="25">CURL_OFF_T_MAX<pos:position pos:line="260" pos:column="39"/></name></expr>;<pos:position pos:line="260" pos:column="40"/></expr_stmt></block></then>
        <else pos:line="261" pos:column="9">else
          <block type="pseudo"><expr_stmt><expr><name><name pos:line="262" pos:column="11">co<pos:position pos:line="262" pos:column="13"/></name><operator pos:line="262" pos:column="13">-&gt;<pos:position pos:line="262" pos:column="18"/></operator><name pos:line="262" pos:column="15">expires<pos:position pos:line="262" pos:column="22"/></name></name> <operator pos:line="262" pos:column="23">+=<pos:position pos:line="262" pos:column="25"/></operator> <name pos:line="262" pos:column="26">now<pos:position pos:line="262" pos:column="29"/></name></expr>;<pos:position pos:line="262" pos:column="30"/></expr_stmt></block></else></if>
      }<pos:position pos:line="263" pos:column="8"/></block></then></if></elseif></if>
    }<pos:position pos:line="264" pos:column="6"/></block></then>
    <elseif pos:line="265" pos:column="5">else <if pos:line="265" pos:column="10">if<condition pos:line="265" pos:column="12">(<expr><name><name pos:line="265" pos:column="13">co<pos:position pos:line="265" pos:column="15"/></name><operator pos:line="265" pos:column="15">-&gt;<pos:position pos:line="265" pos:column="20"/></operator><name pos:line="265" pos:column="17">expirestr<pos:position pos:line="265" pos:column="26"/></name></name></expr>)<pos:position pos:line="265" pos:column="27"/></condition><then pos:line="265" pos:column="27"> <block pos:line="265" pos:column="28">{
      <comment type="block" pos:line="266" pos:column="7">/* Note that if the date couldn't get parsed for whatever reason,
         the cookie will be treated as a session cookie */</comment>
      <expr_stmt><expr><name><name pos:line="268" pos:column="7">co<pos:position pos:line="268" pos:column="9"/></name><operator pos:line="268" pos:column="9">-&gt;<pos:position pos:line="268" pos:column="14"/></operator><name pos:line="268" pos:column="11">expires<pos:position pos:line="268" pos:column="18"/></name></name> <operator pos:line="268" pos:column="19">=<pos:position pos:line="268" pos:column="20"/></operator> <call><name pos:line="268" pos:column="21">curl_getdate<pos:position pos:line="268" pos:column="33"/></name><argument_list pos:line="268" pos:column="33">(<argument><expr><name><name pos:line="268" pos:column="34">co<pos:position pos:line="268" pos:column="36"/></name><operator pos:line="268" pos:column="36">-&gt;<pos:position pos:line="268" pos:column="41"/></operator><name pos:line="268" pos:column="38">expirestr<pos:position pos:line="268" pos:column="47"/></name></name></expr></argument>, <argument><expr><name pos:line="268" pos:column="49">NULL<pos:position pos:line="268" pos:column="53"/></name></expr></argument>)<pos:position pos:line="268" pos:column="54"/></argument_list></call></expr>;<pos:position pos:line="268" pos:column="55"/></expr_stmt>

      <comment type="block" pos:line="270" pos:column="7">/* Session cookies have expires set to 0 so if we get that back
         from the date parser let's add a second to make it a
         non-session cookie */</comment>
      <if pos:line="273" pos:column="7">if<condition pos:line="273" pos:column="9">(<expr><name><name pos:line="273" pos:column="10">co<pos:position pos:line="273" pos:column="12"/></name><operator pos:line="273" pos:column="12">-&gt;<pos:position pos:line="273" pos:column="17"/></operator><name pos:line="273" pos:column="14">expires<pos:position pos:line="273" pos:column="21"/></name></name> <operator pos:line="273" pos:column="22">==<pos:position pos:line="273" pos:column="24"/></operator> <literal type="number" pos:line="273" pos:column="25">0<pos:position pos:line="273" pos:column="26"/></literal></expr>)<pos:position pos:line="273" pos:column="27"/></condition><then pos:line="273" pos:column="27">
        <block type="pseudo"><expr_stmt><expr><name><name pos:line="274" pos:column="9">co<pos:position pos:line="274" pos:column="11"/></name><operator pos:line="274" pos:column="11">-&gt;<pos:position pos:line="274" pos:column="16"/></operator><name pos:line="274" pos:column="13">expires<pos:position pos:line="274" pos:column="20"/></name></name> <operator pos:line="274" pos:column="21">=<pos:position pos:line="274" pos:column="22"/></operator> <literal type="number" pos:line="274" pos:column="23">1<pos:position pos:line="274" pos:column="24"/></literal></expr>;<pos:position pos:line="274" pos:column="25"/></expr_stmt></block></then>
      <elseif pos:line="275" pos:column="7">else <if pos:line="275" pos:column="12">if<condition pos:line="275" pos:column="14">(<expr><name><name pos:line="275" pos:column="15">co<pos:position pos:line="275" pos:column="17"/></name><operator pos:line="275" pos:column="17">-&gt;<pos:position pos:line="275" pos:column="22"/></operator><name pos:line="275" pos:column="19">expires<pos:position pos:line="275" pos:column="26"/></name></name> <operator pos:line="275" pos:column="27">&lt;<pos:position pos:line="275" pos:column="31"/></operator> <literal type="number" pos:line="275" pos:column="29">0<pos:position pos:line="275" pos:column="30"/></literal></expr>)<pos:position pos:line="275" pos:column="31"/></condition><then pos:line="275" pos:column="31">
        <block type="pseudo"><expr_stmt><expr><name><name pos:line="276" pos:column="9">co<pos:position pos:line="276" pos:column="11"/></name><operator pos:line="276" pos:column="11">-&gt;<pos:position pos:line="276" pos:column="16"/></operator><name pos:line="276" pos:column="13">expires<pos:position pos:line="276" pos:column="20"/></name></name> <operator pos:line="276" pos:column="21">=<pos:position pos:line="276" pos:column="22"/></operator> <literal type="number" pos:line="276" pos:column="23">0<pos:position pos:line="276" pos:column="24"/></literal></expr>;<pos:position pos:line="276" pos:column="25"/></expr_stmt></block></then></if></elseif></if>
    }<pos:position pos:line="277" pos:column="6"/></block></then></if></elseif></if>

    <if pos:line="279" pos:column="5">if<condition pos:line="279" pos:column="7">(<expr><operator pos:line="279" pos:column="8">!<pos:position pos:line="279" pos:column="9"/></operator><name pos:line="279" pos:column="9">badcookie<pos:position pos:line="279" pos:column="18"/></name> <operator pos:line="279" pos:column="19">&amp;&amp;<pos:position pos:line="279" pos:column="29"/></operator> <operator pos:line="279" pos:column="22">!<pos:position pos:line="279" pos:column="23"/></operator><name><name pos:line="279" pos:column="23">co<pos:position pos:line="279" pos:column="25"/></name><operator pos:line="279" pos:column="25">-&gt;<pos:position pos:line="279" pos:column="30"/></operator><name pos:line="279" pos:column="27">domain<pos:position pos:line="279" pos:column="33"/></name></name></expr>)<pos:position pos:line="279" pos:column="34"/></condition><then pos:line="279" pos:column="34"> <block pos:line="279" pos:column="35">{
      <if pos:line="280" pos:column="7">if<condition pos:line="280" pos:column="9">(<expr><name pos:line="280" pos:column="10">domain<pos:position pos:line="280" pos:column="16"/></name></expr>)<pos:position pos:line="280" pos:column="17"/></condition><then pos:line="280" pos:column="17"> <block pos:line="280" pos:column="18">{
        <comment type="block" pos:line="281" pos:column="9">/* no domain was given in the header line, set the default */</comment>
        <expr_stmt><expr><name><name pos:line="282" pos:column="9">co<pos:position pos:line="282" pos:column="11"/></name><operator pos:line="282" pos:column="11">-&gt;<pos:position pos:line="282" pos:column="16"/></operator><name pos:line="282" pos:column="13">domain<pos:position pos:line="282" pos:column="19"/></name></name> <operator pos:line="282" pos:column="20">=<pos:position pos:line="282" pos:column="21"/></operator> <call><name pos:line="282" pos:column="22">strdup<pos:position pos:line="282" pos:column="28"/></name><argument_list pos:line="282" pos:column="28">(<argument><expr><name pos:line="282" pos:column="29">domain<pos:position pos:line="282" pos:column="35"/></name></expr></argument>)<pos:position pos:line="282" pos:column="36"/></argument_list></call></expr>;<pos:position pos:line="282" pos:column="37"/></expr_stmt>
        <if pos:line="283" pos:column="9">if<condition pos:line="283" pos:column="11">(<expr><operator pos:line="283" pos:column="12">!<pos:position pos:line="283" pos:column="13"/></operator><name><name pos:line="283" pos:column="13">co<pos:position pos:line="283" pos:column="15"/></name><operator pos:line="283" pos:column="15">-&gt;<pos:position pos:line="283" pos:column="20"/></operator><name pos:line="283" pos:column="17">domain<pos:position pos:line="283" pos:column="23"/></name></name></expr>)<pos:position pos:line="283" pos:column="24"/></condition><then pos:line="283" pos:column="24">
          <block type="pseudo"><expr_stmt><expr><name pos:line="284" pos:column="11">badcookie<pos:position pos:line="284" pos:column="20"/></name> <operator pos:line="284" pos:column="21">=<pos:position pos:line="284" pos:column="22"/></operator> <name pos:line="284" pos:column="23">TRUE<pos:position pos:line="284" pos:column="27"/></name></expr>;<pos:position pos:line="284" pos:column="28"/></expr_stmt></block></then></if>
      }<pos:position pos:line="285" pos:column="8"/></block></then></if>
    }<pos:position pos:line="286" pos:column="6"/></block></then></if>

    <if pos:line="288" pos:column="5">if<condition pos:line="288" pos:column="7">(<expr><operator pos:line="288" pos:column="8">!<pos:position pos:line="288" pos:column="9"/></operator><name pos:line="288" pos:column="9">badcookie<pos:position pos:line="288" pos:column="18"/></name> <operator pos:line="288" pos:column="19">&amp;&amp;<pos:position pos:line="288" pos:column="29"/></operator> <operator pos:line="288" pos:column="22">!<pos:position pos:line="288" pos:column="23"/></operator><name><name pos:line="288" pos:column="23">co<pos:position pos:line="288" pos:column="25"/></name><operator pos:line="288" pos:column="25">-&gt;<pos:position pos:line="288" pos:column="30"/></operator><name pos:line="288" pos:column="27">path<pos:position pos:line="288" pos:column="31"/></name></name> <operator pos:line="288" pos:column="32">&amp;&amp;<pos:position pos:line="288" pos:column="42"/></operator> <name pos:line="288" pos:column="35">path<pos:position pos:line="288" pos:column="39"/></name></expr>)<pos:position pos:line="288" pos:column="40"/></condition><then pos:line="288" pos:column="40"> <block pos:line="288" pos:column="41">{
      <comment type="block" pos:line="289" pos:column="7">/* No path was given in the header line, set the default.
         Note that the passed-in path to this function MAY have a '?' and
         following part that MUST not be stored as part of the path. */</comment>
      <decl_stmt><decl><type><name pos:line="292" pos:column="7">char<pos:position pos:line="292" pos:column="11"/></name> <modifier pos:line="292" pos:column="12">*<pos:position pos:line="292" pos:column="13"/></modifier></type><name pos:line="292" pos:column="13">queryp<pos:position pos:line="292" pos:column="19"/></name> <init pos:line="292" pos:column="20">= <expr><call><name pos:line="292" pos:column="22">strchr<pos:position pos:line="292" pos:column="28"/></name><argument_list pos:line="292" pos:column="28">(<argument><expr><name pos:line="292" pos:column="29">path<pos:position pos:line="292" pos:column="33"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="292" pos:column="35">'?'<pos:position pos:line="292" pos:column="38"/></literal></expr></argument>)<pos:position pos:line="292" pos:column="39"/></argument_list></call></expr></init></decl>;<pos:position pos:line="292" pos:column="40"/></decl_stmt>

      <comment type="block" pos:line="294" pos:column="7">/* queryp is where the interesting part of the path ends, so now we
         want to the find the last */</comment>
      <decl_stmt><decl><type><name pos:line="296" pos:column="7">char<pos:position pos:line="296" pos:column="11"/></name> <modifier pos:line="296" pos:column="12">*<pos:position pos:line="296" pos:column="13"/></modifier></type><name pos:line="296" pos:column="13">endslash<pos:position pos:line="296" pos:column="21"/></name></decl>;<pos:position pos:line="296" pos:column="22"/></decl_stmt>
      <if pos:line="297" pos:column="7">if<condition pos:line="297" pos:column="9">(<expr><operator pos:line="297" pos:column="10">!<pos:position pos:line="297" pos:column="11"/></operator><name pos:line="297" pos:column="11">queryp<pos:position pos:line="297" pos:column="17"/></name></expr>)<pos:position pos:line="297" pos:column="18"/></condition><then pos:line="297" pos:column="18">
        <block type="pseudo"><expr_stmt><expr><name pos:line="298" pos:column="9">endslash<pos:position pos:line="298" pos:column="17"/></name> <operator pos:line="298" pos:column="18">=<pos:position pos:line="298" pos:column="19"/></operator> <call><name pos:line="298" pos:column="20">strrchr<pos:position pos:line="298" pos:column="27"/></name><argument_list pos:line="298" pos:column="27">(<argument><expr><name pos:line="298" pos:column="28">path<pos:position pos:line="298" pos:column="32"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="298" pos:column="34">'/'<pos:position pos:line="298" pos:column="37"/></literal></expr></argument>)<pos:position pos:line="298" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="298" pos:column="39"/></expr_stmt></block></then>
      <else pos:line="299" pos:column="7">else
        <block type="pseudo"><expr_stmt><expr><name pos:line="300" pos:column="9">endslash<pos:position pos:line="300" pos:column="17"/></name> <operator pos:line="300" pos:column="18">=<pos:position pos:line="300" pos:column="19"/></operator> <call><name pos:line="300" pos:column="20">memrchr<pos:position pos:line="300" pos:column="27"/></name><argument_list pos:line="300" pos:column="27">(<argument><expr><name pos:line="300" pos:column="28">path<pos:position pos:line="300" pos:column="32"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="300" pos:column="34">'/'<pos:position pos:line="300" pos:column="37"/></literal></expr></argument>, <argument><expr><call pos:line="300" pos:column="39">(<name pos:line="300" pos:column="40">size_t<pos:position pos:line="300" pos:column="46"/></name>)<argument_list pos:line="300" pos:column="47">(<argument><expr><name pos:line="300" pos:column="48">queryp<pos:position pos:line="300" pos:column="54"/></name> <operator pos:line="300" pos:column="55">-<pos:position pos:line="300" pos:column="56"/></operator> <name pos:line="300" pos:column="57">path<pos:position pos:line="300" pos:column="61"/></name></expr></argument>)<pos:position pos:line="300" pos:column="62"/></argument_list></call></expr></argument>)<pos:position pos:line="300" pos:column="63"/></argument_list></call></expr>;<pos:position pos:line="300" pos:column="64"/></expr_stmt></block></else></if>
      <if pos:line="301" pos:column="7">if<condition pos:line="301" pos:column="9">(<expr><name pos:line="301" pos:column="10">endslash<pos:position pos:line="301" pos:column="18"/></name></expr>)<pos:position pos:line="301" pos:column="19"/></condition><then pos:line="301" pos:column="19"> <block pos:line="301" pos:column="20">{
        <decl_stmt><decl><type><name pos:line="302" pos:column="9">size_t<pos:position pos:line="302" pos:column="15"/></name></type> <name pos:line="302" pos:column="16">pathlen<pos:position pos:line="302" pos:column="23"/></name> <init pos:line="302" pos:column="24">= <expr><call pos:line="302" pos:column="26">(<name pos:line="302" pos:column="27">size_t<pos:position pos:line="302" pos:column="33"/></name>)<argument_list pos:line="302" pos:column="34">(<argument><expr><name pos:line="302" pos:column="35">endslash<pos:position pos:line="302" pos:column="43"/></name><operator pos:line="302" pos:column="43">-<pos:position pos:line="302" pos:column="44"/></operator><name pos:line="302" pos:column="44">path<pos:position pos:line="302" pos:column="48"/></name> <operator pos:line="302" pos:column="49">+<pos:position pos:line="302" pos:column="50"/></operator> <literal type="number" pos:line="302" pos:column="51">1<pos:position pos:line="302" pos:column="52"/></literal></expr></argument>)<pos:position pos:line="302" pos:column="53"/></argument_list></call></expr></init></decl>;<pos:position pos:line="302" pos:column="54"/></decl_stmt> <comment type="block" pos:line="302" pos:column="55">/* include end slash */</comment>
        <expr_stmt><expr><name><name pos:line="303" pos:column="9">co<pos:position pos:line="303" pos:column="11"/></name><operator pos:line="303" pos:column="11">-&gt;<pos:position pos:line="303" pos:column="16"/></operator><name pos:line="303" pos:column="13">path<pos:position pos:line="303" pos:column="17"/></name></name> <operator pos:line="303" pos:column="18">=<pos:position pos:line="303" pos:column="19"/></operator> <call><name pos:line="303" pos:column="20">malloc<pos:position pos:line="303" pos:column="26"/></name><argument_list pos:line="303" pos:column="26">(<argument><expr><name pos:line="303" pos:column="27">pathlen<pos:position pos:line="303" pos:column="34"/></name> <operator pos:line="303" pos:column="35">+<pos:position pos:line="303" pos:column="36"/></operator> <literal type="number" pos:line="303" pos:column="37">1<pos:position pos:line="303" pos:column="38"/></literal></expr></argument>)<pos:position pos:line="303" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="303" pos:column="40"/></expr_stmt> <comment type="block" pos:line="303" pos:column="41">/* one extra for the zero byte */</comment>
        <if pos:line="304" pos:column="9">if<condition pos:line="304" pos:column="11">(<expr><name><name pos:line="304" pos:column="12">co<pos:position pos:line="304" pos:column="14"/></name><operator pos:line="304" pos:column="14">-&gt;<pos:position pos:line="304" pos:column="19"/></operator><name pos:line="304" pos:column="16">path<pos:position pos:line="304" pos:column="20"/></name></name></expr>)<pos:position pos:line="304" pos:column="21"/></condition><then pos:line="304" pos:column="21"> <block pos:line="304" pos:column="22">{
          <expr_stmt><expr><call><name pos:line="305" pos:column="11">memcpy<pos:position pos:line="305" pos:column="17"/></name><argument_list pos:line="305" pos:column="17">(<argument><expr><name><name pos:line="305" pos:column="18">co<pos:position pos:line="305" pos:column="20"/></name><operator pos:line="305" pos:column="20">-&gt;<pos:position pos:line="305" pos:column="25"/></operator><name pos:line="305" pos:column="22">path<pos:position pos:line="305" pos:column="26"/></name></name></expr></argument>, <argument><expr><name pos:line="305" pos:column="28">path<pos:position pos:line="305" pos:column="32"/></name></expr></argument>, <argument><expr><name pos:line="305" pos:column="34">pathlen<pos:position pos:line="305" pos:column="41"/></name></expr></argument>)<pos:position pos:line="305" pos:column="42"/></argument_list></call></expr>;<pos:position pos:line="305" pos:column="43"/></expr_stmt>
          <expr_stmt><expr><name><name pos:line="306" pos:column="11">co<pos:position pos:line="306" pos:column="13"/></name><operator pos:line="306" pos:column="13">-&gt;<pos:position pos:line="306" pos:column="18"/></operator><name pos:line="306" pos:column="15">path<pos:position pos:line="306" pos:column="19"/></name><index pos:line="306" pos:column="19">[<expr><name pos:line="306" pos:column="20">pathlen<pos:position pos:line="306" pos:column="27"/></name></expr>]<pos:position pos:line="306" pos:column="28"/></index></name> <operator pos:line="306" pos:column="29">=<pos:position pos:line="306" pos:column="30"/></operator> <literal type="number" pos:line="306" pos:column="31">0<pos:position pos:line="306" pos:column="32"/></literal></expr>;<pos:position pos:line="306" pos:column="33"/></expr_stmt> <comment type="block" pos:line="306" pos:column="34">/* zero terminate */</comment>
          <expr_stmt><expr><name><name pos:line="307" pos:column="11">co<pos:position pos:line="307" pos:column="13"/></name><operator pos:line="307" pos:column="13">-&gt;<pos:position pos:line="307" pos:column="18"/></operator><name pos:line="307" pos:column="15">spath<pos:position pos:line="307" pos:column="20"/></name></name> <operator pos:line="307" pos:column="21">=<pos:position pos:line="307" pos:column="22"/></operator> <call><name pos:line="307" pos:column="23">sanitize_cookie_path<pos:position pos:line="307" pos:column="43"/></name><argument_list pos:line="307" pos:column="43">(<argument><expr><name><name pos:line="307" pos:column="44">co<pos:position pos:line="307" pos:column="46"/></name><operator pos:line="307" pos:column="46">-&gt;<pos:position pos:line="307" pos:column="51"/></operator><name pos:line="307" pos:column="48">path<pos:position pos:line="307" pos:column="52"/></name></name></expr></argument>)<pos:position pos:line="307" pos:column="53"/></argument_list></call></expr>;<pos:position pos:line="307" pos:column="54"/></expr_stmt>
          <if pos:line="308" pos:column="11">if<condition pos:line="308" pos:column="13">(<expr><operator pos:line="308" pos:column="14">!<pos:position pos:line="308" pos:column="15"/></operator><name><name pos:line="308" pos:column="15">co<pos:position pos:line="308" pos:column="17"/></name><operator pos:line="308" pos:column="17">-&gt;<pos:position pos:line="308" pos:column="22"/></operator><name pos:line="308" pos:column="19">spath<pos:position pos:line="308" pos:column="24"/></name></name></expr>)<pos:position pos:line="308" pos:column="25"/></condition><then pos:line="308" pos:column="25">
            <block type="pseudo"><expr_stmt><expr><name pos:line="309" pos:column="13">badcookie<pos:position pos:line="309" pos:column="22"/></name> <operator pos:line="309" pos:column="23">=<pos:position pos:line="309" pos:column="24"/></operator> <name pos:line="309" pos:column="25">TRUE<pos:position pos:line="309" pos:column="29"/></name></expr>;<pos:position pos:line="309" pos:column="30"/></expr_stmt></block></then></if> <comment type="block" pos:line="309" pos:column="31">/* out of memory bad */</comment>
        }<pos:position pos:line="310" pos:column="10"/></block></then>
        <else pos:line="311" pos:column="9">else
          <block type="pseudo"><expr_stmt><expr><name pos:line="312" pos:column="11">badcookie<pos:position pos:line="312" pos:column="20"/></name> <operator pos:line="312" pos:column="21">=<pos:position pos:line="312" pos:column="22"/></operator> <name pos:line="312" pos:column="23">TRUE<pos:position pos:line="312" pos:column="27"/></name></expr>;<pos:position pos:line="312" pos:column="28"/></expr_stmt></block></else></if>
      }<pos:position pos:line="313" pos:column="8"/></block></then></if>
    }<pos:position pos:line="314" pos:column="6"/></block></then></if>

    <if pos:line="316" pos:column="5">if<condition pos:line="316" pos:column="7">(<expr><name pos:line="316" pos:column="8">badcookie<pos:position pos:line="316" pos:column="17"/></name> <operator pos:line="316" pos:column="18">||<pos:position pos:line="316" pos:column="20"/></operator> <operator pos:line="316" pos:column="21">!<pos:position pos:line="316" pos:column="22"/></operator><name><name pos:line="316" pos:column="22">co<pos:position pos:line="316" pos:column="24"/></name><operator pos:line="316" pos:column="24">-&gt;<pos:position pos:line="316" pos:column="29"/></operator><name pos:line="316" pos:column="26">name<pos:position pos:line="316" pos:column="30"/></name></name></expr>)<pos:position pos:line="316" pos:column="31"/></condition><then pos:line="316" pos:column="31"> <block pos:line="316" pos:column="32">{
      <comment type="block" pos:line="317" pos:column="7">/* we didn't get a cookie name or a bad one,
         this is an illegal line, bail out */</comment>
      <expr_stmt><expr><call><name pos:line="319" pos:column="7">freecookie<pos:position pos:line="319" pos:column="17"/></name><argument_list pos:line="319" pos:column="17">(<argument><expr><name pos:line="319" pos:column="18">co<pos:position pos:line="319" pos:column="20"/></name></expr></argument>)<pos:position pos:line="319" pos:column="21"/></argument_list></call></expr>;<pos:position pos:line="319" pos:column="22"/></expr_stmt>
      <return pos:line="320" pos:column="7">return <expr><name pos:line="320" pos:column="14">NULL<pos:position pos:line="320" pos:column="18"/></name></expr>;<pos:position pos:line="320" pos:column="19"/></return>
    }<pos:position pos:line="321" pos:column="6"/></block></then></if>

  }<pos:position pos:line="323" pos:column="4"/></block></then>
  <else pos:line="324" pos:column="3">else <block pos:line="324" pos:column="8">{
    <comment type="block" pos:line="325" pos:column="5">/* This line is NOT a HTTP header style line, we do offer support for
       reading the odd netscape cookies-file format here */</comment>
    <decl_stmt><decl><type><name pos:line="327" pos:column="5">char<pos:position pos:line="327" pos:column="9"/></name> <modifier pos:line="327" pos:column="10">*<pos:position pos:line="327" pos:column="11"/></modifier></type><name pos:line="327" pos:column="11">ptr<pos:position pos:line="327" pos:column="14"/></name></decl>;<pos:position pos:line="327" pos:column="15"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="328" pos:column="5">char<pos:position pos:line="328" pos:column="9"/></name> <modifier pos:line="328" pos:column="10">*<pos:position pos:line="328" pos:column="11"/></modifier></type><name pos:line="328" pos:column="11">firstptr<pos:position pos:line="328" pos:column="19"/></name></decl>;<pos:position pos:line="328" pos:column="20"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="329" pos:column="5">char<pos:position pos:line="329" pos:column="9"/></name> <modifier pos:line="329" pos:column="10">*<pos:position pos:line="329" pos:column="11"/></modifier></type><name pos:line="329" pos:column="11">tok_buf<pos:position pos:line="329" pos:column="18"/></name> <init pos:line="329" pos:column="19">= <expr><name pos:line="329" pos:column="21">NULL<pos:position pos:line="329" pos:column="25"/></name></expr></init></decl>;<pos:position pos:line="329" pos:column="26"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="330" pos:column="5">int<pos:position pos:line="330" pos:column="8"/></name></type> <name pos:line="330" pos:column="9">fields<pos:position pos:line="330" pos:column="15"/></name></decl>;<pos:position pos:line="330" pos:column="16"/></decl_stmt>

    <comment type="block" pos:line="332" pos:column="5">/* IE introduced HTTP-only cookies to prevent XSS attacks. Cookies
       marked with httpOnly after the domain name are not accessible
       from javascripts, but since curl does not operate at javascript
       level, we include them anyway. In Firefox's cookie files, these
       lines are preceded with #HttpOnly_ and then everything is
       as usual, so we skip 10 characters of the line..
    */</comment>
    <if pos:line="339" pos:column="5">if<condition pos:line="339" pos:column="7">(<expr><call><name pos:line="339" pos:column="8">strncmp<pos:position pos:line="339" pos:column="15"/></name><argument_list pos:line="339" pos:column="15">(<argument><expr><name pos:line="339" pos:column="16">lineptr<pos:position pos:line="339" pos:column="23"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="339" pos:column="25">"#HttpOnly_"<pos:position pos:line="339" pos:column="37"/></literal></expr></argument>, <argument><expr><literal type="number" pos:line="339" pos:column="39">10<pos:position pos:line="339" pos:column="41"/></literal></expr></argument>)<pos:position pos:line="339" pos:column="42"/></argument_list></call> <operator pos:line="339" pos:column="43">==<pos:position pos:line="339" pos:column="45"/></operator> <literal type="number" pos:line="339" pos:column="46">0<pos:position pos:line="339" pos:column="47"/></literal></expr>)<pos:position pos:line="339" pos:column="48"/></condition><then pos:line="339" pos:column="48"> <block pos:line="339" pos:column="49">{
      <expr_stmt><expr><name pos:line="340" pos:column="7">lineptr<pos:position pos:line="340" pos:column="14"/></name> <operator pos:line="340" pos:column="15">+=<pos:position pos:line="340" pos:column="17"/></operator> <literal type="number" pos:line="340" pos:column="18">10<pos:position pos:line="340" pos:column="20"/></literal></expr>;<pos:position pos:line="340" pos:column="21"/></expr_stmt>
      <expr_stmt><expr><name><name pos:line="341" pos:column="7">co<pos:position pos:line="341" pos:column="9"/></name><operator pos:line="341" pos:column="9">-&gt;<pos:position pos:line="341" pos:column="14"/></operator><name pos:line="341" pos:column="11">httponly<pos:position pos:line="341" pos:column="19"/></name></name> <operator pos:line="341" pos:column="20">=<pos:position pos:line="341" pos:column="21"/></operator> <name pos:line="341" pos:column="22">TRUE<pos:position pos:line="341" pos:column="26"/></name></expr>;<pos:position pos:line="341" pos:column="27"/></expr_stmt>
    }<pos:position pos:line="342" pos:column="6"/></block></then></if>

    <if pos:line="344" pos:column="5">if<condition pos:line="344" pos:column="7">(<expr><name><name pos:line="344" pos:column="8">lineptr<pos:position pos:line="344" pos:column="15"/></name><index pos:line="344" pos:column="15">[<expr><literal type="number" pos:line="344" pos:column="16">0<pos:position pos:line="344" pos:column="17"/></literal></expr>]<pos:position pos:line="344" pos:column="18"/></index></name><operator pos:line="344" pos:column="18">==<pos:position pos:line="344" pos:column="20"/></operator><literal type="char" pos:line="344" pos:column="20">'#'<pos:position pos:line="344" pos:column="23"/></literal></expr>)<pos:position pos:line="344" pos:column="24"/></condition><then pos:line="344" pos:column="24"> <block pos:line="344" pos:column="25">{
      <comment type="block" pos:line="345" pos:column="7">/* don't even try the comments */</comment>
      <expr_stmt><expr><call><name pos:line="346" pos:column="7">free<pos:position pos:line="346" pos:column="11"/></name><argument_list pos:line="346" pos:column="11">(<argument><expr><name pos:line="346" pos:column="12">co<pos:position pos:line="346" pos:column="14"/></name></expr></argument>)<pos:position pos:line="346" pos:column="15"/></argument_list></call></expr>;<pos:position pos:line="346" pos:column="16"/></expr_stmt>
      <return pos:line="347" pos:column="7">return <expr><name pos:line="347" pos:column="14">NULL<pos:position pos:line="347" pos:column="18"/></name></expr>;<pos:position pos:line="347" pos:column="19"/></return>
    }<pos:position pos:line="348" pos:column="6"/></block></then></if>
    <comment type="block" pos:line="349" pos:column="5">/* strip off the possible end-of-line characters */</comment>
    <expr_stmt><expr><name pos:line="350" pos:column="5">ptr<pos:position pos:line="350" pos:column="8"/></name> <operator pos:line="350" pos:column="9">=<pos:position pos:line="350" pos:column="10"/></operator> <call><name pos:line="350" pos:column="11">strchr<pos:position pos:line="350" pos:column="17"/></name><argument_list pos:line="350" pos:column="17">(<argument><expr><name pos:line="350" pos:column="18">lineptr<pos:position pos:line="350" pos:column="25"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="350" pos:column="27">'\r'<pos:position pos:line="350" pos:column="31"/></literal></expr></argument>)<pos:position pos:line="350" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="350" pos:column="33"/></expr_stmt>
    <if pos:line="351" pos:column="5">if<condition pos:line="351" pos:column="7">(<expr><name pos:line="351" pos:column="8">ptr<pos:position pos:line="351" pos:column="11"/></name></expr>)<pos:position pos:line="351" pos:column="12"/></condition><then pos:line="351" pos:column="12">
      <block type="pseudo"><expr_stmt><expr><operator pos:line="352" pos:column="7">*<pos:position pos:line="352" pos:column="8"/></operator><name pos:line="352" pos:column="8">ptr<pos:position pos:line="352" pos:column="11"/></name> <operator pos:line="352" pos:column="12">=<pos:position pos:line="352" pos:column="13"/></operator> <literal type="number" pos:line="352" pos:column="14">0<pos:position pos:line="352" pos:column="15"/></literal></expr>;<pos:position pos:line="352" pos:column="16"/></expr_stmt></block></then></if> <comment type="block" pos:line="352" pos:column="17">/* clear it */</comment>
    <expr_stmt><expr><name pos:line="353" pos:column="5">ptr<pos:position pos:line="353" pos:column="8"/></name> <operator pos:line="353" pos:column="9">=<pos:position pos:line="353" pos:column="10"/></operator> <call><name pos:line="353" pos:column="11">strchr<pos:position pos:line="353" pos:column="17"/></name><argument_list pos:line="353" pos:column="17">(<argument><expr><name pos:line="353" pos:column="18">lineptr<pos:position pos:line="353" pos:column="25"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="353" pos:column="27">'\n'<pos:position pos:line="353" pos:column="31"/></literal></expr></argument>)<pos:position pos:line="353" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="353" pos:column="33"/></expr_stmt>
    <if pos:line="354" pos:column="5">if<condition pos:line="354" pos:column="7">(<expr><name pos:line="354" pos:column="8">ptr<pos:position pos:line="354" pos:column="11"/></name></expr>)<pos:position pos:line="354" pos:column="12"/></condition><then pos:line="354" pos:column="12">
      <block type="pseudo"><expr_stmt><expr><operator pos:line="355" pos:column="7">*<pos:position pos:line="355" pos:column="8"/></operator><name pos:line="355" pos:column="8">ptr<pos:position pos:line="355" pos:column="11"/></name> <operator pos:line="355" pos:column="12">=<pos:position pos:line="355" pos:column="13"/></operator> <literal type="number" pos:line="355" pos:column="14">0<pos:position pos:line="355" pos:column="15"/></literal></expr>;<pos:position pos:line="355" pos:column="16"/></expr_stmt></block></then></if> <comment type="block" pos:line="355" pos:column="17">/* clear it */</comment>

    <expr_stmt><expr><name pos:line="357" pos:column="5">firstptr<pos:position pos:line="357" pos:column="13"/></name> <operator pos:line="357" pos:column="14">=<pos:position pos:line="357" pos:column="15"/></operator> <call><name pos:line="357" pos:column="16">strtok_r<pos:position pos:line="357" pos:column="24"/></name><argument_list pos:line="357" pos:column="24">(<argument><expr><name pos:line="357" pos:column="25">lineptr<pos:position pos:line="357" pos:column="32"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="357" pos:column="34">"\t"<pos:position pos:line="357" pos:column="38"/></literal></expr></argument>, <argument><expr><operator pos:line="357" pos:column="40">&amp;<pos:position pos:line="357" pos:column="45"/></operator><name pos:line="357" pos:column="41">tok_buf<pos:position pos:line="357" pos:column="48"/></name></expr></argument>)<pos:position pos:line="357" pos:column="49"/></argument_list></call></expr>;<pos:position pos:line="357" pos:column="50"/></expr_stmt> <comment type="block" pos:line="357" pos:column="51">/* tokenize it on the TAB */</comment>

    <comment type="block" pos:line="359" pos:column="5">/* Now loop through the fields and init the struct we already have
       allocated */</comment>
    <for pos:line="361" pos:column="5">for<control pos:line="361" pos:column="8">(<init><expr><name pos:line="361" pos:column="9">ptr<pos:position pos:line="361" pos:column="12"/></name> <operator pos:line="361" pos:column="13">=<pos:position pos:line="361" pos:column="14"/></operator> <name pos:line="361" pos:column="15">firstptr<pos:position pos:line="361" pos:column="23"/></name></expr><operator pos:line="361" pos:column="23">,<pos:position pos:line="361" pos:column="24"/></operator> <expr><name pos:line="361" pos:column="25">fields<pos:position pos:line="361" pos:column="31"/></name> <operator pos:line="361" pos:column="32">=<pos:position pos:line="361" pos:column="33"/></operator> <literal type="number" pos:line="361" pos:column="34">0<pos:position pos:line="361" pos:column="35"/></literal></expr>;<pos:position pos:line="361" pos:column="36"/></init> <condition><expr><name pos:line="361" pos:column="37">ptr<pos:position pos:line="361" pos:column="40"/></name> <operator pos:line="361" pos:column="41">&amp;&amp;<pos:position pos:line="361" pos:column="51"/></operator> <operator pos:line="361" pos:column="44">!<pos:position pos:line="361" pos:column="45"/></operator><name pos:line="361" pos:column="45">badcookie<pos:position pos:line="361" pos:column="54"/></name></expr>;<pos:position pos:line="361" pos:column="55"/></condition>
        <incr><expr><name pos:line="362" pos:column="9">ptr<pos:position pos:line="362" pos:column="12"/></name> <operator pos:line="362" pos:column="13">=<pos:position pos:line="362" pos:column="14"/></operator> <call><name pos:line="362" pos:column="15">strtok_r<pos:position pos:line="362" pos:column="23"/></name><argument_list pos:line="362" pos:column="23">(<argument><expr><name pos:line="362" pos:column="24">NULL<pos:position pos:line="362" pos:column="28"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="362" pos:column="30">"\t"<pos:position pos:line="362" pos:column="34"/></literal></expr></argument>, <argument><expr><operator pos:line="362" pos:column="36">&amp;<pos:position pos:line="362" pos:column="41"/></operator><name pos:line="362" pos:column="37">tok_buf<pos:position pos:line="362" pos:column="44"/></name></expr></argument>)<pos:position pos:line="362" pos:column="45"/></argument_list></call></expr><operator pos:line="362" pos:column="45">,<pos:position pos:line="362" pos:column="46"/></operator> <expr><name pos:line="362" pos:column="47">fields<pos:position pos:line="362" pos:column="53"/></name><operator pos:line="362" pos:column="53">++<pos:position pos:line="362" pos:column="55"/></operator></expr></incr>)<pos:position pos:line="362" pos:column="56"/></control> <block pos:line="362" pos:column="57">{
      <switch pos:line="363" pos:column="7">switch<condition pos:line="363" pos:column="13">(<expr><name pos:line="363" pos:column="14">fields<pos:position pos:line="363" pos:column="20"/></name></expr>)<pos:position pos:line="363" pos:column="21"/></condition> <block pos:line="363" pos:column="22">{
      <case pos:line="364" pos:column="7">case <expr><literal type="number" pos:line="364" pos:column="12">0<pos:position pos:line="364" pos:column="13"/></literal></expr>:<pos:position pos:line="364" pos:column="14"/></case>
        <if pos:line="365" pos:column="9">if<condition pos:line="365" pos:column="11">(<expr><name><name pos:line="365" pos:column="12">ptr<pos:position pos:line="365" pos:column="15"/></name><index pos:line="365" pos:column="15">[<expr><literal type="number" pos:line="365" pos:column="16">0<pos:position pos:line="365" pos:column="17"/></literal></expr>]<pos:position pos:line="365" pos:column="18"/></index></name><operator pos:line="365" pos:column="18">==<pos:position pos:line="365" pos:column="20"/></operator><literal type="char" pos:line="365" pos:column="20">'.'<pos:position pos:line="365" pos:column="23"/></literal></expr>)<pos:position pos:line="365" pos:column="24"/></condition><then pos:line="365" pos:column="24"> <comment type="block" pos:line="365" pos:column="25">/* skip preceding dots */</comment>
          <block type="pseudo"><expr_stmt><expr><name pos:line="366" pos:column="11">ptr<pos:position pos:line="366" pos:column="14"/></name><operator pos:line="366" pos:column="14">++<pos:position pos:line="366" pos:column="16"/></operator></expr>;<pos:position pos:line="366" pos:column="17"/></expr_stmt></block></then></if>
        <expr_stmt><expr><name><name pos:line="367" pos:column="9">co<pos:position pos:line="367" pos:column="11"/></name><operator pos:line="367" pos:column="11">-&gt;<pos:position pos:line="367" pos:column="16"/></operator><name pos:line="367" pos:column="13">domain<pos:position pos:line="367" pos:column="19"/></name></name> <operator pos:line="367" pos:column="20">=<pos:position pos:line="367" pos:column="21"/></operator> <call><name pos:line="367" pos:column="22">strdup<pos:position pos:line="367" pos:column="28"/></name><argument_list pos:line="367" pos:column="28">(<argument><expr><name pos:line="367" pos:column="29">ptr<pos:position pos:line="367" pos:column="32"/></name></expr></argument>)<pos:position pos:line="367" pos:column="33"/></argument_list></call></expr>;<pos:position pos:line="367" pos:column="34"/></expr_stmt>
        <if pos:line="368" pos:column="9">if<condition pos:line="368" pos:column="11">(<expr><operator pos:line="368" pos:column="12">!<pos:position pos:line="368" pos:column="13"/></operator><name><name pos:line="368" pos:column="13">co<pos:position pos:line="368" pos:column="15"/></name><operator pos:line="368" pos:column="15">-&gt;<pos:position pos:line="368" pos:column="20"/></operator><name pos:line="368" pos:column="17">domain<pos:position pos:line="368" pos:column="23"/></name></name></expr>)<pos:position pos:line="368" pos:column="24"/></condition><then pos:line="368" pos:column="24">
          <block type="pseudo"><expr_stmt><expr><name pos:line="369" pos:column="11">badcookie<pos:position pos:line="369" pos:column="20"/></name> <operator pos:line="369" pos:column="21">=<pos:position pos:line="369" pos:column="22"/></operator> <name pos:line="369" pos:column="23">TRUE<pos:position pos:line="369" pos:column="27"/></name></expr>;<pos:position pos:line="369" pos:column="28"/></expr_stmt></block></then></if>
        <break pos:line="370" pos:column="9">break;<pos:position pos:line="370" pos:column="15"/></break>
      <case pos:line="371" pos:column="7">case <expr><literal type="number" pos:line="371" pos:column="12">1<pos:position pos:line="371" pos:column="13"/></literal></expr>:<pos:position pos:line="371" pos:column="14"/></case>
        <comment type="block" pos:line="372" pos:column="9">/* This field got its explanation on the 23rd of May 2001 by
           Andrés García:

           flag: A TRUE/FALSE value indicating if all machines within a given
           domain can access the variable. This value is set automatically by
           the browser, depending on the value you set for the domain.

           As far as I can see, it is set to true when the cookie says
           .domain.com and to false when the domain is complete www.domain.com
        */</comment>
        <expr_stmt><expr><name><name pos:line="382" pos:column="9">co<pos:position pos:line="382" pos:column="11"/></name><operator pos:line="382" pos:column="11">-&gt;<pos:position pos:line="382" pos:column="16"/></operator><name pos:line="382" pos:column="13">tailmatch<pos:position pos:line="382" pos:column="22"/></name></name> <operator pos:line="382" pos:column="23">=<pos:position pos:line="382" pos:column="24"/></operator> <ternary><condition><expr><call><name pos:line="382" pos:column="25">strcasecompare<pos:position pos:line="382" pos:column="39"/></name><argument_list pos:line="382" pos:column="39">(<argument><expr><name pos:line="382" pos:column="40">ptr<pos:position pos:line="382" pos:column="43"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="382" pos:column="45">"TRUE"<pos:position pos:line="382" pos:column="51"/></literal></expr></argument>)<pos:position pos:line="382" pos:column="52"/></argument_list></call></expr>?<pos:position pos:line="382" pos:column="53"/></condition><then><expr><name pos:line="382" pos:column="53">TRUE<pos:position pos:line="382" pos:column="57"/></name></expr></then><else pos:line="382" pos:column="57">:<expr><name pos:line="382" pos:column="58">FALSE<pos:position pos:line="382" pos:column="63"/></name></expr></else></ternary></expr>;<pos:position pos:line="382" pos:column="64"/></expr_stmt>
        <break pos:line="383" pos:column="9">break;<pos:position pos:line="383" pos:column="15"/></break>
      <case pos:line="384" pos:column="7">case <expr><literal type="number" pos:line="384" pos:column="12">2<pos:position pos:line="384" pos:column="13"/></literal></expr>:<pos:position pos:line="384" pos:column="14"/></case>
        <comment type="block" pos:line="385" pos:column="9">/* It turns out, that sometimes the file format allows the path
           field to remain not filled in, we try to detect this and work
           around it! Andrés García made us aware of this... */</comment>
        <if pos:line="388" pos:column="9">if<condition pos:line="388" pos:column="11">(<expr><call><name pos:line="388" pos:column="12">strcmp<pos:position pos:line="388" pos:column="18"/></name><argument_list pos:line="388" pos:column="18">(<argument><expr><literal type="string" pos:line="388" pos:column="19">"TRUE"<pos:position pos:line="388" pos:column="25"/></literal></expr></argument>, <argument><expr><name pos:line="388" pos:column="27">ptr<pos:position pos:line="388" pos:column="30"/></name></expr></argument>)<pos:position pos:line="388" pos:column="31"/></argument_list></call> <operator pos:line="388" pos:column="32">&amp;&amp;<pos:position pos:line="388" pos:column="42"/></operator> <call><name pos:line="388" pos:column="35">strcmp<pos:position pos:line="388" pos:column="41"/></name><argument_list pos:line="388" pos:column="41">(<argument><expr><literal type="string" pos:line="388" pos:column="42">"FALSE"<pos:position pos:line="388" pos:column="49"/></literal></expr></argument>, <argument><expr><name pos:line="388" pos:column="51">ptr<pos:position pos:line="388" pos:column="54"/></name></expr></argument>)<pos:position pos:line="388" pos:column="55"/></argument_list></call></expr>)<pos:position pos:line="388" pos:column="56"/></condition><then pos:line="388" pos:column="56"> <block pos:line="388" pos:column="57">{
          <comment type="block" pos:line="389" pos:column="11">/* only if the path doesn't look like a boolean option! */</comment>
          <expr_stmt><expr><name><name pos:line="390" pos:column="11">co<pos:position pos:line="390" pos:column="13"/></name><operator pos:line="390" pos:column="13">-&gt;<pos:position pos:line="390" pos:column="18"/></operator><name pos:line="390" pos:column="15">path<pos:position pos:line="390" pos:column="19"/></name></name> <operator pos:line="390" pos:column="20">=<pos:position pos:line="390" pos:column="21"/></operator> <call><name pos:line="390" pos:column="22">strdup<pos:position pos:line="390" pos:column="28"/></name><argument_list pos:line="390" pos:column="28">(<argument><expr><name pos:line="390" pos:column="29">ptr<pos:position pos:line="390" pos:column="32"/></name></expr></argument>)<pos:position pos:line="390" pos:column="33"/></argument_list></call></expr>;<pos:position pos:line="390" pos:column="34"/></expr_stmt>
          <if pos:line="391" pos:column="11">if<condition pos:line="391" pos:column="13">(<expr><operator pos:line="391" pos:column="14">!<pos:position pos:line="391" pos:column="15"/></operator><name><name pos:line="391" pos:column="15">co<pos:position pos:line="391" pos:column="17"/></name><operator pos:line="391" pos:column="17">-&gt;<pos:position pos:line="391" pos:column="22"/></operator><name pos:line="391" pos:column="19">path<pos:position pos:line="391" pos:column="23"/></name></name></expr>)<pos:position pos:line="391" pos:column="24"/></condition><then pos:line="391" pos:column="24">
            <block type="pseudo"><expr_stmt><expr><name pos:line="392" pos:column="13">badcookie<pos:position pos:line="392" pos:column="22"/></name> <operator pos:line="392" pos:column="23">=<pos:position pos:line="392" pos:column="24"/></operator> <name pos:line="392" pos:column="25">TRUE<pos:position pos:line="392" pos:column="29"/></name></expr>;<pos:position pos:line="392" pos:column="30"/></expr_stmt></block></then>
          <else pos:line="393" pos:column="11">else <block pos:line="393" pos:column="16">{
            <expr_stmt><expr><name><name pos:line="394" pos:column="13">co<pos:position pos:line="394" pos:column="15"/></name><operator pos:line="394" pos:column="15">-&gt;<pos:position pos:line="394" pos:column="20"/></operator><name pos:line="394" pos:column="17">spath<pos:position pos:line="394" pos:column="22"/></name></name> <operator pos:line="394" pos:column="23">=<pos:position pos:line="394" pos:column="24"/></operator> <call><name pos:line="394" pos:column="25">sanitize_cookie_path<pos:position pos:line="394" pos:column="45"/></name><argument_list pos:line="394" pos:column="45">(<argument><expr><name><name pos:line="394" pos:column="46">co<pos:position pos:line="394" pos:column="48"/></name><operator pos:line="394" pos:column="48">-&gt;<pos:position pos:line="394" pos:column="53"/></operator><name pos:line="394" pos:column="50">path<pos:position pos:line="394" pos:column="54"/></name></name></expr></argument>)<pos:position pos:line="394" pos:column="55"/></argument_list></call></expr>;<pos:position pos:line="394" pos:column="56"/></expr_stmt>
            <if pos:line="395" pos:column="13">if<condition pos:line="395" pos:column="15">(<expr><operator pos:line="395" pos:column="16">!<pos:position pos:line="395" pos:column="17"/></operator><name><name pos:line="395" pos:column="17">co<pos:position pos:line="395" pos:column="19"/></name><operator pos:line="395" pos:column="19">-&gt;<pos:position pos:line="395" pos:column="24"/></operator><name pos:line="395" pos:column="21">spath<pos:position pos:line="395" pos:column="26"/></name></name></expr>)<pos:position pos:line="395" pos:column="27"/></condition><then pos:line="395" pos:column="27"> <block pos:line="395" pos:column="28">{
              <expr_stmt><expr><name pos:line="396" pos:column="15">badcookie<pos:position pos:line="396" pos:column="24"/></name> <operator pos:line="396" pos:column="25">=<pos:position pos:line="396" pos:column="26"/></operator> <name pos:line="396" pos:column="27">TRUE<pos:position pos:line="396" pos:column="31"/></name></expr>;<pos:position pos:line="396" pos:column="32"/></expr_stmt> <comment type="block" pos:line="396" pos:column="33">/* out of memory bad */</comment>
            }<pos:position pos:line="397" pos:column="14"/></block></then></if>
          }<pos:position pos:line="398" pos:column="12"/></block></else></if>
          <break pos:line="399" pos:column="11">break;<pos:position pos:line="399" pos:column="17"/></break>
        }<pos:position pos:line="400" pos:column="10"/></block></then></if>
        <comment type="block" pos:line="401" pos:column="9">/* this doesn't look like a path, make one up! */</comment>
        <expr_stmt><expr><name><name pos:line="402" pos:column="9">co<pos:position pos:line="402" pos:column="11"/></name><operator pos:line="402" pos:column="11">-&gt;<pos:position pos:line="402" pos:column="16"/></operator><name pos:line="402" pos:column="13">path<pos:position pos:line="402" pos:column="17"/></name></name> <operator pos:line="402" pos:column="18">=<pos:position pos:line="402" pos:column="19"/></operator> <call><name pos:line="402" pos:column="20">strdup<pos:position pos:line="402" pos:column="26"/></name><argument_list pos:line="402" pos:column="26">(<argument><expr><literal type="string" pos:line="402" pos:column="27">"/"<pos:position pos:line="402" pos:column="30"/></literal></expr></argument>)<pos:position pos:line="402" pos:column="31"/></argument_list></call></expr>;<pos:position pos:line="402" pos:column="32"/></expr_stmt>
        <if pos:line="403" pos:column="9">if<condition pos:line="403" pos:column="11">(<expr><operator pos:line="403" pos:column="12">!<pos:position pos:line="403" pos:column="13"/></operator><name><name pos:line="403" pos:column="13">co<pos:position pos:line="403" pos:column="15"/></name><operator pos:line="403" pos:column="15">-&gt;<pos:position pos:line="403" pos:column="20"/></operator><name pos:line="403" pos:column="17">path<pos:position pos:line="403" pos:column="21"/></name></name></expr>)<pos:position pos:line="403" pos:column="22"/></condition><then pos:line="403" pos:column="22">
          <block type="pseudo"><expr_stmt><expr><name pos:line="404" pos:column="11">badcookie<pos:position pos:line="404" pos:column="20"/></name> <operator pos:line="404" pos:column="21">=<pos:position pos:line="404" pos:column="22"/></operator> <name pos:line="404" pos:column="23">TRUE<pos:position pos:line="404" pos:column="27"/></name></expr>;<pos:position pos:line="404" pos:column="28"/></expr_stmt></block></then></if>
        <expr_stmt><expr><name><name pos:line="405" pos:column="9">co<pos:position pos:line="405" pos:column="11"/></name><operator pos:line="405" pos:column="11">-&gt;<pos:position pos:line="405" pos:column="16"/></operator><name pos:line="405" pos:column="13">spath<pos:position pos:line="405" pos:column="18"/></name></name> <operator pos:line="405" pos:column="19">=<pos:position pos:line="405" pos:column="20"/></operator> <call><name pos:line="405" pos:column="21">strdup<pos:position pos:line="405" pos:column="27"/></name><argument_list pos:line="405" pos:column="27">(<argument><expr><literal type="string" pos:line="405" pos:column="28">"/"<pos:position pos:line="405" pos:column="31"/></literal></expr></argument>)<pos:position pos:line="405" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="405" pos:column="33"/></expr_stmt>
        <if pos:line="406" pos:column="9">if<condition pos:line="406" pos:column="11">(<expr><operator pos:line="406" pos:column="12">!<pos:position pos:line="406" pos:column="13"/></operator><name><name pos:line="406" pos:column="13">co<pos:position pos:line="406" pos:column="15"/></name><operator pos:line="406" pos:column="15">-&gt;<pos:position pos:line="406" pos:column="20"/></operator><name pos:line="406" pos:column="17">spath<pos:position pos:line="406" pos:column="22"/></name></name></expr>)<pos:position pos:line="406" pos:column="23"/></condition><then pos:line="406" pos:column="23">
          <block type="pseudo"><expr_stmt><expr><name pos:line="407" pos:column="11">badcookie<pos:position pos:line="407" pos:column="20"/></name> <operator pos:line="407" pos:column="21">=<pos:position pos:line="407" pos:column="22"/></operator> <name pos:line="407" pos:column="23">TRUE<pos:position pos:line="407" pos:column="27"/></name></expr>;<pos:position pos:line="407" pos:column="28"/></expr_stmt></block></then></if>
        <expr_stmt><expr><name pos:line="408" pos:column="9">fields<pos:position pos:line="408" pos:column="15"/></name><operator pos:line="408" pos:column="15">++<pos:position pos:line="408" pos:column="17"/></operator></expr>;<pos:position pos:line="408" pos:column="18"/></expr_stmt> <comment type="block" pos:line="408" pos:column="19">/* add a field and fall down to secure */</comment>
        <comment type="block" pos:line="409" pos:column="9">/* FALLTHROUGH */</comment>
      <case pos:line="410" pos:column="7">case <expr><literal type="number" pos:line="410" pos:column="12">3<pos:position pos:line="410" pos:column="13"/></literal></expr>:<pos:position pos:line="410" pos:column="14"/></case>
        <expr_stmt><expr><name><name pos:line="411" pos:column="9">co<pos:position pos:line="411" pos:column="11"/></name><operator pos:line="411" pos:column="11">-&gt;<pos:position pos:line="411" pos:column="16"/></operator><name pos:line="411" pos:column="13">secure<pos:position pos:line="411" pos:column="19"/></name></name> <operator pos:line="411" pos:column="20">=<pos:position pos:line="411" pos:column="21"/></operator> <ternary><condition><expr><call><name pos:line="411" pos:column="22">strcasecompare<pos:position pos:line="411" pos:column="36"/></name><argument_list pos:line="411" pos:column="36">(<argument><expr><name pos:line="411" pos:column="37">ptr<pos:position pos:line="411" pos:column="40"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="411" pos:column="42">"TRUE"<pos:position pos:line="411" pos:column="48"/></literal></expr></argument>)<pos:position pos:line="411" pos:column="49"/></argument_list></call></expr>?<pos:position pos:line="411" pos:column="50"/></condition><then><expr><name pos:line="411" pos:column="50">TRUE<pos:position pos:line="411" pos:column="54"/></name></expr></then><else pos:line="411" pos:column="54">:<expr><name pos:line="411" pos:column="55">FALSE<pos:position pos:line="411" pos:column="60"/></name></expr></else></ternary></expr>;<pos:position pos:line="411" pos:column="61"/></expr_stmt>
        <break pos:line="412" pos:column="9">break;<pos:position pos:line="412" pos:column="15"/></break>
      <case pos:line="413" pos:column="7">case <expr><literal type="number" pos:line="413" pos:column="12">4<pos:position pos:line="413" pos:column="13"/></literal></expr>:<pos:position pos:line="413" pos:column="14"/></case>
        <if pos:line="414" pos:column="9">if<condition pos:line="414" pos:column="11">(<expr><call><name pos:line="414" pos:column="12">curlx_strtoofft<pos:position pos:line="414" pos:column="27"/></name><argument_list pos:line="414" pos:column="27">(<argument><expr><name pos:line="414" pos:column="28">ptr<pos:position pos:line="414" pos:column="31"/></name></expr></argument>, <argument><expr><name pos:line="414" pos:column="33">NULL<pos:position pos:line="414" pos:column="37"/></name></expr></argument>, <argument><expr><literal type="number" pos:line="414" pos:column="39">10<pos:position pos:line="414" pos:column="41"/></literal></expr></argument>, <argument><expr><operator pos:line="414" pos:column="43">&amp;<pos:position pos:line="414" pos:column="48"/></operator><name><name pos:line="414" pos:column="44">co<pos:position pos:line="414" pos:column="46"/></name><operator pos:line="414" pos:column="46">-&gt;<pos:position pos:line="414" pos:column="51"/></operator><name pos:line="414" pos:column="48">expires<pos:position pos:line="414" pos:column="55"/></name></name></expr></argument>)<pos:position pos:line="414" pos:column="56"/></argument_list></call></expr>)<pos:position pos:line="414" pos:column="57"/></condition><then pos:line="414" pos:column="57">
          <block type="pseudo"><expr_stmt><expr><name pos:line="415" pos:column="11">badcookie<pos:position pos:line="415" pos:column="20"/></name> <operator pos:line="415" pos:column="21">=<pos:position pos:line="415" pos:column="22"/></operator> <name pos:line="415" pos:column="23">TRUE<pos:position pos:line="415" pos:column="27"/></name></expr>;<pos:position pos:line="415" pos:column="28"/></expr_stmt></block></then></if>
        <break pos:line="416" pos:column="9">break;<pos:position pos:line="416" pos:column="15"/></break>
      <case pos:line="417" pos:column="7">case <expr><literal type="number" pos:line="417" pos:column="12">5<pos:position pos:line="417" pos:column="13"/></literal></expr>:<pos:position pos:line="417" pos:column="14"/></case>
        <expr_stmt><expr><name><name pos:line="418" pos:column="9">co<pos:position pos:line="418" pos:column="11"/></name><operator pos:line="418" pos:column="11">-&gt;<pos:position pos:line="418" pos:column="16"/></operator><name pos:line="418" pos:column="13">name<pos:position pos:line="418" pos:column="17"/></name></name> <operator pos:line="418" pos:column="18">=<pos:position pos:line="418" pos:column="19"/></operator> <call><name pos:line="418" pos:column="20">strdup<pos:position pos:line="418" pos:column="26"/></name><argument_list pos:line="418" pos:column="26">(<argument><expr><name pos:line="418" pos:column="27">ptr<pos:position pos:line="418" pos:column="30"/></name></expr></argument>)<pos:position pos:line="418" pos:column="31"/></argument_list></call></expr>;<pos:position pos:line="418" pos:column="32"/></expr_stmt>
        <if pos:line="419" pos:column="9">if<condition pos:line="419" pos:column="11">(<expr><operator pos:line="419" pos:column="12">!<pos:position pos:line="419" pos:column="13"/></operator><name><name pos:line="419" pos:column="13">co<pos:position pos:line="419" pos:column="15"/></name><operator pos:line="419" pos:column="15">-&gt;<pos:position pos:line="419" pos:column="20"/></operator><name pos:line="419" pos:column="17">name<pos:position pos:line="419" pos:column="21"/></name></name></expr>)<pos:position pos:line="419" pos:column="22"/></condition><then pos:line="419" pos:column="22">
          <block type="pseudo"><expr_stmt><expr><name pos:line="420" pos:column="11">badcookie<pos:position pos:line="420" pos:column="20"/></name> <operator pos:line="420" pos:column="21">=<pos:position pos:line="420" pos:column="22"/></operator> <name pos:line="420" pos:column="23">TRUE<pos:position pos:line="420" pos:column="27"/></name></expr>;<pos:position pos:line="420" pos:column="28"/></expr_stmt></block></then></if>
        <break pos:line="421" pos:column="9">break;<pos:position pos:line="421" pos:column="15"/></break>
      <case pos:line="422" pos:column="7">case <expr><literal type="number" pos:line="422" pos:column="12">6<pos:position pos:line="422" pos:column="13"/></literal></expr>:<pos:position pos:line="422" pos:column="14"/></case>
        <expr_stmt><expr><name><name pos:line="423" pos:column="9">co<pos:position pos:line="423" pos:column="11"/></name><operator pos:line="423" pos:column="11">-&gt;<pos:position pos:line="423" pos:column="16"/></operator><name pos:line="423" pos:column="13">value<pos:position pos:line="423" pos:column="18"/></name></name> <operator pos:line="423" pos:column="19">=<pos:position pos:line="423" pos:column="20"/></operator> <call><name pos:line="423" pos:column="21">strdup<pos:position pos:line="423" pos:column="27"/></name><argument_list pos:line="423" pos:column="27">(<argument><expr><name pos:line="423" pos:column="28">ptr<pos:position pos:line="423" pos:column="31"/></name></expr></argument>)<pos:position pos:line="423" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="423" pos:column="33"/></expr_stmt>
        <if pos:line="424" pos:column="9">if<condition pos:line="424" pos:column="11">(<expr><operator pos:line="424" pos:column="12">!<pos:position pos:line="424" pos:column="13"/></operator><name><name pos:line="424" pos:column="13">co<pos:position pos:line="424" pos:column="15"/></name><operator pos:line="424" pos:column="15">-&gt;<pos:position pos:line="424" pos:column="20"/></operator><name pos:line="424" pos:column="17">value<pos:position pos:line="424" pos:column="22"/></name></name></expr>)<pos:position pos:line="424" pos:column="23"/></condition><then pos:line="424" pos:column="23">
          <block type="pseudo"><expr_stmt><expr><name pos:line="425" pos:column="11">badcookie<pos:position pos:line="425" pos:column="20"/></name> <operator pos:line="425" pos:column="21">=<pos:position pos:line="425" pos:column="22"/></operator> <name pos:line="425" pos:column="23">TRUE<pos:position pos:line="425" pos:column="27"/></name></expr>;<pos:position pos:line="425" pos:column="28"/></expr_stmt></block></then></if>
        <break pos:line="426" pos:column="9">break;<pos:position pos:line="426" pos:column="15"/></break>
      }<pos:position pos:line="427" pos:column="8"/></block></switch>
    }<pos:position pos:line="428" pos:column="6"/></block></for>
    <if pos:line="429" pos:column="5">if<condition pos:line="429" pos:column="7">(<expr><literal type="number" pos:line="429" pos:column="8">6<pos:position pos:line="429" pos:column="9"/></literal> <operator pos:line="429" pos:column="10">==<pos:position pos:line="429" pos:column="12"/></operator> <name pos:line="429" pos:column="13">fields<pos:position pos:line="429" pos:column="19"/></name></expr>)<pos:position pos:line="429" pos:column="20"/></condition><then pos:line="429" pos:column="20"> <block pos:line="429" pos:column="21">{
      <comment type="block" pos:line="430" pos:column="7">/* we got a cookie with blank contents, fix it */</comment>
      <expr_stmt><expr><name><name pos:line="431" pos:column="7">co<pos:position pos:line="431" pos:column="9"/></name><operator pos:line="431" pos:column="9">-&gt;<pos:position pos:line="431" pos:column="14"/></operator><name pos:line="431" pos:column="11">value<pos:position pos:line="431" pos:column="16"/></name></name> <operator pos:line="431" pos:column="17">=<pos:position pos:line="431" pos:column="18"/></operator> <call><name pos:line="431" pos:column="19">strdup<pos:position pos:line="431" pos:column="25"/></name><argument_list pos:line="431" pos:column="25">(<argument><expr><literal type="string" pos:line="431" pos:column="26">""<pos:position pos:line="431" pos:column="28"/></literal></expr></argument>)<pos:position pos:line="431" pos:column="29"/></argument_list></call></expr>;<pos:position pos:line="431" pos:column="30"/></expr_stmt>
      <if pos:line="432" pos:column="7">if<condition pos:line="432" pos:column="9">(<expr><operator pos:line="432" pos:column="10">!<pos:position pos:line="432" pos:column="11"/></operator><name><name pos:line="432" pos:column="11">co<pos:position pos:line="432" pos:column="13"/></name><operator pos:line="432" pos:column="13">-&gt;<pos:position pos:line="432" pos:column="18"/></operator><name pos:line="432" pos:column="15">value<pos:position pos:line="432" pos:column="20"/></name></name></expr>)<pos:position pos:line="432" pos:column="21"/></condition><then pos:line="432" pos:column="21">
        <block type="pseudo"><expr_stmt><expr><name pos:line="433" pos:column="9">badcookie<pos:position pos:line="433" pos:column="18"/></name> <operator pos:line="433" pos:column="19">=<pos:position pos:line="433" pos:column="20"/></operator> <name pos:line="433" pos:column="21">TRUE<pos:position pos:line="433" pos:column="25"/></name></expr>;<pos:position pos:line="433" pos:column="26"/></expr_stmt></block></then>
      <else pos:line="434" pos:column="7">else
        <block type="pseudo"><expr_stmt><expr><name pos:line="435" pos:column="9">fields<pos:position pos:line="435" pos:column="15"/></name><operator pos:line="435" pos:column="15">++<pos:position pos:line="435" pos:column="17"/></operator></expr>;<pos:position pos:line="435" pos:column="18"/></expr_stmt></block></else></if>
    }<pos:position pos:line="436" pos:column="6"/></block></then></if>

    <if pos:line="438" pos:column="5">if<condition pos:line="438" pos:column="7">(<expr><operator pos:line="438" pos:column="8">!<pos:position pos:line="438" pos:column="9"/></operator><name pos:line="438" pos:column="9">badcookie<pos:position pos:line="438" pos:column="18"/></name> <operator pos:line="438" pos:column="19">&amp;&amp;<pos:position pos:line="438" pos:column="29"/></operator> <operator pos:line="438" pos:column="22">(<pos:position pos:line="438" pos:column="23"/></operator><literal type="number" pos:line="438" pos:column="23">7<pos:position pos:line="438" pos:column="24"/></literal> <operator pos:line="438" pos:column="25">!=<pos:position pos:line="438" pos:column="27"/></operator> <name pos:line="438" pos:column="28">fields<pos:position pos:line="438" pos:column="34"/></name><operator pos:line="438" pos:column="34">)<pos:position pos:line="438" pos:column="35"/></operator></expr>)<pos:position pos:line="438" pos:column="36"/></condition><then pos:line="438" pos:column="36">
      <comment type="block" pos:line="439" pos:column="7">/* we did not find the sufficient number of fields */</comment>
      <block type="pseudo"><expr_stmt><expr><name pos:line="440" pos:column="7">badcookie<pos:position pos:line="440" pos:column="16"/></name> <operator pos:line="440" pos:column="17">=<pos:position pos:line="440" pos:column="18"/></operator> <name pos:line="440" pos:column="19">TRUE<pos:position pos:line="440" pos:column="23"/></name></expr>;<pos:position pos:line="440" pos:column="24"/></expr_stmt></block></then></if>

    <if pos:line="442" pos:column="5">if<condition pos:line="442" pos:column="7">(<expr><name pos:line="442" pos:column="8">badcookie<pos:position pos:line="442" pos:column="17"/></name></expr>)<pos:position pos:line="442" pos:column="18"/></condition><then pos:line="442" pos:column="18"> <block pos:line="442" pos:column="19">{
      <expr_stmt><expr><call><name pos:line="443" pos:column="7">freecookie<pos:position pos:line="443" pos:column="17"/></name><argument_list pos:line="443" pos:column="17">(<argument><expr><name pos:line="443" pos:column="18">co<pos:position pos:line="443" pos:column="20"/></name></expr></argument>)<pos:position pos:line="443" pos:column="21"/></argument_list></call></expr>;<pos:position pos:line="443" pos:column="22"/></expr_stmt>
      <return pos:line="444" pos:column="7">return <expr><name pos:line="444" pos:column="14">NULL<pos:position pos:line="444" pos:column="18"/></name></expr>;<pos:position pos:line="444" pos:column="19"/></return>
    }<pos:position pos:line="445" pos:column="6"/></block></then></if>

  }<pos:position pos:line="447" pos:column="4"/></block></else></if>

  <if pos:line="449" pos:column="3">if<condition pos:line="449" pos:column="5">(<expr><operator pos:line="449" pos:column="6">!<pos:position pos:line="449" pos:column="7"/></operator><name><name pos:line="449" pos:column="7">c<pos:position pos:line="449" pos:column="8"/></name><operator pos:line="449" pos:column="8">-&gt;<pos:position pos:line="449" pos:column="13"/></operator><name pos:line="449" pos:column="10">running<pos:position pos:line="449" pos:column="17"/></name></name> <operator pos:line="449" pos:column="18">&amp;&amp;<pos:position pos:line="449" pos:column="28"/></operator>    <comment type="block" pos:line="449" pos:column="24">/* read from a file */</comment>
     <name><name pos:line="450" pos:column="6">c<pos:position pos:line="450" pos:column="7"/></name><operator pos:line="450" pos:column="7">-&gt;<pos:position pos:line="450" pos:column="12"/></operator><name pos:line="450" pos:column="9">newsession<pos:position pos:line="450" pos:column="19"/></name></name> <operator pos:line="450" pos:column="20">&amp;&amp;<pos:position pos:line="450" pos:column="30"/></operator>  <comment type="block" pos:line="450" pos:column="24">/* clean session cookies */</comment>
     <operator pos:line="451" pos:column="6">!<pos:position pos:line="451" pos:column="7"/></operator><name><name pos:line="451" pos:column="7">co<pos:position pos:line="451" pos:column="9"/></name><operator pos:line="451" pos:column="9">-&gt;<pos:position pos:line="451" pos:column="14"/></operator><name pos:line="451" pos:column="11">expires<pos:position pos:line="451" pos:column="18"/></name></name></expr>)<pos:position pos:line="451" pos:column="19"/></condition><then pos:line="451" pos:column="19"> <block pos:line="451" pos:column="20">{   <comment type="block" pos:line="451" pos:column="24">/* this is a session cookie since it doesn't expire! */</comment>
    <expr_stmt><expr><call><name pos:line="452" pos:column="5">freecookie<pos:position pos:line="452" pos:column="15"/></name><argument_list pos:line="452" pos:column="15">(<argument><expr><name pos:line="452" pos:column="16">co<pos:position pos:line="452" pos:column="18"/></name></expr></argument>)<pos:position pos:line="452" pos:column="19"/></argument_list></call></expr>;<pos:position pos:line="452" pos:column="20"/></expr_stmt>
    <return pos:line="453" pos:column="5">return <expr><name pos:line="453" pos:column="12">NULL<pos:position pos:line="453" pos:column="16"/></name></expr>;<pos:position pos:line="453" pos:column="17"/></return>
  }<pos:position pos:line="454" pos:column="4"/></block></then></if>

  <expr_stmt><expr><name><name pos:line="456" pos:column="3">co<pos:position pos:line="456" pos:column="5"/></name><operator pos:line="456" pos:column="5">-&gt;<pos:position pos:line="456" pos:column="10"/></operator><name pos:line="456" pos:column="7">livecookie<pos:position pos:line="456" pos:column="17"/></name></name> <operator pos:line="456" pos:column="18">=<pos:position pos:line="456" pos:column="19"/></operator> <name><name pos:line="456" pos:column="20">c<pos:position pos:line="456" pos:column="21"/></name><operator pos:line="456" pos:column="21">-&gt;<pos:position pos:line="456" pos:column="26"/></operator><name pos:line="456" pos:column="23">running<pos:position pos:line="456" pos:column="30"/></name></name></expr>;<pos:position pos:line="456" pos:column="31"/></expr_stmt>

  <comment type="block" pos:line="458" pos:column="3">/* now, we have parsed the incoming line, we must now check if this
     superceeds an already existing cookie, which it may if the previous have
     the same domain and path as this */</comment>

  <comment type="block" pos:line="462" pos:column="3">/* at first, remove expired cookies */</comment>
  <expr_stmt><expr><call><name pos:line="463" pos:column="3">remove_expired<pos:position pos:line="463" pos:column="17"/></name><argument_list pos:line="463" pos:column="17">(<argument><expr><name pos:line="463" pos:column="18">c<pos:position pos:line="463" pos:column="19"/></name></expr></argument>)<pos:position pos:line="463" pos:column="20"/></argument_list></call></expr>;<pos:position pos:line="463" pos:column="21"/></expr_stmt>

<cpp:ifdef pos:line="465" pos:column="1">#<cpp:directive pos:line="465" pos:column="2">ifdef<pos:position pos:line="465" pos:column="7"/></cpp:directive> <name pos:line="465" pos:column="8">USE_LIBPSL<pos:position pos:line="465" pos:column="18"/></name></cpp:ifdef>
  <comment type="block" pos:line="466" pos:column="3">/* Check if the domain is a Public Suffix and if yes, ignore the cookie.
     This needs a libpsl compiled with builtin data. */</comment>
  <if pos:line="468" pos:column="3">if<condition pos:line="468" pos:column="5">(<expr><name pos:line="468" pos:column="6">domain<pos:position pos:line="468" pos:column="12"/></name> <operator pos:line="468" pos:column="13">&amp;&amp;<pos:position pos:line="468" pos:column="23"/></operator> <name><name pos:line="468" pos:column="16">co<pos:position pos:line="468" pos:column="18"/></name><operator pos:line="468" pos:column="18">-&gt;<pos:position pos:line="468" pos:column="23"/></operator><name pos:line="468" pos:column="20">domain<pos:position pos:line="468" pos:column="26"/></name></name> <operator pos:line="468" pos:column="27">&amp;&amp;<pos:position pos:line="468" pos:column="37"/></operator> <operator pos:line="468" pos:column="30">!<pos:position pos:line="468" pos:column="31"/></operator><call><name pos:line="468" pos:column="31">isip<pos:position pos:line="468" pos:column="35"/></name><argument_list pos:line="468" pos:column="35">(<argument><expr><name><name pos:line="468" pos:column="36">co<pos:position pos:line="468" pos:column="38"/></name><operator pos:line="468" pos:column="38">-&gt;<pos:position pos:line="468" pos:column="43"/></operator><name pos:line="468" pos:column="40">domain<pos:position pos:line="468" pos:column="46"/></name></name></expr></argument>)<pos:position pos:line="468" pos:column="47"/></argument_list></call></expr>)<pos:position pos:line="468" pos:column="48"/></condition><then pos:line="468" pos:column="48"> <block pos:line="468" pos:column="49">{
    <expr_stmt><expr><name pos:line="469" pos:column="5">psl<pos:position pos:line="469" pos:column="8"/></name> <operator pos:line="469" pos:column="9">=<pos:position pos:line="469" pos:column="10"/></operator> <call><name pos:line="469" pos:column="11">psl_builtin<pos:position pos:line="469" pos:column="22"/></name><argument_list pos:line="469" pos:column="22">()<pos:position pos:line="469" pos:column="24"/></argument_list></call></expr>;<pos:position pos:line="469" pos:column="25"/></expr_stmt>
    <if pos:line="470" pos:column="5">if<condition pos:line="470" pos:column="7">(<expr><name pos:line="470" pos:column="8">psl<pos:position pos:line="470" pos:column="11"/></name> <operator pos:line="470" pos:column="12">&amp;&amp;<pos:position pos:line="470" pos:column="22"/></operator> <operator pos:line="470" pos:column="15">!<pos:position pos:line="470" pos:column="16"/></operator><call><name pos:line="470" pos:column="16">psl_is_cookie_domain_acceptable<pos:position pos:line="470" pos:column="47"/></name><argument_list pos:line="470" pos:column="47">(<argument><expr><name pos:line="470" pos:column="48">psl<pos:position pos:line="470" pos:column="51"/></name></expr></argument>, <argument><expr><name pos:line="470" pos:column="53">domain<pos:position pos:line="470" pos:column="59"/></name></expr></argument>, <argument><expr><name><name pos:line="470" pos:column="61">co<pos:position pos:line="470" pos:column="63"/></name><operator pos:line="470" pos:column="63">-&gt;<pos:position pos:line="470" pos:column="68"/></operator><name pos:line="470" pos:column="65">domain<pos:position pos:line="470" pos:column="71"/></name></name></expr></argument>)<pos:position pos:line="470" pos:column="72"/></argument_list></call></expr>)<pos:position pos:line="470" pos:column="73"/></condition><then pos:line="470" pos:column="73"> <block pos:line="470" pos:column="74">{
      <expr_stmt><expr><call><name pos:line="471" pos:column="7">infof<pos:position pos:line="471" pos:column="12"/></name><argument_list pos:line="471" pos:column="12">(<argument><expr><name pos:line="471" pos:column="13">data<pos:position pos:line="471" pos:column="17"/></name></expr></argument>,
            <argument><expr><literal type="string" pos:line="472" pos:column="13">"cookie '%s' dropped, domain '%s' must not set cookies for '%s'\n"<pos:position pos:line="472" pos:column="79"/></literal></expr></argument>,
            <argument><expr><name><name pos:line="473" pos:column="13">co<pos:position pos:line="473" pos:column="15"/></name><operator pos:line="473" pos:column="15">-&gt;<pos:position pos:line="473" pos:column="20"/></operator><name pos:line="473" pos:column="17">name<pos:position pos:line="473" pos:column="21"/></name></name></expr></argument>, <argument><expr><name pos:line="473" pos:column="23">domain<pos:position pos:line="473" pos:column="29"/></name></expr></argument>, <argument><expr><name><name pos:line="473" pos:column="31">co<pos:position pos:line="473" pos:column="33"/></name><operator pos:line="473" pos:column="33">-&gt;<pos:position pos:line="473" pos:column="38"/></operator><name pos:line="473" pos:column="35">domain<pos:position pos:line="473" pos:column="41"/></name></name></expr></argument>)<pos:position pos:line="473" pos:column="42"/></argument_list></call></expr>;<pos:position pos:line="473" pos:column="43"/></expr_stmt>
      <expr_stmt><expr><call><name pos:line="474" pos:column="7">freecookie<pos:position pos:line="474" pos:column="17"/></name><argument_list pos:line="474" pos:column="17">(<argument><expr><name pos:line="474" pos:column="18">co<pos:position pos:line="474" pos:column="20"/></name></expr></argument>)<pos:position pos:line="474" pos:column="21"/></argument_list></call></expr>;<pos:position pos:line="474" pos:column="22"/></expr_stmt>
      <return pos:line="475" pos:column="7">return <expr><name pos:line="475" pos:column="14">NULL<pos:position pos:line="475" pos:column="18"/></name></expr>;<pos:position pos:line="475" pos:column="19"/></return>
    }<pos:position pos:line="476" pos:column="6"/></block></then></if>
  }<pos:position pos:line="477" pos:column="4"/></block></then></if>
<cpp:endif pos:line="478" pos:column="1">#<cpp:directive pos:line="478" pos:column="2">endif<pos:position pos:line="478" pos:column="7"/></cpp:directive></cpp:endif>

  <expr_stmt><expr><name pos:line="480" pos:column="3">clist<pos:position pos:line="480" pos:column="8"/></name> <operator pos:line="480" pos:column="9">=<pos:position pos:line="480" pos:column="10"/></operator> <name><name pos:line="480" pos:column="11">c<pos:position pos:line="480" pos:column="12"/></name><operator pos:line="480" pos:column="12">-&gt;<pos:position pos:line="480" pos:column="17"/></operator><name pos:line="480" pos:column="14">cookies<pos:position pos:line="480" pos:column="21"/></name></name></expr>;<pos:position pos:line="480" pos:column="22"/></expr_stmt>
  <expr_stmt><expr><name pos:line="481" pos:column="3">replace_old<pos:position pos:line="481" pos:column="14"/></name> <operator pos:line="481" pos:column="15">=<pos:position pos:line="481" pos:column="16"/></operator> <name pos:line="481" pos:column="17">FALSE<pos:position pos:line="481" pos:column="22"/></name></expr>;<pos:position pos:line="481" pos:column="23"/></expr_stmt>
  <while pos:line="482" pos:column="3">while<condition pos:line="482" pos:column="8">(<expr><name pos:line="482" pos:column="9">clist<pos:position pos:line="482" pos:column="14"/></name></expr>)<pos:position pos:line="482" pos:column="15"/></condition> <block pos:line="482" pos:column="16">{
    <if pos:line="483" pos:column="5">if<condition pos:line="483" pos:column="7">(<expr><call><name pos:line="483" pos:column="8">strcasecompare<pos:position pos:line="483" pos:column="22"/></name><argument_list pos:line="483" pos:column="22">(<argument><expr><name><name pos:line="483" pos:column="23">clist<pos:position pos:line="483" pos:column="28"/></name><operator pos:line="483" pos:column="28">-&gt;<pos:position pos:line="483" pos:column="33"/></operator><name pos:line="483" pos:column="30">name<pos:position pos:line="483" pos:column="34"/></name></name></expr></argument>, <argument><expr><name><name pos:line="483" pos:column="36">co<pos:position pos:line="483" pos:column="38"/></name><operator pos:line="483" pos:column="38">-&gt;<pos:position pos:line="483" pos:column="43"/></operator><name pos:line="483" pos:column="40">name<pos:position pos:line="483" pos:column="44"/></name></name></expr></argument>)<pos:position pos:line="483" pos:column="45"/></argument_list></call></expr>)<pos:position pos:line="483" pos:column="46"/></condition><then pos:line="483" pos:column="46"> <block pos:line="483" pos:column="47">{
      <comment type="block" pos:line="484" pos:column="7">/* the names are identical */</comment>

      <if pos:line="486" pos:column="7">if<condition pos:line="486" pos:column="9">(<expr><name><name pos:line="486" pos:column="10">clist<pos:position pos:line="486" pos:column="15"/></name><operator pos:line="486" pos:column="15">-&gt;<pos:position pos:line="486" pos:column="20"/></operator><name pos:line="486" pos:column="17">domain<pos:position pos:line="486" pos:column="23"/></name></name> <operator pos:line="486" pos:column="24">&amp;&amp;<pos:position pos:line="486" pos:column="34"/></operator> <name><name pos:line="486" pos:column="27">co<pos:position pos:line="486" pos:column="29"/></name><operator pos:line="486" pos:column="29">-&gt;<pos:position pos:line="486" pos:column="34"/></operator><name pos:line="486" pos:column="31">domain<pos:position pos:line="486" pos:column="37"/></name></name></expr>)<pos:position pos:line="486" pos:column="38"/></condition><then pos:line="486" pos:column="38"> <block pos:line="486" pos:column="39">{
        <if pos:line="487" pos:column="9">if<condition pos:line="487" pos:column="11">(<expr><call><name pos:line="487" pos:column="12">strcasecompare<pos:position pos:line="487" pos:column="26"/></name><argument_list pos:line="487" pos:column="26">(<argument><expr><name><name pos:line="487" pos:column="27">clist<pos:position pos:line="487" pos:column="32"/></name><operator pos:line="487" pos:column="32">-&gt;<pos:position pos:line="487" pos:column="37"/></operator><name pos:line="487" pos:column="34">domain<pos:position pos:line="487" pos:column="40"/></name></name></expr></argument>, <argument><expr><name><name pos:line="487" pos:column="42">co<pos:position pos:line="487" pos:column="44"/></name><operator pos:line="487" pos:column="44">-&gt;<pos:position pos:line="487" pos:column="49"/></operator><name pos:line="487" pos:column="46">domain<pos:position pos:line="487" pos:column="52"/></name></name></expr></argument>)<pos:position pos:line="487" pos:column="53"/></argument_list></call> <operator pos:line="487" pos:column="54">&amp;&amp;<pos:position pos:line="487" pos:column="64"/></operator>
          <operator pos:line="488" pos:column="11">(<pos:position pos:line="488" pos:column="12"/></operator><name><name pos:line="488" pos:column="12">clist<pos:position pos:line="488" pos:column="17"/></name><operator pos:line="488" pos:column="17">-&gt;<pos:position pos:line="488" pos:column="22"/></operator><name pos:line="488" pos:column="19">tailmatch<pos:position pos:line="488" pos:column="28"/></name></name> <operator pos:line="488" pos:column="29">==<pos:position pos:line="488" pos:column="31"/></operator> <name><name pos:line="488" pos:column="32">co<pos:position pos:line="488" pos:column="34"/></name><operator pos:line="488" pos:column="34">-&gt;<pos:position pos:line="488" pos:column="39"/></operator><name pos:line="488" pos:column="36">tailmatch<pos:position pos:line="488" pos:column="45"/></name></name><operator pos:line="488" pos:column="45">)<pos:position pos:line="488" pos:column="46"/></operator></expr>)<pos:position pos:line="488" pos:column="47"/></condition><then pos:line="488" pos:column="47">
          <comment type="block" pos:line="489" pos:column="11">/* The domains are identical */</comment>
          <block type="pseudo"><expr_stmt><expr><name pos:line="490" pos:column="11">replace_old<pos:position pos:line="490" pos:column="22"/></name> <operator pos:line="490" pos:column="23">=<pos:position pos:line="490" pos:column="24"/></operator> <name pos:line="490" pos:column="25">TRUE<pos:position pos:line="490" pos:column="29"/></name></expr>;<pos:position pos:line="490" pos:column="30"/></expr_stmt></block></then></if>
      }<pos:position pos:line="491" pos:column="8"/></block></then>
      <elseif pos:line="492" pos:column="7">else <if pos:line="492" pos:column="12">if<condition pos:line="492" pos:column="14">(<expr><operator pos:line="492" pos:column="15">!<pos:position pos:line="492" pos:column="16"/></operator><name><name pos:line="492" pos:column="16">clist<pos:position pos:line="492" pos:column="21"/></name><operator pos:line="492" pos:column="21">-&gt;<pos:position pos:line="492" pos:column="26"/></operator><name pos:line="492" pos:column="23">domain<pos:position pos:line="492" pos:column="29"/></name></name> <operator pos:line="492" pos:column="30">&amp;&amp;<pos:position pos:line="492" pos:column="40"/></operator> <operator pos:line="492" pos:column="33">!<pos:position pos:line="492" pos:column="34"/></operator><name><name pos:line="492" pos:column="34">co<pos:position pos:line="492" pos:column="36"/></name><operator pos:line="492" pos:column="36">-&gt;<pos:position pos:line="492" pos:column="41"/></operator><name pos:line="492" pos:column="38">domain<pos:position pos:line="492" pos:column="44"/></name></name></expr>)<pos:position pos:line="492" pos:column="45"/></condition><then pos:line="492" pos:column="45">
        <block type="pseudo"><expr_stmt><expr><name pos:line="493" pos:column="9">replace_old<pos:position pos:line="493" pos:column="20"/></name> <operator pos:line="493" pos:column="21">=<pos:position pos:line="493" pos:column="22"/></operator> <name pos:line="493" pos:column="23">TRUE<pos:position pos:line="493" pos:column="27"/></name></expr>;<pos:position pos:line="493" pos:column="28"/></expr_stmt></block></then></if></elseif></if>

      <if pos:line="495" pos:column="7">if<condition pos:line="495" pos:column="9">(<expr><name pos:line="495" pos:column="10">replace_old<pos:position pos:line="495" pos:column="21"/></name></expr>)<pos:position pos:line="495" pos:column="22"/></condition><then pos:line="495" pos:column="22"> <block pos:line="495" pos:column="23">{
        <comment type="block" pos:line="496" pos:column="9">/* the domains were identical */</comment>

        <if pos:line="498" pos:column="9">if<condition pos:line="498" pos:column="11">(<expr><name><name pos:line="498" pos:column="12">clist<pos:position pos:line="498" pos:column="17"/></name><operator pos:line="498" pos:column="17">-&gt;<pos:position pos:line="498" pos:column="22"/></operator><name pos:line="498" pos:column="19">spath<pos:position pos:line="498" pos:column="24"/></name></name> <operator pos:line="498" pos:column="25">&amp;&amp;<pos:position pos:line="498" pos:column="35"/></operator> <name><name pos:line="498" pos:column="28">co<pos:position pos:line="498" pos:column="30"/></name><operator pos:line="498" pos:column="30">-&gt;<pos:position pos:line="498" pos:column="35"/></operator><name pos:line="498" pos:column="32">spath<pos:position pos:line="498" pos:column="37"/></name></name></expr>)<pos:position pos:line="498" pos:column="38"/></condition><then pos:line="498" pos:column="38"> <block pos:line="498" pos:column="39">{
          <if pos:line="499" pos:column="11">if<condition pos:line="499" pos:column="13">(<expr><call><name pos:line="499" pos:column="14">strcasecompare<pos:position pos:line="499" pos:column="28"/></name><argument_list pos:line="499" pos:column="28">(<argument><expr><name><name pos:line="499" pos:column="29">clist<pos:position pos:line="499" pos:column="34"/></name><operator pos:line="499" pos:column="34">-&gt;<pos:position pos:line="499" pos:column="39"/></operator><name pos:line="499" pos:column="36">spath<pos:position pos:line="499" pos:column="41"/></name></name></expr></argument>, <argument><expr><name><name pos:line="499" pos:column="43">co<pos:position pos:line="499" pos:column="45"/></name><operator pos:line="499" pos:column="45">-&gt;<pos:position pos:line="499" pos:column="50"/></operator><name pos:line="499" pos:column="47">spath<pos:position pos:line="499" pos:column="52"/></name></name></expr></argument>)<pos:position pos:line="499" pos:column="53"/></argument_list></call></expr>)<pos:position pos:line="499" pos:column="54"/></condition><then pos:line="499" pos:column="54"> <block pos:line="499" pos:column="55">{
            <expr_stmt><expr><name pos:line="500" pos:column="13">replace_old<pos:position pos:line="500" pos:column="24"/></name> <operator pos:line="500" pos:column="25">=<pos:position pos:line="500" pos:column="26"/></operator> <name pos:line="500" pos:column="27">TRUE<pos:position pos:line="500" pos:column="31"/></name></expr>;<pos:position pos:line="500" pos:column="32"/></expr_stmt>
          }<pos:position pos:line="501" pos:column="12"/></block></then>
          <else pos:line="502" pos:column="11">else
            <block type="pseudo"><expr_stmt><expr><name pos:line="503" pos:column="13">replace_old<pos:position pos:line="503" pos:column="24"/></name> <operator pos:line="503" pos:column="25">=<pos:position pos:line="503" pos:column="26"/></operator> <name pos:line="503" pos:column="27">FALSE<pos:position pos:line="503" pos:column="32"/></name></expr>;<pos:position pos:line="503" pos:column="33"/></expr_stmt></block></else></if>
        }<pos:position pos:line="504" pos:column="10"/></block></then>
        <elseif pos:line="505" pos:column="9">else <if pos:line="505" pos:column="14">if<condition pos:line="505" pos:column="16">(<expr><operator pos:line="505" pos:column="17">!<pos:position pos:line="505" pos:column="18"/></operator><name><name pos:line="505" pos:column="18">clist<pos:position pos:line="505" pos:column="23"/></name><operator pos:line="505" pos:column="23">-&gt;<pos:position pos:line="505" pos:column="28"/></operator><name pos:line="505" pos:column="25">spath<pos:position pos:line="505" pos:column="30"/></name></name> <operator pos:line="505" pos:column="31">&amp;&amp;<pos:position pos:line="505" pos:column="41"/></operator> <operator pos:line="505" pos:column="34">!<pos:position pos:line="505" pos:column="35"/></operator><name><name pos:line="505" pos:column="35">co<pos:position pos:line="505" pos:column="37"/></name><operator pos:line="505" pos:column="37">-&gt;<pos:position pos:line="505" pos:column="42"/></operator><name pos:line="505" pos:column="39">spath<pos:position pos:line="505" pos:column="44"/></name></name></expr>)<pos:position pos:line="505" pos:column="45"/></condition><then pos:line="505" pos:column="45">
          <block type="pseudo"><expr_stmt><expr><name pos:line="506" pos:column="11">replace_old<pos:position pos:line="506" pos:column="22"/></name> <operator pos:line="506" pos:column="23">=<pos:position pos:line="506" pos:column="24"/></operator> <name pos:line="506" pos:column="25">TRUE<pos:position pos:line="506" pos:column="29"/></name></expr>;<pos:position pos:line="506" pos:column="30"/></expr_stmt></block></then></if></elseif>
        <else pos:line="507" pos:column="9">else
          <block type="pseudo"><expr_stmt><expr><name pos:line="508" pos:column="11">replace_old<pos:position pos:line="508" pos:column="22"/></name> <operator pos:line="508" pos:column="23">=<pos:position pos:line="508" pos:column="24"/></operator> <name pos:line="508" pos:column="25">FALSE<pos:position pos:line="508" pos:column="30"/></name></expr>;<pos:position pos:line="508" pos:column="31"/></expr_stmt></block></else></if>

      }<pos:position pos:line="510" pos:column="8"/></block></then></if>

      <if pos:line="512" pos:column="7">if<condition pos:line="512" pos:column="9">(<expr><name pos:line="512" pos:column="10">replace_old<pos:position pos:line="512" pos:column="21"/></name> <operator pos:line="512" pos:column="22">&amp;&amp;<pos:position pos:line="512" pos:column="32"/></operator> <operator pos:line="512" pos:column="25">!<pos:position pos:line="512" pos:column="26"/></operator><name><name pos:line="512" pos:column="26">co<pos:position pos:line="512" pos:column="28"/></name><operator pos:line="512" pos:column="28">-&gt;<pos:position pos:line="512" pos:column="33"/></operator><name pos:line="512" pos:column="30">livecookie<pos:position pos:line="512" pos:column="40"/></name></name> <operator pos:line="512" pos:column="41">&amp;&amp;<pos:position pos:line="512" pos:column="51"/></operator> <name><name pos:line="512" pos:column="44">clist<pos:position pos:line="512" pos:column="49"/></name><operator pos:line="512" pos:column="49">-&gt;<pos:position pos:line="512" pos:column="54"/></operator><name pos:line="512" pos:column="51">livecookie<pos:position pos:line="512" pos:column="61"/></name></name></expr>)<pos:position pos:line="512" pos:column="62"/></condition><then pos:line="512" pos:column="62"> <block pos:line="512" pos:column="63">{
        <comment type="block" pos:line="513" pos:column="9">/* Both cookies matched fine, except that the already present
           cookie is "live", which means it was set from a header, while
           the new one isn't "live" and thus only read from a file. We let
           live cookies stay alive */</comment>

        <comment type="block" pos:line="518" pos:column="9">/* Free the newcomer and get out of here! */</comment>
        <expr_stmt><expr><call><name pos:line="519" pos:column="9">freecookie<pos:position pos:line="519" pos:column="19"/></name><argument_list pos:line="519" pos:column="19">(<argument><expr><name pos:line="519" pos:column="20">co<pos:position pos:line="519" pos:column="22"/></name></expr></argument>)<pos:position pos:line="519" pos:column="23"/></argument_list></call></expr>;<pos:position pos:line="519" pos:column="24"/></expr_stmt>
        <return pos:line="520" pos:column="9">return <expr><name pos:line="520" pos:column="16">NULL<pos:position pos:line="520" pos:column="20"/></name></expr>;<pos:position pos:line="520" pos:column="21"/></return>
      }<pos:position pos:line="521" pos:column="8"/></block></then></if>

      <if pos:line="523" pos:column="7">if<condition pos:line="523" pos:column="9">(<expr><name pos:line="523" pos:column="10">replace_old<pos:position pos:line="523" pos:column="21"/></name></expr>)<pos:position pos:line="523" pos:column="22"/></condition><then pos:line="523" pos:column="22"> <block pos:line="523" pos:column="23">{
        <expr_stmt><expr><name><name pos:line="524" pos:column="9">co<pos:position pos:line="524" pos:column="11"/></name><operator pos:line="524" pos:column="11">-&gt;<pos:position pos:line="524" pos:column="16"/></operator><name pos:line="524" pos:column="13">next<pos:position pos:line="524" pos:column="17"/></name></name> <operator pos:line="524" pos:column="18">=<pos:position pos:line="524" pos:column="19"/></operator> <name><name pos:line="524" pos:column="20">clist<pos:position pos:line="524" pos:column="25"/></name><operator pos:line="524" pos:column="25">-&gt;<pos:position pos:line="524" pos:column="30"/></operator><name pos:line="524" pos:column="27">next<pos:position pos:line="524" pos:column="31"/></name></name></expr>;<pos:position pos:line="524" pos:column="32"/></expr_stmt> <comment type="block" pos:line="524" pos:column="33">/* get the next-pointer first */</comment>

        <comment type="block" pos:line="526" pos:column="9">/* then free all the old pointers */</comment>
        <expr_stmt><expr><call><name pos:line="527" pos:column="9">free<pos:position pos:line="527" pos:column="13"/></name><argument_list pos:line="527" pos:column="13">(<argument><expr><name><name pos:line="527" pos:column="14">clist<pos:position pos:line="527" pos:column="19"/></name><operator pos:line="527" pos:column="19">-&gt;<pos:position pos:line="527" pos:column="24"/></operator><name pos:line="527" pos:column="21">name<pos:position pos:line="527" pos:column="25"/></name></name></expr></argument>)<pos:position pos:line="527" pos:column="26"/></argument_list></call></expr>;<pos:position pos:line="527" pos:column="27"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="528" pos:column="9">free<pos:position pos:line="528" pos:column="13"/></name><argument_list pos:line="528" pos:column="13">(<argument><expr><name><name pos:line="528" pos:column="14">clist<pos:position pos:line="528" pos:column="19"/></name><operator pos:line="528" pos:column="19">-&gt;<pos:position pos:line="528" pos:column="24"/></operator><name pos:line="528" pos:column="21">value<pos:position pos:line="528" pos:column="26"/></name></name></expr></argument>)<pos:position pos:line="528" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="528" pos:column="28"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="529" pos:column="9">free<pos:position pos:line="529" pos:column="13"/></name><argument_list pos:line="529" pos:column="13">(<argument><expr><name><name pos:line="529" pos:column="14">clist<pos:position pos:line="529" pos:column="19"/></name><operator pos:line="529" pos:column="19">-&gt;<pos:position pos:line="529" pos:column="24"/></operator><name pos:line="529" pos:column="21">domain<pos:position pos:line="529" pos:column="27"/></name></name></expr></argument>)<pos:position pos:line="529" pos:column="28"/></argument_list></call></expr>;<pos:position pos:line="529" pos:column="29"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="530" pos:column="9">free<pos:position pos:line="530" pos:column="13"/></name><argument_list pos:line="530" pos:column="13">(<argument><expr><name><name pos:line="530" pos:column="14">clist<pos:position pos:line="530" pos:column="19"/></name><operator pos:line="530" pos:column="19">-&gt;<pos:position pos:line="530" pos:column="24"/></operator><name pos:line="530" pos:column="21">path<pos:position pos:line="530" pos:column="25"/></name></name></expr></argument>)<pos:position pos:line="530" pos:column="26"/></argument_list></call></expr>;<pos:position pos:line="530" pos:column="27"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="531" pos:column="9">free<pos:position pos:line="531" pos:column="13"/></name><argument_list pos:line="531" pos:column="13">(<argument><expr><name><name pos:line="531" pos:column="14">clist<pos:position pos:line="531" pos:column="19"/></name><operator pos:line="531" pos:column="19">-&gt;<pos:position pos:line="531" pos:column="24"/></operator><name pos:line="531" pos:column="21">spath<pos:position pos:line="531" pos:column="26"/></name></name></expr></argument>)<pos:position pos:line="531" pos:column="27"/></argument_list></call></expr>;<pos:position pos:line="531" pos:column="28"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="532" pos:column="9">free<pos:position pos:line="532" pos:column="13"/></name><argument_list pos:line="532" pos:column="13">(<argument><expr><name><name pos:line="532" pos:column="14">clist<pos:position pos:line="532" pos:column="19"/></name><operator pos:line="532" pos:column="19">-&gt;<pos:position pos:line="532" pos:column="24"/></operator><name pos:line="532" pos:column="21">expirestr<pos:position pos:line="532" pos:column="30"/></name></name></expr></argument>)<pos:position pos:line="532" pos:column="31"/></argument_list></call></expr>;<pos:position pos:line="532" pos:column="32"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="533" pos:column="9">free<pos:position pos:line="533" pos:column="13"/></name><argument_list pos:line="533" pos:column="13">(<argument><expr><name><name pos:line="533" pos:column="14">clist<pos:position pos:line="533" pos:column="19"/></name><operator pos:line="533" pos:column="19">-&gt;<pos:position pos:line="533" pos:column="24"/></operator><name pos:line="533" pos:column="21">version<pos:position pos:line="533" pos:column="28"/></name></name></expr></argument>)<pos:position pos:line="533" pos:column="29"/></argument_list></call></expr>;<pos:position pos:line="533" pos:column="30"/></expr_stmt>
        <expr_stmt><expr><call><name pos:line="534" pos:column="9">free<pos:position pos:line="534" pos:column="13"/></name><argument_list pos:line="534" pos:column="13">(<argument><expr><name><name pos:line="534" pos:column="14">clist<pos:position pos:line="534" pos:column="19"/></name><operator pos:line="534" pos:column="19">-&gt;<pos:position pos:line="534" pos:column="24"/></operator><name pos:line="534" pos:column="21">maxage<pos:position pos:line="534" pos:column="27"/></name></name></expr></argument>)<pos:position pos:line="534" pos:column="28"/></argument_list></call></expr>;<pos:position pos:line="534" pos:column="29"/></expr_stmt>

        <expr_stmt><expr><operator pos:line="536" pos:column="9">*<pos:position pos:line="536" pos:column="10"/></operator><name pos:line="536" pos:column="10">clist<pos:position pos:line="536" pos:column="15"/></name> <operator pos:line="536" pos:column="16">=<pos:position pos:line="536" pos:column="17"/></operator> <operator pos:line="536" pos:column="18">*<pos:position pos:line="536" pos:column="19"/></operator><name pos:line="536" pos:column="19">co<pos:position pos:line="536" pos:column="21"/></name></expr>;<pos:position pos:line="536" pos:column="22"/></expr_stmt>  <comment type="block" pos:line="536" pos:column="24">/* then store all the new data */</comment>

        <expr_stmt><expr><call><name pos:line="538" pos:column="9">free<pos:position pos:line="538" pos:column="13"/></name><argument_list pos:line="538" pos:column="13">(<argument><expr><name pos:line="538" pos:column="14">co<pos:position pos:line="538" pos:column="16"/></name></expr></argument>)<pos:position pos:line="538" pos:column="17"/></argument_list></call></expr>;<pos:position pos:line="538" pos:column="18"/></expr_stmt>   <comment type="block" pos:line="538" pos:column="21">/* free the newly alloced memory */</comment>
        <expr_stmt><expr><name pos:line="539" pos:column="9">co<pos:position pos:line="539" pos:column="11"/></name> <operator pos:line="539" pos:column="12">=<pos:position pos:line="539" pos:column="13"/></operator> <name pos:line="539" pos:column="14">clist<pos:position pos:line="539" pos:column="19"/></name></expr>;<pos:position pos:line="539" pos:column="20"/></expr_stmt> <comment type="block" pos:line="539" pos:column="21">/* point to the previous struct instead */</comment>

        <comment type="block" pos:line="541" pos:column="9">/* We have replaced a cookie, now skip the rest of the list but
           make sure the 'lastc' pointer is properly set */</comment>
        <do pos:line="543" pos:column="9">do <block pos:line="543" pos:column="12">{
          <expr_stmt><expr><name pos:line="544" pos:column="11">lastc<pos:position pos:line="544" pos:column="16"/></name> <operator pos:line="544" pos:column="17">=<pos:position pos:line="544" pos:column="18"/></operator> <name pos:line="544" pos:column="19">clist<pos:position pos:line="544" pos:column="24"/></name></expr>;<pos:position pos:line="544" pos:column="25"/></expr_stmt>
          <expr_stmt><expr><name pos:line="545" pos:column="11">clist<pos:position pos:line="545" pos:column="16"/></name> <operator pos:line="545" pos:column="17">=<pos:position pos:line="545" pos:column="18"/></operator> <name><name pos:line="545" pos:column="19">clist<pos:position pos:line="545" pos:column="24"/></name><operator pos:line="545" pos:column="24">-&gt;<pos:position pos:line="545" pos:column="29"/></operator><name pos:line="545" pos:column="26">next<pos:position pos:line="545" pos:column="30"/></name></name></expr>;<pos:position pos:line="545" pos:column="31"/></expr_stmt>
        }<pos:position pos:line="546" pos:column="10"/></block> while<condition pos:line="546" pos:column="16">(<expr><name pos:line="546" pos:column="17">clist<pos:position pos:line="546" pos:column="22"/></name></expr>)<pos:position pos:line="546" pos:column="23"/></condition>;<pos:position pos:line="546" pos:column="24"/></do>
        <break pos:line="547" pos:column="9">break;<pos:position pos:line="547" pos:column="15"/></break>
      }<pos:position pos:line="548" pos:column="8"/></block></then></if>
    }<pos:position pos:line="549" pos:column="6"/></block></then></if>
    <expr_stmt><expr><name pos:line="550" pos:column="5">lastc<pos:position pos:line="550" pos:column="10"/></name> <operator pos:line="550" pos:column="11">=<pos:position pos:line="550" pos:column="12"/></operator> <name pos:line="550" pos:column="13">clist<pos:position pos:line="550" pos:column="18"/></name></expr>;<pos:position pos:line="550" pos:column="19"/></expr_stmt>
    <expr_stmt><expr><name pos:line="551" pos:column="5">clist<pos:position pos:line="551" pos:column="10"/></name> <operator pos:line="551" pos:column="11">=<pos:position pos:line="551" pos:column="12"/></operator> <name><name pos:line="551" pos:column="13">clist<pos:position pos:line="551" pos:column="18"/></name><operator pos:line="551" pos:column="18">-&gt;<pos:position pos:line="551" pos:column="23"/></operator><name pos:line="551" pos:column="20">next<pos:position pos:line="551" pos:column="24"/></name></name></expr>;<pos:position pos:line="551" pos:column="25"/></expr_stmt>
  }<pos:position pos:line="552" pos:column="4"/></block></while>

  <if pos:line="554" pos:column="3">if<condition pos:line="554" pos:column="5">(<expr><name><name pos:line="554" pos:column="6">c<pos:position pos:line="554" pos:column="7"/></name><operator pos:line="554" pos:column="7">-&gt;<pos:position pos:line="554" pos:column="12"/></operator><name pos:line="554" pos:column="9">running<pos:position pos:line="554" pos:column="16"/></name></name></expr>)<pos:position pos:line="554" pos:column="17"/></condition><then pos:line="554" pos:column="17">
    <comment type="block" pos:line="555" pos:column="5">/* Only show this when NOT reading the cookies from a file */</comment>
    <block type="pseudo"><expr_stmt><expr><call><name pos:line="556" pos:column="5">infof<pos:position pos:line="556" pos:column="10"/></name><argument_list pos:line="556" pos:column="10">(<argument><expr><name pos:line="556" pos:column="11">data<pos:position pos:line="556" pos:column="15"/></name></expr></argument>, <argument><expr><literal type="string" pos:line="556" pos:column="17">"%s cookie %s=\"%s\" for domain %s, path %s, "<pos:position pos:line="556" pos:column="63"/></literal>
          <literal type="string" pos:line="557" pos:column="11">"expire %"<pos:position pos:line="557" pos:column="21"/></literal> <name pos:line="557" pos:column="22">CURL_FORMAT_CURL_OFF_T<pos:position pos:line="557" pos:column="44"/></name> <literal type="string" pos:line="557" pos:column="45">"\n"<pos:position pos:line="557" pos:column="49"/></literal></expr></argument>,
          <argument><expr><ternary><condition><expr><name pos:line="558" pos:column="11">replace_old<pos:position pos:line="558" pos:column="22"/></name></expr>?<pos:position pos:line="558" pos:column="23"/></condition><then><expr><literal type="string" pos:line="558" pos:column="23">"Replaced"<pos:position pos:line="558" pos:column="33"/></literal></expr></then><else pos:line="558" pos:column="33">:<expr><literal type="string" pos:line="558" pos:column="34">"Added"<pos:position pos:line="558" pos:column="41"/></literal></expr></else></ternary></expr></argument>, <argument><expr><name><name pos:line="558" pos:column="43">co<pos:position pos:line="558" pos:column="45"/></name><operator pos:line="558" pos:column="45">-&gt;<pos:position pos:line="558" pos:column="50"/></operator><name pos:line="558" pos:column="47">name<pos:position pos:line="558" pos:column="51"/></name></name></expr></argument>, <argument><expr><name><name pos:line="558" pos:column="53">co<pos:position pos:line="558" pos:column="55"/></name><operator pos:line="558" pos:column="55">-&gt;<pos:position pos:line="558" pos:column="60"/></operator><name pos:line="558" pos:column="57">value<pos:position pos:line="558" pos:column="62"/></name></name></expr></argument>,
          <argument><expr><name><name pos:line="559" pos:column="11">co<pos:position pos:line="559" pos:column="13"/></name><operator pos:line="559" pos:column="13">-&gt;<pos:position pos:line="559" pos:column="18"/></operator><name pos:line="559" pos:column="15">domain<pos:position pos:line="559" pos:column="21"/></name></name></expr></argument>, <argument><expr><name><name pos:line="559" pos:column="23">co<pos:position pos:line="559" pos:column="25"/></name><operator pos:line="559" pos:column="25">-&gt;<pos:position pos:line="559" pos:column="30"/></operator><name pos:line="559" pos:column="27">path<pos:position pos:line="559" pos:column="31"/></name></name></expr></argument>, <argument><expr><name><name pos:line="559" pos:column="33">co<pos:position pos:line="559" pos:column="35"/></name><operator pos:line="559" pos:column="35">-&gt;<pos:position pos:line="559" pos:column="40"/></operator><name pos:line="559" pos:column="37">expires<pos:position pos:line="559" pos:column="44"/></name></name></expr></argument>)<pos:position pos:line="559" pos:column="45"/></argument_list></call></expr>;<pos:position pos:line="559" pos:column="46"/></expr_stmt></block></then></if>

  <if pos:line="561" pos:column="3">if<condition pos:line="561" pos:column="5">(<expr><operator pos:line="561" pos:column="6">!<pos:position pos:line="561" pos:column="7"/></operator><name pos:line="561" pos:column="7">replace_old<pos:position pos:line="561" pos:column="18"/></name></expr>)<pos:position pos:line="561" pos:column="19"/></condition><then pos:line="561" pos:column="19"> <block pos:line="561" pos:column="20">{
    <comment type="block" pos:line="562" pos:column="5">/* then make the last item point on this new one */</comment>
    <if pos:line="563" pos:column="5">if<condition pos:line="563" pos:column="7">(<expr><name pos:line="563" pos:column="8">lastc<pos:position pos:line="563" pos:column="13"/></name></expr>)<pos:position pos:line="563" pos:column="14"/></condition><then pos:line="563" pos:column="14">
      <block type="pseudo"><expr_stmt><expr><name><name pos:line="564" pos:column="7">lastc<pos:position pos:line="564" pos:column="12"/></name><operator pos:line="564" pos:column="12">-&gt;<pos:position pos:line="564" pos:column="17"/></operator><name pos:line="564" pos:column="14">next<pos:position pos:line="564" pos:column="18"/></name></name> <operator pos:line="564" pos:column="19">=<pos:position pos:line="564" pos:column="20"/></operator> <name pos:line="564" pos:column="21">co<pos:position pos:line="564" pos:column="23"/></name></expr>;<pos:position pos:line="564" pos:column="24"/></expr_stmt></block></then>
    <else pos:line="565" pos:column="5">else
      <block type="pseudo"><expr_stmt><expr><name><name pos:line="566" pos:column="7">c<pos:position pos:line="566" pos:column="8"/></name><operator pos:line="566" pos:column="8">-&gt;<pos:position pos:line="566" pos:column="13"/></operator><name pos:line="566" pos:column="10">cookies<pos:position pos:line="566" pos:column="17"/></name></name> <operator pos:line="566" pos:column="18">=<pos:position pos:line="566" pos:column="19"/></operator> <name pos:line="566" pos:column="20">co<pos:position pos:line="566" pos:column="22"/></name></expr>;<pos:position pos:line="566" pos:column="23"/></expr_stmt></block></else></if>
    <expr_stmt><expr><name><name pos:line="567" pos:column="5">c<pos:position pos:line="567" pos:column="6"/></name><operator pos:line="567" pos:column="6">-&gt;<pos:position pos:line="567" pos:column="11"/></operator><name pos:line="567" pos:column="8">numcookies<pos:position pos:line="567" pos:column="18"/></name></name><operator pos:line="567" pos:column="18">++<pos:position pos:line="567" pos:column="20"/></operator></expr>;<pos:position pos:line="567" pos:column="21"/></expr_stmt> <comment type="block" pos:line="567" pos:column="22">/* one more cookie in the jar */</comment>
  }<pos:position pos:line="568" pos:column="4"/></block></then></if>

  <return pos:line="570" pos:column="3">return <expr><name pos:line="570" pos:column="10">co<pos:position pos:line="570" pos:column="12"/></name></expr>;<pos:position pos:line="570" pos:column="13"/></return>
}<pos:position pos:line="571" pos:column="2"/></block></function></unit>
