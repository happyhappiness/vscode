diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/configure /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/configure
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/configure	2005-02-15 02:01:39.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/configure	2005-02-16 07:33:34.000000000 +0800
@@ -1,9 +1,9 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.57 for rtorrent 0.0.1.
+# Generated by GNU Autoconf 2.57 for rtorrent 0.0.2.
 #
 # Report bugs to <jaris@ifi.uio.no>.
 #
 # Copyright 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001, 2002
 # Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
@@ -265,14 +265,14 @@
 # only ac_max_sed_lines should be used.
 : ${ac_max_here_lines=38}
 
 # Identity of this package.
 PACKAGE_NAME='rtorrent'
 PACKAGE_TARNAME='rtorrent'
-PACKAGE_VERSION='0.0.1'
-PACKAGE_STRING='rtorrent 0.0.1'
+PACKAGE_VERSION='0.0.2'
+PACKAGE_STRING='rtorrent 0.0.2'
 PACKAGE_BUGREPORT='jaris@ifi.uio.no'
 
 ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO AMTAR install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM AWK SET_MAKE CXX CXXFLAGS LDFLAGS CPPFLAGS ac_ct_CXX EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CXXDEPMODE RANLIB ac_ct_RANLIB CC CFLAGS ac_ct_CC CCDEPMODE PKG_CONFIG STUFF_CFLAGS STUFF_LIBS LIBOBJS LTLIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -742,13 +742,13 @@
 # Report the --help message.
 #
 if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures rtorrent 0.0.1 to adapt to many kinds of systems.
+\`configure' configures rtorrent 0.0.2 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
 To assign environment variables (e.g., CC, CFLAGS...), specify them as
 VAR=VALUE.  See below for descriptions of some of the useful variables.
 
@@ -804,13 +804,13 @@
   --program-transform-name=PROGRAM   run sed PROGRAM on installed program names
 _ACEOF
 fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of rtorrent 0.0.1:";;
+     short | recursive ) echo "Configuration of rtorrent 0.0.2:";;
    esac
   cat <<\_ACEOF
 
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
@@ -893,13 +893,13 @@
   done
 fi
 
 test -n "$ac_init_help" && exit 0
 if $ac_init_version; then
   cat <<\_ACEOF
-rtorrent configure 0.0.1
+rtorrent configure 0.0.2
 generated by GNU Autoconf 2.57
 
 Copyright 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001, 2002
 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
@@ -908,13 +908,13 @@
 fi
 exec 5>config.log
 cat >&5 <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by rtorrent $as_me 0.0.1, which was
+It was created by rtorrent $as_me 0.0.2, which was
 generated by GNU Autoconf 2.57.  Invocation command line was
 
   $ $0 $@
 
 _ACEOF
 {
@@ -1499,13 +1499,13 @@
 echo "$as_me: error: source directory already configured; run \"make distclean\" there first" >&2;}
    { (exit 1); exit 1; }; }
 fi
 
 # Define the identity of the package.
  PACKAGE=rtorrent
- VERSION=0.0.1
+ VERSION=0.0.2
 
 
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
 
@@ -3771,37 +3771,37 @@
      echo "*** in your path, or set the PKG_CONFIG environment variable"
      echo "*** to the full path to pkg-config."
      echo "*** Or see http://www.freedesktop.org/software/pkgconfig to get pkg-config."
   else
      PKG_CONFIG_MIN_VERSION=0.9.0
      if $PKG_CONFIG --atleast-pkgconfig-version $PKG_CONFIG_MIN_VERSION; then
-        echo "$as_me:$LINENO: checking for sigc++-2.0 libtorrent >= 0.4.9" >&5
-echo $ECHO_N "checking for sigc++-2.0 libtorrent >= 0.4.9... $ECHO_C" >&6
+        echo "$as_me:$LINENO: checking for sigc++-2.0 libtorrent >= 0.4.10" >&5
+echo $ECHO_N "checking for sigc++-2.0 libtorrent >= 0.4.10... $ECHO_C" >&6
 
-        if $PKG_CONFIG --exists "sigc++-2.0 libtorrent >= 0.4.9" ; then
+        if $PKG_CONFIG --exists "sigc++-2.0 libtorrent >= 0.4.10" ; then
             echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6
             succeeded=yes
 
             echo "$as_me:$LINENO: checking STUFF_CFLAGS" >&5
 echo $ECHO_N "checking STUFF_CFLAGS... $ECHO_C" >&6
-            STUFF_CFLAGS=`$PKG_CONFIG --cflags "sigc++-2.0 libtorrent >= 0.4.9"`
+            STUFF_CFLAGS=`$PKG_CONFIG --cflags "sigc++-2.0 libtorrent >= 0.4.10"`
             echo "$as_me:$LINENO: result: $STUFF_CFLAGS" >&5
 echo "${ECHO_T}$STUFF_CFLAGS" >&6
 
             echo "$as_me:$LINENO: checking STUFF_LIBS" >&5
 echo $ECHO_N "checking STUFF_LIBS... $ECHO_C" >&6
-            STUFF_LIBS=`$PKG_CONFIG --libs "sigc++-2.0 libtorrent >= 0.4.9"`
+            STUFF_LIBS=`$PKG_CONFIG --libs "sigc++-2.0 libtorrent >= 0.4.10"`
             echo "$as_me:$LINENO: result: $STUFF_LIBS" >&5
 echo "${ECHO_T}$STUFF_LIBS" >&6
         else
             STUFF_CFLAGS=""
             STUFF_LIBS=""
             ## If we have a custom action on failure, don't print errors, but
             ## do set a variable so people can do so.
-            STUFF_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "sigc++-2.0 libtorrent >= 0.4.9"`
+            STUFF_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "sigc++-2.0 libtorrent >= 0.4.10"`
             echo $STUFF_PKG_ERRORS
         fi
 
 
 
      else
@@ -3811,14 +3811,14 @@
   fi
 
   if test $succeeded = yes; then
      CXXFLAGS="$CXXFLAGS $STUFF_CFLAGS $CURL_CFLAGS";
 		  LIBS="$LIBS $STUFF_LIBS $CURL_LIBS"
   else
-     { { echo "$as_me:$LINENO: error: Library requirements (sigc++-2.0 libtorrent >= 0.4.9) not met; consider adjusting the PKG_CONFIG_PATH environment variable if your libraries are in a nonstandard prefix so pkg-config can find them." >&5
-echo "$as_me: error: Library requirements (sigc++-2.0 libtorrent >= 0.4.9) not met; consider adjusting the PKG_CONFIG_PATH environment variable if your libraries are in a nonstandard prefix so pkg-config can find them." >&2;}
+     { { echo "$as_me:$LINENO: error: Library requirements (sigc++-2.0 libtorrent >= 0.4.10) not met; consider adjusting the PKG_CONFIG_PATH environment variable if your libraries are in a nonstandard prefix so pkg-config can find them." >&5
+echo "$as_me: error: Library requirements (sigc++-2.0 libtorrent >= 0.4.10) not met; consider adjusting the PKG_CONFIG_PATH environment variable if your libraries are in a nonstandard prefix so pkg-config can find them." >&2;}
    { (exit 1); exit 1; }; }
   fi
 
 
 
 cat >>confdefs.h <<\_ACEOF
@@ -4191,13 +4191,13 @@
   sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
 ## Running $as_me. ##
 _ASBOX
 } >&5
 cat >&5 <<_CSEOF
 
-This file was extended by rtorrent $as_me 0.0.1, which was
+This file was extended by rtorrent $as_me 0.0.2, which was
 generated by GNU Autoconf 2.57.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
   CONFIG_LINKS    = $CONFIG_LINKS
   CONFIG_COMMANDS = $CONFIG_COMMANDS
@@ -4254,13 +4254,13 @@
 
 Report bugs to <bug-autoconf@gnu.org>."
 _ACEOF
 
 cat >>$CONFIG_STATUS <<_ACEOF
 ac_cs_version="\\
-rtorrent config.status 0.0.1
+rtorrent config.status 0.0.2
 configured by $0, generated by GNU Autoconf 2.57,
   with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
 
 Copyright 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001
 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/configure.ac /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/configure.ac
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/configure.ac	2005-02-15 02:01:05.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/configure.ac	2005-02-16 07:12:57.000000000 +0800
@@ -1,7 +1,7 @@
-AC_INIT(rtorrent, 0.0.1, jaris@ifi.uio.no)
+AC_INIT(rtorrent, 0.0.2, jaris@ifi.uio.no)
 
 AM_INIT_AUTOMAKE
 AM_CONFIG_HEADER(config.h)
 
 sinclude(scripts/checks.m4)
 
@@ -36,13 +36,13 @@
 AC_SEARCH_LIBS(wbkgdset, ncurses curses,,echo "*** The ncurses library is required!";exit 1)
 
 TORRENT_CHECK_EXECINFO()
 TORRENT_CHECK_CURL()
 TORRENT_OTFD()
 
-PKG_CHECK_MODULES(STUFF, sigc++-2.0 libtorrent >= 0.4.9,
+PKG_CHECK_MODULES(STUFF, sigc++-2.0 libtorrent >= 0.4.10,
 	          CXXFLAGS="$CXXFLAGS $STUFF_CFLAGS $CURL_CFLAGS";
 		  LIBS="$LIBS $STUFF_LIBS $CURL_LIBS")
 
 AC_DEFINE(HAVE_CONFIG_H, 1, true if config.h was included)
 
 AC_OUTPUT([
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/Makefile.am	2005-01-25 23:08:52.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/Makefile.am	2005-02-15 09:07:42.000000000 +0800
@@ -1,4 +1,5 @@
 SUBDIRS = src
 
 EXTRA_DIST= \
-	autogen.sh
+	autogen.sh \
+	scripts/checks.m4
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/Makefile.in	2005-02-15 02:01:37.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/Makefile.in	2005-02-16 07:33:32.000000000 +0800
@@ -76,13 +76,14 @@
 am__include = @am__include@
 am__quote = @am__quote@
 install_sh = @install_sh@
 SUBDIRS = src
 
 EXTRA_DIST = \
-	autogen.sh
+	autogen.sh \
+	scripts/checks.m4
 
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
 CONFIG_HEADER = config.h
 CONFIG_CLEAN_FILES =
@@ -90,15 +91,15 @@
 
 RECURSIVE_TARGETS = info-recursive dvi-recursive install-info-recursive \
 	uninstall-info-recursive all-recursive install-data-recursive \
 	install-exec-recursive installdirs-recursive install-recursive \
 	uninstall-recursive check-recursive installcheck-recursive
 DIST_COMMON = README AUTHORS COPYING ChangeLog INSTALL Makefile.am \
-	Makefile.in NEWS aclocal.m4 config.guess config.h.in config.sub \
-	configure configure.ac depcomp install-sh ltmain.sh missing \
-	mkinstalldirs
+	Makefile.in NEWS TODO aclocal.m4 config.guess config.h.in \
+	config.sub configure configure.ac depcomp install-sh ltmain.sh \
+	missing mkinstalldirs
 DIST_SUBDIRS = $(SUBDIRS)
 all: config.h
 	$(MAKE) $(AM_MAKEFLAGS) all-recursive
 
 .SUFFIXES:
 
@@ -244,12 +245,13 @@
 GZIP_ENV = --best
 distcleancheck_listfiles = find . -type f -print
 
 distdir: $(DISTFILES)
 	$(am__remove_distdir)
 	mkdir $(distdir)
+	$(mkinstalldirs) $(distdir)/scripts
 	@list='$(DISTFILES)'; for file in $$list; do \
 	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
 	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
 	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
 	    dir="/$$dir"; \
 	    $(mkinstalldirs) "$(distdir)$$dir"; \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/README /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/README
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/README	2005-02-15 02:34:33.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/README	2005-02-16 05:47:33.000000000 +0800
@@ -1,9 +1,9 @@
 All:
 
-  Ctrl-C  - Quit
+  Ctrl-Q  - Quit
 
   A       - Increase Throttle by 1 KiB
   Z       - Decrease Throttle by 1 KiB
 
   S       - Increase Throttle by 5 KiB
   X       - Decrease Throttle by 5 KiB
@@ -8,33 +8,38 @@
   S       - Increase Throttle by 5 KiB
   X       - Decrease Throttle by 5 KiB
 
   D       - Increase Throttle by 50 KiB
   C       - Decrease Throttle by 50 KiB
 
+
 In main window:
 
   Backspace - Activate text input for inserting urls/file
               paths. Arrows/C^f/C^b for navigation, enter/C^m.
 
-  Up/Down   - Select torrent.
+  Up/Down   - Select torrent
+
+  Right     - View torrent
 
-  Right     - View torrent.
+  Ctrl-S    - Start torrent
+  Ctrl-D    - Stop/delete torrent
 
 
 In torrent view:
 
-  Up/Down   - Select peer.
+  Up/Down   - Select peer
 
-  Left      - Back to main.
+  Left      - Back to main
 
-  Right     - View peer.
+  Right     - View peer
 
   1         - Decrease max uploads
   2         - Increase max uploads
 
   3         - Decrease min peers connected
   4         - Increase min peers connected
 
   5         - Decrease max peers connected
   6         - Increase max peers connected
 
+  T         - Query tracker
\ No newline at end of file
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2: scripts
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/curl_stack.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/curl_stack.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/curl_stack.cc	2005-02-10 07:07:20.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/curl_stack.cc	2005-02-16 07:44:48.000000000 +0800
@@ -52,18 +52,14 @@
 
   } while (code == CURLM_CALL_MULTI_PERFORM);
 }
 
 void
 CurlStack::fdset(fd_set* readfds, fd_set* writefds, fd_set* exceptfds, int* maxFd) {
-  int f;
-
-  if (curl_multi_fdset((CURLM*)m_handle, readfds, writefds, exceptfds, &f) > 0)
+  if (curl_multi_fdset((CURLM*)m_handle, readfds, writefds, exceptfds, maxFd) > 0)
     throw torrent::local_error("Error calling curl_multi_fdset");
-
-  *maxFd = std::max(f, *maxFd);
 }
 
 void
 CurlStack::add_get(CurlGet* get) {
   CURLMcode code;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download.h	2005-02-09 05:58:09.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download.h	2005-02-16 23:15:58.000000000 +0800
@@ -16,16 +16,15 @@
   
   const std::string& get_tracker_msg()               { return m_trackerMsg; }
 
   void               open()                          { m_download.open(); }
   void               close()                         { m_download.close(); }
 
+  void               start()                         { m_download.start(); }
   void               stop()                          { m_download.stop(); }
 
-  void               hash_check(bool resume = false) { m_download.hash_check(resume); }
-
   bool operator == (const std::string& str)          { return str == m_download.get_hash(); }
 
 private:
   void               receive_tracker_msg(std::string msg);
 
   torrent::Download  m_download;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download_list.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download_list.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download_list.cc	2005-02-11 03:10:43.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download_list.cc	2005-02-16 23:17:19.000000000 +0800
@@ -12,16 +12,13 @@
 
 DownloadList::iterator
 DownloadList::insert(std::istream* str) {
   torrent::Download d = torrent::download_create(str);
 
   iterator itr = Base::insert(end(), Download());
-
   itr->set_download(d);
-  itr->get_download().signal_hash_done(sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_hash_done),
-						  itr->get_hash()));
 
   return itr;
 }
 
 void
 DownloadList::erase(iterator itr) {
@@ -25,21 +22,10 @@
 
 void
 DownloadList::erase(iterator itr) {
   itr->release_download();
 
   torrent::download_remove(itr->get_hash());
-
   Base::erase(itr);
 }
 
-void
-DownloadList::receive_hash_done(const std::string& str) {
-  iterator itr = std::find(begin(), end(), str);
-
-  if (itr == end())
-    throw torrent::client_error("DownloadList received hash check done, but couldn't find the download");
-
-  itr->get_download().start();
-}
-
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download_list.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download_list.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/download_list.h	2005-02-11 03:09:25.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/download_list.h	2005-02-16 23:11:47.000000000 +0800
@@ -23,14 +23,11 @@
 
   using Base::empty;
   using Base::size;
 
   iterator  insert(std::istream* str);
   void      erase(iterator itr);
-
-private:
-  void      receive_hash_done(const std::string& str);
 };
 
 }
 
 #endif
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core: hash_queue.cc
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core: hash_queue.h
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/Makefile.am	2005-02-12 02:34:10.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/Makefile.am	2005-02-15 22:31:58.000000000 +0800
@@ -2,12 +2,14 @@
 
 libsub_core_a_SOURCES = \
 	curl_get.cc \
 	curl_get.h \
 	curl_stack.cc \
 	curl_stack.h \
+	hash_queue.cc \
+	hash_queue.h \
 	http_queue.cc \
 	http_queue.h \
 	download.cc \
 	download.h \
 	download_list.cc \
 	download_list.h \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/Makefile.in	2005-02-15 02:01:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/Makefile.in	2005-02-16 07:33:42.000000000 +0800
@@ -80,12 +80,14 @@
 
 libsub_core_a_SOURCES = \
 	curl_get.cc \
 	curl_get.h \
 	curl_stack.cc \
 	curl_stack.h \
+	hash_queue.cc \
+	hash_queue.h \
 	http_queue.cc \
 	http_queue.h \
 	download.cc \
 	download.h \
 	download_list.cc \
 	download_list.h \
@@ -102,28 +104,28 @@
 CONFIG_CLEAN_FILES =
 LIBRARIES = $(noinst_LIBRARIES)
 
 libsub_core_a_AR = $(AR) cru
 libsub_core_a_LIBADD =
 am_libsub_core_a_OBJECTS = curl_get.$(OBJEXT) curl_stack.$(OBJEXT) \
-	http_queue.$(OBJEXT) download.$(OBJEXT) download_list.$(OBJEXT) \
-	manager.$(OBJEXT) poll.$(OBJEXT)
+	hash_queue.$(OBJEXT) http_queue.$(OBJEXT) download.$(OBJEXT) \
+	download_list.$(OBJEXT) manager.$(OBJEXT) poll.$(OBJEXT)
 libsub_core_a_OBJECTS = $(am_libsub_core_a_OBJECTS)
 
 DEFS = @DEFS@
 DEFAULT_INCLUDES =  -I. -I$(srcdir) -I$(top_builddir)
 CPPFLAGS = @CPPFLAGS@
 LDFLAGS = @LDFLAGS@
 LIBS = @LIBS@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 @AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/curl_get.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/curl_stack.Po ./$(DEPDIR)/download.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/download_list.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/http_queue.Po ./$(DEPDIR)/manager.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/poll.Po
+@AMDEP_TRUE@	./$(DEPDIR)/hash_queue.Po ./$(DEPDIR)/http_queue.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/manager.Po ./$(DEPDIR)/poll.Po
 CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
 	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
 CXXLD = $(CXX)
 CXXLINK = $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) $(AM_LDFLAGS) $(LDFLAGS) \
 	-o $@
 CXXFLAGS = @CXXFLAGS@
@@ -162,12 +164,13 @@
 	-rm -f *.tab.c
 
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/curl_get.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/curl_stack.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/download.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/download_list.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/hash_queue.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/http_queue.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/manager.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/poll.Po@am__quote@
 
 distclean-depend:
 	-rm -rf ./$(DEPDIR)
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/manager.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/manager.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/manager.cc	2005-02-12 04:08:00.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/manager.cc	2005-02-16 23:23:00.000000000 +0800
@@ -1,38 +1,88 @@
 #include "config.h"
 
+#include <stdexcept>
 #include <cstring>
 #include <fstream>
 #include <istream>
 #include <sigc++/bind.h>
 #include <torrent/exceptions.h>
 #include <torrent/http.h>
+#include <torrent/torrent.h>
 
 #include "manager.h"
 
 namespace core {
 
 void
+Manager::initialize() {
+  torrent::Http::set_factory(m_poll.get_http_factory());
+  m_httpQueue.slot_factory(m_poll.get_http_factory());
+
+  CurlStack::init();
+
+  torrent::initialize();
+  torrent::listen_open(10000, 20000);
+}
+
+void
+Manager::cleanup() {
+  torrent::cleanup();
+  core::CurlStack::cleanup();
+}
+
+void
 Manager::insert(const std::string& uri) {
   if (std::strncmp(uri.c_str(), "http://", 7))
     create_file(uri);
   else
     create_http(uri);
 }
 
 void
+Manager::erase(DownloadList::iterator itr) {
+  if (itr->get_download().is_active())
+    throw std::logic_error("core::Manager::erase(...) called on an active download");
+
+  if (itr->get_download().is_open())
+    itr->close();
+
+  m_downloadList.erase(itr);
+}  
+
+void
+Manager::start(Download* d) {
+  if (d->get_download().is_active())
+    return;
+
+  if (!d->get_download().is_open())
+    d->open();
+
+  if (d->get_download().is_hash_checked())
+    d->start();
+  else
+    m_hashQueue.insert(d, sigc::mem_fun(*d, &Download::start));
+}
+
+void
+Manager::stop(Download* d) {
+  m_hashQueue.remove(d);
+
+  d->stop();
+}
+
+void
 Manager::create_file(const std::string& uri) {
   DownloadList::iterator itr = m_downloadList.end();
 
   try {
     std::fstream f(uri.c_str(), std::ios::in);
     
     itr = m_downloadList.insert(&f);
 
-    itr->open();
-    itr->hash_check();
+    start(&*itr);
 
   } catch (torrent::local_error& e) {
     // What to do? Keep in list for now.
   }
 }
 
@@ -48,14 +98,13 @@
 Manager::receive_http_done(torrent::Http* http) {
   DownloadList::iterator itr = m_downloadList.end();
 
   try {
     itr = m_downloadList.insert(http->get_stream());
 
-    itr->open();
-    itr->hash_check();
+    start(&*itr);
 
   } catch (torrent::local_error& e) {
     // What to do? Keep in list for now.
   }
 }  
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/manager.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/manager.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/manager.h	2005-02-12 03:35:04.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/manager.h	2005-02-16 23:12:07.000000000 +0800
@@ -1,31 +1,45 @@
 #ifndef RTORRENT_CORE_MANAGER_H
 #define RTORRENT_CORE_MANAGER_H
 
 #include "download_list.h"
+#include "hash_queue.h"
 #include "http_queue.h"
+#include "poll.h"
 
 namespace core {
 
 class Manager {
 public:
   typedef sigc::slot1<void, DownloadList::iterator> SlotReady;
   typedef sigc::slot0<void>                         SlotFailed;
 
   DownloadList& get_download_list() { return m_downloadList; }
+  HashQueue&    get_hash_queue()    { return m_hashQueue; }
   HttpQueue&    get_http_queue()    { return m_httpQueue; }
 
+  Poll&         get_poll()          { return m_poll; }
+
+  void          initialize();
+  void          cleanup();
+
   void          insert(const std::string& uri);
+  void          erase(DownloadList::iterator itr);
+
+  void          start(Download* d);
+  void          stop(Download* d);
 
 private:
   void          receive_http_done(torrent::Http* http);
 
   void          create_file(const std::string& uri);
   void          create_http(const std::string& uri);
 
   DownloadList  m_downloadList;
+  HashQueue     m_hashQueue;
   HttpQueue     m_httpQueue;
+  Poll          m_poll;
 };
 
 }
 
 #endif
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/poll.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/poll.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/poll.cc	2005-02-11 02:42:41.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/poll.cc	2005-02-16 07:46:19.000000000 +0800
@@ -10,33 +10,36 @@
 #include "curl_get.h"
 
 namespace core {
 
 void
 Poll::poll() {
-  FD_ZERO(&m_readSet);
-  FD_ZERO(&m_writeSet);
-  FD_ZERO(&m_exceptSet);
-
-  torrent::mark(&m_readSet, &m_writeSet, &m_exceptSet, &m_maxFd);
-
-  m_maxFd = std::max(m_maxFd, 1);
-    
-  FD_SET(0, &m_readSet);
+  FD_ZERO(m_readSet);
+  FD_ZERO(m_writeSet);
+  FD_ZERO(m_exceptSet);
 
-  if (m_curlStack.is_busy())
-    m_curlStack.fdset(&m_readSet, &m_writeSet, &m_exceptSet, &m_maxFd);
+  FD_SET(0, m_readSet);
+
+  torrent::mark(m_readSet, m_writeSet, m_exceptSet, &m_maxFd);
+
+  if (m_curlStack.is_busy()) {
+    int n;
+
+    m_curlStack.fdset(m_readSet, m_writeSet, m_exceptSet, &n);
+    m_maxFd = std::max(m_maxFd, n);
+  }
 
   uint64_t t = torrent::get(torrent::TIME_SELECT);
 
   if (t > 1000000)
     t = 1000000;
 
   timeval timeout = {t / 1000000, t % 1000000};
 
-  m_maxFd = select(m_maxFd + 1, &m_readSet, &m_writeSet, &m_exceptSet, &timeout);
+  errno = 0;
+  m_maxFd = select(m_maxFd + 1, m_readSet, m_writeSet, m_exceptSet, &timeout);
 
   if (m_maxFd >= 0) {
     work();
 
   } else if (errno == EINTR) {
     m_slotSelectInterrupted();
@@ -46,19 +49,19 @@
     throw std::runtime_error("Poll::work(): select error");
   }
 }
 
 void
 Poll::work() {
-  if (FD_ISSET(0, &m_readSet))
+  if (FD_ISSET(0, m_readSet))
     work_input();
 
   if (m_curlStack.is_busy())
     m_curlStack.perform();
 
-  torrent::work(&m_readSet, &m_writeSet, &m_exceptSet, m_maxFd);
+  torrent::work(m_readSet, m_writeSet, m_exceptSet, m_maxFd);
 }
 
 void
 Poll::work_input() {
   int key;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/poll.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/poll.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/core/poll.h	2005-02-11 02:42:19.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/core/poll.h	2005-02-16 07:32:59.000000000 +0800
@@ -15,30 +15,36 @@
 class Poll {
 public:
   typedef sigc::slot0<void>           Slot;
   typedef sigc::slot1<void, int>      SlotInt;
   typedef sigc::slot0<torrent::Http*> SlotFactory;
 
+  Poll() : m_readSet(new fd_set), m_writeSet(new fd_set), m_exceptSet(new fd_set) {}
+  ~Poll() { delete m_readSet; delete m_writeSet; delete m_exceptSet; }
+
   void        poll();
 
   SlotFactory get_http_factory();
 
   void        slot_read_stdin(SlotInt s)      { m_slotReadStdin = s; }
   void        slot_select_interrupted(Slot s) { m_slotSelectInterrupted = s; }
 
 private:
+  Poll(const Poll&);
+  void operator = (const Poll&);
+
   void        work();
   void        work_input();
 
   SlotInt     m_slotReadStdin;
   Slot        m_slotSelectInterrupted;
 
   int         m_maxFd;
-  fd_set      m_readSet;
-  fd_set      m_writeSet;
-  fd_set      m_exceptSet;
+  fd_set*     m_readSet;
+  fd_set*     m_writeSet;
+  fd_set*     m_exceptSet;
 
   CurlStack   m_curlStack;
 };
 
 }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/canvas.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/canvas.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/canvas.cc	2005-02-07 01:15:04.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/canvas.cc	2005-02-16 04:38:39.000000000 +0800
@@ -10,19 +10,20 @@
   mvwin(m_window, y, x);
 }
 
 void
 Canvas::init() {
   initscr();
-  cbreak();
+  raw();
   noecho();
   nodelay(stdscr, TRUE);
   keypad(stdscr, TRUE);
   curs_set(0);
 }
 
 void
 Canvas::cleanup() {
+  noraw();
   endwin();
 }
 
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/Makefile.am /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/Makefile.am
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/Makefile.am	2005-02-13 23:57:01.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/Makefile.am	2005-02-16 05:54:46.000000000 +0800
@@ -2,12 +2,14 @@
 
 libsub_display_a_SOURCES = \
 	canvas.cc \
 	canvas.h \
 	manager.cc \
 	manager.h \
+	utils.cc \
+	utils.h \
 	window.cc \
 	window.h \
 	window_download_statusbar.cc \
 	window_download_statusbar.h \
 	window_download_list.cc \
 	window_download_list.h \
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/Makefile.in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/Makefile.in
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/Makefile.in	2005-02-15 02:01:38.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/Makefile.in	2005-02-16 07:34:57.000000000 +0800
@@ -80,12 +80,14 @@
 
 libsub_display_a_SOURCES = \
 	canvas.cc \
 	canvas.h \
 	manager.cc \
 	manager.h \
+	utils.cc \
+	utils.h \
 	window.cc \
 	window.h \
 	window_download_statusbar.cc \
 	window_download_statusbar.h \
 	window_download_list.cc \
 	window_download_list.h \
@@ -108,13 +110,14 @@
 CONFIG_CLEAN_FILES =
 LIBRARIES = $(noinst_LIBRARIES)
 
 libsub_display_a_AR = $(AR) cru
 libsub_display_a_LIBADD =
 am_libsub_display_a_OBJECTS = canvas.$(OBJEXT) manager.$(OBJEXT) \
-	window.$(OBJEXT) window_download_statusbar.$(OBJEXT) \
+	utils.$(OBJEXT) window.$(OBJEXT) \
+	window_download_statusbar.$(OBJEXT) \
 	window_download_list.$(OBJEXT) window_input.$(OBJEXT) \
 	window_peer_info.$(OBJEXT) window_peer_list.$(OBJEXT) \
 	window_statusbar.$(OBJEXT) window_title.$(OBJEXT)
 libsub_display_a_OBJECTS = $(am_libsub_display_a_OBJECTS)
 
 DEFS = @DEFS@
@@ -122,13 +125,13 @@
 CPPFLAGS = @CPPFLAGS@
 LDFLAGS = @LDFLAGS@
 LIBS = @LIBS@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 @AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/canvas.Po ./$(DEPDIR)/manager.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/window.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/utils.Po ./$(DEPDIR)/window.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_download_list.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_download_statusbar.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_input.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_peer_info.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_peer_list.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/window_statusbar.Po \
@@ -172,12 +175,13 @@
 
 distclean-compile:
 	-rm -f *.tab.c
 
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/canvas.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/manager.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/utils.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window_download_list.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window_download_statusbar.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window_input.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window_peer_info.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/window_peer_list.Po@am__quote@
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/manager.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/manager.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/manager.cc	2005-02-10 07:07:27.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/manager.cc	2005-02-17 04:27:11.000000000 +0800
@@ -23,19 +23,23 @@
 
 void
 Manager::adjust_layout() {
   int countDynamic = 0;
   int staticHeight = 0;
 
-  std::for_each(begin(), end(), func::accumulate(staticHeight, std::mem_fun(&Window::get_min_height)));
-  std::for_each(begin(), end(), func::accumulate(countDynamic, std::mem_fun(&Window::is_dynamic)));
+  std::for_each(begin(), end(), func::if_then(std::mem_fun(&Window::is_active), func::accumulate(staticHeight, std::mem_fun(&Window::get_min_height))));
+  std::for_each(begin(), end(), func::if_then(std::mem_fun(&Window::is_active), func::accumulate(countDynamic, std::mem_fun(&Window::is_dynamic))));
 
   int dynamic = std::max(0, Canvas::get_screen_height() - staticHeight);
   int height = 0, h;
 
   for (iterator itr = begin(); itr != end(); ++itr, height += h) {
+    h = 0;
+
+    if (!(*itr)->is_active())
+      continue;
 
     if ((*itr)->is_dynamic()) {
       dynamic -= h = (dynamic + countDynamic - 1) / countDynamic;
       countDynamic--;
     } else {
       h = 0;
@@ -49,13 +53,13 @@
 }
 
 void
 Manager::do_update() {
   Canvas::refresh_std();
 
-  std::for_each(begin(), end(), std::mem_fun(&Window::redraw));
-  std::for_each(begin(), end(), std::mem_fun(&Window::refresh));
+  std::for_each(begin(), end(), func::if_then(std::mem_fun(&Window::is_active), std::mem_fun(&Window::redraw)));
+  std::for_each(begin(), end(), func::if_then(std::mem_fun(&Window::is_active), std::mem_fun(&Window::refresh)));
 
   Canvas::do_update();
 }
 
 }
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display: utils.cc
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display: utils.h
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window_download_list.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window_download_list.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window_download_list.cc	2005-02-09 06:03:50.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window_download_list.cc	2005-02-16 05:54:24.000000000 +0800
@@ -1,9 +1,10 @@
 #include "config.h"
 
 #include "canvas.h"
+#include "utils.h"
 #include "window_download_list.h"
 
 namespace display {
 
 WindowDownloadList::WindowDownloadList(DList* l, DList::iterator* f) :
   Window(new Canvas, true),
@@ -67,15 +68,13 @@
 		      itr == *m_focus ? '*' : ' ',
 		      (double)itr->get_download().get_bytes_total() / (double)(1 << 20),
 		      (double)itr->get_download().get_rate_up() / 1024.0,
 		      (double)itr->get_download().get_rate_down() / 1024.0,
 		      (double)itr->get_download().get_bytes_up() / (double)(1 << 20));
     
-    m_canvas->print(0, pos++, "%c Tracker: %s",
-		    itr == *m_focus ? '*' : ' ',
-		    itr->get_download().is_tracker_busy() ? "Connecting" : itr->get_tracker_msg().c_str());
+    m_canvas->print(0, pos++, "%c %s", itr == *m_focus ? '*' : ' ', print_download_status(&*itr).c_str());
 
     ++itr;
   }    
 }
 
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window_download_statusbar.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window_download_statusbar.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window_download_statusbar.cc	2005-02-13 02:53:30.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window_download_statusbar.cc	2005-02-16 05:56:14.000000000 +0800
@@ -1,9 +1,10 @@
 #include "config.h"
 
 #include "canvas.h"
+#include "utils.h"
 #include "window_download_statusbar.h"
 
 #include "core/download.h"
 
 namespace display {
 
@@ -40,13 +41,13 @@
 		  (int)m_download->get_download().get_peers_connected(),
 		  (int)m_download->get_download().get_peers_not_connected(),
 		  (int)m_download->get_download().get_peers_min(),
 		  (int)m_download->get_download().get_peers_max(),
 		  (int)m_download->get_download().get_uploads_max());
 
-  m_canvas->print(0, 2, "Tracker: [%c:%i] %s",
+  m_canvas->print(0, 2, "[%c:%i] %s",
 		  m_download->get_download().is_tracker_busy() ? 'C' : ' ',
 		  (int)(m_download->get_download().get_tracker_timeout() / 1000000),
-		  m_download->get_tracker_msg().c_str());
+		  print_download_status(m_download).c_str());
 }
 
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/display/window.h	2005-02-07 01:22:32.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/display/window.h	2005-02-17 04:16:44.000000000 +0800
@@ -7,34 +7,39 @@
 
 class Canvas;
 
 class Window {
 public:
   Window(Canvas* c = NULL, bool d = false, int h = 1) :
-    m_canvas(c), m_dynamic(d), m_minHeight(h) {}
+    m_canvas(c), m_active(true), m_dynamic(d), m_minHeight(h) {}
 
   virtual ~Window();
 
-  bool         is_dynamic()     { return m_dynamic; }
-  bool         is_dirty()       { return m_lastDraw == 0; }
+  bool         is_active()        { return m_active; }
+  bool         is_dynamic()       { return m_dynamic; }
+  bool         is_dirty()         { return m_lastDraw == 0; }
 
-  int          get_min_height() { return m_minHeight; }
+  int          get_min_height()   { return m_minHeight; }
+
+  bool         get_active()       { return m_active; }
+  void         set_active(bool a) { m_active = a; }
 
   void         refresh();
   void         resize(int x, int y, int w, int h);
 
-  void         mark_dirty()     { m_lastDraw = 0; }
+  void         mark_dirty()       { m_lastDraw = 0; }
 
   virtual void redraw() = 0;
 
 protected:
   Window(const Window&);
   void operator = (const Window&);
 
   Canvas*      m_canvas;
 
+  bool         m_active;
   bool         m_dynamic;
   int          m_minHeight;
 
   Timer        m_lastDraw;
 };
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/functional.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/functional.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/functional.h	2005-02-12 04:10:48.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/functional.h	2005-02-17 04:24:46.000000000 +0800
@@ -68,12 +67,32 @@
 template <typename Dest, typename Src>
 inline _on<Dest, Src>
 on(Dest d, Src s) {
   return _on<Dest, Src>(d, s);
 }  
 
+template <typename Cond, typename Then>
+struct _if_then {
+  _if_then(Cond c, Then t) : m_cond(c), m_then(t) {}
+
+  template <typename Arg>
+  void operator () (Arg& a) {
+    if (m_cond(a))
+      m_then(a);
+  }
+
+  Cond m_cond;
+  Then m_then;
+};
+
+template <typename Cond, typename Then>
+inline _if_then<Cond, Then>
+if_then(Cond c, Then t) {
+  return _if_then<Cond, Then>(c, t);
+}
+
 struct _call_delete
   : public std::unary_function<void, void> {
   
   template <typename Type>
   void operator () (Type* t) {
     delete t;
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/input/text_input.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/input/text_input.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/input/text_input.cc	2005-02-15 02:29:27.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/input/text_input.cc	2005-02-16 23:27:27.000000000 +0800
@@ -1,12 +1,12 @@
 #include "config.h"
 
+#include <sstream>
 #include <ncurses.h>
 
 #include "text_input.h"
-#include <sstream>
 
 namespace input {
 
 bool
 TextInput::pressed(int key) {
   //std::stringstream str;
@@ -29,12 +29,13 @@
 
   } else if (key >= 0x20 && key < 0x7F) {
     Base::insert(m_pos++, 1, key);
 
   } else {
     switch (key) {
+    case 0x08:
     case KEY_BACKSPACE:
       if (m_pos != 0)
 	Base::erase(--m_pos, 1);
 
       break;
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/main.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/main.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/main.cc	2005-02-15 01:58:23.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/main.cc	2005-02-17 03:39:27.000000000 +0800
@@ -11,20 +11,14 @@
 
 #ifdef USE_EXECINFO
 #include <execinfo.h>
 #endif
 
 #include "display/canvas.h"
-
-#include "core/poll.h"
-#include "core/curl_stack.h"
-#include "core/manager.h"
-
 #include "ui/control.h"
 #include "ui/download_list.h"
-
 #include "input/bindings.h"
 
 #include "timer.h"
 #include "signal_handler.h"
 
 int64_t Timer::m_cache;
@@ -29,15 +23,12 @@
 
 int64_t Timer::m_cache;
 
 bool start_shutdown = false;
 bool is_shutting_down = false;
 
-core::Poll poll;
-core::Manager coreManager;
-
 bool
 is_resized() {
   static int x = 0;
   static int y = 0;
   
   bool r = display::Canvas::get_screen_width() != x || display::Canvas::get_screen_height() != y;
@@ -51,25 +42,28 @@
 void
 set_shutdown() {
   start_shutdown = true;
 }
 
 void
-do_shutdown() {
-  if (is_shutting_down)
-    // Be quick about it...
-    return;
-
-  is_shutting_down = true;
-
-  torrent::listen_close();
+do_shutdown(ui::Control* c) {
+  if (!is_shutting_down) {
+    is_shutting_down = true;
+
+    torrent::listen_close();
+
+    std::for_each(c->get_core().get_download_list().begin(), c->get_core().get_download_list().end(),
+		  std::mem_fun_ref(&core::Download::stop));
+
+  } else {
+    // Close all torrents, this will stop all tracker connections and cause
+    // a quick shutdown.
+    std::for_each(c->get_core().get_download_list().begin(), c->get_core().get_download_list().end(),
+		  std::mem_fun_ref(&core::Download::close));
 
-  // TODO: Set display to a safe mode.
-
-  std::for_each(coreManager.get_download_list().begin(), coreManager.get_download_list().end(),
-		std::mem_fun_ref(&core::Download::stop));
+  }
 }
 
 void
 do_panic(int signum) {
   display::Canvas::cleanup();
 
@@ -94,65 +88,61 @@
   
   exit(-1);
 }
 
 int
 main(int argc, char** argv) {
+  ui::Control uiControl;
+
   try {
 
   SignalHandler::set_handler(SIGINT, sigc::ptr_fun(&set_shutdown));
   SignalHandler::set_handler(SIGSEGV, sigc::bind(sigc::ptr_fun(&do_panic), SIGSEGV));
   SignalHandler::set_handler(SIGBUS, sigc::bind(sigc::ptr_fun(&do_panic), SIGBUS));
 
   display::Canvas::init();
-  core::CurlStack::init();
 
-  ui::Control uiControl;
-  ui::DownloadList uiDownloadList(&coreManager.get_download_list(), &uiControl);
+  ui::DownloadList uiDownloadList(&uiControl);
 
   uiDownloadList.activate();
-  uiDownloadList.slot_open_uri(sigc::mem_fun(coreManager, &core::Manager::insert));
+  uiDownloadList.slot_open_uri(sigc::mem_fun(uiControl.get_core(), &core::Manager::insert));
 
   // Register main key events.
   input::Bindings inputMain;
   uiControl.get_input().push_back(&inputMain);
 
   inputMain[KEY_RESIZE] = sigc::mem_fun(uiControl.get_display(), &display::Manager::adjust_layout);
+  inputMain['\x11'] = sigc::ptr_fun(&set_shutdown);
 
-  poll.slot_read_stdin(sigc::mem_fun(uiControl.get_input(), &input::Manager::pressed));
-  poll.slot_select_interrupted(sigc::ptr_fun(display::Canvas::do_update));
-
-  torrent::Http::set_factory(poll.get_http_factory());
-  coreManager.get_http_queue().slot_factory(poll.get_http_factory());
+  uiControl.get_core().get_poll().slot_read_stdin(sigc::mem_fun(uiControl.get_input(), &input::Manager::pressed));
+  uiControl.get_core().get_poll().slot_select_interrupted(sigc::ptr_fun(display::Canvas::do_update));
 
-  torrent::initialize();
-  torrent::listen_open(10000, 20000);
+  uiControl.get_core().initialize();
 
   for (int i = 1; i < argc; ++i)
-    coreManager.insert(argv[i]);
+    uiControl.get_core().insert(argv[i]);
 
   uiControl.get_display().adjust_layout();
 
   while (!is_shutting_down || !torrent::get(torrent::SHUTDOWN_DONE)) {
     if (start_shutdown && !is_shutting_down)
-      do_shutdown();
+      do_shutdown(&uiControl);
 
     Timer::update();
 
     uiControl.get_display().do_update();
 
-    poll.poll();
+    uiControl.get_core().get_poll().poll();
   }
 
   display::Canvas::cleanup();
 
   } catch (std::exception& e) {
     display::Canvas::cleanup();
 
     std::cout << "Caught exception: \"" << e.what() << '"' << std::endl;
   }
 
-  torrent::cleanup();
-  core::CurlStack::cleanup();
+  uiControl.get_core().cleanup();
 
   return 0;
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/control.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/control.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/control.h	2005-02-08 05:13:26.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/control.h	2005-02-16 04:53:03.000000000 +0800
@@ -1,25 +1,28 @@
 #ifndef RTORRENT_UI_CONTROL_H
 #define RTORRENT_UI_CONTROL_H
 
+#include "core/manager.h"
 #include "display/manager.h"
 #include "input/manager.h"
 
 namespace ui {
 
 class Control {
 public:
   Control() {}
   
+  core::Manager&    get_core()    { return m_core; }
   display::Manager& get_display() { return m_display; }
   input::Manager&   get_input()   { return m_input; }
 
 private:
   Control(const Control&);
   void operator = (const Control&);
 
+  core::Manager     m_core;
   display::Manager  m_display;
   input::Manager    m_input;
 };
 
 }
 
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/download_list.cc /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/download_list.cc
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/download_list.cc	2005-02-15 01:57:12.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/download_list.cc	2005-02-17 04:30:54.000000000 +0800
@@ -14,80 +14,114 @@
 #include "control.h"
 #include "download.h"
 #include "download_list.h"
 
 namespace ui {
 
-DownloadList::DownloadList(core::DownloadList* l, Control* c) :
+DownloadList::DownloadList(Control* c) :
   m_title(new WTitle("rtorrent " VERSION " - " + torrent::get(torrent::LIBRARY_NAME))),
   m_status(new WStatus),
+  m_textInput(new WInput(new input::TextInput)),
   m_download(NULL),
-  m_list(l),
-  m_focus(l->end()),
+  m_focus(c->get_core().get_download_list().end()),
   m_control(c),
-  m_bindings(new input::Bindings),
-  m_windowInput(new WInput(new input::TextInput)) {
+  m_bindings(new input::Bindings) {
 
-  m_window = new WList(m_list, &m_focus);
+  m_window = new WList(&m_control->get_core().get_download_list(), &m_focus);
 
   bind_keys(m_bindings);
 
-  m_windowInput->get_input()->slot_dirty(sigc::mem_fun(*m_windowInput, &WInput::mark_dirty));
+  m_textInput->get_input()->slot_dirty(sigc::mem_fun(*m_textInput, &WInput::mark_dirty));
 }
 
 DownloadList::~DownloadList() {
   delete m_window;
   delete m_title;
   delete m_status;
   delete m_bindings;
 
-  delete m_windowInput->get_input();
-  delete m_windowInput;
+  delete m_textInput->get_input();
+  delete m_textInput;
 }
 
 void
 DownloadList::activate() {
-  m_control->get_display().push_back(m_windowInput);
+  m_textInput->set_active(false);
+
+  m_control->get_input().push_front(m_bindings);
+
+  m_control->get_display().push_back(m_textInput);
   m_control->get_display().push_back(m_status);
   m_control->get_display().push_front(m_window);
   m_control->get_display().push_front(m_title);
-  m_control->get_input().push_front(m_bindings);
 }
 
 void
 DownloadList::disable() {
-  m_control->get_display().erase(m_windowInput);
+  if (m_textInput->is_active()) {
+    m_textInput->get_input()->clear();
+    receive_exit_input();
+  }
+
+  m_control->get_input().erase(m_bindings);
+
   m_control->get_display().erase(m_title);
   m_control->get_display().erase(m_window);
   m_control->get_display().erase(m_status);
-  m_control->get_input().erase(m_bindings);
+  m_control->get_display().erase(m_textInput);
 }
 
 void
 DownloadList::receive_next() {
-  if (m_focus != m_list->end())
+  if (m_focus != m_control->get_core().get_download_list().end())
     ++m_focus;
   else
-    m_focus = m_list->begin();
+    m_focus = m_control->get_core().get_download_list().begin();
 
   mark_dirty();
 }
 
 void
 DownloadList::receive_prev() {
-  if (m_focus != m_list->begin())
+  if (m_focus != m_control->get_core().get_download_list().begin())
     --m_focus;
   else
-    m_focus = m_list->end();
+    m_focus = m_control->get_core().get_download_list().end();
 
   mark_dirty();
 }
 
 void
+DownloadList::receive_throttle(int t) {
+  m_status->mark_dirty();
+
+  torrent::set(torrent::THROTTLE_ROOT_CONST_RATE, torrent::get(torrent::THROTTLE_ROOT_CONST_RATE) + t * 1024);
+}
+
+void
+DownloadList::receive_start_download() {
+  if (m_focus == m_control->get_core().get_download_list().end())
+    return;
+
+  m_control->get_core().start(&*m_focus);
+}
+
+void
+DownloadList::receive_stop_download() {
+  if (m_focus == m_control->get_core().get_download_list().end())
+    return;
+
+  if (m_focus->get_download().is_active())
+    m_control->get_core().stop(&*m_focus);
+  else
+    m_control->get_core().erase(m_focus);
+}
+
+void
 DownloadList::receive_view_download() {
-  if (m_focus == m_list->end())
+  if (m_focus == m_control->get_core().get_download_list().end())
     return;
 
   if (m_download != NULL)
     throw std::logic_error("DownloadList::receive_view_download() called but m_download != NULL");
 
   disable();
@@ -110,36 +144,37 @@
   activate();
 
   m_control->get_display().adjust_layout();
 }
 
 void
-DownloadList::receive_throttle(int t) {
-  m_status->mark_dirty();
-
-  torrent::set(torrent::THROTTLE_ROOT_CONST_RATE, torrent::get(torrent::THROTTLE_ROOT_CONST_RATE) + t * 1024);
-}
-
-void
 DownloadList::receive_view_input() {
-  m_control->get_input().set_text_input(m_windowInput->get_input());
+  m_status->set_active(false);
+  m_textInput->set_active(true);
+  m_control->get_display().adjust_layout();
 
-  m_windowInput->set_focus(true);
+  m_control->get_input().set_text_input(m_textInput->get_input());
+
+  m_textInput->set_focus(true);
 
   (*m_bindings)['\n'] = sigc::mem_fun(*this, &DownloadList::receive_exit_input);
   (*m_bindings)[KEY_ENTER] = sigc::mem_fun(*this, &DownloadList::receive_exit_input);
 }
 
 void
 DownloadList::receive_exit_input() {
+  m_status->set_active(true);
+  m_textInput->set_active(false);
+  m_control->get_display().adjust_layout();
+
   m_control->get_input().set_text_input();
 
-  m_slotOpenUri(m_windowInput->get_input()->str());
+  m_slotOpenUri(m_textInput->get_input()->str());
 
-  m_windowInput->get_input()->clear();
-  m_windowInput->set_focus(false);
+  m_textInput->get_input()->clear();
+  m_textInput->set_focus(false);
 
   m_bindings->erase('\n');
   m_bindings->erase(KEY_ENTER);
 }
 
 void
@@ -148,12 +183,15 @@
   (*b)['z'] = sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_throttle), -1);
   (*b)['s'] = sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_throttle), 5);
   (*b)['x'] = sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_throttle), -5);
   (*b)['d'] = sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_throttle), 50);
   (*b)['c'] = sigc::bind(sigc::mem_fun(*this, &DownloadList::receive_throttle), -50);
 
+  (*b)['\x13'] = sigc::mem_fun(*this, &DownloadList::receive_start_download);
+  (*b)['\x04'] = sigc::mem_fun(*this, &DownloadList::receive_stop_download);
+
   (*b)[KEY_UP]    = sigc::mem_fun(*this, &DownloadList::receive_prev);
   (*b)[KEY_DOWN]  = sigc::mem_fun(*this, &DownloadList::receive_next);
   (*b)[KEY_RIGHT] = sigc::mem_fun(*this, &DownloadList::receive_view_download);
 
   (*b)[KEY_BACKSPACE] = sigc::mem_fun(*this, &DownloadList::receive_view_input);
 }
diff -BEr -U 6 /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/download_list.h /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/download_list.h
--- /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.1/src/ui/download_list.h	2005-02-15 01:54:45.000000000 +0800
+++ /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2/src/ui/download_list.h	2005-02-17 03:54:23.000000000 +0800
@@ -23,13 +23,13 @@
   typedef display::WindowInput                  WInput;
   typedef core::DownloadList                    DList;
 
   typedef sigc::slot1<void, const std::string&> SlotOpenUri;
 
   // We own 'window'.
-  DownloadList(DList* l, Control* c);
+  DownloadList(Control* c);
   ~DownloadList();
 
   WList&           get_window()                 { return *m_window; }
   input::Bindings& get_bindings()               { return *m_bindings; }
 
   void             activate();
@@ -41,39 +41,40 @@
   DownloadList(const DownloadList&);
   void operator = (const DownloadList&);
 
   void             receive_next();
   void             receive_prev();
 
+  void             receive_throttle(int t);
+
+  void             receive_start_download();
+  void             receive_stop_download();
+
   void             receive_view_download();
   void             receive_exit_download();
 
-  void             receive_throttle(int t);
-
   void             receive_view_input();
   void             receive_exit_input();
 
   void             bind_keys(input::Bindings* b);
 
   void             mark_dirty();
 
   WList*           m_window;
   WTitle*          m_title;
   WStatus*         m_status;
+  WInput*          m_textInput;
 
   Download*        m_download;
 
   DList*           m_list;
   DList::iterator  m_focus;
 
   Control*         m_control;
   input::Bindings* m_bindings;
 
   SlotOpenUri      m_slotOpenUri;
-
-  // Test
-  WInput*          m_windowInput;
 };
 
 }
 
 #endif
Only in /usr/info/code/cpp/LogMonitor/LogMonitor/second/download/rtorrent/repos/rtorrent-0.0.2: TODO
