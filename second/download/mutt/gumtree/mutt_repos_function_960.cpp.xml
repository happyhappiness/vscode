<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/mutt/gumtree/mutt_repos_function_960.cpp" pos:tabs="8"><function><specifier pos:line="1" pos:column="1">static<pos:position pos:line="1" pos:column="7"/></specifier> <type><name pos:line="1" pos:column="8">int<pos:position pos:line="1" pos:column="11"/></name></type> <name pos:line="1" pos:column="12">tls_check_preauth<pos:position pos:line="1" pos:column="29"/></name> <parameter_list pos:line="1" pos:column="30">(<parameter><decl><type><specifier pos:line="1" pos:column="31">const<pos:position pos:line="1" pos:column="36"/></specifier> <name pos:line="1" pos:column="37">gnutls_datum_t<pos:position pos:line="1" pos:column="51"/></name> <modifier pos:line="1" pos:column="52">*<pos:position pos:line="1" pos:column="53"/></modifier></type><name pos:line="1" pos:column="53">certdata<pos:position pos:line="1" pos:column="61"/></name></decl></parameter>,
                              <parameter><decl><type><name pos:line="2" pos:column="31">gnutls_certificate_status_t<pos:position pos:line="2" pos:column="58"/></name></type> <name pos:line="2" pos:column="59">certstat<pos:position pos:line="2" pos:column="67"/></name></decl></parameter>,
                              <parameter><decl><type><specifier pos:line="3" pos:column="31">const<pos:position pos:line="3" pos:column="36"/></specifier> <name pos:line="3" pos:column="37">char<pos:position pos:line="3" pos:column="41"/></name> <modifier pos:line="3" pos:column="42">*<pos:position pos:line="3" pos:column="43"/></modifier></type><name pos:line="3" pos:column="43">hostname<pos:position pos:line="3" pos:column="51"/></name></decl></parameter>, <parameter><decl><type><name pos:line="3" pos:column="53">int<pos:position pos:line="3" pos:column="56"/></name></type> <name pos:line="3" pos:column="57">chainidx<pos:position pos:line="3" pos:column="65"/></name></decl></parameter>, <parameter><decl><type><name pos:line="3" pos:column="67">int<pos:position pos:line="3" pos:column="70"/></name><modifier pos:line="3" pos:column="70">*<pos:position pos:line="3" pos:column="71"/></modifier></type> <name pos:line="3" pos:column="72">certerr<pos:position pos:line="3" pos:column="79"/></name></decl></parameter>,
                              <parameter><decl><type><name pos:line="4" pos:column="31">int<pos:position pos:line="4" pos:column="34"/></name><modifier pos:line="4" pos:column="34">*<pos:position pos:line="4" pos:column="35"/></modifier></type> <name pos:line="4" pos:column="36">savedcert<pos:position pos:line="4" pos:column="45"/></name></decl></parameter>)<pos:position pos:line="4" pos:column="46"/></parameter_list>
<block pos:line="5" pos:column="1">{
  <decl_stmt><decl><type><name pos:line="6" pos:column="3">gnutls_x509_crt_t<pos:position pos:line="6" pos:column="20"/></name></type> <name pos:line="6" pos:column="21">cert<pos:position pos:line="6" pos:column="25"/></name></decl>;<pos:position pos:line="6" pos:column="26"/></decl_stmt>

  <expr_stmt><expr><operator pos:line="8" pos:column="3">*<pos:position pos:line="8" pos:column="4"/></operator><name pos:line="8" pos:column="4">certerr<pos:position pos:line="8" pos:column="11"/></name> <operator pos:line="8" pos:column="12">=<pos:position pos:line="8" pos:column="13"/></operator> <name pos:line="8" pos:column="14">CERTERR_VALID<pos:position pos:line="8" pos:column="27"/></name></expr>;<pos:position pos:line="8" pos:column="28"/></expr_stmt>
  <expr_stmt><expr><operator pos:line="9" pos:column="3">*<pos:position pos:line="9" pos:column="4"/></operator><name pos:line="9" pos:column="4">savedcert<pos:position pos:line="9" pos:column="13"/></name> <operator pos:line="9" pos:column="14">=<pos:position pos:line="9" pos:column="15"/></operator> <literal type="number" pos:line="9" pos:column="16">0<pos:position pos:line="9" pos:column="17"/></literal></expr>;<pos:position pos:line="9" pos:column="18"/></expr_stmt>

  <if pos:line="11" pos:column="3">if <condition pos:line="11" pos:column="6">(<expr><call><name pos:line="11" pos:column="7">gnutls_x509_crt_init<pos:position pos:line="11" pos:column="27"/></name> <argument_list pos:line="11" pos:column="28">(<argument><expr><operator pos:line="11" pos:column="29">&amp;<pos:position pos:line="11" pos:column="34"/></operator><name pos:line="11" pos:column="30">cert<pos:position pos:line="11" pos:column="34"/></name></expr></argument>)<pos:position pos:line="11" pos:column="35"/></argument_list></call> <operator pos:line="11" pos:column="36">&lt;<pos:position pos:line="11" pos:column="40"/></operator> <literal type="number" pos:line="11" pos:column="38">0<pos:position pos:line="11" pos:column="39"/></literal></expr>)<pos:position pos:line="11" pos:column="40"/></condition><then pos:line="11" pos:column="40">
  <block pos:line="12" pos:column="3">{
    <expr_stmt><expr><call><name pos:line="13" pos:column="5">mutt_error<pos:position pos:line="13" pos:column="15"/></name> <argument_list pos:line="13" pos:column="16">(<argument><expr><call><name pos:line="13" pos:column="17">_<pos:position pos:line="13" pos:column="18"/></name><argument_list pos:line="13" pos:column="18">(<argument><expr><literal type="string" pos:line="13" pos:column="19">"Error initialising gnutls certificate data"<pos:position pos:line="13" pos:column="63"/></literal></expr></argument>)<pos:position pos:line="13" pos:column="64"/></argument_list></call></expr></argument>)<pos:position pos:line="13" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="13" pos:column="66"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="14" pos:column="5">mutt_sleep<pos:position pos:line="14" pos:column="15"/></name> <argument_list pos:line="14" pos:column="16">(<argument><expr><literal type="number" pos:line="14" pos:column="17">2<pos:position pos:line="14" pos:column="18"/></literal></expr></argument>)<pos:position pos:line="14" pos:column="19"/></argument_list></call></expr>;<pos:position pos:line="14" pos:column="20"/></expr_stmt>
    <return pos:line="15" pos:column="5">return <expr><operator pos:line="15" pos:column="12">-<pos:position pos:line="15" pos:column="13"/></operator><literal type="number" pos:line="15" pos:column="13">1<pos:position pos:line="15" pos:column="14"/></literal></expr>;<pos:position pos:line="15" pos:column="15"/></return>
  }<pos:position pos:line="16" pos:column="4"/></block></then></if>

  <if pos:line="18" pos:column="3">if <condition pos:line="18" pos:column="6">(<expr><call><name pos:line="18" pos:column="7">gnutls_x509_crt_import<pos:position pos:line="18" pos:column="29"/></name> <argument_list pos:line="18" pos:column="30">(<argument><expr><name pos:line="18" pos:column="31">cert<pos:position pos:line="18" pos:column="35"/></name></expr></argument>, <argument><expr><name pos:line="18" pos:column="37">certdata<pos:position pos:line="18" pos:column="45"/></name></expr></argument>, <argument><expr><name pos:line="18" pos:column="47">GNUTLS_X509_FMT_DER<pos:position pos:line="18" pos:column="66"/></name></expr></argument>)<pos:position pos:line="18" pos:column="67"/></argument_list></call> <operator pos:line="18" pos:column="68">&lt;<pos:position pos:line="18" pos:column="72"/></operator> <literal type="number" pos:line="18" pos:column="70">0<pos:position pos:line="18" pos:column="71"/></literal></expr>)<pos:position pos:line="18" pos:column="72"/></condition><then pos:line="18" pos:column="72">
  <block pos:line="19" pos:column="3">{
    <expr_stmt><expr><call><name pos:line="20" pos:column="5">mutt_error<pos:position pos:line="20" pos:column="15"/></name> <argument_list pos:line="20" pos:column="16">(<argument><expr><call><name pos:line="20" pos:column="17">_<pos:position pos:line="20" pos:column="18"/></name><argument_list pos:line="20" pos:column="18">(<argument><expr><literal type="string" pos:line="20" pos:column="19">"Error processing certificate data"<pos:position pos:line="20" pos:column="54"/></literal></expr></argument>)<pos:position pos:line="20" pos:column="55"/></argument_list></call></expr></argument>)<pos:position pos:line="20" pos:column="56"/></argument_list></call></expr>;<pos:position pos:line="20" pos:column="57"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="21" pos:column="5">mutt_sleep<pos:position pos:line="21" pos:column="15"/></name> <argument_list pos:line="21" pos:column="16">(<argument><expr><literal type="number" pos:line="21" pos:column="17">2<pos:position pos:line="21" pos:column="18"/></literal></expr></argument>)<pos:position pos:line="21" pos:column="19"/></argument_list></call></expr>;<pos:position pos:line="21" pos:column="20"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="22" pos:column="5">gnutls_x509_crt_deinit<pos:position pos:line="22" pos:column="27"/></name> <argument_list pos:line="22" pos:column="28">(<argument><expr><name pos:line="22" pos:column="29">cert<pos:position pos:line="22" pos:column="33"/></name></expr></argument>)<pos:position pos:line="22" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="22" pos:column="35"/></expr_stmt>
    <return pos:line="23" pos:column="5">return <expr><operator pos:line="23" pos:column="12">-<pos:position pos:line="23" pos:column="13"/></operator><literal type="number" pos:line="23" pos:column="13">1<pos:position pos:line="23" pos:column="14"/></literal></expr>;<pos:position pos:line="23" pos:column="15"/></return>
  }<pos:position pos:line="24" pos:column="4"/></block></then></if>

  <if pos:line="26" pos:column="3">if <condition pos:line="26" pos:column="6">(<expr><call><name pos:line="26" pos:column="7">option<pos:position pos:line="26" pos:column="13"/></name> <argument_list pos:line="26" pos:column="14">(<argument><expr><name pos:line="26" pos:column="15">OPTSSLVERIFYDATES<pos:position pos:line="26" pos:column="32"/></name></expr></argument>)<pos:position pos:line="26" pos:column="33"/></argument_list></call> <operator pos:line="26" pos:column="34">!=<pos:position pos:line="26" pos:column="36"/></operator> <name pos:line="26" pos:column="37">MUTT_NO<pos:position pos:line="26" pos:column="44"/></name></expr>)<pos:position pos:line="26" pos:column="45"/></condition><then pos:line="26" pos:column="45">
  <block pos:line="27" pos:column="3">{
    <if pos:line="28" pos:column="5">if <condition pos:line="28" pos:column="8">(<expr><call><name pos:line="28" pos:column="9">gnutls_x509_crt_get_expiration_time<pos:position pos:line="28" pos:column="44"/></name> <argument_list pos:line="28" pos:column="45">(<argument><expr><name pos:line="28" pos:column="46">cert<pos:position pos:line="28" pos:column="50"/></name></expr></argument>)<pos:position pos:line="28" pos:column="51"/></argument_list></call> <operator pos:line="28" pos:column="52">&lt;<pos:position pos:line="28" pos:column="56"/></operator> <call><name pos:line="28" pos:column="54">time<pos:position pos:line="28" pos:column="58"/></name><argument_list pos:line="28" pos:column="58">(<argument><expr><name pos:line="28" pos:column="59">NULL<pos:position pos:line="28" pos:column="63"/></name></expr></argument>)<pos:position pos:line="28" pos:column="64"/></argument_list></call></expr>)<pos:position pos:line="28" pos:column="65"/></condition><then pos:line="28" pos:column="65">
      <block type="pseudo"><expr_stmt><expr><operator pos:line="29" pos:column="7">*<pos:position pos:line="29" pos:column="8"/></operator><name pos:line="29" pos:column="8">certerr<pos:position pos:line="29" pos:column="15"/></name> <operator pos:line="29" pos:column="16">|=<pos:position pos:line="29" pos:column="18"/></operator> <name pos:line="29" pos:column="19">CERTERR_EXPIRED<pos:position pos:line="29" pos:column="34"/></name></expr>;<pos:position pos:line="29" pos:column="35"/></expr_stmt></block></then></if>
    <if pos:line="30" pos:column="5">if <condition pos:line="30" pos:column="8">(<expr><call><name pos:line="30" pos:column="9">gnutls_x509_crt_get_activation_time<pos:position pos:line="30" pos:column="44"/></name> <argument_list pos:line="30" pos:column="45">(<argument><expr><name pos:line="30" pos:column="46">cert<pos:position pos:line="30" pos:column="50"/></name></expr></argument>)<pos:position pos:line="30" pos:column="51"/></argument_list></call> <operator pos:line="30" pos:column="52">&gt;<pos:position pos:line="30" pos:column="56"/></operator> <call><name pos:line="30" pos:column="54">time<pos:position pos:line="30" pos:column="58"/></name><argument_list pos:line="30" pos:column="58">(<argument><expr><name pos:line="30" pos:column="59">NULL<pos:position pos:line="30" pos:column="63"/></name></expr></argument>)<pos:position pos:line="30" pos:column="64"/></argument_list></call></expr>)<pos:position pos:line="30" pos:column="65"/></condition><then pos:line="30" pos:column="65">
      <block type="pseudo"><expr_stmt><expr><operator pos:line="31" pos:column="7">*<pos:position pos:line="31" pos:column="8"/></operator><name pos:line="31" pos:column="8">certerr<pos:position pos:line="31" pos:column="15"/></name> <operator pos:line="31" pos:column="16">|=<pos:position pos:line="31" pos:column="18"/></operator> <name pos:line="31" pos:column="19">CERTERR_NOTYETVALID<pos:position pos:line="31" pos:column="38"/></name></expr>;<pos:position pos:line="31" pos:column="39"/></expr_stmt></block></then></if>
  }<pos:position pos:line="32" pos:column="4"/></block></then></if>

  <if pos:line="34" pos:column="3">if <condition pos:line="34" pos:column="6">(<expr><name pos:line="34" pos:column="7">chainidx<pos:position pos:line="34" pos:column="15"/></name> <operator pos:line="34" pos:column="16">==<pos:position pos:line="34" pos:column="18"/></operator> <literal type="number" pos:line="34" pos:column="19">0<pos:position pos:line="34" pos:column="20"/></literal> <operator pos:line="34" pos:column="21">&amp;&amp;<pos:position pos:line="34" pos:column="31"/></operator> <call><name pos:line="34" pos:column="24">option<pos:position pos:line="34" pos:column="30"/></name> <argument_list pos:line="34" pos:column="31">(<argument><expr><name pos:line="34" pos:column="32">OPTSSLVERIFYHOST<pos:position pos:line="34" pos:column="48"/></name></expr></argument>)<pos:position pos:line="34" pos:column="49"/></argument_list></call> <operator pos:line="34" pos:column="50">!=<pos:position pos:line="34" pos:column="52"/></operator> <name pos:line="34" pos:column="53">MUTT_NO<pos:position pos:line="34" pos:column="60"/></name>
      <operator pos:line="35" pos:column="7">&amp;&amp;<pos:position pos:line="35" pos:column="17"/></operator> <operator pos:line="35" pos:column="10">!<pos:position pos:line="35" pos:column="11"/></operator><call><name pos:line="35" pos:column="11">gnutls_x509_crt_check_hostname<pos:position pos:line="35" pos:column="41"/></name> <argument_list pos:line="35" pos:column="42">(<argument><expr><name pos:line="35" pos:column="43">cert<pos:position pos:line="35" pos:column="47"/></name></expr></argument>, <argument><expr><name pos:line="35" pos:column="49">hostname<pos:position pos:line="35" pos:column="57"/></name></expr></argument>)<pos:position pos:line="35" pos:column="58"/></argument_list></call>
      <operator pos:line="36" pos:column="7">&amp;&amp;<pos:position pos:line="36" pos:column="17"/></operator> <operator pos:line="36" pos:column="10">!<pos:position pos:line="36" pos:column="11"/></operator><call><name pos:line="36" pos:column="11">tls_check_stored_hostname<pos:position pos:line="36" pos:column="36"/></name> <argument_list pos:line="36" pos:column="37">(<argument><expr><name pos:line="36" pos:column="38">certdata<pos:position pos:line="36" pos:column="46"/></name></expr></argument>, <argument><expr><name pos:line="36" pos:column="48">hostname<pos:position pos:line="36" pos:column="56"/></name></expr></argument>)<pos:position pos:line="36" pos:column="57"/></argument_list></call></expr>)<pos:position pos:line="36" pos:column="58"/></condition><then pos:line="36" pos:column="58">
    <block type="pseudo"><expr_stmt><expr><operator pos:line="37" pos:column="5">*<pos:position pos:line="37" pos:column="6"/></operator><name pos:line="37" pos:column="6">certerr<pos:position pos:line="37" pos:column="13"/></name> <operator pos:line="37" pos:column="14">|=<pos:position pos:line="37" pos:column="16"/></operator> <name pos:line="37" pos:column="17">CERTERR_HOSTNAME<pos:position pos:line="37" pos:column="33"/></name></expr>;<pos:position pos:line="37" pos:column="34"/></expr_stmt></block></then></if>

  <comment type="block" pos:line="39" pos:column="3">/* see whether certificate is in our cache (certificates file) */</comment>
  <if pos:line="40" pos:column="3">if <condition pos:line="40" pos:column="6">(<expr><call><name pos:line="40" pos:column="7">tls_compare_certificates<pos:position pos:line="40" pos:column="31"/></name> <argument_list pos:line="40" pos:column="32">(<argument><expr><name pos:line="40" pos:column="33">certdata<pos:position pos:line="40" pos:column="41"/></name></expr></argument>)<pos:position pos:line="40" pos:column="42"/></argument_list></call></expr>)<pos:position pos:line="40" pos:column="43"/></condition><then pos:line="40" pos:column="43">
  <block pos:line="41" pos:column="3">{
    <expr_stmt><expr><operator pos:line="42" pos:column="5">*<pos:position pos:line="42" pos:column="6"/></operator><name pos:line="42" pos:column="6">savedcert<pos:position pos:line="42" pos:column="15"/></name> <operator pos:line="42" pos:column="16">=<pos:position pos:line="42" pos:column="17"/></operator> <literal type="number" pos:line="42" pos:column="18">1<pos:position pos:line="42" pos:column="19"/></literal></expr>;<pos:position pos:line="42" pos:column="20"/></expr_stmt>

    <if pos:line="44" pos:column="5">if <condition pos:line="44" pos:column="8">(<expr><name pos:line="44" pos:column="9">chainidx<pos:position pos:line="44" pos:column="17"/></name> <operator pos:line="44" pos:column="18">==<pos:position pos:line="44" pos:column="20"/></operator> <literal type="number" pos:line="44" pos:column="21">0<pos:position pos:line="44" pos:column="22"/></literal> <operator pos:line="44" pos:column="23">&amp;&amp;<pos:position pos:line="44" pos:column="33"/></operator> <operator pos:line="44" pos:column="26">(<pos:position pos:line="44" pos:column="27"/></operator><name pos:line="44" pos:column="27">certstat<pos:position pos:line="44" pos:column="35"/></name> <operator pos:line="44" pos:column="36">&amp;<pos:position pos:line="44" pos:column="41"/></operator> <name pos:line="44" pos:column="38">GNUTLS_CERT_INVALID<pos:position pos:line="44" pos:column="57"/></name><operator pos:line="44" pos:column="57">)<pos:position pos:line="44" pos:column="58"/></operator></expr>)<pos:position pos:line="44" pos:column="59"/></condition><then pos:line="44" pos:column="59">
    <block pos:line="45" pos:column="5">{
      <comment type="block" pos:line="46" pos:column="7">/* doesn't matter - have decided is valid because server
       certificate is in our trusted cache */</comment>
      <expr_stmt><expr><name pos:line="48" pos:column="7">certstat<pos:position pos:line="48" pos:column="15"/></name> <operator pos:line="48" pos:column="16">^=<pos:position pos:line="48" pos:column="18"/></operator> <name pos:line="48" pos:column="19">GNUTLS_CERT_INVALID<pos:position pos:line="48" pos:column="38"/></name></expr>;<pos:position pos:line="48" pos:column="39"/></expr_stmt>
    }<pos:position pos:line="49" pos:column="6"/></block></then></if>

    <if pos:line="51" pos:column="5">if <condition pos:line="51" pos:column="8">(<expr><name pos:line="51" pos:column="9">chainidx<pos:position pos:line="51" pos:column="17"/></name> <operator pos:line="51" pos:column="18">==<pos:position pos:line="51" pos:column="20"/></operator> <literal type="number" pos:line="51" pos:column="21">0<pos:position pos:line="51" pos:column="22"/></literal> <operator pos:line="51" pos:column="23">&amp;&amp;<pos:position pos:line="51" pos:column="33"/></operator> <operator pos:line="51" pos:column="26">(<pos:position pos:line="51" pos:column="27"/></operator><name pos:line="51" pos:column="27">certstat<pos:position pos:line="51" pos:column="35"/></name> <operator pos:line="51" pos:column="36">&amp;<pos:position pos:line="51" pos:column="41"/></operator> <name pos:line="51" pos:column="38">GNUTLS_CERT_SIGNER_NOT_FOUND<pos:position pos:line="51" pos:column="66"/></name><operator pos:line="51" pos:column="66">)<pos:position pos:line="51" pos:column="67"/></operator></expr>)<pos:position pos:line="51" pos:column="68"/></condition><then pos:line="51" pos:column="68">
    <block pos:line="52" pos:column="5">{
      <comment type="block" pos:line="53" pos:column="7">/* doesn't matter that we haven't found the signer, since
       certificate is in our trusted cache */</comment>
      <expr_stmt><expr><name pos:line="55" pos:column="7">certstat<pos:position pos:line="55" pos:column="15"/></name> <operator pos:line="55" pos:column="16">^=<pos:position pos:line="55" pos:column="18"/></operator> <name pos:line="55" pos:column="19">GNUTLS_CERT_SIGNER_NOT_FOUND<pos:position pos:line="55" pos:column="47"/></name></expr>;<pos:position pos:line="55" pos:column="48"/></expr_stmt>
    }<pos:position pos:line="56" pos:column="6"/></block></then></if>

    <if pos:line="58" pos:column="5">if <condition pos:line="58" pos:column="8">(<expr><name pos:line="58" pos:column="9">chainidx<pos:position pos:line="58" pos:column="17"/></name> <operator pos:line="58" pos:column="18">&lt;=<pos:position pos:line="58" pos:column="23"/></operator> <literal type="number" pos:line="58" pos:column="21">1<pos:position pos:line="58" pos:column="22"/></literal> <operator pos:line="58" pos:column="23">&amp;&amp;<pos:position pos:line="58" pos:column="33"/></operator> <operator pos:line="58" pos:column="26">(<pos:position pos:line="58" pos:column="27"/></operator><name pos:line="58" pos:column="27">certstat<pos:position pos:line="58" pos:column="35"/></name> <operator pos:line="58" pos:column="36">&amp;<pos:position pos:line="58" pos:column="41"/></operator> <name pos:line="58" pos:column="38">GNUTLS_CERT_SIGNER_NOT_CA<pos:position pos:line="58" pos:column="63"/></name><operator pos:line="58" pos:column="63">)<pos:position pos:line="58" pos:column="64"/></operator></expr>)<pos:position pos:line="58" pos:column="65"/></condition><then pos:line="58" pos:column="65">
    <block pos:line="59" pos:column="5">{
      <comment type="block" pos:line="60" pos:column="7">/* Hmm. Not really sure how to handle this, but let's say
       that we don't care if the CA certificate hasn't got the
       correct X.509 basic constraints if server or first signer
       certificate is in our cache. */</comment>
      <expr_stmt><expr><name pos:line="64" pos:column="7">certstat<pos:position pos:line="64" pos:column="15"/></name> <operator pos:line="64" pos:column="16">^=<pos:position pos:line="64" pos:column="18"/></operator> <name pos:line="64" pos:column="19">GNUTLS_CERT_SIGNER_NOT_CA<pos:position pos:line="64" pos:column="44"/></name></expr>;<pos:position pos:line="64" pos:column="45"/></expr_stmt>
    }<pos:position pos:line="65" pos:column="6"/></block></then></if>

    <if pos:line="67" pos:column="5">if <condition pos:line="67" pos:column="8">(<expr><name pos:line="67" pos:column="9">chainidx<pos:position pos:line="67" pos:column="17"/></name> <operator pos:line="67" pos:column="18">==<pos:position pos:line="67" pos:column="20"/></operator> <literal type="number" pos:line="67" pos:column="21">0<pos:position pos:line="67" pos:column="22"/></literal> <operator pos:line="67" pos:column="23">&amp;&amp;<pos:position pos:line="67" pos:column="33"/></operator> <operator pos:line="67" pos:column="26">(<pos:position pos:line="67" pos:column="27"/></operator><name pos:line="67" pos:column="27">certstat<pos:position pos:line="67" pos:column="35"/></name> <operator pos:line="67" pos:column="36">&amp;<pos:position pos:line="67" pos:column="41"/></operator> <name pos:line="67" pos:column="38">GNUTLS_CERT_INSECURE_ALGORITHM<pos:position pos:line="67" pos:column="68"/></name><operator pos:line="67" pos:column="68">)<pos:position pos:line="67" pos:column="69"/></operator></expr>)<pos:position pos:line="67" pos:column="70"/></condition><then pos:line="67" pos:column="70">
    <block pos:line="68" pos:column="5">{
      <comment type="block" pos:line="69" pos:column="7">/* doesn't matter that it was signed using an insecure
         algorithm, since certificate is in our trusted cache */</comment>
      <expr_stmt><expr><name pos:line="71" pos:column="7">certstat<pos:position pos:line="71" pos:column="15"/></name> <operator pos:line="71" pos:column="16">^=<pos:position pos:line="71" pos:column="18"/></operator> <name pos:line="71" pos:column="19">GNUTLS_CERT_INSECURE_ALGORITHM<pos:position pos:line="71" pos:column="49"/></name></expr>;<pos:position pos:line="71" pos:column="50"/></expr_stmt>
    }<pos:position pos:line="72" pos:column="6"/></block></then></if>
  }<pos:position pos:line="73" pos:column="4"/></block></then></if>

  <if pos:line="75" pos:column="3">if <condition pos:line="75" pos:column="6">(<expr><name pos:line="75" pos:column="7">certstat<pos:position pos:line="75" pos:column="15"/></name> <operator pos:line="75" pos:column="16">&amp;<pos:position pos:line="75" pos:column="21"/></operator> <name pos:line="75" pos:column="18">GNUTLS_CERT_REVOKED<pos:position pos:line="75" pos:column="37"/></name></expr>)<pos:position pos:line="75" pos:column="38"/></condition><then pos:line="75" pos:column="38">
  <block pos:line="76" pos:column="3">{
    <expr_stmt><expr><operator pos:line="77" pos:column="5">*<pos:position pos:line="77" pos:column="6"/></operator><name pos:line="77" pos:column="6">certerr<pos:position pos:line="77" pos:column="13"/></name> <operator pos:line="77" pos:column="14">|=<pos:position pos:line="77" pos:column="16"/></operator> <name pos:line="77" pos:column="17">CERTERR_REVOKED<pos:position pos:line="77" pos:column="32"/></name></expr>;<pos:position pos:line="77" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><name pos:line="78" pos:column="5">certstat<pos:position pos:line="78" pos:column="13"/></name> <operator pos:line="78" pos:column="14">^=<pos:position pos:line="78" pos:column="16"/></operator> <name pos:line="78" pos:column="17">GNUTLS_CERT_REVOKED<pos:position pos:line="78" pos:column="36"/></name></expr>;<pos:position pos:line="78" pos:column="37"/></expr_stmt>
  }<pos:position pos:line="79" pos:column="4"/></block></then></if>

  <if pos:line="81" pos:column="3">if <condition pos:line="81" pos:column="6">(<expr><name pos:line="81" pos:column="7">certstat<pos:position pos:line="81" pos:column="15"/></name> <operator pos:line="81" pos:column="16">&amp;<pos:position pos:line="81" pos:column="21"/></operator> <name pos:line="81" pos:column="18">GNUTLS_CERT_INVALID<pos:position pos:line="81" pos:column="37"/></name></expr>)<pos:position pos:line="81" pos:column="38"/></condition><then pos:line="81" pos:column="38">
  <block pos:line="82" pos:column="3">{
    <expr_stmt><expr><operator pos:line="83" pos:column="5">*<pos:position pos:line="83" pos:column="6"/></operator><name pos:line="83" pos:column="6">certerr<pos:position pos:line="83" pos:column="13"/></name> <operator pos:line="83" pos:column="14">|=<pos:position pos:line="83" pos:column="16"/></operator> <name pos:line="83" pos:column="17">CERTERR_NOTTRUSTED<pos:position pos:line="83" pos:column="35"/></name></expr>;<pos:position pos:line="83" pos:column="36"/></expr_stmt>
    <expr_stmt><expr><name pos:line="84" pos:column="5">certstat<pos:position pos:line="84" pos:column="13"/></name> <operator pos:line="84" pos:column="14">^=<pos:position pos:line="84" pos:column="16"/></operator> <name pos:line="84" pos:column="17">GNUTLS_CERT_INVALID<pos:position pos:line="84" pos:column="36"/></name></expr>;<pos:position pos:line="84" pos:column="37"/></expr_stmt>
  }<pos:position pos:line="85" pos:column="4"/></block></then></if>

  <if pos:line="87" pos:column="3">if <condition pos:line="87" pos:column="6">(<expr><name pos:line="87" pos:column="7">certstat<pos:position pos:line="87" pos:column="15"/></name> <operator pos:line="87" pos:column="16">&amp;<pos:position pos:line="87" pos:column="21"/></operator> <name pos:line="87" pos:column="18">GNUTLS_CERT_SIGNER_NOT_FOUND<pos:position pos:line="87" pos:column="46"/></name></expr>)<pos:position pos:line="87" pos:column="47"/></condition><then pos:line="87" pos:column="47">
  <block pos:line="88" pos:column="3">{
    <comment type="block" pos:line="89" pos:column="5">/* NB: already cleared if cert in cache */</comment>
    <expr_stmt><expr><operator pos:line="90" pos:column="5">*<pos:position pos:line="90" pos:column="6"/></operator><name pos:line="90" pos:column="6">certerr<pos:position pos:line="90" pos:column="13"/></name> <operator pos:line="90" pos:column="14">|=<pos:position pos:line="90" pos:column="16"/></operator> <name pos:line="90" pos:column="17">CERTERR_NOTTRUSTED<pos:position pos:line="90" pos:column="35"/></name></expr>;<pos:position pos:line="90" pos:column="36"/></expr_stmt>
    <expr_stmt><expr><name pos:line="91" pos:column="5">certstat<pos:position pos:line="91" pos:column="13"/></name> <operator pos:line="91" pos:column="14">^=<pos:position pos:line="91" pos:column="16"/></operator> <name pos:line="91" pos:column="17">GNUTLS_CERT_SIGNER_NOT_FOUND<pos:position pos:line="91" pos:column="45"/></name></expr>;<pos:position pos:line="91" pos:column="46"/></expr_stmt>
  }<pos:position pos:line="92" pos:column="4"/></block></then></if>

  <if pos:line="94" pos:column="3">if <condition pos:line="94" pos:column="6">(<expr><name pos:line="94" pos:column="7">certstat<pos:position pos:line="94" pos:column="15"/></name> <operator pos:line="94" pos:column="16">&amp;<pos:position pos:line="94" pos:column="21"/></operator> <name pos:line="94" pos:column="18">GNUTLS_CERT_SIGNER_NOT_CA<pos:position pos:line="94" pos:column="43"/></name></expr>)<pos:position pos:line="94" pos:column="44"/></condition><then pos:line="94" pos:column="44">
  <block pos:line="95" pos:column="3">{
    <comment type="block" pos:line="96" pos:column="5">/* NB: already cleared if cert in cache */</comment>
    <expr_stmt><expr><operator pos:line="97" pos:column="5">*<pos:position pos:line="97" pos:column="6"/></operator><name pos:line="97" pos:column="6">certerr<pos:position pos:line="97" pos:column="13"/></name> <operator pos:line="97" pos:column="14">|=<pos:position pos:line="97" pos:column="16"/></operator> <name pos:line="97" pos:column="17">CERTERR_SIGNERNOTCA<pos:position pos:line="97" pos:column="36"/></name></expr>;<pos:position pos:line="97" pos:column="37"/></expr_stmt>
    <expr_stmt><expr><name pos:line="98" pos:column="5">certstat<pos:position pos:line="98" pos:column="13"/></name> <operator pos:line="98" pos:column="14">^=<pos:position pos:line="98" pos:column="16"/></operator> <name pos:line="98" pos:column="17">GNUTLS_CERT_SIGNER_NOT_CA<pos:position pos:line="98" pos:column="42"/></name></expr>;<pos:position pos:line="98" pos:column="43"/></expr_stmt>
  }<pos:position pos:line="99" pos:column="4"/></block></then></if>

  <if pos:line="101" pos:column="3">if <condition pos:line="101" pos:column="6">(<expr><name pos:line="101" pos:column="7">certstat<pos:position pos:line="101" pos:column="15"/></name> <operator pos:line="101" pos:column="16">&amp;<pos:position pos:line="101" pos:column="21"/></operator> <name pos:line="101" pos:column="18">GNUTLS_CERT_INSECURE_ALGORITHM<pos:position pos:line="101" pos:column="48"/></name></expr>)<pos:position pos:line="101" pos:column="49"/></condition><then pos:line="101" pos:column="49">
  <block pos:line="102" pos:column="3">{
    <comment type="block" pos:line="103" pos:column="5">/* NB: already cleared if cert in cache */</comment>
    <expr_stmt><expr><operator pos:line="104" pos:column="5">*<pos:position pos:line="104" pos:column="6"/></operator><name pos:line="104" pos:column="6">certerr<pos:position pos:line="104" pos:column="13"/></name> <operator pos:line="104" pos:column="14">|=<pos:position pos:line="104" pos:column="16"/></operator> <name pos:line="104" pos:column="17">CERTERR_INSECUREALG<pos:position pos:line="104" pos:column="36"/></name></expr>;<pos:position pos:line="104" pos:column="37"/></expr_stmt>
    <expr_stmt><expr><name pos:line="105" pos:column="5">certstat<pos:position pos:line="105" pos:column="13"/></name> <operator pos:line="105" pos:column="14">^=<pos:position pos:line="105" pos:column="16"/></operator> <name pos:line="105" pos:column="17">GNUTLS_CERT_INSECURE_ALGORITHM<pos:position pos:line="105" pos:column="47"/></name></expr>;<pos:position pos:line="105" pos:column="48"/></expr_stmt>
  }<pos:position pos:line="106" pos:column="4"/></block></then></if>

  <expr_stmt><expr><call><name pos:line="108" pos:column="3">gnutls_x509_crt_deinit<pos:position pos:line="108" pos:column="25"/></name> <argument_list pos:line="108" pos:column="26">(<argument><expr><name pos:line="108" pos:column="27">cert<pos:position pos:line="108" pos:column="31"/></name></expr></argument>)<pos:position pos:line="108" pos:column="32"/></argument_list></call></expr>;<pos:position pos:line="108" pos:column="33"/></expr_stmt>

  <comment type="block" pos:line="110" pos:column="3">/* we've been zeroing the interesting bits in certstat -
   don't return OK if there are any unhandled bits we don't
   understand */</comment>
  <if pos:line="113" pos:column="3">if <condition pos:line="113" pos:column="6">(<expr><operator pos:line="113" pos:column="7">*<pos:position pos:line="113" pos:column="8"/></operator><name pos:line="113" pos:column="8">certerr<pos:position pos:line="113" pos:column="15"/></name> <operator pos:line="113" pos:column="16">==<pos:position pos:line="113" pos:column="18"/></operator> <name pos:line="113" pos:column="19">CERTERR_VALID<pos:position pos:line="113" pos:column="32"/></name> <operator pos:line="113" pos:column="33">&amp;&amp;<pos:position pos:line="113" pos:column="43"/></operator> <name pos:line="113" pos:column="36">certstat<pos:position pos:line="113" pos:column="44"/></name> <operator pos:line="113" pos:column="45">==<pos:position pos:line="113" pos:column="47"/></operator> <literal type="number" pos:line="113" pos:column="48">0<pos:position pos:line="113" pos:column="49"/></literal></expr>)<pos:position pos:line="113" pos:column="50"/></condition><then pos:line="113" pos:column="50">
    <block type="pseudo"><return pos:line="114" pos:column="5">return <expr><literal type="number" pos:line="114" pos:column="12">0<pos:position pos:line="114" pos:column="13"/></literal></expr>;<pos:position pos:line="114" pos:column="14"/></return></block></then></if>

  <return pos:line="116" pos:column="3">return <expr><operator pos:line="116" pos:column="10">-<pos:position pos:line="116" pos:column="11"/></operator><literal type="number" pos:line="116" pos:column="11">1<pos:position pos:line="116" pos:column="12"/></literal></expr>;<pos:position pos:line="116" pos:column="13"/></return>
}<pos:position pos:line="117" pos:column="2"/></block></function></unit>
