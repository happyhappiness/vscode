utils::Assert(type_nbytes < reduce_buffer_size, "too large type_nbytes");