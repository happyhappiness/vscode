utils::Assert(nread % type_nbytes == 0, "AllReduce: size check");