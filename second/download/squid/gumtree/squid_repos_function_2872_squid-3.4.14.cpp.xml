<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="0.9.5" language="C++" filename="usr/info/code/cpp/LogMonitor/LogMonitor/second/download/squid/gumtree/squid_repos_function_2872_squid-3.4.14.cpp" pos:tabs="8"><function><specifier pos:line="1" pos:column="1">static<pos:position pos:line="1" pos:column="7"/></specifier> <type><name pos:line="1" pos:column="8">void<pos:position pos:line="1" pos:column="12"/></name></type>
<name pos:line="2" pos:column="1">wccp2AssignBuckets<pos:position pos:line="2" pos:column="19"/></name><parameter_list pos:line="2" pos:column="19">(<parameter><decl><type><name pos:line="2" pos:column="20">void<pos:position pos:line="2" pos:column="24"/></name> <modifier pos:line="2" pos:column="25">*<pos:position pos:line="2" pos:column="26"/></modifier></type><name pos:line="2" pos:column="26">voidnotused<pos:position pos:line="2" pos:column="37"/></name></decl></parameter>)<pos:position pos:line="2" pos:column="38"/></parameter_list>
<block pos:line="3" pos:column="1">{

    <decl_stmt><decl><type><name><name pos:line="5" pos:column="5">struct<pos:position pos:line="5" pos:column="11"/></name> <name pos:line="5" pos:column="12">wccp2_service_list_t<pos:position pos:line="5" pos:column="32"/></name></name> <modifier pos:line="5" pos:column="33">*<pos:position pos:line="5" pos:column="34"/></modifier></type><name pos:line="5" pos:column="34">service_list_ptr<pos:position pos:line="5" pos:column="50"/></name></decl>;<pos:position pos:line="5" pos:column="51"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="7" pos:column="5">struct<pos:position pos:line="7" pos:column="11"/></name> <name pos:line="7" pos:column="12">wccp2_router_list_t<pos:position pos:line="7" pos:column="31"/></name></name> <modifier pos:line="7" pos:column="32">*<pos:position pos:line="7" pos:column="33"/></modifier></type><name pos:line="7" pos:column="33">router_list_ptr<pos:position pos:line="7" pos:column="48"/></name></decl>;<pos:position pos:line="7" pos:column="49"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="9" pos:column="5">struct<pos:position pos:line="9" pos:column="11"/></name> <name pos:line="9" pos:column="12">wccp2_cache_list_t<pos:position pos:line="9" pos:column="30"/></name></name> <modifier pos:line="9" pos:column="31">*<pos:position pos:line="9" pos:column="32"/></modifier></type><name pos:line="9" pos:column="32">cache_list_ptr<pos:position pos:line="9" pos:column="46"/></name></decl>;<pos:position pos:line="9" pos:column="47"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="10" pos:column="5">char<pos:position pos:line="10" pos:column="9"/></name></type> <name><name pos:line="10" pos:column="10">wccp_packet<pos:position pos:line="10" pos:column="21"/></name><index pos:line="10" pos:column="21">[<expr><name pos:line="10" pos:column="22">WCCP_RESPONSE_SIZE<pos:position pos:line="10" pos:column="40"/></name></expr>]<pos:position pos:line="10" pos:column="41"/></index></name></decl>;<pos:position pos:line="10" pos:column="42"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="11" pos:column="5">short<pos:position pos:line="11" pos:column="10"/></name> <name pos:line="11" pos:column="11">int<pos:position pos:line="11" pos:column="14"/></name></type> <name pos:line="11" pos:column="15">offset<pos:position pos:line="11" pos:column="21"/></name></decl>, <decl><type ref="prev"/><name pos:line="11" pos:column="23">saved_offset<pos:position pos:line="11" pos:column="35"/></name></decl>, <decl><type ref="prev"/><name pos:line="11" pos:column="37">assignment_offset<pos:position pos:line="11" pos:column="54"/></name></decl>, <decl><type ref="prev"/><name pos:line="11" pos:column="56">alt_assignment_offset<pos:position pos:line="11" pos:column="77"/></name></decl>;<pos:position pos:line="11" pos:column="78"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="13" pos:column="5">struct<pos:position pos:line="13" pos:column="11"/></name> <name pos:line="13" pos:column="12">sockaddr_in<pos:position pos:line="13" pos:column="23"/></name></name></type> <name pos:line="13" pos:column="24">router<pos:position pos:line="13" pos:column="30"/></name></decl>;<pos:position pos:line="13" pos:column="31"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="14" pos:column="5">int<pos:position pos:line="14" pos:column="8"/></name></type> <name pos:line="14" pos:column="9">router_len<pos:position pos:line="14" pos:column="19"/></name></decl>;<pos:position pos:line="14" pos:column="20"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="15" pos:column="5">int<pos:position pos:line="15" pos:column="8"/></name></type> <name pos:line="15" pos:column="9">bucket_counter<pos:position pos:line="15" pos:column="23"/></name></decl>;<pos:position pos:line="15" pos:column="24"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="16" pos:column="5">uint32_t<pos:position pos:line="16" pos:column="13"/></name></type> <name pos:line="16" pos:column="14">service_flags<pos:position pos:line="16" pos:column="27"/></name></decl>;<pos:position pos:line="16" pos:column="28"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="17" pos:column="5">unsigned<pos:position pos:line="17" pos:column="13"/></name> <name pos:line="17" pos:column="14">short<pos:position pos:line="17" pos:column="19"/></name></type> <name pos:line="17" pos:column="20">port<pos:position pos:line="17" pos:column="24"/></name> <init pos:line="17" pos:column="25">= <expr><name pos:line="17" pos:column="27">WCCP_PORT<pos:position pos:line="17" pos:column="36"/></name></expr></init></decl>;<pos:position pos:line="17" pos:column="37"/></decl_stmt>

    <comment type="block" pos:line="19" pos:column="5">/* Packet segments */</comment>

    <decl_stmt><decl><type><name><name pos:line="21" pos:column="5">struct<pos:position pos:line="21" pos:column="11"/></name> <name pos:line="21" pos:column="12">wccp2_message_header_t<pos:position pos:line="21" pos:column="34"/></name></name> <modifier pos:line="21" pos:column="35">*<pos:position pos:line="21" pos:column="36"/></modifier></type><name pos:line="21" pos:column="36">main_header<pos:position pos:line="21" pos:column="47"/></name></decl>;<pos:position pos:line="21" pos:column="48"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="23" pos:column="5">struct<pos:position pos:line="23" pos:column="11"/></name> <name pos:line="23" pos:column="12">wccp2_security_md5_t<pos:position pos:line="23" pos:column="32"/></name></name> <modifier pos:line="23" pos:column="33">*<pos:position pos:line="23" pos:column="34"/></modifier></type><name pos:line="23" pos:column="34">security<pos:position pos:line="23" pos:column="42"/></name> <init pos:line="23" pos:column="43">= <expr><name pos:line="23" pos:column="45">NULL<pos:position pos:line="23" pos:column="49"/></name></expr></init></decl>;<pos:position pos:line="23" pos:column="50"/></decl_stmt>
    <comment type="block" pos:line="24" pos:column="5">/* service from service struct */</comment>

    <decl_stmt><decl><type><name><name pos:line="26" pos:column="5">struct<pos:position pos:line="26" pos:column="11"/></name> <name pos:line="26" pos:column="12">wccp2_item_header_t<pos:position pos:line="26" pos:column="31"/></name></name> <modifier pos:line="26" pos:column="32">*<pos:position pos:line="26" pos:column="33"/></modifier></type><name pos:line="26" pos:column="33">assignment_header<pos:position pos:line="26" pos:column="50"/></name></decl>;<pos:position pos:line="26" pos:column="51"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="28" pos:column="5">struct<pos:position pos:line="28" pos:column="11"/></name> <name pos:line="28" pos:column="12">wccp2_item_header_t<pos:position pos:line="28" pos:column="31"/></name></name> <modifier pos:line="28" pos:column="32">*<pos:position pos:line="28" pos:column="33"/></modifier></type><name pos:line="28" pos:column="33">alt_assignment_type_header<pos:position pos:line="28" pos:column="59"/></name> <init pos:line="28" pos:column="60">= <expr><name pos:line="28" pos:column="62">NULL<pos:position pos:line="28" pos:column="66"/></name></expr></init></decl>;<pos:position pos:line="28" pos:column="67"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="30" pos:column="5">struct<pos:position pos:line="30" pos:column="11"/></name> <name pos:line="30" pos:column="12">assignment_key_t<pos:position pos:line="30" pos:column="28"/></name></name> <modifier pos:line="30" pos:column="29">*<pos:position pos:line="30" pos:column="30"/></modifier></type><name pos:line="30" pos:column="30">assignment_key<pos:position pos:line="30" pos:column="44"/></name></decl>;<pos:position pos:line="30" pos:column="45"/></decl_stmt>
    <comment type="block" pos:line="31" pos:column="5">/* number of routers */</comment>

    <decl_stmt><decl><type><name><name pos:line="33" pos:column="5">struct<pos:position pos:line="33" pos:column="11"/></name> <name pos:line="33" pos:column="12">wccp2_router_assign_element_t<pos:position pos:line="33" pos:column="41"/></name></name> <modifier pos:line="33" pos:column="42">*<pos:position pos:line="33" pos:column="43"/></modifier></type><name pos:line="33" pos:column="43">router_assign<pos:position pos:line="33" pos:column="56"/></name></decl>;<pos:position pos:line="33" pos:column="57"/></decl_stmt>
    <comment type="block" pos:line="34" pos:column="5">/* number of caches */</comment>

    <decl_stmt><decl><type><name><name pos:line="36" pos:column="5">struct<pos:position pos:line="36" pos:column="11"/></name> <name pos:line="36" pos:column="12">in_addr<pos:position pos:line="36" pos:column="19"/></name></name> <modifier pos:line="36" pos:column="20">*<pos:position pos:line="36" pos:column="21"/></modifier></type><name pos:line="36" pos:column="21">cache_address<pos:position pos:line="36" pos:column="34"/></name></decl>;<pos:position pos:line="36" pos:column="35"/></decl_stmt>
    <comment type="block" pos:line="37" pos:column="5">/* Alternative assignement mask/values */</comment>
    <decl_stmt><decl><type><name pos:line="38" pos:column="5">int<pos:position pos:line="38" pos:column="8"/></name></type> <name pos:line="38" pos:column="9">num_maskval<pos:position pos:line="38" pos:column="20"/></name></decl>;<pos:position pos:line="38" pos:column="21"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="40" pos:column="5">struct<pos:position pos:line="40" pos:column="11"/></name> <name pos:line="40" pos:column="12">wccp2_mask_element_t<pos:position pos:line="40" pos:column="32"/></name></name> <modifier pos:line="40" pos:column="33">*<pos:position pos:line="40" pos:column="34"/></modifier></type><name pos:line="40" pos:column="34">mask_element<pos:position pos:line="40" pos:column="46"/></name></decl>;<pos:position pos:line="40" pos:column="47"/></decl_stmt>

    <decl_stmt><decl><type><name><name pos:line="42" pos:column="5">struct<pos:position pos:line="42" pos:column="11"/></name> <name pos:line="42" pos:column="12">wccp2_value_element_t<pos:position pos:line="42" pos:column="33"/></name></name> <modifier pos:line="42" pos:column="34">*<pos:position pos:line="42" pos:column="35"/></modifier></type><name pos:line="42" pos:column="35">value_element<pos:position pos:line="42" pos:column="48"/></name></decl>;<pos:position pos:line="42" pos:column="49"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="43" pos:column="5">int<pos:position pos:line="43" pos:column="8"/></name></type> <name pos:line="43" pos:column="9">valuecounter<pos:position pos:line="43" pos:column="21"/></name></decl>, <decl><type ref="prev"/><name pos:line="43" pos:column="23">value<pos:position pos:line="43" pos:column="28"/></name></decl>;<pos:position pos:line="43" pos:column="29"/></decl_stmt>
    <decl_stmt><decl><type><name pos:line="44" pos:column="5">char<pos:position pos:line="44" pos:column="9"/></name> <modifier pos:line="44" pos:column="10">*<pos:position pos:line="44" pos:column="11"/></modifier></type><name pos:line="44" pos:column="11">buckets<pos:position pos:line="44" pos:column="18"/></name></decl>;<pos:position pos:line="44" pos:column="19"/></decl_stmt>

    <expr_stmt><expr><name pos:line="46" pos:column="5">assignment_offset<pos:position pos:line="46" pos:column="22"/></name> <operator pos:line="46" pos:column="23">=<pos:position pos:line="46" pos:column="24"/></operator> <name pos:line="46" pos:column="25">alt_assignment_offset<pos:position pos:line="46" pos:column="46"/></name> <operator pos:line="46" pos:column="47">=<pos:position pos:line="46" pos:column="48"/></operator> <literal type="number" pos:line="46" pos:column="49">0<pos:position pos:line="46" pos:column="50"/></literal></expr>;<pos:position pos:line="46" pos:column="51"/></expr_stmt>

    <expr_stmt><expr><name pos:line="48" pos:column="5">router_len<pos:position pos:line="48" pos:column="15"/></name> <operator pos:line="48" pos:column="16">=<pos:position pos:line="48" pos:column="17"/></operator> <sizeof pos:line="48" pos:column="18">sizeof<argument_list pos:line="48" pos:column="24">(<argument><expr><name pos:line="48" pos:column="25">router<pos:position pos:line="48" pos:column="31"/></name></expr></argument>)<pos:position pos:line="48" pos:column="32"/></argument_list></sizeof></expr>;<pos:position pos:line="48" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><call><name pos:line="49" pos:column="5">memset<pos:position pos:line="49" pos:column="11"/></name><argument_list pos:line="49" pos:column="11">(<argument><expr><operator pos:line="49" pos:column="12">&amp;<pos:position pos:line="49" pos:column="17"/></operator><name pos:line="49" pos:column="13">router<pos:position pos:line="49" pos:column="19"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="49" pos:column="21">'\0'<pos:position pos:line="49" pos:column="25"/></literal></expr></argument>, <argument><expr><name pos:line="49" pos:column="27">router_len<pos:position pos:line="49" pos:column="37"/></name></expr></argument>)<pos:position pos:line="49" pos:column="38"/></argument_list></call></expr>;<pos:position pos:line="49" pos:column="39"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="50" pos:column="5">router<pos:position pos:line="50" pos:column="11"/></name><operator pos:line="50" pos:column="11">.<pos:position pos:line="50" pos:column="12"/></operator><name pos:line="50" pos:column="12">sin_family<pos:position pos:line="50" pos:column="22"/></name></name> <operator pos:line="50" pos:column="23">=<pos:position pos:line="50" pos:column="24"/></operator> <name pos:line="50" pos:column="25">AF_INET<pos:position pos:line="50" pos:column="32"/></name></expr>;<pos:position pos:line="50" pos:column="33"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="51" pos:column="5">router<pos:position pos:line="51" pos:column="11"/></name><operator pos:line="51" pos:column="11">.<pos:position pos:line="51" pos:column="12"/></operator><name pos:line="51" pos:column="12">sin_port<pos:position pos:line="51" pos:column="20"/></name></name> <operator pos:line="51" pos:column="21">=<pos:position pos:line="51" pos:column="22"/></operator> <call><name pos:line="51" pos:column="23">htons<pos:position pos:line="51" pos:column="28"/></name><argument_list pos:line="51" pos:column="28">(<argument><expr><name pos:line="51" pos:column="29">port<pos:position pos:line="51" pos:column="33"/></name></expr></argument>)<pos:position pos:line="51" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="51" pos:column="35"/></expr_stmt>

    <comment type="block" pos:line="53" pos:column="5">/* Start main header - fill in length later */</comment>
    <expr_stmt><expr><name pos:line="54" pos:column="5">offset<pos:position pos:line="54" pos:column="11"/></name> <operator pos:line="54" pos:column="12">=<pos:position pos:line="54" pos:column="13"/></operator> <literal type="number" pos:line="54" pos:column="14">0<pos:position pos:line="54" pos:column="15"/></literal></expr>;<pos:position pos:line="54" pos:column="16"/></expr_stmt>

    <expr_stmt><expr><name pos:line="56" pos:column="5">main_header<pos:position pos:line="56" pos:column="16"/></name> <operator pos:line="56" pos:column="17">=<pos:position pos:line="56" pos:column="18"/></operator> <operator pos:line="56" pos:column="19">(<pos:position pos:line="56" pos:column="20"/></operator>struct <name pos:line="56" pos:column="27">wccp2_message_header_t<pos:position pos:line="56" pos:column="49"/></name> <operator pos:line="56" pos:column="50">*<pos:position pos:line="56" pos:column="51"/></operator><operator pos:line="56" pos:column="51">)<pos:position pos:line="56" pos:column="52"/></operator> <operator pos:line="56" pos:column="53">&amp;<pos:position pos:line="56" pos:column="58"/></operator><name><name pos:line="56" pos:column="54">wccp_packet<pos:position pos:line="56" pos:column="65"/></name><index pos:line="56" pos:column="65">[<expr><name pos:line="56" pos:column="66">offset<pos:position pos:line="56" pos:column="72"/></name></expr>]<pos:position pos:line="56" pos:column="73"/></index></name></expr>;<pos:position pos:line="56" pos:column="74"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="57" pos:column="5">main_header<pos:position pos:line="57" pos:column="16"/></name><operator pos:line="57" pos:column="16">-&gt;<pos:position pos:line="57" pos:column="21"/></operator><name pos:line="57" pos:column="18">type<pos:position pos:line="57" pos:column="22"/></name></name> <operator pos:line="57" pos:column="23">=<pos:position pos:line="57" pos:column="24"/></operator> <call><name pos:line="57" pos:column="25">htonl<pos:position pos:line="57" pos:column="30"/></name><argument_list pos:line="57" pos:column="30">(<argument><expr><name pos:line="57" pos:column="31">WCCP2_REDIRECT_ASSIGN<pos:position pos:line="57" pos:column="52"/></name></expr></argument>)<pos:position pos:line="57" pos:column="53"/></argument_list></call></expr>;<pos:position pos:line="57" pos:column="54"/></expr_stmt>
    <expr_stmt><expr><name><name pos:line="58" pos:column="5">main_header<pos:position pos:line="58" pos:column="16"/></name><operator pos:line="58" pos:column="16">-&gt;<pos:position pos:line="58" pos:column="21"/></operator><name pos:line="58" pos:column="18">version<pos:position pos:line="58" pos:column="25"/></name></name> <operator pos:line="58" pos:column="26">=<pos:position pos:line="58" pos:column="27"/></operator> <call><name pos:line="58" pos:column="28">htons<pos:position pos:line="58" pos:column="33"/></name><argument_list pos:line="58" pos:column="33">(<argument><expr><name pos:line="58" pos:column="34">WCCP2_VERSION<pos:position pos:line="58" pos:column="47"/></name></expr></argument>)<pos:position pos:line="58" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="58" pos:column="49"/></expr_stmt>

    <expr_stmt><expr><call><name pos:line="60" pos:column="5">debugs<pos:position pos:line="60" pos:column="11"/></name><argument_list pos:line="60" pos:column="11">(<argument><expr><literal type="number" pos:line="60" pos:column="12">80<pos:position pos:line="60" pos:column="14"/></literal></expr></argument>, <argument><expr><literal type="number" pos:line="60" pos:column="16">2<pos:position pos:line="60" pos:column="17"/></literal></expr></argument>, <argument><expr><literal type="string" pos:line="60" pos:column="19">"Running wccp2AssignBuckets"<pos:position pos:line="60" pos:column="47"/></literal></expr></argument>)<pos:position pos:line="60" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="60" pos:column="49"/></expr_stmt>
    <expr_stmt><expr><name pos:line="61" pos:column="5">service_list_ptr<pos:position pos:line="61" pos:column="21"/></name> <operator pos:line="61" pos:column="22">=<pos:position pos:line="61" pos:column="23"/></operator> <name pos:line="61" pos:column="24">wccp2_service_list_head<pos:position pos:line="61" pos:column="47"/></name></expr>;<pos:position pos:line="61" pos:column="48"/></expr_stmt>

    <while pos:line="63" pos:column="5">while <condition pos:line="63" pos:column="11">(<expr><name pos:line="63" pos:column="12">service_list_ptr<pos:position pos:line="63" pos:column="28"/></name> <operator pos:line="63" pos:column="29">!=<pos:position pos:line="63" pos:column="31"/></operator> <name pos:line="63" pos:column="32">NULL<pos:position pos:line="63" pos:column="36"/></name></expr>)<pos:position pos:line="63" pos:column="37"/></condition> <block pos:line="63" pos:column="38">{
        <comment type="block" pos:line="64" pos:column="9">/* If we're not the lowest, we don't need to worry */</comment>

        <if pos:line="66" pos:column="9">if <condition pos:line="66" pos:column="12">(<expr><name><name pos:line="66" pos:column="13">service_list_ptr<pos:position pos:line="66" pos:column="29"/></name><operator pos:line="66" pos:column="29">-&gt;<pos:position pos:line="66" pos:column="34"/></operator><name pos:line="66" pos:column="31">lowest_ip<pos:position pos:line="66" pos:column="40"/></name></name> <operator pos:line="66" pos:column="41">==<pos:position pos:line="66" pos:column="43"/></operator> <literal type="number" pos:line="66" pos:column="44">0<pos:position pos:line="66" pos:column="45"/></literal></expr>)<pos:position pos:line="66" pos:column="46"/></condition><then pos:line="66" pos:column="46"> <block pos:line="66" pos:column="47">{
            <comment type="block" pos:line="67" pos:column="13">/* XXX eww */</comment>
            <expr_stmt><expr><name pos:line="68" pos:column="13">service_list_ptr<pos:position pos:line="68" pos:column="29"/></name> <operator pos:line="68" pos:column="30">=<pos:position pos:line="68" pos:column="31"/></operator> <name><name pos:line="68" pos:column="32">service_list_ptr<pos:position pos:line="68" pos:column="48"/></name><operator pos:line="68" pos:column="48">-&gt;<pos:position pos:line="68" pos:column="53"/></operator><name pos:line="68" pos:column="50">next<pos:position pos:line="68" pos:column="54"/></name></name></expr>;<pos:position pos:line="68" pos:column="55"/></expr_stmt>
            <continue pos:line="69" pos:column="13">continue;<pos:position pos:line="69" pos:column="22"/></continue>
        }<pos:position pos:line="70" pos:column="10"/></block></then></if>

        <comment type="block" pos:line="72" pos:column="9">/* reset the offset */</comment>

        <expr_stmt><expr><name pos:line="74" pos:column="9">offset<pos:position pos:line="74" pos:column="15"/></name> <operator pos:line="74" pos:column="16">=<pos:position pos:line="74" pos:column="17"/></operator> <sizeof pos:line="74" pos:column="18">sizeof<argument_list pos:line="74" pos:column="24">(<argument><expr pos:line="74" pos:column="25">struct <name pos:line="74" pos:column="32">wccp2_message_header_t<pos:position pos:line="74" pos:column="54"/></name></expr></argument>)<pos:position pos:line="74" pos:column="55"/></argument_list></sizeof></expr>;<pos:position pos:line="74" pos:column="56"/></expr_stmt>

        <comment type="block" pos:line="76" pos:column="9">/* build packet header from hereIam packet */</comment>
        <comment type="block" pos:line="77" pos:column="9">/* Security info */</comment>
        <comment type="block" pos:line="78" pos:column="9">/* XXX this should be made more generic! */</comment>
        <comment type="block" pos:line="79" pos:column="9">/* XXX and I hate magic numbers! */</comment>
        <switch pos:line="80" pos:column="9">switch <condition pos:line="80" pos:column="16">(<expr><name><name pos:line="80" pos:column="17">service_list_ptr<pos:position pos:line="80" pos:column="33"/></name><operator pos:line="80" pos:column="33">-&gt;<pos:position pos:line="80" pos:column="38"/></operator><name pos:line="80" pos:column="35">wccp2_security_type<pos:position pos:line="80" pos:column="54"/></name></name></expr>)<pos:position pos:line="80" pos:column="55"/></condition> <block pos:line="80" pos:column="56">{

        <case pos:line="82" pos:column="9">case <expr><name pos:line="82" pos:column="14">WCCP2_NO_SECURITY<pos:position pos:line="82" pos:column="31"/></name></expr>:<pos:position pos:line="82" pos:column="32"/></case>

            <expr_stmt><expr><name pos:line="84" pos:column="13">security<pos:position pos:line="84" pos:column="21"/></name> <operator pos:line="84" pos:column="22">=<pos:position pos:line="84" pos:column="23"/></operator> <operator pos:line="84" pos:column="24">(<pos:position pos:line="84" pos:column="25"/></operator>struct <name pos:line="84" pos:column="32">wccp2_security_md5_t<pos:position pos:line="84" pos:column="52"/></name> <operator pos:line="84" pos:column="53">*<pos:position pos:line="84" pos:column="54"/></operator><operator pos:line="84" pos:column="54">)<pos:position pos:line="84" pos:column="55"/></operator> <operator pos:line="84" pos:column="56">&amp;<pos:position pos:line="84" pos:column="61"/></operator><name><name pos:line="84" pos:column="57">wccp_packet<pos:position pos:line="84" pos:column="68"/></name><index pos:line="84" pos:column="68">[<expr><name pos:line="84" pos:column="69">offset<pos:position pos:line="84" pos:column="75"/></name></expr>]<pos:position pos:line="84" pos:column="76"/></index></name></expr>;<pos:position pos:line="84" pos:column="77"/></expr_stmt>
            <expr_stmt><expr><call><name pos:line="85" pos:column="13">memcpy<pos:position pos:line="85" pos:column="19"/></name><argument_list pos:line="85" pos:column="19">(<argument><expr><name pos:line="85" pos:column="20">security<pos:position pos:line="85" pos:column="28"/></name></expr></argument>, <argument><expr><name><name pos:line="85" pos:column="30">service_list_ptr<pos:position pos:line="85" pos:column="46"/></name><operator pos:line="85" pos:column="46">-&gt;<pos:position pos:line="85" pos:column="51"/></operator><name pos:line="85" pos:column="48">security_info<pos:position pos:line="85" pos:column="61"/></name></name></expr></argument>, <argument><expr><literal type="number" pos:line="85" pos:column="63">8<pos:position pos:line="85" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="85" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="85" pos:column="66"/></expr_stmt>
            <expr_stmt><expr><name pos:line="86" pos:column="13">offset<pos:position pos:line="86" pos:column="19"/></name> <operator pos:line="86" pos:column="20">+=<pos:position pos:line="86" pos:column="22"/></operator> <literal type="number" pos:line="86" pos:column="23">8<pos:position pos:line="86" pos:column="24"/></literal></expr>;<pos:position pos:line="86" pos:column="25"/></expr_stmt>
            <break pos:line="87" pos:column="13">break;<pos:position pos:line="87" pos:column="19"/></break>

        <case pos:line="89" pos:column="9">case <expr><name pos:line="89" pos:column="14">WCCP2_MD5_SECURITY<pos:position pos:line="89" pos:column="32"/></name></expr>:<pos:position pos:line="89" pos:column="33"/></case>

            <expr_stmt><expr><name pos:line="91" pos:column="13">security<pos:position pos:line="91" pos:column="21"/></name> <operator pos:line="91" pos:column="22">=<pos:position pos:line="91" pos:column="23"/></operator> <operator pos:line="91" pos:column="24">(<pos:position pos:line="91" pos:column="25"/></operator>struct <name pos:line="91" pos:column="32">wccp2_security_md5_t<pos:position pos:line="91" pos:column="52"/></name> <operator pos:line="91" pos:column="53">*<pos:position pos:line="91" pos:column="54"/></operator><operator pos:line="91" pos:column="54">)<pos:position pos:line="91" pos:column="55"/></operator> <operator pos:line="91" pos:column="56">&amp;<pos:position pos:line="91" pos:column="61"/></operator><name><name pos:line="91" pos:column="57">wccp_packet<pos:position pos:line="91" pos:column="68"/></name><index pos:line="91" pos:column="68">[<expr><name pos:line="91" pos:column="69">offset<pos:position pos:line="91" pos:column="75"/></name></expr>]<pos:position pos:line="91" pos:column="76"/></index></name></expr>;<pos:position pos:line="91" pos:column="77"/></expr_stmt>

            <expr_stmt><expr><call><name pos:line="93" pos:column="13">memcpy<pos:position pos:line="93" pos:column="19"/></name><argument_list pos:line="93" pos:column="19">(<argument><expr><name pos:line="93" pos:column="20">security<pos:position pos:line="93" pos:column="28"/></name></expr></argument>, <argument><expr><name><name pos:line="93" pos:column="30">service_list_ptr<pos:position pos:line="93" pos:column="46"/></name><operator pos:line="93" pos:column="46">-&gt;<pos:position pos:line="93" pos:column="51"/></operator><name pos:line="93" pos:column="48">security_info<pos:position pos:line="93" pos:column="61"/></name></name></expr></argument>, <argument><expr><sizeof pos:line="93" pos:column="63">sizeof<argument_list pos:line="93" pos:column="69">(<argument><expr pos:line="93" pos:column="70">struct <name pos:line="93" pos:column="77">wccp2_security_md5_t<pos:position pos:line="93" pos:column="97"/></name></expr></argument>)<pos:position pos:line="93" pos:column="98"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="93" pos:column="99"/></argument_list></call></expr>;<pos:position pos:line="93" pos:column="100"/></expr_stmt>

            <expr_stmt><expr><name pos:line="95" pos:column="13">offset<pos:position pos:line="95" pos:column="19"/></name> <operator pos:line="95" pos:column="20">+=<pos:position pos:line="95" pos:column="22"/></operator> <sizeof pos:line="95" pos:column="23">sizeof<argument_list pos:line="95" pos:column="29">(<argument><expr pos:line="95" pos:column="30">struct <name pos:line="95" pos:column="37">wccp2_security_md5_t<pos:position pos:line="95" pos:column="57"/></name></expr></argument>)<pos:position pos:line="95" pos:column="58"/></argument_list></sizeof></expr>;<pos:position pos:line="95" pos:column="59"/></expr_stmt>
            <break pos:line="96" pos:column="13">break;<pos:position pos:line="96" pos:column="19"/></break>

        <default pos:line="98" pos:column="9">default:<pos:position pos:line="98" pos:column="17"/></default>
            <expr_stmt><expr><call><name pos:line="99" pos:column="13">fatalf<pos:position pos:line="99" pos:column="19"/></name><argument_list pos:line="99" pos:column="19">(<argument><expr><literal type="string" pos:line="99" pos:column="20">"Unknown Wccp2 security type\n"<pos:position pos:line="99" pos:column="51"/></literal></expr></argument>)<pos:position pos:line="99" pos:column="52"/></argument_list></call></expr>;<pos:position pos:line="99" pos:column="53"/></expr_stmt>
        }<pos:position pos:line="100" pos:column="10"/></block></switch>

        <comment type="block" pos:line="102" pos:column="9">/* Service info */</comment>

        <expr_stmt><expr><call><name pos:line="104" pos:column="9">memcpy<pos:position pos:line="104" pos:column="15"/></name><argument_list pos:line="104" pos:column="15">(<argument><expr><operator pos:line="104" pos:column="16">&amp;<pos:position pos:line="104" pos:column="21"/></operator><name><name pos:line="104" pos:column="17">wccp_packet<pos:position pos:line="104" pos:column="28"/></name><index pos:line="104" pos:column="28">[<expr><name pos:line="104" pos:column="29">offset<pos:position pos:line="104" pos:column="35"/></name></expr>]<pos:position pos:line="104" pos:column="36"/></index></name></expr></argument>, <argument><expr><name><name pos:line="104" pos:column="38">service_list_ptr<pos:position pos:line="104" pos:column="54"/></name><operator pos:line="104" pos:column="54">-&gt;<pos:position pos:line="104" pos:column="59"/></operator><name pos:line="104" pos:column="56">service_info<pos:position pos:line="104" pos:column="68"/></name></name></expr></argument>, <argument><expr><sizeof pos:line="104" pos:column="70">sizeof<argument_list pos:line="104" pos:column="76">(<argument><expr pos:line="104" pos:column="77">struct <name pos:line="104" pos:column="84">wccp2_service_info_t<pos:position pos:line="104" pos:column="104"/></name></expr></argument>)<pos:position pos:line="104" pos:column="105"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="104" pos:column="106"/></argument_list></call></expr>;<pos:position pos:line="104" pos:column="107"/></expr_stmt>

        <expr_stmt><expr><name pos:line="106" pos:column="9">offset<pos:position pos:line="106" pos:column="15"/></name> <operator pos:line="106" pos:column="16">+=<pos:position pos:line="106" pos:column="18"/></operator> <sizeof pos:line="106" pos:column="19">sizeof<argument_list pos:line="106" pos:column="25">(<argument><expr pos:line="106" pos:column="26">struct <name pos:line="106" pos:column="33">wccp2_service_info_t<pos:position pos:line="106" pos:column="53"/></name></expr></argument>)<pos:position pos:line="106" pos:column="54"/></argument_list></sizeof></expr>;<pos:position pos:line="106" pos:column="55"/></expr_stmt>

        <comment type="block" pos:line="108" pos:column="9">/* assignment header - fill in length later */</comment>

        <expr_stmt><expr><name pos:line="110" pos:column="9">assignment_header<pos:position pos:line="110" pos:column="26"/></name> <operator pos:line="110" pos:column="27">=<pos:position pos:line="110" pos:column="28"/></operator> <operator pos:line="110" pos:column="29">(<pos:position pos:line="110" pos:column="30"/></operator>struct <name pos:line="110" pos:column="37">wccp2_item_header_t<pos:position pos:line="110" pos:column="56"/></name> <operator pos:line="110" pos:column="57">*<pos:position pos:line="110" pos:column="58"/></operator><operator pos:line="110" pos:column="58">)<pos:position pos:line="110" pos:column="59"/></operator> <operator pos:line="110" pos:column="60">&amp;<pos:position pos:line="110" pos:column="65"/></operator><name><name pos:line="110" pos:column="61">wccp_packet<pos:position pos:line="110" pos:column="72"/></name><index pos:line="110" pos:column="72">[<expr><name pos:line="110" pos:column="73">offset<pos:position pos:line="110" pos:column="79"/></name></expr>]<pos:position pos:line="110" pos:column="80"/></index></name></expr>;<pos:position pos:line="110" pos:column="81"/></expr_stmt>

        <switch pos:line="112" pos:column="9">switch <condition pos:line="112" pos:column="16">(<expr><name><name pos:line="112" pos:column="17">Config<pos:position pos:line="112" pos:column="23"/></name><operator pos:line="112" pos:column="23">.<pos:position pos:line="112" pos:column="24"/></operator><name pos:line="112" pos:column="24">Wccp2<pos:position pos:line="112" pos:column="29"/></name><operator pos:line="112" pos:column="29">.<pos:position pos:line="112" pos:column="30"/></operator><name pos:line="112" pos:column="30">assignment_method<pos:position pos:line="112" pos:column="47"/></name></name></expr>)<pos:position pos:line="112" pos:column="48"/></condition> <block pos:line="112" pos:column="49">{

        <case pos:line="114" pos:column="9">case <expr><name pos:line="114" pos:column="14">WCCP2_ASSIGNMENT_METHOD_HASH<pos:position pos:line="114" pos:column="42"/></name></expr>:<pos:position pos:line="114" pos:column="43"/></case>
            <expr_stmt><expr><name><name pos:line="115" pos:column="13">assignment_header<pos:position pos:line="115" pos:column="30"/></name><operator pos:line="115" pos:column="30">-&gt;<pos:position pos:line="115" pos:column="35"/></operator><name pos:line="115" pos:column="32">type<pos:position pos:line="115" pos:column="36"/></name></name> <operator pos:line="115" pos:column="37">=<pos:position pos:line="115" pos:column="38"/></operator> <call><name pos:line="115" pos:column="39">htons<pos:position pos:line="115" pos:column="44"/></name><argument_list pos:line="115" pos:column="44">(<argument><expr><name pos:line="115" pos:column="45">WCCP2_REDIRECT_ASSIGNMENT<pos:position pos:line="115" pos:column="70"/></name></expr></argument>)<pos:position pos:line="115" pos:column="71"/></argument_list></call></expr>;<pos:position pos:line="115" pos:column="72"/></expr_stmt>

            <expr_stmt><expr><name pos:line="117" pos:column="13">offset<pos:position pos:line="117" pos:column="19"/></name> <operator pos:line="117" pos:column="20">+=<pos:position pos:line="117" pos:column="22"/></operator> <sizeof pos:line="117" pos:column="23">sizeof<argument_list pos:line="117" pos:column="29">(<argument><expr pos:line="117" pos:column="30">struct <name pos:line="117" pos:column="37">wccp2_item_header_t<pos:position pos:line="117" pos:column="56"/></name></expr></argument>)<pos:position pos:line="117" pos:column="57"/></argument_list></sizeof></expr>;<pos:position pos:line="117" pos:column="58"/></expr_stmt>
            <expr_stmt><expr><name pos:line="118" pos:column="13">assignment_offset<pos:position pos:line="118" pos:column="30"/></name> <operator pos:line="118" pos:column="31">=<pos:position pos:line="118" pos:column="32"/></operator> <name pos:line="118" pos:column="33">offset<pos:position pos:line="118" pos:column="39"/></name></expr>;<pos:position pos:line="118" pos:column="40"/></expr_stmt>
            <break pos:line="119" pos:column="13">break;<pos:position pos:line="119" pos:column="19"/></break>

        <case pos:line="121" pos:column="9">case <expr><name pos:line="121" pos:column="14">WCCP2_ASSIGNMENT_METHOD_MASK<pos:position pos:line="121" pos:column="42"/></name></expr>:<pos:position pos:line="121" pos:column="43"/></case>
            <expr_stmt><expr><name><name pos:line="122" pos:column="13">assignment_header<pos:position pos:line="122" pos:column="30"/></name><operator pos:line="122" pos:column="30">-&gt;<pos:position pos:line="122" pos:column="35"/></operator><name pos:line="122" pos:column="32">type<pos:position pos:line="122" pos:column="36"/></name></name> <operator pos:line="122" pos:column="37">=<pos:position pos:line="122" pos:column="38"/></operator> <call><name pos:line="122" pos:column="39">htons<pos:position pos:line="122" pos:column="44"/></name><argument_list pos:line="122" pos:column="44">(<argument><expr><name pos:line="122" pos:column="45">WCCP2_ALT_ASSIGNMENT<pos:position pos:line="122" pos:column="65"/></name></expr></argument>)<pos:position pos:line="122" pos:column="66"/></argument_list></call></expr>;<pos:position pos:line="122" pos:column="67"/></expr_stmt>

            <expr_stmt><expr><name pos:line="124" pos:column="13">offset<pos:position pos:line="124" pos:column="19"/></name> <operator pos:line="124" pos:column="20">+=<pos:position pos:line="124" pos:column="22"/></operator> <sizeof pos:line="124" pos:column="23">sizeof<argument_list pos:line="124" pos:column="29">(<argument><expr pos:line="124" pos:column="30">struct <name pos:line="124" pos:column="37">wccp2_item_header_t<pos:position pos:line="124" pos:column="56"/></name></expr></argument>)<pos:position pos:line="124" pos:column="57"/></argument_list></sizeof></expr>;<pos:position pos:line="124" pos:column="58"/></expr_stmt>
            <expr_stmt><expr><name pos:line="125" pos:column="13">assignment_offset<pos:position pos:line="125" pos:column="30"/></name> <operator pos:line="125" pos:column="31">=<pos:position pos:line="125" pos:column="32"/></operator> <name pos:line="125" pos:column="33">offset<pos:position pos:line="125" pos:column="39"/></name></expr>;<pos:position pos:line="125" pos:column="40"/></expr_stmt>

            <comment type="block" pos:line="127" pos:column="13">/* The alternative assignment has an extra header, fill in length later */</comment>

            <expr_stmt><expr><name pos:line="129" pos:column="13">alt_assignment_type_header<pos:position pos:line="129" pos:column="39"/></name> <operator pos:line="129" pos:column="40">=<pos:position pos:line="129" pos:column="41"/></operator> <operator pos:line="129" pos:column="42">(<pos:position pos:line="129" pos:column="43"/></operator>struct <name pos:line="129" pos:column="50">wccp2_item_header_t<pos:position pos:line="129" pos:column="69"/></name> <operator pos:line="129" pos:column="70">*<pos:position pos:line="129" pos:column="71"/></operator><operator pos:line="129" pos:column="71">)<pos:position pos:line="129" pos:column="72"/></operator> <operator pos:line="129" pos:column="73">&amp;<pos:position pos:line="129" pos:column="78"/></operator><name><name pos:line="129" pos:column="74">wccp_packet<pos:position pos:line="129" pos:column="85"/></name><index pos:line="129" pos:column="85">[<expr><name pos:line="129" pos:column="86">offset<pos:position pos:line="129" pos:column="92"/></name></expr>]<pos:position pos:line="129" pos:column="93"/></index></name></expr>;<pos:position pos:line="129" pos:column="94"/></expr_stmt>
            <expr_stmt><expr><name><name pos:line="130" pos:column="13">alt_assignment_type_header<pos:position pos:line="130" pos:column="39"/></name><operator pos:line="130" pos:column="39">-&gt;<pos:position pos:line="130" pos:column="44"/></operator><name pos:line="130" pos:column="41">type<pos:position pos:line="130" pos:column="45"/></name></name> <operator pos:line="130" pos:column="46">=<pos:position pos:line="130" pos:column="47"/></operator> <call><name pos:line="130" pos:column="48">htons<pos:position pos:line="130" pos:column="53"/></name><argument_list pos:line="130" pos:column="53">(<argument><expr><name pos:line="130" pos:column="54">WCCP2_MASK_ASSIGNMENT<pos:position pos:line="130" pos:column="75"/></name></expr></argument>)<pos:position pos:line="130" pos:column="76"/></argument_list></call></expr>;<pos:position pos:line="130" pos:column="77"/></expr_stmt>

            <expr_stmt><expr><name pos:line="132" pos:column="13">offset<pos:position pos:line="132" pos:column="19"/></name> <operator pos:line="132" pos:column="20">+=<pos:position pos:line="132" pos:column="22"/></operator> <sizeof pos:line="132" pos:column="23">sizeof<argument_list pos:line="132" pos:column="29">(<argument><expr pos:line="132" pos:column="30">struct <name pos:line="132" pos:column="37">wccp2_item_header_t<pos:position pos:line="132" pos:column="56"/></name></expr></argument>)<pos:position pos:line="132" pos:column="57"/></argument_list></sizeof></expr>;<pos:position pos:line="132" pos:column="58"/></expr_stmt>
            <expr_stmt><expr><name pos:line="133" pos:column="13">alt_assignment_offset<pos:position pos:line="133" pos:column="34"/></name> <operator pos:line="133" pos:column="35">=<pos:position pos:line="133" pos:column="36"/></operator> <name pos:line="133" pos:column="37">offset<pos:position pos:line="133" pos:column="43"/></name></expr>;<pos:position pos:line="133" pos:column="44"/></expr_stmt>

            <break pos:line="135" pos:column="13">break;<pos:position pos:line="135" pos:column="19"/></break>

        <default pos:line="137" pos:column="9">default:<pos:position pos:line="137" pos:column="17"/></default>
            <expr_stmt><expr><call><name pos:line="138" pos:column="13">fatalf<pos:position pos:line="138" pos:column="19"/></name><argument_list pos:line="138" pos:column="19">(<argument><expr><literal type="string" pos:line="138" pos:column="20">"Unknown Wccp2 assignment method\n"<pos:position pos:line="138" pos:column="55"/></literal></expr></argument>)<pos:position pos:line="138" pos:column="56"/></argument_list></call></expr>;<pos:position pos:line="138" pos:column="57"/></expr_stmt>
        }<pos:position pos:line="139" pos:column="10"/></block></switch>

        <comment type="block" pos:line="141" pos:column="9">/* Assignment key - fill in master ip later */</comment>

        <expr_stmt><expr><name pos:line="143" pos:column="9">assignment_key<pos:position pos:line="143" pos:column="23"/></name> <operator pos:line="143" pos:column="24">=<pos:position pos:line="143" pos:column="25"/></operator> <operator pos:line="143" pos:column="26">(<pos:position pos:line="143" pos:column="27"/></operator>struct <name pos:line="143" pos:column="34">assignment_key_t<pos:position pos:line="143" pos:column="50"/></name> <operator pos:line="143" pos:column="51">*<pos:position pos:line="143" pos:column="52"/></operator><operator pos:line="143" pos:column="52">)<pos:position pos:line="143" pos:column="53"/></operator> <operator pos:line="143" pos:column="54">&amp;<pos:position pos:line="143" pos:column="59"/></operator><name><name pos:line="143" pos:column="55">wccp_packet<pos:position pos:line="143" pos:column="66"/></name><index pos:line="143" pos:column="66">[<expr><name pos:line="143" pos:column="67">offset<pos:position pos:line="143" pos:column="73"/></name></expr>]<pos:position pos:line="143" pos:column="74"/></index></name></expr>;<pos:position pos:line="143" pos:column="75"/></expr_stmt>

        <expr_stmt><expr><name><name pos:line="145" pos:column="9">assignment_key<pos:position pos:line="145" pos:column="23"/></name><operator pos:line="145" pos:column="23">-&gt;<pos:position pos:line="145" pos:column="28"/></operator><name pos:line="145" pos:column="25">master_number<pos:position pos:line="145" pos:column="38"/></name></name> <operator pos:line="145" pos:column="39">=<pos:position pos:line="145" pos:column="40"/></operator> <call><name pos:line="145" pos:column="41">htonl<pos:position pos:line="145" pos:column="46"/></name><argument_list pos:line="145" pos:column="46">(<argument><expr><operator pos:line="145" pos:column="47">++<pos:position pos:line="145" pos:column="49"/></operator><name><name pos:line="145" pos:column="49">service_list_ptr<pos:position pos:line="145" pos:column="65"/></name><operator pos:line="145" pos:column="65">-&gt;<pos:position pos:line="145" pos:column="70"/></operator><name pos:line="145" pos:column="67">change_num<pos:position pos:line="145" pos:column="77"/></name></name></expr></argument>)<pos:position pos:line="145" pos:column="78"/></argument_list></call></expr>;<pos:position pos:line="145" pos:column="79"/></expr_stmt>

        <expr_stmt><expr><name pos:line="147" pos:column="9">offset<pos:position pos:line="147" pos:column="15"/></name> <operator pos:line="147" pos:column="16">+=<pos:position pos:line="147" pos:column="18"/></operator> <sizeof pos:line="147" pos:column="19">sizeof<argument_list pos:line="147" pos:column="25">(<argument><expr pos:line="147" pos:column="26">struct <name pos:line="147" pos:column="33">assignment_key_t<pos:position pos:line="147" pos:column="49"/></name></expr></argument>)<pos:position pos:line="147" pos:column="50"/></argument_list></sizeof></expr>;<pos:position pos:line="147" pos:column="51"/></expr_stmt>

        <comment type="block" pos:line="149" pos:column="9">/* Number of routers */</comment>
        <expr_stmt><expr><call><name pos:line="150" pos:column="9">memcpy<pos:position pos:line="150" pos:column="15"/></name><argument_list pos:line="150" pos:column="15">(<argument><expr><operator pos:line="150" pos:column="16">&amp;<pos:position pos:line="150" pos:column="21"/></operator><name><name pos:line="150" pos:column="17">wccp_packet<pos:position pos:line="150" pos:column="28"/></name><index pos:line="150" pos:column="28">[<expr><name pos:line="150" pos:column="29">offset<pos:position pos:line="150" pos:column="35"/></name></expr>]<pos:position pos:line="150" pos:column="36"/></index></name></expr></argument>, <argument><expr><operator pos:line="150" pos:column="38">&amp;<pos:position pos:line="150" pos:column="43"/></operator><name><name pos:line="150" pos:column="39">service_list_ptr<pos:position pos:line="150" pos:column="55"/></name><operator pos:line="150" pos:column="55">-&gt;<pos:position pos:line="150" pos:column="60"/></operator><name pos:line="150" pos:column="57">num_routers<pos:position pos:line="150" pos:column="68"/></name></name></expr></argument>, <argument><expr><sizeof pos:line="150" pos:column="70">sizeof<argument_list pos:line="150" pos:column="76">(<argument><expr><name><name pos:line="150" pos:column="77">service_list_ptr<pos:position pos:line="150" pos:column="93"/></name><operator pos:line="150" pos:column="93">-&gt;<pos:position pos:line="150" pos:column="98"/></operator><name pos:line="150" pos:column="95">num_routers<pos:position pos:line="150" pos:column="106"/></name></name></expr></argument>)<pos:position pos:line="150" pos:column="107"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="150" pos:column="108"/></argument_list></call></expr>;<pos:position pos:line="150" pos:column="109"/></expr_stmt>

        <expr_stmt><expr><name pos:line="152" pos:column="9">offset<pos:position pos:line="152" pos:column="15"/></name> <operator pos:line="152" pos:column="16">+=<pos:position pos:line="152" pos:column="18"/></operator> <sizeof pos:line="152" pos:column="19">sizeof<argument_list pos:line="152" pos:column="25">(<argument><expr><name><name pos:line="152" pos:column="26">service_list_ptr<pos:position pos:line="152" pos:column="42"/></name><operator pos:line="152" pos:column="42">-&gt;<pos:position pos:line="152" pos:column="47"/></operator><name pos:line="152" pos:column="44">num_routers<pos:position pos:line="152" pos:column="55"/></name></name></expr></argument>)<pos:position pos:line="152" pos:column="56"/></argument_list></sizeof></expr>;<pos:position pos:line="152" pos:column="57"/></expr_stmt>

        <for pos:line="154" pos:column="9">for <control pos:line="154" pos:column="13">(<init><expr><name pos:line="154" pos:column="14">router_list_ptr<pos:position pos:line="154" pos:column="29"/></name> <operator pos:line="154" pos:column="30">=<pos:position pos:line="154" pos:column="31"/></operator> <operator pos:line="154" pos:column="32">&amp;<pos:position pos:line="154" pos:column="37"/></operator><name><name pos:line="154" pos:column="33">service_list_ptr<pos:position pos:line="154" pos:column="49"/></name><operator pos:line="154" pos:column="49">-&gt;<pos:position pos:line="154" pos:column="54"/></operator><name pos:line="154" pos:column="51">router_list_head<pos:position pos:line="154" pos:column="67"/></name></name></expr>;<pos:position pos:line="154" pos:column="68"/></init> <condition><expr><name><name pos:line="154" pos:column="69">router_list_ptr<pos:position pos:line="154" pos:column="84"/></name><operator pos:line="154" pos:column="84">-&gt;<pos:position pos:line="154" pos:column="89"/></operator><name pos:line="154" pos:column="86">next<pos:position pos:line="154" pos:column="90"/></name></name> <operator pos:line="154" pos:column="91">!=<pos:position pos:line="154" pos:column="93"/></operator> <name pos:line="154" pos:column="94">NULL<pos:position pos:line="154" pos:column="98"/></name></expr>;<pos:position pos:line="154" pos:column="99"/></condition> <incr><expr><name pos:line="154" pos:column="100">router_list_ptr<pos:position pos:line="154" pos:column="115"/></name> <operator pos:line="154" pos:column="116">=<pos:position pos:line="154" pos:column="117"/></operator> <name><name pos:line="154" pos:column="118">router_list_ptr<pos:position pos:line="154" pos:column="133"/></name><operator pos:line="154" pos:column="133">-&gt;<pos:position pos:line="154" pos:column="138"/></operator><name pos:line="154" pos:column="135">next<pos:position pos:line="154" pos:column="139"/></name></name></expr></incr>)<pos:position pos:line="154" pos:column="140"/></control> <block pos:line="154" pos:column="141">{

            <comment type="block" pos:line="156" pos:column="13">/* Add routers */</comment>

            <expr_stmt><expr><name pos:line="158" pos:column="13">router_assign<pos:position pos:line="158" pos:column="26"/></name> <operator pos:line="158" pos:column="27">=<pos:position pos:line="158" pos:column="28"/></operator> <operator pos:line="158" pos:column="29">(<pos:position pos:line="158" pos:column="30"/></operator>struct <name pos:line="158" pos:column="37">wccp2_router_assign_element_t<pos:position pos:line="158" pos:column="66"/></name> <operator pos:line="158" pos:column="67">*<pos:position pos:line="158" pos:column="68"/></operator><operator pos:line="158" pos:column="68">)<pos:position pos:line="158" pos:column="69"/></operator> <operator pos:line="158" pos:column="70">&amp;<pos:position pos:line="158" pos:column="75"/></operator><name><name pos:line="158" pos:column="71">wccp_packet<pos:position pos:line="158" pos:column="82"/></name><index pos:line="158" pos:column="82">[<expr><name pos:line="158" pos:column="83">offset<pos:position pos:line="158" pos:column="89"/></name></expr>]<pos:position pos:line="158" pos:column="90"/></index></name></expr>;<pos:position pos:line="158" pos:column="91"/></expr_stmt>
            <expr_stmt><expr><name><name pos:line="159" pos:column="13">router_assign<pos:position pos:line="159" pos:column="26"/></name><operator pos:line="159" pos:column="26">-&gt;<pos:position pos:line="159" pos:column="31"/></operator><name pos:line="159" pos:column="28">router_address<pos:position pos:line="159" pos:column="42"/></name></name> <operator pos:line="159" pos:column="43">=<pos:position pos:line="159" pos:column="44"/></operator> <name><name pos:line="159" pos:column="45">router_list_ptr<pos:position pos:line="159" pos:column="60"/></name><operator pos:line="159" pos:column="60">-&gt;<pos:position pos:line="159" pos:column="65"/></operator><name pos:line="159" pos:column="62">info<pos:position pos:line="159" pos:column="66"/></name><operator pos:line="159" pos:column="66">-&gt;<pos:position pos:line="159" pos:column="71"/></operator><name pos:line="159" pos:column="68">router_address<pos:position pos:line="159" pos:column="82"/></name></name></expr>;<pos:position pos:line="159" pos:column="83"/></expr_stmt>
            <expr_stmt><expr><name><name pos:line="160" pos:column="13">router_assign<pos:position pos:line="160" pos:column="26"/></name><operator pos:line="160" pos:column="26">-&gt;<pos:position pos:line="160" pos:column="31"/></operator><name pos:line="160" pos:column="28">received_id<pos:position pos:line="160" pos:column="39"/></name></name> <operator pos:line="160" pos:column="40">=<pos:position pos:line="160" pos:column="41"/></operator> <name><name pos:line="160" pos:column="42">router_list_ptr<pos:position pos:line="160" pos:column="57"/></name><operator pos:line="160" pos:column="57">-&gt;<pos:position pos:line="160" pos:column="62"/></operator><name pos:line="160" pos:column="59">info<pos:position pos:line="160" pos:column="63"/></name><operator pos:line="160" pos:column="63">-&gt;<pos:position pos:line="160" pos:column="68"/></operator><name pos:line="160" pos:column="65">received_id<pos:position pos:line="160" pos:column="76"/></name></name></expr>;<pos:position pos:line="160" pos:column="77"/></expr_stmt>
            <expr_stmt><expr><name><name pos:line="161" pos:column="13">router_assign<pos:position pos:line="161" pos:column="26"/></name><operator pos:line="161" pos:column="26">-&gt;<pos:position pos:line="161" pos:column="31"/></operator><name pos:line="161" pos:column="28">change_number<pos:position pos:line="161" pos:column="41"/></name></name> <operator pos:line="161" pos:column="42">=<pos:position pos:line="161" pos:column="43"/></operator> <call><name pos:line="161" pos:column="44">htonl<pos:position pos:line="161" pos:column="49"/></name><argument_list pos:line="161" pos:column="49">(<argument><expr><name><name pos:line="161" pos:column="50">router_list_ptr<pos:position pos:line="161" pos:column="65"/></name><operator pos:line="161" pos:column="65">-&gt;<pos:position pos:line="161" pos:column="70"/></operator><name pos:line="161" pos:column="67">member_change<pos:position pos:line="161" pos:column="80"/></name></name></expr></argument>)<pos:position pos:line="161" pos:column="81"/></argument_list></call></expr>;<pos:position pos:line="161" pos:column="82"/></expr_stmt>

            <expr_stmt><expr><name pos:line="163" pos:column="13">offset<pos:position pos:line="163" pos:column="19"/></name> <operator pos:line="163" pos:column="20">+=<pos:position pos:line="163" pos:column="22"/></operator> <sizeof pos:line="163" pos:column="23">sizeof<argument_list pos:line="163" pos:column="29">(<argument><expr pos:line="163" pos:column="30">struct <name pos:line="163" pos:column="37">wccp2_router_assign_element_t<pos:position pos:line="163" pos:column="66"/></name></expr></argument>)<pos:position pos:line="163" pos:column="67"/></argument_list></sizeof></expr>;<pos:position pos:line="163" pos:column="68"/></expr_stmt>
        }<pos:position pos:line="164" pos:column="10"/></block></for>

        <expr_stmt><expr><name pos:line="166" pos:column="9">saved_offset<pos:position pos:line="166" pos:column="21"/></name> <operator pos:line="166" pos:column="22">=<pos:position pos:line="166" pos:column="23"/></operator> <name pos:line="166" pos:column="24">offset<pos:position pos:line="166" pos:column="30"/></name></expr>;<pos:position pos:line="166" pos:column="31"/></expr_stmt>

        <for pos:line="168" pos:column="9">for <control pos:line="168" pos:column="13">(<init><expr><name pos:line="168" pos:column="14">router_list_ptr<pos:position pos:line="168" pos:column="29"/></name> <operator pos:line="168" pos:column="30">=<pos:position pos:line="168" pos:column="31"/></operator> <operator pos:line="168" pos:column="32">&amp;<pos:position pos:line="168" pos:column="37"/></operator><name><name pos:line="168" pos:column="33">service_list_ptr<pos:position pos:line="168" pos:column="49"/></name><operator pos:line="168" pos:column="49">-&gt;<pos:position pos:line="168" pos:column="54"/></operator><name pos:line="168" pos:column="51">router_list_head<pos:position pos:line="168" pos:column="67"/></name></name></expr>;<pos:position pos:line="168" pos:column="68"/></init> <condition><expr><name><name pos:line="168" pos:column="69">router_list_ptr<pos:position pos:line="168" pos:column="84"/></name><operator pos:line="168" pos:column="84">-&gt;<pos:position pos:line="168" pos:column="89"/></operator><name pos:line="168" pos:column="86">next<pos:position pos:line="168" pos:column="90"/></name></name> <operator pos:line="168" pos:column="91">!=<pos:position pos:line="168" pos:column="93"/></operator> <name pos:line="168" pos:column="94">NULL<pos:position pos:line="168" pos:column="98"/></name></expr>;<pos:position pos:line="168" pos:column="99"/></condition> <incr><expr><name pos:line="168" pos:column="100">router_list_ptr<pos:position pos:line="168" pos:column="115"/></name> <operator pos:line="168" pos:column="116">=<pos:position pos:line="168" pos:column="117"/></operator> <name><name pos:line="168" pos:column="118">router_list_ptr<pos:position pos:line="168" pos:column="133"/></name><operator pos:line="168" pos:column="133">-&gt;<pos:position pos:line="168" pos:column="138"/></operator><name pos:line="168" pos:column="135">next<pos:position pos:line="168" pos:column="139"/></name></name></expr></incr>)<pos:position pos:line="168" pos:column="140"/></control> <block pos:line="168" pos:column="141">{
            <decl_stmt><decl><type><name pos:line="169" pos:column="13">unsigned<pos:position pos:line="169" pos:column="21"/></name> <name pos:line="169" pos:column="22">long<pos:position pos:line="169" pos:column="26"/></name> <modifier pos:line="169" pos:column="27">*<pos:position pos:line="169" pos:column="28"/></modifier></type><name pos:line="169" pos:column="28">weight<pos:position pos:line="169" pos:column="34"/></name> <init pos:line="169" pos:column="35">= <expr><operator pos:line="169" pos:column="37">(<pos:position pos:line="169" pos:column="38"/></operator><name pos:line="169" pos:column="38">unsigned<pos:position pos:line="169" pos:column="46"/></name> <name pos:line="169" pos:column="47">long<pos:position pos:line="169" pos:column="51"/></name> <operator pos:line="169" pos:column="52">*<pos:position pos:line="169" pos:column="53"/></operator><operator pos:line="169" pos:column="53">)<pos:position pos:line="169" pos:column="54"/></operator><call><name pos:line="169" pos:column="54">xcalloc<pos:position pos:line="169" pos:column="61"/></name><argument_list pos:line="169" pos:column="61">(<argument><expr><sizeof pos:line="169" pos:column="62">sizeof<argument_list pos:line="169" pos:column="68">(<argument><expr><operator pos:line="169" pos:column="69">*<pos:position pos:line="169" pos:column="70"/></operator><name pos:line="169" pos:column="70">weight<pos:position pos:line="169" pos:column="76"/></name></expr></argument>)<pos:position pos:line="169" pos:column="77"/></argument_list></sizeof></expr></argument>, <argument><expr><call><name pos:line="169" pos:column="79">ntohl<pos:position pos:line="169" pos:column="84"/></name><argument_list pos:line="169" pos:column="84">(<argument><expr><name><name pos:line="169" pos:column="85">router_list_ptr<pos:position pos:line="169" pos:column="100"/></name><operator pos:line="169" pos:column="100">-&gt;<pos:position pos:line="169" pos:column="105"/></operator><name pos:line="169" pos:column="102">num_caches<pos:position pos:line="169" pos:column="112"/></name></name></expr></argument>)<pos:position pos:line="169" pos:column="113"/></argument_list></call></expr></argument>)<pos:position pos:line="169" pos:column="114"/></argument_list></call></expr></init></decl>;<pos:position pos:line="169" pos:column="115"/></decl_stmt>
            <decl_stmt><decl><type><name pos:line="170" pos:column="13">unsigned<pos:position pos:line="170" pos:column="21"/></name> <name pos:line="170" pos:column="22">long<pos:position pos:line="170" pos:column="26"/></name></type> <name pos:line="170" pos:column="27">total_weight<pos:position pos:line="170" pos:column="39"/></name> <init pos:line="170" pos:column="40">= <expr><literal type="number" pos:line="170" pos:column="42">0<pos:position pos:line="170" pos:column="43"/></literal></expr></init></decl>;<pos:position pos:line="170" pos:column="44"/></decl_stmt>
            <decl_stmt><decl><type><name pos:line="171" pos:column="13">int<pos:position pos:line="171" pos:column="16"/></name></type> <name pos:line="171" pos:column="17">num_caches<pos:position pos:line="171" pos:column="27"/></name> <init pos:line="171" pos:column="28">= <expr><call><name pos:line="171" pos:column="30">ntohl<pos:position pos:line="171" pos:column="35"/></name><argument_list pos:line="171" pos:column="35">(<argument><expr><name><name pos:line="171" pos:column="36">router_list_ptr<pos:position pos:line="171" pos:column="51"/></name><operator pos:line="171" pos:column="51">-&gt;<pos:position pos:line="171" pos:column="56"/></operator><name pos:line="171" pos:column="53">num_caches<pos:position pos:line="171" pos:column="63"/></name></name></expr></argument>)<pos:position pos:line="171" pos:column="64"/></argument_list></call></expr></init></decl>;<pos:position pos:line="171" pos:column="65"/></decl_stmt>

            <expr_stmt><expr><name pos:line="173" pos:column="13">offset<pos:position pos:line="173" pos:column="19"/></name> <operator pos:line="173" pos:column="20">=<pos:position pos:line="173" pos:column="21"/></operator> <name pos:line="173" pos:column="22">saved_offset<pos:position pos:line="173" pos:column="34"/></name></expr>;<pos:position pos:line="173" pos:column="35"/></expr_stmt>

            <switch pos:line="175" pos:column="13">switch <condition pos:line="175" pos:column="20">(<expr><name><name pos:line="175" pos:column="21">Config<pos:position pos:line="175" pos:column="27"/></name><operator pos:line="175" pos:column="27">.<pos:position pos:line="175" pos:column="28"/></operator><name pos:line="175" pos:column="28">Wccp2<pos:position pos:line="175" pos:column="33"/></name><operator pos:line="175" pos:column="33">.<pos:position pos:line="175" pos:column="34"/></operator><name pos:line="175" pos:column="34">assignment_method<pos:position pos:line="175" pos:column="51"/></name></name></expr>)<pos:position pos:line="175" pos:column="52"/></condition> <block pos:line="175" pos:column="53">{

            <case pos:line="177" pos:column="13">case <expr><name pos:line="177" pos:column="18">WCCP2_ASSIGNMENT_METHOD_HASH<pos:position pos:line="177" pos:column="46"/></name></expr>:<pos:position pos:line="177" pos:column="47"/></case>
                <comment type="block" pos:line="178" pos:column="17">/* Number of caches */</comment>
                <expr_stmt><expr><call><name pos:line="179" pos:column="17">memcpy<pos:position pos:line="179" pos:column="23"/></name><argument_list pos:line="179" pos:column="23">(<argument><expr><operator pos:line="179" pos:column="24">&amp;<pos:position pos:line="179" pos:column="29"/></operator><name><name pos:line="179" pos:column="25">wccp_packet<pos:position pos:line="179" pos:column="36"/></name><index pos:line="179" pos:column="36">[<expr><name pos:line="179" pos:column="37">offset<pos:position pos:line="179" pos:column="43"/></name></expr>]<pos:position pos:line="179" pos:column="44"/></index></name></expr></argument>, <argument><expr><operator pos:line="179" pos:column="46">&amp;<pos:position pos:line="179" pos:column="51"/></operator><name><name pos:line="179" pos:column="47">router_list_ptr<pos:position pos:line="179" pos:column="62"/></name><operator pos:line="179" pos:column="62">-&gt;<pos:position pos:line="179" pos:column="67"/></operator><name pos:line="179" pos:column="64">num_caches<pos:position pos:line="179" pos:column="74"/></name></name></expr></argument>, <argument><expr><sizeof pos:line="179" pos:column="76">sizeof<argument_list pos:line="179" pos:column="82">(<argument><expr><name><name pos:line="179" pos:column="83">router_list_ptr<pos:position pos:line="179" pos:column="98"/></name><operator pos:line="179" pos:column="98">-&gt;<pos:position pos:line="179" pos:column="103"/></operator><name pos:line="179" pos:column="100">num_caches<pos:position pos:line="179" pos:column="110"/></name></name></expr></argument>)<pos:position pos:line="179" pos:column="111"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="179" pos:column="112"/></argument_list></call></expr>;<pos:position pos:line="179" pos:column="113"/></expr_stmt>
                <expr_stmt><expr><name pos:line="180" pos:column="17">offset<pos:position pos:line="180" pos:column="23"/></name> <operator pos:line="180" pos:column="24">+=<pos:position pos:line="180" pos:column="26"/></operator> <sizeof pos:line="180" pos:column="27">sizeof<argument_list pos:line="180" pos:column="33">(<argument><expr><name><name pos:line="180" pos:column="34">router_list_ptr<pos:position pos:line="180" pos:column="49"/></name><operator pos:line="180" pos:column="49">-&gt;<pos:position pos:line="180" pos:column="54"/></operator><name pos:line="180" pos:column="51">num_caches<pos:position pos:line="180" pos:column="61"/></name></name></expr></argument>)<pos:position pos:line="180" pos:column="62"/></argument_list></sizeof></expr>;<pos:position pos:line="180" pos:column="63"/></expr_stmt>

                <if pos:line="182" pos:column="17">if <condition pos:line="182" pos:column="20">(<expr><name pos:line="182" pos:column="21">num_caches<pos:position pos:line="182" pos:column="31"/></name></expr>)<pos:position pos:line="182" pos:column="32"/></condition><then pos:line="182" pos:column="32"> <block pos:line="182" pos:column="33">{
                    <decl_stmt><decl><type><name pos:line="183" pos:column="21">int<pos:position pos:line="183" pos:column="24"/></name></type> <name pos:line="183" pos:column="25">cache<pos:position pos:line="183" pos:column="30"/></name></decl>;<pos:position pos:line="183" pos:column="31"/></decl_stmt>

                    <for pos:line="185" pos:column="21">for <control pos:line="185" pos:column="25">(<init><expr><name pos:line="185" pos:column="26">cache<pos:position pos:line="185" pos:column="31"/></name> <operator pos:line="185" pos:column="32">=<pos:position pos:line="185" pos:column="33"/></operator> <literal type="number" pos:line="185" pos:column="34">0<pos:position pos:line="185" pos:column="35"/></literal></expr><operator pos:line="185" pos:column="35">,<pos:position pos:line="185" pos:column="36"/></operator> <expr><name pos:line="185" pos:column="37">cache_list_ptr<pos:position pos:line="185" pos:column="51"/></name> <operator pos:line="185" pos:column="52">=<pos:position pos:line="185" pos:column="53"/></operator> <operator pos:line="185" pos:column="54">&amp;<pos:position pos:line="185" pos:column="59"/></operator><name><name pos:line="185" pos:column="55">router_list_ptr<pos:position pos:line="185" pos:column="70"/></name><operator pos:line="185" pos:column="70">-&gt;<pos:position pos:line="185" pos:column="75"/></operator><name pos:line="185" pos:column="72">cache_list_head<pos:position pos:line="185" pos:column="87"/></name></name></expr>;<pos:position pos:line="185" pos:column="88"/></init> <condition><expr><name><name pos:line="185" pos:column="89">cache_list_ptr<pos:position pos:line="185" pos:column="103"/></name><operator pos:line="185" pos:column="103">-&gt;<pos:position pos:line="185" pos:column="108"/></operator><name pos:line="185" pos:column="105">next<pos:position pos:line="185" pos:column="109"/></name></name></expr>;<pos:position pos:line="185" pos:column="110"/></condition> <incr><expr><name pos:line="185" pos:column="111">cache_list_ptr<pos:position pos:line="185" pos:column="125"/></name> <operator pos:line="185" pos:column="126">=<pos:position pos:line="185" pos:column="127"/></operator> <name><name pos:line="185" pos:column="128">cache_list_ptr<pos:position pos:line="185" pos:column="142"/></name><operator pos:line="185" pos:column="142">-&gt;<pos:position pos:line="185" pos:column="147"/></operator><name pos:line="185" pos:column="144">next<pos:position pos:line="185" pos:column="148"/></name></name></expr><operator pos:line="185" pos:column="148">,<pos:position pos:line="185" pos:column="149"/></operator> <expr><operator pos:line="185" pos:column="150">++<pos:position pos:line="185" pos:column="152"/></operator><name pos:line="185" pos:column="152">cache<pos:position pos:line="185" pos:column="157"/></name></expr></incr>)<pos:position pos:line="185" pos:column="158"/></control> <block pos:line="185" pos:column="159">{
                        <comment type="block" pos:line="186" pos:column="25">/* add caches */</comment>

                        <expr_stmt><expr><name pos:line="188" pos:column="25">cache_address<pos:position pos:line="188" pos:column="38"/></name> <operator pos:line="188" pos:column="39">=<pos:position pos:line="188" pos:column="40"/></operator> <operator pos:line="188" pos:column="41">(<pos:position pos:line="188" pos:column="42"/></operator>struct <name pos:line="188" pos:column="49">in_addr<pos:position pos:line="188" pos:column="56"/></name> <operator pos:line="188" pos:column="57">*<pos:position pos:line="188" pos:column="58"/></operator><operator pos:line="188" pos:column="58">)<pos:position pos:line="188" pos:column="59"/></operator> <operator pos:line="188" pos:column="60">&amp;<pos:position pos:line="188" pos:column="65"/></operator><name><name pos:line="188" pos:column="61">wccp_packet<pos:position pos:line="188" pos:column="72"/></name><index pos:line="188" pos:column="72">[<expr><name pos:line="188" pos:column="73">offset<pos:position pos:line="188" pos:column="79"/></name></expr>]<pos:position pos:line="188" pos:column="80"/></index></name></expr>;<pos:position pos:line="188" pos:column="81"/></expr_stmt>

                        <expr_stmt><expr><call><name pos:line="190" pos:column="25">memcpy<pos:position pos:line="190" pos:column="31"/></name><argument_list pos:line="190" pos:column="31">(<argument><expr><name pos:line="190" pos:column="32">cache_address<pos:position pos:line="190" pos:column="45"/></name></expr></argument>, <argument><expr><operator pos:line="190" pos:column="47">&amp;<pos:position pos:line="190" pos:column="52"/></operator><name><name pos:line="190" pos:column="48">cache_list_ptr<pos:position pos:line="190" pos:column="62"/></name><operator pos:line="190" pos:column="62">-&gt;<pos:position pos:line="190" pos:column="67"/></operator><name pos:line="190" pos:column="64">cache_ip<pos:position pos:line="190" pos:column="72"/></name></name></expr></argument>, <argument><expr><sizeof pos:line="190" pos:column="74">sizeof<argument_list pos:line="190" pos:column="80">(<argument><expr pos:line="190" pos:column="81">struct <name pos:line="190" pos:column="88">in_addr<pos:position pos:line="190" pos:column="95"/></name></expr></argument>)<pos:position pos:line="190" pos:column="96"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="190" pos:column="97"/></argument_list></call></expr>;<pos:position pos:line="190" pos:column="98"/></expr_stmt>
                        <expr_stmt><expr><name pos:line="191" pos:column="25">total_weight<pos:position pos:line="191" pos:column="37"/></name> <operator pos:line="191" pos:column="38">+=<pos:position pos:line="191" pos:column="40"/></operator> <name><name pos:line="191" pos:column="41">cache_list_ptr<pos:position pos:line="191" pos:column="55"/></name><operator pos:line="191" pos:column="55">-&gt;<pos:position pos:line="191" pos:column="60"/></operator><name pos:line="191" pos:column="57">weight<pos:position pos:line="191" pos:column="63"/></name></name> <operator pos:line="191" pos:column="64">&lt;&lt;<pos:position pos:line="191" pos:column="72"/></operator> <literal type="number" pos:line="191" pos:column="67">12<pos:position pos:line="191" pos:column="69"/></literal></expr>;<pos:position pos:line="191" pos:column="70"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="192" pos:column="25">weight<pos:position pos:line="192" pos:column="31"/></name><index pos:line="192" pos:column="31">[<expr><name pos:line="192" pos:column="32">cache<pos:position pos:line="192" pos:column="37"/></name></expr>]<pos:position pos:line="192" pos:column="38"/></index></name> <operator pos:line="192" pos:column="39">=<pos:position pos:line="192" pos:column="40"/></operator> <name><name pos:line="192" pos:column="41">cache_list_ptr<pos:position pos:line="192" pos:column="55"/></name><operator pos:line="192" pos:column="55">-&gt;<pos:position pos:line="192" pos:column="60"/></operator><name pos:line="192" pos:column="57">weight<pos:position pos:line="192" pos:column="63"/></name></name> <operator pos:line="192" pos:column="64">&lt;&lt;<pos:position pos:line="192" pos:column="72"/></operator> <literal type="number" pos:line="192" pos:column="67">12<pos:position pos:line="192" pos:column="69"/></literal></expr>;<pos:position pos:line="192" pos:column="70"/></expr_stmt>

                        <expr_stmt><expr><name pos:line="194" pos:column="25">offset<pos:position pos:line="194" pos:column="31"/></name> <operator pos:line="194" pos:column="32">+=<pos:position pos:line="194" pos:column="34"/></operator> <sizeof pos:line="194" pos:column="35">sizeof<argument_list pos:line="194" pos:column="41">(<argument><expr pos:line="194" pos:column="42">struct <name pos:line="194" pos:column="49">in_addr<pos:position pos:line="194" pos:column="56"/></name></expr></argument>)<pos:position pos:line="194" pos:column="57"/></argument_list></sizeof></expr>;<pos:position pos:line="194" pos:column="58"/></expr_stmt>
                    }<pos:position pos:line="195" pos:column="22"/></block></for>
                }<pos:position pos:line="196" pos:column="18"/></block></then></if>

                <comment type="block" pos:line="198" pos:column="17">/* Add buckets */</comment>
                <expr_stmt><expr><name pos:line="199" pos:column="17">buckets<pos:position pos:line="199" pos:column="24"/></name> <operator pos:line="199" pos:column="25">=<pos:position pos:line="199" pos:column="26"/></operator> <operator pos:line="199" pos:column="27">(<pos:position pos:line="199" pos:column="28"/></operator><name pos:line="199" pos:column="28">char<pos:position pos:line="199" pos:column="32"/></name> <operator pos:line="199" pos:column="33">*<pos:position pos:line="199" pos:column="34"/></operator><operator pos:line="199" pos:column="34">)<pos:position pos:line="199" pos:column="35"/></operator> <operator pos:line="199" pos:column="36">&amp;<pos:position pos:line="199" pos:column="41"/></operator><name><name pos:line="199" pos:column="37">wccp_packet<pos:position pos:line="199" pos:column="48"/></name><index pos:line="199" pos:column="48">[<expr><name pos:line="199" pos:column="49">offset<pos:position pos:line="199" pos:column="55"/></name></expr>]<pos:position pos:line="199" pos:column="56"/></index></name></expr>;<pos:position pos:line="199" pos:column="57"/></expr_stmt>

                <expr_stmt><expr><call><name pos:line="201" pos:column="17">memset<pos:position pos:line="201" pos:column="23"/></name><argument_list pos:line="201" pos:column="23">(<argument><expr><name pos:line="201" pos:column="24">buckets<pos:position pos:line="201" pos:column="31"/></name></expr></argument>, <argument><expr><literal type="char" pos:line="201" pos:column="33">'\0'<pos:position pos:line="201" pos:column="37"/></literal></expr></argument>, <argument><expr><name pos:line="201" pos:column="39">WCCP_BUCKETS<pos:position pos:line="201" pos:column="51"/></name></expr></argument>)<pos:position pos:line="201" pos:column="52"/></argument_list></call></expr>;<pos:position pos:line="201" pos:column="53"/></expr_stmt>

                <if pos:line="203" pos:column="17">if <condition pos:line="203" pos:column="20">(<expr><name pos:line="203" pos:column="21">num_caches<pos:position pos:line="203" pos:column="31"/></name> <operator pos:line="203" pos:column="32">!=<pos:position pos:line="203" pos:column="34"/></operator> <literal type="number" pos:line="203" pos:column="35">0<pos:position pos:line="203" pos:column="36"/></literal></expr>)<pos:position pos:line="203" pos:column="37"/></condition><then pos:line="203" pos:column="37"> <block pos:line="203" pos:column="38">{
                    <if pos:line="204" pos:column="21">if <condition pos:line="204" pos:column="24">(<expr><name pos:line="204" pos:column="25">total_weight<pos:position pos:line="204" pos:column="37"/></name> <operator pos:line="204" pos:column="38">==<pos:position pos:line="204" pos:column="40"/></operator> <literal type="number" pos:line="204" pos:column="41">0<pos:position pos:line="204" pos:column="42"/></literal></expr>)<pos:position pos:line="204" pos:column="43"/></condition><then pos:line="204" pos:column="43"> <block pos:line="204" pos:column="44">{
                        <for pos:line="205" pos:column="25">for <control pos:line="205" pos:column="29">(<init><expr><name pos:line="205" pos:column="30">bucket_counter<pos:position pos:line="205" pos:column="44"/></name> <operator pos:line="205" pos:column="45">=<pos:position pos:line="205" pos:column="46"/></operator> <literal type="number" pos:line="205" pos:column="47">0<pos:position pos:line="205" pos:column="48"/></literal></expr>;<pos:position pos:line="205" pos:column="49"/></init> <condition><expr><name pos:line="205" pos:column="50">bucket_counter<pos:position pos:line="205" pos:column="64"/></name> <operator pos:line="205" pos:column="65">&lt;<pos:position pos:line="205" pos:column="69"/></operator> <name pos:line="205" pos:column="67">WCCP_BUCKETS<pos:position pos:line="205" pos:column="79"/></name></expr>;<pos:position pos:line="205" pos:column="80"/></condition> <incr><expr><operator pos:line="205" pos:column="81">++<pos:position pos:line="205" pos:column="83"/></operator><name pos:line="205" pos:column="83">bucket_counter<pos:position pos:line="205" pos:column="97"/></name></expr></incr>)<pos:position pos:line="205" pos:column="98"/></control> <block pos:line="205" pos:column="99">{
                            <expr_stmt><expr><name><name pos:line="206" pos:column="29">buckets<pos:position pos:line="206" pos:column="36"/></name><index pos:line="206" pos:column="36">[<expr><name pos:line="206" pos:column="37">bucket_counter<pos:position pos:line="206" pos:column="51"/></name></expr>]<pos:position pos:line="206" pos:column="52"/></index></name> <operator pos:line="206" pos:column="53">=<pos:position pos:line="206" pos:column="54"/></operator> <call pos:line="206" pos:column="55">(<name pos:line="206" pos:column="56">char<pos:position pos:line="206" pos:column="60"/></name>) <argument_list pos:line="206" pos:column="62">(<argument><expr><name pos:line="206" pos:column="63">bucket_counter<pos:position pos:line="206" pos:column="77"/></name> <operator pos:line="206" pos:column="78">%<pos:position pos:line="206" pos:column="79"/></operator> <name pos:line="206" pos:column="80">num_caches<pos:position pos:line="206" pos:column="90"/></name></expr></argument>)<pos:position pos:line="206" pos:column="91"/></argument_list></call></expr>;<pos:position pos:line="206" pos:column="92"/></expr_stmt>
                        }<pos:position pos:line="207" pos:column="26"/></block></for>
                    }<pos:position pos:line="208" pos:column="22"/></block></then> <else pos:line="208" pos:column="23">else <block pos:line="208" pos:column="28">{
                        <decl_stmt><decl><type><name pos:line="209" pos:column="25">unsigned<pos:position pos:line="209" pos:column="33"/></name> <name pos:line="209" pos:column="34">long<pos:position pos:line="209" pos:column="38"/></name> <modifier pos:line="209" pos:column="39">*<pos:position pos:line="209" pos:column="40"/></modifier></type><name pos:line="209" pos:column="40">assigned<pos:position pos:line="209" pos:column="48"/></name> <init pos:line="209" pos:column="49">= <expr><operator pos:line="209" pos:column="51">(<pos:position pos:line="209" pos:column="52"/></operator><name pos:line="209" pos:column="52">unsigned<pos:position pos:line="209" pos:column="60"/></name> <name pos:line="209" pos:column="61">long<pos:position pos:line="209" pos:column="65"/></name> <operator pos:line="209" pos:column="66">*<pos:position pos:line="209" pos:column="67"/></operator><operator pos:line="209" pos:column="67">)<pos:position pos:line="209" pos:column="68"/></operator><call><name pos:line="209" pos:column="68">xcalloc<pos:position pos:line="209" pos:column="75"/></name><argument_list pos:line="209" pos:column="75">(<argument><expr><sizeof pos:line="209" pos:column="76">sizeof<argument_list pos:line="209" pos:column="82">(<argument><expr><operator pos:line="209" pos:column="83">*<pos:position pos:line="209" pos:column="84"/></operator><name pos:line="209" pos:column="84">assigned<pos:position pos:line="209" pos:column="92"/></name></expr></argument>)<pos:position pos:line="209" pos:column="93"/></argument_list></sizeof></expr></argument>, <argument><expr><name pos:line="209" pos:column="95">num_caches<pos:position pos:line="209" pos:column="105"/></name></expr></argument>)<pos:position pos:line="209" pos:column="106"/></argument_list></call></expr></init></decl>;<pos:position pos:line="209" pos:column="107"/></decl_stmt>
                        <decl_stmt><decl><type><name pos:line="210" pos:column="25">unsigned<pos:position pos:line="210" pos:column="33"/></name> <name pos:line="210" pos:column="34">long<pos:position pos:line="210" pos:column="38"/></name></type> <name pos:line="210" pos:column="39">done<pos:position pos:line="210" pos:column="43"/></name> <init pos:line="210" pos:column="44">= <expr><literal type="number" pos:line="210" pos:column="46">0<pos:position pos:line="210" pos:column="47"/></literal></expr></init></decl>;<pos:position pos:line="210" pos:column="48"/></decl_stmt>
                        <decl_stmt><decl><type><name pos:line="211" pos:column="25">int<pos:position pos:line="211" pos:column="28"/></name></type> <name pos:line="211" pos:column="29">cache<pos:position pos:line="211" pos:column="34"/></name> <init pos:line="211" pos:column="35">= <expr><operator pos:line="211" pos:column="37">-<pos:position pos:line="211" pos:column="38"/></operator><literal type="number" pos:line="211" pos:column="38">1<pos:position pos:line="211" pos:column="39"/></literal></expr></init></decl>;<pos:position pos:line="211" pos:column="40"/></decl_stmt>
                        <decl_stmt><decl><type><name pos:line="212" pos:column="25">unsigned<pos:position pos:line="212" pos:column="33"/></name> <name pos:line="212" pos:column="34">long<pos:position pos:line="212" pos:column="38"/></name></type> <name pos:line="212" pos:column="39">per_bucket<pos:position pos:line="212" pos:column="49"/></name> <init pos:line="212" pos:column="50">= <expr><name pos:line="212" pos:column="52">total_weight<pos:position pos:line="212" pos:column="64"/></name> <operator pos:line="212" pos:column="65">/<pos:position pos:line="212" pos:column="66"/></operator> <name pos:line="212" pos:column="67">WCCP_BUCKETS<pos:position pos:line="212" pos:column="79"/></name></expr></init></decl>;<pos:position pos:line="212" pos:column="80"/></decl_stmt>

                        <for pos:line="214" pos:column="25">for <control pos:line="214" pos:column="29">(<init><expr><name pos:line="214" pos:column="30">bucket_counter<pos:position pos:line="214" pos:column="44"/></name> <operator pos:line="214" pos:column="45">=<pos:position pos:line="214" pos:column="46"/></operator> <literal type="number" pos:line="214" pos:column="47">0<pos:position pos:line="214" pos:column="48"/></literal></expr>;<pos:position pos:line="214" pos:column="49"/></init> <condition><expr><name pos:line="214" pos:column="50">bucket_counter<pos:position pos:line="214" pos:column="64"/></name> <operator pos:line="214" pos:column="65">&lt;<pos:position pos:line="214" pos:column="69"/></operator> <name pos:line="214" pos:column="67">WCCP_BUCKETS<pos:position pos:line="214" pos:column="79"/></name></expr>;<pos:position pos:line="214" pos:column="80"/></condition> <incr><expr><operator pos:line="214" pos:column="81">++<pos:position pos:line="214" pos:column="83"/></operator><name pos:line="214" pos:column="83">bucket_counter<pos:position pos:line="214" pos:column="97"/></name></expr></incr>)<pos:position pos:line="214" pos:column="98"/></control> <block pos:line="214" pos:column="99">{
                            <decl_stmt><decl><type><name pos:line="215" pos:column="29">int<pos:position pos:line="215" pos:column="32"/></name></type> <name pos:line="215" pos:column="33">n<pos:position pos:line="215" pos:column="34"/></name></decl>;<pos:position pos:line="215" pos:column="35"/></decl_stmt>
                            <decl_stmt><decl><type><name pos:line="216" pos:column="29">unsigned<pos:position pos:line="216" pos:column="37"/></name> <name pos:line="216" pos:column="38">long<pos:position pos:line="216" pos:column="42"/></name></type> <name pos:line="216" pos:column="43">step<pos:position pos:line="216" pos:column="47"/></name></decl>;<pos:position pos:line="216" pos:column="48"/></decl_stmt>

                            <for pos:line="218" pos:column="29">for <control pos:line="218" pos:column="33">(<init><expr><name pos:line="218" pos:column="34">n<pos:position pos:line="218" pos:column="35"/></name> <operator pos:line="218" pos:column="36">=<pos:position pos:line="218" pos:column="37"/></operator> <name pos:line="218" pos:column="38">num_caches<pos:position pos:line="218" pos:column="48"/></name></expr>;<pos:position pos:line="218" pos:column="49"/></init> <condition><expr><name pos:line="218" pos:column="50">n<pos:position pos:line="218" pos:column="51"/></name></expr>;<pos:position pos:line="218" pos:column="52"/></condition> <incr><expr><operator pos:line="218" pos:column="53">--<pos:position pos:line="218" pos:column="55"/></operator><name pos:line="218" pos:column="55">n<pos:position pos:line="218" pos:column="56"/></name></expr></incr>)<pos:position pos:line="218" pos:column="57"/></control> <block pos:line="218" pos:column="58">{
                                <expr_stmt><expr><operator pos:line="219" pos:column="33">++<pos:position pos:line="219" pos:column="35"/></operator><name pos:line="219" pos:column="35">cache<pos:position pos:line="219" pos:column="40"/></name></expr>;<pos:position pos:line="219" pos:column="41"/></expr_stmt>

                                <if pos:line="221" pos:column="33">if <condition pos:line="221" pos:column="36">(<expr><name pos:line="221" pos:column="37">cache<pos:position pos:line="221" pos:column="42"/></name> <operator pos:line="221" pos:column="43">&gt;=<pos:position pos:line="221" pos:column="48"/></operator> <name pos:line="221" pos:column="46">num_caches<pos:position pos:line="221" pos:column="56"/></name></expr>)<pos:position pos:line="221" pos:column="57"/></condition><then pos:line="221" pos:column="57">
                                    <block type="pseudo"><expr_stmt><expr><name pos:line="222" pos:column="37">cache<pos:position pos:line="222" pos:column="42"/></name> <operator pos:line="222" pos:column="43">=<pos:position pos:line="222" pos:column="44"/></operator> <literal type="number" pos:line="222" pos:column="45">0<pos:position pos:line="222" pos:column="46"/></literal></expr>;<pos:position pos:line="222" pos:column="47"/></expr_stmt></block></then></if>

                                <if pos:line="224" pos:column="33">if <condition pos:line="224" pos:column="36">(<expr><operator pos:line="224" pos:column="37">!<pos:position pos:line="224" pos:column="38"/></operator><name><name pos:line="224" pos:column="38">weight<pos:position pos:line="224" pos:column="44"/></name><index pos:line="224" pos:column="44">[<expr><name pos:line="224" pos:column="45">cache<pos:position pos:line="224" pos:column="50"/></name></expr>]<pos:position pos:line="224" pos:column="51"/></index></name></expr>)<pos:position pos:line="224" pos:column="52"/></condition><then pos:line="224" pos:column="52"> <block pos:line="224" pos:column="53">{
                                    <expr_stmt><expr><operator pos:line="225" pos:column="37">++<pos:position pos:line="225" pos:column="39"/></operator><name pos:line="225" pos:column="39">n<pos:position pos:line="225" pos:column="40"/></name></expr>;<pos:position pos:line="225" pos:column="41"/></expr_stmt>
                                    <continue pos:line="226" pos:column="37">continue;<pos:position pos:line="226" pos:column="46"/></continue>
                                }<pos:position pos:line="227" pos:column="34"/></block></then></if>

                                <if pos:line="229" pos:column="33">if <condition pos:line="229" pos:column="36">(<expr><name><name pos:line="229" pos:column="37">assigned<pos:position pos:line="229" pos:column="45"/></name><index pos:line="229" pos:column="45">[<expr><name pos:line="229" pos:column="46">cache<pos:position pos:line="229" pos:column="51"/></name></expr>]<pos:position pos:line="229" pos:column="52"/></index></name> <operator pos:line="229" pos:column="53">&lt;=<pos:position pos:line="229" pos:column="58"/></operator> <name pos:line="229" pos:column="56">done<pos:position pos:line="229" pos:column="60"/></name></expr>)<pos:position pos:line="229" pos:column="61"/></condition><then pos:line="229" pos:column="61">
                                    <block type="pseudo"><break pos:line="230" pos:column="37">break;<pos:position pos:line="230" pos:column="43"/></break></block></then></if>
                            }<pos:position pos:line="231" pos:column="30"/></block></for>

                            <expr_stmt><expr><name><name pos:line="233" pos:column="29">buckets<pos:position pos:line="233" pos:column="36"/></name><index pos:line="233" pos:column="36">[<expr><name pos:line="233" pos:column="37">bucket_counter<pos:position pos:line="233" pos:column="51"/></name></expr>]<pos:position pos:line="233" pos:column="52"/></index></name> <operator pos:line="233" pos:column="53">=<pos:position pos:line="233" pos:column="54"/></operator> <operator pos:line="233" pos:column="55">(<pos:position pos:line="233" pos:column="56"/></operator><name pos:line="233" pos:column="56">char<pos:position pos:line="233" pos:column="60"/></name><operator pos:line="233" pos:column="60">)<pos:position pos:line="233" pos:column="61"/></operator> <name pos:line="233" pos:column="62">cache<pos:position pos:line="233" pos:column="67"/></name></expr>;<pos:position pos:line="233" pos:column="68"/></expr_stmt>
                            <expr_stmt><expr><name pos:line="234" pos:column="29">step<pos:position pos:line="234" pos:column="33"/></name> <operator pos:line="234" pos:column="34">=<pos:position pos:line="234" pos:column="35"/></operator> <name pos:line="234" pos:column="36">per_bucket<pos:position pos:line="234" pos:column="46"/></name> <operator pos:line="234" pos:column="47">*<pos:position pos:line="234" pos:column="48"/></operator> <name pos:line="234" pos:column="49">total_weight<pos:position pos:line="234" pos:column="61"/></name> <operator pos:line="234" pos:column="62">/<pos:position pos:line="234" pos:column="63"/></operator> <name><name pos:line="234" pos:column="64">weight<pos:position pos:line="234" pos:column="70"/></name><index pos:line="234" pos:column="70">[<expr><name pos:line="234" pos:column="71">cache<pos:position pos:line="234" pos:column="76"/></name></expr>]<pos:position pos:line="234" pos:column="77"/></index></name></expr>;<pos:position pos:line="234" pos:column="78"/></expr_stmt>
                            <expr_stmt><expr><name><name pos:line="235" pos:column="29">assigned<pos:position pos:line="235" pos:column="37"/></name><index pos:line="235" pos:column="37">[<expr><name pos:line="235" pos:column="38">cache<pos:position pos:line="235" pos:column="43"/></name></expr>]<pos:position pos:line="235" pos:column="44"/></index></name> <operator pos:line="235" pos:column="45">+=<pos:position pos:line="235" pos:column="47"/></operator> <name pos:line="235" pos:column="48">step<pos:position pos:line="235" pos:column="52"/></name></expr>;<pos:position pos:line="235" pos:column="53"/></expr_stmt>
                            <expr_stmt><expr><name pos:line="236" pos:column="29">done<pos:position pos:line="236" pos:column="33"/></name> <operator pos:line="236" pos:column="34">+=<pos:position pos:line="236" pos:column="36"/></operator> <name pos:line="236" pos:column="37">per_bucket<pos:position pos:line="236" pos:column="47"/></name></expr>;<pos:position pos:line="236" pos:column="48"/></expr_stmt>
                        }<pos:position pos:line="237" pos:column="26"/></block></for>

                        <expr_stmt><expr><call><name pos:line="239" pos:column="25">safe_free<pos:position pos:line="239" pos:column="34"/></name><argument_list pos:line="239" pos:column="34">(<argument><expr><name pos:line="239" pos:column="35">assigned<pos:position pos:line="239" pos:column="43"/></name></expr></argument>)<pos:position pos:line="239" pos:column="44"/></argument_list></call></expr>;<pos:position pos:line="239" pos:column="45"/></expr_stmt>
                    }<pos:position pos:line="240" pos:column="22"/></block></else></if>
                }<pos:position pos:line="241" pos:column="18"/></block></then></if>

                <expr_stmt><expr><name pos:line="243" pos:column="17">offset<pos:position pos:line="243" pos:column="23"/></name> <operator pos:line="243" pos:column="24">+=<pos:position pos:line="243" pos:column="26"/></operator> <operator pos:line="243" pos:column="27">(<pos:position pos:line="243" pos:column="28"/></operator><name pos:line="243" pos:column="28">WCCP_BUCKETS<pos:position pos:line="243" pos:column="40"/></name> <operator pos:line="243" pos:column="41">*<pos:position pos:line="243" pos:column="42"/></operator> <sizeof pos:line="243" pos:column="43">sizeof<argument_list pos:line="243" pos:column="49">(<argument><expr><name pos:line="243" pos:column="50">char<pos:position pos:line="243" pos:column="54"/></name></expr></argument>)<pos:position pos:line="243" pos:column="55"/></argument_list></sizeof><operator pos:line="243" pos:column="55">)<pos:position pos:line="243" pos:column="56"/></operator></expr>;<pos:position pos:line="243" pos:column="57"/></expr_stmt>
                <expr_stmt><expr><call><name pos:line="244" pos:column="17">safe_free<pos:position pos:line="244" pos:column="26"/></name><argument_list pos:line="244" pos:column="26">(<argument><expr><name pos:line="244" pos:column="27">weight<pos:position pos:line="244" pos:column="33"/></name></expr></argument>)<pos:position pos:line="244" pos:column="34"/></argument_list></call></expr>;<pos:position pos:line="244" pos:column="35"/></expr_stmt>
                <break pos:line="245" pos:column="17">break;<pos:position pos:line="245" pos:column="23"/></break>

            <case pos:line="247" pos:column="13">case <expr><name pos:line="247" pos:column="18">WCCP2_ASSIGNMENT_METHOD_MASK<pos:position pos:line="247" pos:column="46"/></name></expr>:<pos:position pos:line="247" pos:column="47"/></case>
                <expr_stmt><expr><name pos:line="248" pos:column="17">num_maskval<pos:position pos:line="248" pos:column="28"/></name> <operator pos:line="248" pos:column="29">=<pos:position pos:line="248" pos:column="30"/></operator> <call><name pos:line="248" pos:column="31">htonl<pos:position pos:line="248" pos:column="36"/></name><argument_list pos:line="248" pos:column="36">(<argument><expr><literal type="number" pos:line="248" pos:column="37">1<pos:position pos:line="248" pos:column="38"/></literal></expr></argument>)<pos:position pos:line="248" pos:column="39"/></argument_list></call></expr>;<pos:position pos:line="248" pos:column="40"/></expr_stmt>
                <expr_stmt><expr><call><name pos:line="249" pos:column="17">memcpy<pos:position pos:line="249" pos:column="23"/></name><argument_list pos:line="249" pos:column="23">(<argument><expr><operator pos:line="249" pos:column="24">&amp;<pos:position pos:line="249" pos:column="29"/></operator><name><name pos:line="249" pos:column="25">wccp_packet<pos:position pos:line="249" pos:column="36"/></name><index pos:line="249" pos:column="36">[<expr><name pos:line="249" pos:column="37">offset<pos:position pos:line="249" pos:column="43"/></name></expr>]<pos:position pos:line="249" pos:column="44"/></index></name></expr></argument>, <argument><expr><operator pos:line="249" pos:column="46">&amp;<pos:position pos:line="249" pos:column="51"/></operator><name pos:line="249" pos:column="47">num_maskval<pos:position pos:line="249" pos:column="58"/></name></expr></argument>, <argument><expr><sizeof pos:line="249" pos:column="60">sizeof<argument_list pos:line="249" pos:column="66">(<argument><expr><name pos:line="249" pos:column="67">int<pos:position pos:line="249" pos:column="70"/></name></expr></argument>)<pos:position pos:line="249" pos:column="71"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="249" pos:column="72"/></argument_list></call></expr>;<pos:position pos:line="249" pos:column="73"/></expr_stmt>
                <expr_stmt><expr><name pos:line="250" pos:column="17">offset<pos:position pos:line="250" pos:column="23"/></name> <operator pos:line="250" pos:column="24">+=<pos:position pos:line="250" pos:column="26"/></operator> <sizeof pos:line="250" pos:column="27">sizeof<argument_list pos:line="250" pos:column="33">(<argument><expr><name pos:line="250" pos:column="34">int<pos:position pos:line="250" pos:column="37"/></name></expr></argument>)<pos:position pos:line="250" pos:column="38"/></argument_list></sizeof></expr>;<pos:position pos:line="250" pos:column="39"/></expr_stmt>

                <expr_stmt><expr><name pos:line="252" pos:column="17">mask_element<pos:position pos:line="252" pos:column="29"/></name> <operator pos:line="252" pos:column="30">=<pos:position pos:line="252" pos:column="31"/></operator> <operator pos:line="252" pos:column="32">(<pos:position pos:line="252" pos:column="33"/></operator>struct <name pos:line="252" pos:column="40">wccp2_mask_element_t<pos:position pos:line="252" pos:column="60"/></name> <operator pos:line="252" pos:column="61">*<pos:position pos:line="252" pos:column="62"/></operator><operator pos:line="252" pos:column="62">)<pos:position pos:line="252" pos:column="63"/></operator> <operator pos:line="252" pos:column="64">&amp;<pos:position pos:line="252" pos:column="69"/></operator><name><name pos:line="252" pos:column="65">wccp_packet<pos:position pos:line="252" pos:column="76"/></name><index pos:line="252" pos:column="76">[<expr><name pos:line="252" pos:column="77">offset<pos:position pos:line="252" pos:column="83"/></name></expr>]<pos:position pos:line="252" pos:column="84"/></index></name></expr>;<pos:position pos:line="252" pos:column="85"/></expr_stmt>
                <expr_stmt><expr><name pos:line="253" pos:column="17">service_flags<pos:position pos:line="253" pos:column="30"/></name> <operator pos:line="253" pos:column="31">=<pos:position pos:line="253" pos:column="32"/></operator> <call><name pos:line="253" pos:column="33">ntohl<pos:position pos:line="253" pos:column="38"/></name><argument_list pos:line="253" pos:column="38">(<argument><expr><name><name pos:line="253" pos:column="39">service_list_ptr<pos:position pos:line="253" pos:column="55"/></name><operator pos:line="253" pos:column="55">-&gt;<pos:position pos:line="253" pos:column="60"/></operator><name pos:line="253" pos:column="57">service_info<pos:position pos:line="253" pos:column="69"/></name><operator pos:line="253" pos:column="69">-&gt;<pos:position pos:line="253" pos:column="74"/></operator><name pos:line="253" pos:column="71">service_flags<pos:position pos:line="253" pos:column="84"/></name></name></expr></argument>)<pos:position pos:line="253" pos:column="85"/></argument_list></call></expr>;<pos:position pos:line="253" pos:column="86"/></expr_stmt>

                <if pos:line="255" pos:column="17">if <condition pos:line="255" pos:column="20">(<expr><operator pos:line="255" pos:column="21">(<pos:position pos:line="255" pos:column="22"/></operator><name pos:line="255" pos:column="22">service_flags<pos:position pos:line="255" pos:column="35"/></name> <operator pos:line="255" pos:column="36">&amp;<pos:position pos:line="255" pos:column="41"/></operator> <name pos:line="255" pos:column="38">WCCP2_SERVICE_SRC_IP_HASH<pos:position pos:line="255" pos:column="63"/></name><operator pos:line="255" pos:column="63">)<pos:position pos:line="255" pos:column="64"/></operator> <operator pos:line="255" pos:column="65">||<pos:position pos:line="255" pos:column="67"/></operator> <operator pos:line="255" pos:column="68">(<pos:position pos:line="255" pos:column="69"/></operator><name pos:line="255" pos:column="69">service_flags<pos:position pos:line="255" pos:column="82"/></name> <operator pos:line="255" pos:column="83">&amp;<pos:position pos:line="255" pos:column="88"/></operator> <name pos:line="255" pos:column="85">WCCP2_SERVICE_SRC_IP_ALT_HASH<pos:position pos:line="255" pos:column="114"/></name><operator pos:line="255" pos:column="114">)<pos:position pos:line="255" pos:column="115"/></operator></expr>)<pos:position pos:line="255" pos:column="116"/></condition><then pos:line="255" pos:column="116"> <block pos:line="255" pos:column="117">{
                    <expr_stmt><expr><name><name pos:line="256" pos:column="21">mask_element<pos:position pos:line="256" pos:column="33"/></name><operator pos:line="256" pos:column="33">-&gt;<pos:position pos:line="256" pos:column="38"/></operator><name pos:line="256" pos:column="35">source_ip_mask<pos:position pos:line="256" pos:column="49"/></name></name> <operator pos:line="256" pos:column="50">=<pos:position pos:line="256" pos:column="51"/></operator> <call><name pos:line="256" pos:column="52">htonl<pos:position pos:line="256" pos:column="57"/></name><argument_list pos:line="256" pos:column="57">(<argument><expr><literal type="number" pos:line="256" pos:column="58">0x00001741<pos:position pos:line="256" pos:column="68"/></literal></expr></argument>)<pos:position pos:line="256" pos:column="69"/></argument_list></call></expr>;<pos:position pos:line="256" pos:column="70"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="257" pos:column="21">mask_element<pos:position pos:line="257" pos:column="33"/></name><operator pos:line="257" pos:column="33">-&gt;<pos:position pos:line="257" pos:column="38"/></operator><name pos:line="257" pos:column="35">dest_ip_mask<pos:position pos:line="257" pos:column="47"/></name></name> <operator pos:line="257" pos:column="48">=<pos:position pos:line="257" pos:column="49"/></operator> <literal type="number" pos:line="257" pos:column="50">0<pos:position pos:line="257" pos:column="51"/></literal></expr>;<pos:position pos:line="257" pos:column="52"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="258" pos:column="21">mask_element<pos:position pos:line="258" pos:column="33"/></name><operator pos:line="258" pos:column="33">-&gt;<pos:position pos:line="258" pos:column="38"/></operator><name pos:line="258" pos:column="35">source_port_mask<pos:position pos:line="258" pos:column="51"/></name></name> <operator pos:line="258" pos:column="52">=<pos:position pos:line="258" pos:column="53"/></operator> <literal type="number" pos:line="258" pos:column="54">0<pos:position pos:line="258" pos:column="55"/></literal></expr>;<pos:position pos:line="258" pos:column="56"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="259" pos:column="21">mask_element<pos:position pos:line="259" pos:column="33"/></name><operator pos:line="259" pos:column="33">-&gt;<pos:position pos:line="259" pos:column="38"/></operator><name pos:line="259" pos:column="35">dest_port_mask<pos:position pos:line="259" pos:column="49"/></name></name> <operator pos:line="259" pos:column="50">=<pos:position pos:line="259" pos:column="51"/></operator> <literal type="number" pos:line="259" pos:column="52">0<pos:position pos:line="259" pos:column="53"/></literal></expr>;<pos:position pos:line="259" pos:column="54"/></expr_stmt>
                }<pos:position pos:line="260" pos:column="18"/></block></then> <elseif pos:line="260" pos:column="19">else <if pos:line="260" pos:column="24">if <condition pos:line="260" pos:column="27">(<expr><operator pos:line="260" pos:column="28">(<pos:position pos:line="260" pos:column="29"/></operator><name><name pos:line="260" pos:column="29">service_list_ptr<pos:position pos:line="260" pos:column="45"/></name><operator pos:line="260" pos:column="45">-&gt;<pos:position pos:line="260" pos:column="50"/></operator><name pos:line="260" pos:column="47">info<pos:position pos:line="260" pos:column="51"/></name><operator pos:line="260" pos:column="51">.<pos:position pos:line="260" pos:column="52"/></operator><name pos:line="260" pos:column="52">service<pos:position pos:line="260" pos:column="59"/></name></name> <operator pos:line="260" pos:column="60">==<pos:position pos:line="260" pos:column="62"/></operator> <name pos:line="260" pos:column="63">WCCP2_SERVICE_STANDARD<pos:position pos:line="260" pos:column="85"/></name><operator pos:line="260" pos:column="85">)<pos:position pos:line="260" pos:column="86"/></operator> <operator pos:line="260" pos:column="87">||<pos:position pos:line="260" pos:column="89"/></operator> <operator pos:line="260" pos:column="90">(<pos:position pos:line="260" pos:column="91"/></operator><name pos:line="260" pos:column="91">service_flags<pos:position pos:line="260" pos:column="104"/></name> <operator pos:line="260" pos:column="105">&amp;<pos:position pos:line="260" pos:column="110"/></operator> <name pos:line="260" pos:column="107">WCCP2_SERVICE_DST_IP_HASH<pos:position pos:line="260" pos:column="132"/></name><operator pos:line="260" pos:column="132">)<pos:position pos:line="260" pos:column="133"/></operator> <operator pos:line="260" pos:column="134">||<pos:position pos:line="260" pos:column="136"/></operator> <operator pos:line="260" pos:column="137">(<pos:position pos:line="260" pos:column="138"/></operator><name pos:line="260" pos:column="138">service_flags<pos:position pos:line="260" pos:column="151"/></name> <operator pos:line="260" pos:column="152">&amp;<pos:position pos:line="260" pos:column="157"/></operator> <name pos:line="260" pos:column="154">WCCP2_SERVICE_DST_IP_ALT_HASH<pos:position pos:line="260" pos:column="183"/></name><operator pos:line="260" pos:column="183">)<pos:position pos:line="260" pos:column="184"/></operator></expr>)<pos:position pos:line="260" pos:column="185"/></condition><then pos:line="260" pos:column="185"> <block pos:line="260" pos:column="186">{
                    <expr_stmt><expr><name><name pos:line="261" pos:column="21">mask_element<pos:position pos:line="261" pos:column="33"/></name><operator pos:line="261" pos:column="33">-&gt;<pos:position pos:line="261" pos:column="38"/></operator><name pos:line="261" pos:column="35">source_ip_mask<pos:position pos:line="261" pos:column="49"/></name></name> <operator pos:line="261" pos:column="50">=<pos:position pos:line="261" pos:column="51"/></operator> <literal type="number" pos:line="261" pos:column="52">0<pos:position pos:line="261" pos:column="53"/></literal></expr>;<pos:position pos:line="261" pos:column="54"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="262" pos:column="21">mask_element<pos:position pos:line="262" pos:column="33"/></name><operator pos:line="262" pos:column="33">-&gt;<pos:position pos:line="262" pos:column="38"/></operator><name pos:line="262" pos:column="35">dest_ip_mask<pos:position pos:line="262" pos:column="47"/></name></name> <operator pos:line="262" pos:column="48">=<pos:position pos:line="262" pos:column="49"/></operator> <call><name pos:line="262" pos:column="50">htonl<pos:position pos:line="262" pos:column="55"/></name><argument_list pos:line="262" pos:column="55">(<argument><expr><literal type="number" pos:line="262" pos:column="56">0x00001741<pos:position pos:line="262" pos:column="66"/></literal></expr></argument>)<pos:position pos:line="262" pos:column="67"/></argument_list></call></expr>;<pos:position pos:line="262" pos:column="68"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="263" pos:column="21">mask_element<pos:position pos:line="263" pos:column="33"/></name><operator pos:line="263" pos:column="33">-&gt;<pos:position pos:line="263" pos:column="38"/></operator><name pos:line="263" pos:column="35">source_port_mask<pos:position pos:line="263" pos:column="51"/></name></name> <operator pos:line="263" pos:column="52">=<pos:position pos:line="263" pos:column="53"/></operator> <literal type="number" pos:line="263" pos:column="54">0<pos:position pos:line="263" pos:column="55"/></literal></expr>;<pos:position pos:line="263" pos:column="56"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="264" pos:column="21">mask_element<pos:position pos:line="264" pos:column="33"/></name><operator pos:line="264" pos:column="33">-&gt;<pos:position pos:line="264" pos:column="38"/></operator><name pos:line="264" pos:column="35">dest_port_mask<pos:position pos:line="264" pos:column="49"/></name></name> <operator pos:line="264" pos:column="50">=<pos:position pos:line="264" pos:column="51"/></operator> <literal type="number" pos:line="264" pos:column="52">0<pos:position pos:line="264" pos:column="53"/></literal></expr>;<pos:position pos:line="264" pos:column="54"/></expr_stmt>
                }<pos:position pos:line="265" pos:column="18"/></block></then></if></elseif> <elseif pos:line="265" pos:column="19">else <if pos:line="265" pos:column="24">if <condition pos:line="265" pos:column="27">(<expr><operator pos:line="265" pos:column="28">(<pos:position pos:line="265" pos:column="29"/></operator><name pos:line="265" pos:column="29">service_flags<pos:position pos:line="265" pos:column="42"/></name> <operator pos:line="265" pos:column="43">&amp;<pos:position pos:line="265" pos:column="48"/></operator> <name pos:line="265" pos:column="45">WCCP2_SERVICE_SRC_PORT_HASH<pos:position pos:line="265" pos:column="72"/></name><operator pos:line="265" pos:column="72">)<pos:position pos:line="265" pos:column="73"/></operator> <operator pos:line="265" pos:column="74">||<pos:position pos:line="265" pos:column="76"/></operator> <operator pos:line="265" pos:column="77">(<pos:position pos:line="265" pos:column="78"/></operator><name pos:line="265" pos:column="78">service_flags<pos:position pos:line="265" pos:column="91"/></name> <operator pos:line="265" pos:column="92">&amp;<pos:position pos:line="265" pos:column="97"/></operator> <name pos:line="265" pos:column="94">WCCP2_SERVICE_SRC_PORT_ALT_HASH<pos:position pos:line="265" pos:column="125"/></name><operator pos:line="265" pos:column="125">)<pos:position pos:line="265" pos:column="126"/></operator></expr>)<pos:position pos:line="265" pos:column="127"/></condition><then pos:line="265" pos:column="127"> <block pos:line="265" pos:column="128">{
                    <expr_stmt><expr><name><name pos:line="266" pos:column="21">mask_element<pos:position pos:line="266" pos:column="33"/></name><operator pos:line="266" pos:column="33">-&gt;<pos:position pos:line="266" pos:column="38"/></operator><name pos:line="266" pos:column="35">source_ip_mask<pos:position pos:line="266" pos:column="49"/></name></name> <operator pos:line="266" pos:column="50">=<pos:position pos:line="266" pos:column="51"/></operator> <literal type="number" pos:line="266" pos:column="52">0<pos:position pos:line="266" pos:column="53"/></literal></expr>;<pos:position pos:line="266" pos:column="54"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="267" pos:column="21">mask_element<pos:position pos:line="267" pos:column="33"/></name><operator pos:line="267" pos:column="33">-&gt;<pos:position pos:line="267" pos:column="38"/></operator><name pos:line="267" pos:column="35">dest_ip_mask<pos:position pos:line="267" pos:column="47"/></name></name> <operator pos:line="267" pos:column="48">=<pos:position pos:line="267" pos:column="49"/></operator> <literal type="number" pos:line="267" pos:column="50">0<pos:position pos:line="267" pos:column="51"/></literal></expr>;<pos:position pos:line="267" pos:column="52"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="268" pos:column="21">mask_element<pos:position pos:line="268" pos:column="33"/></name><operator pos:line="268" pos:column="33">-&gt;<pos:position pos:line="268" pos:column="38"/></operator><name pos:line="268" pos:column="35">source_port_mask<pos:position pos:line="268" pos:column="51"/></name></name> <operator pos:line="268" pos:column="52">=<pos:position pos:line="268" pos:column="53"/></operator> <call><name pos:line="268" pos:column="54">htons<pos:position pos:line="268" pos:column="59"/></name><argument_list pos:line="268" pos:column="59">(<argument><expr><literal type="number" pos:line="268" pos:column="60">0x1741<pos:position pos:line="268" pos:column="66"/></literal></expr></argument>)<pos:position pos:line="268" pos:column="67"/></argument_list></call></expr>;<pos:position pos:line="268" pos:column="68"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="269" pos:column="21">mask_element<pos:position pos:line="269" pos:column="33"/></name><operator pos:line="269" pos:column="33">-&gt;<pos:position pos:line="269" pos:column="38"/></operator><name pos:line="269" pos:column="35">dest_port_mask<pos:position pos:line="269" pos:column="49"/></name></name> <operator pos:line="269" pos:column="50">=<pos:position pos:line="269" pos:column="51"/></operator> <literal type="number" pos:line="269" pos:column="52">0<pos:position pos:line="269" pos:column="53"/></literal></expr>;<pos:position pos:line="269" pos:column="54"/></expr_stmt>
                }<pos:position pos:line="270" pos:column="18"/></block></then></if></elseif> <elseif pos:line="270" pos:column="19">else <if pos:line="270" pos:column="24">if <condition pos:line="270" pos:column="27">(<expr><operator pos:line="270" pos:column="28">(<pos:position pos:line="270" pos:column="29"/></operator><name pos:line="270" pos:column="29">service_flags<pos:position pos:line="270" pos:column="42"/></name> <operator pos:line="270" pos:column="43">&amp;<pos:position pos:line="270" pos:column="48"/></operator> <name pos:line="270" pos:column="45">WCCP2_SERVICE_DST_PORT_HASH<pos:position pos:line="270" pos:column="72"/></name><operator pos:line="270" pos:column="72">)<pos:position pos:line="270" pos:column="73"/></operator> <operator pos:line="270" pos:column="74">||<pos:position pos:line="270" pos:column="76"/></operator> <operator pos:line="270" pos:column="77">(<pos:position pos:line="270" pos:column="78"/></operator><name pos:line="270" pos:column="78">service_flags<pos:position pos:line="270" pos:column="91"/></name> <operator pos:line="270" pos:column="92">&amp;<pos:position pos:line="270" pos:column="97"/></operator> <name pos:line="270" pos:column="94">WCCP2_SERVICE_DST_PORT_ALT_HASH<pos:position pos:line="270" pos:column="125"/></name><operator pos:line="270" pos:column="125">)<pos:position pos:line="270" pos:column="126"/></operator></expr>)<pos:position pos:line="270" pos:column="127"/></condition><then pos:line="270" pos:column="127"> <block pos:line="270" pos:column="128">{
                    <expr_stmt><expr><name><name pos:line="271" pos:column="21">mask_element<pos:position pos:line="271" pos:column="33"/></name><operator pos:line="271" pos:column="33">-&gt;<pos:position pos:line="271" pos:column="38"/></operator><name pos:line="271" pos:column="35">source_ip_mask<pos:position pos:line="271" pos:column="49"/></name></name> <operator pos:line="271" pos:column="50">=<pos:position pos:line="271" pos:column="51"/></operator> <literal type="number" pos:line="271" pos:column="52">0<pos:position pos:line="271" pos:column="53"/></literal></expr>;<pos:position pos:line="271" pos:column="54"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="272" pos:column="21">mask_element<pos:position pos:line="272" pos:column="33"/></name><operator pos:line="272" pos:column="33">-&gt;<pos:position pos:line="272" pos:column="38"/></operator><name pos:line="272" pos:column="35">dest_ip_mask<pos:position pos:line="272" pos:column="47"/></name></name> <operator pos:line="272" pos:column="48">=<pos:position pos:line="272" pos:column="49"/></operator> <literal type="number" pos:line="272" pos:column="50">0<pos:position pos:line="272" pos:column="51"/></literal></expr>;<pos:position pos:line="272" pos:column="52"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="273" pos:column="21">mask_element<pos:position pos:line="273" pos:column="33"/></name><operator pos:line="273" pos:column="33">-&gt;<pos:position pos:line="273" pos:column="38"/></operator><name pos:line="273" pos:column="35">source_port_mask<pos:position pos:line="273" pos:column="51"/></name></name> <operator pos:line="273" pos:column="52">=<pos:position pos:line="273" pos:column="53"/></operator> <literal type="number" pos:line="273" pos:column="54">0<pos:position pos:line="273" pos:column="55"/></literal></expr>;<pos:position pos:line="273" pos:column="56"/></expr_stmt>
                    <expr_stmt><expr><name><name pos:line="274" pos:column="21">mask_element<pos:position pos:line="274" pos:column="33"/></name><operator pos:line="274" pos:column="33">-&gt;<pos:position pos:line="274" pos:column="38"/></operator><name pos:line="274" pos:column="35">dest_port_mask<pos:position pos:line="274" pos:column="49"/></name></name> <operator pos:line="274" pos:column="50">=<pos:position pos:line="274" pos:column="51"/></operator> <call><name pos:line="274" pos:column="52">htons<pos:position pos:line="274" pos:column="57"/></name><argument_list pos:line="274" pos:column="57">(<argument><expr><literal type="number" pos:line="274" pos:column="58">0x1741<pos:position pos:line="274" pos:column="64"/></literal></expr></argument>)<pos:position pos:line="274" pos:column="65"/></argument_list></call></expr>;<pos:position pos:line="274" pos:column="66"/></expr_stmt>
                }<pos:position pos:line="275" pos:column="18"/></block></then></if></elseif> <else pos:line="275" pos:column="19">else <block pos:line="275" pos:column="24">{
                    <expr_stmt><expr><call><name pos:line="276" pos:column="21">fatalf<pos:position pos:line="276" pos:column="27"/></name><argument_list pos:line="276" pos:column="27">(<argument><expr><literal type="string" pos:line="276" pos:column="28">"Unknown service hash method\n"<pos:position pos:line="276" pos:column="59"/></literal></expr></argument>)<pos:position pos:line="276" pos:column="60"/></argument_list></call></expr>;<pos:position pos:line="276" pos:column="61"/></expr_stmt>
                }<pos:position pos:line="277" pos:column="18"/></block></else></if>

                <expr_stmt><expr><name><name pos:line="279" pos:column="17">mask_element<pos:position pos:line="279" pos:column="29"/></name><operator pos:line="279" pos:column="29">-&gt;<pos:position pos:line="279" pos:column="34"/></operator><name pos:line="279" pos:column="31">number_values<pos:position pos:line="279" pos:column="44"/></name></name> <operator pos:line="279" pos:column="45">=<pos:position pos:line="279" pos:column="46"/></operator> <call><name pos:line="279" pos:column="47">htonl<pos:position pos:line="279" pos:column="52"/></name><argument_list pos:line="279" pos:column="52">(<argument><expr><literal type="number" pos:line="279" pos:column="53">64<pos:position pos:line="279" pos:column="55"/></literal></expr></argument>)<pos:position pos:line="279" pos:column="56"/></argument_list></call></expr>;<pos:position pos:line="279" pos:column="57"/></expr_stmt>

                <expr_stmt><expr><name pos:line="281" pos:column="17">offset<pos:position pos:line="281" pos:column="23"/></name> <operator pos:line="281" pos:column="24">+=<pos:position pos:line="281" pos:column="26"/></operator> <sizeof pos:line="281" pos:column="27">sizeof<argument_list pos:line="281" pos:column="33">(<argument><expr pos:line="281" pos:column="34">struct <name pos:line="281" pos:column="41">wccp2_mask_element_t<pos:position pos:line="281" pos:column="61"/></name></expr></argument>)<pos:position pos:line="281" pos:column="62"/></argument_list></sizeof></expr>;<pos:position pos:line="281" pos:column="63"/></expr_stmt>

                <expr_stmt><expr><name pos:line="283" pos:column="17">cache_list_ptr<pos:position pos:line="283" pos:column="31"/></name> <operator pos:line="283" pos:column="32">=<pos:position pos:line="283" pos:column="33"/></operator> <operator pos:line="283" pos:column="34">&amp;<pos:position pos:line="283" pos:column="39"/></operator><name><name pos:line="283" pos:column="35">router_list_ptr<pos:position pos:line="283" pos:column="50"/></name><operator pos:line="283" pos:column="50">-&gt;<pos:position pos:line="283" pos:column="55"/></operator><name pos:line="283" pos:column="52">cache_list_head<pos:position pos:line="283" pos:column="67"/></name></name></expr>;<pos:position pos:line="283" pos:column="68"/></expr_stmt>
                <expr_stmt><expr><name pos:line="284" pos:column="17">value<pos:position pos:line="284" pos:column="22"/></name> <operator pos:line="284" pos:column="23">=<pos:position pos:line="284" pos:column="24"/></operator> <literal type="number" pos:line="284" pos:column="25">0<pos:position pos:line="284" pos:column="26"/></literal></expr>;<pos:position pos:line="284" pos:column="27"/></expr_stmt>

                <for pos:line="286" pos:column="17">for <control pos:line="286" pos:column="21">(<init><expr><name pos:line="286" pos:column="22">valuecounter<pos:position pos:line="286" pos:column="34"/></name> <operator pos:line="286" pos:column="35">=<pos:position pos:line="286" pos:column="36"/></operator> <literal type="number" pos:line="286" pos:column="37">0<pos:position pos:line="286" pos:column="38"/></literal></expr>;<pos:position pos:line="286" pos:column="39"/></init> <condition><expr><name pos:line="286" pos:column="40">valuecounter<pos:position pos:line="286" pos:column="52"/></name> <operator pos:line="286" pos:column="53">&lt;<pos:position pos:line="286" pos:column="57"/></operator> <literal type="number" pos:line="286" pos:column="55">64<pos:position pos:line="286" pos:column="57"/></literal></expr>;<pos:position pos:line="286" pos:column="58"/></condition> <incr><expr><operator pos:line="286" pos:column="59">++<pos:position pos:line="286" pos:column="61"/></operator><name pos:line="286" pos:column="61">valuecounter<pos:position pos:line="286" pos:column="73"/></name></expr></incr>)<pos:position pos:line="286" pos:column="74"/></control> <block pos:line="286" pos:column="75">{

                    <expr_stmt><expr><name pos:line="288" pos:column="21">value_element<pos:position pos:line="288" pos:column="34"/></name> <operator pos:line="288" pos:column="35">=<pos:position pos:line="288" pos:column="36"/></operator> <operator pos:line="288" pos:column="37">(<pos:position pos:line="288" pos:column="38"/></operator>struct <name pos:line="288" pos:column="45">wccp2_value_element_t<pos:position pos:line="288" pos:column="66"/></name> <operator pos:line="288" pos:column="67">*<pos:position pos:line="288" pos:column="68"/></operator><operator pos:line="288" pos:column="68">)<pos:position pos:line="288" pos:column="69"/></operator> <operator pos:line="288" pos:column="70">&amp;<pos:position pos:line="288" pos:column="75"/></operator><name><name pos:line="288" pos:column="71">wccp_packet<pos:position pos:line="288" pos:column="82"/></name><index pos:line="288" pos:column="82">[<expr><name pos:line="288" pos:column="83">offset<pos:position pos:line="288" pos:column="89"/></name></expr>]<pos:position pos:line="288" pos:column="90"/></index></name></expr>;<pos:position pos:line="288" pos:column="91"/></expr_stmt>

                    <comment type="block" pos:line="290" pos:column="21">/* Update the value according the the "correct" formula */</comment>

                    <for pos:line="292" pos:column="21">for <control pos:line="292" pos:column="25">(<init pos:line="292" pos:column="26">;<pos:position pos:line="292" pos:column="27"/></init> <condition><expr><operator pos:line="292" pos:column="28">(<pos:position pos:line="292" pos:column="29"/></operator><name pos:line="292" pos:column="29">value<pos:position pos:line="292" pos:column="34"/></name> <operator pos:line="292" pos:column="35">&amp;<pos:position pos:line="292" pos:column="40"/></operator> <literal type="number" pos:line="292" pos:column="37">0x1741<pos:position pos:line="292" pos:column="43"/></literal><operator pos:line="292" pos:column="43">)<pos:position pos:line="292" pos:column="44"/></operator> <operator pos:line="292" pos:column="45">!=<pos:position pos:line="292" pos:column="47"/></operator> <name pos:line="292" pos:column="48">value<pos:position pos:line="292" pos:column="53"/></name></expr>;<pos:position pos:line="292" pos:column="54"/></condition> <incr><expr><operator pos:line="292" pos:column="55">++<pos:position pos:line="292" pos:column="57"/></operator><name pos:line="292" pos:column="57">value<pos:position pos:line="292" pos:column="62"/></name></expr></incr>)<pos:position pos:line="292" pos:column="63"/></control> <block pos:line="292" pos:column="64">{
                        <expr_stmt><expr><call><name pos:line="293" pos:column="25">assert<pos:position pos:line="293" pos:column="31"/></name><argument_list pos:line="293" pos:column="31">(<argument><expr><name pos:line="293" pos:column="32">value<pos:position pos:line="293" pos:column="37"/></name> <operator pos:line="293" pos:column="38">&lt;=<pos:position pos:line="293" pos:column="43"/></operator> <literal type="number" pos:line="293" pos:column="41">0x1741<pos:position pos:line="293" pos:column="47"/></literal></expr></argument>)<pos:position pos:line="293" pos:column="48"/></argument_list></call></expr>;<pos:position pos:line="293" pos:column="49"/></expr_stmt>
                    }<pos:position pos:line="294" pos:column="22"/></block></for>

                    <if pos:line="296" pos:column="21">if <condition pos:line="296" pos:column="24">(<expr><operator pos:line="296" pos:column="25">(<pos:position pos:line="296" pos:column="26"/></operator><name pos:line="296" pos:column="26">service_flags<pos:position pos:line="296" pos:column="39"/></name> <operator pos:line="296" pos:column="40">&amp;<pos:position pos:line="296" pos:column="45"/></operator> <name pos:line="296" pos:column="42">WCCP2_SERVICE_SRC_IP_HASH<pos:position pos:line="296" pos:column="67"/></name><operator pos:line="296" pos:column="67">)<pos:position pos:line="296" pos:column="68"/></operator> <operator pos:line="296" pos:column="69">||<pos:position pos:line="296" pos:column="71"/></operator> <operator pos:line="296" pos:column="72">(<pos:position pos:line="296" pos:column="73"/></operator><name pos:line="296" pos:column="73">service_flags<pos:position pos:line="296" pos:column="86"/></name> <operator pos:line="296" pos:column="87">&amp;<pos:position pos:line="296" pos:column="92"/></operator> <name pos:line="296" pos:column="89">WCCP2_SERVICE_SRC_IP_ALT_HASH<pos:position pos:line="296" pos:column="118"/></name><operator pos:line="296" pos:column="118">)<pos:position pos:line="296" pos:column="119"/></operator></expr>)<pos:position pos:line="296" pos:column="120"/></condition><then pos:line="296" pos:column="120"> <block pos:line="296" pos:column="121">{
                        <expr_stmt><expr><name><name pos:line="297" pos:column="25">value_element<pos:position pos:line="297" pos:column="38"/></name><operator pos:line="297" pos:column="38">-&gt;<pos:position pos:line="297" pos:column="43"/></operator><name pos:line="297" pos:column="40">source_ip_value<pos:position pos:line="297" pos:column="55"/></name></name> <operator pos:line="297" pos:column="56">=<pos:position pos:line="297" pos:column="57"/></operator> <call><name pos:line="297" pos:column="58">htonl<pos:position pos:line="297" pos:column="63"/></name><argument_list pos:line="297" pos:column="63">(<argument><expr><name pos:line="297" pos:column="64">value<pos:position pos:line="297" pos:column="69"/></name></expr></argument>)<pos:position pos:line="297" pos:column="70"/></argument_list></call></expr>;<pos:position pos:line="297" pos:column="71"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="298" pos:column="25">value_element<pos:position pos:line="298" pos:column="38"/></name><operator pos:line="298" pos:column="38">-&gt;<pos:position pos:line="298" pos:column="43"/></operator><name pos:line="298" pos:column="40">dest_ip_value<pos:position pos:line="298" pos:column="53"/></name></name> <operator pos:line="298" pos:column="54">=<pos:position pos:line="298" pos:column="55"/></operator> <literal type="number" pos:line="298" pos:column="56">0<pos:position pos:line="298" pos:column="57"/></literal></expr>;<pos:position pos:line="298" pos:column="58"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="299" pos:column="25">value_element<pos:position pos:line="299" pos:column="38"/></name><operator pos:line="299" pos:column="38">-&gt;<pos:position pos:line="299" pos:column="43"/></operator><name pos:line="299" pos:column="40">source_port_value<pos:position pos:line="299" pos:column="57"/></name></name> <operator pos:line="299" pos:column="58">=<pos:position pos:line="299" pos:column="59"/></operator> <literal type="number" pos:line="299" pos:column="60">0<pos:position pos:line="299" pos:column="61"/></literal></expr>;<pos:position pos:line="299" pos:column="62"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="300" pos:column="25">value_element<pos:position pos:line="300" pos:column="38"/></name><operator pos:line="300" pos:column="38">-&gt;<pos:position pos:line="300" pos:column="43"/></operator><name pos:line="300" pos:column="40">dest_port_value<pos:position pos:line="300" pos:column="55"/></name></name> <operator pos:line="300" pos:column="56">=<pos:position pos:line="300" pos:column="57"/></operator> <literal type="number" pos:line="300" pos:column="58">0<pos:position pos:line="300" pos:column="59"/></literal></expr>;<pos:position pos:line="300" pos:column="60"/></expr_stmt>
                    }<pos:position pos:line="301" pos:column="22"/></block></then> <elseif pos:line="301" pos:column="23">else <if pos:line="301" pos:column="28">if <condition pos:line="301" pos:column="31">(<expr><operator pos:line="301" pos:column="32">(<pos:position pos:line="301" pos:column="33"/></operator><name><name pos:line="301" pos:column="33">service_list_ptr<pos:position pos:line="301" pos:column="49"/></name><operator pos:line="301" pos:column="49">-&gt;<pos:position pos:line="301" pos:column="54"/></operator><name pos:line="301" pos:column="51">info<pos:position pos:line="301" pos:column="55"/></name><operator pos:line="301" pos:column="55">.<pos:position pos:line="301" pos:column="56"/></operator><name pos:line="301" pos:column="56">service<pos:position pos:line="301" pos:column="63"/></name></name> <operator pos:line="301" pos:column="64">==<pos:position pos:line="301" pos:column="66"/></operator> <name pos:line="301" pos:column="67">WCCP2_SERVICE_STANDARD<pos:position pos:line="301" pos:column="89"/></name><operator pos:line="301" pos:column="89">)<pos:position pos:line="301" pos:column="90"/></operator> <operator pos:line="301" pos:column="91">||<pos:position pos:line="301" pos:column="93"/></operator> <operator pos:line="301" pos:column="94">(<pos:position pos:line="301" pos:column="95"/></operator><name pos:line="301" pos:column="95">service_flags<pos:position pos:line="301" pos:column="108"/></name> <operator pos:line="301" pos:column="109">&amp;<pos:position pos:line="301" pos:column="114"/></operator> <name pos:line="301" pos:column="111">WCCP2_SERVICE_DST_IP_HASH<pos:position pos:line="301" pos:column="136"/></name><operator pos:line="301" pos:column="136">)<pos:position pos:line="301" pos:column="137"/></operator> <operator pos:line="301" pos:column="138">||<pos:position pos:line="301" pos:column="140"/></operator> <operator pos:line="301" pos:column="141">(<pos:position pos:line="301" pos:column="142"/></operator><name pos:line="301" pos:column="142">service_flags<pos:position pos:line="301" pos:column="155"/></name> <operator pos:line="301" pos:column="156">&amp;<pos:position pos:line="301" pos:column="161"/></operator> <name pos:line="301" pos:column="158">WCCP2_SERVICE_DST_IP_ALT_HASH<pos:position pos:line="301" pos:column="187"/></name><operator pos:line="301" pos:column="187">)<pos:position pos:line="301" pos:column="188"/></operator></expr>)<pos:position pos:line="301" pos:column="189"/></condition><then pos:line="301" pos:column="189"> <block pos:line="301" pos:column="190">{
                        <expr_stmt><expr><name><name pos:line="302" pos:column="25">value_element<pos:position pos:line="302" pos:column="38"/></name><operator pos:line="302" pos:column="38">-&gt;<pos:position pos:line="302" pos:column="43"/></operator><name pos:line="302" pos:column="40">source_ip_value<pos:position pos:line="302" pos:column="55"/></name></name> <operator pos:line="302" pos:column="56">=<pos:position pos:line="302" pos:column="57"/></operator> <literal type="number" pos:line="302" pos:column="58">0<pos:position pos:line="302" pos:column="59"/></literal></expr>;<pos:position pos:line="302" pos:column="60"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="303" pos:column="25">value_element<pos:position pos:line="303" pos:column="38"/></name><operator pos:line="303" pos:column="38">-&gt;<pos:position pos:line="303" pos:column="43"/></operator><name pos:line="303" pos:column="40">dest_ip_value<pos:position pos:line="303" pos:column="53"/></name></name> <operator pos:line="303" pos:column="54">=<pos:position pos:line="303" pos:column="55"/></operator> <call><name pos:line="303" pos:column="56">htonl<pos:position pos:line="303" pos:column="61"/></name><argument_list pos:line="303" pos:column="61">(<argument><expr><name pos:line="303" pos:column="62">value<pos:position pos:line="303" pos:column="67"/></name></expr></argument>)<pos:position pos:line="303" pos:column="68"/></argument_list></call></expr>;<pos:position pos:line="303" pos:column="69"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="304" pos:column="25">value_element<pos:position pos:line="304" pos:column="38"/></name><operator pos:line="304" pos:column="38">-&gt;<pos:position pos:line="304" pos:column="43"/></operator><name pos:line="304" pos:column="40">source_port_value<pos:position pos:line="304" pos:column="57"/></name></name> <operator pos:line="304" pos:column="58">=<pos:position pos:line="304" pos:column="59"/></operator> <literal type="number" pos:line="304" pos:column="60">0<pos:position pos:line="304" pos:column="61"/></literal></expr>;<pos:position pos:line="304" pos:column="62"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="305" pos:column="25">value_element<pos:position pos:line="305" pos:column="38"/></name><operator pos:line="305" pos:column="38">-&gt;<pos:position pos:line="305" pos:column="43"/></operator><name pos:line="305" pos:column="40">dest_port_value<pos:position pos:line="305" pos:column="55"/></name></name> <operator pos:line="305" pos:column="56">=<pos:position pos:line="305" pos:column="57"/></operator> <literal type="number" pos:line="305" pos:column="58">0<pos:position pos:line="305" pos:column="59"/></literal></expr>;<pos:position pos:line="305" pos:column="60"/></expr_stmt>
                    }<pos:position pos:line="306" pos:column="22"/></block></then></if></elseif> <elseif pos:line="306" pos:column="23">else <if pos:line="306" pos:column="28">if <condition pos:line="306" pos:column="31">(<expr><operator pos:line="306" pos:column="32">(<pos:position pos:line="306" pos:column="33"/></operator><name pos:line="306" pos:column="33">service_flags<pos:position pos:line="306" pos:column="46"/></name> <operator pos:line="306" pos:column="47">&amp;<pos:position pos:line="306" pos:column="52"/></operator> <name pos:line="306" pos:column="49">WCCP2_SERVICE_SRC_PORT_HASH<pos:position pos:line="306" pos:column="76"/></name><operator pos:line="306" pos:column="76">)<pos:position pos:line="306" pos:column="77"/></operator> <operator pos:line="306" pos:column="78">||<pos:position pos:line="306" pos:column="80"/></operator> <operator pos:line="306" pos:column="81">(<pos:position pos:line="306" pos:column="82"/></operator><name pos:line="306" pos:column="82">service_flags<pos:position pos:line="306" pos:column="95"/></name> <operator pos:line="306" pos:column="96">&amp;<pos:position pos:line="306" pos:column="101"/></operator> <name pos:line="306" pos:column="98">WCCP2_SERVICE_SRC_PORT_ALT_HASH<pos:position pos:line="306" pos:column="129"/></name><operator pos:line="306" pos:column="129">)<pos:position pos:line="306" pos:column="130"/></operator></expr>)<pos:position pos:line="306" pos:column="131"/></condition><then pos:line="306" pos:column="131"> <block pos:line="306" pos:column="132">{
                        <expr_stmt><expr><name><name pos:line="307" pos:column="25">value_element<pos:position pos:line="307" pos:column="38"/></name><operator pos:line="307" pos:column="38">-&gt;<pos:position pos:line="307" pos:column="43"/></operator><name pos:line="307" pos:column="40">source_ip_value<pos:position pos:line="307" pos:column="55"/></name></name> <operator pos:line="307" pos:column="56">=<pos:position pos:line="307" pos:column="57"/></operator> <literal type="number" pos:line="307" pos:column="58">0<pos:position pos:line="307" pos:column="59"/></literal></expr>;<pos:position pos:line="307" pos:column="60"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="308" pos:column="25">value_element<pos:position pos:line="308" pos:column="38"/></name><operator pos:line="308" pos:column="38">-&gt;<pos:position pos:line="308" pos:column="43"/></operator><name pos:line="308" pos:column="40">dest_ip_value<pos:position pos:line="308" pos:column="53"/></name></name> <operator pos:line="308" pos:column="54">=<pos:position pos:line="308" pos:column="55"/></operator> <literal type="number" pos:line="308" pos:column="56">0<pos:position pos:line="308" pos:column="57"/></literal></expr>;<pos:position pos:line="308" pos:column="58"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="309" pos:column="25">value_element<pos:position pos:line="309" pos:column="38"/></name><operator pos:line="309" pos:column="38">-&gt;<pos:position pos:line="309" pos:column="43"/></operator><name pos:line="309" pos:column="40">source_port_value<pos:position pos:line="309" pos:column="57"/></name></name> <operator pos:line="309" pos:column="58">=<pos:position pos:line="309" pos:column="59"/></operator> <call><name pos:line="309" pos:column="60">htons<pos:position pos:line="309" pos:column="65"/></name><argument_list pos:line="309" pos:column="65">(<argument><expr><name pos:line="309" pos:column="66">value<pos:position pos:line="309" pos:column="71"/></name></expr></argument>)<pos:position pos:line="309" pos:column="72"/></argument_list></call></expr>;<pos:position pos:line="309" pos:column="73"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="310" pos:column="25">value_element<pos:position pos:line="310" pos:column="38"/></name><operator pos:line="310" pos:column="38">-&gt;<pos:position pos:line="310" pos:column="43"/></operator><name pos:line="310" pos:column="40">dest_port_value<pos:position pos:line="310" pos:column="55"/></name></name> <operator pos:line="310" pos:column="56">=<pos:position pos:line="310" pos:column="57"/></operator> <literal type="number" pos:line="310" pos:column="58">0<pos:position pos:line="310" pos:column="59"/></literal></expr>;<pos:position pos:line="310" pos:column="60"/></expr_stmt>
                    }<pos:position pos:line="311" pos:column="22"/></block></then></if></elseif> <elseif pos:line="311" pos:column="23">else <if pos:line="311" pos:column="28">if <condition pos:line="311" pos:column="31">(<expr><operator pos:line="311" pos:column="32">(<pos:position pos:line="311" pos:column="33"/></operator><name pos:line="311" pos:column="33">service_flags<pos:position pos:line="311" pos:column="46"/></name> <operator pos:line="311" pos:column="47">&amp;<pos:position pos:line="311" pos:column="52"/></operator> <name pos:line="311" pos:column="49">WCCP2_SERVICE_DST_PORT_HASH<pos:position pos:line="311" pos:column="76"/></name><operator pos:line="311" pos:column="76">)<pos:position pos:line="311" pos:column="77"/></operator> <operator pos:line="311" pos:column="78">||<pos:position pos:line="311" pos:column="80"/></operator> <operator pos:line="311" pos:column="81">(<pos:position pos:line="311" pos:column="82"/></operator><name pos:line="311" pos:column="82">service_flags<pos:position pos:line="311" pos:column="95"/></name> <operator pos:line="311" pos:column="96">&amp;<pos:position pos:line="311" pos:column="101"/></operator> <name pos:line="311" pos:column="98">WCCP2_SERVICE_DST_PORT_ALT_HASH<pos:position pos:line="311" pos:column="129"/></name><operator pos:line="311" pos:column="129">)<pos:position pos:line="311" pos:column="130"/></operator></expr>)<pos:position pos:line="311" pos:column="131"/></condition><then pos:line="311" pos:column="131"> <block pos:line="311" pos:column="132">{
                        <expr_stmt><expr><name><name pos:line="312" pos:column="25">value_element<pos:position pos:line="312" pos:column="38"/></name><operator pos:line="312" pos:column="38">-&gt;<pos:position pos:line="312" pos:column="43"/></operator><name pos:line="312" pos:column="40">source_ip_value<pos:position pos:line="312" pos:column="55"/></name></name> <operator pos:line="312" pos:column="56">=<pos:position pos:line="312" pos:column="57"/></operator> <literal type="number" pos:line="312" pos:column="58">0<pos:position pos:line="312" pos:column="59"/></literal></expr>;<pos:position pos:line="312" pos:column="60"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="313" pos:column="25">value_element<pos:position pos:line="313" pos:column="38"/></name><operator pos:line="313" pos:column="38">-&gt;<pos:position pos:line="313" pos:column="43"/></operator><name pos:line="313" pos:column="40">dest_ip_value<pos:position pos:line="313" pos:column="53"/></name></name> <operator pos:line="313" pos:column="54">=<pos:position pos:line="313" pos:column="55"/></operator> <literal type="number" pos:line="313" pos:column="56">0<pos:position pos:line="313" pos:column="57"/></literal></expr>;<pos:position pos:line="313" pos:column="58"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="314" pos:column="25">value_element<pos:position pos:line="314" pos:column="38"/></name><operator pos:line="314" pos:column="38">-&gt;<pos:position pos:line="314" pos:column="43"/></operator><name pos:line="314" pos:column="40">source_port_value<pos:position pos:line="314" pos:column="57"/></name></name> <operator pos:line="314" pos:column="58">=<pos:position pos:line="314" pos:column="59"/></operator> <literal type="number" pos:line="314" pos:column="60">0<pos:position pos:line="314" pos:column="61"/></literal></expr>;<pos:position pos:line="314" pos:column="62"/></expr_stmt>
                        <expr_stmt><expr><name><name pos:line="315" pos:column="25">value_element<pos:position pos:line="315" pos:column="38"/></name><operator pos:line="315" pos:column="38">-&gt;<pos:position pos:line="315" pos:column="43"/></operator><name pos:line="315" pos:column="40">dest_port_value<pos:position pos:line="315" pos:column="55"/></name></name> <operator pos:line="315" pos:column="56">=<pos:position pos:line="315" pos:column="57"/></operator> <call><name pos:line="315" pos:column="58">htons<pos:position pos:line="315" pos:column="63"/></name><argument_list pos:line="315" pos:column="63">(<argument><expr><name pos:line="315" pos:column="64">value<pos:position pos:line="315" pos:column="69"/></name></expr></argument>)<pos:position pos:line="315" pos:column="70"/></argument_list></call></expr>;<pos:position pos:line="315" pos:column="71"/></expr_stmt>
                    }<pos:position pos:line="316" pos:column="22"/></block></then></if></elseif> <else pos:line="316" pos:column="23">else <block pos:line="316" pos:column="28">{
                        <expr_stmt><expr><call><name pos:line="317" pos:column="25">fatalf<pos:position pos:line="317" pos:column="31"/></name><argument_list pos:line="317" pos:column="31">(<argument><expr><literal type="string" pos:line="317" pos:column="32">"Unknown service hash method\n"<pos:position pos:line="317" pos:column="63"/></literal></expr></argument>)<pos:position pos:line="317" pos:column="64"/></argument_list></call></expr>;<pos:position pos:line="317" pos:column="65"/></expr_stmt>
                    }<pos:position pos:line="318" pos:column="22"/></block></else></if>

                    <expr_stmt><expr><name><name pos:line="320" pos:column="21">value_element<pos:position pos:line="320" pos:column="34"/></name><operator pos:line="320" pos:column="34">-&gt;<pos:position pos:line="320" pos:column="39"/></operator><name pos:line="320" pos:column="36">cache_ip<pos:position pos:line="320" pos:column="44"/></name></name> <operator pos:line="320" pos:column="45">=<pos:position pos:line="320" pos:column="46"/></operator> <name><name pos:line="320" pos:column="47">cache_list_ptr<pos:position pos:line="320" pos:column="61"/></name><operator pos:line="320" pos:column="61">-&gt;<pos:position pos:line="320" pos:column="66"/></operator><name pos:line="320" pos:column="63">cache_ip<pos:position pos:line="320" pos:column="71"/></name></name></expr>;<pos:position pos:line="320" pos:column="72"/></expr_stmt>

                    <expr_stmt><expr><name pos:line="322" pos:column="21">offset<pos:position pos:line="322" pos:column="27"/></name> <operator pos:line="322" pos:column="28">+=<pos:position pos:line="322" pos:column="30"/></operator> <sizeof pos:line="322" pos:column="31">sizeof<argument_list pos:line="322" pos:column="37">(<argument><expr pos:line="322" pos:column="38">struct <name pos:line="322" pos:column="45">wccp2_value_element_t<pos:position pos:line="322" pos:column="66"/></name></expr></argument>)<pos:position pos:line="322" pos:column="67"/></argument_list></sizeof></expr>;<pos:position pos:line="322" pos:column="68"/></expr_stmt>
                    <expr_stmt><expr><operator pos:line="323" pos:column="21">++<pos:position pos:line="323" pos:column="23"/></operator><name pos:line="323" pos:column="23">value<pos:position pos:line="323" pos:column="28"/></name></expr>;<pos:position pos:line="323" pos:column="29"/></expr_stmt>

                    <comment type="block" pos:line="325" pos:column="21">/* Assign the next value to the next cache */</comment>

                    <if pos:line="327" pos:column="21">if <condition pos:line="327" pos:column="24">(<expr><operator pos:line="327" pos:column="25">(<pos:position pos:line="327" pos:column="26"/></operator><name><name pos:line="327" pos:column="26">cache_list_ptr<pos:position pos:line="327" pos:column="40"/></name><operator pos:line="327" pos:column="40">-&gt;<pos:position pos:line="327" pos:column="45"/></operator><name pos:line="327" pos:column="42">next<pos:position pos:line="327" pos:column="46"/></name></name><operator pos:line="327" pos:column="46">)<pos:position pos:line="327" pos:column="47"/></operator> <operator pos:line="327" pos:column="48">&amp;&amp;<pos:position pos:line="327" pos:column="58"/></operator> <operator pos:line="327" pos:column="51">(<pos:position pos:line="327" pos:column="52"/></operator><name><name pos:line="327" pos:column="52">cache_list_ptr<pos:position pos:line="327" pos:column="66"/></name><operator pos:line="327" pos:column="66">-&gt;<pos:position pos:line="327" pos:column="71"/></operator><name pos:line="327" pos:column="68">next<pos:position pos:line="327" pos:column="72"/></name><operator pos:line="327" pos:column="72">-&gt;<pos:position pos:line="327" pos:column="77"/></operator><name pos:line="327" pos:column="74">next<pos:position pos:line="327" pos:column="78"/></name></name><operator pos:line="327" pos:column="78">)<pos:position pos:line="327" pos:column="79"/></operator></expr>)<pos:position pos:line="327" pos:column="80"/></condition><then pos:line="327" pos:column="80">
                        <block type="pseudo"><expr_stmt><expr><name pos:line="328" pos:column="25">cache_list_ptr<pos:position pos:line="328" pos:column="39"/></name> <operator pos:line="328" pos:column="40">=<pos:position pos:line="328" pos:column="41"/></operator> <name><name pos:line="328" pos:column="42">cache_list_ptr<pos:position pos:line="328" pos:column="56"/></name><operator pos:line="328" pos:column="56">-&gt;<pos:position pos:line="328" pos:column="61"/></operator><name pos:line="328" pos:column="58">next<pos:position pos:line="328" pos:column="62"/></name></name></expr>;<pos:position pos:line="328" pos:column="63"/></expr_stmt></block></then>
                    <else pos:line="329" pos:column="21">else
                        <block type="pseudo"><expr_stmt><expr><name pos:line="330" pos:column="25">cache_list_ptr<pos:position pos:line="330" pos:column="39"/></name> <operator pos:line="330" pos:column="40">=<pos:position pos:line="330" pos:column="41"/></operator> <operator pos:line="330" pos:column="42">&amp;<pos:position pos:line="330" pos:column="47"/></operator><name><name pos:line="330" pos:column="43">router_list_ptr<pos:position pos:line="330" pos:column="58"/></name><operator pos:line="330" pos:column="58">-&gt;<pos:position pos:line="330" pos:column="63"/></operator><name pos:line="330" pos:column="60">cache_list_head<pos:position pos:line="330" pos:column="75"/></name></name></expr>;<pos:position pos:line="330" pos:column="76"/></expr_stmt></block></else></if>
                }<pos:position pos:line="331" pos:column="18"/></block></for>

                <comment type="block" pos:line="333" pos:column="17">/* Fill in length */</comment>
                <expr_stmt><expr><name><name pos:line="334" pos:column="17">alt_assignment_type_header<pos:position pos:line="334" pos:column="43"/></name><operator pos:line="334" pos:column="43">-&gt;<pos:position pos:line="334" pos:column="48"/></operator><name pos:line="334" pos:column="45">length<pos:position pos:line="334" pos:column="51"/></name></name> <operator pos:line="334" pos:column="52">=<pos:position pos:line="334" pos:column="53"/></operator> <call><name pos:line="334" pos:column="54">htons<pos:position pos:line="334" pos:column="59"/></name><argument_list pos:line="334" pos:column="59">(<argument><expr><name pos:line="334" pos:column="60">offset<pos:position pos:line="334" pos:column="66"/></name> <operator pos:line="334" pos:column="67">-<pos:position pos:line="334" pos:column="68"/></operator> <name pos:line="334" pos:column="69">alt_assignment_offset<pos:position pos:line="334" pos:column="90"/></name></expr></argument>)<pos:position pos:line="334" pos:column="91"/></argument_list></call></expr>;<pos:position pos:line="334" pos:column="92"/></expr_stmt>

                <break pos:line="336" pos:column="17">break;<pos:position pos:line="336" pos:column="23"/></break>

            <default pos:line="338" pos:column="13">default:<pos:position pos:line="338" pos:column="21"/></default>
                <expr_stmt><expr><call><name pos:line="339" pos:column="17">fatalf<pos:position pos:line="339" pos:column="23"/></name><argument_list pos:line="339" pos:column="23">(<argument><expr><literal type="string" pos:line="339" pos:column="24">"Unknown Wccp2 assignment method\n"<pos:position pos:line="339" pos:column="59"/></literal></expr></argument>)<pos:position pos:line="339" pos:column="60"/></argument_list></call></expr>;<pos:position pos:line="339" pos:column="61"/></expr_stmt>
            }<pos:position pos:line="340" pos:column="14"/></block></switch>

            <comment type="block" pos:line="342" pos:column="13">/* Fill in length */</comment>

            <expr_stmt><expr><name><name pos:line="344" pos:column="13">assignment_header<pos:position pos:line="344" pos:column="30"/></name><operator pos:line="344" pos:column="30">-&gt;<pos:position pos:line="344" pos:column="35"/></operator><name pos:line="344" pos:column="32">length<pos:position pos:line="344" pos:column="38"/></name></name> <operator pos:line="344" pos:column="39">=<pos:position pos:line="344" pos:column="40"/></operator> <call><name pos:line="344" pos:column="41">htons<pos:position pos:line="344" pos:column="46"/></name><argument_list pos:line="344" pos:column="46">(<argument><expr><name pos:line="344" pos:column="47">offset<pos:position pos:line="344" pos:column="53"/></name> <operator pos:line="344" pos:column="54">-<pos:position pos:line="344" pos:column="55"/></operator> <name pos:line="344" pos:column="56">assignment_offset<pos:position pos:line="344" pos:column="73"/></name></expr></argument>)<pos:position pos:line="344" pos:column="74"/></argument_list></call></expr>;<pos:position pos:line="344" pos:column="75"/></expr_stmt>

            <comment type="block" pos:line="346" pos:column="13">/* Fill in assignment key */</comment>
            <expr_stmt><expr><name><name pos:line="347" pos:column="13">assignment_key<pos:position pos:line="347" pos:column="27"/></name><operator pos:line="347" pos:column="27">-&gt;<pos:position pos:line="347" pos:column="32"/></operator><name pos:line="347" pos:column="29">master_ip<pos:position pos:line="347" pos:column="38"/></name></name> <operator pos:line="347" pos:column="39">=<pos:position pos:line="347" pos:column="40"/></operator> <name><name pos:line="347" pos:column="41">router_list_ptr<pos:position pos:line="347" pos:column="56"/></name><operator pos:line="347" pos:column="56">-&gt;<pos:position pos:line="347" pos:column="61"/></operator><name pos:line="347" pos:column="58">local_ip<pos:position pos:line="347" pos:column="66"/></name></name></expr>;<pos:position pos:line="347" pos:column="67"/></expr_stmt>

            <comment type="block" pos:line="349" pos:column="13">/* finish length */</comment>

            <expr_stmt><expr><name><name pos:line="351" pos:column="13">main_header<pos:position pos:line="351" pos:column="24"/></name><operator pos:line="351" pos:column="24">-&gt;<pos:position pos:line="351" pos:column="29"/></operator><name pos:line="351" pos:column="26">length<pos:position pos:line="351" pos:column="32"/></name></name> <operator pos:line="351" pos:column="33">=<pos:position pos:line="351" pos:column="34"/></operator> <call><name pos:line="351" pos:column="35">htons<pos:position pos:line="351" pos:column="40"/></name><argument_list pos:line="351" pos:column="40">(<argument><expr><name pos:line="351" pos:column="41">offset<pos:position pos:line="351" pos:column="47"/></name> <operator pos:line="351" pos:column="48">-<pos:position pos:line="351" pos:column="49"/></operator> <sizeof pos:line="351" pos:column="50">sizeof<argument_list pos:line="351" pos:column="56">(<argument><expr pos:line="351" pos:column="57">struct <name pos:line="351" pos:column="64">wccp2_message_header_t<pos:position pos:line="351" pos:column="86"/></name></expr></argument>)<pos:position pos:line="351" pos:column="87"/></argument_list></sizeof></expr></argument>)<pos:position pos:line="351" pos:column="88"/></argument_list></call></expr>;<pos:position pos:line="351" pos:column="89"/></expr_stmt>

            <comment type="block" pos:line="353" pos:column="13">/* set the destination address */</comment>
            <expr_stmt><expr><name><name pos:line="354" pos:column="13">router<pos:position pos:line="354" pos:column="19"/></name><operator pos:line="354" pos:column="19">.<pos:position pos:line="354" pos:column="20"/></operator><name pos:line="354" pos:column="20">sin_addr<pos:position pos:line="354" pos:column="28"/></name></name> <operator pos:line="354" pos:column="29">=<pos:position pos:line="354" pos:column="30"/></operator> <name><name pos:line="354" pos:column="31">router_list_ptr<pos:position pos:line="354" pos:column="46"/></name><operator pos:line="354" pos:column="46">-&gt;<pos:position pos:line="354" pos:column="51"/></operator><name pos:line="354" pos:column="48">router_sendto_address<pos:position pos:line="354" pos:column="69"/></name></name></expr>;<pos:position pos:line="354" pos:column="70"/></expr_stmt>

            <comment type="block" pos:line="356" pos:column="13">/* Security update, if needed */</comment>

            <if pos:line="358" pos:column="13">if <condition pos:line="358" pos:column="16">(<expr><name><name pos:line="358" pos:column="17">service_list_ptr<pos:position pos:line="358" pos:column="33"/></name><operator pos:line="358" pos:column="33">-&gt;<pos:position pos:line="358" pos:column="38"/></operator><name pos:line="358" pos:column="35">wccp2_security_type<pos:position pos:line="358" pos:column="54"/></name></name> <operator pos:line="358" pos:column="55">==<pos:position pos:line="358" pos:column="57"/></operator> <name pos:line="358" pos:column="58">WCCP2_MD5_SECURITY<pos:position pos:line="358" pos:column="76"/></name></expr>)<pos:position pos:line="358" pos:column="77"/></condition><then pos:line="358" pos:column="77"> <block pos:line="358" pos:column="78">{
                <expr_stmt><expr><call><name pos:line="359" pos:column="17">wccp2_update_md5_security<pos:position pos:line="359" pos:column="42"/></name><argument_list pos:line="359" pos:column="42">(<argument><expr><name><name pos:line="359" pos:column="43">service_list_ptr<pos:position pos:line="359" pos:column="59"/></name><operator pos:line="359" pos:column="59">-&gt;<pos:position pos:line="359" pos:column="64"/></operator><name pos:line="359" pos:column="61">wccp_password<pos:position pos:line="359" pos:column="74"/></name></name></expr></argument>, <argument><expr><operator pos:line="359" pos:column="76">(<pos:position pos:line="359" pos:column="77"/></operator><name pos:line="359" pos:column="77">char<pos:position pos:line="359" pos:column="81"/></name> <operator pos:line="359" pos:column="82">*<pos:position pos:line="359" pos:column="83"/></operator><operator pos:line="359" pos:column="83">)<pos:position pos:line="359" pos:column="84"/></operator> <name pos:line="359" pos:column="85">security<pos:position pos:line="359" pos:column="93"/></name></expr></argument>, <argument><expr><name pos:line="359" pos:column="95">wccp_packet<pos:position pos:line="359" pos:column="106"/></name></expr></argument>, <argument><expr><name pos:line="359" pos:column="108">offset<pos:position pos:line="359" pos:column="114"/></name></expr></argument>)<pos:position pos:line="359" pos:column="115"/></argument_list></call></expr>;<pos:position pos:line="359" pos:column="116"/></expr_stmt>
            }<pos:position pos:line="360" pos:column="14"/></block></then></if>

            <if pos:line="362" pos:column="13">if <condition pos:line="362" pos:column="16">(<expr><call><name pos:line="362" pos:column="17">ntohl<pos:position pos:line="362" pos:column="22"/></name><argument_list pos:line="362" pos:column="22">(<argument><expr><name><name pos:line="362" pos:column="23">router_list_ptr<pos:position pos:line="362" pos:column="38"/></name><operator pos:line="362" pos:column="38">-&gt;<pos:position pos:line="362" pos:column="43"/></operator><name pos:line="362" pos:column="40">num_caches<pos:position pos:line="362" pos:column="50"/></name></name></expr></argument>)<pos:position pos:line="362" pos:column="51"/></argument_list></call></expr>)<pos:position pos:line="362" pos:column="52"/></condition><then pos:line="362" pos:column="52"> <block pos:line="362" pos:column="53">{
                <comment type="block" pos:line="363" pos:column="17">/* send packet */</comment>

                <comment type="block" pos:line="365" pos:column="17">/* FIXME INET6 : drop temp conversion */</comment>
                <decl_stmt><decl><type><name><name pos:line="366" pos:column="17">Ip<pos:position pos:line="366" pos:column="19"/></name><operator pos:line="366" pos:column="19">::<pos:position pos:line="366" pos:column="21"/></operator><name pos:line="366" pos:column="21">Address<pos:position pos:line="366" pos:column="28"/></name></name></type> <name pos:line="366" pos:column="29">tmp_rtr<pos:position pos:line="366" pos:column="36"/></name><argument_list pos:line="366" pos:column="36">(<argument><expr><name pos:line="366" pos:column="37">router<pos:position pos:line="366" pos:column="43"/></name></expr></argument>)<pos:position pos:line="366" pos:column="44"/></argument_list></decl>;<pos:position pos:line="366" pos:column="45"/></decl_stmt>

                <if pos:line="368" pos:column="17">if <condition pos:line="368" pos:column="20">(<expr><name pos:line="368" pos:column="21">wccp2_numrouters<pos:position pos:line="368" pos:column="37"/></name> <operator pos:line="368" pos:column="38">&gt;<pos:position pos:line="368" pos:column="42"/></operator> <literal type="number" pos:line="368" pos:column="40">1<pos:position pos:line="368" pos:column="41"/></literal></expr>)<pos:position pos:line="368" pos:column="42"/></condition><then pos:line="368" pos:column="42"> <block pos:line="368" pos:column="43">{
                    <expr_stmt><expr><call><name pos:line="369" pos:column="21">comm_udp_sendto<pos:position pos:line="369" pos:column="36"/></name><argument_list pos:line="369" pos:column="36">(<argument><expr><name pos:line="369" pos:column="37">theWccp2Connection<pos:position pos:line="369" pos:column="55"/></name></expr></argument>,
                                    <argument><expr><name pos:line="370" pos:column="37">tmp_rtr<pos:position pos:line="370" pos:column="44"/></name></expr></argument>,
                                    <argument><expr><operator pos:line="371" pos:column="37">&amp;<pos:position pos:line="371" pos:column="42"/></operator><name pos:line="371" pos:column="38">wccp_packet<pos:position pos:line="371" pos:column="49"/></name></expr></argument>,
                                    <argument><expr><name pos:line="372" pos:column="37">offset<pos:position pos:line="372" pos:column="43"/></name></expr></argument>)<pos:position pos:line="372" pos:column="44"/></argument_list></call></expr>;<pos:position pos:line="372" pos:column="45"/></expr_stmt>
                }<pos:position pos:line="373" pos:column="18"/></block></then> <else pos:line="373" pos:column="19">else <block pos:line="373" pos:column="24">{
                    <expr_stmt><expr><name pos:line="374" pos:column="21">errno<pos:position pos:line="374" pos:column="26"/></name> <operator pos:line="374" pos:column="27">=<pos:position pos:line="374" pos:column="28"/></operator> <literal type="number" pos:line="374" pos:column="29">0<pos:position pos:line="374" pos:column="30"/></literal></expr>;<pos:position pos:line="374" pos:column="31"/></expr_stmt>
                    <if pos:line="375" pos:column="21">if <condition pos:line="375" pos:column="24">(<expr><call><name pos:line="375" pos:column="25">send<pos:position pos:line="375" pos:column="29"/></name><argument_list pos:line="375" pos:column="29">(<argument><expr><name pos:line="375" pos:column="30">theWccp2Connection<pos:position pos:line="375" pos:column="48"/></name></expr></argument>, <argument><expr><operator pos:line="375" pos:column="50">&amp;<pos:position pos:line="375" pos:column="55"/></operator><name pos:line="375" pos:column="51">wccp_packet<pos:position pos:line="375" pos:column="62"/></name></expr></argument>, <argument><expr><name pos:line="375" pos:column="64">offset<pos:position pos:line="375" pos:column="70"/></name></expr></argument>, <argument><expr><literal type="number" pos:line="375" pos:column="72">0<pos:position pos:line="375" pos:column="73"/></literal></expr></argument>)<pos:position pos:line="375" pos:column="74"/></argument_list></call> <operator pos:line="375" pos:column="75">&lt;<pos:position pos:line="375" pos:column="79"/></operator> <cast type="static" pos:line="375" pos:column="77">static_cast<argument_list type="generic" pos:line="375" pos:column="88">&lt;<argument><expr><name pos:line="375" pos:column="89">int<pos:position pos:line="375" pos:column="92"/></name></expr></argument>&gt;<pos:position pos:line="375" pos:column="96"/></argument_list><argument_list pos:line="375" pos:column="93">(<argument><expr><name pos:line="375" pos:column="94">offset<pos:position pos:line="375" pos:column="100"/></name></expr></argument>)<pos:position pos:line="375" pos:column="101"/></argument_list></cast></expr>)<pos:position pos:line="375" pos:column="102"/></condition><then pos:line="375" pos:column="102">
                        <block type="pseudo"><expr_stmt><expr><call><name pos:line="376" pos:column="25">debugs<pos:position pos:line="376" pos:column="31"/></name><argument_list pos:line="376" pos:column="31">(<argument><expr><literal type="number" pos:line="376" pos:column="32">80<pos:position pos:line="376" pos:column="34"/></literal></expr></argument>, <argument><expr><literal type="number" pos:line="376" pos:column="36">2<pos:position pos:line="376" pos:column="37"/></literal></expr></argument>, <argument><expr><literal type="string" pos:line="376" pos:column="39">"ERROR: failed to send WCCPv2 HERE_I_AM packet to "<pos:position pos:line="376" pos:column="90"/></literal> <operator pos:line="376" pos:column="91">&lt;&lt;<pos:position pos:line="376" pos:column="99"/></operator> <name pos:line="376" pos:column="94">tmp_rtr<pos:position pos:line="376" pos:column="101"/></name> <operator pos:line="376" pos:column="102">&lt;&lt;<pos:position pos:line="376" pos:column="110"/></operator> <literal type="string" pos:line="376" pos:column="105">" : "<pos:position pos:line="376" pos:column="110"/></literal> <operator pos:line="376" pos:column="111">&lt;&lt;<pos:position pos:line="376" pos:column="119"/></operator> <call><name pos:line="376" pos:column="114">xstrerror<pos:position pos:line="376" pos:column="123"/></name><argument_list pos:line="376" pos:column="123">()<pos:position pos:line="376" pos:column="125"/></argument_list></call></expr></argument>)<pos:position pos:line="376" pos:column="126"/></argument_list></call></expr>;<pos:position pos:line="376" pos:column="127"/></expr_stmt></block></then></if>
                }<pos:position pos:line="377" pos:column="18"/></block></else></if>
            }<pos:position pos:line="378" pos:column="14"/></block></then></if>
            <expr_stmt><expr><call><name pos:line="379" pos:column="13">safe_free<pos:position pos:line="379" pos:column="22"/></name><argument_list pos:line="379" pos:column="22">(<argument><expr><name pos:line="379" pos:column="23">weight<pos:position pos:line="379" pos:column="29"/></name></expr></argument>)<pos:position pos:line="379" pos:column="30"/></argument_list></call></expr>;<pos:position pos:line="379" pos:column="31"/></expr_stmt>
        }<pos:position pos:line="380" pos:column="10"/></block></for>

        <expr_stmt><expr><name pos:line="382" pos:column="9">service_list_ptr<pos:position pos:line="382" pos:column="25"/></name> <operator pos:line="382" pos:column="26">=<pos:position pos:line="382" pos:column="27"/></operator> <name><name pos:line="382" pos:column="28">service_list_ptr<pos:position pos:line="382" pos:column="44"/></name><operator pos:line="382" pos:column="44">-&gt;<pos:position pos:line="382" pos:column="49"/></operator><name pos:line="382" pos:column="46">next<pos:position pos:line="382" pos:column="50"/></name></name></expr>;<pos:position pos:line="382" pos:column="51"/></expr_stmt>
    }<pos:position pos:line="383" pos:column="6"/></block></while>
}<pos:position pos:line="384" pos:column="2"/></block></function></unit>
