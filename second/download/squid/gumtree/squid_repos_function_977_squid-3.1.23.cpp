char *space(mb_size_t required) { if (size + required > capacity) grow(size + required); return buf + size; }