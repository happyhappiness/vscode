(ds->loop < 0 || last)
					goto failed;