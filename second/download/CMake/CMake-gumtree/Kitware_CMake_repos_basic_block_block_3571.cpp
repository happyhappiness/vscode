weight[i+1] = (freq[i] == 0 ? 1 : freq[i]) << 8