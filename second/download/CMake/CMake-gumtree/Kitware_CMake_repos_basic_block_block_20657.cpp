(buffer == NULL) {
    return ERROR_OUTOFMEMORY;
  }