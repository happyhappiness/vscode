update_long_rep(state)