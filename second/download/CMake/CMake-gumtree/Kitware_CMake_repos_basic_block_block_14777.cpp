bytes_to_write = block_end - a->offset